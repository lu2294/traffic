!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e(require("react"),require("leaflet"));else if("function"==typeof define&&define.amd)define(["react","leaflet"],e);else{var n="object"==typeof exports?e(require("react"),require("leaflet")):e(t.React,t.L);for(var r in n)("object"==typeof exports?exports:t)[r]=n[r]}}(window,(function(t,e){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=304)}([function(t,e,n){"use strict";function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}n.d(e,"a",(function(){return i}))},function(t,e,n){"use strict";function r(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";n.d(e,"c",(function(){return r.a})),n.d(e,"e",(function(){return i.a})),n.d(e,"i",(function(){return s})),n.d(e,"f",(function(){return u})),n.d(e,"d",(function(){return c})),n.d(e,"g",(function(){return l.a})),n.d(e,"b",(function(){return h})),n.d(e,"a",(function(){return o.a})),n.d(e,"h",(function(){return d.a}));var r=n(67),i=n(114);var o=n(3),a={};function s(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"id";a[t]=a[t]||1;var e=a[t]++;return"".concat(t,"-").concat(e)}function u(t){return Object(o.a)("number"==typeof t,"Input must be a number"),t&&0==(t&t-1)}function c(t){var e=!0;for(var n in t){e=!1;break}return e}var l=n(36);function f(t,e){for(var n=e.maxElts,r=void 0===n?16:n,i=e.size,o=void 0===i?1:i,a="[",s=0;s<t.length&&s<r;++s)s>0&&(a+=",".concat(s%o==0?" ":"")),a+=h(t[s],e);var u=t.length>r?"...":"]";return"".concat(a).concat(u)}function h(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=1e-16,r=e.isInteger,i=void 0!==r&&r;if(Array.isArray(t)||ArrayBuffer.isView(t))return f(t,e);if(!Number.isFinite(t))return String(t);if(Math.abs(t)<n)return i?"0":"0.";if(i)return t.toFixed(0);if(Math.abs(t)>100&&Math.abs(t)<1e4)return t.toFixed(0);var o=t.toPrecision(2),a=o.indexOf(".0");return a===o.length-2?o.slice(0,-1):o}var d=n(115)},function(t,e,n){"use strict";n.r(e),n.d(e,"isWebGL",(function(){return r.c})),n.d(e,"isWebGL2",(function(){return r.d})),n.d(e,"cloneTextureFrom",(function(){return i.a})),n.d(e,"getKeyValue",(function(){return o.b})),n.d(e,"getKey",(function(){return o.a})),n.d(e,"createGLContext",(function(){return V})),n.d(e,"destroyGLContext",(function(){return G})),n.d(e,"resizeGLContext",(function(){return U})),n.d(e,"pollGLContext",(function(){return W})),n.d(e,"setContextDefaults",(function(){return z})),n.d(e,"trackContextState",(function(){return v.a})),n.d(e,"resetParameters",(function(){return X.d})),n.d(e,"getParameter",(function(){return X.b})),n.d(e,"getParameters",(function(){return X.c})),n.d(e,"setParameter",(function(){return X.e})),n.d(e,"setParameters",(function(){return X.f})),n.d(e,"withParameters",(function(){return X.g})),n.d(e,"getModifiedParameters",(function(){return X.a})),n.d(e,"getContextInfo",(function(){return T})),n.d(e,"getGLContextInfo",(function(){return A})),n.d(e,"getContextLimits",(function(){return I})),n.d(e,"glGetDebugInfo",(function(){return N})),n.d(e,"FEATURES",(function(){return Y})),n.d(e,"hasFeature",(function(){return Q})),n.d(e,"hasFeatures",(function(){return $})),n.d(e,"getFeatures",(function(){return tt})),n.d(e,"canCompileGLGSExtension",(function(){return K})),n.d(e,"Buffer",(function(){return et.a})),n.d(e,"Shader",(function(){return at})),n.d(e,"VertexShader",(function(){return st})),n.d(e,"FragmentShader",(function(){return ut})),n.d(e,"Program",(function(){return Yt})),n.d(e,"Framebuffer",(function(){return Et})),n.d(e,"Renderbuffer",(function(){return mt})),n.d(e,"Texture2D",(function(){return pt.a})),n.d(e,"TextureCube",(function(){return Zt.a})),n.d(e,"clear",(function(){return bt})),n.d(e,"clearBuffer",(function(){return _t})),n.d(e,"FenceSync",(function(){return Kt})),n.d(e,"Query",(function(){return Qt})),n.d(e,"Sampler",(function(){return Ot})),n.d(e,"Texture3D",(function(){return $t.a})),n.d(e,"Texture2DArray",(function(){return te})),n.d(e,"TransformFeedback",(function(){return ee})),n.d(e,"VertexArrayObject",(function(){return ce})),n.d(e,"VertexArray",(function(){return le})),n.d(e,"UniformBufferLayout",(function(){return fe})),n.d(e,"_Accessor",(function(){return Gt.a})),n.d(e,"_clearBuffer",(function(){return _t})),n.d(e,"Object3D",(function(){return pe})),n.d(e,"Group",(function(){return ve})),n.d(e,"Model",(function(){return jn})),n.d(e,"AnimationLoop",(function(){return Bn})),n.d(e,"pickModels",(function(){return zn})),n.d(e,"encodePickingColor",(function(){return Gn})),n.d(e,"decodePickingColor",(function(){return Un})),n.d(e,"getNullPickingColor",(function(){return Wn})),n.d(e,"Transform",(function(){return Yn})),n.d(e,"_Attribute",(function(){return ye})),n.d(e,"_ShaderCache",(function(){return Zn})),n.d(e,"_AnimationLoopProxy",(function(){return Kn})),n.d(e,"_MultiPassRenderer",(function(){return tr})),n.d(e,"_RenderState",(function(){return $n})),n.d(e,"_Pass",(function(){return Jn})),n.d(e,"_CompositePass",(function(){return Qn})),n.d(e,"_ClearPass",(function(){return er})),n.d(e,"_RenderPass",(function(){return nr})),n.d(e,"_CopyPass",(function(){return Ir})),n.d(e,"_TexturePass",(function(){return Tr})),n.d(e,"_PickingPass",(function(){return Nr})),n.d(e,"_ShaderModulePass",(function(){return Br})),n.d(e,"_Canvas",(function(){return qr})),n.d(e,"Geometry",(function(){return _e})),n.d(e,"ConeGeometry",(function(){return or})),n.d(e,"CubeGeometry",(function(){return ar})),n.d(e,"CylinderGeometry",(function(){return hr})),n.d(e,"IcoSphereGeometry",(function(){return gr})),n.d(e,"PlaneGeometry",(function(){return vr})),n.d(e,"SphereGeometry",(function(){return yr})),n.d(e,"TruncatedConeGeometry",(function(){return ir})),n.d(e,"Cone",(function(){return br})),n.d(e,"Cube",(function(){return _r})),n.d(e,"Cylinder",(function(){return xr})),n.d(e,"IcoSphere",(function(){return wr})),n.d(e,"Plane",(function(){return Er})),n.d(e,"Sphere",(function(){return Sr})),n.d(e,"TruncatedCone",(function(){return Or})),n.d(e,"ClipSpace",(function(){return Cr})),n.d(e,"setPathPrefix",(function(){return Jr})),n.d(e,"loadFile",(function(){return Qr})),n.d(e,"loadImage",(function(){return $r})),n.d(e,"loadTexture",(function(){return ei})),n.d(e,"loadFiles",(function(){return ni})),n.d(e,"loadImages",(function(){return ri})),n.d(e,"loadTextures",(function(){return ii})),n.d(e,"loadProgram",(function(){return oi})),n.d(e,"loadModel",(function(){return ai})),n.d(e,"parseModel",(function(){return si})),n.d(e,"setDefaultShaderModules",(function(){return Ce})),n.d(e,"registerShaderModules",(function(){return Me})),n.d(e,"assembleShaders",(function(){return Ye})),n.d(e,"normalizeShaderModule",(function(){return Fr})),n.d(e,"fp32",(function(){return Qe})),n.d(e,"fp64",(function(){return rn})),n.d(e,"project",(function(){return un})),n.d(e,"lighting",(function(){return cn})),n.d(e,"dirlight",(function(){return fn})),n.d(e,"picking",(function(){return dn})),n.d(e,"diffuse",(function(){return gn})),n.d(e,"pbr",(function(){return li})),n.d(e,"assert",(function(){return j.a})),n.d(e,"log",(function(){return fi.a})),n.d(e,"global",(function(){return m.b})),n.d(e,"window",(function(){return m.d})),n.d(e,"document",(function(){return m.a})),n.d(e,"self",(function(){return m.c})),n.d(e,"isBrowser",(function(){return hi.a})),n.d(e,"isOldIE",(function(){return di.a})),n.d(e,"stubRemovedMethods",(function(){return pi.a})),n.d(e,"makeDebugContext",(function(){return _})),n.d(e,"ClipSpaceQuad",(function(){return Cr})),n.d(e,"glGet",(function(){return o.c})),n.d(e,"glKey",(function(){return o.d})),n.d(e,"glKeyType",(function(){return o.e}));var r=n(65),i=n(113),o=n(29),a=n(6),s=n(28);function u(t){var e=t.width,n=t.height,r=t.opts,i=t.onError,o=r.webgl1;if(r.webgl2&&!o)return i("headless-gl does not support WebGL2");if(!s.d)return i("Failed to create WebGL context in Node.js, headless gl not available");var a=Object(s.d)(e,n,r);return a||i("Failed to create WebGL context in Node.js, headless gl returned null")}var c,l=n(4),f=l.c&&"undefined"!=typeof document,h=f&&"complete"===document.readyState;function d(){return c||(c=f?new Promise((function(t,e){if(f&&"complete"===document.readyState)return h=!0,void t(document);window.onload=function(){h=!0,t(document)}})):Promise.resolve({})),c}function p(t){var e,n=t.canvas,r=t.width,i=t.height,o=t.onError,a=void 0===o?function(){}:o;return"string"==typeof n?(h||a("createGLContext called on canvas '".concat(n,"' before page was loaded")),e=document.getElementById(n)):e=n||function(t){var e=t.width,n=void 0===e?800:e,r=t.height,i=void 0===r?600:r,o=t.id,a=void 0===o?"gl-canvas":o,s=t.insert,u=void 0===s||s,c=document.createElement("canvas");if(c.id=a,c.style.width=Number.isFinite(n)?"".concat(n,"px"):"100%",c.style.height=Number.isFinite(i)?"".concat(i,"px"):"100%",u){var l=document.body;l.insertBefore(c,l.firstChild)}return c}({id:"lumagl-canvas",width:r,height:i,onError:a}),e}function g(t){var e=t.canvas,n=t.opts,r=void 0===n?{}:n,i=t.onError,o=void 0===i?function(t){return null}:i;function a(t){o("WebGL context: ".concat(t.statusMessage||"Unknown error"))}e.addEventListener("webglcontextcreationerror",a,!1);var s=r.webgl1,u=void 0===s||s,c=r.webgl2,l=void 0===c||c,f=null;return l&&(f=(f=f||e.getContext("webgl2",r))||e.getContext("experimental-webgl2",r)),u&&(f=(f=f||e.getContext("webgl",r))||e.getContext("experimental-webgl",r)),e.removeEventListener("webglcontextcreationerror",a,!1),f||o("Failed to create ".concat(l&&!u?"WebGL2":"WebGL"," context"))}var v=n(68),y=n(1),m=n(21);function b(t){return t.luma=t.luma||{},t.luma}function _(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.debug,r=void 0===n||n;return null===t?null:r?w(t):x(t)}function x(t){if(null===t)return null;var e=b(t);return e.realContext?e.realContext:t}function w(t){if(null===t)return null;if(!m.b.WebGLDebug)return l.g.warn('WebGL debug mode not activated. import "luma.gl/debug" to enable.')(),t;var e=b(t);if(e.realContext)return t;if(e.debugContext)return e.debugContext;var n=m.b.WebGLDebug.makeDebugContext(t,S,O);return Object.assign(function t(){Object(y.a)(this,t)}.prototype,n),e.debugContext=n,n.debug=!0,n.gl=t,l.g.info("debug context actived."),n}function E(t,e){var n=m.b.WebGLDebug.glFunctionArgsToString(t,e);return n="".concat(n.slice(0,100)).concat(n.length>100?"...":""),"gl.".concat(t,"(").concat(n,")")}function S(t,e,n){var r=m.b.WebGLDebug.glEnumToString(t),i=m.b.WebGLDebug.glFunctionArgsToString(e,n),o="".concat(r," in gl.").concat(e,"(").concat(i,")");if(l.g.throw)throw new Error(o);l.g.error(o)()}function O(t,e){var n;if(l.g.priority>=4&&(n=E(t,e),l.g.log(4,n)()),l.g.break){n=n||E(t,e);l.g.break&&l.g.break.every((function(t){return-1!==n.indexOf(t)}))}var r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){if(void 0===a.value){if(n=n||E(t,e),l.g.throw)throw new Error("Undefined argument: ".concat(n));l.g.error("Undefined argument: ".concat(n))}}}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}}var P,C=n(0),M=(P={},Object(C.a)(P,33902,{gl1:new Float32Array([1,1])}),Object(C.a)(P,33901,{gl1:new Float32Array([1,1])}),Object(C.a)(P,3379,{gl1:64,gl2:2048}),Object(C.a)(P,34076,{gl1:16}),Object(C.a)(P,34930,{gl1:8}),Object(C.a)(P,35661,{gl1:8}),Object(C.a)(P,35660,{gl1:0}),Object(C.a)(P,34024,{gl1:1}),Object(C.a)(P,36348,{gl1:8}),Object(C.a)(P,34921,{gl1:8}),Object(C.a)(P,36347,{gl1:128}),Object(C.a)(P,36349,{gl1:16}),Object(C.a)(P,3386,{gl1:new Int32Array([0,0])}),Object(C.a)(P,32883,{gl1:0,gl2:256}),Object(C.a)(P,35071,{gl1:0,gl2:256}),Object(C.a)(P,37447,{gl1:0,gl2:0}),Object(C.a)(P,36063,{gl1:0,gl2:4}),Object(C.a)(P,35379,{gl1:0,gl2:0}),Object(C.a)(P,35374,{gl1:0,gl2:0}),Object(C.a)(P,35377,{gl1:0,gl2:0}),Object(C.a)(P,34852,{gl1:0,gl2:4}),Object(C.a)(P,36203,{gl1:0,gl2:0}),Object(C.a)(P,33001,{gl1:0,gl2:0}),Object(C.a)(P,33e3,{gl1:0,gl2:0}),Object(C.a)(P,37157,{gl1:0,gl2:0}),Object(C.a)(P,35373,{gl1:0,gl2:0}),Object(C.a)(P,35657,{gl1:0,gl2:0}),Object(C.a)(P,36183,{gl1:0,gl2:0}),Object(C.a)(P,37137,{gl1:0,gl2:0}),Object(C.a)(P,34045,{gl1:0,gl2:0}),Object(C.a)(P,35978,{gl1:0,gl2:0}),Object(C.a)(P,35979,{gl1:0,gl2:0}),Object(C.a)(P,35968,{gl1:0,gl2:0}),Object(C.a)(P,35376,{gl1:0,gl2:0}),Object(C.a)(P,35375,{gl1:0,gl2:0}),Object(C.a)(P,35659,{gl1:0,gl2:0}),Object(C.a)(P,37154,{gl1:0,gl2:0}),Object(C.a)(P,35371,{gl1:0,gl2:0}),Object(C.a)(P,35658,{gl1:0,gl2:0}),Object(C.a)(P,35076,{gl1:0,gl2:-8,negative:!0}),Object(C.a)(P,35077,{gl1:0,gl2:7}),Object(C.a)(P,35380,{gl1:0,gl2:0}),P);function I(t){if(t.luma=t.luma||{},!t.luma.limits){t.luma.limits={},t.luma.webgl1MinLimits={},t.luma.webgl2MinLimits={};var e=Object(a.n)(t);for(var n in M){var r=M[n],i=r.gl1,o="gl2"in r?r.gl2:r.gl1,s=e?o:i,u="gl2"in r&&!e||"extension"in r&&!t.getExtension(r.extension)?s:t.getParameter(n);t.luma.limits[n]=u,t.luma.webgl1MinLimits[n]=i,t.luma.webgl2MinLimits[n]=o}}return t.luma.limits}function A(t){if(t.luma=t.luma||{},!t.luma.info){var e,n=t.getExtension("WEBGL_debug_renderer_info");t.luma.info=(e={},Object(C.a)(e,7936,t.getParameter(7936)),Object(C.a)(e,7937,t.getParameter(7937)),Object(C.a)(e,37445,t.getParameter(n&&n.UNMASKED_VENDOR_WEBGL||7936)),Object(C.a)(e,37446,t.getParameter(n&&n.UNMASKED_RENDERER_WEBGL||7937)),Object(C.a)(e,7938,t.getParameter(7938)),Object(C.a)(e,35724,t.getParameter(35724)),e)}return t.luma.info}function T(t){var e=I(t),n=A(t);return{vendor:n[37445]||n[7936],renderer:n[37446]||n[7937],version:n[7938],shadingLanguageVersion:n[35724],info:n,limits:e,webgl1MinLimits:t.luma.webgl1MinLimits,webgl2MinLimits:t.luma.webgl2MinLimits}}function N(t){return function(t){var e=t.getParameter(7936),n=t.getParameter(7937),r=t.getExtension("WEBGL_debug_renderer_info");return{vendor:r&&t.getParameter(r.UNMASKED_VENDOR_WEBGL||7936)||e,renderer:r&&t.getParameter(r.UNMASKED_RENDERER_WEBGL||7937)||n,vendorMasked:e,rendererMasked:n,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}(t)}var L=n(2),R=function(t){return t},k=new(function(){function t(){Object(y.a)(this,t),this.pendingQueries=new Set,this.invalidQueryType=null,this.invalidErrorMessage="",this.checkInvalid=function(){return!1}}return Object(L.a)(t,[{key:"poll",value:function(t){this.cancelInvalidQueries(t);var e=!0,n=!1,r=void 0;try{for(var i,o=this.pendingQueries.values()[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;if(a.isResultAvailable()){var s=a.getResult();this.resolveQuery(a,s)}}}catch(t){n=!0,r=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}}},{key:"setInvalidator",value:function(t){var e=t.queryType,n=t.errorMessage,r=t.checkInvalid;this.invalidQueryType=e,this.invalidErrorMessage=n,this.checkInvalid=r}},{key:"beginQuery",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:R,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:R;this.cancelInvalidQueries(t.gl),this.cancelQuery(t);var r={};return t.promise=new Promise((function(t,e){r.resolve=t,r.reject=e})),Object.assign(t.promise,r),this.pendingQueries.add(t),t.promise.then(e).catch(n)}},{key:"resolveQuery",value:function(t,e){this.pendingQueries.delete(t),t.promise.resolve(e)}},{key:"rejectQuery",value:function(t,e){this.pendingQueries.delete(t),t.promise&&t.promise.reject(new Error(e))}},{key:"deleteQuery",value:function(t){return this.rejectQuery(t,"Query was deleted before result was available")}},{key:"cancelQuery",value:function(t){return this.rejectQuery(t,"Query was canceled before result was available")}},{key:"invalidateQuery",value:function(t){t instanceof this.invalidQueryType&&this.rejectQuery(t,this.invalidErrorMessage)}},{key:"cancelInvalidQueries",value:function(t){if(this.checkInvalid(t)){var e=!0,n=!1,r=void 0;try{for(var i,o=this.pendingQueries.values()[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;this.invalidateQuery(a)}}catch(t){n=!0,r=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}}}}]),t}()),j=n(3);function F(t){return Boolean(t&&(t instanceof a.c||34962===t.ARRAY_BUFFER))}function D(t){return Boolean(t&&(t instanceof a.a||32874===t.TEXTURE_BINDING_3D))}var B={webgl2:!0,webgl1:!0,throwOnFailure:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function z(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.assign(B,{width:1,height:1},t)}function V(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e=Object.assign({},B,e),r=n.canvas,i=n.width,o=n.height,a=n.throwOnError,s=n.manageState,c=n.debug;function f(t){if(a)throw new Error(t);return null}if(l.c){var h=p({canvas:r,width:i,height:o,onError:f});t=g({canvas:h,opts:e})}else t=u({width:i,height:o,opts:e,onError:f});return t?(s&&Object(v.a)(t,{copyState:!1,log:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return l.g.log.apply(l.g,[1].concat(e))()}}),l.c&&c&&(t=_(t,{debug:c}),l.g.priority=Math.max(l.g.priority,1)),q(t),t):null}function G(t){var e=t.getExtension("STACKGL_destroy_context");e&&e.destroy()}function U(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t.canvas){var n=e.useDevicePixels&&window.devicePixelRatio||1,r="width"in e?e.width:t.canvas.clientWidth,i="height"in e?e.height:t.canvas.clientHeight;return t.canvas.width=r*n,void(t.canvas.height=i*n)}var o=t.getExtension("STACKGL_resize_drawingbuffer");o&&"width"in e&&"height"in e&&o.resize(e.width,e.height)}function W(t){k.poll(t)}function q(t){var e=D(t)?"WebGL2":"WebGL1",n=N(t),r=n?"(".concat(n.vendor,",").concat(n.renderer,")"):"",i=t.debug?" debug":"";l.g.once(0,"".concat(e).concat(i," context ").concat(r))()}var X=n(24),H={VERTEX_ARRAY_OBJECT:["OES_vertex_array_object",!0],TIMER_QUERY:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],INSTANCED_RENDERING:["ANGLE_instanced_arrays",!0],MULTIPLE_RENDER_TARGETS:["WEBGL_draw_buffers",!0],ELEMENT_INDEX_UINT32:["OES_element_index_uint",!0],BLEND_EQUATION_MINMAX:["EXT_blend_minmax",!0],COLOR_ENCODING_SRGB:["EXT_sRGB",!0],TEXTURE_DEPTH:["WEBGL_depth_texture",!0],TEXTURE_FLOAT:["OES_texture_float",!0],TEXTURE_HALF_FLOAT:["OES_texture_half_float",!0],TEXTURE_FILTER_LINEAR_FLOAT:["OES_texture_float_linear"],TEXTURE_FILTER_LINEAR_HALF_FLOAT:["OES_texture_half_float_linear"],TEXTURE_FILTER_ANISOTROPIC:["EXT_texture_filter_anisotropic"],COLOR_ATTACHMENT_RGBA32F:["WEBGL_color_buffer_float","EXT_color_buffer_float"],COLOR_ATTACHMENT_FLOAT:[!1,"EXT_color_buffer_float"],COLOR_ATTACHMENT_HALF_FLOAT:[!1,"EXT_color_buffer_half_float"],GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},Y={};Object.keys(H).forEach((function(t){Y[t]=t}));var Z={};function K(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=H[e];if(Object(j.a)(r,e),!Object(l.e)(n))return!0;if(e in Z)return Z[e];var i=r[0],o="#extension GL_".concat(i," : enable\nvoid main(void) {}"),a=t.createShader(35633);t.shaderSource(a,o),t.compileShader(a);var s=t.getShaderParameter(a,35713);return t.deleteShader(a),Z[e]=s,s}function J(t,e){var n=H[e];Object(j.a)(n,e);var r=Object(a.n)(t)&&n[1]||n[0],i="string"==typeof r?Boolean(t.getExtension(r)):r;return Object(j.a)(!1===i||!0===i),i}function Q(t,e){return $(t,e)}function $(t,e){return(e=Array.isArray(e)?e:[e]).every((function(e){return J(t,e)}))}function tt(t){if(t.luma=t.luma||{},!t.luma.caps)for(var e in t.luma.caps={},t.luma.caps.webgl2=Object(a.n)(t),H)t.luma.caps[e]=J(t,e);return t.luma.caps}var et=n(19),nt=n(9),rt=n(8),it=n(10),ot=n(26),at=function(t){function e(t,n){var r;Object(y.a)(this,e),Object(a.e)(t),Object(j.a)("string"==typeof n.source,"Shader: GLSL source code must be a JavaScript string");var i=Object(a.k)(n.source,null)||n.id||Object(l.i)("unnamed ".concat(e.getTypeName(n.shaderType)));return(r=Object(nt.a)(this,Object(rt.a)(e).call(this,t,{id:i}))).shaderType=n.shaderType,r.source=n.source,r.initialize(n),r}return Object(it.a)(e,t),Object(L.a)(e,null,[{key:"getTypeName",value:function(t){switch(t){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return Object(j.a)(!1),"unknown"}}}]),Object(L.a)(e,[{key:"initialize",value:function(t){var e=t.source,n=Object(a.k)(e,null);n&&(this.id=Object(l.i)(n)),this._compile(e)}},{key:"getParameter",value:function(t){return this.gl.getShaderParameter(this.handle,t)}},{key:"toString",value:function(){return"".concat(this.getTypeName(this.shaderType),":").concat(this.id)}},{key:"getName",value:function(){return Object(a.k)(this.source)||"unnamed-shader"}},{key:"getSource",value:function(){return this.gl.getShaderSource(this.handle)}},{key:"getTranslatedSource",value:function(){var t=this.gl.getExtension("WEBGL_debug_shaders");return t?t.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}},{key:"_compile",value:function(){if(this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){var t=this.gl.getShaderInfoLog(this.handle),e=Object(a.o)(t,this.source,this.shaderType,this.id),n=e.shaderName,r=e.errors,i=e.warnings;throw l.g.error("GLSL compilation errors in ".concat(n,"\n").concat(r))(),l.g.warn("GLSL compilation warnings in ".concat(n,"\n").concat(i))(),new Error("GLSL compilation errors in ".concat(n))}}},{key:"_deleteHandle",value:function(){this.gl.deleteShader(this.handle)}},{key:"_getOptsFromHandle",value:function(){return{type:this.getParameter(35663),source:this.getSource()}}}]),e}(ot.a),st=function(t){function e(t,n){return Object(y.a)(this,e),"string"==typeof n&&(l.g.deprecated("new FragmentShader(gl, source)","new FragmentShader(gl, {source})","6.1"),n={source:n}),Object(nt.a)(this,Object(rt.a)(e).call(this,t,Object.assign({},n,{shaderType:35633})))}return Object(it.a)(e,t),Object(L.a)(e,[{key:"_createHandle",value:function(){return this.gl.createShader(35633)}}]),e}(at),ut=function(t){function e(t,n){return Object(y.a)(this,e),"string"==typeof n&&(l.g.deprecated("new FragmentShader(gl, source)","new FragmentShader(gl, {source})","6.1"),n={source:n}),Object(nt.a)(this,Object(rt.a)(e).call(this,t,Object.assign({},n,{shaderType:35632})))}return Object(it.a)(e,t),Object(L.a)(e,[{key:"_createHandle",value:function(){return this.gl.createShader(35632)}}]),e}(at);function ct(t,e,n){return(ct="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Object(rt.a)(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}var lt,ft=n(17),ht=n(47),dt=n(13),pt=n(53),gt="EXT_color_buffer_float",vt=(lt={},Object(C.a)(lt,33189,{}),Object(C.a)(lt,33190,{gl2:!0}),Object(C.a)(lt,36012,{gl2:!0}),Object(C.a)(lt,36168,{}),Object(C.a)(lt,34041,{}),Object(C.a)(lt,35056,{gl2:!0}),Object(C.a)(lt,36013,{gl2:!0}),Object(C.a)(lt,32854,{}),Object(C.a)(lt,36194,{}),Object(C.a)(lt,32855,{}),Object(C.a)(lt,33321,{gl2:!0}),Object(C.a)(lt,33330,{gl2:!0}),Object(C.a)(lt,33329,{gl2:!0}),Object(C.a)(lt,33332,{gl2:!0}),Object(C.a)(lt,33331,{gl2:!0}),Object(C.a)(lt,33334,{gl2:!0}),Object(C.a)(lt,33333,{gl2:!0}),Object(C.a)(lt,33323,{gl2:!0}),Object(C.a)(lt,33336,{gl2:!0}),Object(C.a)(lt,33335,{gl2:!0}),Object(C.a)(lt,33338,{gl2:!0}),Object(C.a)(lt,33337,{gl2:!0}),Object(C.a)(lt,33340,{gl2:!0}),Object(C.a)(lt,33339,{gl2:!0}),Object(C.a)(lt,32849,{gl2:!0}),Object(C.a)(lt,32856,{gl2:!0}),Object(C.a)(lt,32857,{gl2:!0}),Object(C.a)(lt,36220,{gl2:!0}),Object(C.a)(lt,36238,{gl2:!0}),Object(C.a)(lt,36975,{gl2:!0}),Object(C.a)(lt,36214,{gl2:!0}),Object(C.a)(lt,36232,{gl2:!0}),Object(C.a)(lt,36226,{gl2:!0}),Object(C.a)(lt,36208,{gl2:!0}),Object(C.a)(lt,33325,{gl2:gt}),Object(C.a)(lt,33327,{gl2:gt}),Object(C.a)(lt,34842,{gl2:gt}),Object(C.a)(lt,33326,{gl2:gt}),Object(C.a)(lt,33328,{gl2:gt}),Object(C.a)(lt,34836,{gl2:gt}),Object(C.a)(lt,35898,{gl2:gt}),lt);function yt(t,e,n){var r=n[e];if(!r)return!1;var i=Object(a.n)(t)&&r.gl2||r.gl1;return"string"==typeof i?t.getExtension(i):i}var mt=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(y.a)(this,e),(n=Object(nt.a)(this,Object(rt.a)(e).call(this,t,r))).initialize(r),Object.seal(Object(ft.a)(Object(ft.a)(n))),n}return Object(it.a)(e,t),Object(L.a)(e,null,[{key:"isSupported",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.format;return!n||yt(t,n,vt)}},{key:"getSamplesForFormat",value:function(t,e){var n=e.format;return t.getInternalformatParameter(36161,n,32937)}}]),Object(L.a)(e,[{key:"initialize",value:function(t){var e=t.format,n=t.width,r=void 0===n?1:n,i=t.height,o=void 0===i?1:i,s=t.samples,u=void 0===s?0:s;return Object(j.a)(e,"Needs format"),this.gl.bindRenderbuffer(36161,this.handle),0!==u&&Object(a.n)(this.gl)?this.gl.renderbufferStorageMultisample(36161,u,e,r,o):this.gl.renderbufferStorage(36161,e,r,o),this.format=e,this.width=r,this.height=o,this.samples=u,this}},{key:"resize",value:function(t){var e=t.width,n=t.height;return e!==this.width||n!==this.height?this.initialize({width:e,height:n,format:this.format,samples:this.samples}):this}},{key:"_createHandle",value:function(){return this.gl.createRenderbuffer()}},{key:"_deleteHandle",value:function(){this.gl.deleteRenderbuffer(this.handle)}},{key:"_bindHandle",value:function(t){this.gl.bindRenderbuffer(36161,t)}},{key:"_syncHandle",value:function(t){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}},{key:"_getParameter",value:function(t){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,t)}}]),e}(ot.a);function bt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.framebuffer,r=void 0===n?null:n,i=e.color,o=void 0===i?null:i,a=e.depth,s=void 0===a?null:a,u=e.stencil,c=void 0===u?null:u,l={};r&&(l.framebuffer=r);var f=0;o&&(f|=16384,!0!==o&&(l.clearColor=o)),s&&(f|=256,!0!==s&&(l.clearDepth=s)),c&&(f|=1024,!0!==s&&(l.clearStencil=s)),Object(j.a)(0!==f,"clear: bad arguments"),Object(X.g)(t,l,(function(){t.clear(f)}))}function _t(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.framebuffer,r=void 0===n?null:n,i=e.buffer,o=void 0===i?6144:i,s=e.drawBuffer,u=void 0===s?0:s,c=e.value,l=void 0===c?[0,0,0,0]:c;Object(a.d)(t),Object(X.g)(t,{framebuffer:r},(function(){switch(o){case 6144:switch(l.constructor){case Int32Array:t.clearBufferiv(o,u,l);break;case Uint32Array:t.clearBufferuiv(o,u,l);break;case Float32Array:default:t.clearBufferfv(o,u,l)}break;case 6145:t.clearBufferfv(6145,0,[l]);break;case 6146:t.clearBufferiv(6146,0,[l]);break;case 34041:var e=Object(dt.a)(l,2),n=e[0],r=e[1];t.clearBufferfi(34041,0,n,r);break;default:Object(j.a)(!1,"clear: bad arguments")}}))}var xt=n(41);function wt(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return Object(j.a)(!1),0}}var Et=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(y.a)(this,e),(n=Object(nt.a)(this,Object(rt.a)(e).call(this,t,r))).width=null,n.height=null,n.attachments={},n.readBuffer=36064,n.drawBuffers=[36064],n.initialize(r),Object.seal(Object(ft.a)(Object(ft.a)(n))),n}return Object(it.a)(e,t),Object(L.a)(e,[{key:"MAX_COLOR_ATTACHMENTS",get:function(){return this.gl.getParameter(this.gl.MAX_COLOR_ATTACHMENTS)}},{key:"MAX_DRAW_BUFFERS",get:function(){return this.gl.getParameter(this.gl.MAX_DRAW_BUFFERS)}}],[{key:"isSupported",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.colorBufferFloat,r=e.colorBufferHalfFloat;return n&&t.getExtension(Object(a.n)(t)?"EXT_color_buffer_float":"WEBGL.color_buffer_float"),r&&t.getExtension(Object(a.n)(t)?"EXT_color_buffer_float":"EXT_color_buffer_half_float")}},{key:"getDefaultFramebuffer",value:function(t){return t.luma=t.luma||{},t.luma.defaultFramebuffer=t.luma.defaultFramebuffer||new e(t,{id:"default-framebuffer",handle:null,attachments:{}}),t.luma.defaultFramebuffer}}]),Object(L.a)(e,[{key:"initialize",value:function(t){var e=t.width,n=void 0===e?1:e,r=t.height,i=void 0===r?1:r,o=t.attachments,a=void 0===o?null:o,s=t.color,u=void 0===s||s,c=t.depth,l=void 0===c||c,f=t.stencil,h=void 0!==f&&f,d=t.check,p=void 0===d||d,g=t.readBuffer,v=t.drawBuffers;if(Object(j.a)(n>=0&&i>=0,"Width and height need to be integers"),this.width=n,this.height=i,a)for(var y in a){var m=a[y];(Array.isArray(m)?m[0]:m).resize({width:n,height:i})}else a=this._createDefaultAttachments(u,l,h,n,i);this.update({clearAttachments:!0,attachments:a,readBuffer:g,drawBuffers:v}),a&&p&&this.checkStatus()}},{key:"update",value:function(t){var e=t.attachments,n=void 0===e?{}:e,r=t.readBuffer,i=t.drawBuffers,o=t.clearAttachments,a=void 0!==o&&o,s=t.resizeAttachments,u=void 0===s||s;this.attach(n,{clearAttachments:a,resizeAttachments:u});var c=this.gl,l=c.bindFramebuffer(36160,this.handle);return r&&this._setReadBuffer(r),i&&this._setDrawBuffers(i),c.bindFramebuffer(36160,l||null),this}},{key:"resize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.width,n=t.height;if(null===this.handle)return Object(j.a)(void 0===e&&void 0===n),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;for(var r in void 0===e&&(e=this.gl.drawingBufferWidth),void 0===n&&(n=this.gl.drawingBufferHeight),e!==this.width&&n!==this.height&&l.g.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(e,"x").concat(n)),this.attachments)this.attachments[r].resize({width:e,height:n});return this.width=e,this.height=n,this}},{key:"attach",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.clearAttachments,i=void 0!==r&&r,o=n.resizeAttachments,a=void 0===o||o,s={};i&&Object.keys(this.attachments).forEach((function(t){s[t]=null})),Object.assign(s,t);var u=this.gl.bindFramebuffer(36160,this.handle);for(var c in s){Object(j.a)(void 0!==c,"Misspelled framebuffer binding point?");var l=Number(c),f=s[l],h=f;if(h)if(h instanceof mt)this._attachRenderbuffer({attachment:l,renderbuffer:h});else if(Array.isArray(f)){var d=Object(dt.a)(f,3),p=d[0],g=d[1],v=void 0===g?0:g,y=d[2],m=void 0===y?0:y;h=p,this._attachTexture({attachment:l,texture:p,layer:v,level:m})}else this._attachTexture({attachment:l,texture:h,layer:0,level:0});else this._unattach(l);a&&h&&h.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,u||null),Object.assign(this.attachments,t),Object.keys(this.attachments).filter((function(t){return!e.attachments[t]})).forEach((function(t){delete e.attachments[t]}))}},{key:"checkStatus",value:function(){var t=this.gl,e=t.bindFramebuffer(36160,this.handle),n=t.checkFramebufferStatus(36160);if(t.bindFramebuffer(36160,e||null),36053!==n)throw new Error(function(t){return(Et.STATUS||{})[t]||"Framebuffer error ".concat(t)}(n));return this}},{key:"clear",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.color,n=t.depth,r=t.stencil,i=t.drawBuffers,o=void 0===i?[]:i,a=this.gl.bindFramebuffer(36160,this.handle);return(e||n||r)&&bt(this.gl,{color:e,depth:n,stencil:r}),o.forEach((function(t,e){_t({drawBuffer:e,value:t})})),this.gl.bindFramebuffer(36160,a||null),this}},{key:"readPixels",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.x,n=void 0===e?0:e,r=t.y,i=void 0===r?0:r,o=t.width,a=void 0===o?this.width:o,s=t.height,u=void 0===s?this.height:s,c=t.format,l=void 0===c?6408:c,f=t.type,h=t.pixelArray,d=void 0===h?null:h,p=t.attachment,g=void 0===p?36064:p;this.gl;if(36064===g&&null===this.handle&&(g=1028),Object(j.a)(this.attachments[g]),f=f||this.attachments[g].type,!d){f=f||5121;var v=Object(xt.c)(f,{clamped:!1}),y=wt(l);d=d||new v(a*u*y)}f=f||Object(xt.b)(d);var m=this.gl.bindFramebuffer(36160,this.handle);return this.gl.readPixels(n,i,a,u,l,f,d),this.gl.bindFramebuffer(36160,m||null),d}},{key:"readPixelsToBuffer",value:function(t){var e=t.x,n=void 0===e?0:e,r=t.y,i=void 0===r?0:r,o=t.width,s=void 0===o?this.width:o,u=t.height,c=void 0===u?this.height:u,l=t.format,f=void 0===l?6408:l,h=t.type,d=t.buffer,p=void 0===d?null:d,g=t.byteOffset,v=void 0===g?0:g,y=this.gl;if(Object(a.d)(y),h=h||(p?p.type:5121),!p){var m=wt(f),b=function(t){switch(t){case 5121:return 1;case 33635:case 32819:case 32820:return 2;case 5126:return 4;default:return Object(j.a)(!1),0}}(h),_=v+s*c*m*b;p=new et.a(y,{bytes:_,type:h,size:m})}return p.bind({target:35051}),Object(X.g)(y,{framebuffer:this},(function(){y.readPixels(n,i,s,c,f,h,v)})),p.unbind({target:35051}),p}},{key:"copyToDataUrl",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.attachment,n=void 0===e?36064:e,r=t.maxHeight,i=void 0===r?Number.MAX_SAFE_INTEGER:r,o=this.readPixels({attachment:n}),s=this.width,u=this.height;u>i;){var c=Object(a.q)({data:o,width:s,height:u});o=c.data,s=c.width,u=c.height}Object(a.h)({data:o,width:s,height:u});var l=document.createElement("canvas");l.width=s,l.height=u;var f=l.getContext("2d"),h=f.createImageData(s,u);return h.data.set(o),f.putImageData(h,0,0),l.toDataURL()}},{key:"copyToImage",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.image,n=void 0===e?null:e,r=t.attachment,i=void 0===r?36064:r,o=t.maxHeight,a=(void 0===o&&Number.MAX_SAFE_INTEGER,this.readDataUrl({attachment:i}));return(n=n||new Image).src=a,n}},{key:"copyToTexture",value:function(t){var e=t.texture,n=t.target,r=t.xoffset,i=void 0===r?0:r,o=t.yoffset,a=void 0===o?0:o,s=t.zoffset,u=void 0===s?0:s,c=t.mipmapLevel,l=void 0===c?0:c,f=(t.attachment,t.x),h=void 0===f?0:f,d=t.y,p=void 0===d?0:d,g=t.width,v=t.height,y=this.gl,m=y.bindFramebuffer(36160,this.handle);switch(Object(j.a)(n||e),e&&(g=Number.isFinite(g)?g:e.width,v=Number.isFinite(v)?v:e.height,e.bind(0)),e.target){case 3553:case 34067:y.copyTexSubImage2D(n||e.target,l,i,a,h,p,g,v);break;case 35866:case 32879:y.copyTexSubImage3D(n||e.target,l,i,a,u,h,p,g,v)}return e&&e.unbind(),y.bindFramebuffer(36160,m||null),e}},{key:"blit",value:function(t){var e=t.srcFramebuffer,n=t.attachment,r=void 0===n?36064:n,i=t.srcX0,o=void 0===i?0:i,s=t.srcY0,u=void 0===s?0:s,c=t.srcX1,l=t.srcY1,f=t.dstX0,h=void 0===f?0:f,d=t.dstY0,p=void 0===d?0:d,g=t.dstX1,v=t.dstY1,y=t.color,m=void 0===y||y,b=t.depth,_=void 0!==b&&b,x=t.stencil,w=void 0!==x&&x,E=t.mask,S=void 0===E?0:E,O=t.filter,P=void 0===O?9728:O,C=this.gl;Object(a.d)(C),e.handle||36064!==r||(r=1028),m&&(S|=16384),_&&(S|=256),w&&(S|=1024),Object(j.a)(S),c=void 0===c?e.width:c,l=void 0===l?e.height:l,g=void 0===g?this.width:g,v=void 0===v?this.height:v;var M=C.bindFramebuffer(36009,this.handle),I=C.bindFramebuffer(36008,e.handle);return C.readBuffer(r),C.blitFramebuffer(o,u,c,l,h,p,g,v,S,P),C.readBuffer(this.readBuffer),C.bindFramebuffer(36008,I||null),C.bindFramebuffer(36009,M||null),this}},{key:"invalidate",value:function(t){var e=t.attachments,n=void 0===e?[]:e,r=t.x,i=void 0===r?0:r,o=t.y,s=void 0===o?0:o,u=t.width,c=t.height,l=this.gl;Object(a.d)(l);var f=l.bindFramebuffer(36008,this.handle);return 0===i&&0===s&&void 0===u&&void 0===c?l.invalidateFramebuffer(36008,n):l.invalidateFramebuffer(36008,n,i,s,u,c),l.bindFramebuffer(36008,f),this}},{key:"getAttachmentParameter",value:function(t,e,n){var r=this._getAttachmentParameterFallback(e);return null===r&&(this.gl.bindFramebuffer(36160,this.handle),r=this.gl.getFramebufferAttachmentParameter(36160,t,e),this.gl.bindFramebuffer(36160,null)),n&&r>1e3&&(r=Object(o.d)(this.gl,r)),r}},{key:"getAttachmentParameters",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:36064,e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[],r={},i=!0,a=!1,s=void 0;try{for(var u,c=n[Symbol.iterator]();!(i=(u=c.next()).done);i=!0){var l=u.value,f=e?Object(o.d)(this.gl,l):l;r[f]=this.getAttachmentParameter(t,l,e)}}catch(t){a=!0,s=t}finally{try{i||null==c.return||c.return()}finally{if(a)throw s}}return r}},{key:"getParameters",value:function(){for(var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=Object.keys(this.attachments),n={},r=0;r<e.length;r++){var i=e[r],a=Number(i),s=t?Object(o.d)(this.gl,a):a;n[s]=this.getAttachmentParameters(a,t)}return n}},{key:"show",value:function(){return"undefined"!=typeof window&&window.open(this.copyToDataUrl(),"luma-debug-texture"),this}},{key:"log",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(t>l.g.priority||"undefined"==typeof window)return this;e=e||"Framebuffer ".concat(this.id);var n=this.copyToDataUrl({maxHeight:100});return l.g.image({priority:t,message:e,image:n},e)(),this}},{key:"bind",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.target,n=void 0===e?36160:e;return this.gl.bindFramebuffer(n,this.handle),this}},{key:"unbind",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.target,n=void 0===e?36160:e;return this.gl.bindFramebuffer(n,null),this}},{key:"_createDefaultAttachments",value:function(t,e,n,r,i){var o,a=null;t&&((a=a||{})[36064]=new pt.a(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:r,height:i,mipmaps:!1,parameters:(o={},Object(C.a)(o,10241,9728),Object(C.a)(o,10240,9728),Object(C.a)(o,10242,33071),Object(C.a)(o,10243,33071),o)}));return e&&n?(a=a||{})[33306]=new mt(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:r,height:111}):e?(a=a||{})[36096]=new mt(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:r,height:i}):n&&Object(j.a)(!1),a}},{key:"_unattach",value:function(t){var e=this.attachments[t];e&&(e instanceof mt?this.gl.framebufferRenderbuffer(36160,t,36161,null):this.gl.framebufferTexture2D(36160,t,3553,null,0),delete this.attachments[t])}},{key:"_attachRenderbuffer",value:function(t){var e=t.attachment,n=void 0===e?36064:e,r=t.renderbuffer;this.gl.framebufferRenderbuffer(36160,n,36161,r.handle),this.attachments[n]=r}},{key:"_attachTexture",value:function(t){var e=t.attachment,n=void 0===e?36064:e,r=t.texture,i=t.layer,o=t.level,a=this.gl;switch(a.bindTexture(r.target,r.handle),r.target){case 35866:case 32879:a.framebufferTextureLayer(36160,n,r.target,o,i);break;case 34067:var s=function(t){return t<34069?t+34069:t}(i);a.framebufferTexture2D(36160,n,s,r.handle,o);break;case 3553:a.framebufferTexture2D(36160,n,3553,r.handle,o);break;default:Object(j.a)(!1,"Illegal texture type")}a.bindTexture(r.target,null),this.attachments[n]=r}},{key:"_setReadBuffer",value:function(t,e){Object(a.n)(t)?t.readBuffer(e):Object(j.a)(36064===e||1029===e,"Multiple render targets not supported"),this.readBuffer=e}},{key:"_setDrawBuffers",value:function(t,e){if(Object(a.n)(t))t.drawBuffers(e);else{var n=t.getExtension("WEBGL.draw_buffers");n?n.drawBuffersWEBGL(e):Object(j.a)(1===e.length&&(36064===e[0]||1029===e[0]),"Multiple render targets not supported")}this.drawBuffers=e}},{key:"_getAttachmentParameterFallback",value:function(t){var e=tt(this.gl);switch(t){case 36052:return e.webgl2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return e.webgl2?null:8;case 33297:return e.webgl2?null:5125;case 33296:return e.webgl2||e.EXT_sRGB?null:9729;default:return null}}},{key:"_createHandle",value:function(){return this.gl.createFramebuffer()}},{key:"_deleteHandle",value:function(){this.gl.deleteFramebuffer(this.handle)}},{key:"_bindHandle",value:function(t){return this.gl.bindFramebuffer(36160,t)}},{key:"color",get:function(){return this.attachments[36064]||null}},{key:"texture",get:function(){return this.attachments[36064]||null}},{key:"depth",get:function(){return this.attachments[36096]||this.attachments[33306]||null}},{key:"stencil",get:function(){return this.attachments[36128]||this.attachments[33306]||null}}]),e}(ot.a);Et.ATTACHMENT_PARAMETERS=[36049,36048,33296,33298,33299,33300,33301,33302,33303];var St,Ot=function(t){function e(t,n){var r;return Object(y.a)(this,e),Object(a.d)(t),r=Object(nt.a)(this,Object(rt.a)(e).call(this,t,n)),Object.seal(Object(ft.a)(Object(ft.a)(r))),r}return Object(it.a)(e,t),Object(L.a)(e,null,[{key:"isSupported",value:function(t){return Object(a.n)(t)}}]),Object(L.a)(e,[{key:"bind",value:function(t){return this.gl.bindSampler(t,this.handle),this}},{key:"unbind",value:function(t){return this.gl.bindSampler(t,null),this}},{key:"_createHandle",value:function(){return this.gl.createSampler()}},{key:"_deleteHandle",value:function(){this.gl.deleteSampler(this.handle)}},{key:"_getParameter",value:function(t){return this.gl.getSamplerParameter(this.handle,t)}},{key:"_setParameter",value:function(t,e){switch(t){case 33082:case 33083:this.gl.samplerParameterf(this.handle,t,e);break;default:this.gl.samplerParameteri(this.handle,t,e)}return this}}]),e}(ot.a),Pt=(St={},Object(C.a)(St,5126,(function(t,e,n){return t.uniform1fv(e,Nt(n,1))})),Object(C.a)(St,35664,(function(t,e,n){return t.uniform2fv(e,Nt(n,2))})),Object(C.a)(St,35665,(function(t,e,n){return t.uniform3fv(e,Nt(n,3))})),Object(C.a)(St,35666,(function(t,e,n){return t.uniform4fv(e,Nt(n,4))})),Object(C.a)(St,5124,(function(t,e,n){return t.uniform1iv(e,Lt(n,1))})),Object(C.a)(St,35667,(function(t,e,n){return t.uniform2iv(e,Lt(n,2))})),Object(C.a)(St,35668,(function(t,e,n){return t.uniform3iv(e,Lt(n,3))})),Object(C.a)(St,35669,(function(t,e,n){return t.uniform4iv(e,Lt(n,4))})),Object(C.a)(St,35670,(function(t,e,n){return t.uniform1iv(e,Lt(n,1))})),Object(C.a)(St,35671,(function(t,e,n){return t.uniform2iv(e,Lt(n,2))})),Object(C.a)(St,35672,(function(t,e,n){return t.uniform3iv(e,Lt(n,3))})),Object(C.a)(St,35673,(function(t,e,n){return t.uniform4iv(e,Lt(n,4))})),Object(C.a)(St,35674,(function(t,e,n){return t.uniformMatrix2fv(e,!1,Nt(n,4))})),Object(C.a)(St,35675,(function(t,e,n){return t.uniformMatrix3fv(e,!1,Nt(n,9))})),Object(C.a)(St,35676,(function(t,e,n){return t.uniformMatrix4fv(e,!1,Nt(n,16))})),Object(C.a)(St,35678,(function(t,e,n){return t.uniform1i(e,n)})),Object(C.a)(St,35680,(function(t,e,n){return t.uniform1i(e,n)})),Object(C.a)(St,5125,(function(t,e,n){return t.uniform1uiv(e,Rt(n,1))})),Object(C.a)(St,36294,(function(t,e,n){return t.uniform2uiv(e,Rt(n,2))})),Object(C.a)(St,36295,(function(t,e,n){return t.uniform3uiv(e,Rt(n,3))})),Object(C.a)(St,36296,(function(t,e,n){return t.uniform4uiv(e,Rt(n,4))})),Object(C.a)(St,35685,(function(t,e,n){return t.uniformMatrix2x3fv(e,!1,Nt(n,6))})),Object(C.a)(St,35686,(function(t,e,n){return t.uniformMatrix2x4fv(e,!1,Nt(n,8))})),Object(C.a)(St,35687,(function(t,e,n){return t.uniformMatrix3x2fv(e,!1,Nt(n,6))})),Object(C.a)(St,35688,(function(t,e,n){return t.uniformMatrix3x4fv(e,!1,Nt(n,12))})),Object(C.a)(St,35689,(function(t,e,n){return t.uniformMatrix4x2fv(e,!1,Nt(n,8))})),Object(C.a)(St,35690,(function(t,e,n){return t.uniformMatrix4x3fv(e,!1,Nt(n,12))})),Object(C.a)(St,35679,(function(t,e,n){return t.uniform1i(e,n)})),Object(C.a)(St,35682,(function(t,e,n){return t.uniform1i(e,n)})),Object(C.a)(St,36289,(function(t,e,n){return t.uniform1i(e,n)})),Object(C.a)(St,36292,(function(t,e,n){return t.uniform1i(e,n)})),Object(C.a)(St,36293,(function(t,e,n){return t.uniform1i(e,n)})),Object(C.a)(St,36298,(function(t,e,n){return t.uniform1i(e,n)})),Object(C.a)(St,36299,(function(t,e,n){return t.uniform1i(e,n)})),Object(C.a)(St,36300,(function(t,e,n){return t.uniform1i(e,n)})),Object(C.a)(St,36303,(function(t,e,n){return t.uniform1i(e,n)})),Object(C.a)(St,36306,(function(t,e,n){return t.uniform1i(e,n)})),Object(C.a)(St,36307,(function(t,e,n){return t.uniform1i(e,n)})),Object(C.a)(St,36308,(function(t,e,n){return t.uniform1i(e,n)})),Object(C.a)(St,36311,(function(t,e,n){return t.uniform1i(e,n)})),St),Ct={},Mt={},It={},At=[0];function Tt(t,e,n,r){1===e&&"boolean"==typeof t&&(t=t?1:0),Number.isFinite(t)&&(At[0]=t,t=At);var i=t.length;if(i%e&&l.g.warn("Uniform size should be multiples of ".concat(e),t)(),t instanceof n)return t;var o=r[i];o||(o=new n(i),r[i]=o);for(var a=0;a<i;a++)o[a]=t[a];return o}function Nt(t,e){return Tt(t,e,Float32Array,Ct)}function Lt(t,e){return Tt(t,e,Int32Array,Mt)}function Rt(t,e){return Tt(t,e,Uint32Array,It)}function kt(t){if("]"!==t[t.length-1])return{name:t,length:1,isArray:!1};var e=t.match(/([^\[]*)(\[[0-9]+\])?/);if(!e||e.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(t));return{name:e[1],length:e[2]||1,isArray:Boolean(e[2])}}function jt(t,e,n){var r=Pt[n.type];if(!r)throw new Error("Unknown GLSL uniform type ".concat(n.type));return r.bind(null,t,e)}function Ft(t,e,n){for(var r in t){var i=t[r];if((!n||Boolean(n[r]))&&!Dt(i))throw e=e?"".concat(e," "):"",console.error("".concat(e," Bad uniform ").concat(r),i),new Error("".concat(e," Bad uniform ").concat(r))}return!0}function Dt(t){return Array.isArray(t)||ArrayBuffer.isView(t)?function(t){if(0===t.length)return!1;for(var e=Math.min(t.length,16),n=0;n<e;++n)if(!Number.isFinite(t[n]))return!1;return!0}(t):!!isFinite(t)||(!0===t||!1===t||(t instanceof ht.a||t instanceof Ot||(t instanceof mt||t instanceof Et&&Boolean(t.texture))))}function Bt(t,e){if(Array.isArray(t)||ArrayBuffer.isView(t)){if(!e)return!1;var n=t.length;if(e.length!==n)return!1;for(var r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return t===e}function zt(t){return Array.isArray(t)||ArrayBuffer.isView(t)?t.slice():t}var Vt,Gt=n(48),Ut=(Vt={},Object(C.a)(Vt,5126,[5126,1,"float"]),Object(C.a)(Vt,35664,[5126,2,"vec2"]),Object(C.a)(Vt,35665,[5126,3,"vec3"]),Object(C.a)(Vt,35666,[5126,4,"vec4"]),Object(C.a)(Vt,5124,[5124,1,"int"]),Object(C.a)(Vt,35667,[5124,2,"ivec2"]),Object(C.a)(Vt,35668,[5124,3,"ivec3"]),Object(C.a)(Vt,35669,[5124,4,"ivec4"]),Object(C.a)(Vt,5125,[5125,1,"uint"]),Object(C.a)(Vt,36294,[5125,2,"uvec2"]),Object(C.a)(Vt,36295,[5125,3,"uvec3"]),Object(C.a)(Vt,36296,[5125,4,"uvec4"]),Object(C.a)(Vt,35670,[5126,1,"bool"]),Object(C.a)(Vt,35671,[5126,2,"bvec2"]),Object(C.a)(Vt,35672,[5126,3,"bvec3"]),Object(C.a)(Vt,35673,[5126,4,"bvec4"]),Object(C.a)(Vt,35674,[5126,8,"mat2"]),Object(C.a)(Vt,35685,[5126,8,"mat2x3"]),Object(C.a)(Vt,35686,[5126,8,"mat2x4"]),Object(C.a)(Vt,35675,[5126,12,"mat3"]),Object(C.a)(Vt,35687,[5126,12,"mat3x2"]),Object(C.a)(Vt,35688,[5126,12,"mat3x4"]),Object(C.a)(Vt,35676,[5126,16,"mat4"]),Object(C.a)(Vt,35689,[5126,16,"mat4x2"]),Object(C.a)(Vt,35690,[5126,16,"mat4x3"]),Vt);function Wt(t){switch(t){case 0:return 0;case 1:case 3:case 2:return 1;case 4:case 5:case 6:return 4;default:return Object(j.a)(!1),0}}function qt(t){var e=Ut[t];if(!e)return null;var n=Object(dt.a)(e,2);return{type:n[0],components:n[1]}}function Xt(t,e){switch(t){case 5120:case 5121:case 5122:case 5123:t=5126}for(var n in Ut){var r=Object(dt.a)(Ut[n],3),i=r[0],o=r[1],a=r[2];if(i===t&&o===e)return{glType:n,name:a}}return null}var Ht=function(){function t(e){Object(y.a)(this,t),this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}return Object(L.a)(t,[{key:"getAttributeInfo",value:function(t){var e=Number(t);return Number.isFinite(e)?this.attributeInfos[e]:this.attributeInfosByName[t]||null}},{key:"getAttributeLocation",value:function(t){var e=this.getAttributeInfo(t);return e?e.location:-1}},{key:"getAttributeAccessor",value:function(t){var e=this.getAttributeInfo(t);return e?e.accessor:null}},{key:"getVaryingInfo",value:function(t){var e=Number(t);return Number.isFinite(e)?this.varyingInfos[e]:this.varyingInfosByName[t]||null}},{key:"getVaryingIndex",value:function(t){var e=this.getVaryingInfo();return e?e.location:-1}},{key:"getVaryingAccessor",value:function(t){var e=this.getVaryingInfo();return e?e.accessor:null}},{key:"_readAttributesFromProgram",value:function(t){for(var e=t.gl,n=e.getProgramParameter(t.handle,35721),r=0;r<n;r++){var i=e.getActiveAttrib(t.handle,r),o=i.name,a=i.type,s=i.size,u=e.getAttribLocation(t.handle,o);u>=0&&this._addAttribute(u,o,a,s)}this.attributeInfos.sort((function(t,e){return t.location-e.location}))}},{key:"_readVaryingsFromProgram",value:function(t){var e=t.gl;if(Object(a.n)(e)){for(var n=e.getProgramParameter(t.handle,35971),r=0;r<n;r++){var i=e.getTransformFeedbackVarying(t.handle,r),o=i.name,s=i.type,u=i.size;this._addVarying(r,o,s,u)}this.varyingInfos.sort((function(t,e){return t.location-e.location}))}}},{key:"_addAttribute",value:function(t,e,n,r){var i=qt(n),o={type:i.type,size:r*i.components};this._inferProperties(t,e,o);var a={location:t,name:e,accessor:new Gt.a(o)};this.attributeInfos.push(a),this.attributeInfosByName[a.name]=a}},{key:"_inferProperties",value:function(t,e,n){/instance/i.test(e)&&(n.divisor=1)}},{key:"_addVarying",value:function(t,e,n,r){var i=qt(n),o=i.type,a=i.components,s={location:t,name:e,accessor:new Gt.a({type:o,size:r*a})};this.varyingInfos.push(s),this.varyingInfosByName[s.name]=s}}]),t}(),Yt=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(y.a)(this,e),(n=Object(nt.a)(this,Object(rt.a)(e).call(this,t,r))).stubRemovedMethods("Program","v6.0",["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"]),n._isCached=!1,n.initialize(r),Object.seal(Object(ft.a)(Object(ft.a)(n))),n._setId(r.id),n}return Object(it.a)(e,t),Object(L.a)(e,[{key:"initialize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.vs,n=t.fs,r=t.varyings,i=t.bufferMode,o=void 0===i?35981:i;return this.vs="string"==typeof e?new st(this.gl,{id:"".concat(t.id,"-vs"),source:e}):e,this.fs="string"==typeof n?new ut(this.gl,{id:"".concat(t.id,"-fs"),source:n}):n,Object(j.a)(this.vs instanceof st),Object(j.a)(this.fs instanceof ut),this.uniforms={},this.samplers={},r&&(Object(a.d)(this.gl),this.varyings=r,this.gl.transformFeedbackVaryings(this.handle,r,o)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new Ht(this),this.setProps(t)}},{key:"delete",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._isCached?this:ct(Object(rt.a)(e.prototype),"delete",this).call(this,t)}},{key:"setProps",value:function(t){return"uniforms"in t&&this.setUniforms(t.uniforms,t.samplers),this}},{key:"draw",value:function(t){var e=this,n=t.logPriority,r=t.drawMode,i=void 0===r?4:r,s=t.vertexCount,u=t.offset,c=void 0===u?0:u,f=t.start,h=t.end,d=t.isIndexed,p=void 0!==d&&d,g=t.indexType,v=void 0===g?5123:g,y=t.isInstanced,m=void 0!==y&&y,b=t.instanceCount,_=void 0===b?0:b,x=t.vertexArray,w=void 0===x?null:x,E=t.transformFeedback,S=t.framebuffer,O=t.parameters,P=void 0===O?{}:O,C=t.uniforms,M=void 0===C?{}:C,I=t.samplers,A=void 0===I?{}:I;if(void 0!==n){var T=S?S.id:"default",N="mode=".concat(Object(o.a)(this.gl,i)," verts=").concat(s," ")+"instances=".concat(_," indexType=").concat(Object(o.a)(this.gl,v)," ")+"isInstanced=".concat(m," isIndexed=").concat(p," ")+"Framebuffer=".concat(T);l.g.log(n,N)()}return this.gl.useProgram(this.handle),Object(j.a)(w),w.bindForDraw(s,_,(function(){if(M&&(l.g.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)"),e.setUniforms(M,A)),e._bindTextures(),void 0!==S&&(P=Object.assign({},P,{framebuffer:S})),E){var t=Wt(i);E.begin(t)}Object(X.g)(e.gl,P,(function(){p&&m?e.gl.drawElementsInstanced(i,s,v,c,_):p&&Object(a.n)(e.gl)&&!isNaN(f)&&!isNaN(h)?e.gl.drawRangeElements(i,f,h,s,v,c):p?e.gl.drawElements(i,s,v,c):m?e.gl.drawArraysInstanced(i,c,s,_):e.gl.drawArrays(i,c,s)})),E&&E.end()})),this}},{key:"setSamplers",value:function(t){Object.assign(this.samplers,t)}},{key:"setUniforms",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},r=!1,i={};for(var o in t)Bt(this.uniforms[o],t[o])||(r=!0,i[o]=t[o],this.uniforms[o]=zt(t[o]));return r&&(n(),Ft(i,this.id,this._uniformSetters),Object.assign(this.samplers,e),this._setUniforms(i)),this}},{key:"_bindTextures",value:function(){for(var t in this.uniforms){var e=this._uniformSetters[t];if(e&&void 0!==e.textureIndex){var n=this.uniforms[t],r=this.samplers[t];n instanceof Et&&(n=n.texture),n instanceof ht.a&&n.bind(e.textureIndex),r&&r.bind(e.textureIndex)}}}},{key:"_setUniforms",value:function(t){for(var e in this.gl.useProgram(this.handle),t){var n=t[e],r=this._uniformSetters[e];if(r)if(n instanceof Et&&(n=n.texture),n instanceof ht.a){void 0===r.textureIndex&&(r.textureIndex=this._textureIndexCounter++);var i=n,o=r.textureIndex;i.bind(o),r(o)}else r(n)}return this}},{key:"_createHandle",value:function(){return this.gl.createProgram()}},{key:"_deleteHandle",value:function(){this.gl.deleteProgram(this.handle)}},{key:"_getOptionsFromHandle",value:function(t){var e=this.gl.getAttachedShaders(t),n={},r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:n.vs=new st({handle:u});break;case 35632:n.fs=new ut({handle:u})}}}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}},{key:"_getParameter",value:function(t){return this.gl.getProgramParameter(this.handle,t)}},{key:"_setId",value:function(t){if(!t){var e=this._getName();this.id=Object(l.i)(e)}}},{key:"_getName",value:function(){var t=this.vs.getName()||this.fs.getName();return t=(t=t.replace(/shader/i,""))?"".concat(t,"-program"):"program"}},{key:"_compileAndLink",value:function(){var t=this.gl;if((t.attachShader(this.handle,this.vs.handle),t.attachShader(this.handle,this.fs.handle),l.g.time(4,"linkProgram for ".concat(this._getName()))(),t.linkProgram(this.handle),l.g.timeEnd(4,"linkProgram for ".concat(this._getName()))(),t.debug||l.g.priority>0)&&(t.validateProgram(this.handle),!t.getProgramParameter(this.handle,35714)))throw new Error("Error linking: ".concat(t.getProgramInfoLog(this.handle)))}},{key:"_readUniformLocationsFromLinkedProgram",value:function(){var t=this.gl;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(var e=0;e<this._uniformCount;e++){var n=this.gl.getActiveUniform(this.handle,e),r=kt(n.name),i=r.name,o=(r.isArray,t.getUniformLocation(this.handle,i));this._uniformSetters[i]=jt(t,o,n)}this._textureIndexCounter=0}},{key:"reset",value:function(){}},{key:"getActiveUniforms",value:function(t,e){return this.gl.getActiveUniforms(this.handle,t,e)}},{key:"getUniformBlockIndex",value:function(t){return this.gl.getUniformBlockIndex(this.handle,t)}},{key:"getActiveUniformBlockParameter",value:function(t,e){return this.gl.getActiveUniformBlockParameter(this.handle,t,e)}},{key:"uniformBlockBinding",value:function(t,e){this.gl.uniformBlockBinding(this.handle,t,e)}}]),e}(ot.a),Zt=n(86),Kt=function(t){function e(t,n){var r;return Object(y.a)(this,e),Object(a.d)(t),(r=Object(nt.a)(this,Object(rt.a)(e).call(this,t,n))).promise=null,Object.seal(Object(ft.a)(Object(ft.a)(r))),r}return Object(it.a)(e,t),Object(L.a)(e,[{key:"wait",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.flags,n=void 0===e?0:e,r=t.timeout,i=void 0===r?-1:r;return this.gl.waitSync(this.handle,n,i),this}},{key:"clientWait",value:function(t){var e=t.flags,n=void 0===e?1:e,r=t.timeout,i=this.gl.clientWaitSync(this.handle,n,r);return i}},{key:"cancel",value:function(){k.cancelQuery(this)}},{key:"isSignaled",value:function(){return 37145===this.getParameter(37140)}},{key:"isResultAvailable",value:function(){return this.isSignaled()}},{key:"getResult",value:function(){return this.isSignaled()}},{key:"getParameter",value:function(t){return this.gl.getSyncParameter(this.handle,t)}},{key:"_createHandle",value:function(){return this.gl.fenceSync(37143,0)}},{key:"_deleteHandle",value:function(){k.deleteQuery(this),this.gl.deleteSync(this.handle)}}]),e}(ot.a),Jt=function(t){return t},Qt=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(y.a)(this,e),n=Object(nt.a)(this,Object(rt.a)(e).call(this,t,r));var i=r.onComplete,o=void 0===i?Jt:i,a=r.onError,s=void 0===a?Jt:a;return n.target=null,n.onComplete=o,n.onError=s,n.promise=null,Object.seal(Object(ft.a)(Object(ft.a)(n))),n}return Object(it.a)(e,t),Object(L.a)(e,null,[{key:"isSupported",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=Object(a.n)(t),r=$(t,Y.TIMER_QUERY),i=n||r,o=!0,s=!1,u=void 0;try{for(var c,l=e[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var f=c.value;switch(f){case"queries":i=i&&n;break;case"timers":i=i&&r;break;case"timestamps":var h=r?t.getQuery(36392,34916):0;i=i&&h>0;break;default:Object(j.a)(!1)}}}catch(t){s=!0,u=t}finally{try{o||null==l.return||l.return()}finally{if(s)throw u}}return i}}]),Object(L.a)(e,[{key:"beginTimeElapsedQuery",value:function(){return this.begin(35007)}},{key:"beginOcclusionQuery",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.conservative,n=void 0!==e&&e;return this.begin(n?36202:35887)}},{key:"beginTransformFeedbackQuery",value:function(){return this.begin(35976)}},{key:"getTimestamp",value:function(){k.beginQuery(this,this.onComplete,this.onError);try{this.gl.queryCounter(this.handle,36392)}catch(t){k.rejectQuery(this,'Timer queries require "EXT_disjoint_timer_query" extension')}return this}},{key:"begin",value:function(t){k.beginQuery(this,this.onComplete,this.onError),this.target=t;try{this.gl.beginQuery(this.target,this.handle)}catch(t){k.rejectQuery(this,"Query not supported")}return this}},{key:"end",value:function(){return this.target&&(this.gl.endQuery(this.target),this.target=null),this}},{key:"cancel",value:function(){return this.end(),k.cancelQuery(this),this}},{key:"isResultAvailable",value:function(){return this.gl.getQueryParameter(this.handle,34919)}},{key:"getResult",value:function(){var t=this.gl.getQueryParameter(this.handle,34918);return Number.isFinite(t)?t/1e6:0}},{key:"_createHandle",value:function(){return e.isSupported(this.gl)?this.gl.createQuery():null}},{key:"_deleteHandle",value:function(){k.deleteQuery(this),this.gl.deleteQuery(this.handle)}}],[{key:"poll",value:function(t){k.poll(t)}}]),e}(ot.a);k.setInvalidator({queryType:Qt,errorMessage:"Disjoint GPU operation invalidated timer queries",checkInvalid:function(t){return t.getParameter(36795)}});var $t=n(133),te=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};throw Object(y.a)(this,e),Object(nt.a)(this,Object(rt.a)(e).call(this,t,n)),new Error("Texture2DArray not yet implemented")}return Object(it.a)(e,t),Object(L.a)(e,null,[{key:"isSupported",value:function(t){return Object(a.n)(t)}}]),e}(ht.a),ee=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(y.a)(this,e),Object(a.d)(t),(n=Object(nt.a)(this,Object(rt.a)(e).call(this,t,r))).initialize(r),n.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(Object(ft.a)(Object(ft.a)(n))),n}return Object(it.a)(e,t),Object(L.a)(e,null,[{key:"isSupported",value:function(t){return Object(a.n)(t)}}]),Object(L.a)(e,[{key:"initialize",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,Object(l.d)(this.buffers)||this.bind((function(){return t._unbindBuffers()})),this.setProps(e),this}},{key:"setProps",value:function(t){"program"in t&&(this.configuration=t.program&&t.program.configuration),"configuration"in t&&(this.configuration=t.configuration),"bindOnUse"in t&&(t=t.bindOnUse),"buffers"in t&&this.setBuffers(t.buffers)}},{key:"setBuffers",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.bind((function(){for(var n in e)t.setBuffer(n,e[n])})),this}},{key:"setBuffer",value:function(t,e){var n=this,r=this._getVaryingIndex(t),i=this._getBufferParams(e),o=i.buffer,a=i.sizeInBytes,s=i.offsetInBytes;return r<0?(this.unused[t]=o,l.g.warn((function(){return"".concat(n.id," unused varying buffer ").concat(t)}))(),this):(this.buffers[r]=e,this.bindOnUse||this._bindBuffer(r,o,s,a),this)}},{key:"begin",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(t),this}},{key:"end",value:function(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}},{key:"_getBufferParams",value:function(t){var e,n,r;return t instanceof et.a==!1?(r=t.buffer,n=t.sizeInBytes,e=t.offsetInBytes):r=t,void 0===e&&void 0===n||(e=e||0,n=n||r.byteLength-e),{buffer:r,offsetInBytes:e,sizeInBytes:n}}},{key:"_getVaryingInfo",value:function(t){return this.configuration&&this.configuration.getVaryingInfo(t)}},{key:"_getVaryingIndex",value:function(t){if(this.configuration)return this.configuration.getVaryingInfo(t).location;var e=Number(t);return Number.isFinite(e)?e:-1}},{key:"_bindBuffers",value:function(){if(this.bindOnUse)for(var t in this.buffers){var e=this._getBufferParams(this.buffers[t]),n=e.buffer,r=e.sizeInBytes,i=e.offsetInBytes;this._bindBuffer(t,n,i,r)}}},{key:"_unbindBuffers",value:function(){if(this.bindOnUse)for(var t in this.buffers)this._bindBuffer(t,null)}},{key:"_bindBuffer",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0,i=e&&e.handle;return i&&void 0!==r?this.gl.bindBufferRange(35982,t,i,n,r):this.gl.bindBufferBase(35982,t,i),this}},{key:"_createHandle",value:function(){return this.gl.createTransformFeedback()}},{key:"_deleteHandle",value:function(){this.gl.deleteTransformFeedback(this.handle)}},{key:"_bindHandle",value:function(t){this.gl.bindTransformFeedback(36386,this.handle)}}]),e}(ot.a),ne=null;function re(t,e){var n;return new t((n=t.BYTES_PER_ELEMENT*e,(!ne||ne.byteLength<n)&&(ne=new ArrayBuffer(n)),ne),0,e)}var ie=n(43),oe=n(135),ae=n(136);function se(t){if(!t&&!Object(oe.a)())return"Node";if(Object(ae.a)(t))return"Electron";var e="undefined"!=typeof navigator?navigator:{},n=t||e.userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";var r=-1!==n.indexOf("MSIE "),i=-1!==n.indexOf("Trident/");return r||i?"IE":ie.b.chrome?"Chrome":ie.b.safari?"Safari":ie.b.mozInnerScreenX?"Firefox":"Unknown"}var ue="elements must be GL.ELEMENT_ARRAY_BUFFER",ce=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(y.a)(this,e);var i=r.id||r.program&&r.program.id;return(n=Object(nt.a)(this,Object(rt.a)(e).call(this,t,Object.assign({},r,{id:i})))).hasVertexArrays=e.isSupported(t),n.buffer=null,n.bufferValue=null,n.initialize(r),Object.seal(Object(ft.a)(Object(ft.a)(n))),n}return Object(it.a)(e,t),Object(L.a)(e,null,[{key:"isSupported",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.constantAttributeZero?Object(a.n)(t)||"Chrome"===se():Object(a.n)(t)||t.getExtension("OES_vertex_array_object")}},{key:"getDefaultArray",value:function(t){return t.luma=t.luma||{},t.luma.defaultVertexArray||(t.luma.defaultVertexArray=new e(t,{handle:null})),t.luma.defaultVertexArray}},{key:"getMaxAttributes",value:function(t){return e.MAX_ATTRIBUTES=e.MAX_ATTRIBUTES||t.getParameter(34921),e.MAX_ATTRIBUTES}},{key:"setConstant",value:function(t,n,r){switch(r.constructor){case Float32Array:e._setConstantFloatArray(t,n,r);break;case Int32Array:e._setConstantIntArray(t,n,r);break;case Uint32Array:e._setConstantUintArray(t,n,r);break;default:Object(l.a)(!1)}}}]),Object(L.a)(e,[{key:"delete",value:function(){ct(Object(rt.a)(e.prototype),"delete",this).call(this),this.buffer&&this.buffer.delete()}},{key:"initialize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.setProps(t)}},{key:"setProps",value:function(t){return this}},{key:"setElementBuffer",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Object(l.a)(!e||34963===e.target,ue),this.bind((function(){t.gl.bindBuffer(34963,e?e.handle:null)})),this}},{key:"setBuffer",value:function(t,e,n){if(34963===e.target)return this.setElementBuffer(e,n);var r=n.size,i=n.type,o=n.stride,s=n.offset,u=n.normalized,c=n.integer,f=n.divisor,h=this.gl;return t=Number(t),this.bind((function(){h.bindBuffer(34962,e.handle),c?(Object(l.a)(Object(a.n)(h)),h.vertexAttribIPointer(t,r,i,o,s)):h.vertexAttribPointer(t,r,i,u,o,s),h.enableVertexAttribArray(t),h.vertexAttribDivisor(t,f||0)})),this}},{key:"enable",value:function(t){var n=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=!r&&0===t&&!e.isSupported(this.gl,{constantAttributeZero:!0});return i||(t=Number(t),this.bind((function(){return r?n.gl.enableVertexAttribArray(t):n.gl.disableVertexAttribArray(t)}))),this}},{key:"getConstantBuffer",value:function(t,e,n){var r=this._normalizeConstantArrayValue(e,n),i=r.byteLength*t,o=r.length*t,a=!this.buffer;if(this.buffer=this.buffer||new et.a(this.gl,i),a=(a=a||this.buffer.setByteLength(i))||!this._compareConstantArrayValues(r,this.bufferValue)){var s=re(e.constructor,o);!function(t){for(var e=t.target,n=t.source,r=t.start,i=void 0===r?0:r,o=t.count,a=void 0===o?1:o,s=n.length,u=a*s,c=0,l=i;c<s;c++)e[l++]=n[c];for(;c<u;)c<u-c?(e.copyWithin(i+c,i,i+c),c*=2):(e.copyWithin(i+c,i,i+u-c),c=u)}({target:s,source:r,start:0,count:o}),this.buffer.subData(s),this.bufferValue=e}return this.buffer}},{key:"_normalizeConstantArrayValue",value:function(t,e){return Array.isArray(t)?new Float32Array(t):t}},{key:"_compareConstantArrayValues",value:function(t,e){if(!t||!e||t.length!==e.length||t.constructor!==e.constructor)return!1;for(var n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}},{key:"_createHandle",value:function(){return this.hasVertexArrays=e.isSupported(this.gl),this.hasVertexArrays?this.gl.createVertexArray():null}},{key:"_deleteHandle",value:function(t){return this.hasVertexArrays&&this.gl.deleteVertexArray(t),[this.elements]}},{key:"_bindHandle",value:function(t){this.hasVertexArrays&&this.gl.bindVertexArray(t)}},{key:"_getParameter",value:function(t,e){var n=this,r=e.location;return Object(l.a)(Number.isFinite(r)),this.bind((function(){switch(t){case 34373:return n.gl.getVertexAttribOffset(r,t);default:return n.gl.getVertexAttrib(r,t)}}))}},{key:"MAX_ATTRIBUTES",get:function(){return e.getMaxAttributes(this.gl)}}],[{key:"_setConstantFloatArray",value:function(t,e,n){switch(n.length){case 1:t.vertexAttrib1fv(e,n);break;case 2:t.vertexAttrib2fv(e,n);break;case 3:t.vertexAttrib3fv(e,n);break;case 4:t.vertexAttrib4fv(e,n);break;default:Object(l.a)(!1)}}},{key:"_setConstantIntArray",value:function(t,e,n){switch(Object(l.a)(Object(a.n)(t)),n.length){case 1:t.vertexAttribI1iv(e,n);break;case 2:t.vertexAttribI2iv(e,n);break;case 3:t.vertexAttribI3iv(e,n);break;case 4:t.vertexAttribI4iv(e,n);break;default:Object(l.a)(!1)}}},{key:"_setConstantUintArray",value:function(t,e,n){switch(Object(l.a)(Object(a.n)(t)),n.length){case 1:t.vertexAttribI1uiv(e,n);break;case 2:t.vertexAttribI2uiv(e,n);break;case 3:t.vertexAttribI3uiv(e,n);break;case 4:t.vertexAttribI4uiv(e,n);break;default:Object(l.a)(!1)}}}]),e}(ot.a),le=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(y.a)(this,t);var r=n.id||n.program&&n.program.id;this.id=r,this.gl=e,this.configuration=null,this.elements=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.vertexArrayObject=ce.isSupported(e)?new ce(e):ce.getDefaultArray(e),Object(l.h)(this,"VertexArray","v6.0",["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"]),this.initialize(n),Object.seal(this)}return Object(L.a)(t,[{key:"delete",value:function(){this.buffer&&this.buffer.delete()}},{key:"initialize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(t)}},{key:"reset",value:function(){this.elements=null;var t=this.vertexArrayObject.MAX_ATTRIBUTES;return this.values=new Array(t).fill(null),this.accessors=new Array(t).fill(null),this.unused={},this.drawParams=null,this}},{key:"setProps",value:function(t){return"program"in t&&(this.configuration=t.program&&t.program.configuration),"configuration"in t&&(this.configuration=t.configuration),"attributes"in t&&this.setAttributes(t.attributes),"elements"in t&&this.setElementBuffer(t.elements),"bindOnUse"in t&&(t=t.bindOnUse),this}},{key:"clearDrawParams",value:function(){this.drawParams=null}},{key:"getDrawParams",value:function(t){return this.drawParams=this.drawParams||this._updateDrawParams(),Object.assign({},this.drawParams,t)}},{key:"setAttributes",value:function(t){var e=this;return this.vertexArrayObject.bind((function(){for(var n in t){var r=t[n];if(r instanceof et.a)e.setBuffer(n,r);else if(Array.isArray(r)&&r.length&&r[0]instanceof et.a){var i=r[0],o=r[1];e.setBuffer(n,i,o)}else{if(!ArrayBuffer.isView(r)&&!Array.isArray(r))throw new Error("VertexArray: attributes must be Buffers or constants (i.e. typed array)");e.setConstant(n,r)}}e.gl.bindBuffer(34962,null)})),this}},{key:"setElementBuffer",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.elements=t,this.clearDrawParams(),this.vertexArrayObject.isDefaultArray||this.vertexArrayObject.setElementBuffer(t,e),this}},{key:"setBuffer",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(34963===e.target)return this.setElementBuffer(e);var r=this._resolveLocationAndAccessor(t,e,e.accessor,n),i=r.location,o=r.accessor;return i>=0&&(this.values[i]=e,this.accessors[i]=o,this.clearDrawParams(),this.vertexArrayObject.isDefaultArray||this.vertexArrayObject.setBuffer(i,e,o)),this}},{key:"setConstant",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=this._resolveLocationAndAccessor(t,e,n),i=r.location,o=r.accessor;return i>=0&&(e=this.vertexArrayObject._normalizeConstantArrayValue(e,o),this.values[i]=e,this.accessors[i]=o,this.clearDrawParams(),this.vertexArrayObject.isDefaultArray||this.vertexArrayObject.enable(i,!1)),this}},{key:"unbindBuffers",value:function(){var t=this;return this.vertexArrayObject.bind((function(){t.elements&&t.setElementBuffer(null),t.buffer=t.buffer||new et.a(t.gl,{size:4});for(var e=0;e<t.vertexArrayObject.MAX_ATTRIBUTES;e++)t.values[e]instanceof et.a&&(t.gl.disableVertexAttribArray(e),t.gl.bindBuffer(34962,t.buffer.handle),t.gl.vertexAttribPointer(e,1,5126,!1,0,0))})),this}},{key:"bindBuffers",value:function(){var t=this;return this.vertexArrayObject.bind((function(){t.elements&&t.setElementBuffer(t.elements);for(var e=0;e<t.vertexArrayObject.MAX_ATTRIBUTES;e++){var n=t.values[e];n instanceof et.a&&t.setBuffer(e,n)}})),this}},{key:"bindForDraw",value:function(t,e,n){var r,i=this;return this.vertexArrayObject.bind((function(){i._setConstantAttributes(t,e),i.vertexArrayObject.hasVertexArrays||i.bindBuffers(),r=n(),i.vertexArrayObject.hasVertexArrays||i.unbindBuffers()})),r}},{key:"_resolveLocationAndAccessor",value:function(t,e,n,r){var i=this,o=this._getAttributeIndex(t);if(!Number.isFinite(o)||o<0)return this.unused[t]=e,l.g.once(3,(function(){return"unused value ".concat(t," in ").concat(i.id)}))(),this;var a=this._getAttributeInfo(t),s=Gt.a.resolve(a.accessor,n,r),u=s.size,c=s.type;return Object(l.a)(Number.isFinite(u)&&Number.isFinite(c)),{location:o,accessor:s}}},{key:"_getAttributeInfo",value:function(t){return this.configuration&&this.configuration.getAttributeInfo(t)}},{key:"_getAttributeIndex",value:function(t){if(this.configuration)return this.configuration.getAttributeLocation(t);var e=Number(t);return Number.isFinite(e)?e:-1}},{key:"_setConstantAttributes",value:function(t,e){var n=Math.max(0|t,0|e),r=this.values[0];ArrayBuffer.isView(r)&&this._setConstantAttributeZero(r,n);for(var i=1;i<this.vertexArrayObject.MAX_ATTRIBUTES;i++)r=this.values[i],ArrayBuffer.isView(r)&&this._setConstantAttribute(i,r)}},{key:"_setConstantAttributeZero",value:function(t,e){if(ce.isSupported(this.gl,{constantAttributeZero:!0}))this._setConstantAttribute(0,t);else{var n=this.vertexArrayObject.getConstantBuffer(e,t);this.vertexArrayObject.setBuffer(0,n,this.accessors[0])}}},{key:"_setConstantAttribute",value:function(t,e){ce.setConstant(this.gl,t,e),this.vertexArrayObject.isDefault&&this.vertexArrayObject.enable(t,!1)}},{key:"_updateDrawParams",value:function(){for(var t={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0},e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this._updateDrawParamsForLocation(t,e);return this.elements&&(t.elementCount=this.elements.getElementCount(this.elements.accessor),t.isIndexed=!0,t.indexType=this.elements.accessor.type),t.indexCount===1/0&&(t.indexCount=0),t.vertexCount===1/0&&(t.vertexCount=0),t.instanceCount===1/0&&(t.instanceCount=0),t}},{key:"_updateDrawParamsForLocation",value:function(t,e){var n=this.values[e],r=this.accessors[e];if(n){var i=r.divisor>0;if(t.isInstanced=t.isInstanced||i,n instanceof et.a){var o=n;if(i){var a=o.getVertexCount(r);t.instanceCount=Math.min(t.instanceCount,a)}else{var s=o.getVertexCount(r);t.vertexCount=Math.min(t.vertexCount,s)}}}}},{key:"setElements",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return l.g.deprecated("setElements","setElementBuffer"),this.setElementBuffer(t,e)}}]),t}(),fe=function(){function t(e){var n;for(var r in Object(y.a)(this,t),this.layout={},this.size=0,e)this._addUniform(r,e[r]);var i=new Float32Array(this.size);this.typedArray=(n={},Object(C.a)(n,5126,i),Object(C.a)(n,5124,new Int32Array(i.buffer)),Object(C.a)(n,5125,new Uint32Array(i.buffer)),n)}return Object(L.a)(t,[{key:"getBytes",value:function(){return 4*this.size}},{key:"getData",value:function(){return this.typedArray[5126]}},{key:"getSubData",value:function(t){var e,n;if(void 0===t)e=this.data,n=0;else{var r=this.offsets[t],i=r+this.sizes[t];e=this.data.subarray(r,i),n=4*r}return{data:e,offset:n}}},{key:"setUniforms",value:function(t){for(var e in t)this._setValue(e,t[e]);return this}},{key:"_setValue",value:function(t,e){var n=this.layout[t];Object(j.a)(n,"UniformLayoutStd140 illegal argument");var r=this.typedArray[n.type];1===n.size?r[n.offset]=e:r.set(e,n.offset)}},{key:"_addUniform",value:function(t,e){var n=qt(e);Object(j.a)(n,"UniformBufferLayout illegal argument");var r=n.type,i=n.components;this.size=this._alignTo(this.size,i);var o=this.size;this.size+=i,this.layout[t]={type:r,size:i,offset:o}}},{key:"_alignTo",value:function(t,e){switch(e){case 1:return t;case 2:return t+t%2;default:return t+(4-t%4)%4}}}]),t}(),he=n(103),de=n(556),pe=function(){function t(e){var n=e.id;e.display;Object(y.a)(this,t),this.id=n||Object(l.i)(this.constructor.name),this.display=!0,this.position=new he.a,this.rotation=new he.a,this.scale=new he.a(1,1,1),this.matrix=new de.a,this.userData={}}return Object(L.a)(t,[{key:"toString",value:function(){return"{id: ".concat(this.id,", children: ").concat(this.children,")}")}},{key:"setPosition",value:function(t){return Object(j.a)(3===t.length,"setPosition requires vector argument"),this.position=t,this}},{key:"setRotation",value:function(t){return Object(j.a)(3===t.length,"setRotation requires vector argument"),this.rotation=t,this}},{key:"setScale",value:function(t){return Object(j.a)(3===t.length,"setScale requires vector argument"),this.scale=t,this}},{key:"setMatrixComponents",value:function(t){var e=t.position,n=t.rotation,r=t.scale,i=t.update,o=void 0===i||i;return e&&this.setPosition(e),n&&this.setRotation(n),r&&this.setScale(r),o&&this.updateMatrix(),this}},{key:"updateMatrix",value:function(){var t=this.position,e=this.rotation,n=this.scale;return this.matrix.identity(),this.matrix.translate(t),this.matrix.rotateXYZ(e),this.matrix.scale(n),this}},{key:"update",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.position,n=t.rotation,r=t.scale;return e&&this.setPosition(e),n&&this.setRotation(n),r&&this.setScale(r),this.updateMatrix(),this}},{key:"getCoordinateUniforms",value:function(t,e){Object(j.a)(t),e=e||this.matrix;var n=new de.a(t).multiplyRight(e),r=n.invert(),i=r.transpose();return{viewMatrix:t,modelMatrix:e,objectMatrix:e,worldMatrix:n,worldInverseMatrix:r,worldInverseTransposeMatrix:i}}},{key:"transform",value:function(){if(this.parent){var t=this.parent;this.endPosition.set(this.position.add(t.endPosition)),this.endRotation.set(this.rotation.add(t.endRotation)),this.endScale.set(this.scale.add(t.endScale))}else this.endPosition.set(this.position),this.endRotation.set(this.rotation),this.endScale.set(this.scale);for(var e=this.children,n=0;n<e.length;++n)e[n].transform();return this}}]),t}(),ge=n(20),ve=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(y.a)(this,e);var r=n=Array.isArray(n)?{children:n}:n,i=r.children,o=void 0===i?[]:i;return o.every((function(t){return Object(j.a)(t instanceof pe)})),(t=Object(nt.a)(this,Object(rt.a)(e).call(this,n))).children=o,t}return Object(it.a)(e,t),Object(L.a)(e,[{key:"add",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0;r<e.length;r++){var i=e[r];Array.isArray(i)?this.add.apply(this,Object(ge.a)(i)):this.children.push(i)}return this}},{key:"remove",value:function(t){var e=this.children,n=e.indexOf(t);return n>-1&&e.splice(n,1),this}},{key:"removeAll",value:function(){return this.children=[],this}},{key:"traverse",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.modelMatrix,i=void 0===r?new de.a:r,o=!0,a=!1,s=void 0;try{for(var u,c=this.children[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var l=u.value,f=l.matrix;i=i.multiplyRight(f);var h=void 0;if(h=l instanceof e?l.traverse(t,{modelMatrix:i}):t(l,{}))return h}}catch(t){a=!0,s=t}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}return null}},{key:"traverseReverse",value:function(t){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.modelMatrix,i=void 0===r?new de.a:r,o=this.children.length-1;o>=0;--o){var a=this.children[o],s=a.matrix;i=i.multiplyRight(s);var u=void 0;if(u=a instanceof e?a.traverseReverse(t,{modelMatrix:i}):t(a,{}))return u}return null}}]),e}(pe),ye=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(y.a)(this,t);var r=n.id,i=void 0===r?Object(l.i)("attribute"):r,o=n.type,a=n.isIndexed,s=void 0!==a&&a;this.gl=e,this.id=i,this.isIndexed=s,this.target=s?34963:34962,this.type=o,s&&!o&&(this.type=e&&Q(e,Y.ELEMENT_INDEX_UINT32)?5125:5123),this.value=null,this.externalBuffer=null,this.buffer=null,this.userData={},this.update(n),Object.seal(this),this._validateAttributeDefinition()}return Object(L.a)(t,[{key:"delete",value:function(){this.buffer&&(this.buffer.delete(),this.buffer=null)}},{key:"update",value:function(t){var e=t.value,n=t.buffer,r=t.constant,i=void 0===r?this.constant||!1:r;this.constant=i,n?(this.externalBuffer=n,this.constant=!1,this.type=n.accessor.type,void 0!==n.accessor.divisor&&(this.divisor=n.accessor.divisor)):e&&(this.externalBuffer=null,this.value=e,!i&&this.gl&&(this.buffer=this.buffer||new et.a(this.gl,Object.assign({},t,{id:this.id,target:this.target,type:this.type})),this.buffer.setData({data:e}),this.type=this.buffer.accessor.type)),this._setAccessor(t)}},{key:"getBuffer",value:function(){return this.constant?null:this.externalBuffer||this.buffer}},{key:"getValue",value:function(){if(this.constant)return this.value;var t=this.externalBuffer||this.buffer;return t?[t,this]:null}},{key:"_setAccessor",value:function(t){var e=t.size,n=void 0===e?this.size:e,r=t.offset,i=void 0===r?this.offset||0:r,o=t.stride,a=void 0===o?this.stride||0:o,s=t.normalized,u=void 0===s?this.normalized||!1:s,c=t.integer,f=void 0===c?this.integer||!1:c,h=t.divisor,d=void 0===h?this.divisor||0:h,p=t.instanced,g=t.isInstanced;this.size=n,this.offset=i,this.stride=a,this.normalized=u,this.integer=f,this.divisor=d,void 0!==g&&(l.g.deprecated("Attribute.isInstanced"),this.divisor=g?1:0),void 0!==p&&(l.g.deprecated("Attribute.instanced"),this.divisor=p?1:0)}},{key:"_validateAttributeDefinition",value:function(){}}]),t}(),me={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};function be(t){var e="string"==typeof t?me[t]||me.TRIANGLES:t;return Object(j.a)(e>=0&&e<=me.TRIANGLE_FAN,"Illegal drawMode"),e}var _e=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(y.a)(this,t);var n=e.id,r=e.drawMode,i=void 0===r?me.TRIANGLES:r,o=e.vertexCount,a=void 0===o?void 0:o,s=e.attributes;this.id=n||Object(l.i)(this.constructor.name),this.drawMode=be(i),this.vertexCount=a,this.attributes={},this.needsRedraw=!0,this.userData={},Object.seal(this),s&&this.setAttributes(s)}return Object(L.a)(t,[{key:"setNeedsRedraw",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.needsRedraw=t,this}},{key:"getNeedsRedraw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.clearRedrawFlags,n=void 0!==e&&e,r=!1;return r=r||this.needsRedraw,this.needsRedraw=this.needsRedraw&&!n,r}},{key:"setVertexCount",value:function(t){this.vertexCount=t}},{key:"getVertexCount",value:function(){return void 0!==this.vertexCount?this.vertexCount:this.attributes.indices?this.attributes.indices.value.length:this.attributes.vertices?this.attributes.vertices.value.length/3:!!this.attributes.positions&&this.attributes.positions.value.length/3}},{key:"hasAttribute",value:function(t){return Boolean(this.attributes[t])}},{key:"getAttribute",value:function(t){var e=this.attributes[t];return Object(j.a)(e),e.value}},{key:"getArray",value:function(t){var e=this.attributes[t];return Object(j.a)(e),e.value}},{key:"getAttributes",value:function(){return this.attributes}},{key:"setAttributes",value:function(t){for(var e in t){var n=t[e];n=ArrayBuffer.isView(n)?{value:n}:n,Object(j.a)(ArrayBuffer.isView(n.value),"".concat(this._print(e),": must be typed array or object with value as typed array")),this._autoDetectAttribute(e,n),this.attributes[e]=n}return this.setNeedsRedraw(),this}},{key:"_autoDetectAttribute",value:function(t,e){var n;switch(t){case"indices":n=n||"indices";break;case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors"}switch(n){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2;break;case"indices":e.size=e.size||1,e.isIndexed=void 0===e.isIndexed||e.isIndexed,Object(j.a)(e.value instanceof Uint16Array||e.value instanceof Uint32Array,'attribute array for "indices" must be of integer type')}Object(j.a)(e.size,"attribute ".concat(t," needs size"))}},{key:"_print",value:function(t){return"Geometry ".concat(this.id," attribute ").concat(t)}}]),t}(),xe="#define SHADER_NAME luma_modular_vertex\n\n// object attributes\nattribute vec3 positions;\nattribute vec3 normals;\nattribute vec4 colors;\nattribute vec2 texCoords;\nattribute vec3 pickingColors;\n\nvoid main(void) {\n\n  // Set up position\n#ifdef MODULE_GEOMETRY\n  geometry_setPosition(positions);\n  geometry_setNormal(normals);\n#endif\n\n#ifdef MODULE_PROJECT\n  project_setPositionAndNormal_Model(positions, normals);\n  gl_Position = project_model_to_clipspace(positions);\n#endif\n\n  // Set up depth\n#ifdef MODULE_LOGDEPTH\n  logdepth_adjustPosition(gl_Position);\n#endif\n\n#ifdef MODULE_DIFFUSE\n  diffuse_setTextureCoordinate(texCoords);\n#endif\n\n  // Set up color calculations\n#ifdef MODULE_MATERIAL\n  material_setDiffuseColor(colors);\n  material_setDiffuseTextureCoordinates(texCoords);\n#endif\n\n#ifdef MODULE_LIGHTING\n  lighting_setPositionAndNormal(positions, normals);\n  lighting_apply_light(positions);\n  lighting_apply_reflection(positions);\n#endif\n\n#ifdef MODULE_PICKING\n  picking_setPickingColor(pickingColors);\n#endif\n\n}\n",we="#define SHADER_NAME luma-modular-fragment\n\nprecision highp float;\n\n// varyings\nvarying vec4 vColor;\n\nvoid main(){\n  gl_FragColor = vec4(1., 0., 1., 1.);\n\n#ifdef MODULE_DIFFUSE\n  gl_FragColor = diffuse_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_MATERIAL\n  gl_FragColor = material_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LIGHTING\n  gl_FragColor = lighting_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_FOG\n  gl_FragColor = fog_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_PICKING\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LOGDEPTH\n  logdepth_setFragDepth(gl_Position);\n#endif\n}\n";function Ee(t,e,n){switch(e){case 300:return n?function(t){return t.replace(/attribute\s+/g,"in ").replace(/varying\s+/g,"out ").replace(/texture2D\(/g,"texture(").replace(/textureCube\(+/g,"texture(")}(t):function(t){return t.replace(/varying\s+/g,"in ").replace(/texture2D\(/g,"texture(").replace(/textureCube\(/g,"texture(")}(t);case 100:return n?function(t){return t.replace(/^in\s+/gm,"attribute ").replace(/^out\s+/gm,"varying ").replace(/texture\(/g,"texture2D(")}(t):function(t){return t.replace(/^in\s+/gm,"varying ").replace(/texture\(/g,"texture2D(")}(t);default:throw new Error("unknown GLSL version ".concat(e))}}function Se(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}var Oe=function(){function t(e){var n=e.name,r=e.vs,i=e.fs,o=e.dependencies,a=void 0===o?[]:o,s=e.getUniforms,u=void 0===s?function(){return{}}:s,c=e.deprecations,l=void 0===c?[]:c,f=e.vertexShader,h=e.fragmentShader;Object(y.a)(this,t),Se("string"==typeof n),this.name=n,this.vs=r||f,this.fs=i||h,this.getModuleUniforms=u,this.dependencies=a,this.deprecations=this._parseDeprecationDefinitions(l)}return Object(L.a)(t,[{key:"getModuleSource",value:function(t,e){var n;switch(t){case"vs":n=Ee(this.vs||"",e,!0);break;case"fs":n=Ee(this.fs||"",e,!1);break;default:Se(!1)}return"string"!=typeof n?"":"#define MODULE_".concat(this.name.toUpperCase(),"\n").concat(n,"// END MODULE_").concat(this.name,"\n\n")}},{key:"getUniforms",value:function(t,e){return this.getModuleUniforms(t,e)}},{key:"checkDeprecations",value:function(t,e){this.deprecations.forEach((function(n){n.regex.test(t)&&(n.deprecated&&e?e.deprecated(n.old,n.new)():e&&e.removed(n.old,n.new)())}))}},{key:"_parseDeprecationDefinitions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.forEach((function(t){switch(t.type){case"function":t.regex=new RegExp("\\b".concat(t.old,"\\("));break;default:t.regex=new RegExp("".concat(t.type," ").concat(t.old,";"))}})),t}}]),t}(),Pe=new(function(){function t(){Object(y.a)(this,t),this.shaderModules={},this.defaultShaderModules=[]}return Object(L.a)(t,[{key:"setDefaultShaderModules",value:function(t){this.defaultShaderModules=this.resolveModules(t)}},{key:"registerShaderModules",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.ignoreMultipleRegistrations,r=void 0!==n&&n,i=!0,o=!1,a=void 0;try{for(var s,u=t[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value;this._registerShaderModule(c,r)}}catch(t){o=!0,a=t}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}}},{key:"getShaderModule",value:function(t){if(t instanceof Oe)return t;if("string"!=typeof t)return this._registerShaderModule(t,!0);var e=this.shaderModules[t];return e||Se(!1,"Unknown shader module ".concat(t)),e}},{key:"resolveModules",value:function(t){var e=this;return t.map((function(t){return e.getShaderModule(t)}))}},{key:"_registerShaderModule",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t instanceof Oe)return t;if(Se(t.name,"shader module has no name"),this.shaderModules[t.name]&&!e)throw new Error("shader module ".concat(t.name," already registered"));return(t=new Oe(t)).dependencies=this.resolveModules(t.dependencies),this.shaderModules[t.name]=t,this.shaderModules[t.name]}}]),t}());function Ce(t){Pe.setDefaultShaderModules(t)}function Me(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.ignoreMultipleRegistrations,r=void 0!==n&&n;Pe.registerShaderModules(t,{ignoreMultipleRegistrations:r})}function Ie(t){return t=t.concat(Pe.defaultShaderModules),Ae(t=Pe.resolveModules(t))}function Ae(t){var e={},n={};return Te({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort((function(t,e){return n[e]-n[t]})).map((function(t){return e[t]}))}function Te(t){var e=t.modules,n=t.level,r=t.moduleMap,i=t.moduleDepth;if(n>=5)throw new Error("Possible loop in shader dependency graph");var o=!0,a=!1,s=void 0;try{for(var u,c=e[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var l=u.value;r[l.name]=l,(void 0===i[l.name]||i[l.name]<n)&&(i[l.name]=n)}}catch(t){a=!0,s=t}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}var f=!0,h=!1,d=void 0;try{for(var p,g=e[Symbol.iterator]();!(f=(p=g.next()).done);f=!0){var v=p.value;v.dependencies&&Te({modules:v.dependencies,level:n+1,moduleMap:r,moduleDepth:i})}}catch(t){h=!0,d=t}finally{try{f||null==g.return||g.return()}finally{if(h)throw d}}}function Ne(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e="undefined"!=typeof window&&window.navigator||{},n=t.userAgent||e.userAgent||"",r=-1!==n.indexOf("MSIE "),i=-1!==n.indexOf("Trident/");return r||i}var Le={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},Re={};Object.keys(Le).forEach((function(t){Re[t]=t}));var ke={};function je(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=Le[e];if(Se(r,e),!Ne(n))return!0;if(e in ke)return ke[e];var i=r[0],o=n.behavior||"enable",a="#extension GL_".concat(i," : ").concat(o,"\nvoid main(void) {}"),s=t.createShader(35633);t.shaderSource(s,a),t.compileShader(s);var u=t.getShaderParameter(s,35713);return t.deleteShader(s),ke[e]=u,u}function Fe(t,e){var n=Le[e];Se(n,e);var r=function(t){return Boolean(t&&("undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||!0))}(t)&&n[1]||n[0],i="string"==typeof r?Boolean(t.getExtension(r)):r;return Se(!1===i||!0===i),i}function De(t,e){return(e=Array.isArray(e)?e:[e]).every((function(e){return Fe(t,e)}))}var Be,ze,Ve=n(58),Ge=n.n(Ve),Ue=(Be={},Object(C.a)(Be,"vs","#ifdef MODULE_LOGDEPTH\n  logdepth_adjustPosition(gl_Position);\n#endif\n"),Object(C.a)(Be,"fs","#ifdef MODULE_MATERIAL\n  gl_FragColor = material_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LIGHTING\n  gl_FragColor = lighting_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_FOG\n  gl_FragColor = fog_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_PICKING\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LOGDEPTH\n  logdepth_setFragDepth();\n#endif\n"),Be),We=/void main\s*\([^\)]*\)\s*\{\n?/,qe=/}\n?[^{}]*$/;function Xe(t){var e={};return Ge()(Array.isArray(t)&&t.length>1),t.forEach((function(t){for(var n in t)e[n]=e[n]?"".concat(e[n],"\n").concat(t[n]):t[n]})),e}var He=(ze={},Object(C.a)(ze,"vs","vertex"),Object(C.a)(ze,"fs","fragment"),ze);function Ye(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.vs,r=e.fs,i=Ie(e.modules||[]);return{gl:t,vs:Ze(t,Object.assign({},e,{source:n,type:"vs",modules:i})),fs:Ze(t,Object.assign({},e,{source:r,type:"fs",modules:i})),getUniforms:Ke(i),modules:Je(i)}}function Ze(t,e){var n=e.id,r=e.source,i=e.type,o=e.modules,a=void 0===o?[]:o,s=e.defines,u=void 0===s?{}:s,c=e.inject,l=void 0===c?{}:c,f=e.prologue,h=void 0===f||f,d=e.log;Se("string"==typeof r,"shader source must be a string");var p="vs"===i,g=r.split("\n"),v=100,y="",m=r;0===g[0].indexOf("#version ")&&(v=300,y=g[0],m=g.slice(1).join("\n"));var b=h?"".concat(y,"\n").concat(function(t){var e=t.id,n=t.source,r=t.type;return e&&"string"==typeof e&&-1===n.indexOf("SHADER_NAME")?"\n#define SHADER_NAME ".concat(e,"_").concat(He[r],"\n\n"):""}({id:n,source:r,type:i}),"\n").concat(function(t){switch(function(t){var e=t.getExtension("WEBGL_debug_renderer_info"),n=t.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||7936),r=t.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||7937);return{gpuVendor:function(t,e){if(t.match(/NVIDIA/i)||e.match(/NVIDIA/i))return"NVIDIA";if(t.match(/INTEL/i)||e.match(/INTEL/i))return"INTEL";if(t.match(/AMD/i)||e.match(/AMD/i)||t.match(/ATI/i)||e.match(/ATI/i))return"AMD";return"UNKNOWN GPU"}(n,r),vendor:n,renderer:r,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}(t).gpuVendor.toLowerCase()){case"nvidia":return"#define NVIDIA_GPU\n// Nvidia optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n";case"intel":return"#define INTEL_GPU\n// Intel optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"amd":return"#define AMD_GPU\n";default:return"#define DEFAULT_GPU\n// Prevent driver from optimizing away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n"}}(t),"\n").concat(function(t,e,n){var r="#if (__VERSION__ > 120)\n\n# define FRAG_DEPTH\n# define DERIVATIVES\n# define DRAW_BUFFERS\n# define TEXTURE_LOD\n\n#endif // __VERSION\n";return De(t,Re.GLSL_FRAG_DEPTH)&&(r+="// FRAG_DEPTH => gl_FragDepth is available\n#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n# define FRAG_DEPTH\n# define gl_FragDepth gl_FragDepthEXT\n#endif\n"),De(t,Re.GLSL_DERIVATIVES)&&je(t,Re.GLSL_DERIVATIVES)&&(r+="// DERIVATIVES => dxdF, dxdY and fwidth are available\n#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n# define DERIVATIVES\n#endif\n"),De(t,Re.GLSL_FRAG_DATA)&&je(t,Re.GLSL_FRAG_DATA,{behavior:"require"})&&(r+="// DRAW_BUFFERS => gl_FragData[] is available\n#ifdef GL_EXT_draw_buffers\n#extension GL_EXT_draw_buffers : require\n#define DRAW_BUFFERS\n#endif\n"),De(t,Re.GLSL_TEXTURE_LOD)&&(r+="// TEXTURE_LOD => texture2DLod etc are available\n#ifdef GL_EXT_shader_texture_lod\n#extension GL_EXT_shader_texture_lod : enable\n# define TEXTURE_LOD\n#define texture2DLod texture2DLodEXT\n#define texture2DProjLod texture2DProjLodEXT\n#define texture2DProjLod texture2DProjLodEXT\n#define textureCubeLod textureCubeLodEXT\n#define texture2DGrad texture2DGradEXT\n#define texture2DProjGrad texture2DProjGradEXT\n#define texture2DProjGrad texture2DProjGradEXT\n#define textureCubeGrad textureCubeGradEXT\n#endif\n"),r}(t),"\n").concat(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=0,n="";for(var r in t){0===e&&(n+="\n// APPLICATION DEFINES\n"),e++;var i=t[r];(i||Number.isFinite(i))&&(n+="#define ".concat(r.toUpperCase()," ").concat(t[r],"\n"))}0===e&&(n+="\n");return n}(u),"\n").concat(p?"":"precision highp float;\n\n","\n"):"".concat(y,"\n"),_=!1,x=!0,w=!1,E=void 0;try{for(var S,O=a[Symbol.iterator]();!(x=(S=O.next()).done);x=!0){var P=S.value;switch(P.name){case"inject":_=!0;break;default:P.checkDeprecations(m,d),b+=P.getModuleSource(i,v)}}}catch(t){w=!0,E=t}finally{try{x||null==O.return||O.return()}finally{if(w)throw E}}return b=function(t,e,n,r){var i="vs"===e,o=function(e){var r=n[e];switch(e){case"vs:#decl":i&&(t=t.replace(We,(function(t){return"".concat(r,"\n").concat(t)})));break;case"vs:#main-start":i&&(t=t.replace(We,(function(t){return t+r})));break;case"vs:#main-end":i&&(t=t.replace(qe,(function(t){return r+t})));break;case"fs:#decl":i||(t=t.replace(We,(function(t){return"".concat(r,"\n").concat(t)})));break;case"fs:#main-start":i||(t=t.replace(We,(function(t){return t+r})));break;case"fs:#main-end":i||(t=t.replace(qe,(function(t){return r+t})));break;default:t=t.replace(e,(function(t){return t+r}))}};for(var a in n)o(a);return r&&(t=t.replace("}s*$",(function(t){return t+Ue[e]}))),t}(b+=m,i,l,_)}function Ke(t){return function(e){var n={},r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value.getUniforms(e,n);Object.assign(n,u)}}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}}function Je(t){var e,n={},r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value,c=(e=u,Pe.getShaderModule(e));n[u]=c}}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}var Qe={name:"fp32",vs:"#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\nconst float TWO_PI = 6.2831854820251465;\nconst float PI_2 = 1.5707963705062866;\nconst float PI_16 = 0.1963495463132858;\n\nconst float SIN_TABLE_0 = 0.19509032368659973;\nconst float SIN_TABLE_1 = 0.3826834261417389;\nconst float SIN_TABLE_2 = 0.5555702447891235;\nconst float SIN_TABLE_3 = 0.7071067690849304;\n\nconst float COS_TABLE_0 = 0.9807852506637573;\nconst float COS_TABLE_1 = 0.9238795042037964;\nconst float COS_TABLE_2 = 0.8314695954322815;\nconst float COS_TABLE_3 = 0.7071067690849304;\n\nconst float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;\nconst float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;\nconst float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;\nconst float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;\n\nfloat sin_taylor_fp32(float a) {\n  float r, s, t, x;\n\n  if (a == 0.0) {\n    return 0.0;\n  }\n\n  x = -a * a;\n  s = a;\n  r = a;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_3;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_5;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_7;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_9;\n  s = s + t;\n\n  return s;\n}\n\nvoid sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {\n  if (a == 0.0) {\n    sin_t = 0.0;\n    cos_t = 1.0;\n  }\n  sin_t = sin_taylor_fp32(a);\n  cos_t = sqrt(1.0 - sin_t * sin_t);\n}\n\nfloat tan_taylor_fp32(float a) {\n    float sin_a;\n    float cos_a;\n\n    if (a == 0.0) {\n        return 0.0;\n    }\n    float z = floor(a / TWO_PI);\n    float r = a - TWO_PI * z;\n\n    float t;\n    float q = floor(r / PI_2 + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return 0.0 / 0.0;\n    }\n\n    t = r - PI_2 * q;\n\n    q = floor(t / PI_16 + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return 0.0 / 0.0;\n    } else {\n        t = t - PI_16 * q;\n    }\n\n    float u = 0.0;\n    float v = 0.0;\n\n    float sin_t, cos_t;\n    float s, c;\n    sincos_taylor_fp32(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0;\n            v = SIN_TABLE_0;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1;\n            v = SIN_TABLE_1;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2;\n            v = SIN_TABLE_2;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3;\n            v = SIN_TABLE_3;\n        }\n        if (k > 0) {\n            s = u * sin_t + v * cos_t;\n            c = u * cos_t - v * sin_t;\n        } else {\n            s = u * sin_t - v * cos_t;\n            c = u * cos_t + v * sin_t;\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return sin_a / cos_a;\n}\n#endif\n\nfloat tan_fp32(float a) {\n#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\n  return tan_taylor_fp32(a);\n#else\n  return tan(a);\n#endif\n}\n",fs:null};function $e(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=Math.fround(t),i=t-r;return e[n]=r,e[n+1]=i,e}var tn="uniform float ONE;\nvec2 split(float a) {\n  const float SPLIT = 4097.0;\n  float t = a * SPLIT;\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float a_hi = t * ONE - (t - a);\n  float a_lo = a * ONE - a_hi;\n#else\n  float a_hi = t - (t - a);\n  float a_lo = a - a_hi;\n#endif\n  return vec2(a_hi, a_lo);\n}\nvec2 split2(vec2 a) {\n  vec2 b = split(a.x);\n  b.y += a.y;\n  return b;\n}\nvec2 quickTwoSum(float a, float b) {\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float sum = (a + b) * ONE;\n  float err = b - (sum - a) * ONE;\n#else\n  float sum = a + b;\n  float err = b - (sum - a);\n#endif\n  return vec2(sum, err);\n}\nvec2 twoSum(float a, float b) {\n  float s = (a + b);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float v = (s * ONE - a) * ONE;\n  float err = (a - (s - v) * ONE) * ONE * ONE * ONE + (b - v);\n#else\n  float v = s - a;\n  float err = (a - (s - v)) + (b - v);\n#endif\n  return vec2(s, err);\n}\n\nvec2 twoSub(float a, float b) {\n  float s = (a - b);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float v = (s * ONE - a) * ONE;\n  float err = (a - (s - v) * ONE) * ONE * ONE * ONE - (b + v);\n#else\n  float v = s - a;\n  float err = (a - (s - v)) - (b + v);\n#endif\n  return vec2(s, err);\n}\n\nvec2 twoSqr(float a) {\n  float prod = a * a;\n  vec2 a_fp64 = split(a);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float err = ((a_fp64.x * a_fp64.x - prod) * ONE + 2.0 * a_fp64.x *\n    a_fp64.y * ONE * ONE) + a_fp64.y * a_fp64.y * ONE * ONE * ONE;\n#else\n  float err = ((a_fp64.x * a_fp64.x - prod) + 2.0 * a_fp64.x * a_fp64.y) + a_fp64.y * a_fp64.y;\n#endif\n  return vec2(prod, err);\n}\n\nvec2 twoProd(float a, float b) {\n  float prod = a * b;\n  vec2 a_fp64 = split(a);\n  vec2 b_fp64 = split(b);\n  float err = ((a_fp64.x * b_fp64.x - prod) + a_fp64.x * b_fp64.y +\n    a_fp64.y * b_fp64.x) + a_fp64.y * b_fp64.y;\n  return vec2(prod, err);\n}\n\nvec2 sum_fp64(vec2 a, vec2 b) {\n  vec2 s, t;\n  s = twoSum(a.x, b.x);\n  t = twoSum(a.y, b.y);\n  s.y += t.x;\n  s = quickTwoSum(s.x, s.y);\n  s.y += t.y;\n  s = quickTwoSum(s.x, s.y);\n  return s;\n}\n\nvec2 sub_fp64(vec2 a, vec2 b) {\n  vec2 s, t;\n  s = twoSub(a.x, b.x);\n  t = twoSub(a.y, b.y);\n  s.y += t.x;\n  s = quickTwoSum(s.x, s.y);\n  s.y += t.y;\n  s = quickTwoSum(s.x, s.y);\n  return s;\n}\n\nvec2 mul_fp64(vec2 a, vec2 b) {\n  vec2 prod = twoProd(a.x, b.x);\n  prod.y += a.x * b.y;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  prod = split2(prod);\n#endif\n  prod = quickTwoSum(prod.x, prod.y);\n  prod.y += a.y * b.x;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  prod = split2(prod);\n#endif\n  prod = quickTwoSum(prod.x, prod.y);\n  return prod;\n}\n\nvec2 div_fp64(vec2 a, vec2 b) {\n  float xn = 1.0 / b.x;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  vec2 yn = mul_fp64(a, vec2(xn, 0));\n#else\n  vec2 yn = a * xn;\n#endif\n  float diff = (sub_fp64(a, mul_fp64(b, yn))).x;\n  vec2 prod = twoProd(xn, diff);\n  return sum_fp64(yn, prod);\n}\n\nvec2 sqrt_fp64(vec2 a) {\n  if (a.x == 0.0 && a.y == 0.0) return vec2(0.0, 0.0);\n  if (a.x < 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);\n\n  float x = 1.0 / sqrt(a.x);\n  float yn = a.x * x;\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  vec2 yn_sqr = twoSqr(yn) * ONE;\n#else\n  vec2 yn_sqr = twoSqr(yn);\n#endif\n  float diff = sub_fp64(a, yn_sqr).x;\n  vec2 prod = twoProd(x * 0.5, diff);\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  return sum_fp64(split(yn), prod);\n#else\n  return sum_fp64(vec2(yn, 0.0), prod);\n#endif\n}\n",en="".concat(tn,"\n").concat("const vec2 E_FP64 = vec2(2.7182817459106445e+00, 8.254840366817007e-08);\nconst vec2 LOG2_FP64 = vec2(0.6931471824645996e+00, -1.9046542121259336e-09);\nconst vec2 PI_FP64 = vec2(3.1415927410125732, -8.742278012618954e-8);\nconst vec2 TWO_PI_FP64 = vec2(6.2831854820251465, -1.7484556025237907e-7);\nconst vec2 PI_2_FP64 = vec2(1.5707963705062866, -4.371139006309477e-8);\nconst vec2 PI_4_FP64 = vec2(0.7853981852531433, -2.1855695031547384e-8);\nconst vec2 PI_16_FP64 = vec2(0.19634954631328583, -5.463923757886846e-9);\nconst vec2 PI_16_2_FP64 = vec2(0.39269909262657166, -1.0927847515773692e-8);\nconst vec2 PI_16_3_FP64 = vec2(0.5890486240386963, -1.4906100798128818e-9);\nconst vec2 PI_180_FP64 = vec2(0.01745329238474369, 1.3519960498364902e-10);\n\nconst vec2 SIN_TABLE_0_FP64 = vec2(0.19509032368659973, -1.6704714833615242e-9);\nconst vec2 SIN_TABLE_1_FP64 = vec2(0.3826834261417389, 6.22335089017767e-9);\nconst vec2 SIN_TABLE_2_FP64 = vec2(0.5555702447891235, -1.1769521357507529e-8);\nconst vec2 SIN_TABLE_3_FP64 = vec2(0.7071067690849304, 1.2101617041793133e-8);\n\nconst vec2 COS_TABLE_0_FP64 = vec2(0.9807852506637573, 2.9739473106360492e-8);\nconst vec2 COS_TABLE_1_FP64 = vec2(0.9238795042037964, 2.8307490351764386e-8);\nconst vec2 COS_TABLE_2_FP64 = vec2(0.8314695954322815, 1.6870263741530778e-8);\nconst vec2 COS_TABLE_3_FP64 = vec2(0.7071067690849304, 1.2101617152815436e-8);\n\nconst vec2 INVERSE_FACTORIAL_3_FP64 = vec2(1.666666716337204e-01, -4.967053879312289e-09);\nconst vec2 INVERSE_FACTORIAL_4_FP64 = vec2(4.16666679084301e-02, -1.2417634698280722e-09);\nconst vec2 INVERSE_FACTORIAL_5_FP64 = vec2(8.333333767950535e-03, -4.34617203337595e-10);\nconst vec2 INVERSE_FACTORIAL_6_FP64 = vec2(1.3888889225199819e-03, -3.3631094437103215e-11);\nconst vec2 INVERSE_FACTORIAL_7_FP64 = vec2(1.9841270113829523e-04,  -2.725596874933456e-12);\nconst vec2 INVERSE_FACTORIAL_8_FP64 = vec2(2.4801587642286904e-05, -3.406996025904184e-13);\nconst vec2 INVERSE_FACTORIAL_9_FP64 = vec2(2.75573188446287533e-06, 3.7935713937038186e-14);\nconst vec2 INVERSE_FACTORIAL_10_FP64 = vec2(2.755731998149713e-07, -7.575112367869873e-15);\n\nfloat nint(float d) {\n    if (d == floor(d)) return d;\n    return floor(d + 0.5);\n}\n\nvec2 nint_fp64(vec2 a) {\n    float hi = nint(a.x);\n    float lo;\n    vec2 tmp;\n    if (hi == a.x) {\n        lo = nint(a.y);\n        tmp = quickTwoSum(hi, lo);\n    } else {\n        lo = 0.0;\n        if (abs(hi - a.x) == 0.5 && a.y < 0.0) {\n            hi -= 1.0;\n        }\n        tmp = vec2(hi, lo);\n    }\n    return tmp;\n}\n\nvec2 exp_fp64(vec2 a) {\n\n  const int k_power = 4;\n  const float k = 16.0;\n\n  const float inv_k = 1.0 / k;\n\n  if (a.x <= -88.0) return vec2(0.0, 0.0);\n  if (a.x >= 88.0) return vec2(1.0 / 0.0, 1.0 / 0.0);\n  if (a.x == 0.0 && a.y == 0.0) return vec2(1.0, 0.0);\n  if (a.x == 1.0 && a.y == 0.0) return E_FP64;\n\n  float m = floor(a.x / LOG2_FP64.x + 0.5);\n  vec2 r = sub_fp64(a, mul_fp64(LOG2_FP64, vec2(m, 0.0))) * inv_k;\n  vec2 s, t, p;\n\n  p = mul_fp64(r, r);\n  s = sum_fp64(r, p * 0.5);\n  p = mul_fp64(p, r);\n  t = mul_fp64(p, INVERSE_FACTORIAL_3_FP64);\n\n  s = sum_fp64(s, t);\n  p = mul_fp64(p, r);\n  t = mul_fp64(p, INVERSE_FACTORIAL_4_FP64);\n\n  s = sum_fp64(s, t);\n  p = mul_fp64(p, r);\n  t = mul_fp64(p, INVERSE_FACTORIAL_5_FP64);\n\n\n\n\n\n\n  s = sum_fp64(s, t);\n  for (int i = 0; i < k_power; i++) {\n    s = sum_fp64(s * 2.0, mul_fp64(s, s));\n  }\n\n#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)\n  s = sum_fp64(s, vec2(ONE, 0.0));\n#else\n  s = sum_fp64(s, vec2(1.0, 0.0));\n#endif\n\n  return s * pow(2.0, m);\n}\n\nvec2 log_fp64(vec2 a)\n{\n  if (a.x == 1.0 && a.y == 0.0) return vec2(0.0, 0.0);\n  if (a.x <= 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);\n  vec2 x = vec2(log(a.x), 0.0);\n  vec2 s;\n#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)\n  s = vec2(ONE, 0.0);\n#else\n  s = vec2(1.0, 0.0);\n#endif\n\n  x = sub_fp64(sum_fp64(x, mul_fp64(a, exp_fp64(-x))), s);\n  return x;\n}\n\nvec2 sin_taylor_fp64(vec2 a) {\n  vec2 r, s, t, x;\n\n  if (a.x == 0.0 && a.y == 0.0) {\n    return vec2(0.0, 0.0);\n  }\n\n  x = -mul_fp64(a, a);\n  s = a;\n  r = a;\n\n  r = mul_fp64(r, x);\n  t = mul_fp64(r, INVERSE_FACTORIAL_3_FP64);\n  s = sum_fp64(s, t);\n\n  r = mul_fp64(r, x);\n  t = mul_fp64(r, INVERSE_FACTORIAL_5_FP64);\n  s = sum_fp64(s, t);\n\n\n\n\n\n\n  return s;\n}\n\nvec2 cos_taylor_fp64(vec2 a) {\n  vec2 r, s, t, x;\n\n  if (a.x == 0.0 && a.y == 0.0) {\n    return vec2(1.0, 0.0);\n  }\n\n  x = -mul_fp64(a, a);\n  r = x;\n  s = sum_fp64(vec2(1.0, 0.0), r * 0.5);\n\n  r = mul_fp64(r, x);\n  t = mul_fp64(r, INVERSE_FACTORIAL_4_FP64);\n  s = sum_fp64(s, t);\n\n  r = mul_fp64(r, x);\n  t = mul_fp64(r, INVERSE_FACTORIAL_6_FP64);\n  s = sum_fp64(s, t);\n\n\n\n\n\n\n  return s;\n}\n\nvoid sincos_taylor_fp64(vec2 a, out vec2 sin_t, out vec2 cos_t) {\n  if (a.x == 0.0 && a.y == 0.0) {\n    sin_t = vec2(0.0, 0.0);\n    cos_t = vec2(1.0, 0.0);\n  }\n\n  sin_t = sin_taylor_fp64(a);\n  cos_t = sqrt_fp64(sub_fp64(vec2(1.0, 0.0), mul_fp64(sin_t, sin_t)));\n}\n\nvec2 sin_fp64(vec2 a) {\n    if (a.x == 0.0 && a.y == 0.0) {\n        return vec2(0.0, 0.0);\n    }\n    vec2 z = nint_fp64(div_fp64(a, TWO_PI_FP64));\n    vec2 r = sub_fp64(a, mul_fp64(TWO_PI_FP64, z));\n\n    vec2 t;\n    float q = floor(r.x / PI_2_FP64.x + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    }\n\n    t = sub_fp64(r, mul_fp64(PI_2_FP64, vec2(q, 0.0)));\n\n    q = floor(t.x / PI_16_FP64.x + 0.5);\n    int k = int(q);\n\n    if (k == 0) {\n        if (j == 0) {\n            return sin_taylor_fp64(t);\n        } else if (j == 1) {\n            return cos_taylor_fp64(t);\n        } else if (j == -1) {\n            return -cos_taylor_fp64(t);\n        } else {\n            return -sin_taylor_fp64(t);\n        }\n    }\n\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    } else {\n        t = sub_fp64(t, mul_fp64(PI_16_FP64, vec2(q, 0.0)));\n    }\n\n    vec2 u = vec2(0.0, 0.0);\n    vec2 v = vec2(0.0, 0.0);\n\n#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)\n    if (abs(float(abs_k) - 1.0) < 0.5) {\n        u = COS_TABLE_0_FP64;\n        v = SIN_TABLE_0_FP64;\n    } else if (abs(float(abs_k) - 2.0) < 0.5) {\n        u = COS_TABLE_1_FP64;\n        v = SIN_TABLE_1_FP64;\n    } else if (abs(float(abs_k) - 3.0) < 0.5) {\n        u = COS_TABLE_2_FP64;\n        v = SIN_TABLE_2_FP64;\n    } else if (abs(float(abs_k) - 4.0) < 0.5) {\n        u = COS_TABLE_3_FP64;\n        v = SIN_TABLE_3_FP64;\n    }\n#else\n    if (abs_k == 1) {\n        u = COS_TABLE_0_FP64;\n        v = SIN_TABLE_0_FP64;\n    } else if (abs_k == 2) {\n        u = COS_TABLE_1_FP64;\n        v = SIN_TABLE_1_FP64;\n    } else if (abs_k == 3) {\n        u = COS_TABLE_2_FP64;\n        v = SIN_TABLE_2_FP64;\n    } else if (abs_k == 4) {\n        u = COS_TABLE_3_FP64;\n        v = SIN_TABLE_3_FP64;\n    }\n#endif\n\n    vec2 sin_t, cos_t;\n    sincos_taylor_fp64(t, sin_t, cos_t);\n\n\n\n    vec2 result = vec2(0.0, 0.0);\n    if (j == 0) {\n        if (k > 0) {\n            result = sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        } else {\n            result = sub_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        }\n    } else if (j == 1) {\n        if (k > 0) {\n            result = sub_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        } else {\n            result = sum_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        }\n    } else if (j == -1) {\n        if (k > 0) {\n            result = sub_fp64(mul_fp64(v, sin_t), mul_fp64(u, cos_t));\n        } else {\n            result = -sum_fp64(mul_fp64(v, sin_t), mul_fp64(u, cos_t));\n        }\n    } else {\n        if (k > 0) {\n            result = -sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        } else {\n            result = sub_fp64(mul_fp64(v, cos_t), mul_fp64(u, sin_t));\n        }\n    }\n\n    return result;\n}\n\nvec2 cos_fp64(vec2 a) {\n    if (a.x == 0.0 && a.y == 0.0) {\n        return vec2(1.0, 0.0);\n    }\n    vec2 z = nint_fp64(div_fp64(a, TWO_PI_FP64));\n    vec2 r = sub_fp64(a, mul_fp64(TWO_PI_FP64, z));\n\n    vec2 t;\n    float q = floor(r.x / PI_2_FP64.x + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    }\n\n    t = sub_fp64(r, mul_fp64(PI_2_FP64, vec2(q, 0.0)));\n\n    q = floor(t.x / PI_16_FP64.x + 0.5);\n    int k = int(q);\n\n    if (k == 0) {\n        if (j == 0) {\n            return cos_taylor_fp64(t);\n        } else if (j == 1) {\n            return -sin_taylor_fp64(t);\n        } else if (j == -1) {\n            return sin_taylor_fp64(t);\n        } else {\n            return -cos_taylor_fp64(t);\n        }\n    }\n\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    } else {\n        t = sub_fp64(t, mul_fp64(PI_16_FP64, vec2(q, 0.0)));\n    }\n\n    vec2 u = vec2(0.0, 0.0);\n    vec2 v = vec2(0.0, 0.0);\n\n#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)\n    if (abs(float(abs_k) - 1.0) < 0.5) {\n        u = COS_TABLE_0_FP64;\n        v = SIN_TABLE_0_FP64;\n    } else if (abs(float(abs_k) - 2.0) < 0.5) {\n        u = COS_TABLE_1_FP64;\n        v = SIN_TABLE_1_FP64;\n    } else if (abs(float(abs_k) - 3.0) < 0.5) {\n        u = COS_TABLE_2_FP64;\n        v = SIN_TABLE_2_FP64;\n    } else if (abs(float(abs_k) - 4.0) < 0.5) {\n        u = COS_TABLE_3_FP64;\n        v = SIN_TABLE_3_FP64;\n    }\n#else\n    if (abs_k == 1) {\n        u = COS_TABLE_0_FP64;\n        v = SIN_TABLE_0_FP64;\n    } else if (abs_k == 2) {\n        u = COS_TABLE_1_FP64;\n        v = SIN_TABLE_1_FP64;\n    } else if (abs_k == 3) {\n        u = COS_TABLE_2_FP64;\n        v = SIN_TABLE_2_FP64;\n    } else if (abs_k == 4) {\n        u = COS_TABLE_3_FP64;\n        v = SIN_TABLE_3_FP64;\n    }\n#endif\n\n    vec2 sin_t, cos_t;\n    sincos_taylor_fp64(t, sin_t, cos_t);\n\n    vec2 result = vec2(0.0, 0.0);\n    if (j == 0) {\n        if (k > 0) {\n            result = sub_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        } else {\n            result = sum_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        }\n    } else if (j == 1) {\n        if (k > 0) {\n            result = -sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        } else {\n            result = sub_fp64(mul_fp64(v, cos_t), mul_fp64(u, sin_t));\n        }\n    } else if (j == -1) {\n        if (k > 0) {\n            result = sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        } else {\n            result = sub_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        }\n    } else {\n        if (k > 0) {\n            result = sub_fp64(mul_fp64(v, sin_t), mul_fp64(u, cos_t));\n        } else {\n            result = -sum_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        }\n    }\n\n    return result;\n}\n\nvec2 tan_fp64(vec2 a) {\n    vec2 sin_a;\n    vec2 cos_a;\n\n    if (a.x == 0.0 && a.y == 0.0) {\n        return vec2(0.0, 0.0);\n    }\n    vec2 z = nint_fp64(div_fp64(a, TWO_PI_FP64));\n    vec2 r = sub_fp64(a, mul_fp64(TWO_PI_FP64, z));\n\n    vec2 t;\n    float q = floor(r.x / PI_2_FP64.x + 0.5);\n    int j = int(q);\n\n\n    if (j < -2 || j > 2) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    }\n\n    t = sub_fp64(r, mul_fp64(PI_2_FP64, vec2(q, 0.0)));\n\n    q = floor(t.x / PI_16_FP64.x + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    } else {\n        t = sub_fp64(t, mul_fp64(PI_16_FP64, vec2(q, 0.0)));\n    }\n\n\n    vec2 u = vec2(0.0, 0.0);\n    vec2 v = vec2(0.0, 0.0);\n\n    vec2 sin_t, cos_t;\n    vec2 s, c;\n    sincos_taylor_fp64(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0_FP64;\n            v = SIN_TABLE_0_FP64;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1_FP64;\n            v = SIN_TABLE_1_FP64;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2_FP64;\n            v = SIN_TABLE_2_FP64;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3_FP64;\n            v = SIN_TABLE_3_FP64;\n        }\n#else\n        if (abs_k == 1) {\n            u = COS_TABLE_0_FP64;\n            v = SIN_TABLE_0_FP64;\n        } else if (abs_k == 2) {\n            u = COS_TABLE_1_FP64;\n            v = SIN_TABLE_1_FP64;\n        } else if (abs_k == 3) {\n            u = COS_TABLE_2_FP64;\n            v = SIN_TABLE_2_FP64;\n        } else if (abs_k == 4) {\n            u = COS_TABLE_3_FP64;\n            v = SIN_TABLE_3_FP64;\n        }\n#endif\n        if (k > 0) {\n            s = sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n            c = sub_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        } else {\n            s = sub_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n            c = sum_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return div_fp64(sin_a, cos_a);\n}\n\nvec2 radians_fp64(vec2 degree) {\n  return mul_fp64(degree, PI_180_FP64);\n}\n\nvec2 mix_fp64(vec2 a, vec2 b, float x) {\n  vec2 range = sub_fp64(b, a);\n  return sum_fp64(a, mul_fp64(range, vec2(x, 0.0)));\n}\n\nvoid vec2_sum_fp64(vec2 a[2], vec2 b[2], out vec2 out_val[2]) {\n    out_val[0] = sum_fp64(a[0], b[0]);\n    out_val[1] = sum_fp64(a[1], b[1]);\n}\n\nvoid vec2_sub_fp64(vec2 a[2], vec2 b[2], out vec2 out_val[2]) {\n    out_val[0] = sub_fp64(a[0], b[0]);\n    out_val[1] = sub_fp64(a[1], b[1]);\n}\n\nvoid vec2_mul_fp64(vec2 a[2], vec2 b[2], out vec2 out_val[2]) {\n    out_val[0] = mul_fp64(a[0], b[0]);\n    out_val[1] = mul_fp64(a[1], b[1]);\n}\n\nvoid vec2_div_fp64(vec2 a[2], vec2 b[2], out vec2 out_val[2]) {\n    out_val[0] = div_fp64(a[0], b[0]);\n    out_val[1] = div_fp64(a[1], b[1]);\n}\n\nvoid vec2_mix_fp64(vec2 x[2], vec2 y[2], float a, out vec2 out_val[2]) {\n  vec2 range[2];\n  vec2_sub_fp64(y, x, range);\n  vec2 portion[2];\n  portion[0] = range[0] * a;\n  portion[1] = range[1] * a;\n  vec2_sum_fp64(x, portion, out_val);\n}\n\nvec2 vec2_length_fp64(vec2 x[2]) {\n  return sqrt_fp64(sum_fp64(mul_fp64(x[0], x[0]), mul_fp64(x[1], x[1])));\n}\n\nvoid vec2_normalize_fp64(vec2 x[2], out vec2 out_val[2]) {\n  vec2 length = vec2_length_fp64(x);\n  vec2 length_vec2[2];\n  length_vec2[0] = length;\n  length_vec2[1] = length;\n\n  vec2_div_fp64(x, length_vec2, out_val);\n}\n\nvec2 vec2_distance_fp64(vec2 x[2], vec2 y[2]) {\n  vec2 diff[2];\n  vec2_sub_fp64(x, y, diff);\n  return vec2_length_fp64(diff);\n}\n\nvec2 vec2_dot_fp64(vec2 a[2], vec2 b[2]) {\n  vec2 v[2];\n\n  v[0] = mul_fp64(a[0], b[0]);\n  v[1] = mul_fp64(a[1], b[1]);\n\n  return sum_fp64(v[0], v[1]);\n}\nvoid vec3_sub_fp64(vec2 a[3], vec2 b[3], out vec2 out_val[3]) {\n  for (int i = 0; i < 3; i++) {\n    out_val[i] = sum_fp64(a[i], b[i]);\n  }\n}\n\nvoid vec3_sum_fp64(vec2 a[3], vec2 b[3], out vec2 out_val[3]) {\n  for (int i = 0; i < 3; i++) {\n    out_val[i] = sum_fp64(a[i], b[i]);\n  }\n}\n\nvec2 vec3_length_fp64(vec2 x[3]) {\n  return sqrt_fp64(sum_fp64(sum_fp64(mul_fp64(x[0], x[0]), mul_fp64(x[1], x[1])),\n    mul_fp64(x[2], x[2])));\n}\n\nvec2 vec3_distance_fp64(vec2 x[3], vec2 y[3]) {\n  vec2 diff[3];\n  vec3_sub_fp64(x, y, diff);\n  return vec3_length_fp64(diff);\n}\nvoid vec4_fp64(vec4 a, out vec2 out_val[4]) {\n  out_val[0].x = a[0];\n  out_val[0].y = 0.0;\n\n  out_val[1].x = a[1];\n  out_val[1].y = 0.0;\n\n  out_val[2].x = a[2];\n  out_val[2].y = 0.0;\n\n  out_val[3].x = a[3];\n  out_val[3].y = 0.0;\n}\n\nvoid vec4_scalar_mul_fp64(vec2 a[4], vec2 b, out vec2 out_val[4]) {\n  out_val[0] = mul_fp64(a[0], b);\n  out_val[1] = mul_fp64(a[1], b);\n  out_val[2] = mul_fp64(a[2], b);\n  out_val[3] = mul_fp64(a[3], b);\n}\n\nvoid vec4_sum_fp64(vec2 a[4], vec2 b[4], out vec2 out_val[4]) {\n  for (int i = 0; i < 4; i++) {\n    out_val[i] = sum_fp64(a[i], b[i]);\n  }\n}\n\nvoid vec4_dot_fp64(vec2 a[4], vec2 b[4], out vec2 out_val) {\n  vec2 v[4];\n\n  v[0] = mul_fp64(a[0], b[0]);\n  v[1] = mul_fp64(a[1], b[1]);\n  v[2] = mul_fp64(a[2], b[2]);\n  v[3] = mul_fp64(a[3], b[3]);\n\n  out_val = sum_fp64(sum_fp64(v[0], v[1]), sum_fp64(v[2], v[3]));\n}\n\nvoid mat4_vec4_mul_fp64(vec2 b[16], vec2 a[4], out vec2 out_val[4]) {\n  vec2 tmp[4];\n\n  for (int i = 0; i < 4; i++)\n  {\n    for (int j = 0; j < 4; j++)\n    {\n      tmp[j] = b[j + i * 4];\n    }\n    vec4_dot_fp64(a, tmp, out_val[i]);\n  }\n}\n"),nn={ONE:1};var rn={name:"fp64",vs:en,fs:null,fp64ify:$e,fp64LowPart:function(t){return t-Math.fround(t)},fp64ifyMatrix4:function(t){for(var e=new Float32Array(32),n=0;n<4;++n)for(var r=0;r<4;++r){var i=4*n+r;$e(t[4*r+n],e,2*i)}return e},getUniforms:function(){return Object.assign({},nn)}},on=("".concat(tn),[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),an={modelMatrix:on,viewMatrix:on,projectionMatrix:on,cameraPositionWorld:[0,0,0]};var sn="varying vec4 project_vPositionWorld;\nvarying vec3 project_vNormalWorld;\n\nvec4 project_getPosition_World() {\n  return project_vPositionWorld;\n}\n\nvec3 project_getNormal_World() {\n  return project_vNormalWorld;\n}\n",un={name:"project",getUniforms:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:an,e=(arguments.length>1&&void 0!==arguments[1]&&arguments[1],{});return void 0!==t.modelMatrix&&(e.modelMatrix=t.modelMatrix),void 0!==t.viewMatrix&&(e.viewMatrix=t.viewMatrix),void 0!==t.projectionMatrix&&(e.projectionMatrix=t.projectionMatrix),void 0!==t.cameraPositionWorld&&(e.cameraPositionWorld=t.cameraPositionWorld),void 0===t.projectionMatrix&&void 0===t.viewMatrix||(e.viewProjectionMatrix=new de.a(t.projectionMatrix).multiplyRight(t.viewMatrix)),e},vs:"".concat(sn,"\nuniform mat4 modelMatrix;\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 viewProjectionMatrix;\nuniform vec3 cameraPositionWorld;\n\nstruct World {\n  vec3 position;\n  vec3 normal;\n};\n\nWorld world;\n\nvoid project_setPosition(vec4 position) {\n  project_vPositionWorld = position;\n}\n\nvoid project_setNormal(vec3 normal) {\n  project_vNormalWorld = normal;\n}\n\nvoid project_setPositionAndNormal_World(vec3 position, vec3 normal) {\n  world.position = position;\n  world.normal = normal;\n}\n\nvoid project_setPositionAndNormal_Model(vec3 position, vec3 normal) {\n  world.position = (modelMatrix * vec4(position, 1.)).xyz;\n  world.normal = mat3(modelMatrix) * normal;\n}\n\nvec4 project_model_to_clipspace(vec4 position) {\n  return viewProjectionMatrix * modelMatrix * position;\n}\n\nvec4 project_model_to_clipspace(vec3 position) {\n  return viewProjectionMatrix * modelMatrix * vec4(position, 1.);\n}\n\nvec4 project_world_to_clipspace(vec3 position) {\n  return viewProjectionMatrix * vec4(position, 1.);\n}\n\nvec4 project_view_to_clipspace(vec3 position) {\n  return projectionMatrix * vec4(position, 1.);\n}\n\nvec4 project_to_clipspace(vec3 position) {\n  return viewProjectionMatrix * vec4(position, 1.);\n}\n"),fs:"\n".concat(sn)};var cn={name:"lighting",vs:"".concat("\n","\n").concat("#define LIGHT_MAX 4\n\nuniform bool lighting_uEnableLights;\nuniform vec3 lighting_uAmbientColor;\nuniform vec3 lighting_uDirection;\nuniform vec3 lighting_uDirectionalColor;\nuniform int  lighting_uPointCount;\nuniform vec3 lighting_uPointLocation[LIGHT_MAX];\nuniform vec3 lighting_uPointColor[LIGHT_MAX];\nuniform bool lighting_uEnableReflections;\nvarying vec4 lighting_vPosition;\nvarying vec4 lighting_vNormal;\nvarying vec3 lighting_vColor;\nvarying vec3 lighting_vLightWeighting;\nvarying vec3 lighting_vReflection;\n\nvoid lighting_setPositionAndNormal(vec3 position, vec3 normal) {\n  lighting_vPosition = worldMatrix * vec4(position, 1.);\n  lighting_vNormal = worldInverseTransposeMatrix * vec4(normal, 1.);;\n}\n\nvoid lighting__getLightWeigting() {\n  float directionalLightWeighting = max(dot(lighting_vNormal.xyz, lighting_uDirection), 0.);\n  vec3 pointWeight = vec3(0., 0., 0.);\n  for (int i = 0; i < LIGHT_MAX; i++) {\n    if (i < numberPoints) {\n      vec4 mvLightPosition = viewMatrix * vec4(lighting_uPointLocation[i], 1.);\n      vec3 pointLightDirection = normalize(mvLightPosition.xyz - lighting_vPosition.xyz);\n      pointWeight += max(dot(lighting_vNormal.xyz, pointLightDirection), 0.) * pointColor[i];\n     } else {\n       break;\n     }\n   }\n   return ambientColor + (directionalColor * directionalLightWeighting) + pointWeight;\n}\n\nvoid lighting_apply(vec3 position, vec3 normal) {\n  lighting_setPositionAndNormal(position, normal);\n  if(!lighting_uEnableLights) {\n    lighting_vLightWeighting = vec3(1., 1., 1.);\n  } else {\n    lighting_vLightWeighting = lighting__getLightWeighting();\n  }\n}\n\nvoid lighting_set_reflection(vec3 position) {\n  if (lighting_uEnableReflections) {\n    lighting_vReflection = (viewInverseMatrix[3] - (worldMatrix * vec4(position, 1.))).xyz;\n  } else {\n    lighting_vReflection = vec3(1., 1., 1.);\n  }\n}\n","\n"),fs:"".concat("\n","\n").concat("precision highp float;\n\n#define LIGHT_MAX 4\n\nvarying vec3 lighting_vLightWeighting;\n\nvec4 lighting_apply(vec4 color) {\n  return vec4(color.rgb * lighting_vLightWeighting, color.a);\n}\n\nuniform mat4 viewMatrix;\n\n\nvarying vec4 lighting_vColor;\nvarying vec4 lighting_vTransformedNormal;\nvarying vec4 lighting_vPosition;\n\nuniform float shininess;\nuniform bool enableSpecularMap;\nuniform bool enableLights;\n\nuniform vec3 ambientColor;\nuniform vec3 directionalColor;\nuniform vec3 lightingDirection;\n\nuniform vec3 lighting_uPointLocation[LIGHT_MAX];\nuniform vec3 lighting_uPointColor[LIGHT_MAX];\nuniform float lighting_uPointSpecularEnable[LIGHT_MAX];\nuniform vec3 lighting_uPointSpecularColor[LIGHT_MAX];\nuniform int numberPoints;\n\n\nvec3 lighting__calculate_light_weighting() {\n\treturn lighting__calculate_light_weighting(shininess);\n}\n\nvec3 lighting__calculate_light_weighting(shininess) {\n  vec3 normal = vTransformedNormal.xyz;\n  vec3 eyeDirection = normalize(-vPosition.xyz);\n\n  vec3 specularLight = vec3(0., 0., 0.);\n  vec3 diffuseLight = vec3(0., 0., 0.);\n\n  for (int i = 0; i < LIGHT_MAX; i++) {\n    if (i < numberPoints) {\n      vec3 transformedPointLocation = (viewMatrix * vec4(lighting_uPointLocation[i], 1.0)).xyz;\n      vec3 lightDirection = normalize(transformedPointLocation - vPosition.xyz);\n\n      if (lighting_uPointSpecularEnable > 0.) {\n        vec3 reflectionDirection = reflect(-lightDirection, normal);\n        float specularLightWeighting =\n          pow(max(dot(reflectionDirection, eyeDirection), 0.0), shininessVal);\n        specularLight += specularLightWeighting * lighting_uPointSpecularColor[i];\n      }\n\n      float diffuseLightWeighting = max(dot(normal, lightDirection), 0.0);\n      diffuseLight += diffuseLightWeighting * lighting_uPointColor[i];\n    } else {\n      break;\n    }\n  }\n\n  return ambientColor + diffuseLight + specularLight;\n}\n\nvoid lighting_filterColor(fragmentColor) {\n  if (!lighting_enable) {\n  \treturn fragmentColor;\n  } else {\n  \tvec3 lightWeighting = lighting__calculate_light_weighting();\n  \treturn vec4(fragmentColor.rgb * lightWeighting, fragmentColor.a);\n  }\n}\n\nuniform vec3 material_uAmbientColor;\nuniform vec3 material_uDiffuseColor;\nuniform vec3 material_uSpecularColor;\nuniform vec3 material_uEmissiveColor;\n\nuniform bool hasTexture1;\nuniform sampler2D sampler1;\n\nuniform mat4 viewMatrix;\n\nvoid apply_lighting(color) {\n  vec3 ambientLightWeighting = ambientColor;\n\n  vec3 normal = vTransformedNormal.xyz;\n  vec3 eyeDirection = normalize(-vPosition.xyz);\n\n  vec3 specularLight = vec3(0.0, 0.0, 0.0);\n  vec3 diffuseLight = vec3(0.0, 0.0, 0.0);\n\n  for (int i = 0; i < LIGHT_MAX; i++) {\n    if (i < numberPoints) {\n      vec3 transformedPointLocation = (viewMatrix * vec4(pointLocation[i], 1.0)).xyz;\n      vec3 lightDirection = normalize(transformedPointLocation - vPosition.xyz);\n\n      if (enableSpecularHighlights) {\n        vec3 reflectionDirection = reflect(-lightDirection, normal);\n        float specularLightWeighting =\n          pow(max(dot(reflectionDirection, eyeDirection), 0.0), shininess);\n        specularLight += specularLightWeighting * pointSpecularColor[i];\n      }\n\n      float diffuseLightWeighting = max(dot(normal, lightDirection), 0.0);\n      diffuseLight += diffuseLightWeighting * pointColor[i];\n    } else {\n        break;\n    }\n  }\n\n  vec3 matAmbientColor = material_uAmbientColor * color.rgb;\n  vec3 matDiffuseColor = material_uDiffuseColor * color.rgb;\n  vec3 matSpecularColor = material_uSpecularColor * color.rgb;\n  vec3 matEmissiveColor = material_uEmissiveColor * color.rgb;\n  gl_FragColor = vec4(\n    matAmbientColor * ambientLightWeighting\n    + matDiffuseColor * diffuseLightWeighting\n    + matSpecularColor * specularLightWeighting\n    + matEmissiveColor,\n    color.a\n  );\n}\n\n  vec3 lightWeighting;\n  if (!enableLights) {\n    lightWeighting = vec3(1.0, 1.0, 1.0);\n  } else {\n    vec3 lightDirection;\n    float specularLightWeighting = 0.0;\n    float diffuseLightWeighting = 0.0;\n    vec3  specularLight = vec3(0.0, 0.0, 0.0);\n    vec3  diffuseLight = vec3(0.0, 0.0, 0.0);\n\n    vec3 transformedPointLocation;\n    vec3 normal = vTransformedNormal.xyz;\n\n    vec3 eyeDirection = normalize(-vPosition.xyz);\n    vec3 reflectionDirection;\n\n    vec3 pointWeight = vec3(0.0, 0.0, 0.0);\n\n    for (int i = 0; i < LIGHT_MAX; i++) {\n      if (i < numberPoints) {\n        transformedPointLocation = (viewMatrix * vec4(pointLocation[i], 1.0)).xyz;\n        lightDirection = normalize(transformedPointLocation - vPosition.xyz);\n\n        if (enableSpecular[i] > 0.0) {\n          reflectionDirection = reflect(-lightDirection, normal);\n          specularLightWeighting = pow(max(dot(reflectionDirection, eyeDirection), 0.0), shininess);\n          specularLight += specularLightWeighting * pointSpecularColor[i];\n        }\n\n        diffuseLightWeighting = max(dot(normal, lightDirection), 0.0);\n        diffuseLight += diffuseLightWeighting * pointColor[i];\n      } else {\n        break;\n      }\n    }\n\n    lightWeighting = ambientColor + diffuseLight + specularLight;\n  }\nuniform float reflection;\nuniform float refraction;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","\n"),getUniforms:function(t){var e,n,r,i,o=t.lightingEnable,a=void 0!==o&&o,s=t.lightingAmbientColor,u=void 0===s?[.2,.2,.2]:s,c=t.lightingDirection,l=void 0===c?[1,1,1]:c,f=(t.lightingDirectionalColor,t.lightingPointLights),h=void 0===f?[]:f;return Object.assign({lightingEnable:a,lightingAmbientColor:u},(n=(e=l).color,r=e.direction,i=new he.a(r.x,r.y,r.z).normalize().scale(-1,-1,-1),{directionalColor:[n.r,n.g,n.b],lightingDirection:[i.x,i.y,i.z]}),function(t){var e=(t=t instanceof Array?t:[t]).length,n=[],r=[],i=[],o=[],a=!0,s=!1,u=void 0;try{for(var c,l=t[Symbol.iterator]();!(a=(c=l.next()).done);a=!0){var f=c.value,h=f.position,d=f.color,p=f.diffuse,g=f.specular,v=d||p;n.push(h.x,h.y,h.z),r.push(v.r,v.g,v.b),i.push(Number(Boolean(g))),g?o.push(g.r,g.g,g.b):o.push(0,0,0)}}catch(t){s=!0,u=t}finally{try{a||null==l.return||l.return()}finally{if(s)throw u}}return{numberPoints:e,pointLocation:n,pointColor:r,enableSpecular:i,pointSpecularColor:o}}(h))}},ln={lightDirection:new Float32Array([1,1,2])};var fn={name:"dirlight",vs:null,fs:"uniform vec3 dirlight_uLightDirection;\nvec4 dirlight_filterColor(vec4 color) {\n  vec3 normal = project_getNormal_World();\n  float d = abs(dot(normalize(normal), normalize(dirlight_uLightDirection)));\n  return vec4(color.rgb * d, color.a);\n}\n",getUniforms:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ln,e={};return t.lightDirection&&(e.dirlight_uLightDirection=t.lightDirection),e},dependencies:[un]},hn={pickingSelectedColor:null,pickingHighlightColor:new Uint8Array([0,255,255,255]),pickingThreshold:1,pickingActive:!1};var dn={name:"picking",vs:"uniform vec3 picking_uSelectedColor;\nuniform float picking_uThreshold;\nuniform bool picking_uSelectedColorValid;\n\nout vec4 picking_vRGBcolor_Aselected;\n\nconst float COLOR_SCALE = 1. / 255.;\n\nbool isVertexPicked(vec3 vertexColor) {\n  return\n    picking_uSelectedColorValid &&\n    abs(vertexColor.r - picking_uSelectedColor.r) < picking_uThreshold &&\n    abs(vertexColor.g - picking_uSelectedColor.g) < picking_uThreshold &&\n    abs(vertexColor.b - picking_uSelectedColor.b) < picking_uThreshold;\n}\n\nvoid picking_setPickingColor(vec3 pickingColor) {\n  picking_vRGBcolor_Aselected.a =\n    float(isVertexPicked(pickingColor));\n  picking_vRGBcolor_Aselected.rgb = pickingColor * COLOR_SCALE;\n}\n",fs:"uniform bool picking_uActive;\nuniform vec3 picking_uSelectedColor;\nuniform vec4 picking_uHighlightColor;\n\nin vec4 picking_vRGBcolor_Aselected;\n\nconst float COLOR_SCALE = 1. / 255.;\nvec4 picking_filterHighlightColor(vec4 color) {\n  bool selected = bool(picking_vRGBcolor_Aselected.a);\n\n  if (selected) {\n    vec4 highLightColor = picking_uHighlightColor * COLOR_SCALE;\n\n    float highLightAlpha = highLightColor.a;\n    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);\n    float highLightRatio = highLightAlpha / blendedAlpha;\n\n    vec3 blendedRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);\n    return vec4(blendedRGB, blendedAlpha);\n  } else {\n    return color;\n  }\n}\nvec4 picking_filterPickingColor(vec4 color) {\n  vec3 pickingColor = picking_vRGBcolor_Aselected.rgb;\n  if (picking_uActive && length(pickingColor) < 0.001) {\n    discard;\n  }\n  return picking_uActive ? vec4(pickingColor, 1.0) : color;\n}\nvec4 picking_filterColor(vec4 color) {\n  vec4 highightColor = picking_filterHighlightColor(color);\n  return picking_filterPickingColor(highightColor);\n}\n\n",getUniforms:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:hn,e={};if(void 0!==t.pickingSelectedColor)if(null===t.pickingSelectedColor)e.picking_uSelectedColorValid=0;else{var n=[t.pickingSelectedColor[0],t.pickingSelectedColor[1],t.pickingSelectedColor[2]];e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=n}return void 0!==t.pickingHighlightColor&&(e.picking_uHighlightColor=t.pickingHighlightColor),void 0!==t.pickingThreshold&&(e.picking_uThreshold=t.pickingThreshold),void 0!==t.pickingActive&&(e.picking_uActive=t.pickingActive?1:0),e}},pn={diffuseTexture:null,diffuseColor:[.5,.5,.5,1]};var gn={name:"diffuse",getUniforms:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pn,e={};return void 0!==t.diffuseTexture&&(e.diffuse_uHasTexture=Boolean(t.diffuseTexture),e.diffuse_uTexture=t.diffuseTexture),void 0!==t.diffuseColor&&(e.diffuse_uColor=t.diffuseColor),e},vs:"out vec2 diffuse_vTexCoord;\nvoid diffuse_setTextureCoordinate(vec2 uv) {\n  diffuse_vTexCoord = uv;\n}\n",fs:"uniform vec4 diffuse_uColor;\nuniform bool diffuse_uHasTexture;\nuniform sampler2D diffuse_uTexture;\n\nin vec2 diffuse_vTexCoord;\n\n\n\nvec4 diffuse_getColor() {\n  vec2 texCoord = diffuse_vTexCoord;\n  return diffuse_uHasTexture ?\n    texture2D(diffuse_uTexture, vec2(texCoord.s, texCoord.t)) :\n    diffuse_uColor;\n}\n\nvec4 diffuse_filterColor(vec4 color) {\n  return diffuse_getColor();\n}\n"},vn="void main() {}",yn="#version 300 es\n".concat(vn);function mn(t,e){e=Array.isArray(e)?e:[e];var n=t.replace(/^\s+/,"").split(/\s+/),r=Object(dt.a)(n,3),i=r[0],o=r[1],a=r[2];return e.includes(i)&&o&&a?{qualifier:i,type:o,name:a.split(";")[0]}:null}function bn(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.version,n=void 0===e?100:e,r=t.input,i=t.inputType,o=t.output;if(!r)return 300===n?yn:vn;var a=xn(r,i);return 300===n?"#version 300 es\nin ".concat(i," ").concat(r,";\nout vec4 ").concat(o,";\nvoid main() {\n  ").concat(o," = ").concat(a,";\n}"):"varying ".concat(i," ").concat(r,";\nvoid main() {\n  gl_FragColor = ").concat(a,";\n}")}function _n(t){switch(t){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return Ge()(!1),null}}function xn(t,e){switch(e){case"float":return"vec4(".concat(t,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(t,", 0.0, 1.0)");case"vec3":return"vec4(".concat(t,", 1.0)");case"vec4":return t;default:return Ge()(!1),null}}var wn={name:"transform",vs:"attribute float transform_elementID;\nvec2 transform_getPixelSizeHalf(vec2 size) {\n  return vec2(1.) / (2. * size);\n}\n\nvec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {\n  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);\n  float xIndex = transform_elementID - (yIndex * texSize[0]);\n  return vec2(xIndex, yIndex);\n}\nvec2 transform_getTexCoord(vec2 size) {\n  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);\n  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);\n  vec2 coord = indices / size + pixelSizeHalf;\n  return coord;\n}\nvec2 transform_getPos(vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);\n  return pos;\n}\nvec4 transform_getInput(sampler2D texSampler, vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec4 textureColor = texture2D(texSampler, texCoord);\n  return textureColor;\n}\n",fs:null},En=n(25),Sn=n.n(En),On={},Pn=function(t){On[t.id]||(On[t.id]=t,Sn.a.listItem("luma.gl",t.id))},Cn=function t(e,n,r){e&&(n.length>1?t(e[n[0]],n.slice(1),r):e[n[0]]=r)},Mn=new Map,In=function(t,e){if(m.d.__SEER_INITIALIZED__&&t){var n=Mn.get(t);n&&n.forEach((function(t,n){Cn(e,n,t)}))}};function An(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.header,n=void 0===e?"Uniforms":e,r=t.program,i=t.uniforms,o=t.undefinedOnly,a=void 0!==o&&o;Object(j.a)(r);var s=".*_.*",u=".*Matrix",c=r._uniformSetters,f={},h=Object.keys(c).sort(),d=0,p=!0,g=!1,v=void 0;try{for(var y,m=h[Symbol.iterator]();!(p=(y=m.next()).done);p=!0){var b=y.value;b.match(s)||b.match(u)||Tn({table:f,header:n,uniforms:i,uniformName:b,undefinedOnly:a})&&d++}}catch(t){g=!0,v=t}finally{try{p||null==m.return||m.return()}finally{if(g)throw v}}var _=!0,x=!1,w=void 0;try{for(var E,S=h[Symbol.iterator]();!(_=(E=S.next()).done);_=!0){var O=E.value;O.match(u)&&Tn({table:f,header:n,uniforms:i,uniformName:O,undefinedOnly:a})&&d++}}catch(t){x=!0,w=t}finally{try{_||null==S.return||S.return()}finally{if(x)throw w}}var P=!0,M=!1,I=void 0;try{for(var A,T=h[Symbol.iterator]();!(P=(A=T.next()).done);P=!0){var N=A.value;f[N]||Tn({table:f,header:n,uniforms:i,uniformName:N,undefinedOnly:a})&&d++}}catch(t){M=!0,I=t}finally{try{P||null==T.return||T.return()}finally{if(M)throw I}}var L=0,R={};if(!a)for(var k in i){var F=i[k];f[k]||(L++,R[k]=Object(C.a)({Type:"NOT USED: ".concat(F)},n,Object(l.b)(F)))}return{table:f,count:d,unusedTable:R,unusedCount:L}}function Tn(t){var e,n=t.table,r=t.header,i=t.uniforms,o=t.uniformName,a=t.undefinedOnly,s=i[o],u=function(t){return null!=t}(s);return(!a||!u)&&(n[o]=(e={},Object(C.a)(e,r,u?Object(l.b)(s):"N/A"),Object(C.a)(e,"Uniform Type",u?s:"NOT PROVIDED"),e),!0)}function Nn(t,e,n,r){var i,a,s,u,c=t.gl,f="NOT PROVIDED",h="N/A",d="N/A",p="N/A";if(n&&(f=n.type,h=n.size,a=-1!==(f=String(f).replace("Array","")).indexOf("nt")),e instanceof et.a){var g,v,y=e,m=y.getDebugData(),b=m.data;if(s=m.modified?"*":"",u=b,d=(p=y.byteLength)/b.BYTES_PER_ELEMENT/h,n){var _=n.divisor>0;v="".concat(_?"I ":"P "," ").concat(d," (x").concat(h,"=").concat(p," bytes ").concat(Object(o.d)(c,f),")")}else a=!0,v="".concat(p," bytes");return g={},Object(C.a)(g,r,"".concat(s).concat(Object(l.b)(u,{size:h,isInteger:a}))),Object(C.a)(g,"Format ",v),g}return u=e,h=e.length,a=-1!==(f=String(e.constructor.name).replace("Array","")).indexOf("nt"),i={},Object(C.a)(i,r,"".concat(Object(l.b)(u,{size:h,isInteger:a})," (constant)")),Object(C.a)(i,"Format ","".concat(h,"x").concat(f," (constant)")),i}function Ln(t,e){var n=Xt(e.type,e.size);return n?"".concat(t," (").concat(n.name,")"):t}function Rn(t){var e=t.accessor,n=Xt(e.type,e.size);return n?"".concat(n.name," ").concat(t.name):t.name}Sn.a.listenFor("luma.gl",(function(t){var e=On[t.itemKey];if(e&&"edit"===t.type&&"uniforms"===t.valuePath[0]){var n=t.valuePath.slice(1);!function(t,e,n){m.d.__SEER_INITIALIZED__&&(Mn.has(t)||Mn.set(t,new Map),Mn.get(t).set(e,n))}(t.itemKey,n,t.value);var r=e.getUniforms();Cn(r,n,t.value),e.setUniforms(r)}}));var kn=["renderPickingBuffer","pickingEnabled"],jn=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(y.a)(this,e),n=Object(nt.a)(this,Object(rt.a)(e).call(this,r)),Object(j.a)(Object(a.m)(t)),n.gl=t,n.lastLogTime=0,n.initialize(r),n}return Object(it.a)(e,t),Object(L.a)(e,[{key:"initialize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.props={},this.program=this._createProgram(t),this.vertexArray=new le(this.gl,{program:this.program}),this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.animatedUniforms={},this.animated=!1,this.animationLoop=null,this.timerQueryEnabled=!1,this.timeElapsedQuery=void 0,this.lastQueryReturned=!0,this.stats={accumulatedFrameTime:0,averageFrameTime:0,profileFrameCount:0},this.pickable=!0,this.setProps(t),this.setUniforms(Object.assign({},this.getModuleUniforms(),this.getModuleUniforms(t.moduleSettings))),this.isInstanced=t.isInstanced||t.instanced,this.onBeforeRender=t.onBeforeRender||function(){},this.onAfterRender=t.onAfterRender||function(){},Object(j.a)(void 0!==this.drawMode&&Number.isFinite(this.vertexCount),"Model needs drawMode and vertexCount")}},{key:"setProps",value:function(t){Object.assign(this.props,t),"instanceCount"in t&&(this.instanceCount=t.instanceCount),"geometry"in t&&this.setGeometry(t.geometry),"attributes"in t&&this.setAttributes(t.attributes),"uniforms"in t&&this.setUniforms(t.uniforms,t.samplers),"pickable"in t&&(this.pickable=t.pickable),"timerQueryEnabled"in t&&(this.timerQueryEnabled=t.timerQueryEnabled&&Qt.isSupported(this.gl,["timers"]),t.timerQueryEnabled&&!this.timerQueryEnabled&&l.g.warn("GPU timer not supported")()),"_feedbackBuffers"in t&&this._setFeedbackBuffers(t._feedbackBuffers),"_animationProps"in t&&this._setAnimationProps(t._animationProps),"_animationLoop"in t&&(this.animationLoop=t._animationLoop)}},{key:"delete",value:function(){for(var t in this._attributes)this._attributes[t]!==this.attributes[t]&&this._attributes[t].delete();var e;this.program.delete(),this.vertexArray.delete(),e=this.id,delete On[e],Sn.a.deleteItem("luma.gl",e)}},{key:"destroy",value:function(){this.delete()}},{key:"getNeedsRedraw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.clearRedrawFlags,n=void 0!==e&&e,r=!1;return r=r||this.needsRedraw,this.needsRedraw=this.needsRedraw&&!n,this.geometry&&(r=r||this.geometry.getNeedsRedraw({clearRedrawFlags:n})),this.animated&&(r=r||"animated model ".concat(this.id)),r}},{key:"getDrawMode",value:function(){return this.drawMode}},{key:"getVertexCount",value:function(){return this.vertexCount}},{key:"getInstanceCount",value:function(){return this.instanceCount}},{key:"getProgram",value:function(){return this.program}},{key:"getAttributes",value:function(){return this.attributes}},{key:"getUniforms",value:function(){return this.program.getUniforms}},{key:"setNeedsRedraw",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.needsRedraw=t,this}},{key:"setDrawMode",value:function(t){return this.props.drawMode=be(t),this}},{key:"setVertexCount",value:function(t){return Object(j.a)(Number.isFinite(t)),this.props.vertexCount=t,this}},{key:"setInstanceCount",value:function(t){return Object(j.a)(Number.isFinite(t)),this.instanceCount=t,this}},{key:"setGeometry",value:function(t){this.geometry=t;var e=this._createBuffersFromAttributeDescriptors(this.geometry.getAttributes());return this.vertexArray.setAttributes(e),this.setNeedsRedraw(),this}},{key:"setAttributes",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Object(l.d)(t))return this;Object.assign(this.attributes,t);var e=this._createBuffersFromAttributeDescriptors(t);return this.vertexArray.setAttributes(e),this.setNeedsRedraw(),this}},{key:"setUniforms",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e=Object.assign({},e),In(this.id,e),e=this._extractAnimatedUniforms(e),this.program.setUniforms(e,n,(function(){t._checkForDeprecatedUniforms(e),t.setNeedsRedraw()}))}},{key:"_setAnimationProps",value:function(t){var e=this;if(this.animated){Object(j.a)(t,"Model.draw(): animated uniforms but no animationProps");var n=this._evaluateAnimateUniforms(t);this.program.setUniforms(n,{},(function(){e._checkForDeprecatedUniforms(n),e.setNeedsRedraw()}))}}},{key:"updateModuleSettings",value:function(t){var e=this.getModuleUniforms(t||{});return this.setUniforms(e)}},{key:"clear",value:function(t){return bt(this.program.gl,t),this}},{key:"draw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.moduleSettings,n=void 0===e?null:e,r=t.framebuffer,i=t.uniforms,o=void 0===i?{}:i,a=t.attributes,s=void 0===a?{}:a,u=t.samplers,c=void 0===u?{}:u,f=t.transformFeedback,h=void 0===f?this.transformFeedback:f,d=t.parameters,p=void 0===d?{}:d,g=t.vertexArray,v=void 0===g?this.vertexArray:g,y=t.animationProps;Pn(this),this.setAttributes(s),this.updateModuleSettings(n),this.setUniforms(o,c),this._refreshAnimationProps(y);var m=this._logDrawCallStart(2),b=this.vertexArray.getDrawParams(this.props);b.isInstanced&&!this.isInstanced&&l.g.warn("Found instanced attributes on non-instanced model",this.id)();var _=b.isIndexed,x=b.indexType,w=this.isInstanced,E=this.instanceCount;return this.onBeforeRender(),this._timerQueryStart(),this.program.draw(Object.assign({},t,{logPriority:m,uniforms:null,framebuffer:r,parameters:p,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:v,transformFeedback:h,isIndexed:_,indexType:x,isInstanced:w,instanceCount:E})),this._timerQueryEnd(),this.onAfterRender(),this.setNeedsRedraw(!1),this._logDrawCallEnd(m,v,r),this}},{key:"transform",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.discard,n=void 0===e||e,r=t.feedbackBuffers,i=t.unbindModels,o=void 0===i?[]:i,a=t.parameters;r&&this._setFeedbackBuffers(r),n&&(a=Object.assign({},a,Object(C.a)({},35977,n))),o.forEach((function(t){return t.vertexArray.unbindBuffers()}));try{this.draw(Object.assign({},t,{parameters:a}))}finally{o.forEach((function(t){return t.vertexArray.bindBuffers()}))}return this}},{key:"render",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(j.a)(arguments.length<=1),this.draw({uniforms:t})}},{key:"_createProgram",value:function(t){var e=t.vs,n=void 0===e?null:e,r=t.fs,i=void 0===r?null:r,o=t.modules,a=void 0===o?null:o,s=t.defines,u=void 0===s?{}:s,c=t.inject,f=void 0===c?{}:c,h=t.shaderCache,d=void 0===h?null:h,p=t.varyings,g=void 0===p?null:p,v=t.bufferMode,y=void 0===v?35981:v,m=t.program,b=void 0===m?null:m;this.getModuleUniforms=function(t){};var _=this.id;if(!b){n=n||xe,i=i||we;var x=Ye(this.gl,{vs:n,fs:i,modules:a,inject:f,defines:u,log:l.g});n=x.vs,i=x.fs,b=d?d.getProgram(this.gl,{id:_,vs:n,fs:i}):new Yt(this.gl,{id:_,vs:n,fs:i,varyings:g,bufferMode:y}),this.getModuleUniforms=x.getUniforms||function(t){}}return Object(j.a)(b instanceof Yt,"Model needs a program"),b}},{key:"_checkForDeprecatedUniforms",value:function(t){kn.forEach((function(e){e in t&&l.g.deprecated(e,"use picking shader module and Model class updateModuleSettings()")()}))}},{key:"_refreshAnimationProps",value:function(t){(t=t||this.animationLoop&&this.animationLoop.animationProps)&&this._setAnimationProps(t)}},{key:"_evaluateAnimateUniforms",value:function(t){if(!this.animated)return{};var e={};for(var n in this.animatedUniforms){var r=this.animatedUniforms[n];e[n]=r(t)}return e}},{key:"_extractAnimatedUniforms",value:function(t){var e=!1;for(var n in t){var r=t[n];"function"==typeof r?(this.animatedUniforms[n]=r,e=!0):delete this.animatedUniforms[n]}if(this.animated=!Object(l.d)(this.animatedUniforms),!e)return t;var i={};for(var o in t)this.animatedUniforms[o]||(i[o]=t[o]);return i}},{key:"_setFeedbackBuffers",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Object(l.d)(t))return this;var e=this.program.gl;return this.transformFeedback=this.transformFeedback||new ee(e,{program:this.program}),this.transformFeedback.setBuffers(t),this.setNeedsRedraw(),this}},{key:"_timerQueryStart",value:function(){!0===this.timerQueryEnabled&&(this.timeElapsedQuery||(this.timeElapsedQuery=new Qt(this.gl)),this.lastQueryReturned&&(this.lastQueryReturned=!1,this.timeElapsedQuery.beginTimeElapsedQuery()))}},{key:"_timerQueryEnd",value:function(){if(!0===this.timerQueryEnabled&&(this.timeElapsedQuery.end(),this.timeElapsedQuery.isResultAvailable())){this.lastQueryReturned=!0;var t=this.timeElapsedQuery.getResult();this.stats.lastFrameTime=t,this.stats.accumulatedFrameTime+=t,this.stats.profileFrameCount++,this.stats.averageFrameTime=this.stats.accumulatedFrameTime/this.stats.profileFrameCount,l.g.log(2,"GPU time ".concat(this.program.id,": ").concat(this.stats.lastFrameTime,"ms average ").concat(this.stats.averageFrameTime,"ms accumulated: ").concat(this.stats.accumulatedFrameTime,"ms count: ").concat(this.stats.profileFrameCount))()}}},{key:"_createBuffersFromAttributeDescriptors",value:function(t){var e=this.program.gl,n={};for(var r in t){var i=t[r],o=this._attributes[r];i instanceof ye?o=i:i instanceof et.a?(o=o||new ye(e,Object.assign({},i,i.layout,{id:r}))).update({buffer:i}):o?o.update(i):o=new ye(e,Object.assign({},i,{id:r})),this._attributes[r]=o,n[r]=o.getValue()}return n}},{key:"_logDrawCallStart",value:function(t){var e=t>3?0:1e4;if(!(l.g.priority<t||Date.now()-this.lastLogTime<e))return this.lastLogTime=Date.now(),l.g.group(2,">>> DRAWING MODEL ".concat(this.id),{collapsed:l.g.priority<=2})(),t}},{key:"_logDrawCallEnd",value:function(t,e,n,r){if(void 0!==t){var i=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.vertexArray,n=t.header,r=void 0===n?"Attributes":n;if(!e.configuration)return{};var i={};e.elements&&(i.ELEMENT_ARRAY_BUFFER=Nn(e,e.elements,null,r));var o=e.values;for(var a in o){var s=e._getAttributeInfo(a);if(s){var u="".concat(a,": ").concat(s.name),c=e.accessors[s.location];c&&(u="".concat(a,": ").concat(Ln(s.name,c))),i[u]=Nn(e,o[a],c,r)}}return i}({vertexArray:e,header:"".concat(this.id," attributes"),attributes:this._attributes}),o=An({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,n)}),a=o.table,s=o.unusedTable,u=o.unusedCount,c=An({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,n),undefinedOnly:!0}),f=c.table;c.count>0&&l.g.log("MISSING UNIFORMS",Object.keys(f))(),u>0&&l.g.log("UNUSED UNIFORMS",Object.keys(s))();var h=function(t){var e={},n="Accessors for ".concat(t.id),r=!0,i=!1,o=void 0;try{for(var a,s=t.attributeInfos[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;if(u){var c=Rn(u);e["in ".concat(c)]=Object(C.a)({},n,JSON.stringify(u.accessor))}}}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}var l=!0,f=!1,h=void 0;try{for(var d,p=t.varyingInfos[Symbol.iterator]();!(l=(d=p.next()).done);l=!0){var g=d.value;if(g){var v=Rn(g);e["out ".concat(v)]=Object(C.a)({},n,JSON.stringify(g.accessor))}}}catch(t){f=!0,h=t}finally{try{l||null==p.return||p.return()}finally{if(f)throw h}}return e}(this.vertexArray.configuration);l.g.table(t,i)(),l.g.table(t,a)(),l.g.table(t+1,h)(),function(t,e){if(Sn.a.isReady()&&!Sn.a.throttle("luma.gl:".concat(t.id),1e3)){var n=t.geometry?Object.assign({},t.geometry.attributes,t.attributes):t.attributes,r=Object.assign({},t.uniforms,e);Sn.a.multiUpdate("luma.gl",t.id,[{path:"objects.uniforms",data:r},{path:"objects.attributes",data:n}])}}(this,n),r&&r.log({priority:2,message:"Rendered to ".concat(r.id)}),l.g.groupEnd(2,">>> DRAWING MODEL ".concat(this.id))()}}},{key:"vertexCount",get:function(){return Number.isFinite(this.props.vertexCount)?this.props.vertexCount:this.geometry&&this.geometry.getVertexCount()}},{key:"drawMode",get:function(){return Number.isFinite(this.props.drawMode)?this.props.drawMode:this.geometry&&this.geometry.drawMode}}]),e}(pe),Fn=n(22),Dn={preserveDrawingBuffer:!0},Bn=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(y.a)(this,t);var n=e.onCreateContext,r=void 0===n?function(t){return V(t)}:n,i=e.onAddHTML,o=void 0===i?null:i,a=e.onInitialize,s=void 0===a?function(){}:a,u=e.onRender,c=void 0===u?function(){}:u,f=e.onFinalize,h=void 0===f?function(){}:f,d=e.gl,p=void 0===d?null:d,g=e.glOptions,v=void 0===g?{}:g,m=e.debug,b=void 0!==m&&m,_=e.createFramebuffer,x=void 0!==_&&_,w=e.autoResizeViewport,E=void 0===w||w,S=e.autoResizeDrawingBuffer,O=void 0===S||S,P=e.useDevicePixels,C=void 0===P||P;return"useDevicePixelRatio"in e&&(l.g.deprecated("useDevicePixelRatio","useDevicePixels")(),C=e.useDevicePixelRatio),this.props={onCreateContext:r,onAddHTML:o,onInitialize:s,onRender:c,onFinalize:h,gl:p,glOptions:v,debug:b,createFramebuffer:x},this.gl=p,this.needsRedraw=null,this._initialized=!1,this._running=!1,this._animationFrameId=null,this._startPromise=null,this.setProps({autoResizeViewport:E,autoResizeDrawingBuffer:O,useDevicePixels:C}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this),this}return Object(L.a)(t,[{key:"setNeedsRedraw",value:function(t){return Object(j.a)("string"==typeof t),this.needsRedraw=this.needsRedraw||t,this}},{key:"setProps",value:function(t){return"autoResizeViewport"in t&&(this.autoResizeViewport=t.autoResizeViewport),"autoResizeDrawingBuffer"in t&&(this.autoResizeDrawingBuffer=t.autoResizeDrawingBuffer),"useDevicePixels"in t&&(this.useDevicePixels=t.useDevicePixels),this}},{key:"start",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._running||(this._running=!0,this._startPromise=d().then((function(){if(!t._running||t._initialized)return null;t._createWebGLContext(e),t._createFramebuffer(),t._startEventHandling(),t._initializeCallbackData(),t._updateCallbackData(),t._resizeCanvasDrawingBuffer(),t._resizeViewport();var n=t.onInitialize(t.animationProps);return t._initialized=!0,n})).then((function(e){t._running&&(t._addCallbackData(e||{}),!1!==e&&t._startLoop())}))),this}},{key:"redraw",value:function(){return this._setupFrame(),this._updateCallbackData(),this.onRender(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this}},{key:"stop",value:function(){return this._running&&(this._finalizeCallbackData(),Object(a.f)(this._animationFrameId),this._animationFrameId=null,this._running=!1),this}},{key:"onCreateContext",value:function(){var t;return(t=this.props).onCreateContext.apply(t,arguments)}},{key:"onInitialize",value:function(){var t;return(t=this.props).onInitialize.apply(t,arguments)}},{key:"onRender",value:function(){var t;return(t=this.props).onRender.apply(t,arguments)}},{key:"onFinalize",value:function(){var t;return(t=this.props).onFinalize.apply(t,arguments)}},{key:"getHTMLControlValue",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=document.getElementById(t);return n?Number(n.value):e}},{key:"setViewParameters",value:function(){return l.g.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}},{key:"_startLoop",value:function(){var t=this;Object(a.f)(this._animationFrameId),this._animationFrameId=Object(a.p)((function e(){t._running&&(t.redraw(),t._animationFrameId=Object(a.p)(e))}))}},{key:"_clearNeedsRedraw",value:function(){this.needsRedraw=null}},{key:"_setupFrame",value:function(){this._onSetupFrame?this._onSetupFrame(this.animationProps):(this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer())}},{key:"_initializeCallbackData",value:function(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),time:0,tick:0,tock:0,_loop:this,_animationLoop:this,_mousePosition:null}}},{key:"_updateCallbackData",value:function(){var t=this._getSizeAndAspect(),e=t.width,n=t.height,r=t.aspect;e===this.animationProps.width&&n===this.animationProps.height||this.setNeedsRedraw("drawing buffer resized"),r!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=n,this.animationProps.aspect=r,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.time=Date.now()-this.animationProps.startTime,this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps._offScreen=this.offScreen}},{key:"_finalizeCallbackData",value:function(){this.onFinalize(this.animationProps)}},{key:"_addCallbackData",value:function(t){"object"===Object(Fn.a)(t)&&null!==t&&(this.animationProps=Object.assign({},this.animationProps,t))}},{key:"_createWebGLContext",value:function(t){if(this.offScreen=t.canvas&&"undefined"!=typeof OffscreenCanvas&&t.canvas instanceof OffscreenCanvas,t=Object.assign({},t,Dn,this.props.glOptions),this.gl=this.props.gl||this.onCreateContext(t),!Object(a.m)(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");this.props.debug&&(this.gl=_(this.gl)),Object(X.d)(this.gl),this._createInfoDiv()}},{key:"_createInfoDiv",value:function(){if(this.gl.canvas&&this.props.onAddHTML){var t=document.createElement("div");document.body.appendChild(t),t.style.position="relative";var e=document.createElement("div");e.style.position="absolute",e.style.left="10px",e.style.bottom="10px",e.style.width="300px",e.style.background="white",t.appendChild(this.gl.canvas),t.appendChild(e);var n=this.props.onAddHTML(e);n&&(e.innerHTML=n)}}},{key:"_getSizeAndAspect",value:function(){var t=this.gl.drawingBufferWidth,e=this.gl.drawingBufferHeight,n=1,r=this.gl.canvas,i=r.clientWidth,o=r.clientHeight;return i>=0&&o>=0?n=e>0?i/o:1:t>0&&e>0&&(n=t/e),{width:t,height:e,aspect:n}}},{key:"_resizeViewport",value:function(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}},{key:"_resizeCanvasDrawingBuffer",value:function(){this.autoResizeDrawingBuffer&&U(this.gl,{useDevicePixels:this.useDevicePixels})}},{key:"_createFramebuffer",value:function(){this.props.createFramebuffer&&(this.framebuffer=new Et(this.gl))}},{key:"_resizeFramebuffer",value:function(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}},{key:"_startEventHandling",value:function(){this.gl.canvas.addEventListener("mousemove",this._onMousemove),this.gl.canvas.addEventListener("mouseleave",this._onMouseleave)}},{key:"_onMousemove",value:function(t){this.animationProps._mousePosition=[t.offsetX,t.offsetY]}},{key:"_onMouseleave",value:function(t){this.animationProps._mousePosition=null}}]),t}();function zn(t,e){var n=e.models,r=e.position,i=e.uniforms,o=void 0===i?{}:i,a=e.parameters,s=void 0===a?{}:a,u=e.settings,c=e.useDevicePixels,l=void 0===c||c,f=e.framebuffer,h=e.context;Object(j.a)(F(t)&&f&&r);var d=Object(dt.a)(r,2),p=d[0],g=d[1];f.resize({width:t.canvas.width,height:t.canvas.height});var v=l&&"undefined"!=typeof window?window.devicePixelRatio:1,y=p*v,m=t.canvas.height-g*v;return new ve({children:n}).traverseReverse((function(n){if(n.pickable){bt(t,{framebuffer:f,color:!0,depth:!0}),n.setUniforms({picking_uActive:1}),n.draw(Object.assign({},e,{uniforms:o,parameters:s,settings:u,framebuffer:f,context:h})),n.setUniforms({picking_uActive:0});var r=f.readPixels({x:y,y:m,width:1,height:1,format:6408,type:5121});if(0!==r[0]||0!==r[1]||0!==r[2])return{model:n,color:r,x:p,y:g,deviceX:y,deviceY:m}}return null}))}var Vn=new Uint8Array([0,0,0]);function Gn(t){return[t+1&255,t+1>>8&255,t+1>>16&255]}function Un(t){var e=Object(dt.a)(t,3);return e[0]+256*e[1]+65536*e[2]-1}function Wn(){return Vn}var qn;function Xn(t){var e=t.vs,n=t.sourceTextureMap,r=t.targetTextureVarying,i=t.targetTexture,o=Object.keys(n).length,a=null,s={},u=e,c={};if(o>0||r){var l=u.split("\n"),f=l.slice();if(l.forEach((function(t,e,i){if(o>0){var u=function(t,e){var n={},r=function(t){return mn(t,["attribute","in"])}(t);if(!r)return null;var i=r.type,o=r.name;if(o&&e[o]){var a="// ".concat(t," => Replaced by Transform with a sampler"),s=function(t){var e="".concat("transform_uSampler_").concat(t),n="".concat("transform_uSize_").concat(t),r="  uniform sampler2D ".concat(e,";\n  uniform vec2 ").concat(n,";");return{samplerName:e,sizeName:n,uniformDeclerations:r}}(o),u=s.samplerName,c=s.sizeName,l=s.uniformDeclerations,f=function(t){switch(t){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return Ge()(!1),null}}(i),h="  ".concat(i," ").concat(o," = transform_getInput(").concat(u,", ").concat(c,").").concat(f,";\n");return n[u]=o,{updatedLine:a,inject:{"vs:#decl":l,"vs:#main-start":h},samplerTextureMap:n}}return null}(t,n);if(u){var l=u.updatedLine,h=u.inject;f[e]=l,c=Xe([c,h]),Object.assign(s,u.samplerTextureMap),o--}}r&&!a&&(a=function(t,e){var n=mn(t,["varying","out"]);if(!n)return null;return n.name===e?n.type:null}(t,r))})),r){Ge()(i);var h="".concat("transform_uSize_").concat(r),d="uniform vec2 ".concat(h,";\n"),p="     vec2 ".concat("transform_position"," = transform_getPos(").concat(h,");\n     gl_Position = vec4(").concat("transform_position",", 0, 1.);\n");c=Xe([c,{"vs:#decl":d,"vs:#main-start":p}])}u=f.join("\n")}return{vs:u,targetTextureType:a,inject:c,samplerTextureMap:s}}var Hn=(qn={},Object(C.a)(qn,10241,9728),Object(C.a)(qn,10240,9728),Object(C.a)(qn,10242,33071),Object(C.a)(qn,10243,33071),qn),Yn=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(y.a)(this,t),Object(a.d)(e),this.gl=e,this.model=null,this.elementCount=0,this.currentIndex=0,this.sourceBuffers=new Array(2),this.sourceTextures=new Array(2),this.feedbackBuffers=new Array(2),this.targetTextures=new Array(2),this.transformFeedbacks=new Array(2),this.framebuffers=new Array(2),this._createdBuffers={},this.elementIDBuffer=null,this._targetRefTexName=null,this._initialize(n),Object.seal(this)}return Object(L.a)(t,null,[{key:"isSupported",value:function(t){return Object(a.n)(t)}}]),Object(L.a)(t,[{key:"delete",value:function(){for(var t in this._createdBuffers)this._createdBuffers[t].delete();this.model.delete()}},{key:"getBuffer",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=t?this.feedbackBuffers[this.currentIndex][t]:null;return e?e instanceof et.a?e:e.buffer:null}},{key:"_getTargetTexture",value:function(){return this.framebuffers[this.currentIndex]?this.framebuffers[this.currentIndex].attachments[36064]:null}},{key:"getData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.varyingName,n=void 0===e?null:e,r=t.packed,i=void 0!==r&&r,o=this.getBuffer(n);if(o)return o.getData();Object(j.a)(!n||n===this.targetTextureVarying);var a=this.framebuffers[this.currentIndex].readPixels();if(!i)return a;for(var s=a.constructor,u=_n(this.targetTextureType),c=new s(a.length*u/4),l=0,f=0;f<a.length;f+=4)for(var h=0;h<u;h++)c[l++]=a[f+h];return c}},{key:"getFramebuffer",value:function(){return this.framebuffers[this.currentIndex]}},{key:"_getInputs",value:function(){var t={},e=this.currentIndex,n=Object.assign({},this.sourceBuffers[e]);if(this.hasSourceTextures||this.targetTextureVarying){for(var r in n.transform_elementID=this.elementIDBuffer,this.samplerTextureMap){var i=this.samplerTextureMap[r];t[r]=this.sourceTextures[e][i]}this._setSourceTextureParameters();var o=function(t){var e,n,r=t.sourceTextureMap,i=t.targetTextureVarying,o=t.targetTexture,a={};for(var s in i&&(e=o.width,n=o.height,a["".concat("transform_uSize_").concat(i)]=[e,n]),r){var u=r[s];e=u.width,n=u.height,a["".concat("transform_uSize_").concat(s)]=[e,n]}return a}({sourceTextureMap:this.sourceTextures[e],targetTextureVarying:this.targetTextureVarying,targetTexture:this.targetTextures[e]});Object.assign(t,o)}return{attributes:n,uniforms:t}}},{key:"run",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this._getInputs(),n=e.attributes,r=e.uniforms;Object.assign(r,t.uniforms);var i=Object.assign({},t.parameters),o=t.clearRenderTarget,a=void 0===o||o,s=null,u=!0;this.renderingToTexture&&(u=!1,s=this.framebuffers[this.currentIndex],Object(j.a)(s),i.viewport=[0,0,s.width,s.height],a&&this.gl.clear(this.gl.COLOR_BUFFER_BIT)),this.model.setAttributes(n),this.model.transform(Object.assign({},t,{transformFeedback:this.transformFeedbacks[this.currentIndex],uniforms:r,discard:u,framebuffer:s,parameters:i}))}},{key:"swapBuffers",value:function(){l.g.deprecated("swapBuffers()","swap()"),this.swap()}},{key:"swap",value:function(){Object(j.a)(this.feedbackMap||this._swapTexture),this.currentIndex=(this.currentIndex+1)%2}},{key:"update",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.elementCount&&this._setElementCount(t.elementCount);var e=t.sourceBuffers,n=void 0===e?null:e,r=t.feedbackBuffers,i=void 0===r?null:r,o=this.currentIndex;if(n||i){for(var a in i)Object(j.a)(i[a]instanceof et.a||i[a].buffer instanceof et.a);Object.assign(this.sourceBuffers[o],n),Object.assign(this.feedbackBuffers[o],i),this._createFeedbackBuffers({feedbackBuffers:i}),this.transformFeedbacks[o]&&this.transformFeedbacks[o].setBuffers(this.feedbackBuffers[o]),this._setupSwapBuffers()}var s=t._sourceTextures,u=t._targetTexture;(s||u)&&(Object.assign(this.sourceTextures[o],s),this._updateTargetTexture(u||this._targetRefTexName,o),this._setupSwapTextures())}},{key:"_setSourceTextureParameters",value:function(){var t=this.currentIndex;for(var e in this.sourceTextures[t])this.sourceTextures[t][e].setParameters(Hn)}},{key:"_setElementCount",value:function(t){this.elementCount!==t&&(this.elementCount<t&&this._updateElementIDBuffer(t),this.model.setVertexCount(t),this.elementCount=t)}},{key:"_updateTargetTexture",value:function(t,e){var n=this._buildTargetTexture(t);n&&(this.targetTextures[e]=n,this.framebuffers[e]&&(this.framebuffers[e].update({attachments:Object(C.a)({},36064,this.targetTextures[e]),resizeAttachments:!1}),this.framebuffers[e].resize({width:n.width,height:n.height})))}},{key:"_initialize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this._validateProps(t),n=e.feedbackBuffers,r=e.feedbackMap,i=t.sourceBuffers,o=t.varyings,a=t._targetTexture,s=t._targetTextureVarying,u=t._swapTexture,c=o;r&&!Array.isArray(o)&&(c=Object.values(r)),this.varyingsArray=c,this.feedbackMap=r,this._swapTexture=u,a&&(this.targetTextureVarying=s,this.renderingToTexture=!0,Object(j.a)(this.targetTextureVarying)),this._setupBuffers({sourceBuffers:i,feedbackBuffers:n}),this._setupTextures(t),this._setupSwapBuffers(),this._setupSwapTextures(),this._buildModel(Object.assign({},t,{id:t.id||"transform-model",drawMode:t.drawMode||0,varyings:c}))}},{key:"_validateProps",value:function(t){var e=t.feedbackBuffers,n=t.feedbackMap,r=t.destinationBuffers,i=t.sourceDestinationMap;r&&(l.g.deprecated("destinationBuffers","feedbackBuffers")(),e=e||r),i&&(l.g.deprecated("sourceDestinationMap","feedbackMap")(),n=n||i);var o=t.vs,a=t.elementCount,s=t.varyings,u=t._sourceTextures,c=t._targetTexture,f=t._targetTextureVarying,h=t._swapTexture;for(var d in Object(j.a)(o&&(s||n||c)&&a),e||{})Object(j.a)(e[d]instanceof et.a||e[d].buffer instanceof et.a);for(var p in u||{})Object(j.a)(u[p]instanceof pt.a);return Object(j.a)(!c||f),Object(j.a)(!h||u[h]),{feedbackBuffers:e,feedbackMap:n}}},{key:"_setupBuffers",value:function(t){var e=t.sourceBuffers,n=void 0===e?null:e,r=t.feedbackBuffers,i=void 0===r?null:r;this.sourceBuffers[0]=Object.assign({},n),this.feedbackBuffers[0]=Object.assign({},i),this._createFeedbackBuffers({feedbackBuffers:i}),this.sourceBuffers[1]={},this.feedbackBuffers[1]={}}},{key:"_setupTextures",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t._sourceTextures,n=t._targetTexture;if(this.sourceTextures[0]=Object.assign({},e),this.sourceTextures[1]={},this.hasSourceTextures=Object.keys(this.sourceTextures[0]).length>0,this.targetTextureVarying){var r=this._buildTargetTexture(n);Object(j.a)(r),this.targetTextures[0]=r,this.targetTextures[1]=null}}},{key:"_buildTargetTexture",value:function(t){var e;if(t instanceof pt.a)return t;var n=this.sourceTextures[0][t];return n?(this._targetRefTexName=t,Object(a.g)(n,{parameters:(e={},Object(C.a)(e,10241,9728),Object(C.a)(e,10240,9728),Object(C.a)(e,10242,33071),Object(C.a)(e,10243,33071),e),pixelStore:Object(C.a)({},37440,!1)})):null}},{key:"_createFeedbackBuffers",value:function(t){var e=t.feedbackBuffers;if(this.feedbackMap){var n=this.currentIndex;for(var r in this.feedbackMap){var i=this.feedbackMap[r];if(!(i===this.targetTextureVarying||e&&e[i])){var o=this.sourceBuffers[n][r],a=o.bytes,s=o.type,u=o.usage,c=o.accessor,l=new et.a(this.gl,{bytes:a,type:s,usage:u,accessor:c});this._createdBuffers[i]&&this._createdBuffers[i].delete(),this._createdBuffers[i]=l,this.feedbackBuffers[n][i]=l}}}}},{key:"_createNewBuffer",value:function(t,e){var n=new et.a(this.gl,e);return this._createdBuffers[t]&&(this._createdBuffers[t].delete(),this._createdBuffers[t]=n),n}},{key:"_setupSwapBuffers",value:function(){if(this.feedbackMap){var t=this.currentIndex,e=(t+1)%2;for(var n in Object.assign(this.sourceBuffers[e],this.sourceBuffers[t]),Object.assign(this.feedbackBuffers[e],this.feedbackBuffers[t]),this.feedbackMap){var r=this.feedbackMap[n];r!==this.targetTextureVarying&&(this.sourceBuffers[e][n]=this.feedbackBuffers[t][r],this.feedbackBuffers[e][r]=this.sourceBuffers[t][n],Object(j.a)(this.feedbackBuffers[e][r]instanceof et.a))}this.transformFeedbacks[e]&&this.transformFeedbacks[e].setBuffers(this.feedbackBuffers[e])}}},{key:"_setupSwapTextures",value:function(){if(this._swapTexture&&this.targetTextureVarying){var t=this.currentIndex,e=(t+1)%2;Object.assign(this.sourceTextures[e],this.sourceTextures[t]),this.sourceTextures[e][this._swapTexture]=this.targetTextures[t],this._updateTargetTexture(this.sourceTextures[t][this._swapTexture],e)}}},{key:"_buildModel",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this._getShaders(t),n=e.vs,r=e.fs,i=e.modules,o=e.uniforms,a=e.inject,s=e.samplerTextureMap;this.model=new jn(this.gl,Object.assign({},t,{vs:n,fs:r,vertexCount:t.elementCount,modules:i,uniforms:o,inject:a})),this.samplerTextureMap=s,this._setupTransformFeedback(),this._setupFramebuffers(),this._setElementCount(t.elementCount)}},{key:"_setupTransformFeedback",value:function(){Object(l.d)(this.feedbackBuffers[0])||(this.transformFeedbacks[0]=new ee(this.gl,{program:this.model.program,buffers:this.feedbackBuffers[0]}),this.feedbackMap&&(this.transformFeedbacks[1]=new ee(this.gl,{program:this.model.program,buffers:this.feedbackBuffers[1]})))}},{key:"_setupFramebuffers",value:function(){if(this.renderingToTexture){var t=this.targetTextures[0],e=t.width,n=t.height;if(this.framebuffers[0]=new Et(this.gl,{id:"".concat(this.id||"transform","-framebuffer-0"),width:e,height:n,attachments:Object(C.a)({},36064,this.targetTextures[0])}),this._swapTexture){var r=this.targetTextures[1];e=r.width,n=r.height,this.framebuffers[1]=new Et(this.gl,{id:"".concat(this.id||"transform","-framebuffer-1"),width:e,height:n,attachments:Object(C.a)({},36064,this.targetTextures[1])})}}}},{key:"_updateElementIDBuffer",value:function(t){if(this.hasSourceTextures||this.targetTextureVarying){var e=new Float32Array(t);e.forEach((function(t,e,n){n[e]=e})),this.elementIDBuffer?this.elementIDBuffer.setData({data:e}):this.elementIDBuffer=new et.a(this.gl,{data:e,size:1})}}},{key:"_getShaders",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this._processVertexShader(t.vs),n=e.vs,r=e.uniforms,i=e.targetTextureType,o=e.inject,s=e.samplerTextureMap,u=Xe([t.inject||{},o]);this.targetTextureType=i;var c=bn({version:Object(a.l)(n),input:this.targetTextureVarying,inputType:i,output:"transform_output"}),l=this.hasSourceTextures||this.targetTextureVarying?[wn].concat(t.modules||[]):t.modules;return{vs:n,fs:c,modules:l,uniforms:r,inject:u,samplerTextureMap:s}}},{key:"_processVertexShader",value:function(t){return Xn({vs:t,sourceTextureMap:this.sourceTextures[this.currentIndex],targetTextureVarying:this.targetTextureVarying,targetTexture:this.targetTextures[this.currentIndex]})}}]),t}(),Zn=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.gl,r=e._cachePrograms,i=void 0!==r&&r;Object(y.a)(this,t),Object(j.a)(n),this.gl=n,this.vertexShaders={},this.fragmentShaders={},this.programs={},this._cachePrograms=i}return Object(L.a)(t,[{key:"delete",value:function(){return this}},{key:"getVertexShader",value:function(t,e){Object(j.a)("string"==typeof e),Object(j.a)(this._compareContexts(t,this.gl));var n=this.vertexShaders[e];return n||(n=new st(t,e),this.vertexShaders[e]=n),n}},{key:"getFragmentShader",value:function(t,e){Object(j.a)("string"==typeof e),Object(j.a)(this._compareContexts(t,this.gl));var n=this.fragmentShaders[e];return n||(n=new ut(t,e),this.fragmentShaders[e]=n),n}},{key:"getProgram",value:function(t,e){Object(j.a)(this._compareContexts(t,this.gl)),Object(j.a)("string"==typeof e.vs),Object(j.a)("string"==typeof e.fs),Object(j.a)("string"==typeof e.id);var n=this._getProgramKey(e),r=this.programs[n];return r?(this._resetProgram(r),r):(r=this._createNewProgram(t,e),this._cachePrograms&&this._checkProgramProp(r)&&(r._isCached=!0,this.programs[n]=r),r)}},{key:"_getProgramKey",value:function(t){return"".concat(t.id,"-").concat(t.vs,"-").concat(t.fs)}},{key:"_checkProgramProp",value:function(t){return!t.varyings}},{key:"_createNewProgram",value:function(t,e){var n=e.vs,r=e.fs,i=this.getVertexShader(t,n),o=this.getFragmentShader(t,r);return new Yt(this.gl,Object.assign({},e,{vs:i,fs:o}))}},{key:"_resetProgram",value:function(t,e){t.reset()}},{key:"_compareContexts",value:function(t,e){return(t.gl||t)===(e.gl||e)}}]),t}(),Kn=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(y.a)(this,t);var r=n.onInitialize,i=void 0===r?function(){}:r,o=n.onFinalize,a=void 0===o?function(){}:o,s=n.useDevicePixels,u=void 0===s||s,c=n.autoResizeDrawingBuffer,l=void 0===c||c;this.props={onInitialize:i,onFinalize:a},this.setProps({autoResizeDrawingBuffer:l,useDevicePixels:u}),Object(j.a)(e instanceof Worker),this.worker=e,this.canvas=null,this.width=null,this.height=null,this._stopped=!0,this._animationFrameId=null,this._startPromise=null,this._onMessage=this._onMessage.bind(this),this._onEvent=this._onEvent.bind(this),this._updateFrame=this._updateFrame.bind(this)}return Object(L.a)(t,null,[{key:"createWorker",value:function(t){return function(e){t.setProps({useDevicePixels:!1,autoResizeDrawingBuffer:!1}),e.canvas=null,e.addEventListener("message",(function(n){switch(n.data.command){case"start":r=n.data.opts.canvas,i=new Map,r.addEventListener=function(t,n){e.postMessage({command:"addEventListener",type:t}),i.has(t)||i.set(t,[]),i.get(t).push(n)},r.removeEventListener=function(t,n){e.postMessage({command:"removeEventListener",type:t});var r=i.get(t);r&&r.splice(r.indexOf(n),1)},r.dispatchEvent=function(t,e){var n=i.get(t);n&&n.forEach((function(t){return t(e)}))},e.canvas=r,t.start(n.data.opts);break;case"stop":t.stop();break;case"resize":e.canvas.width=n.data.width,e.canvas.height=n.data.height;break;case"event":e.canvas.dispatchEvent(n.data.type,n.data.event)}var r,i}))}}}]),Object(L.a)(t,[{key:"setProps",value:function(t){return"autoResizeDrawingBuffer"in t&&(this.autoResizeDrawingBuffer=t.autoResizeDrawingBuffer),"useDevicePixels"in t&&(this.useDevicePixels=t.useDevicePixels),this}},{key:"start",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._stopped=!1,this._animationFrameId||(this.worker.onmessage=this._onMessage,this._startPromise=d().then((function(){return t._createAndTransferCanvas(e),t.props.onInitialize(t)})).then((function(){t._stopped||(t._animationFrameId=Object(a.p)(t._updateFrame))}))),this}},{key:"stop",value:function(){return this._animationFrameId&&(Object(a.f)(this._animationFrameId),this._animationFrameId=null,this._stopped=!0,this.props.onFinalize(this)),this.worker.postMessage({command:"stop"}),this}},{key:"_onMessage",value:function(t){switch(t.data.command){case"addEventListener":this.canvas.addEventListener(t.data.type,this._onEvent);break;case"removeEventListener":this.canvas.removeEventListener(t.data.type,this._onEvent)}}},{key:"_onEvent",value:function(t){var e=this.useDevicePixels&&window.devicePixelRatio||1,n=t.type,r={};for(var i in t){var o=t[i],a=Object(Fn.a)(o);"offsetX"!==i&&"offsetY"!==i||(o*=e),"number"!==a&&"boolean"!==a&&"string"!==a||(r[i]=o)}this.worker.postMessage({command:"event",type:n,event:r})}},{key:"_updateFrame",value:function(){this._resizeCanvasDrawingBuffer(),this._animationFrameId=Object(a.p)(this._updateFrame)}},{key:"_createAndTransferCanvas",value:function(t){var e=p(t);e.transferControlToOffscreen||l.g.error("OffscreenCanvas is not available in your browser.")();var n=e.transferControlToOffscreen();this.worker.postMessage({command:"start",opts:Object.assign({},t,{canvas:n})},[n]),this.canvas=e}},{key:"_resizeCanvasDrawingBuffer",value:function(){if(this.autoResizeDrawingBuffer){var t=this.useDevicePixels&&window.devicePixelRatio||1,e=this.canvas.clientWidth*t,n=this.canvas.clientHeight*t;this.width===e&&this.height===n||(this.width=e,this.height=n,this.worker.postMessage({command:"resize",width:e,height:n}))}}}]),t}(),Jn=function(){function t(e,n){Object(y.a)(this,t);var r=n.id,i=void 0===r?"pass":r;this.id=i,this.gl=e,this.props={enabled:!0,screen:!1,swap:!1},Object.assign(this.props,n)}return Object(L.a)(t,[{key:"setProps",value:function(t){Object.assign(this.props,t)}},{key:"render",value:function(t,e){var n=this;if(this.props.enabled){var r=this.gl,i={gl:r,outputBuffer:t.writeBuffer,inputBuffer:t.readBuffer,animationProps:e,swapBuffers:function(){return t._swapFramebuffers()}};this.props.screen?(i.inputBuffer=i.outputBuffer,i.outputBuffer=Et.getDefaultFramebuffer(r)):this.props.swap&&(i.inputBuffer=t.writeBuffer,i.outputBuffer=t.readBuffer),Object(X.g)(r,{framebuffer:i.outputBuffer},(function(){return n._renderPass(i)})),this.props.debug&&i.outputBuffer.log(0,this.id),this.props.swap&&t._swapFramebuffers()}}},{key:"_renderPass",value:function(t){t.gl,t.inputBuffer,t.outputBuffer,t.animationProps}}]),t}(),Qn=function(t){function e(t,n){return Object(y.a)(this,e),n=Array.isArray(n)?{passes:n}:n,Object(nt.a)(this,Object(rt.a)(e).call(this,t,Object.assign({id:"composite-pass"},n)))}return Object(it.a)(e,t),Object(L.a)(e,[{key:"render",value:function(){var t=this.props.passes,e=void 0===t?[]:t,n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;s.render.apply(s,arguments)}}catch(t){r=!0,i=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}}}]),e}(Jn),$n=function(){function t(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];Object(y.a)(this,t),this.gl=e,this.framebuffer1=new Et(e,{id:"multi-pass-1",stencil:!0}),this.framebuffer2=new Et(e,{id:"multi-pass-2",stencil:!0}),this.reset()}return Object(L.a)(t,[{key:"reset",value:function(){this.framebuffer1.resize(),this.framebuffer2.resize(),this.writeBuffer=this.framebuffer1,this.readBuffer=this.framebuffer2,this.maskActive=!1}},{key:"_swapFramebuffers",value:function(){var t=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=t}}]),t}(),tr=function(t){function e(t,n){var r;return Object(y.a)(this,e),n=Array.isArray(n)?{passes:n}:n,(r=Object(nt.a)(this,Object(rt.a)(e).call(this,t,Object.assign({id:"multi-pass"},n)))).renderState=new $n(t,n),r}return Object(it.a)(e,t),Object(L.a)(e,[{key:"render",value:function(t){this.renderState.reset();var e=this.props.passes,n=void 0===e?[]:e,r=!0,i=!1,o=void 0;try{for(var a,s=n[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){a.value.render(this.renderState,t)}}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return this}}]),e}(Qn),er=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(y.a)(this,e),Object(nt.a)(this,Object(rt.a)(e).call(this,t,Object.assign({id:"clear-pass"},n)))}return Object(it.a)(e,t),Object(L.a)(e,[{key:"_renderPass",value:function(t){var e=t.gl,n=this.props.clearBits,r=void 0===n?16640:n;e.clear(r)}}]),e}(Jn),nr=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(y.a)(this,e),Object(nt.a)(this,Object(rt.a)(e).call(this,t,Object.assign({id:"render-pass"},n)))}return Object(it.a)(e,t),Object(L.a)(e,[{key:"_renderPass",value:function(t){var e=t.animationProps,n=this.props,r=n.models,i=void 0===r?[]:r,o=n.drawParams,a=!0,s=!1,u=void 0;try{for(var c,l=i[Symbol.iterator]();!(a=(c=l.next()).done);a=!0){c.value.draw(Object.assign({},o,{animationProps:e}))}}catch(t){s=!0,u=t}finally{try{a||null==l.return||l.return()}finally{if(s)throw u}}}}]),e}(Jn),rr={x:[2,0,1],y:[0,1,2],z:[1,2,0]},ir=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(y.a)(this,e);for(var n=t.bottomRadius,r=void 0===n?0:n,i=t.topRadius,o=void 0===i?0:i,a=t.height,s=void 0===a?1:a,u=t.nradial,c=void 0===u?10:u,l=t.nvertical,f=void 0===l?10:l,h=t.verticalAxis,d=void 0===h?"y":h,p=t.topCap,g=void 0!==p&&p,v=t.bottomCap,m=void 0!==v&&v,b=(g?2:0)+(m?2:0),_=(c+1)*(f+1+b),x=Math.atan2(r-o,s),w=Math.sin,E=Math.cos,S=Math.PI,O=E(x),P=w(x),C=g?-2:0,M=f+(m?2:0),I=c+1,A=new Float32Array(3*_),T=new Float32Array(3*_),N=new Float32Array(2*_),L=new Uint16Array(c*(f+b)*6),R=rr[d],k=0,j=0,F=C;F<=M;F++){var D=F/f,B=s*D,z=void 0;F<0?(B=0,D=1,z=r):F>f?(B=s,D=1,z=o):z=r+F/f*(o-r),-2!==F&&F!==f+2||(z=0,D=0),B-=s/2;for(var V=0;V<I;V++){var G=w(V*S*2/c),U=E(V*S*2/c);A[k+R[0]]=G*z,A[k+R[1]]=B,A[k+R[2]]=U*z,T[k+R[0]]=F<0||F>f?0:G*O,T[k+R[1]]=F<0?-1:F>f?1:P,T[k+R[2]]=F<0||F>f?0:U*O,N[j+0]=V/c,N[j+1]=D,j+=2,k+=3}}for(var W=0;W<f+b;W++)for(var q=0;q<c;q++){var X=6*(W*c+q);L[X+0]=I*(W+0)+0+q,L[X+1]=I*(W+0)+1+q,L[X+2]=I*(W+1)+1+q,L[X+3]=I*(W+0)+0+q,L[X+4]=I*(W+1)+1+q,L[X+5]=I*(W+1)+0+q}return Object(nt.a)(this,Object(rt.a)(e).call(this,Object.assign({},t,{attributes:{positions:A,normals:T,texCoords:N,indices:L}})))}return Object(it.a)(e,t),e}(_e),or=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(y.a)(this,e);var n=t.radius,r=void 0===n?1:n,i=t.cap,o=void 0===i||i;return Object(nt.a)(this,Object(rt.a)(e).call(this,Object.assign({},t,{topRadius:0,topCap:Boolean(o),bottomCap:Boolean(o),bottomRadius:r})))}return Object(it.a)(e,t),e}(ir),ar=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(y.a)(this,e);var n=t.id,r=void 0===n?Object(l.i)("cube-geometry"):n;return Object(nt.a)(this,Object(rt.a)(e).call(this,Object.assign({},t,{id:r,attributes:fr()})))}return Object(it.a)(e,t),e}(_e),sr=new Uint16Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),ur=new Float32Array([-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1]),cr=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0]),lr=new Float32Array([0,0,1,0,1,1,0,1,1,0,1,1,0,1,0,0,0,1,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,0,1,1,0,1,0,0,0,0,1,0,1,1,0,1]);function fr(){return{indices:new Uint16Array(sr),positions:new Float32Array(ur),normals:new Float32Array(cr),texCoords:new Float32Array(lr)}}var hr=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(y.a)(this,e);var n=t.radius,r=void 0===n?1:n;return Object(nt.a)(this,Object(rt.a)(e).call(this,Object.assign({},t,{bottomRadius:r,topRadius:r})))}return Object(it.a)(e,t),e}(ir),dr=[-1,0,0,0,1,0,0,0,-1,0,0,1,0,-1,0,1,0,0],pr=[3,4,5,3,5,1,3,1,0,3,0,4,4,0,2,4,2,5,2,0,1,5,2,1],gr=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(y.a)(this,e);var n=t.iterations,r=void 0===n?0:n,i=Math.PI,o=2*i,a=dr.concat(),s=pr.concat();a.push(),s.push();for(var u,c=(u={},function(t,e){var n=(t*=3)>(e*=3)?t:e,r="".concat(t<e?t:e,"|").concat(n);if(r in u)return u[r];var i=a[t],o=a[t+1],s=a[t+2],c=(i+a[e])/2,l=(o+a[e+1])/2,f=(s+a[e+2])/2,h=Math.sqrt(c*c+l*l+f*f);return c/=h,l/=h,f/=h,a.push(c,l,f),u[r]=a.length/3-1}),l=0;l<r;l++){for(var f=[],h=0;h<s.length;h+=3){var d=c(s[h+0],s[h+1]),p=c(s[h+1],s[h+2]),g=c(s[h+2],s[h+0]);f.push(g,s[h+0],d,d,s[h+1],p,p,s[h+2],g,d,p,g)}s=f}for(var v=new Array(3*s.length),m=new Array(2*s.length),b=s.length,_=b-3;_>=0;_-=3){var x=s[_+0],w=s[_+1],E=s[_+2],S=3*x,O=3*w,P=3*E,C=2*x,M=2*w,I=2*E,A=a[S+0],T=a[S+1],N=a[S+2],L=Math.acos(N/Math.sqrt(A*A+T*T+N*N)),R=Math.atan2(T,A)+i,k=L/i,j=1-R/o,F=a[O+0],D=a[O+1],B=a[O+2],z=Math.acos(B/Math.sqrt(F*F+D*D+B*B)),V=Math.atan2(D,F)+i,G=z/i,U=1-V/o,W=a[P+0],q=a[P+1],X=a[P+2],H=Math.acos(X/Math.sqrt(W*W+q*q+X*X)),Y=Math.atan2(q,W)+i,Z=H/i,K=1-Y/o,J=[W-F,q-D,X-B],Q=[A-F,T-D,N-B],$=new he.a(J).cross(Q).normalize(),tt=void 0;(0===j||0===U||0===K)&&(0===j||j>.5)&&(0===U||U>.5)&&(0===K||K>.5)&&(a.push(a[S+0],a[S+1],a[S+2]),tt=a.length/3-1,s.push(tt),m[2*tt+0]=1,m[2*tt+1]=k,v[3*tt+0]=$.x,v[3*tt+1]=$.y,v[3*tt+2]=$.z,a.push(a[O+0],a[O+1],a[O+2]),tt=a.length/3-1,s.push(tt),m[2*tt+0]=1,m[2*tt+1]=G,v[3*tt+0]=$.x,v[3*tt+1]=$.y,v[3*tt+2]=$.z,a.push(a[P+0],a[P+1],a[P+2]),tt=a.length/3-1,s.push(tt),m[2*tt+0]=1,m[2*tt+1]=Z,v[3*tt+0]=$.x,v[3*tt+1]=$.y,v[3*tt+2]=$.z),v[S+0]=v[O+0]=v[P+0]=$.x,v[S+1]=v[O+1]=v[P+1]=$.y,v[S+2]=v[O+2]=v[P+2]=$.z,m[C+0]=j,m[C+1]=k,m[M+0]=U,m[M+1]=G,m[I+0]=K,m[I+1]=Z}return Object(nt.a)(this,Object(rt.a)(e).call(this,Object.assign({},t,{attributes:{positions:new Float32Array(a),normals:new Float32Array(v),texCoords:new Float32Array(m),indices:new Uint16Array(s)}})))}return Object(it.a)(e,t),e}(_e),vr=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(y.a)(this,e);var n=t.type,r=void 0===n?"x,y":n,i=t.offset,o=void 0===i?0:i,a=t.flipCull,s=void 0!==a&&a,u=t.unpack,c=void 0!==u&&u,f=t.id,h=void 0===f?Object(l.i)("plane-geometry"):f,d=r.split(","),p=t["".concat(d[0],"len")],g=t["".concat(d[1],"len")],v=t["n".concat(d[0])]||1,m=t["n".concat(d[1])]||1,b=(v+1)*(m+1),_=new Float32Array(3*b),x=new Float32Array(3*b),w=new Float32Array(2*b);s&&(p=-p);for(var E=0,S=0,O=0;O<=m;O++)for(var P=0;P<=v;P++){var C=P/v,M=O/m;switch(w[E+0]=s?1-C:C,w[E+1]=M,r){case"x,y":_[S+0]=p*C-.5*p,_[S+1]=g*M-.5*g,_[S+2]=o,x[S+0]=0,x[S+1]=0,x[S+2]=s?1:-1;break;case"x,z":_[S+0]=p*C-.5*p,_[S+1]=o,_[S+2]=g*M-.5*g,x[S+0]=0,x[S+1]=s?1:-1,x[S+2]=0;break;case"y,z":_[S+0]=o,_[S+1]=p*C-.5*p,_[S+2]=g*M-.5*g,x[S+0]=s?1:-1,x[S+1]=0,x[S+2]=0}E+=2,S+=3}for(var I=v+1,A=new Uint16Array(v*m*6),T=0;T<m;T++)for(var N=0;N<v;N++){var L=6*(T*v+N);A[L+0]=(T+0)*I+N,A[L+1]=(T+1)*I+N,A[L+2]=(T+0)*I+N+1,A[L+3]=(T+1)*I+N,A[L+4]=(T+1)*I+N+1,A[L+5]=(T+0)*I+N+1}if(c){for(var R=new Float32Array(3*A.length),k=new Float32Array(3*A.length),j=new Float32Array(2*A.length),F=0;F<A.length;++F){var D=A[F];R[3*F+0]=_[3*D+0],R[3*F+1]=_[3*D+1],R[3*F+2]=_[3*D+2],k[3*F+0]=x[3*D+0],k[3*F+1]=x[3*D+1],k[3*F+2]=x[3*D+2],j[2*F+0]=w[2*D+0],j[2*F+1]=w[2*D+1]}_=R,x=k,w=j,A=void 0}var B={positions:_,normals:x,texCoords:w};return A&&(B.indices=A),Object(nt.a)(this,Object(rt.a)(e).call(this,Object.assign({},t,{attributes:B,id:h})))}return Object(it.a)(e,t),e}(_e),yr=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(y.a)(this,e);var n=t.nlat,r=void 0===n?10:n,i=t.nlong,o=void 0===i?10:i,a=t.radius,s=void 0===a?1:a,u=t.id,c=void 0===u?Object(l.i)("sphere-geometry"):u;return Object(nt.a)(this,Object(rt.a)(e).call(this,Object.assign({},t,{id:c,attributes:mr(r,o,s)})))}return Object(it.a)(e,t),e}(_e);function mr(t,e,n){var r=Math.PI-0,i=2*Math.PI-0,o=(t+1)*(e+1);if("number"==typeof n){var a=n;n=function(t,e,n,r,i){return a}}for(var s=new Float32Array(3*o),u=new Float32Array(3*o),c=new Float32Array(2*o),l=new Uint16Array(t*e*6),f=0;f<=t;f++)for(var h=0;h<=e;h++){var d=h/e,p=f/t,g=h+f*(e+1),v=2*g,y=3*g,m=i*d,b=r*p,_=Math.sin(m),x=Math.cos(m),w=Math.sin(b),E=x*w,S=Math.cos(b),O=_*w,P=n(E,S,O,d,p);s[y+0]=P*E,s[y+1]=P*S,s[y+2]=P*O,u[y+0]=E,u[y+1]=S,u[y+2]=O,c[v+0]=d,c[v+1]=p}for(var C=t+1,M=0;M<t;M++)for(var I=0;I<e;I++){var A=6*(M*e+I);l[A+0]=I*C+M,l[A+1]=I*C+M+1,l[A+2]=(I+1)*C+M,l[A+3]=(I+1)*C+M,l[A+4]=I*C+M+1,l[A+5]=(I+1)*C+M+1}return{positions:s,indices:l,normals:u,texCoords:c}}var br=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(y.a)(this,e),Object(nt.a)(this,Object(rt.a)(e).call(this,t,Object.assign({},n,{geometry:new or(n)})))}return Object(it.a)(e,t),e}(jn),_r=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(y.a)(this,e);var r=n.id,i=void 0===r?Object(l.i)("cube"):r;return Object(nt.a)(this,Object(rt.a)(e).call(this,t,Object.assign({},n,{id:i,geometry:new ar(n)})))}return Object(it.a)(e,t),e}(jn),xr=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(y.a)(this,e),Object(nt.a)(this,Object(rt.a)(e).call(this,t,Object.assign({},n,{geometry:new hr(n)})))}return Object(it.a)(e,t),e}(jn),wr=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(y.a)(this,e),Object(nt.a)(this,Object(rt.a)(e).call(this,t,Object.assign({},n,{geometry:new gr(n)})))}return Object(it.a)(e,t),e}(jn),Er=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(y.a)(this,e);var r=n.id,i=void 0===r?Object(l.i)("plane"):r;return Object(nt.a)(this,Object(rt.a)(e).call(this,t,Object.assign({},n,{id:i,geometry:new vr(n)})))}return Object(it.a)(e,t),e}(jn),Sr=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(y.a)(this,e);var r=n.id,i=void 0===r?Object(l.i)("sphere"):r;return Object(nt.a)(this,Object(rt.a)(e).call(this,t,Object.assign({},n,{id:i,geometry:new yr(n)})))}return Object(it.a)(e,t),e}(jn),Or=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(y.a)(this,e),Object(nt.a)(this,Object(rt.a)(e).call(this,t,Object.assign({},n,{geometry:new ir(n)})))}return Object(it.a)(e,t),e}(jn),Pr=[-1,-1,1,-1,-1,1,1,1],Cr=function(t){function e(t,n){var r;Object(y.a)(this,e);var i=Pr.map((function(t){return-1===t?0:t}));return(r=Object(nt.a)(this,Object(rt.a)(e).call(this,t,Object.assign({},n,{vs:"attribute vec2 aClipSpacePosition;\nattribute vec2 aTexCoord;\nattribute vec2 aCoordinate;\n\nvarying vec2 position;\nvarying vec2 coordinate;\nvarying vec2 uv;\n\nvoid main(void) {\n  gl_Position = vec4(aClipSpacePosition, 0., 1.);\n  position = aClipSpacePosition;\n  coordinate = aCoordinate;\n  uv = aTexCoord;\n}\n",geometry:new _e({drawMode:5,vertexCount:4,attributes:{aClipSpacePosition:{size:2,value:new Float32Array(Pr)},aTexCoord:{size:2,value:new Float32Array(i)},aCoordinate:{size:2,value:new Float32Array(i)}}})})))).setVertexCount(4),r}return Object(it.a)(e,t),e}(jn),Mr="uniform sampler2D uDiffuseSampler;\nuniform float uOpacity;\n\nvarying vec2 uv;\n\nvoid main() {\n  vec4 texel = texture2D(uDiffuseSampler, uv);\n  gl_FragColor = uOpacity * texel;\n}\n",Ir=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(y.a)(this,e),(n=Object(nt.a)(this,Object(rt.a)(e).call(this,t,Object.assign({id:"copy-pass",swap:!0},r)))).clipspace=new Cr(t,{id:"copy-pass",fs:Mr}),n}return Object(it.a)(e,t),Object(L.a)(e,[{key:"_renderPass",value:function(t){var e=t.inputBuffer,n=this.props.opacity,r=void 0===n?1:n;this.clipspace.draw({uniforms:{uDiffuseSampler:e,uOpacity:r},parameters:{depthWrite:!1,depthTest:!1}})}}]),e}(Jn),Ar="uniform sampler2D uDiffuseSampler;\nuniform float uOpacity;\nvarying vec2 uv;\n\nvoid main() {\n  vec4 texel = texture2D(uDiffuseSampler, uv);\n  gl_FragColor = uOpacity * texel;\n}\n",Tr=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(y.a)(this,e),n=Object(nt.a)(this,Object(rt.a)(e).call(this,t,Object.assign({id:"texture-pass"},r)));var i=r.texture,o=r.opacity,a=void 0===o?1:o;return n.clipspace=new Cr(t,{id:"texture-pass",fs:Ar,uniforms:{uDiffuseSampler:i,uOpacity:a}}),n}return Object(it.a)(e,t),Object(L.a)(e,[{key:"_renderPass",value:function(){this.clipspace.draw({parameters:{depthWrite:!1,depthTest:!1}})}}]),e}(Jn),Nr=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(y.a)(this,e),Object(nt.a)(this,Object(rt.a)(e).call(this,t,Object.assign({id:"picking-pass"},n)))}return Object(it.a)(e,t),Object(L.a)(e,[{key:"_renderPass",value:function(t){var e=t.gl,n=t.inputBuffer,r=t.animationProps,i=this.props,o=r?r._mousePosition:i.mousePosition,a=r?r.useDevicePixels:i.useDevicePixels;if(o){var s=zn(e,{models:this.props.models,position:o,useDevicePixels:a,framebuffer:n}),u=!0,c=!1,l=void 0;try{for(var f,h=this.props.models[Symbol.iterator]();!(u=(f=h.next()).done);u=!0){var d=f.value;if(s&&s.model===d){var p=s&&s.color||null;d.updateModuleSettings({pickingSelectedColor:p})}}}catch(t){c=!0,l=t}finally{try{u||null==h.return||h.return()}finally{if(c)throw l}}}else{var g=!0,v=!1,y=void 0;try{for(var m,b=this.props.models[Symbol.iterator]();!(g=(m=b.next()).done);g=!0){m.value.updateModuleSettings({pickingSelectedColor:null})}}catch(t){v=!0,y=t}finally{try{g||null==b.return||b.return()}finally{if(v)throw y}}}}}]),e}(Jn),Lr={boolean:{validate:function(t,e){return!0}},number:{validateType:function(t,e){return"value"in e&&(!("max"in e)||Number.isFinite(e.max))&&(!("min"in e)||Number.isFinite(e.min))},validate:function(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}}};function Rr(t,e){switch(kr(e)){case"object":return function(t){var e=t.type;(Lr[e]||{}).typeValidator;return t}(e=function(t,e){if(!("type"in e))return"value"in e?Object.assign({name:t,type:kr(e.value)},e):{name:t,type:"object",value:e};return Object.assign({name:t},e)}(t,e));case"array":return function(t,e){if(/color/i.test(t)&&(3===e.length||4===e.length))return{name:t,type:"color",value:e};return{name:t,type:"array",value:e}}(t,e);case"boolean":return{name:t,type:"boolean",value:e};case"number":return function(t,e){var n=/radius|scale|width|height|pixel|size|miter/i.test(t)&&/^((?!scale).)*$/.test(t)?100:1;return{name:t,type:"number",max:Math.max(e,n),min:Math.min(e,0),value:e}}(t,e);case"function":return{name:t,type:"function",value:e};default:return{name:t,type:"unknown",value:e}}}function kr(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":null===t?"null":Object(Fn.a)(t)}function jr(t,e){var n={};if(void 0===e){for(var r in t.uniforms)n[r]=t.uniforms[r].value;return n}for(var i in e)n[i]=e[i];return n}function Fr(t){if(!t.normalized){if(t.normalized=!0,t.uniforms){var e=function(t){for(var e={},n={},r=Object.entries(t),i=0;i<r.length;i++){var o=Object(dt.a)(r[i],2),a=o[0],s=Rr(a,o[1]);e[a]=s,n[a]=s.value}return{propTypes:e,defaultProps:n}}(t.uniforms).propTypes;t.uniforms=e}t.uniforms&&!t.getUniforms&&(t.getUniforms=jr.bind(null,t))}return t}var Dr=function(t){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(y.a)(this,e),Object(nt.a)(this,Object(rt.a)(e).call(this,t,Object.assign({swap:!0},n)))}return Object(it.a)(e,t),Object(L.a)(e,[{key:"_renderPass",value:function(t){var e=t.inputBuffer;t.swapBuffers;this.props.model.setUniforms(this.props),this.props.model.draw({uniforms:{texture:e,texSize:[e.width,e.height]},parameters:{depthWrite:!1,depthTest:!1}})}}]),e}(Jn),Br=function(t){function e(t,n){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(y.a)(this,e);var o="".concat(n.name,"-pass");Fr(n);var a=zr(t,n,o,i);return(r=Object(nt.a)(this,Object(rt.a)(e).call(this,t,Object.assign({id:o,passes:a},i)))).module=n,r}return Object(it.a)(e,t),Object(L.a)(e,[{key:"_renderPass",value:function(t){var e=t.inputBuffer,n=t.swapBuffers,r=!0,i=!0,o=!1,a=void 0;try{for(var s,u=this.module.passes[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value;r||n(),r=!1,c.uniforms&&c.model.setUniforms(c.uniforms),c.model.draw({uniforms:{texture:e,texSize:[e.width,e.height]},parameters:{depthWrite:!1,depthTest:!1}})}}catch(t){o=!0,a=t}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}}}]),e}(Qn);function zr(t,e,n,r){if(e.filter||e.sampler){var i=Wr(e);return[new Dr(t,{id:n,model:Vr(t,e,i,n,r),uniforms:null})]}var o=e.passes||[];return o.map((function(i){var a=Wr(e,i),s="".concat(n,"-").concat(o.length+1);return new Dr(t,Object.assign({id:s,model:Vr(t,e,a,s,r),uniforms:i.uniforms},r))}))}function Vr(t,e,n,r,i){var o=new Cr(t,{id:r,fs:n,modules:[e]}),a=Object.assign(e.getUniforms(),e.getUniforms(i));return o.setUniforms(a),o}var Gr=function(t){return"uniform sampler2D texture;\nuniform vec2 texSize;\n\nvarying vec2 position;\nvarying vec2 coordinate;\nvarying vec2 uv;\n\nvoid main() {\n  vec2 texCoord = coordinate;\n\n  gl_FragColor = texture2D(texture, texCoord);\n  gl_FragColor = ".concat(t,"(gl_FragColor, texSize, texCoord);\n}\n")},Ur=function(t){return"uniform sampler2D texture;\nuniform vec2 texSize;\n\nvarying vec2 position;\nvarying vec2 coordinate;\nvarying vec2 uv;\n\nvoid main() {\n  vec2 texCoord = coordinate;\n\n  gl_FragColor = ".concat(t,"(texture, texSize, texCoord);\n}\n")};function Wr(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;if(e.filter){var n="string"==typeof e.filter?e.filter:"".concat(t.name,"_filterColor");return Gr(n)}if(e.sampler){var r="string"==typeof e.sampler?e.sampler:"".concat(t.name,"_sampleColor");return Ur(r)}return null}n(351);var qr=function(){function t(){if(Object(y.a)(this,t),this.canvas=document.createElement("canvas"),this.width=this.canvas.clientWidth,this.height=this.canvas.clientHeight,this.gl=V({canvas:this.canvas,opts:{premultipliedAlpha:!1}}),!this.gl)throw new Error("This browser does not support WebGL");this.texture=null,this.spareTexture=null,this.flippedModel=null}return Object(L.a)(t,[{key:"installFiltersAsMethods",value:function(t){var e=this,n=function(n){"canvas"!==n&&(e[n]=function(r){return e.filter(t[n],r).bind(e)})};for(var r in t)n(r)}},{key:"setTexture",value:function(t){return this.texture=new pt.a(this.gl,{pixels:t}),this.resize(this.gl,this.texture.width,this.texture.height),this}},{key:"resize",value:function(t,e,n){if(t.canvas.width!==e||t.canvas.height!==n){t.canvas.width=e,t.canvas.height=n;var r=Math.floor(e/1),i=Math.floor(n/1);t.canvas.style.width="".concat(r,"px"),t.canvas.style.height="".concat(i,"px"),t.viewport(0,0,e,n),this.width=r,this.height=i}}},{key:"replace",value:function(t){return t.parentNode.insertBefore(this.canvas,t),t.parentNode.removeChild(t),this}},{key:"draw",value:function(){return this.multiPassRenderer=new tr(this.gl,[new er(this.gl),new Tr(this.gl,{texture:this.texture}),new Ir(this.gl,{screen:!0})]),this.multiPassRenderer.render(),this}},{key:"update",value:function(){return this.multiPassRenderer.render({}),this}},{key:"filter",value:function(t,e){return this.multiPassRenderer=new tr(this.gl,[new er(this.gl),new Tr(this.gl,{texture:this.texture}),new Br(this.gl,t,e),new Ir(this.gl,{screen:!0})]),this.multiPassRenderer.render(),this}},{key:"getPixelArray",value:function(){var t=this.gl,e=this.texture.width,n=this.texture.height,r=new Uint8Array(e*n*4);return this.texture.drawTo((function(){return t.readPixels(0,0,e,n,6408,5121,r)})),r}},{key:"_initialize",value:function(t,e){var n=this.gl,r=5121;if(this.gl.getExtension("OES_texture_float")&&n.getExtension("OES_texture_float_linear")){var i=new pt.a(this.gl,{width:100,height:100,format:6408,type:5126});try{i.drawTo((function(){r=5126}))}catch(t){}i.destroy()}this.spareTexture&&this.spareTexture.destroy(),this.width=t,this.height=e,this.texture=new pt.a(this.gl,{width:t,height:e,format:6408,type:r}),this.spareTexture=new pt.a(this.gl,{width:t,height:e,format:6408,type:r}),this.extraTexture=this.extraTexture||new pt.a(this.gl,{width:0,height:0,format:6408,type:r}),this.flippedModel=this.flippedModel||new jn(this.gl,{vs:"attribute vec2 vertex;\nattribute vec2 _texCoord;\nvarying vec2 texCoord;\nvoid main() {\n  texCoord = _texCoord;\n  gl_Position = vec4(vertex * 2.0 - 1.0, 0.0, 1.0);\n}\n",fs:"uniform sampler2D texture;\nvarying vec2 texCoord;\nvoid main() {\n  gl_FragColor = texture2D(texture, vec2(texCoord.x, 1.0 - texCoord.y));\n}\n"}),this.isInitialized=!0}}]),t}();function Xr(){}var Hr=4,Yr=function(){function t(e){var n=e.url,r=e.path,i=void 0===r?null:r,o=e.method,a=void 0===o?"GET":o,s=e.asynchronous,u=void 0===s||s,c=e.noCache,l=void 0!==c&&c,f=e.sendAsBinary,h=void 0!==f&&f,d=e.responseType,p=void 0!==d&&d,g=e.onProgress,v=void 0===g?Xr:g,m=e.onError,b=void 0===m?Xr:m,_=e.onAbort,x=void 0===_?Xr:_,w=e.onComplete,E=void 0===w?Xr:w;Object(y.a)(this,t),this.url=i?i.join(i,n):n,this.method=a,this.async=u,this.noCache=l,this.sendAsBinary=h,this.responseType=p,this.req=new XMLHttpRequest,this.req.onload=function(t){return E(t)},this.req.onerror=function(t){return b(t)},this.req.onabort=function(t){return x(t)},this.req.onprogress=function(t){t.lengthComputable?v(t,Math.round(t.loaded/t.total*100)):v(t,-1)}}return Object(L.a)(t,[{key:"setRequestHeader",value:function(t,e){return this.req.setRequestHeader(t,e),this}},{key:"sendAsync",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.body||null;return new Promise((function(n,r){try{var i=t.req,o=t.method,a=t.noCache,s=t.sendAsBinary,u=t.responseType,c=a?t.url+(t.url.indexOf("?")>=0?"&":"?")+Date.now():t.url;i.open(o,c,t.async),u&&(i.responseType=u),t.async&&(i.onreadystatechange=function(t){i.readyState===Hr&&(200===i.status?n(i.responseType?i.response:i.responseText):r(new Error("".concat(i.status,": ").concat(c))))}),s?i.sendAsBinary(e):i.send(e),t.async||(200===i.status?n(i.responseType?i.response:i.responseText):r(new Error("".concat(i.status,": ").concat(c))))}catch(t){r(t)}}))}}]),t}();function Zr(t){return new Yr(t).sendAsync()}var Kr="";function Jr(t){Kr=t}function Qr(t,e){return"string"==typeof t||e||(t=(e=t).url),e.url=Kr?Kr+t:t,Zr(e)}function $r(t,e){return t=Kr?Kr+t:t,"undefined"==typeof Image?Zr({url:t=new URL(t,location.pathname).href,responseType:"arraybuffer"}).then((function(t){var e=new Blob([new Uint8Array(t)]);return createImageBitmap(e)})):new Promise((function(n,r){try{var i=new Image;i.onload=function(){return n(i)},i.onerror=function(){return r(new Error("Could not load image ".concat(t,".")))},i.crossOrigin=e&&e.crossOrigin||"anonymous",i.src=t}catch(t){r(t)}}))}function ti(){}function ei(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Object(j.a)("string"==typeof e,"loadTexture: url must be string"),$r(e,n).then((function(r){return new pt.a(t,Object.assign({id:e},n,{data:r}))}))}function ni(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.urls,n=t.onProgress,r=void 0===n?ti:n;Object(j.a)(e.every((function(t){return"string"==typeof t})),"loadImages: {urls} must be array of strings");var i=0;return Promise.all(e.map((function(n){var o=Qr(Object.assign({url:n},t));return o.then((function(t){return r({progress:++i/e.length,count:i,total:e.length,url:n})})),o})))}function ri(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.urls,n=t.onProgress,r=void 0===n?ti:n;Object(j.a)(e.every((function(t){return"string"==typeof t})),"loadImages: {urls} must be array of strings");var i=0;return Promise.all(e.map((function(n){var o=$r(n,t);return o.then((function(t){return r({progress:++i/e.length,count:i,total:e.length,url:n})})),o})))}function ii(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.urls,r=e.onProgress,i=void 0===r?ti:r;return Object(j.a)(n.every((function(t){return"string"==typeof t})),"loadTextures: {urls} must be array of strings"),ri(Object.assign({urls:n,onProgress:i},e)).then((function(r){return r.map((function(r,i){return new pt.a(t,Object.assign({id:n[i]},e,{data:r}))}))}))}function oi(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.vs,r=e.fs,i=e.onProgress,o=void 0===i?ti:i;return ni(Object.assign({urls:[n,r],onProgress:o},e)).then((function(n){var r=Object(dt.a)(n,2),i=r[0],o=r[1];return new Yt(t,Object.assign({vs:i,fs:o},e))}))}function ai(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.url,r=e.onProgress,i=void 0===r?ti:r;return ni(Object.assign({urls:[n],onProgress:i},e)).then((function(n){var r=Object(dt.a)(n,1)[0];return si(t,Object.assign({file:r},e))}))}function si(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.file,r=e.program,i=void 0===r?new Yt(t):r,o="string"==typeof n?ui(n):n,a={},s={};for(var u in o){var c=o[u];Array.isArray(c)?a[u]="indices"===u?new Uint16Array(c):new Float32Array(c):s[u]=c}return new jn(t,Object.assign({program:i,geometry:new _e({attributes:a})},s,e))}function ui(t){try{return JSON.parse(t)}catch(t){throw new Error("Failed to parse JSON: ".concat(t))}}var ci="uniform mat4 u_MVPMatrix;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_NormalMatrix;\n",li={name:"pbr",vs:"varying vec3 pbr_vPosition;\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n# ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n# else\nvarying vec3 pbr_vNormal;\n# endif\n#endif\n\nvoid pbr_setPositionNormalTangentUV(vec4 position, vec4 normal, vec4 tangent, vec2 uv)\n{\n  vec4 pos = u_ModelMatrix * position;\n  pbr_vPosition = vec3(pos.xyz) / pos.w;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\n  vec3 normalW = normalize(vec3(u_NormalMatrix * vec4(normal.xyz, 0.0)));\n  vec3 tangentW = normalize(vec3(u_ModelMatrix * vec4(tangent.xyz, 0.0)));\n  vec3 bitangentW = cross(normalW, tangentW) * tangent.w;\n  pbr_vTBN = mat3(tangentW, bitangentW, normalW);\n#else\n  pbr_vNormal = normalize(vec3(u_ModelMatrix * vec4(normal.xyz, 0.0)));\n#endif\n#endif\n\n#ifdef HAS_UV\n  pbr_vUV = uv;\n#else\n  pbr_vUV = vec2(0.,0.);\n#endif\n}\n",fs:"#extension GL_EXT_shader_texture_lod: enable\n#extension GL_OES_standard_derivatives : enable\n\nprecision highp float;\n\nuniform vec3 u_LightDirection;\nuniform vec3 u_LightColor;\n\n#ifdef USE_IBL\nuniform samplerCube u_DiffuseEnvSampler;\nuniform samplerCube u_SpecularEnvSampler;\nuniform sampler2D u_brdfLUT;\n#endif\n\n#ifdef HAS_BASECOLORMAP\nuniform sampler2D u_BaseColorSampler;\n#endif\n#ifdef HAS_NORMALMAP\nuniform sampler2D u_NormalSampler;\nuniform float u_NormalScale;\n#endif\n#ifdef HAS_EMISSIVEMAP\nuniform sampler2D u_EmissiveSampler;\nuniform vec3 u_EmissiveFactor;\n#endif\n#ifdef HAS_METALROUGHNESSMAP\nuniform sampler2D u_MetallicRoughnessSampler;\n#endif\n#ifdef HAS_OCCLUSIONMAP\nuniform sampler2D u_OcclusionSampler;\nuniform float u_OcclusionStrength;\n#endif\n\nuniform vec2 u_MetallicRoughnessValues;\nuniform vec4 u_BaseColorFactor;\n\nuniform vec3 u_Camera;\nuniform vec4 u_ScaleDiffBaseMR;\nuniform vec4 u_ScaleFGDSpec;\nuniform vec4 u_ScaleIBLAmbient;\n\nvarying vec3 pbr_vPosition;\n\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n#else\nvarying vec3 pbr_vNormal;\n#endif\n#endif\n\n\nstruct PBRInfo\n{\n  float NdotL;\n  float NdotV;\n  float NdotH;\n  float LdotH;\n  float VdotH;\n  float perceptualRoughness;\n  float metalness;\n  vec3 reflectance0;\n  vec3 reflectance90;\n  float alphaRoughness;\n  vec3 diffuseColor;\n  vec3 specularColor;\n};\n\nconst float M_PI = 3.141592653589793;\nconst float c_MinRoughness = 0.04;\n\nvec4 SRGBtoLINEAR(vec4 srgbIn)\n{\n  #ifdef MANUAL_SRGB\n  #ifdef SRGB_FAST_APPROXIMATION\n  vec3 linOut = pow(srgbIn.xyz,vec3(2.2));\n  #else\n  vec3 bLess = step(vec3(0.04045),srgbIn.xyz);\n  vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );\n  #endif\n  return vec4(linOut,srgbIn.w);;\n  #else\n  return srgbIn;\n  #endif\n}\n\nvec3 getNormal()\n{\n#ifndef HAS_TANGENTS\n  vec3 pos_dx = dFdx(pbr_vPosition);\n  vec3 pos_dy = dFdy(pbr_vPosition);\n  vec3 tex_dx = dFdx(vec3(pbr_vUV, 0.0));\n  vec3 tex_dy = dFdy(vec3(pbr_vUV, 0.0));\n  vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);\n\n#ifdef HAS_NORMALS\n  vec3 ng = normalize(pbr_vNormal);\n#else\n  vec3 ng = cross(pos_dx, pos_dy);\n#endif\n\n  t = normalize(t - ng * dot(ng, t));\n  vec3 b = normalize(cross(ng, t));\n  mat3 tbn = mat3(t, b, ng);\n#else\n  mat3 tbn = pbr_vTBN;\n#endif\n\n#ifdef HAS_NORMALMAP\n  vec3 n = texture2D(u_NormalSampler, pbr_vUV).rgb;\n  n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_NormalScale, u_NormalScale, 1.0)));\n#else\n  vec3 n = normalize(tbn[2].xyz);\n#endif\n\n  return n;\n}\n\n\n#ifdef USE_IBL\nvec3 getIBLContribution(PBRInfo pbrInputs, vec3 n, vec3 reflection)\n{\n  float mipCount = 9.0;\n  float lod = (pbrInputs.perceptualRoughness * mipCount);\n  vec3 brdf = SRGBtoLINEAR(texture2D(u_brdfLUT,\n    vec2(pbrInputs.NdotV, 1.0 - pbrInputs.perceptualRoughness))).rgb;\n  vec3 diffuseLight = SRGBtoLINEAR(textureCube(u_DiffuseEnvSampler, n)).rgb;\n\n#ifdef USE_TEX_LOD\n  vec3 specularLight = SRGBtoLINEAR(textureCubeLodEXT(u_SpecularEnvSampler, reflection, lod)).rgb;\n#else\n  vec3 specularLight = SRGBtoLINEAR(textureCube(u_SpecularEnvSampler, reflection)).rgb;\n#endif\n\n  vec3 diffuse = diffuseLight * pbrInputs.diffuseColor;\n  vec3 specular = specularLight * (pbrInputs.specularColor * brdf.x + brdf.y);\n  diffuse *= u_ScaleIBLAmbient.x;\n  specular *= u_ScaleIBLAmbient.y;\n\n  return diffuse + specular;\n}\n#endif\n\n\nvec3 diffuse(PBRInfo pbrInputs)\n{\n  return pbrInputs.diffuseColor / M_PI;\n}\n\nvec3 specularReflection(PBRInfo pbrInputs)\n{\n  return pbrInputs.reflectance0 +\n    (pbrInputs.reflectance90 - pbrInputs.reflectance0) *\n    pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);\n}\n\n\n\nfloat geometricOcclusion(PBRInfo pbrInputs)\n{\n  float NdotL = pbrInputs.NdotL;\n  float NdotV = pbrInputs.NdotV;\n  float r = pbrInputs.alphaRoughness;\n\n  float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));\n  float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));\n  return attenuationL * attenuationV;\n}\n\n\n\n\n\nfloat microfacetDistribution(PBRInfo pbrInputs)\n{\n  float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;\n  float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;\n  return roughnessSq / (M_PI * f * f);\n}\n\nvec4 pbr_filterColor(vec4 colorUnused)\n{\n\n\n  float perceptualRoughness = u_MetallicRoughnessValues.y;\n  float metallic = u_MetallicRoughnessValues.x;\n#ifdef HAS_METALROUGHNESSMAP\n\n  vec4 mrSample = texture2D(u_MetallicRoughnessSampler, pbr_vUV);\n  perceptualRoughness = mrSample.g * perceptualRoughness;\n  metallic = mrSample.b * metallic;\n#endif\n  perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);\n  metallic = clamp(metallic, 0.0, 1.0);\n\n  float alphaRoughness = perceptualRoughness * perceptualRoughness;\n#ifdef HAS_BASECOLORMAP\n  vec4 baseColor = SRGBtoLINEAR(texture2D(u_BaseColorSampler, pbr_vUV)) * u_BaseColorFactor;\n#else\n  vec4 baseColor = u_BaseColorFactor;\n#endif\n\n  vec3 f0 = vec3(0.04);\n  vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);\n  diffuseColor *= 1.0 - metallic;\n  vec3 specularColor = mix(f0, baseColor.rgb, metallic);\n  float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\n\n\n\n  float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);\n  vec3 specularEnvironmentR0 = specularColor.rgb;\n  vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;\n\n  vec3 n = getNormal();\n  vec3 v = normalize(u_Camera - pbr_vPosition);\n  vec3 l = normalize(u_LightDirection);\n  vec3 h = normalize(l+v);\n  vec3 reflection = -normalize(reflect(v, n));\n\n  float NdotL = clamp(dot(n, l), 0.001, 1.0);\n  float NdotV = clamp(abs(dot(n, v)), 0.001, 1.0);\n  float NdotH = clamp(dot(n, h), 0.0, 1.0);\n  float LdotH = clamp(dot(l, h), 0.0, 1.0);\n  float VdotH = clamp(dot(v, h), 0.0, 1.0);\n\n  PBRInfo pbrInputs = PBRInfo(\n    NdotL,\n    NdotV,\n    NdotH,\n    LdotH,\n    VdotH,\n    perceptualRoughness,\n    metallic,\n    specularEnvironmentR0,\n    specularEnvironmentR90,\n    alphaRoughness,\n    diffuseColor,\n    specularColor\n  );\n  vec3 F = specularReflection(pbrInputs);\n  float G = geometricOcclusion(pbrInputs);\n  float D = microfacetDistribution(pbrInputs);\n  vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);\n  vec3 specContrib = F * G * D / (4.0 * NdotL * NdotV);\n  vec3 color = NdotL * u_LightColor * (diffuseContrib + specContrib);\n#ifdef USE_IBL\n  color += getIBLContribution(pbrInputs, n, reflection);\n#endif\n#ifdef HAS_OCCLUSIONMAP\n  float ao = texture2D(u_OcclusionSampler, pbr_vUV).r;\n  color = mix(color, color * ao, u_OcclusionStrength);\n#endif\n\n#ifdef HAS_EMISSIVEMAP\n  vec3 emissive = SRGBtoLINEAR(texture2D(u_EmissiveSampler, pbr_vUV)).rgb * u_EmissiveFactor;\n  color += emissive;\n#endif\n\n  color = mix(color, F, u_ScaleFGDSpec.x);\n  color = mix(color, vec3(G), u_ScaleFGDSpec.y);\n  color = mix(color, vec3(D), u_ScaleFGDSpec.z);\n  color = mix(color, specContrib, u_ScaleFGDSpec.w);\n\n  color = mix(color, diffuseContrib, u_ScaleDiffBaseMR.x);\n  color = mix(color, baseColor.rgb, u_ScaleDiffBaseMR.y);\n  color = mix(color, vec3(metallic), u_ScaleDiffBaseMR.z);\n  color = mix(color, vec3(perceptualRoughness), u_ScaleDiffBaseMR.w);\n\n  return vec4(pow(color,vec3(1.0/2.2)), baseColor.a);\n}\n",dependencies:[{name:"project2",vs:ci,fs:ci}]},fi=n(36),hi=n(67),di=n(114),pi=n(115);n(139)},function(t,e,n){"use strict";n.d(e,"c",(function(){return r.c})),n.d(e,"a",(function(){return r.a})),n.d(e,"b",(function(){return r.b})),n.d(e,"m",(function(){return i.c})),n.d(e,"n",(function(){return i.d})),n.d(e,"e",(function(){return i.b})),n.d(e,"d",(function(){return i.a})),n.d(e,"p",(function(){return o})),n.d(e,"f",(function(){return a})),n.d(e,"o",(function(){return u})),n.d(e,"k",(function(){return s})),n.d(e,"h",(function(){return f.a})),n.d(e,"q",(function(){return f.d})),n.d(e,"j",(function(){return h.b})),n.d(e,"i",(function(){return h.a})),n.d(e,"l",(function(){return d})),n.d(e,"g",(function(){return p.a}));var r=n(28),i=n(65);function o(t){return"undefined"!=typeof window&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60)}function a(t){return"undefined"!=typeof window&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t)}function s(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unnamed",n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/,r=t.match(n);return r?r[1]:e}function u(t,e,n,r){for(var i=t.split(/\r?\n/),o={},a={},u=r||s(e)||"(unnamed)",f="".concat(function(t){switch(t){case 35632:return"fragment";case 35633:return"vertex";default:return"unknown type"}}(n)," shader ").concat(u),h=0;h<i.length;h++){var d=i[h];if(!(d.length<=1)){var p=d.split(":"),g=p[0],v=parseInt(p[2],10);if(isNaN(v))throw new Error("GLSL compilation error in ".concat(f,": ").concat(t));"WARNING"!==g?o[v]=d:a[v]=d}}var y=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:": ",r=t.split(/\r?\n/),i=String(r.length+e-1).length;return r.map((function(t,r){var o=r+e,a=String(o).length;return l(o,i-a)+n+t}))}(e);return{shaderName:f,errors:c(o,y),warnings:c(a,y)}}function c(t,e){for(var n="",r=0;r<e.length;r++){var i=e[r];if((t[r+3]||t[r+2]||t[r+1])&&(n+="".concat(i,"\n"),t[r+1])){var o=t[r+1],a=o.split(":",3),s=a[0],u=parseInt(a[1],10)||0,c=o.substring(a.join(":").length+1).trim();n+=l("^^^ ".concat(s,": ").concat(c,"\n\n"),u)}}return n}function l(t,e){for(var n="",r=0;r<e;++r)n+=" ";return"".concat(n).concat(t)}var f=n(41),h=n(29);function d(t){var e=100,n=t.match(/[^\s]+/g);if(n.length>=2&&"#version"===n[0]){var r=parseInt(n[1],10);Number.isFinite(r)&&(e=r)}return e}var p=n(113)},function(t,e,n){t.exports=n(357)},function(t,e,n){"use strict";function r(t){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(22),i=n(17);function o(t,e){return!e||"object"!==Object(r.a)(e)&&"function"!=typeof e?Object(i.a)(t):e}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(87);function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Object(r.a)(t,e)}},function(t,e){function n(t,e,n,r){if(void 0===t)throw new Error("geometry is required");if(e&&e.constructor!==Object)throw new Error("properties must be an Object");if(n&&4!==n.length)throw new Error("bbox must be an Array of 4 numbers");if(r&&-1===["string","number"].indexOf(typeof r))throw new Error("id must be a number or a string");var i={type:"Feature"};return r&&(i.id=r),n&&(i.bbox=n),i.properties=e||{},i.geometry=t,i}function r(t,e,r,i){if(!t)throw new Error("No coordinates passed");if(void 0===t.length)throw new Error("Coordinates must be an array");if(t.length<2)throw new Error("Coordinates must be at least 2 numbers long");if(!p(t[0])||!p(t[1]))throw new Error("Coordinates must contain numbers");return n({type:"Point",coordinates:t},e,r,i)}function i(t,e,r,i){if(!t)throw new Error("No coordinates passed");for(var o=0;o<t.length;o++){var a=t[o];if(a.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<a[a.length-1].length;s++){if(0===o&&0===s&&!p(a[0][0])||!p(a[0][1]))throw new Error("Coordinates must contain numbers");if(a[a.length-1][s]!==a[0][s])throw new Error("First and last Position are not equivalent.")}}return n({type:"Polygon",coordinates:t},e,r,i)}function o(t,e,r,i){if(!t)throw new Error("No coordinates passed");if(t.length<2)throw new Error("Coordinates must be an array of two or more positions");if(!p(t[0][1])||!p(t[0][1]))throw new Error("Coordinates must contain numbers");return n({type:"LineString",coordinates:t},e,r,i)}function a(t,e,r,i){if(!t)throw new Error("No coordinates passed");return n({type:"MultiLineString",coordinates:t},e,r,i)}function s(t,e,r,i){if(!t)throw new Error("No coordinates passed");return n({type:"MultiPoint",coordinates:t},e,r,i)}function u(t,e,r,i){if(!t)throw new Error("No coordinates passed");return n({type:"MultiPolygon",coordinates:t},e,r,i)}var c={miles:3960,nauticalmiles:3441.145,degrees:57.2957795,radians:1,inches:250905600,yards:6969600,meters:6373e3,metres:6373e3,centimeters:6373e5,centimetres:6373e5,kilometers:6373,kilometres:6373,feet:20908792.65},l={kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,centimetres:1e4,millimeter:1e6,acres:247105e-9,miles:386e-9,yards:1.195990046,feet:10.763910417,inches:1550.003100006};function f(t,e){if(null==t)throw new Error("radians is required");var n=c[e||"kilometers"];if(!n)throw new Error("units is invalid");return t*n}function h(t,e){if(null==t)throw new Error("distance is required");var n=c[e||"kilometers"];if(!n)throw new Error("units is invalid");return t/n}function d(t){if(null==t)throw new Error("radians is required");return 180*(t%(2*Math.PI))/Math.PI}function p(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}t.exports={feature:n,geometry:function(t,e,n){if(!t)throw new Error("type is required");if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(n&&4!==n.length)throw new Error("bbox must be an Array of 4 numbers");var c;switch(t){case"Point":c=r(e).geometry;break;case"LineString":c=o(e).geometry;break;case"Polygon":c=i(e).geometry;break;case"MultiPoint":c=s(e).geometry;break;case"MultiLineString":c=a(e).geometry;break;case"MultiPolygon":c=u(e).geometry;break;default:throw new Error(t+" is invalid")}return n&&(c.bbox=n),c},featureCollection:function(t,e,n){if(!t)throw new Error("No features passed");if(!Array.isArray(t))throw new Error("features must be an Array");if(e&&4!==e.length)throw new Error("bbox must be an Array of 4 numbers");if(n&&-1===["string","number"].indexOf(typeof n))throw new Error("id must be a number or a string");var r={type:"FeatureCollection"};return n&&(r.id=n),e&&(r.bbox=e),r.features=t,r},geometryCollection:function(t,e,r,i){if(!t)throw new Error("geometries is required");if(!Array.isArray(t))throw new Error("geometries must be an Array");return n({type:"GeometryCollection",geometries:t},e,r,i)},point:r,multiPoint:s,lineString:o,multiLineString:a,polygon:i,multiPolygon:u,radiansToDistance:f,distanceToRadians:h,distanceToDegrees:function(t,e){return d(h(t,e))},radians2degrees:d,degrees2radians:function(t){if(null==t)throw new Error("degrees is required");return t%360*Math.PI/180},bearingToAngle:function(t){if(null==t)throw new Error("bearing is required");var e=t%360;return e<0&&(e+=360),e},convertDistance:function(t,e,n){if(null==t)throw new Error("distance is required");if(!(t>=0))throw new Error("distance must be a positive number");return f(h(t,e),n||"kilometers")},convertArea:function(t,e,n){if(null==t)throw new Error("area is required");if(!(t>=0))throw new Error("area must be a positive number");var r=l[e||"meters"];if(!r)throw new Error("invalid original units");var i=l[n||"kilometers"];if(!i)throw new Error("invalid final units");return t/r*i},round:function(t,e){if(null==t||isNaN(t))throw new Error("num is required");if(e&&!(e>=0))throw new Error("precision must be a positive number");var n=Math.pow(10,e||0);return Math.round(t*n)/n},isNumber:p}},function(t,e,n){"use strict";n.d(e,"p",(function(){return i})),n.d(e,"e",(function(){return o})),n.d(e,"a",(function(){return a})),n.d(e,"g",(function(){return s})),n.d(e,"o",(function(){return u})),n.d(e,"n",(function(){return c})),n.d(e,"j",(function(){return l})),n.d(e,"k",(function(){return f})),n.d(e,"l",(function(){return h})),n.d(e,"m",(function(){return d})),n.d(e,"c",(function(){return p})),n.d(e,"d",(function(){return g})),n.d(e,"i",(function(){return v})),n.d(e,"h",(function(){return y})),n.d(e,"f",(function(){return m})),n.d(e,"b",(function(){return b}));var r=n(14);function i(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],o=e[6],a=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=o,t[11]=e[14],t[12]=i,t[13]=a,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function o(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8],f=e[9],h=e[10],d=e[11],p=e[12],g=e[13],v=e[14],y=e[15],m=n*s-r*a,b=n*u-i*a,_=n*c-o*a,x=r*u-i*s,w=r*c-o*s,E=i*c-o*u,S=l*g-f*p,O=l*v-h*p,P=l*y-d*p,C=f*v-h*g,M=f*y-d*g,I=h*y-d*v,A=m*I-b*M+_*C+x*P-w*O+E*S;return A?(A=1/A,t[0]=(s*I-u*M+c*C)*A,t[1]=(i*M-r*I-o*C)*A,t[2]=(g*E-v*w+y*x)*A,t[3]=(h*w-f*E-d*x)*A,t[4]=(u*P-a*I-c*O)*A,t[5]=(n*I-i*P+o*O)*A,t[6]=(v*_-p*E-y*b)*A,t[7]=(l*E-h*_+d*b)*A,t[8]=(a*M-s*P+c*S)*A,t[9]=(r*P-n*M-o*S)*A,t[10]=(p*w-g*_+y*m)*A,t[11]=(f*_-l*w-d*m)*A,t[12]=(s*O-a*C-u*S)*A,t[13]=(n*C-r*O+i*S)*A,t[14]=(g*b-p*x-v*m)*A,t[15]=(l*x-f*b+h*m)*A,t):null}function a(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],u=t[7],c=t[8],l=t[9],f=t[10],h=t[11],d=t[12],p=t[13],g=t[14],v=t[15];return(e*a-n*o)*(f*v-h*g)-(e*s-r*o)*(l*v-h*p)+(e*u-i*o)*(l*g-f*p)+(n*s-r*a)*(c*v-h*d)-(n*u-i*a)*(c*g-f*d)+(r*u-i*s)*(c*p-l*d)}function s(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=e[9],d=e[10],p=e[11],g=e[12],v=e[13],y=e[14],m=e[15],b=n[0],_=n[1],x=n[2],w=n[3];return t[0]=b*r+_*s+x*f+w*g,t[1]=b*i+_*u+x*h+w*v,t[2]=b*o+_*c+x*d+w*y,t[3]=b*a+_*l+x*p+w*m,b=n[4],_=n[5],x=n[6],w=n[7],t[4]=b*r+_*s+x*f+w*g,t[5]=b*i+_*u+x*h+w*v,t[6]=b*o+_*c+x*d+w*y,t[7]=b*a+_*l+x*p+w*m,b=n[8],_=n[9],x=n[10],w=n[11],t[8]=b*r+_*s+x*f+w*g,t[9]=b*i+_*u+x*h+w*v,t[10]=b*o+_*c+x*d+w*y,t[11]=b*a+_*l+x*p+w*m,b=n[12],_=n[13],x=n[14],w=n[15],t[12]=b*r+_*s+x*f+w*g,t[13]=b*i+_*u+x*h+w*v,t[14]=b*o+_*c+x*d+w*y,t[15]=b*a+_*l+x*p+w*m,t}function u(t,e,n){var r,i,o,a,s,u,c,l,f,h,d,p,g=n[0],v=n[1],y=n[2];return e===t?(t[12]=e[0]*g+e[4]*v+e[8]*y+e[12],t[13]=e[1]*g+e[5]*v+e[9]*y+e[13],t[14]=e[2]*g+e[6]*v+e[10]*y+e[14],t[15]=e[3]*g+e[7]*v+e[11]*y+e[15]):(r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=e[9],d=e[10],p=e[11],t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=c,t[7]=l,t[8]=f,t[9]=h,t[10]=d,t[11]=p,t[12]=r*g+s*v+f*y+e[12],t[13]=i*g+u*v+h*y+e[13],t[14]=o*g+c*v+d*y+e[14],t[15]=a*g+l*v+p*y+e[15]),t}function c(t,e,n){var r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function l(t,e,n,i){var o,a,s,u,c,l,f,h,d,p,g,v,y,m,b,_,x,w,E,S,O,P,C,M,I=i[0],A=i[1],T=i[2],N=Math.hypot(I,A,T);return N<r.b?null:(I*=N=1/N,A*=N,T*=N,o=Math.sin(n),s=1-(a=Math.cos(n)),u=e[0],c=e[1],l=e[2],f=e[3],h=e[4],d=e[5],p=e[6],g=e[7],v=e[8],y=e[9],m=e[10],b=e[11],_=I*I*s+a,x=A*I*s+T*o,w=T*I*s-A*o,E=I*A*s-T*o,S=A*A*s+a,O=T*A*s+I*o,P=I*T*s+A*o,C=A*T*s-I*o,M=T*T*s+a,t[0]=u*_+h*x+v*w,t[1]=c*_+d*x+y*w,t[2]=l*_+p*x+m*w,t[3]=f*_+g*x+b*w,t[4]=u*E+h*S+v*O,t[5]=c*E+d*S+y*O,t[6]=l*E+p*S+m*O,t[7]=f*E+g*S+b*O,t[8]=u*P+h*C+v*M,t[9]=c*P+d*C+y*M,t[10]=l*P+p*C+m*M,t[11]=f*P+g*C+b*M,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function f(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[4],a=e[5],s=e[6],u=e[7],c=e[8],l=e[9],f=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+c*r,t[5]=a*i+l*r,t[6]=s*i+f*r,t[7]=u*i+h*r,t[8]=c*i-o*r,t[9]=l*i-a*r,t[10]=f*i-s*r,t[11]=h*i-u*r,t}function h(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],c=e[8],l=e[9],f=e[10],h=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i-c*r,t[1]=a*i-l*r,t[2]=s*i-f*r,t[3]=u*i-h*r,t[8]=o*r+c*i,t[9]=a*r+l*i,t[10]=s*r+f*i,t[11]=u*r+h*i,t}function d(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],c=e[4],l=e[5],f=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+c*r,t[1]=a*i+l*r,t[2]=s*i+f*r,t[3]=u*i+h*r,t[4]=c*i-o*r,t[5]=l*i-a*r,t[6]=f*i-s*r,t[7]=h*i-u*r,t}function p(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n+n,s=r+r,u=i+i,c=n*a,l=r*a,f=r*s,h=i*a,d=i*s,p=i*u,g=o*a,v=o*s,y=o*u;return t[0]=1-f-p,t[1]=l+y,t[2]=h-v,t[3]=0,t[4]=l-y,t[5]=1-c-p,t[6]=d+g,t[7]=0,t[8]=h+v,t[9]=d-g,t[10]=1-c-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function g(t,e,n,r,i,o,a){var s=1/(n-e),u=1/(i-r),c=1/(o-a);return t[0]=2*o*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*u,t[6]=0,t[7]=0,t[8]=(n+e)*s,t[9]=(i+r)*u,t[10]=(a+o)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*o*2*c,t[15]=0,t}function v(t,e,n,r,i){var o,a=1/Math.tan(e/2);return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(o=1/(r-i),t[10]=(i+r)*o,t[14]=2*i*r*o):(t[10]=-1,t[14]=-2*r),t}function y(t,e,n,r,i,o,a){var s=1/(e-n),u=1/(r-i),c=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*s,t[13]=(i+r)*u,t[14]=(a+o)*c,t[15]=1,t}function m(t,e,n,i){var o,a,s,u,c,l,f,h,d,p,g=e[0],v=e[1],y=e[2],m=i[0],b=i[1],_=i[2],x=n[0],w=n[1],E=n[2];return Math.abs(g-x)<r.b&&Math.abs(v-w)<r.b&&Math.abs(y-E)<r.b?function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}(t):(f=g-x,h=v-w,d=y-E,o=b*(d*=p=1/Math.hypot(f,h,d))-_*(h*=p),a=_*(f*=p)-m*d,s=m*h-b*f,(p=Math.hypot(o,a,s))?(o*=p=1/p,a*=p,s*=p):(o=0,a=0,s=0),u=h*s-d*a,c=d*o-f*s,l=f*a-h*o,(p=Math.hypot(u,c,l))?(u*=p=1/p,c*=p,l*=p):(u=0,c=0,l=0),t[0]=o,t[1]=u,t[2]=f,t[3]=0,t[4]=a,t[5]=c,t[6]=h,t[7]=0,t[8]=s,t[9]=l,t[10]=d,t[11]=0,t[12]=-(o*g+a*v+s*y),t[13]=-(u*g+c*v+l*y),t[14]=-(f*g+h*v+d*y),t[15]=1,t)}function b(t,e){var n=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],l=t[7],f=t[8],h=t[9],d=t[10],p=t[11],g=t[12],v=t[13],y=t[14],m=t[15],b=e[0],_=e[1],x=e[2],w=e[3],E=e[4],S=e[5],O=e[6],P=e[7],C=e[8],M=e[9],I=e[10],A=e[11],T=e[12],N=e[13],L=e[14],R=e[15];return Math.abs(n-b)<=r.b*Math.max(1,Math.abs(n),Math.abs(b))&&Math.abs(i-_)<=r.b*Math.max(1,Math.abs(i),Math.abs(_))&&Math.abs(o-x)<=r.b*Math.max(1,Math.abs(o),Math.abs(x))&&Math.abs(a-w)<=r.b*Math.max(1,Math.abs(a),Math.abs(w))&&Math.abs(s-E)<=r.b*Math.max(1,Math.abs(s),Math.abs(E))&&Math.abs(u-S)<=r.b*Math.max(1,Math.abs(u),Math.abs(S))&&Math.abs(c-O)<=r.b*Math.max(1,Math.abs(c),Math.abs(O))&&Math.abs(l-P)<=r.b*Math.max(1,Math.abs(l),Math.abs(P))&&Math.abs(f-C)<=r.b*Math.max(1,Math.abs(f),Math.abs(C))&&Math.abs(h-M)<=r.b*Math.max(1,Math.abs(h),Math.abs(M))&&Math.abs(d-I)<=r.b*Math.max(1,Math.abs(d),Math.abs(I))&&Math.abs(p-A)<=r.b*Math.max(1,Math.abs(p),Math.abs(A))&&Math.abs(g-T)<=r.b*Math.max(1,Math.abs(g),Math.abs(T))&&Math.abs(v-N)<=r.b*Math.max(1,Math.abs(v),Math.abs(N))&&Math.abs(y-L)<=r.b*Math.max(1,Math.abs(y),Math.abs(L))&&Math.abs(m-R)<=r.b*Math.max(1,Math.abs(m),Math.abs(R))}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(134);function i(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}}(t,e)||Object(r.a)(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return i})),n.d(e,"c",(function(){return o}));var r=1e-6,i="undefined"!=typeof Float32Array?Float32Array:Array,o=Math.random;Math.PI;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)})},function(t,e,n){"use strict";function r(t,e,n){if(null!==t){var i,o,a,s,u,c,l,f,h,d,p=0,g=0,v=t.type,y="FeatureCollection"===v,m="Feature"===v,b=y?t.features.length:1;for(i=0;i<b;i++)for(l=(d=!!(h=y?t.features[i].geometry:m?t.geometry:t)&&"GeometryCollection"===h.type)?h.geometries.length:1,o=0;o<l;o++){var _=0;if(null!==(c=d?h.geometries[o]:h)){f=c.coordinates;var x=c.type;switch(p=!n||"Polygon"!==x&&"MultiPolygon"!==x?0:1,x){case null:break;case"Point":e(f,g,i,_),g++,_++;break;case"LineString":case"MultiPoint":for(a=0;a<f.length;a++)e(f[a],g,i,_),g++,"MultiPoint"===x&&_++;"LineString"===x&&_++;break;case"Polygon":case"MultiLineString":for(a=0;a<f.length;a++){for(s=0;s<f[a].length-p;s++)e(f[a][s],g,i,_),g++;"MultiLineString"===x&&_++}"Polygon"===x&&_++;break;case"MultiPolygon":for(a=0;a<f.length;a++){for(s=0;s<f[a].length;s++)for(u=0;u<f[a][s].length-p;u++)e(f[a][s][u],g,i,_),g++;_++}break;case"GeometryCollection":for(a=0;a<c.geometries.length;a++)r(c.geometries[a],e,n);break;default:throw new Error("Unknown Geometry Type")}}}}}function i(t,e,n,i){var o=n;return r(t,(function(t,r,i,a){o=0===r&&void 0===n?t:e(o,t,r,i,a)}),i),o}function o(t,e){var n;switch(t.type){case"FeatureCollection":for(n=0;n<t.features.length;n++)e(t.features[n].properties,n);break;case"Feature":e(t.properties,0)}}function a(t,e,n){var r=n;return o(t,(function(t,i){r=0===i&&void 0===n?t:e(r,t,i)})),r}function s(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var n=0;n<t.features.length;n++)e(t.features[n],n)}function u(t,e,n){var r=n;return s(t,(function(t,i){r=0===i&&void 0===n?t:e(r,t,i)})),r}function c(t){var e=[];return r(t,(function(t){e.push(t)})),e}function l(t,e){var n,r,i,o,a,s,u,c,l=0,f="FeatureCollection"===t.type,h="Feature"===t.type,d=f?t.features.length:1;for(n=0;n<d;n++){for(s=f?t.features[n].geometry:h?t.geometry:t,c=f?t.features[n].properties:h?t.properties:{},a=(u=!!s&&"GeometryCollection"===s.type)?s.geometries.length:1,i=0;i<a;i++)if(null!==(o=u?s.geometries[i]:s))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":e(o,l,c);break;case"GeometryCollection":for(r=0;r<o.geometries.length;r++)e(o.geometries[r],l,c);break;default:throw new Error("Unknown Geometry Type")}else e(null,l,c);l++}}function f(t,e,n){var r=n;return l(t,(function(t,i,o){r=0===i&&void 0===n?t:e(r,t,i,o)})),r}function h(t,e){l(t,(function(t,n,r){var i,o=null===t?null:t.type;switch(o){case null:case"Point":case"LineString":case"Polygon":return void e(v(t,r),n,0)}switch(o){case"MultiPoint":i="Point";break;case"MultiLineString":i="LineString";break;case"MultiPolygon":i="Polygon"}t.coordinates.forEach((function(t,o){e(v({type:i,coordinates:t},r),n,o)}))}))}function d(t,e,n){var r=n;return h(t,(function(t,i,o){r=0===i&&0===o&&void 0===n?t:e(r,t,i,o)})),r}function p(t,e){h(t,(function(t,n,r){var o=0;if(t.geometry){var a=t.geometry.type;"Point"!==a&&"MultiPoint"!==a&&i(t,(function(i,a){var s=y([i,a],t.properties);return e(s,n,r,o),o++,a}))}}))}function g(t,e,n){var r=n,i=!1;return p(t,(function(t,o,a,s){r=!1===i&&void 0===n?t:e(r,t,o,a,s),i=!0})),r}function v(t,e){if(void 0===t)throw new Error("No geometry passed");return{type:"Feature",properties:e||{},geometry:t}}function y(t,e){if(!t)throw new Error("No coordinates passed");if(t.length<2)throw new Error("Coordinates must be an array of two or more positions");return{type:"Feature",properties:e||{},geometry:{type:"LineString",coordinates:t}}}function m(t,e){if(!t)throw new Error("geojson is required");var n=t.geometry?t.geometry.type:t.type;if(!n)throw new Error("invalid geojson");if("FeatureCollection"===n)throw new Error("FeatureCollection is not supported");if("GeometryCollection"===n)throw new Error("GeometryCollection is not supported");var r=t.geometry?t.geometry.coordinates:t.coordinates;if(!r)throw new Error("geojson must contain coordinates");switch(n){case"LineString":return void e(r,0,0);case"Polygon":case"MultiLineString":for(var i=0,o=0;o<r.length;o++)"MultiLineString"===n&&(i=o),e(r[o],o,i);return;case"MultiPolygon":for(var a=0;a<r.length;a++)for(var s=0;s<r[a].length;s++)e(r[a][s],s,a);return;default:throw new Error(n+" geometry not supported")}}function b(t,e,n){var r=n;return m(t,(function(t,i,o){r=0===i&&void 0===n?t:e(r,t,i,o)})),r}n.r(e),n.d(e,"coordEach",(function(){return r})),n.d(e,"coordReduce",(function(){return i})),n.d(e,"propEach",(function(){return o})),n.d(e,"propReduce",(function(){return a})),n.d(e,"featureEach",(function(){return s})),n.d(e,"featureReduce",(function(){return u})),n.d(e,"coordAll",(function(){return c})),n.d(e,"geomEach",(function(){return l})),n.d(e,"geomReduce",(function(){return f})),n.d(e,"flattenEach",(function(){return h})),n.d(e,"flattenReduce",(function(){return d})),n.d(e,"segmentEach",(function(){return p})),n.d(e,"segmentReduce",(function(){return g})),n.d(e,"feature",(function(){return v})),n.d(e,"lineString",(function(){return y})),n.d(e,"lineEach",(function(){return m})),n.d(e,"lineReduce",(function(){return b}))},function(t,e){function n(t){if(!t)throw new Error("obj is required");var e;if(t.length?e=t:t.coordinates?e=t.coordinates:t.geometry&&t.geometry.coordinates&&(e=t.geometry.coordinates),e)return r(e),e;throw new Error("No valid coordinates")}function r(t){if(t.length>1&&"number"==typeof t[0]&&"number"==typeof t[1])return!0;if(Array.isArray(t[0])&&t[0].length)return r(t[0]);throw new Error("coordinates must only contain numbers")}function i(t){if(!t)throw new Error("geojson is required");if(void 0!==t.geometry)return t.geometry;if(t.coordinates||t.geometries)return t;throw new Error("geojson must be a valid Feature or Geometry Object")}t.exports={geojsonType:function(t,e,n){if(!e||!n)throw new Error("type and name required");if(!t||t.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.type)},collectionOf:function(t,e,n){if(!t)throw new Error("No featureCollection passed");if(!n)throw new Error(".collectionOf() requires a name");if(!t||"FeatureCollection"!==t.type)throw new Error("Invalid input to "+n+", FeatureCollection required");for(var r=0;r<t.features.length;r++){var i=t.features[r];if(!i||"Feature"!==i.type||!i.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!i.geometry||i.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+i.geometry.type)}},featureOf:function(t,e,n){if(!t)throw new Error("No feature passed");if(!n)throw new Error(".featureOf() requires a name");if(!t||"Feature"!==t.type||!t.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!t.geometry||t.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.geometry.type)},getCoord:function(t){if(!t)throw new Error("obj is required");var e=n(t);if(e.length>1&&"number"==typeof e[0]&&"number"==typeof e[1])return e;throw new Error("Coordinate is not a valid Point")},getCoords:n,containsNumber:r,getGeom:i,getGeomType:function(t){if(!t)throw new Error("geojson is required");var e=i(t);if(e)return e.type}}},function(t,e,n){"use strict";function r(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";n.d(e,"c",(function(){return r})),n.d(e,"a",(function(){return i})),n.d(e,"f",(function(){return a})),n.d(e,"h",(function(){return c})),n.d(e,"d",(function(){return l})),n.d(e,"b",(function(){return f})),n.d(e,"g",(function(){return h})),n.d(e,"e",(function(){return d}));var r={};function i(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function o(t){return Math.round(t/r.EPSILON)*r.EPSILON}function a(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.precision,i=void 0===n?r.precision||4:n;return t=o(t),parseFloat(t.toPrecision(i))}function s(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&void 0!==t.length}function u(t,e){if(s(t)){for(var n=(i=t).clone?i.clone():new Array(i),r=0;r<n.length;++r)n[r]=e(n[r],r,n);return n}var i;return e(t)}function c(t){return u(t,(function(t){return t/180*Math.PI}))}function l(t){return u(t,(function(t){return 180*t/Math.PI}))}function f(t,e,n){return u(t,(function(t){return Math.max(e,Math.min(n,t))}))}function h(t,e,n){return s(t)?t.map((function(t,r){return h(t,e[r],n)})):n*e+(1-n)*t}function d(t,e){if(s(t)&&s(e)){if(t===e)return!0;if(t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(!d(t[n],e[n]))return!1;return!0}return Math.abs(t-e)<=r.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))}r.EPSILON=1e-12,r.debug=!0,r.precision=4,r.printTypes=!1,r.printDegrees=!1,r.printRowMajor=!0},function(t,e,n){"use strict";n.d(e,"a",(function(){return g}));var r=n(1),i=n(2),o=n(9),a=n(8),s=n(10),u=n(17),c=n(26),l=n(48),f=n(6),h=n(41),d=n(4),p=n(3),g=function(t){function e(t){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(r.a)(this,e),(n=Object(o.a)(this,Object(a.a)(e).call(this,t,i))).stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),n.target=i.target||(n.gl.webgl2?36662:34962),n._initialize(i),Object.seal(Object(u.a)(Object(u.a)(n))),n}return Object(s.a)(e,t),Object(i.a)(e,[{key:"getElementCount",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.accessor;return Math.round(this.byteLength/l.a.getBytesPerElement(t))}},{key:"getVertexCount",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.accessor;return Math.round(this.byteLength/l.a.getBytesPerVertex(t))}},{key:"initialize",value:function(t){return this._initialize(t)}},{key:"setProps",value:function(t){return"data"in t&&this.setData(t),this}},{key:"setAccessor",value:function(t){return this.accessor=t,this}},{key:"reallocate",value:function(t){return t>this.byteLength?(this._setByteLength(t),!0):(this.bytesUsed=t,!1)}},{key:"setData",value:function(t){return this.initialize(t)}},{key:"subData",value:function(t){ArrayBuffer.isView(t)&&(t={data:t});var e=t,n=e.data,r=e.offset,i=void 0===r?0:r,o=e.srcOffset,a=void 0===o?0:o,s=t.byteLength||t.length;Object(p.a)(n);var u=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(u,this.handle),0!==a||void 0!==s?(Object(f.d)(this.gl),this.gl.bufferSubData(this.target,i,n,a,s)):this.gl.bufferSubData(u,i,n),this.gl.bindBuffer(u,null),this.debugData=null,this.accessor.type||this.setAccessor(new l.a(this.accessor,{type:Object(h.b)(n)})),this}},{key:"copyData",value:function(t){var e=t.sourceBuffer,n=t.readOffset,r=void 0===n?0:n,i=t.writeOffset,o=void 0===i?0:i,a=t.size,s=this.gl;return Object(f.d)(s),s.bindBuffer(36662,e.handle),s.bindBuffer(36663,this.handle),s.copyBufferSubData(36662,36663,r,o,a),s.bindBuffer(36662,null),s.bindBuffer(36663,null),this.debugData=null,this}},{key:"getData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.dstData,n=void 0===e?null:e,r=t.srcByteOffset,i=void 0===r?0:r,o=t.dstOffset,a=void 0===o?0:o,s=t.length,u=void 0===s?0:s;Object(f.d)(this.gl);var c,l,d=Object(h.c)(this.accessor.type||5126,{clamped:!1}),g=this._getAvailableElementCount(i),v=a;n?c=(l=n.length)-v:l=v+(c=Math.min(g,u||g));var y=Math.min(g,c);return u=u||y,Object(p.a)(u<=y),n=n||new d(l),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,i,n,a,u),this.gl.bindBuffer(36662,null),n}},{key:"bind",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.target,n=void 0===e?this.target:e,r=t.index,i=void 0===r?this.accessor&&this.accessor.index:r,o=t.offset,a=void 0===o?0:o,s=t.size;return 35345===n||35982===n?void 0!==s?this.gl.bindBufferRange(n,i,this.handle,a,s):(Object(p.a)(0===a),this.gl.bindBufferBase(n,i,this.handle)):this.gl.bindBuffer(n,this.handle),this}},{key:"unbind",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.target,n=void 0===e?this.target:e,r=t.index,i=void 0===r?this.accessor&&this.accessor.index:r,o=35345===n||35982===n;return o?this.gl.bindBufferBase(n,i,null):this.gl.bindBuffer(n,null),this}},{key:"getDebugData",value:function(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:10}),{data:this.debugData,changed:!0})}},{key:"invalidateDebugData",value:function(){this.debugData=null}},{key:"_initialize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ArrayBuffer.isView(t)&&(t={data:t}),Number.isFinite(t)&&(t={byteLength:t}),t.bytes&&d.g.deprecated("bytes","byteLength");var e=t.byteLength||t.bytes||0;return this.usage=t.usage||35044,this.setAccessor(new l.a(t,t.accessor)),t.data?this._setData(t.data):this._setByteLength(e)}},{key:"_setData",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.usage;Object(p.a)(ArrayBuffer.isView(t));var n=this._getTarget();this.gl.bindBuffer(n,this.handle),this.gl.bufferData(n,t,e),this.gl.bindBuffer(n,null),this.usage=e,this.debugData=t.slice(0,10),this.byteLength=t.byteLength,this.bytesUsed=t.byteLength;var r=Object(h.b)(t);return Object(p.a)(r),this.setAccessor(new l.a(this.accessor,{type:r})),this}},{key:"_setByteLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.usage;Object(p.a)(t>=0);var n=t;0===t&&(n=new Float32Array(0));var r=this._getTarget();return this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,n,e),this.gl.bindBuffer(r,null),this.usage=e,this.debugData=null,this.byteLength=t,this.bytesUsed=t,this}},{key:"_getTarget",value:function(){return this.gl.webgl2?36663:this.target}},{key:"_getAvailableElementCount",value:function(t){var e=t/Object(h.c)(this.accessor.type||5126,{clamped:!1}).BYTES_PER_ELEMENT;return this.getElementCount()-e}},{key:"_createHandle",value:function(){return this.gl.createBuffer()}},{key:"_deleteHandle",value:function(){this.gl.deleteBuffer(this.handle)}},{key:"_getParameter",value:function(t){this.gl.bindBuffer(this.target,this.handle);var e=this.gl.getBufferParameter(this.target,t);return this.gl.bindBuffer(this.target,null),e}},{key:"updateAccessor",value:function(t){return d.g.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)"),this.accessor=new l.a(this.accessor,t),this}},{key:"setByteLength",value:function(t){return d.g.deprecated("setByteLength","reallocate"),this.reallocate(t)}},{key:"data",get:function(){d.g.removed("Buffer.data","N/A","v6.0")}},{key:"bytes",get:function(){return d.g.deprecated("Buffer.bytes","Buffer.byteLength","v6.1"),this.byteLength}}]),e}(c.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(102);var i=n(134);function o(t){return function(t){if(Array.isArray(t))return Object(r.a)(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||Object(i.a)(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},function(t,e,n){"use strict";(function(t){n.d(e,"c",(function(){return i})),n.d(e,"d",(function(){return o})),n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return s}));var r={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:void 0!==t&&t,document:"undefined"!=typeof document&&document},i=r.self||r.window||r.global,o=r.window||r.self||r.global,a=r.global||r.self||r.window,s=r.document||{}}).call(this,n(50))},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}n.d(e,"a",(function(){return r}))},function(e,n){e.exports=t},function(t,e,n){"use strict";n.d(e,"f",(function(){return f})),n.d(e,"g",(function(){return h}));var r=n(13),i=n(20),o=n(68),a=n(54);n.d(e,"b",(function(){return a.c})),n.d(e,"c",(function(){return a.d})),n.d(e,"e",(function(){return a.f})),n.d(e,"d",(function(){return a.e})),n.d(e,"a",(function(){return a.b}));var s=n(4),u=n(3),c={framebuffer:function(t,e){var n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:function(t,e){return e?t.enable(3042):t.disable(3042)},blendColor:function(t,e){return t.blendColor.apply(t,Object(i.a)(e))},blendEquation:function(t,e){e=l(e)?e:[e,e],t.blendEquationSeparate.apply(t,Object(i.a)(e))},blendFunc:function(t,e){e=l(e)&&2===e.length?Object(i.a)(e).concat(Object(i.a)(e)):e,t.blendFuncSeparate.apply(t,Object(i.a)(e))},clearColor:function(t,e){return t.clearColor.apply(t,Object(i.a)(e))},clearDepth:function(t,e){return t.clearDepth(e)},clearStencil:function(t,e){return t.clearStencil(e)},colorMask:function(t,e){return t.colorMask.apply(t,Object(i.a)(e))},cull:function(t,e){return e?t.enable(2884):t.disable(2884)},cullFace:function(t,e){return t.cullFace(e)},depthTest:function(t,e){return e?t.enable(2929):t.disable(2929)},depthFunc:function(t,e){return t.depthFunc(e)},depthMask:function(t,e){return t.depthMask(e)},depthRange:function(t,e){return t.depthRange.apply(t,Object(i.a)(e))},dither:function(t,e){return e?t.enable(3024):t.disable(3024)},derivativeHint:function(t,e){t.hint(35723,e)},frontFace:function(t,e){return t.frontFace(e)},mipmapHint:function(t,e){return t.hint(33170,e)},lineWidth:function(t,e){return t.lineWidth(e)},polygonOffsetFill:function(t,e){return e?t.enable(32823):t.disable(32823)},polygonOffset:function(t,e){return t.polygonOffset.apply(t,Object(i.a)(e))},sampleCoverage:function(t,e){return t.sampleCoverage.apply(t,Object(i.a)(e))},scissorTest:function(t,e){return e?t.enable(3089):t.disable(3089)},scissor:function(t,e){return t.scissor.apply(t,Object(i.a)(e))},stencilTest:function(t,e){return e?t.enable(2960):t.disable(2960)},stencilMask:function(t,e){var n=e=l(e)?e:[e,e],i=Object(r.a)(n,2),o=i[0],a=i[1];t.stencilMaskSeparate(1028,o),t.stencilMaskSeparate(1029,a)},stencilFunc:function(t,e){var n=e=l(e)&&3===e.length?Object(i.a)(e).concat(Object(i.a)(e)):e,o=Object(r.a)(n,6),a=o[0],s=o[1],u=o[2],c=o[3],f=o[4],h=o[5];t.stencilFuncSeparate(1028,a,s,u),t.stencilFuncSeparate(1029,c,f,h)},stencilOp:function(t,e){var n=e=l(e)&&3===e.length?Object(i.a)(e).concat(Object(i.a)(e)):e,o=Object(r.a)(n,6),a=o[0],s=o[1],u=o[2],c=o[3],f=o[4],h=o[5];t.stencilOpSeparate(1028,a,s,u),t.stencilOpSeparate(1029,c,f,h)},viewport:function(t,e){return t.viewport.apply(t,Object(i.a)(e))}};function l(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function f(t,e){for(var n in Object(a.g)(t,e),e){var r=c[n];r&&r(t,e[n],n)}}function h(t,e,n){if(Object(s.d)(e))return n(t);var r,i=e.nocatch,a=void 0===i||i;if(Object(u.a)(!e.frameBuffer),Object(o.c)(t),f(t,e),a)r=n(t),Object(o.b)(t);else try{r=n(t)}finally{Object(o.b)(t)}return r}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i="undefined"!=typeof window&&window.addEventListener,o=new Map,a=function(){return i&&window.__SEER_INITIALIZED__},s=function(t,e){var n=o.get(t),r=Date.now();return!!(n&&r-n<e)||(o.set(t,r),!1)},u=function(t){return function(e,n){if(!n||"object"!==(void 0===n?"undefined":r(n))||!t.has(n))return t.add(n),Object.prototype.toString.call(n).slice(8,-1).includes("Array")?Array.prototype.slice.call(n,0,20):n}},c=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(i&&a()){var n=new Set,r=JSON.stringify(e,u(n));try{window.postMessage({type:t,payload:r,source:"seer-agent"},"*")}catch(t){if(s("seer-log",2e3))return;console.log(t)}}},l=new Map,f=function(t){if(t&&t.data&&"seer-core"===t.data.source){var e=t.data,n=e.type,r=e.payload,i=l.get(n);i&&i.forEach((function(t){return t(r)}))}},h=function(){i&&!window.__SEER_LISTENER__&&(window.addEventListener("message",f),window.__SEER_LISTENER__=!0)};e.default={send:c,throttle:s,isReady:a,list:function(t,e){return c("LIST",{key:t,data:e})},listItem:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return c("LIST_ITEM",{key:t,itemKey:e,data:n})},updateItem:function(t,e,n,r){return c("UPDATE_ITEM",{key:t,itemKey:e,path:n,data:r})},multiUpdate:function(t,e,n){return c("MULTI_UPDATE_ITEM",{key:t,itemKey:e,array:n})},deleteItem:function(t,e){return c("DELETE_ITEM",{key:t,itemKey:e})},addLog:function(t,e,n){return c("ADD_LOG",{key:t,itemKey:e,msg:n})},listeners:l,listenFor:function(t,e){if(i){if(!t||!e)throw new Error("Please provide a type and callback");l.has(t)||l.set(t,[]),window.__SEER_LISTENER__||h(),l.get(t).push(e)}},removeListener:function(t){l.forEach((function(e,n){l.set(n,e.filter((function(e){return e!==t})))}))},init:h,clean:function(){i&&window.__SEER_LISTENER__&&(window.removeEventListener("message",f),delete window.__SEER_LISTENER__)}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n(1),i=n(2),o=n(139),a=n(6),s=n(4),u=n(3),c="Resource subclass must define virtual methods",l=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(r.a)(this,t),Object(a.e)(e);var i=n.id,o=n.userData,u=void 0===o?{}:o;this.gl=e,this.id=i||Object(s.i)(this.constructor.name),this.userData=u,this._bound=!1,this._handle=n.handle,void 0===this._handle&&(this._handle=this._createHandle()),this._addStats()}return Object(i.a)(t,[{key:"toString",value:function(){return"".concat(this.constructor.name,"(").concat(this.id,")")}},{key:"delete",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.deleteChildren,n=void 0!==e&&e,r=this._handle&&this._deleteHandle(this._handle);return this._handle=null,this._removeStats(),r&&n&&r.filter(Boolean).forEach((function(t){t.delete()})),this}},{key:"bind",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.handle;return"function"!=typeof e?(this._bindHandle(e),this):(this._bound?t=e():(this._bindHandle(this.handle),this._bound=!0,t=e(),this._bound=!1,this._bindHandle(null)),t)}},{key:"unbind",value:function(){this.bind(null)}},{key:"getParameter",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t=Object(a.j)(this.gl,t),Object(u.a)(t);var n=this.constructor.PARAMETERS||{},r=n[t];if(r){var i=Object(a.n)(this.gl),o=(!("webgl2"in r)||i)&&(!("extension"in r)||this.gl.getExtension(r.extension));if(!o){var s=r.webgl1,c="webgl2"in r?r.webgl2:r.webgl1,l=i?c:s;return l}}return this._getParameter(t,e)}},{key:"getParameters",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e={},n=e.parameters,r=e.keys,i=this.constructor.PARAMETERS||{},o=Object(a.n)(this.gl),s={},u=n||Object.keys(i),c=!0,l=!1,f=void 0;try{for(var h,d=u[Symbol.iterator]();!(c=(h=d.next()).done);c=!0){var p=h.value,g=i[p],v=g&&(!("webgl2"in g)||o)&&(!("extension"in g)||this.gl.getExtension(g.extension));if(v){var y=r?Object(a.i)(this.gl,p):p;s[y]=this.getParameter(p,t),r&&"GLenum"===g.type&&(s[y]=Object(a.i)(this.gl,s[y]))}}}catch(t){l=!0,f=t}finally{try{c||null==d.return||d.return()}finally{if(l)throw f}}return s}},{key:"setParameter",value:function(t,e){t=Object(a.j)(this.gl,t),Object(u.a)(t);var n=(this.constructor.PARAMETERS||{})[t];if(n){var r=Object(a.n)(this.gl);if(!((!("webgl2"in n)||r)&&(!("extension"in n)||this.gl.getExtension(n.extension))))throw new Error("Parameter not available on this platform");"GLenum"===n.type&&(e=Object(a.j)(e))}return this._setParameter(t,e),this}},{key:"setParameters",value:function(t){for(var e in t)this.setParameter(e,t[e]);return this}},{key:"stubRemovedMethods",value:function(t,e,n){return Object(s.h)(this,t,e,n)}},{key:"initialize",value:function(t){}},{key:"_createHandle",value:function(){throw new Error(c)}},{key:"_deleteHandle",value:function(){throw new Error(c)}},{key:"_bindHandle",value:function(){throw new Error(c)}},{key:"_getOptsFromHandle",value:function(){throw new Error(c)}},{key:"_getParameter",value:function(t,e){throw new Error(c)}},{key:"_setParameter",value:function(t,e){throw new Error(c)}},{key:"_context",value:function(){return this.gl.luma=this.gl.luma||{},this.gl.luma}},{key:"_addStats",value:function(){var t=this.constructor.name,e=o.default.stats;e.resourceCount=e.resourceCount||0,e.resourceMap=e.resourceMap||{},e.resourceCount++,e.resourceMap[t]=e.resourceMap[t]||{created:0,active:0},e.resourceMap[t].created++,e.resourceMap[t].active++}},{key:"_removeStats",value:function(){var t=this.constructor.name;o.default.stats.resourceMap[t].active--}},{key:"handle",get:function(){return this._handle}}]),t}()},,function(t,e,n){"use strict";n.d(e,"d",(function(){return s})),n.d(e,"c",(function(){return f})),n.d(e,"b",(function(){return d})),n.d(e,"a",(function(){return p}));var r=n(1),i=n(21),o=n(67),a=null,s=function(){throw new Error("luma.gl: loaded under Node.js without headless gl installed, meaning that WebGL contexts can not be created. This may not be an error. For example, this is a typical configuration for isorender applications running on the server.")};if(!o.a)try{s=n(345),a=n(346)}catch(t){}var u=function t(){Object(r.a)(this,t)},c=a||i.b,l=c.WebGLRenderingContext,f=void 0===l?u:l,h=(c.WebGLProgram,c.WebGLShader,c.WebGLBuffer),d=void 0===h?u:h;c.WebGLFramebuffer,c.WebGLRenderbuffer,c.WebGLTexture,c.WebGLUniformLocation,c.WebGLActiveInfo,c.WebGLShaderPrecisionFormat;var p=i.b.WebGL2RenderingContext||function t(){Object(r.a)(this,t)};i.b.Image},function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return a})),n.d(e,"c",(function(){return s})),n.d(e,"d",(function(){return u})),n.d(e,"e",(function(){return c}));var r=n(3),i=n(36);function o(t,e){if("string"!=typeof e)return e;var n=Number(e);if(!isNaN(n))return n;var i=t[e=e.replace(/^.*\./,"")];return Object(r.a)(void 0!==i,"Accessing undefined constant GL.".concat(e)),i}function a(t,e){for(var n in e=Number(e),t)if(t[n]===e)return"GL.".concat(n);return String(e)}function s(t,e){return e||i.a.removed("glGet(name)","glGet(gl, name)","6.0")(),o(t,e)}function u(t,e){return void 0===e&&i.a.removed("glKey(value)","glKey(gl, value)","6.0")(),a(t,e)}function c(t,e){return void 0===e&&i.a.removed("glKeyType(value)","glKeyType(gl, value)","6.0")(),function(t,e){for(var n in Object(r.a)(void 0!==e,"undefined key"),e=Number(e),t)if(t[n]===e)return"GL.".concat(n);return String(e)}(t,e)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"f",(function(){return o})),n.d(e,"c",(function(){return a})),n.d(e,"e",(function(){return s})),n.d(e,"b",(function(){return u})),n.d(e,"d",(function(){return c})),n.d(e,"h",(function(){return l})),n.d(e,"g",(function(){return d}));var r=n(14);function i(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function o(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function a(t){var e=t[0],n=t[1];return Math.hypot(e,n)}function s(t,e){return t[0]=-e[0],t[1]=-e[1],t}function u(t,e,n){var r=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=r,t}function c(t,e,n,r){var i=e[0],o=e[1];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t}function l(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}var f,h,d=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t};f=new r.a(2),r.a!=Float32Array&&(f[0]=0,f[1]=0),h=f},function(t,e,n){t.exports={default:n(309),__esModule:!0}},function(t,e,n){"use strict";e.__esModule=!0,e.default=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e,n){"use strict";e.__esModule=!0;var r,i=n(311),o=(r=i)&&r.__esModule?r:{default:r};e.default=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),(0,o.default)(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}()},function(t,e,n){"use strict";e.__esModule=!0;var r,i=n(146),o=(r=i)&&r.__esModule?r:{default:r};e.default=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":(0,o.default)(e))&&"function"!=typeof e?t:e}},function(t,e,n){"use strict";e.__esModule=!0;var r=a(n(335)),i=a(n(339)),o=a(n(146));function a(t){return t&&t.__esModule?t:{default:t}}e.default=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":(0,o.default)(e)));t.prototype=(0,i.default)(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(r.default?(0,r.default)(t,e):t.__proto__=e)}},function(t,e,n){"use strict";var r=n(553);e.a=new r.a({id:"luma"}).enable()},function(t,e,n){var r=n(16).getCoord,i=n(11).radiansToDistance;t.exports=function(t,e,n){var o=Math.PI/180,a=r(t),s=r(e),u=o*(s[1]-a[1]),c=o*(s[0]-a[0]),l=o*a[1],f=o*s[1],h=Math.pow(Math.sin(u/2),2)+Math.pow(Math.sin(c/2),2)*Math.cos(l)*Math.cos(f);return i(2*Math.atan2(Math.sqrt(h),Math.sqrt(1-h)),n)}},function(t,e){var n=t.exports={version:"2.6.11"};"number"==typeof __e&&(__e=n)},function(t,e,n){var r=n(15).coordEach;t.exports=function(t){var e=[1/0,1/0,-1/0,-1/0];return r(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}},function(t,e,n){t.exports=n(342)()},function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return o})),n.d(e,"d",(function(){return a}));function r(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error("Failed to deduce GL constant from typed array")}}function i(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.clamped,r=void 0===n||n;switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return r?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function o(t){var e=t.data,n=t.width,r=t.height,i=t.bytesPerPixel,o=void 0===i?4:i,a=t.temp,s=n*o;a=a||new Uint8Array(s);for(var u=0;u<r/2;++u){var c=u*s,l=(r-u-1)*s;a.set(e.subarray(c,c+s)),e.copyWithin(c,l,l+s),e.set(a,l)}}function a(t){for(var e=t.data,n=t.width,r=t.height,i=Math.round(n/2),o=Math.round(r/2),a=new Uint8Array(i*o*4),s=0;s<o;s++)for(var u=0;u<i;u++)for(var c=0;c<4;c++)a[4*(s*i+u)+c]=e[4*(2*s*n+2*u)+c];return{data:a,width:i,height:o}}},function(t,e,n){"use strict";n.r(e),n.d(e,"COORDINATE_SYSTEM",(function(){return f})),n.d(e,"Deck",(function(){return Wi})),n.d(e,"Layer",(function(){return qe})),n.d(e,"CompositeLayer",(function(){return Qi})),n.d(e,"View",(function(){return Fn})),n.d(e,"MapView",(function(){return ii})),n.d(e,"FirstPersonView",(function(){return yo})),n.d(e,"ThirdPersonView",(function(){return So})),n.d(e,"OrbitView",(function(){return oa})),n.d(e,"PerspectiveView",(function(){return da})),n.d(e,"OrthographicView",(function(){return La})),n.d(e,"Viewport",(function(){return wn})),n.d(e,"WebMercatorViewport",(function(){return nr})),n.d(e,"Controller",(function(){return Ir})),n.d(e,"MapController",(function(){return Qr})),n.d(e,"AttributeManager",(function(){return zt})),n.d(e,"project",(function(){return S})),n.d(e,"project64",(function(){return M})),n.d(e,"lighting",(function(){return nt})),n.d(e,"LayerManager",(function(){return Mn})),n.d(e,"log",(function(){return i})),n.d(e,"_OrbitController",(function(){return Xo})),n.d(e,"_FirstPersonController",(function(){return co})),n.d(e,"TRANSITION_EVENTS",(function(){return yr})),n.d(e,"LinearInterpolator",(function(){return dr})),n.d(e,"FlyToInterpolator",(function(){return Ka})),n.d(e,"_EffectManager",(function(){return ai})),n.d(e,"_Effect",(function(){return fi})),n.d(e,"_ReflectionEffect",(function(){return za})),n.d(e,"ArcLayer",(function(){return Qs})),n.d(e,"IconLayer",(function(){return mu})),n.d(e,"LineLayer",(function(){return Mu})),n.d(e,"PointCloudLayer",(function(){return zu})),n.d(e,"ScatterplotLayer",(function(){return Ju})),n.d(e,"ScreenGridLayer",(function(){return lc})),n.d(e,"GridLayer",(function(){return kc})),n.d(e,"GridCellLayer",(function(){return xc})),n.d(e,"HexagonLayer",(function(){return ul})),n.d(e,"HexagonCellLayer",(function(){return Xc})),n.d(e,"PathLayer",(function(){return Il})),n.d(e,"PolygonLayer",(function(){return vf})),n.d(e,"GeoJsonLayer",(function(){return Af})),n.d(e,"TextLayer",(function(){return rh})),n.d(e,"default",(function(){return bh})),n.d(e,"DeckGL",(function(){return bh})),n.d(e,"experimental",(function(){return _h}));var r=n(75),i=new(n(553).a)({id:"deck"}).enable();if(r.a.deck&&"6.4.10"!==r.a.deck.VERSION)throw new Error("deck.gl - multiple versions detected: ".concat(r.a.deck.VERSION," vs ").concat("6.4.10"));r.a.deck||(i.log(0,"deck.gl ".concat("6.4.10"," - ").concat("set deck.log.priority=1 (or higher) to trace attribute updates"))(),r.a.deck=r.a.deck||{VERSION:"6.4.10",version:"6.4.10",log:i}),console.table||(console.table=function(){});var o=n(5),a={LNG_LAT:1,LNGLAT_AUTO_OFFSET:4,METER_OFFSETS:2,LNGLAT_OFFSETS:3,IDENTITY:0},s=Object.keys(a).map((function(t){return"const float COORDINATE_SYSTEM_".concat(t," = ").concat(a[t],".;")})).join(""),u="".concat(s,'\n\nuniform float project_uCoordinateSystem;\nuniform float project_uScale;\nuniform bool project_uWrapLongitude;\nuniform float project_uAntimeridian;\nuniform vec3 project_uPixelsPerMeter;\nuniform vec3 project_uPixelsPerDegree;\nuniform vec3 project_uPixelsPerUnit;\nuniform vec3 project_uPixelsPerUnit2;\nuniform vec4 project_uCenter;\nuniform mat4 project_uModelMatrix;\nuniform mat4 project_uViewProjectionMatrix;\nuniform vec2 project_uViewportSize;\nuniform float project_uDevicePixelRatio;\nuniform float project_uFocalDistance;\nuniform vec3 project_uCameraPosition;\nuniform vec2 project_coordinate_origin;\n\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / (PI * 2.0);\nconst vec2 ZERO_64_XY_LOW = vec2(0.0, 0.0);\n\n//\n// Scaling offsets - scales meters to "pixels"\n// Note the scalar version of project_scale is for scaling the z component only\n//\nfloat project_scale(float meters) {\n  return meters * project_uPixelsPerMeter.z;\n}\n\nvec2 project_scale(vec2 meters) {\n  return meters * project_uPixelsPerMeter.xy;\n}\n\nvec3 project_scale(vec3 meters) {\n  return meters * project_uPixelsPerMeter;\n}\n\nvec4 project_scale(vec4 meters) {\n  return vec4(meters.xyz * project_uPixelsPerMeter, meters.w);\n}\n\n//\n// Projecting normal - transform deltas from current coordinate system to\n// normals in the worldspace\n//\nvec3 project_normal(vec3 vector) {\n  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNG_LAT ||\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {\n    return normalize(vector * project_uPixelsPerDegree);\n  }\n  // Apply model matrix\n  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);\n  return normalize(normal_modelspace.xyz * project_uPixelsPerMeter);\n}\n\nvec4 project_offset_(vec4 offset) {\n  float dy = offset.y;\n  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_AUTO_OFFSET) {\n    dy = clamp(dy, -1., 1.);\n  }\n  vec3 pixelsPerUnit = project_uPixelsPerUnit + project_uPixelsPerUnit2 * dy;\n  return vec4(offset.xyz * pixelsPerUnit, offset.w);\n}\n\n//\n// Projecting positions - non-linear projection: lnglats => unit tile [0-1, 0-1]\n//\nvec2 project_mercator_(vec2 lnglat) {\n  float x = lnglat.x;\n  if (project_uWrapLongitude) {\n    x = mod(x - project_uAntimeridian, 360.0) + project_uAntimeridian;\n  }\n  return vec2(\n    radians(x) + PI,\n    PI - log(tan_fp32(PI * 0.25 + radians(lnglat.y) * 0.5))\n  );\n}\n\n//\n// Projects lnglats (or meter offsets, depending on mode) to pixels\n//\nvec4 project_position(vec4 position, vec2 position64xyLow) {\n  // TODO - why not simply subtract center and fall through?\n  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNG_LAT) {\n    return project_uModelMatrix * vec4(\n      project_mercator_(position.xy) * WORLD_SCALE * project_uScale,\n      project_scale(position.z),\n      position.w\n    );\n  }\n\n  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_AUTO_OFFSET) {\n    // Subtract high part of 64 bit value. Convert remainder to float32, preserving precision.\n    float X = position.x - project_coordinate_origin.x;\n    float Y = position.y - project_coordinate_origin.y;\n    return project_offset_(vec4(X + position64xyLow.x, Y + position64xyLow.y, position.z, position.w));\n  }\n\n  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {\n    return project_offset_(position);\n  }\n\n  // METER_OFFSETS or IDENTITY\n  // Apply model matrix\n  vec4 position_modelspace = project_uModelMatrix * position;\n  return project_offset_(position_modelspace);\n}\n\nvec4 project_position(vec4 position) {\n  return project_position(position, ZERO_64_XY_LOW);\n}\n\nvec3 project_position(vec3 position, vec2 position64xyLow) {\n  vec4 projected_position = project_position(vec4(position, 1.0), position64xyLow);\n  return projected_position.xyz;\n}\n\nvec3 project_position(vec3 position) {\n  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_XY_LOW);\n  return projected_position.xyz;\n}\n\nvec2 project_position(vec2 position) {\n  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_XY_LOW);\n  return projected_position.xy;\n}\n\n//\n// Projects from "world" coordinates to clip space.\n// Uses project_uViewProjectionMatrix\n//\nvec4 project_to_clipspace(vec4 position) {\n  if (project_uCoordinateSystem == COORDINATE_SYSTEM_METER_OFFSETS ||\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {\n    // Needs to be divided with project_uPixelsPerMeter\n    position.w *= project_uPixelsPerMeter.z;\n  }\n  return project_uViewProjectionMatrix * position + project_uCenter;\n}\n\n// Returns a clip space offset that corresponds to a given number of **non-device** pixels\nvec4 project_pixel_to_clipspace(vec2 pixels) {\n  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;\n  return vec4(offset * project_uFocalDistance, 0.0, 0.0);\n}\n'),c=n(12),l=n(44),f={LNGLAT:1,LNGLAT_EXPERIMENTAL:1,LNGLAT_DEPRECATED:5,METER_OFFSETS:2,METERS:2,LNGLAT_OFFSETS:3,IDENTITY:0},h={panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}};function d(t,e){if(t===e)return!0;if(Array.isArray(t)){var n=t.length;if(!e||e.length!==n)return!1;for(var r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}function p(t){var e,n={};return function(r){for(var i in r)if(!d(r[i],n[i])){e=t(r),n=r;break}return e}}function g(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}var v=[0,0,0,0],y=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],m=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],b=[0,0,0],_=[0,0,0],x=p((function(t){var e=t.viewport,n=t.devicePixelRatio,r=t.coordinateSystem,i=t.coordinateOrigin,o=t.wrapLongitude,s=e.zoom,u=function(t){var e,n=t.viewport,r=t.coordinateSystem,i=t.coordinateOrigin,o=t.coordinateZoom,s=n.viewMatrixUncentered,u=n.viewMatrix,h=n.projectionMatrix,d=n.viewProjectionMatrix,p=function(t){switch(t){case f.LNGLAT:case f.LNGLAT_EXPERIMENTAL:default:return a.LNGLAT_AUTO_OFFSET;case f.LNGLAT_DEPRECATED:return a.LNG_LAT;case f.METER_OFFSETS:case f.METERS:return a.METER_OFFSETS;case f.LNGLAT_OFFSETS:return a.LNGLAT_OFFSETS;case f.IDENTITY:return a.IDENTITY}}(r),g=i;if(p===a.LNGLAT_AUTO_OFFSET)if(o<12)p=a.LNG_LAT;else{var m=Math.fround(n.longitude),b=Math.fround(n.latitude);g=[m,b]}switch(p){case a.IDENTITY:case a.LNG_LAT:e=v;break;case a.LNGLAT_OFFSETS:case a.METER_OFFSETS:case a.LNGLAT_AUTO_OFFSET:var _=n.projectFlat(g,Math.pow(2,o));e=l.c([],[_[0],_[1],0,1],d),u=s||u,d=c.g([],h,u),d=c.g([],d,y);break;default:throw new Error("Unknown projection mode")}return{viewMatrix:u,viewProjectionMatrix:d,projectionCenter:e,cameraPos:n.cameraPosition,shaderCoordinateSystem:p,shaderCoordinateOrigin:g}}({coordinateSystem:r,coordinateOrigin:i,coordinateZoom:s,viewport:e}),h=u.projectionCenter,d=u.viewProjectionMatrix,p=u.cameraPos,m=u.shaderCoordinateSystem,_=u.shaderCoordinateOrigin;g(d,"Viewport missing modelViewProjectionMatrix");var x=e.getDistanceScales(),w=[e.width*n,e.height*n],E={project_uCoordinateSystem:m,project_uCenter:h,project_uWrapLongitude:o,project_uAntimeridian:(e.longitude||0)-180,project_uViewportSize:w,project_uDevicePixelRatio:n,project_uFocalDistance:e.focalDistance||1,project_uPixelsPerMeter:x.pixelsPerMeter,project_uPixelsPerDegree:x.pixelsPerDegree,project_uPixelsPerUnit:x.pixelsPerMeter,project_uPixelsPerUnit2:b,project_uScale:e.scale,project_uViewProjectionMatrix:d,project_uCameraPosition:p},S=e.getDistanceScales(_);switch(m){case a.METER_OFFSETS:E.project_uPixelsPerUnit=S.pixelsPerMeter,E.project_uPixelsPerUnit2=S.pixelsPerMeter2;break;case a.LNGLAT_AUTO_OFFSET:E.project_coordinate_origin=_;case a.LNGLAT_OFFSETS:E.project_uPixelsPerUnit=S.pixelsPerDegree,E.project_uPixelsPerUnit2=S.pixelsPerDegree2}return E}));function w(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.viewport,n=t.devicePixelRatio,r=void 0===n?1:n,o=t.modelMatrix,a=void 0===o?null:o,s=t.coordinateSystem,u=void 0===s?f.LNGLAT:s,c=t.coordinateOrigin,l=void 0===c?_:c,h=t.wrapLongitude,d=void 0!==h&&h,p=t.projectionMode,v=t.positionOrigin;return g(e),void 0!==p&&i.removed("projectionMode","coordinateSystem")(),void 0!==v&&i.removed("positionOrigin","coordinateOrigin")(),Object.assign({project_uModelMatrix:a||m},x({viewport:e,devicePixelRatio:r,coordinateSystem:u,coordinateOrigin:l,wrapLongitude:d}))}var E={};var S={name:"project",dependencies:[o.fp32],vs:u,getUniforms:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E;return t.viewport?w(t):{}},deprecations:[{type:"uniform vec3",old:"selectedPickingColor",new:"luma.gl's picking module"},{type:"uniform float",old:"renderPickingBuffer",new:"luma.gl's picking module"},{type:"uniform float",old:"pickingEnabled",new:"luma.gl's picking module"},{type:"uniform float",old:"projectionMode",new:"project_uCoordinateSystem"},{type:"uniform vec4",old:"projectionCenter",new:"project_uCenter"},{type:"uniform vec2",old:"projectionOrigin"},{type:"uniform mat4",old:"modelMatrix",new:"project_uModelMatrix"},{type:"uniform mat4",old:"viewMatrix"},{type:"uniform mat4",old:"projectionMatrix",new:"project_uViewProjectionMatrix"},{type:"uniform vec3",old:"projectionPixelsPerUnit",new:"project_uPixelsPerUnit"},{type:"uniform float",old:"projectionScale",new:"project_uScale"},{type:"uniform vec2",old:"viewportSize",new:"project_uViewportSize"},{type:"uniform float",old:"devicePixelRatio",new:"project_uDevicePixelRatio"},{type:"uniform vec3",old:"cameraPos",new:"project_uCameraPosition"},{type:"function",old:"scale",new:"project_scale"},{type:"function",old:"preproject",new:"project_position"},{type:"function",old:"project",new:"project_to_clipspace"}]},O={name:"project32",dependencies:[S],vs:"\nvec4 project_position_to_clipspace(\n  vec3 position, vec2 position64xyLow, vec3 offset, out vec4 worldPosition\n) {\n  vec3 projectedPosition = project_position(position, position64xyLow);\n  worldPosition = vec4(projectedPosition + offset, 1.0);\n  return project_to_clipspace(worldPosition);\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec2 position64xyLow, vec3 offset\n) {\n  vec4 worldPosition;\n  return project_position_to_clipspace(position, position64xyLow, offset, worldPosition);\n}\n"},P=o.fp64.fp64ify,C=o.fp64.fp64ifyMatrix4,M={name:"project64",dependencies:[S,o.fp64],vs:"\nconst vec2 WORLD_SCALE_FP64 = vec2(81.4873275756836, 0.0000032873668232014097);\n\nuniform vec2 project64_uScale;\nuniform vec2 project_uViewProjectionMatrixFP64[16];\n\n// longitude: lnglat_fp64.xy; latitude: lnglat_fp64.zw\nvoid mercatorProject_fp64(vec4 lnglat_fp64, out vec2 out_val[2]) {\n\n#if defined(NVIDIA_FP64_WORKAROUND)\n  out_val[0] = sum_fp64(radians_fp64(lnglat_fp64.xy), PI_FP64 * ONE);\n#else\n  out_val[0] = sum_fp64(radians_fp64(lnglat_fp64.xy), PI_FP64);\n#endif\n  out_val[1] = sub_fp64(PI_FP64,\n    log_fp64(tan_fp64(sum_fp64(PI_4_FP64, radians_fp64(lnglat_fp64.zw) / 2.0))));\n  return;\n}\n\nvoid project_position_fp64(vec4 position_fp64, out vec2 out_val[2]) {\n  vec2 pos_fp64[2];\n  mercatorProject_fp64(position_fp64, pos_fp64);\n  vec2 x_fp64 = mul_fp64(pos_fp64[0], project64_uScale);\n  vec2 y_fp64 = mul_fp64(pos_fp64[1], project64_uScale);\n  out_val[0] = mul_fp64(x_fp64, WORLD_SCALE_FP64);\n  out_val[1] = mul_fp64(y_fp64, WORLD_SCALE_FP64);\n\n  return;\n}\n\nvoid project_position_fp64(vec2 position, vec2 position64xyLow, out vec2 out_val[2]) {\n  vec4 position64xy = vec4(\n    position.x, position64xyLow.x,\n    position.y, position64xyLow.y);\n\n  project_position_fp64(position64xy, out_val);\n}\n\nvec4 project_to_clipspace_fp64(vec2 vertex_pos_modelspace[4]) {\n  vec2 vertex_pos_clipspace[4];\n  mat4_vec4_mul_fp64(project_uViewProjectionMatrixFP64, vertex_pos_modelspace,\n    vertex_pos_clipspace);\n  return vec4(\n    vertex_pos_clipspace[0].x,\n    vertex_pos_clipspace[1].x,\n    vertex_pos_clipspace[2].x,\n    vertex_pos_clipspace[3].x\n    );\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec2 position64xyLow, vec3 offset, out vec4 worldPosition\n) {\n  // This is the local offset to the instance position\n  vec2 offset64[4];\n  vec4_fp64(vec4(offset, 0.0), offset64);\n\n  float z = project_scale(position.z);\n\n  // Apply web mercator projection (depends on coordinate system imn use)\n  vec2 projectedPosition64xy[2];\n  project_position_fp64(position.xy, position64xyLow, projectedPosition64xy);\n\n  vec2 worldPosition64[4];\n  worldPosition64[0] = sum_fp64(offset64[0], projectedPosition64xy[0]);\n  worldPosition64[1] = sum_fp64(offset64[1], projectedPosition64xy[1]);\n  worldPosition64[2] = sum_fp64(offset64[2], vec2(z, 0.0));\n  worldPosition64[3] = vec2(1.0, 0.0);\n\n  worldPosition = vec4(projectedPosition64xy[0].x, projectedPosition64xy[1].x, z, 1.0);\n\n  return project_to_clipspace_fp64(worldPosition64);\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec2 position64xyLow, vec3 offset\n) {\n  vec4 worldPosition;\n  return project_position_to_clipspace(\n    position, position64xyLow, offset, worldPosition\n  );\n}\n",getUniforms:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=t.project_uViewProjectionMatrix,n=t.project_uScale;if(e&&n)return I({project_uViewProjectionMatrix:e,project_uScale:n});return{}},deprecations:[{type:"uniform vec2",old:"projectionFP64[16]",new:"project_uViewProjectionMatrixFP64"},{type:"uniform vec2",old:"projectionScaleFP64",new:"project64_uScale"}]},I=p((function(t){var e=t.project_uViewProjectionMatrix,n=t.project_uScale,r=C(e),i=P(n);return{project_uViewProjectionMatrixFP64:r,project64_uViewProjectionMatrix:r,project64_uScale:i}}));var A=n(49),T=n(13);function N(t,e){var n=l.c([],e,t);return l.b(n,n,1/n[3]),n}function L(t,e){var n=t%e;return n<0?e+n:n}function R(t,e,n){return n*e+(1-n)*t}var k=n(30);function j(t,e){if(!t)throw new Error(e||"viewport-mercator-project: assertion failed.")}var F=Math.PI,D=F/4,B=F/180,z=180/F;function V(t){return Math.pow(2,t)}function G(t){return Math.log2(t)}function U(t,e){var n=Object(T.a)(t,2),r=n[0],i=n[1];j(Number.isFinite(r)&&Number.isFinite(e)),j(Number.isFinite(i)&&i>=-90&&i<=90,"invalid latitude");var o=i*B;return[(e*=512)*(r*B+F)/(2*F),e*(F-Math.log(Math.tan(D+.5*o)))/(2*F)]}function W(t,e){var n=Object(T.a)(t,2),r=n[0],i=n[1],o=r/(e*=512)*(2*F)-F,a=2*(Math.atan(Math.exp(F-i/e*(2*F)))-D);return[o*z,a*z]}function q(t){var e=t.latitude,n=t.longitude,r=t.zoom,i=t.scale,o=t.highPrecision,a=void 0!==o&&o;i=void 0!==i?i:V(r),j(Number.isFinite(e)&&Number.isFinite(n)&&Number.isFinite(i));var s={},u=512*i,c=Math.cos(e*B),l=u/360,f=l/c,h=u/4003e4/c;if(s.pixelsPerMeter=[h,-h,h],s.metersPerPixel=[1/h,-1/h,1/h],s.pixelsPerDegree=[l,-f,h],s.degreesPerPixel=[1/l,-1/f,1/h],a){var d=B*Math.tan(e*B)/c,p=l*d/2,g=u/4003e4*d,v=g/f*h;s.pixelsPerDegree2=[0,-p,g],s.pixelsPerMeter2=[v,0,v]}return s}function X(t,e){var n=Object(T.a)(t,3),r=n[0],i=n[1],o=n[2],a=Object(T.a)(e,3),s=a[0],u=a[1],c=a[2],l=q({longitude:r,latitude:i,scale:1,highPrecision:!0}),f=l.pixelsPerMeter,h=l.pixelsPerMeter2,d=U(t,1);d[0]+=s*(f[0]+h[0]*u),d[1]+=u*(f[1]+h[1]*u);var p=W(d,1),g=(o||0)+(c||0);return Number.isFinite(o)||Number.isFinite(c)?[p[0],p[1],g]:p}function H(t){var e=t.height,n=t.pitch,r=t.bearing,i=t.altitude,o=t.center,a=void 0===o?null:o,s=t.flipY,u=void 0!==s&&s,l=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return c.o(l,l,[0,0,-i]),c.n(l,l,[1,1,1/e]),c.k(l,l,-n*B),c.m(l,l,r*B),u&&c.n(l,l,[1,-1,1]),a&&c.o(l,l,A.d([],a)),l}function Y(t){var e=t.width,n=t.height,r=t.altitude,i=void 0===r?1.5:r,o=t.pitch,a=void 0===o?0:o,s=t.nearZMultiplier,u=void 0===s?1:s,c=t.farZMultiplier,l=void 0===c?1:c,f=a*B,h=Math.atan(.5/i),d=Math.sin(h)*i/Math.sin(Math.PI/2-f-h),p=Math.cos(Math.PI/2-f)*d+i;return{fov:2*Math.atan(n/2/i),aspect:e/n,focalDistance:i,near:u,far:p*l}}function Z(t){var e=t.width,n=t.height,r=t.pitch,i=Y({width:e,height:n,altitude:t.altitude,pitch:r,nearZMultiplier:t.nearZMultiplier,farZMultiplier:t.farZMultiplier}),o=i.fov,a=i.aspect,s=i.near,u=i.far;return c.i([],o,a,s,u)}function K(t,e){var n=Object(T.a)(t,3),r=n[0],i=n[1],o=n[2],a=void 0===o?0:o;return j(Number.isFinite(r)&&Number.isFinite(i)&&Number.isFinite(a)),N(e,[r,i,a,1])}function J(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=Object(T.a)(t,3),i=r[0],o=r[1],a=r[2];if(j(Number.isFinite(i)&&Number.isFinite(o),"invalid pixel coordinate"),Number.isFinite(a)){var s=N(e,[i,o,a,1]);return s}var u=N(e,[i,o,0,1]),c=N(e,[i,o,1,1]),l=u[2],f=c[2],h=l===f?0:((n||0)-l)/(f-l);return k.d([],u,c,h)}function Q(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function $(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=Q(t,3),i=r[0],o=r[1],a=r[2],s=void 0===a?0:a,u=e.projectFlat(t),c=Q(u,2),l=c[0],f=c[1],h=n?q({longitude:i,latitude:o,scale:e.scale}):e.getDistanceScales(),d=s*h.pixelsPerMeter[2];return[l,f,d]}function tt(t,e){var n=e.viewport,r=e.modelMatrix,i=e.coordinateSystem,o=e.coordinateOrigin,a=e.offsetMode,s=Q(t,3),u=s[0],c=s[1],h=s[2];if(r){var d=Q(l.c([],[u,c,h,1],r),3);u=d[0],c=d[1],h=d[2]}switch(i){case f.LNGLAT:case f.LNGLAT_DEPRECATED:return $([u,c,h],n,a);case f.LNGLAT_OFFSETS:return $([u+o[0],c+o[1],h+(o[2]||0)],n,a);case f.METER_OFFSETS:return $(X(o,[u,c,h]),n,a);case f.IDENTITY:default:return[u,c,h]}}function et(t,e){var n=function(t){var e=Object.assign({},t),n=t.viewport,r=t.coordinateSystem,i=t.coordinateOrigin,o=t.fromCoordinateSystem,a=t.fromCoordinateOrigin;return void 0===o&&(e.fromCoordinateSystem=r),void 0===a&&(e.fromCoordinateOrigin=i),r===f.LNGLAT&&n.zoom>=12&&(e.coordinateSystem=f.LNGLAT_OFFSETS,e.coordinateOrigin=[Math.fround(n.longitude),Math.fround(n.latitude)]),e}(e),r=n.viewport,i=n.coordinateSystem,o=n.coordinateOrigin,a=n.modelMatrix,s=n.fromCoordinateSystem,u=n.fromCoordinateOrigin;switch(i){case f.LNGLAT_OFFSETS:case f.METER_OFFSETS:var c=tt(t,{viewport:r,modelMatrix:a,coordinateSystem:s,coordinateOrigin:u,offsetMode:!0}),l=$(o,r,!0);return A.h(c,c,l),c;case f.LNGLAT:case f.LNGLAT_DEPRECATED:case f.IDENTITY:default:return tt(t,{viewport:r,modelMatrix:a,coordinateSystem:s,coordinateOrigin:u,offsetMode:!1})}}var nt={name:"lighting",dependencies:[S],vs:"#define MAX_NUM_OF_LIGHTS 5\n\n// TODO these should be using lighting_ prefix\nuniform vec3 lighting_lightPositions[MAX_NUM_OF_LIGHTS];\nuniform vec2 lighting_lightStrengths[MAX_NUM_OF_LIGHTS];\nuniform float lighting_ambientRatio;\nuniform float lighting_diffuseRatio;\nuniform float lighting_specularRatio;\nuniform int lighting_numberOfLights;\n\nfloat lighting_getLightWeight(vec3 position_worldspace_vec3, vec3 normals_worldspace) {\n  float lightWeight = 0.0;\n\n  vec3 normals_worldspace_vec3 = normals_worldspace.xyz;\n\n  vec3 camera_pos_worldspace = project_uCameraPosition;\n  vec3 view_direction = normalize(camera_pos_worldspace - position_worldspace_vec3);\n\n  for (int i = 0; i < MAX_NUM_OF_LIGHTS; i++) {\n    if (i >= lighting_numberOfLights) {\n      break;\n    }\n    vec3 light_position_worldspace = lighting_lightPositions[i];\n    vec3 light_direction = normalize(light_position_worldspace - position_worldspace_vec3);\n\n    vec3 halfway_direction = normalize(light_direction + view_direction);\n    float lambertian = dot(light_direction, normals_worldspace_vec3);\n    float specular = 0.0;\n    if (lambertian > 0.0) {\n      float specular_angle = max(dot(normals_worldspace_vec3, halfway_direction), 0.0);\n      specular = pow(specular_angle, 32.0);\n    }\n    lambertian = max(lambertian, 0.0);\n    lightWeight += (lighting_ambientRatio + lambertian * lighting_diffuseRatio + specular * lighting_specularRatio) *\n      lighting_lightStrengths[i].x;\n  }\n\n  return lightWeight;\n}\n\n// DEPRECATED - Backwards compatibility\n\nfloat getLightWeight(vec3 position_worldspace_vec3, vec3 normals_worldspace) {\n  return lighting_getLightWeight(position_worldspace_vec3, normals_worldspace);\n}\n",getUniforms:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rt;if(!t.lightSettings)return{};var e=t.coordinateSystem,n=t.coordinateOrigin,r=t.lightSettings,i=r.numberOfLights,o=void 0===i?1:i,a=r.lightsPosition,s=void 0===a?it:a,u=r.lightsStrength,c=void 0===u?ot:u,l=r.coordinateSystem,f=r.coordinateOrigin,h=r.modelMatrix,d=void 0===h?null:h,p=r.ambientRatio,g=void 0===p?.4:p,v=r.diffuseRatio,y=void 0===v?.6:v,m=r.specularRatio,b=void 0===m?.8:m,_=at({lightsPosition:s,numberOfLights:o,viewport:t.viewport,modelMatrix:d,coordinateSystem:e,coordinateOrigin:n,fromCoordinateSystem:l,fromCoordinateOrigin:f});return{lighting_lightPositions:_,lighting_lightStrengths:c,lighting_ambientRatio:g,lighting_diffuseRatio:y,lighting_specularRatio:b,lighting_numberOfLights:o}},deprecations:[{type:"function",old:"getLightWeight",new:"lighting_getLightWeight",deprecated:!0}]},rt={},it=[-122.45,37.75,8e3],ot=[2,0],at=p((function(t){for(var e=t.lightsPosition,n=t.numberOfLights,r=t.viewport,i=t.modelMatrix,o=t.coordinateSystem,a=t.coordinateOrigin,s=t.fromCoordinateSystem,u=t.fromCoordinateOrigin,c={viewport:r,modelMatrix:i,coordinateSystem:o,coordinateOrigin:a,fromCoordinateSystem:s,fromCoordinateOrigin:u},l=[],f=0;f<n;f++){var h=et(e.slice(3*f,3*f+3),c);l[3*f]=h[0],l[3*f+1]=h[1],l[3*f+2]=h[2]}return l}));Object(o.registerShaderModules)([o.fp32,o.fp64,S,O,M,nt,o.picking]),Object(o.setDefaultShaderModules)([S]);var st=n(25),ut=n.n(st),ct=n(7),lt=n.n(ct);function ft(t){return(ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ht(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function dt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function pt(t,e){return!e||"object"!==ft(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function gt(t){return(gt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function vt(t,e){return(vt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var yt={isExternalBuffer:!1,needsUpdate:!0,needsRedraw:!1,allocedInstances:-1},mt=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};ht(this,e),n=pt(this,gt(e).call(this,t,r));var i=r.transition,o=void 0!==i&&i,a=r.noAlloc,s=void 0!==a&&a,u=r.update,c=void 0===u?null:u,l=r.accessor,f=void 0===l?null:l,h=r.bufferLayout,d=void 0===h?null:h,p=r.defaultValue,g=void 0===p?[0,0,0,0]:p;return g=Array.isArray(g)?g:[g],Object.assign(n.userData,yt,r,{transition:o,noAlloc:s,update:c,accessor:f,defaultValue:g,bufferLayout:d}),Object.seal(n.userData),n._validateAttributeUpdaters(),n}var n,r,a;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&vt(t,e)}(e,t),n=e,(r=[{key:"needsUpdate",value:function(){return this.userData.needsUpdate}},{key:"needsRedraw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.clearChangedFlags,n=void 0!==e&&e,r=this.userData.needsRedraw;return this.userData.needsRedraw=this.userData.needsRedraw&&!n,r}},{key:"getInstanceCount",value:function(){return null!==this.value?this.value.length/this.size:0}},{key:"getUpdateTriggers",value:function(){var t=this.userData.accessor;return[this.id].concat(t||[])}},{key:"getAccessor",value:function(){return this.userData.accessor}},{key:"supportsTransition",value:function(){return this.userData.transition}},{key:"getTransitionSetting",value:function(t){var e=this.userData,n=e.transition,r=e.accessor;if(!n)return null;var i=Array.isArray(r)?t[r.find((function(e){return t[e]}))]:t[r];return Number.isFinite(i)&&(i={duration:i}),i&&i.duration>0?Object.assign({},n,i):null}},{key:"setNeedsUpdate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.id;this.userData.needsUpdate=this.userData.needsUpdate||t}},{key:"setNeedsRedraw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.id;this.userData.needsRedraw=this.userData.needsRedraw||t}},{key:"allocate",value:function(t){var e=this.userData;if(e.isExternalBuffer||e.noAlloc)return!1;var n=this.getInstanceCount();if((0===n||n<t)&&(e.update||e.accessor)){g(Number.isFinite(t));var r=Math.max(t,1),i=bt(this.type||lt.a.FLOAT);return this.constant=!1,this.value=new i(this.size*r),e.needsUpdate=!0,e.allocedInstances=r,!0}return!1}},{key:"updateBuffer",value:function(t){var e=t.numInstances,n=t.data,r=t.props,i=t.context;if(!this.needsUpdate())return!1;var o=this.userData,a=o.update,s=o.accessor,u=!0;return a?(a.call(i,this,{data:n,props:r,numInstances:e}),this.update({value:this.value,constant:this.constant}),this._checkAttributeArray()):s?(this._updateBufferViaStandardAccessor(n,r),this._checkAttributeArray()):u=!1,o.needsUpdate=!1,o.needsRedraw=!0,u}},{key:"setGenericValue",value:function(t){var e=this.userData;if(void 0===t||"function"==typeof t)return e.isExternalBuffer=!1,!1;t=this._normalizeValue(t);var n=!this.constant||!this._areValuesEqual(t,this.value);return n&&this.update({constant:!0,value:t}),e.needsRedraw=e.needsUpdate||n,e.needsUpdate=!1,e.isExternalBuffer=!0,!0}},{key:"setExternalBuffer",value:function(t,e){var n=this.userData;if(t){if(n.isExternalBuffer=!0,n.needsUpdate=!1,t instanceof o.Buffer)this.externalBuffer!==t&&(this.update({constant:!1,buffer:t}),n.needsRedraw=!0);else if(this.value!==t){if(!ArrayBuffer.isView(t))throw new Error("Attribute prop must be typed array");if(n.auto&&t.length<=e*this.size)throw new Error("Attribute prop array must match length and size");var r=bt(this.type||lt.a.FLOAT);t instanceof r?this.update({constant:!1,value:t}):(i.warn("Attribute prop ".concat(this.id," is casted to ").concat(r.name))(),this.update({constant:!1,value:new r(t)})),this.value=t,n.needsRedraw=!0}return!0}return n.isExternalBuffer=!1,!1}},{key:"_normalizeValue",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=this.userData.defaultValue;if(!Array.isArray(t)&&!ArrayBuffer.isView(t))return e[n]=Number.isFinite(t)?t:r[0],e;switch(this.size){case 4:e[n+3]=Number.isFinite(t[3])?t[3]:r[3];case 3:e[n+2]=Number.isFinite(t[2])?t[2]:r[2];case 2:e[n+1]=Number.isFinite(t[1])?t[1]:r[1];case 1:e[n+0]=Number.isFinite(t[0])?t[0]:r[0]}return e}},{key:"_areValuesEqual",value:function(t,e){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.size,r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}},{key:"_updateBufferViaStandardAccessor",value:function(t,e){var n=this.userData.accessor,r=this.value,i=this.size,o=e[n];g("function"==typeof o,'accessor "'.concat(n,'" is not a function'));var a=0,s=!0,u=!1,c=void 0;try{for(var l,f=t[Symbol.iterator]();!(s=(l=f.next()).done);s=!0){var h=o(l.value);this._normalizeValue(h,r,a),a+=i}}catch(t){u=!0,c=t}finally{try{s||null==f.return||f.return()}finally{if(u)throw c}}this.update({value:r})}},{key:"_validateAttributeUpdaters",value:function(){var t=this.userData;if(!t.noAlloc&&"function"!=typeof t.update&&"string"!=typeof t.accessor)throw new Error("Attribute ".concat(this.id," missing update or accessor"))}},{key:"_checkAttributeArray",value:function(){var t=this.value;if(t&&t.length>=4&&!(Number.isFinite(t[0])&&Number.isFinite(t[1])&&Number.isFinite(t[2])&&Number.isFinite(t[3])))throw new Error("Illegal attribute generated for ".concat(this.id))}},{key:"bufferLayout",get:function(){return this.userData.bufferLayout},set:function(t){this.userData.bufferLayout=t}}])&&dt(n.prototype,r),a&&dt(n,a),e}(o._Attribute);function bt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.clamped,r=void 0===n||n;switch(t){case lt.a.FLOAT:return Float32Array;case lt.a.UNSIGNED_SHORT:case lt.a.UNSIGNED_SHORT_5_6_5:case lt.a.UNSIGNED_SHORT_4_4_4_4:case lt.a.UNSIGNED_SHORT_5_5_5_1:return Uint16Array;case lt.a.UNSIGNED_INT:return Uint32Array;case lt.a.UNSIGNED_BYTE:return r?Uint8ClampedArray:Uint8Array;case lt.a.BYTE:return Int8Array;case lt.a.SHORT:return Int16Array;case lt.a.INT:return Int32Array;default:throw new Error("Failed to deduce type from array")}}function _t(t){var e=t.source,n=t.target,r=t.start,i=void 0===r?0:r,o=t.end,a=t.getData;o=o||n.length;var s=e.length,u=o-i;if(s>u)n.set(e.subarray(0,u),i);else if(n.set(e,i),a)for(var c=s;c<u;)for(var l=a(c,e),f=0;f<l.length;f++)n[i+c]=l[f],c++}var xt={1:"float",2:"vec2",3:"vec3",4:"vec4"};function wt(t){var e={},n={};for(var r in t){var i=t[r],o=i.fromState,a=i.toState,s=i.buffer;e["".concat(r,"From")]=o,e["".concat(r,"To")]=a,n["".concat(r)]=s}return{sourceBuffers:e,feedbackBuffers:n}}function Et(t){var e=t.fromState,n=t.toState,r=t.fromLength,i=t.toLength,a=t.fromBufferLayout,s=t.toBufferLayout,u=t.getData,c=void 0===u?function(t){return t}:u;if((a&&s||!(r>=i))&&e instanceof o.Buffer){var l=new Float32Array(i),f=e.getData({}),h=n.value,d=n.buffer,p=n.size,g=n.constant,v=h||d.getData({}),y=g?function(t,e){return c(h,e)}:function(t,e){return c(v.subarray(t,t+p),e)};!function(t){var e=t.source,n=t.target,r=t.size,i=t.getData,o=t.sourceLayout,a=t.targetLayout;if(!Array.isArray(a))return _t({source:e,target:n,getData:i}),n;for(var s=0,u=0,c=i&&function(t,e){return i(t+u,e)},l=Math.min(o.length,a.length),f=0;f<l;f++){var h=o[f]*r,d=a[f]*r;_t({source:e.subarray(s,s+h),target:n,start:u,end:u+d,getData:c}),s+=h,u+=d}u<n.length&&_t({source:[],target:n,start:u,getData:c})}({source:f,target:l,sourceLayout:a,targetLayout:s,size:n.size,getData:y}),e.setData({data:l})}}function St(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ot="none",Pt="pending",Ct="in_progress",Mt="ended";function It(){}var At=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._startTime=null,this._state=Ot,this.duration=1,this.easing=function(t){return t},this.onStart=It,this.onUpdate=It,this.onInterrupt=It,this.onEnd=It,Object.assign(this,e)}var e,n,r;return e=t,(n=[{key:"start",value:function(t){this.inProgress&&this.onInterrupt(this),Object.assign(this,t),this._setState(Pt)}},{key:"cancel",value:function(){this.inProgress&&(this.onInterrupt(this),this._setState(Ot))}},{key:"update",value:function(t){if(this.state===Pt&&(this._startTime=t,this._setState(Ct)),this.state===Ct){var e=!1,n=(t-this._startTime)/this.duration;return n>=1&&(n=1,e=!0),this.time=this.easing(n),this.onUpdate(this),e&&this._setState(Mt),!0}return!1}},{key:"_setState",value:function(t){if(this._state!==t)switch(this._state=t,t){case Pt:this.onStart(this);break;case Mt:this.onEnd(this)}}},{key:"state",get:function(){return this._state}},{key:"inProgress",get:function(){return this._state===Pt||this._state===Ct}}])&&St(e.prototype,n),r&&St(e,r),t}();function Tt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Nt=function(){},Lt={duration:0,easing:function(t){return t},onStart:Nt,onEnd:Nt,onInterrupt:Nt},Rt=function(){function t(e,n){var r=n.id;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=r,this.gl=e,this.attributeTransitions={},this.needsRedraw=!1,this.transform=null,this.numInstances=0,o.Transform.isSupported(e)?this.isSupported=!0:e&&i.warn("WebGL2 not supported by this browser. Transition animation is disabled.")()}var e,n,r;return e=t,(n=[{key:"finalize",value:function(){for(var t in this.transform&&this.transform.delete(),this.attributeTransitions)this._removeTransition(t)}},{key:"update",value:function(t){var e=t.attributes,n=t.transitions,r=void 0===n?{}:n,i=t.numInstances;if(this.opts=r,this.numInstances=i||1,this.isSupported){var o=this.attributeTransitions,a={};for(var s in e)this._updateAttribute(s,e[s])&&(a[s]=o[s]);for(var u in o){var c=e[u];c&&c.supportsTransition()||this._removeTransition(u)}if(this.transform){if(this.transform){var l=wt(a),f=l.sourceBuffers,h=l.feedbackBuffers;this.transform.update({elementCount:this.numInstances,sourceBuffers:f,feedbackBuffers:h})}}else this._createModel()}}},{key:"hasAttribute",value:function(t){return t in this.attributeTransitions}},{key:"getAttributes",value:function(){var t={};for(var e in this.attributeTransitions){var n=this.attributeTransitions[e];n.buffer&&(t[e]=n.attributeInTransition)}return t}},{key:"setCurrentTime",value:function(t){if(!this.transform||0===this.numInstances)return!1;var e={},n=this.needsRedraw;for(var r in this.needsRedraw=!1,this.attributeTransitions){var i=this.attributeTransitions[r];i.update(t)&&(e["".concat(r,"Time")]=i.time,n=!0)}return n&&this.transform.run({uniforms:e}),n}},{key:"_createTransition",value:function(t,e){var n=this.attributeTransitions[t];return n?null:(n=new At({name:t,attribute:e,attributeInTransition:new mt(this.gl,e),bufferLayout:e.bufferLayout}),this.attributeTransitions[t]=n,this._invalidateModel(),n)}},{key:"_removeTransition",value:function(t){var e=this.attributeTransitions[t];e&&(e.buffer&&e.buffer.delete(),e._swapBuffer&&e._swapBuffer.delete(),delete this.attributeTransitions[t],this._invalidateModel())}},{key:"_updateAttribute",value:function(t,e){var n=e.getTransitionSetting(this.opts);if(n){var r,i=this.attributeTransitions[t];if(i?r=e.needsRedraw():(i=this._createTransition(t,e),r=!0),r)return this._triggerTransition(i,n),!0}return!1}},{key:"_invalidateModel",value:function(){this.transform&&(this.transform.delete(),this.transform=null)}},{key:"_createModel",value:function(){0!==Object.keys(this.attributeTransitions).length&&(this.transform=new o.Transform(this.gl,Object.assign({elementCount:this.numInstances},wt(this.attributeTransitions),function(t){var e=[],n=[],r=[],i=[],o=[];for(var a in t){var s=t[a],u=xt[s.attribute.size];u&&(s.bufferIndex=e.length,e.push(a),n.push("attribute ".concat(u," ").concat(a,"From;")),n.push("attribute ".concat(u," ").concat(a,"To;")),r.push("uniform float ".concat(a,"Time;")),i.push("varying ".concat(u," ").concat(a,";")),o.push("".concat(a," = mix(").concat(a,"From, ").concat(a,"To,\n        ").concat(a,"Time);")))}return{vs:"\n#define SHADER_NAME feedback-vertex-shader\n".concat(n.join("\n"),"\n").concat(r.join("\n"),"\n").concat(i.join("\n"),"\n\nvoid main(void) {\n  ").concat(o.join("\n"),"\n  gl_Position = vec4(0.0);\n}\n"),fs:"#define SHADER_NAME feedback-fragment-shader\n\nprecision highp float;\n\n".concat(i.join("\n"),"\n\nvoid main(void) {\n  gl_FragColor = vec4(0.0);\n}\n"),varyings:e}}(this.attributeTransitions))))}},{key:"_getNextTransitionStates",value:function(t,e){var n,r=t.attribute,i=r.size;n=r.constant?{constant:!0,value:r.value,size:i}:{constant:!1,buffer:r.getBuffer(),size:i,value:r.externalBuffer?null:r.value};var a=t.buffer||n,s=this.numInstances*i,u=a instanceof o.Buffer&&a.getElementCount()||s,c=t._swapBuffer;return t._swapBuffer=t.buffer,c?c.getElementCount()<s&&c.setData({data:new Float32Array(s)}):c=new o.Buffer(this.gl,{data:new Float32Array(s),usage:lt.a.DYNAMIC_COPY}),t.attributeInTransition.update({buffer:c}),Et({fromState:a,toState:n,fromLength:u,toLength:s,fromBufferLayout:t.bufferLayout,toBufferLayout:r.bufferLayout,getData:e.enter}),t.bufferLayout=r.bufferLayout,{fromState:a,toState:n,buffer:c}}},{key:"_triggerTransition",value:function(t,e){g(e&&e.duration>0),this.needsRedraw=!0;var n=Object.assign({},Lt,e);t.start(Object.assign({},this._getNextTransitionStates(t,e),n))}}])&&Tt(e.prototype,n),r&&Tt(e,r),t}();function kt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function jt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ft(t,e,n){return e&&jt(t.prototype,e),n&&jt(t,n),t}function Dt(){}var Bt={savedMessages:null,timeStart:null,onLog:function(t){var e=t.level,n=t.message;i.log(e,n)()},onUpdateStart:function(t){t.level,t.numInstances;Bt.savedMessages=[],Bt.timeStart=new Date},onUpdate:function(t){t.level;var e=t.message;Bt.savedMessages&&Bt.savedMessages.push(e)},onUpdateEnd:function(t){var e=t.level,n=t.id,r=t.numInstances,o=Math.round(new Date-Bt.timeStart),a="".concat(o,"ms");i.group(e,"Updated attributes for ".concat(r," instances in ").concat(n," in ").concat(a),{collapsed:!0})();var s=!0,u=!1,c=void 0;try{for(var l,f=Bt.savedMessages[Symbol.iterator]();!(s=(l=f.next()).done);s=!0){var h=l.value;i.log(e,h)()}}catch(t){u=!0,c=t}finally{try{s||null==f.return||f.return()}finally{if(u)throw c}}i.groupEnd(e,"Updated attributes for ".concat(r," instances in ").concat(n," in ").concat(a))(),Bt.savedMessages=null}},zt=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.id,i=void 0===r?"attribute-manager":r,o=n.stats;kt(this,t),this.id=i,this.gl=e,this.attributes={},this.updateTriggers={},this.accessors={},this.needsRedraw=!0,this.userData={},this.stats=o,this.attributeTransitionManager=new Rt(e,{id:"".concat(i,"-transitions")}),Object.seal(this)}return Ft(t,null,[{key:"setDefaultLogFunctions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.onLog,n=t.onUpdateStart,r=t.onUpdate,i=t.onUpdateEnd;void 0!==e&&(Bt.onLog=e||Dt),void 0!==n&&(Bt.onUpdateStart=n||Dt),void 0!==r&&(Bt.onUpdate=r||Dt),void 0!==i&&(Bt.onUpdateEnd=i||Dt)}}]),Ft(t,[{key:"finalize",value:function(){for(var t in this.attributes)this.attributes[t].delete();this.attributeTransitionManager.finalize()}},{key:"getNeedsRedraw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.clearRedrawFlags,n=void 0!==e&&e,r=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!n,r&&this.id}},{key:"setNeedsRedraw",value:function(){!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.needsRedraw=!0,this}},{key:"add",value:function(t,e){this._add(t,e)}},{key:"addInstanced",value:function(t,e){this._add(t,e,{instanced:1})}},{key:"remove",value:function(t){for(var e=0;e<t.length;e++){var n=t[e];void 0!==this.attributes[n]&&(this.attributes[n].delete(),delete this.attributes[n])}}},{key:"invalidate",value:function(t){var e=this._invalidateTrigger(t);Bt.onLog({level:3,message:"invalidated attributes ".concat(e," (").concat(t,") for ").concat(this.id)})}},{key:"invalidateAll",value:function(){for(var t in this.attributes)this.attributes[t].setNeedsUpdate();Bt.onLog({level:3,message:"invalidated all attributes for ".concat(this.id)})}},{key:"update",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.data,n=t.numInstances,r=t.transitions,i=t.props,o=void 0===i?{}:i,a=t.buffers,s=void 0===a?{}:a,u=t.context,c=void 0===u?{}:u,l=!1;for(var f in Bt.onUpdateStart({level:2,id:this.id,numInstances:n}),this.stats&&this.stats.timeStart("attribute updates",this.id),this.attributes){var h=this.attributes[f];h.setExternalBuffer(s[f],this.numInstances)||h.setGenericValue(o[h.getAccessor()])||h.needsUpdate()&&(l=!0,this._updateAttribute({attribute:h,numInstances:n,data:e,props:o,context:c})),this.needsRedraw|=h.needsRedraw()}l&&(this.stats&&this.stats.timeEnd("attribute updates",this.id),Bt.onUpdateEnd({level:2,id:this.id,numInstances:n})),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:r})}},{key:"updateTransition",value:function(){var t=this.attributeTransitionManager.setCurrentTime(Date.now());return this.needsRedraw=this.needsRedraw||t,t}},{key:"getAttributes",value:function(){return this.attributes}},{key:"getChangedAttributes",value:function(t){t.clearChangedFlags;var e=this.attributes,n=this.attributeTransitionManager,r=Object.assign({},n.getAttributes());for(var i in e){var o=e[i];o.needsRedraw({clearChangedFlags:!0})&&(n.hasAttribute(i)||(r[i]=o))}return r}},{key:"getAccessors",value:function(){return this.updateTriggers}},{key:"_add",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e&&i.warn("AttributeManager.add({updaters}) - updater map no longer supported")();var r={};for(var o in t){var a=t[o];r[o]=new mt(this.gl,Object.assign({},a,{id:o,constant:a.constant||!1,isIndexed:a.isIndexed||a.elements,size:a.elements?1:a.size,value:a.value||null,instanced:a.instanced||n.instanced}))}Object.assign(this.attributes,r),this._mapUpdateTriggersToAttributes()}},{key:"_mapUpdateTriggersToAttributes",value:function(){var t=this,e={},n=function(n){t.attributes[n].getUpdateTriggers().forEach((function(t){e[t]||(e[t]=[]),e[t].push(n)}))};for(var r in this.attributes)n(r);this.updateTriggers=e}},{key:"_invalidateTrigger",value:function(t){var e=this.attributes,n=this.updateTriggers[t];if(n)n.forEach((function(t){var n=e[t];n&&n.setNeedsUpdate()}));else{var r="invalidating non-existent trigger ".concat(t," for ").concat(this.id,"\n");r+="Valid triggers: ".concat(Object.keys(e).join(", ")),i.warn(r,n)()}return n}},{key:"_updateAttribute",value:function(t){var e=t.attribute,n=t.numInstances,r=t.data,i=t.props,o=t.context;e.allocate(n)&&Bt.onUpdate({level:3,message:"".concat(e.id," allocated ").concat(n),id:this.id});var a=Date.now();if(e.updateBuffer({numInstances:n,data:r,props:i,context:o})){this.needsRedraw=!0;var s=Math.round(Date.now()-a);Bt.onUpdate({level:3,message:"".concat(e.id," updated ").concat(n," in ").concat(s,"ms")})}}}]),t}();function Vt(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var Gt=new Map,Ut=function(t){if(ut.a.isReady()&&t.id){var e=Gt.get(t.id);e&&e.forEach((function(e,n){!function t(e,n,r){e&&(n.length>1?t(e[n[0]],n.slice(1),r):e[n[0]]=r)}(t,n,e),"data"===n[0]&&(t.data=Vt(t.data))}))}},Wt=function(t){ut.a.isReady()&&ut.a.listenFor("deck.gl",t)},qt=function(t){ut.a.isReady()&&ut.a.listenFor("init",t)},Xt=function(t){if(ut.a.isReady()&&t){var e=[t.constructor.layerName];ut.a.listItem("deck.gl",t.id,{badges:e,links:t.state&&t.state.model?["luma.gl:".concat(t.state.model.id)]:void 0,parent:t.parent?t.parent.id:void 0})}},Ht=function(t){if(ut.a.isReady()&&!ut.a.throttle("deck.gl:".concat(t.id),1e3)){var e=function(t){var e=[{path:"objects.props",data:t.props}],n=[t.constructor.layerName];if(t.state){if(t.getAttributeManager()){var r=t.getAttributeManager().getAttributes();e.push({path:"objects.attributes",data:r}),n.push(t.getAttributeManager().stats.getTimeString())}if(t.state.model){t.state.model.setProps({timerQueryEnabled:!0});var i=t.state.model.stats.lastFrameTime;i&&n.push("".concat((1e3*i).toFixed(0),"s"))}}return e.push({path:"badges",data:n}),e}(t);ut.a.multiUpdate("deck.gl",t.id,e)}};function Yt(t){return(Yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zt(t,e){var n=Kt({newProps:t,oldProps:e,propTypes:Qt(t),ignoreProps:{data:null,updateTriggers:null}}),r=function(t,e){if(null===e)return"oldProps is null, initial diff";var n=t.dataComparator;if(n){if(!n(t.data,e.data))return"Data comparator detected a change"}else if(t.data!==e.data)return"A new data container was supplied";return null}(t,e),i=!1;return r||(i=function(t,e){if(null===e)return"oldProps is null, initial diff";if("all"in t.updateTriggers){if(Jt(t,e,"all"))return{all:!0}}var n={},r=!1;for(var i in t.updateTriggers){if("all"!==i)Jt(t,e,i)&&(n[i]=!0,r=n)}return r}(t,e)),{dataChanged:r,propsChanged:n,updateTriggersChanged:i}}function Kt(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.newProps,n=t.oldProps,r=t.ignoreProps,i=void 0===r?{}:r,o=t.propTypes,a=void 0===o?{}:o,s=t.triggerName,u=void 0===s?"props":s;if(g(void 0!==n&&void 0!==e,"compareProps args"),n===e)return null;if("object"!==Yt(e)||null===e)return"".concat(u," changed shallowly");if("object"!==Yt(n)||null===n)return"".concat(u," changed shallowly");for(var c in n)if(!(c in i)){if(!(c in e))return"".concat(u,".").concat(c," dropped");var l=e[c],f=n[c],h=a[c],d=h&&h.equal;if(d&&!d(l,f,h))return"".concat(u,".").concat(c," changed deeply");if(!d&&(d=l&&f&&l.equals)&&!d.call(l,f))return"".concat(u,".").concat(c," changed deeply");if(!d&&f!==l)return"".concat(u,".").concat(c," changed shallowly")}for(var p in e)if(!(p in i)&&!(p in n))return"".concat(u,".").concat(p," added: undefined -> ").concat(e[p]);return null}function Jt(t,e,n){var r=t.updateTriggers[n];r=null==r?{}:r;var i=e.updateTriggers[n];return Kt({oldProps:i=null==i?{}:i,newProps:r,triggerName:n})}function Qt(t){var e=t._component,n=e&&e.constructor;return n?n._propTypes:{}}function $t(t){return($t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function te(t){if(null===(e=t)||"object"!==$t(e))throw new Error("count(): argument not an object");var e;if("function"==typeof t.count)return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(function(t){return null!==t&&"object"===$t(t)&&t.constructor===Object}(t))return Object.keys(t).length;throw new Error("count(): argument not a container")}var ee="Awaiting state",ne="Matched. State transferred from previous layer",re="Initialized",ie="Discarded. Awaiting garbage collection",oe="No longer matched. Awaiting garbage collection",ae="Finalized! Awaiting garbage collection";function se(t){return(se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ue(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var ce={boolean:{validate:function(t,e){return!0},equal:function(t,e,n){return Boolean(t)===Boolean(e)}},number:{validate:function(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},color:{validate:function(t,e){return de(t)&&(3===t.length||4===t.length)},equal:function(t,e,n){return le(t,e)}},accessor:{validate:function(t,e){var n=pe(t);return"function"===n||n===pe(e.value)},equal:function(t,e,n){return"function"==typeof e||le(t,e)}},array:{validate:function(t,e){return e.optional&&!t||de(t)},equal:function(t,e,n){return n.compare?le(t,e):t===e}},function:{validate:function(t,e){return e.optional&&!t||"function"==typeof t},equal:function(t,e,n){return!n.compare||t===e}}};function le(t,e){if(t===e)return!0;if(!de(t)||!de(e))return!1;var n=t.length;if(n!==e.length)return!1;for(var r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}function fe(t,e){switch(pe(e)){case"object":return he(t,e);case"array":return he(t,{type:"array",value:e,compare:!1});case"boolean":return he(t,{type:"boolean",value:e});case"number":return he(t,{type:"number",value:e});case"function":return he(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function he(t,e){return"type"in e?Object.assign({name:t},ce[e.type],e):"value"in e?Object.assign({name:t,type:pe(e.value)},e):{name:t,type:"object",value:e}}function de(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function pe(t){return de(t)?"array":null===t?"null":se(t)}function ge(){for(var t=this,e=ye(t.constructor),n=e.defaultProps,r=Object.create(n,{_component:{enumerable:!1,value:t},_asyncPropOriginalValues:{enumerable:!1,value:{}},_asyncPropResolvedValues:{enumerable:!1,value:{}}}),i=0;i<arguments.length;++i)Object.assign(r,arguments[i]);var o=t.constructor.layerName,a=e.deprecatedProps;return ve(o,r,a),ve(o,r.updateTriggers,a),ve(o,r.transitions,a),Ut(r),Object.freeze(r),r}function ve(t,e,n){if(e)for(var r in n)if(be(e,r)){var o="".concat(t||"Layer",": ").concat(r),a=!0,s=!1,u=void 0;try{for(var c,l=n[r][Symbol.iterator]();!(a=(c=l.next()).done);a=!0){var f=c.value;be(e,f)||(e[f]=e[r])}}catch(t){s=!0,u=t}finally{try{a||null==l.return||l.return()}finally{if(s)throw u}}i.deprecated(o,n[r].join("/"))()}}function ye(t){var e=_e(t,"_mergedDefaultProps");return e?{defaultProps:e,propTypes:_e(t,"_propTypes"),deprecatedProps:_e(t,"_deprecatedProps")}:function(t){var e=t.prototype;if(!e)return{defaultProps:{}};var n=Object.getPrototypeOf(t),r=e&&ye(n)||null,o=function(t){for(var e={},n={},r={},i=Object.entries(t),o=0;o<i.length;o++){var a=ue(i[o],2),s=a[0],u=a[1];if(u&&u.deprecatedFor)r[s]=Array.isArray(u.deprecatedFor)?u.deprecatedFor:[u.deprecatedFor];else{var c=fe(s,u);e[s]=c,n[s]=c.value}}return{propTypes:e,defaultProps:n,deprecatedProps:r}}(_e(t,"defaultProps")||{}),a=Object.assign({},r&&r.propTypes,o.propTypes),s=function(t,e,n,r){var o=Object.create(null);Object.assign(o,e,t);var a=function(t){var e=_e(t,"layerName")||_e(t,"componentName");e||i.once(0,"".concat(t.name,".componentName not specified"))();return e||t.name}(r);return delete t.id,Object.defineProperties(o,{id:{configurable:!1,writable:!0,value:a}}),function(t,e){var n={},r={_asyncPropDefaultValues:{enumerable:!1,value:n},_asyncPropOriginalValues:{enumerable:!1,value:{}}};for(var i in e){var o=e[i],a=o.name,s=o.value;o.async&&(n[a]=s,r[a]=me(a))}Object.defineProperties(t,r)}(o,n),o}(o.defaultProps,r&&r.defaultProps,a,t),u=Object.assign({},r&&r.deprecatedProps,o.deprecatedProps);return t._mergedDefaultProps=s,t._propTypes=a,t._deprecatedProps=u,{propTypes:a,defaultProps:s,deprecatedProps:u}}(t)}function me(t){return{configurable:!1,enumerable:!0,set:function(e){"string"==typeof e||e instanceof Promise?this._asyncPropOriginalValues[t]=e:this._asyncPropResolvedValues[t]=e},get:function(){if(this._asyncPropResolvedValues){if(t in this._asyncPropResolvedValues){var e=this._asyncPropResolvedValues[t];return"data"===t?e||this._asyncPropDefaultValues[t]:e}if(t in this._asyncPropOriginalValues){var n=this._component&&this._component.internalState;if(n&&n.hasAsyncProp(t))return n.getAsyncProp(t)}}return this._asyncPropDefaultValues[t]}}}function be(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function _e(t,e){return be(t,e)&&t[e]}function xe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function we(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ee=Object.freeze({}),Se=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;xe(this,t),this.component=e,this.asyncProps={},this.onAsyncPropUpdated=function(){},this.oldProps=Ee,this.oldAsyncProps=null}var e,n,r;return e=t,(n=[{key:"getOldProps",value:function(){return this.oldAsyncProps||this.oldProps}},{key:"resetOldProps",value:function(){this.oldAsyncProps=null,this.oldProps=this.component.props}},{key:"freezeAsyncOldProps",value:function(){if(!this.oldAsyncProps)for(var t in this.oldProps=this.oldProps||this.component.props,this.oldAsyncProps={},this.oldProps)this.oldAsyncProps[t]=this.oldProps[t]}},{key:"hasAsyncProp",value:function(t){return t in this.asyncProps}},{key:"getAsyncProp",value:function(t){var e=this.asyncProps[t];return e&&e.resolvedValue}},{key:"isAsyncPropLoading",value:function(t){var e=this.asyncProps[t];return Boolean(e&&e.pendingLoadCount>0&&e.pendingLoadCount!==e.resolvedLoadCount)}},{key:"setAsyncProps",value:function(t){var e=t._asyncPropResolvedValues||{},n=t._asyncPropOriginalValues||t,r=t._asyncPropDefaultValues||{};for(var i in e){var o=e[i];this._createAsyncPropData(i,o,r[i]),this._updateAsyncProp(i,o)}for(var a in n){var s=n[a];this._createAsyncPropData(a,s,r[a]),this._updateAsyncProp(a,s)}}},{key:"_updateAsyncProp",value:function(t,e){this._didAsyncInputValueChange(t,e)&&("string"==typeof e&&(e=(0,this.layer.props.fetch)(e)),e instanceof Promise?this._watchPromise(t,e):this._setPropValue(t,e))}},{key:"_didAsyncInputValueChange",value:function(t,e){var n=this.asyncProps[t];return e!==n.lastValue&&(n.lastValue=e,!0)}},{key:"_setPropValue",value:function(t,e){var n=this.asyncProps[t];n.value=e,n.resolvedValue=e,n.pendingLoadCount++,n.resolvedLoadCount=n.pendingLoadCount}},{key:"_setAsyncPropValue",value:function(t,e,n){var r=this.asyncProps[t];r&&n>=r.resolvedLoadCount&&(g(void 0!==e),this.freezeAsyncOldProps(),e=this._postProcessValue(t,e),r.resolvedValue=e,r.resolvedLoadCount=n,this.onAsyncPropUpdated(t,e))}},{key:"_watchPromise",value:function(t,e){var n=this,r=this.asyncProps[t];r.pendingLoadCount++;var o=r.pendingLoadCount;e.then((function(e){return n._setAsyncPropValue(t,e,o)})).catch((function(t){return i.error(t)()}))}},{key:"_postProcessValue",value:function(t,e){var n=(this.component?this.component.props:{}).dataTransform;return"data"===t&&n&&(e=n(e)),e}},{key:"_createAsyncPropData",value:function(t,e,n){this.asyncProps[t]||(this.asyncProps[t]={lastValue:null,resolvedValue:n,pendingLoadCount:0,resolvedLoadCount:0})}}])&&we(e.prototype,n),r&&we(e,r),t}();function Oe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Pe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ce=0,Me=function(){function t(){Oe(this,t),this.props=ge.apply(this,arguments),this.id=this.props.id,this.count=Ce++,this.lifecycle=ee,this.parent=null,this.context=null,this.state=null,this.internalState=null,Object.seal(this)}var e,n,r;return e=t,(n=[{key:"clone",value:function(t){var e=this.props,n={};for(var r in e._asyncPropDefaultValues)r in e._asyncPropResolvedValues?n[r]=e._asyncPropResolvedValues[r]:r in e._asyncPropOriginalValues&&(n[r]=e._asyncPropOriginalValues[r]);return new this.constructor(Object.assign({},e,n,t))}},{key:"_initState",value:function(){this.internalState=new Se({})}},{key:"stats",get:function(){return this.internalState.stats}}])&&Pe(e.prototype,n),r&&Pe(e,r),t}();function Ie(t){return(Ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ae(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Te(t,e){return!e||"object"!==Ie(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ne(t){return(Ne=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Le(t,e){return(Le=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Me.defaultProps={};var Re=function(t){function e(t){var n,r=t.attributeManager,i=t.layer;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Te(this,Ne(e).call(this,i))).attributeManager=r,n.model=null,n.needsRedraw=!0,n.subLayers=null,n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Le(t,e)}(e,t),n=e,(r=[{key:"layer",get:function(){return this.component},set:function(t){this.component=t}}])&&Ae(n.prototype,r),i&&Ae(n,i),e}(Se);function ke(t){return(ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function je(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Fe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function De(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Be(t,e){return!e||"object"!==ke(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ze(t){return(ze=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ve(t,e){return(Ve=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ge=Object.freeze([]),Ue=new Uint8ClampedArray(0),We={data:{type:"data",value:Ge,async:!0},dataComparator:null,dataTransform:{type:"function",value:function(t){return t},compare:!1},fetch:{type:"function",value:function(t){return fetch(t).then((function(t){return t.json()}))},compare:!1},updateTriggers:{},numInstances:void 0,visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:.8},onHover:{type:"function",value:null,compare:!1,optional:!0},onClick:{type:"function",value:null,compare:!1,optional:!0},onDragStart:{type:"function",value:null,compare:!1,optional:!0},onDrag:{type:"function",value:null,compare:!1,optional:!0},onDragEnd:{type:"function",value:null,compare:!1,optional:!0},coordinateSystem:f.LNGLAT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,parameters:{},uniforms:{},framebuffer:null,animation:null,getPolygonOffset:{type:"function",value:function(t){return[0,100*-t.layerIndex]},compare:!1},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"color",value:[0,0,128,128]}},qe=function(t){function e(){return Fe(this,e),Be(this,ze(e).apply(this,arguments))}var n,r,a;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ve(t,e)}(e,t),n=e,(r=[{key:"toString",value:function(){var t=this.constructor.layerName||this.constructor.name;return"".concat(t,"({id: '").concat(this.props.id,"'})")}},{key:"setState",value:function(t){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,t),this.setNeedsRedraw()}},{key:"setNeedsRedraw",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.internalState&&(this.internalState.needsRedraw=t)}},{key:"setLayerNeedsUpdate",value:function(){this.context.layerManager.setNeedsUpdate(String(this))}},{key:"getNeedsRedraw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.clearRedrawFlags,n=void 0!==e&&e;return this._getNeedsRedraw(n)}},{key:"needsUpdate",value:function(){return this.shouldUpdateState(this._getUpdateParams())}},{key:"isPickable",value:function(){return this.props.pickable&&this.props.visible}},{key:"getModels",value:function(){return this.state&&(this.state.models||(this.state.model?[this.state.model]:[]))}},{key:"getSingleModel",value:function(){return this.state&&this.state.model}},{key:"getAttributeManager",value:function(){return this.internalState&&this.internalState.attributeManager}},{key:"getCurrentLayer",value:function(){return this.internalState&&this.internalState.layer}},{key:"getFirstObject",value:function(){var t=this.props.data,e=!0,n=!1,r=void 0;try{for(var i,o=t[Symbol.iterator]();!(e=(i=o.next()).done);e=!0)return i.value}catch(t){n=!0,r=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}return null}},{key:"project",value:function(t){var e=this.context.viewport,n=je(K(tt(t,{viewport:e,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),e.pixelProjectionMatrix),3),r=n[0],i=n[1],o=n[2];return 2===t.length?[r,i]:[r,i,o]}},{key:"unproject",value:function(t){var e=this.context.viewport;return g(Array.isArray(t)),e.unproject(t)}},{key:"projectPosition",value:function(t){return g(Array.isArray(t)),et(t,{viewport:this.context.viewport,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem})}},{key:"projectFlat",value:function(t){i.deprecated("layer.projectFlat","layer.projectPosition")();var e=this.context.viewport;return g(Array.isArray(t)),e.projectFlat(t)}},{key:"unprojectFlat",value:function(t){i.deprecated("layer.unprojectFlat")();var e=this.context.viewport;return g(Array.isArray(t)),e.unprojectFlat(t)}},{key:"use64bitProjection",value:function(){if(this.props.fp64){if(this.props.coordinateSystem===f.LNGLAT_DEPRECATED)return!0;i.once(0,"Legacy 64-bit mode only works with coordinateSystem set to\n        COORDINATE_SYSTEM.LNGLAT_DEPRECATED. Rendering in 32-bit mode instead")()}return!1}},{key:"use64bitPositions",value:function(){return this.props.fp64||this.props.coordinateSystem===f.LNGLAT}},{key:"screenToDevicePixels",value:function(t){return i.deprecated("screenToDevicePixels","DeckGL prop useDevicePixels for conversion")(),t*("undefined"!=typeof window?window.devicePixelRatio:1)}},{key:"onHover",value:function(t){return!!this.props.onHover&&this.props.onHover(t,this.context.pickingEvent)}},{key:"onClick",value:function(t){return!!this.props.onClick&&this.props.onClick(t,this.context.pickingEvent)}},{key:"nullPickingColor",value:function(){return[0,0,0]}},{key:"encodePickingColor",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return g(t<16777215,"index out of picking color range"),e[0]=t+1&255,e[1]=t+1>>8&255,e[2]=t+1>>8>>8&255,e}},{key:"decodePickingColor",value:function(t){g(t instanceof Uint8Array);var e=je(t,3);return e[0]+256*e[1]+65536*e[2]-1}},{key:"initializeState",value:function(){throw new Error("Layer ".concat(this," has not defined initializeState"))}},{key:"shouldUpdateState",value:function(t){return t.oldProps,t.props,t.context,t.changeFlags.propsOrDataChanged}},{key:"updateState",value:function(t){t.oldProps,t.props,t.context;var e=t.changeFlags,n=this.getAttributeManager();e.dataChanged&&n&&n.invalidateAll()}},{key:"finalizeState",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=this.getModels()[Symbol.iterator]();!(t=(r=i.next()).done);t=!0)r.value.delete()}catch(t){e=!0,n=t}finally{try{t||null==i.return||i.return()}finally{if(e)throw n}}var o=this.getAttributeManager();o&&o.finalize()}},{key:"draw",value:function(t){var e=!0,n=!1,r=void 0;try{for(var i,o=this.getModels()[Symbol.iterator]();!(e=(i=o.next()).done);e=!0)i.value.draw(t)}catch(t){n=!0,r=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}}},{key:"getPickingInfo",value:function(t){var e=t.info,n=(t.mode,e.index);return n>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[n]),e}},{key:"invalidateAttribute",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=this.getAttributeManager();n&&("all"===t?(i.log(1,"updateTriggers invalidating all attributes: ".concat(e))(),n.invalidateAll()):(i.log(1,"updateTriggers invalidating attribute ".concat(t,": ").concat(e))(),n.invalidate(t)))}},{key:"updateAttributes",value:function(t){var e=this.getAttributeManager();if(e){var n=this.getNumInstances(t);e.update({data:t.data,numInstances:n,props:t,transitions:t.transitions,buffers:t,context:this,ignoreUnknownAttributes:!0});var r=this.getSingleModel();if(r){var i=e.getChangedAttributes({clearChangedFlags:!0});r.setAttributes(i)}}}},{key:"updateTransition",value:function(){var t=this.getAttributeManager();t&&t.updateTransition()}},{key:"calculateInstancePickingColors",value:function(t,e){var n=e.numInstances,r=t.value,i=t.size;if(1!==r[0]){var o=Ue.length/i;if(o<n){var a=new Uint8ClampedArray(n*i);a.set(Ue);for(var s=[],u=o;u<n;u++)this.encodePickingColor(u,s),a[u*i+0]=s[0],a[u*i+1]=s[1],a[u*i+2]=s[2];Ue=a}r.set(n<o?Ue.subarray(0,n*i):Ue)}}},{key:"_clearInstancePickingColor",value:function(t){var e=this.getAttributeManager().attributes.instancePickingColors,n=e.value,r=e.size,i=this.decodePickingColor(t);n[i*r+0]=0,n[i*r+1]=0,n[i*r+2]=0,e.update({value:n})}},{key:"_clearPickingColor",value:function(t){for(var e=this.getAttributeManager().attributes.pickingColors,n=e.value,r=0;r<n.length;r+=3)n[r+0]===t[0]&&n[r+1]===t[1]&&n[r+2]===t[2]&&(n[r+0]=0,n[r+1]=0,n[r+2]=0);e.update({value:n})}},{key:"clearPickingColor",value:function(t){this.getAttributeManager().attributes.pickingColors?this._clearPickingColor(t):this._clearInstancePickingColor(t)}},{key:"copyPickingColors",value:function(){var t=this.getAttributeManager().attributes,e=t.pickingColors,n=t.instancePickingColors;return new Uint8ClampedArray((e||n).value)}},{key:"restorePickingColors",value:function(t){var e=this.getAttributeManager().attributes,n=e.pickingColors,r=e.instancePickingColors;(n||r).update({value:t})}},{key:"getNumInstances",value:function(t){return void 0!==(t=t||this.props).numInstances?t.numInstances:this.state&&void 0!==this.state.numInstances?this.state.numInstances:te(this.props.data)}},{key:"_initialize",value:function(){this._initState(),this.initializeState(this.context),this.state.attributeManager=this.getAttributeManager(),this.setChangeFlags({dataChanged:!0,propsChanged:!0,viewportChanged:!0}),this._updateState();var t=this.getSingleModel();t&&(t.id=this.props.id,t.program.id="".concat(this.props.id,"-program"),t.geometry.id="".concat(this.props.id,"-geometry"))}},{key:"_update",value:function(){this.needsUpdate()&&this._updateState()}},{key:"_updateState",value:function(){var t=this._getUpdateParams();if(this.context.gl)this.updateState(t);else try{this.updateState(t)}catch(t){}this.isComposite?this._renderLayers(t):(this.setNeedsRedraw(),this.updateAttributes(this.props),this._updateBaseUniforms(),this.state.model&&this.state.model.setInstanceCount(this.getNumInstances())),this.clearChangeFlags(),this.internalState.resetOldProps()}},{key:"_finalize",value:function(){var t;g(this.internalState&&this.state),this.finalizeState(this.context),t=this.id,ut.a.isReady()&&t&&ut.a.deleteItem("deck.gl",t)}},{key:"drawLayer",value:function(t){var e=this,n=t.moduleParameters,r=void 0===n?null:n,i=t.uniforms,a=void 0===i?{}:i,s=t.parameters,u=void 0===s?{}:s;a.picking_uActive||this.updateTransition(),r&&this.setModuleParameters(r);var c=this.context.animationProps;if(c){var l=!0,f=!1,h=void 0;try{for(var d,p=this.getModels()[Symbol.iterator]();!(l=(d=p.next()).done);l=!0)d.value._setAnimationProps(c)}catch(t){f=!0,h=t}finally{try{l||null==p.return||p.return()}finally{if(f)throw h}}}var g=this.props.getPolygonOffset,v=g&&g(a)||[0,0];u.polygonOffset=v,Object(o.withParameters)(this.context.gl,u,(function(){e.draw({moduleParameters:r,uniforms:a,parameters:u,context:e.context})}))}},{key:"pickLayer",value:function(t){return this.getPickingInfo(t)}},{key:"getChangeFlags",value:function(){return this.internalState.changeFlags}},{key:"setChangeFlags",value:function(t){var e=this;this.internalState.changeFlags=this.internalState.changeFlags||{};var n=this.internalState.changeFlags;t.dataChanged&&!n.dataChanged&&(n.dataChanged=t.dataChanged,i.log(2,(function(){return"dataChanged: ".concat(t.dataChanged," in ").concat(e.id)}))()),t.updateTriggersChanged&&!n.updateTriggersChanged&&(n.updateTriggersChanged=n.updateTriggersChanged&&t.updateTriggersChanged?Object.assign({},t.updateTriggersChanged,n.updateTriggersChanged):t.updateTriggersChanged||n.updateTriggersChanged,i.log(2,(function(){return"updateTriggersChanged: "+"".concat(Object.keys(t.updateTriggersChanged).join(", ")," in ").concat(e.id)}))()),t.propsChanged&&!n.propsChanged&&(n.propsChanged=t.propsChanged,i.log(2,(function(){return"propsChanged: ".concat(t.propsChanged," in ").concat(e.id)}))()),t.viewportChanged&&!n.viewportChanged&&(n.viewportChanged=t.viewportChanged,i.log(3,(function(){return"viewportChanged: ".concat(t.viewportChanged," in ").concat(e.id)}))()),t.stateChanged&&!n.stateChanged&&(n.stateChanged=t.stateChanged,i.log(2,(function(){return"stateChanged: ".concat(t.stateChanged," in ").concat(e.id)}))());var r=t.dataChanged||t.updateTriggersChanged||t.propsChanged;n.propsOrDataChanged=n.propsOrDataChanged||r,n.somethingChanged=n.somethingChanged||r||t.viewportChanged||t.stateChanged}},{key:"clearChangeFlags",value:function(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}},{key:"printChangeFlags",value:function(){var t=this.internalState.changeFlags;return"".concat(t.dataChanged?"data ":"").concat(t.propsChanged?"props ":"").concat(t.updateTriggersChanged?"triggers ":"").concat(t.viewportChanged?"viewport":"")}},{key:"diffProps",value:function(t,e){var n=Zt(t,e);if(n.updateTriggersChanged)for(var r in n.updateTriggersChanged)n.updateTriggersChanged[r]&&this._activeUpdateTrigger(r);return this.setChangeFlags(n)}},{key:"validateProps",value:function(){!function(t){var e=Qt(t);for(var n in e){var r=e[n],i=r.validate;if(i&&!i(t[n],r))throw new Error("Invalid prop ".concat(n,": ").concat(t[n]))}}(this.props)}},{key:"setModuleParameters",value:function(t){var e=!0,n=!1,r=void 0;try{for(var i,o=this.getModels()[Symbol.iterator]();!(e=(i=o.next()).done);e=!0)i.value.updateModuleSettings(t)}catch(t){n=!0,r=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw r}}}},{key:"_getUpdateParams",value:function(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}},{key:"_getNeedsRedraw",value:function(t){if(!this.internalState)return!1;var e=!1;e=e||this.internalState.needsRedraw&&this.id,this.internalState.needsRedraw=this.internalState.needsRedraw&&!t;var n=this.getAttributeManager(),r=n&&n.getNeedsRedraw({clearRedrawFlags:t});return e=e||r}},{key:"_getAttributeManager",value:function(){return new zt(this.context.gl,{id:this.props.id,stats:this.context.stats})}},{key:"_initState",value:function(){g(!this.internalState&&!this.state);var t=this._getAttributeManager();t&&t.addInstanced({instancePickingColors:{type:lt.a.UNSIGNED_BYTE,size:3,update:this.calculateInstancePickingColors}}),this.internalState=new Re({attributeManager:t,layer:this}),this.state={},this.state.attributeManager=t,this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props)}},{key:"_transferState",value:function(t){var e=t.state,n=t.internalState;if(g(e&&n),this!==t){this.internalState=n,this.internalState.component=this,this.state=e,e.layer=this,this.internalState.setAsyncProps(this.props);var r=!0,i=!1,o=void 0;try{for(var a,s=this.getModels()[Symbol.iterator]();!(r=(a=s.next()).done);r=!0)a.value.userData.layer=this}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}this.diffProps(this.props,this.internalState.getOldProps())}}},{key:"_onAsyncPropUpdated",value:function(){this.diffProps(this.props,this.internalState.getOldProps()),this.setLayerNeedsUpdate()}},{key:"_activeUpdateTrigger",value:function(t){this.invalidateAttribute(t)}},{key:"_updateBaseUniforms",value:function(){var t=this,e={opacity:"function"==typeof this.props.opacity?function(e){return Math.pow(t.props.opacity(e),1/2.2)}:Math.pow(this.props.opacity,1/2.2)},n=!0,r=!1,i=void 0;try{for(var o,a=this.getModels()[Symbol.iterator]();!(n=(o=a.next()).done);n=!0)o.value.setUniforms(e)}catch(t){r=!0,i=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}}},{key:"setUniforms",value:function(t){var e=!0,n=!1,r=void 0;try{for(var o,a=this.getModels()[Symbol.iterator]();!(e=(o=a.next()).done);e=!0)o.value.setUniforms(t)}catch(t){n=!0,r=t}finally{try{e||null==a.return||a.return()}finally{if(n)throw r}}this.setNeedsRedraw(),i.deprecated("layer.setUniforms","model.setUniforms")()}},{key:"is64bitEnabled",value:function(){return i.deprecated("is64bitEnabled","use64bitProjection")(),this.use64bitProjection()}}])&&De(n.prototype,r),a&&De(n,a),e}(Me);qe.layerName="Layer",qe.defaultProps=We;var Xe=0,He=function(t){var e=t.useDevicePixels;return g("boolean"==typeof e,"Invalid useDevicePixels"),e&&"undefined"!=typeof window?window.devicePixelRatio:1};function Ye(t,e){var n=e.layers,r=e.viewports,a=e.views,s=e.onViewportActive,u=e.useDevicePixels,c=e.drawPickingColors,l=void 0!==c&&c,f=e.deviceRect,h=void 0===f?null:f,d=e.parameters,p=void 0===d?{}:d,g=e.layerFilter,v=void 0===g?null:g,y=e.pass,m=void 0===y?"draw":y,b=e.redrawReason,_=void 0===b?"":b,x=e.stats;e.customRender||function(t,e){e.useDevicePixels;var n=t.drawingBufferWidth,r=t.drawingBufferHeight;Object(o.withParameters)(t,{viewport:[0,0,n,r]},(function(){t.clear(lt.a.COLOR_BUFFER_BIT|lt.a.DEPTH_BUFFER_BIT)}))}(t,{useDevicePixels:u}),r.forEach((function(e,r){var c=function(t){return t.viewport?t.viewport:t}(e),f=a&&a[c.id];s(c),function(t,e){var n=e.layers,r=e.viewport,a=e.view,s=e.useDevicePixels,u=e.drawPickingColors,c=void 0!==u&&u,l=(e.deviceRect,e.parameters),f=void 0===l?{}:l,h=e.layerFilter,d=e.pass,p=void 0===d?"draw":d,g=e.redrawReason,v=void 0===g?"":g,y=e.stats,m=He({useDevicePixels:s}),b=function(t,e){var n=e.viewport,r=e.pixelRatio,i=t.canvas?t.canvas.clientHeight||t.canvas.height:100,o=n;return[o.x*r,(i-o.y-o.height)*r,o.width*r,o.height*r]}(t,{viewport:r,pixelRatio:m});if(a&&a.props.clear){var _=!0===a.props.clear?{color:!0,depth:!0}:a.props.clear;Object(o.withParameters)(t,{scissorTest:!0,scissor:b},(function(){return Object(o.clear)(t,_)}))}var x={totalCount:n.length,visibleCount:0,compositeCount:0,pickableCount:0};Object(o.setParameters)(t,f||{}),n.forEach((function(e,n){var i=!e.isComposite&&e.props.visible;c&&(i=i&&e.props.pickable),i&&h&&(i=h({layer:e,viewport:r,isPicking:c})),i&&e.props.pickable&&x.pickableCount++,e.isComposite&&x.compositeCount++,i&&(x.visibleCount++,function(t){t.gl;var e=t.layer,n=t.layerIndex,r=t.drawPickingColors,i=t.pixelRatio,o=t.glViewport,a=t.parameters,s=Object.assign(Object.create(e.props),{viewport:e.context.viewport,pickingActive:r?1:0,devicePixelRatio:i}),u=Object.assign({},e.context.uniforms,{layerIndex:n}),c=Object.assign({},e.props.parameters||{},a);Object.assign(c,{viewport:o}),r?Object.assign(c,{blendColor:[0,0,0,(n+1)/255]}):Object.assign(s,function(t){var e=t.props,n=e.highlightedObjectIndex,r=e.highlightColor,i={pickingHighlightColor:[r[0],r[1],r[2],r[3]||255]};Number.isInteger(n)&&(i.pickingSelectedColor=n>=0?t.encodePickingColor(n):null);return i}(e));e.drawLayer({moduleParameters:s,uniforms:u,parameters:c})}({gl:t,layer:e,layerIndex:n,drawPickingColors:c,pixelRatio:m,glViewport:b,parameters:f}))})),Xe++,function(t){var e=t.renderStats,n=t.pass,r=t.redrawReason,o=t.stats;if(i.priority>=2){var a=e.totalCount,s=e.visibleCount,u=e.compositeCount,c=e.pickableCount,l=a-u-s,f="";f+="RENDER #".concat(Xe," ").concat(s," (of ").concat(a," layers) to ").concat(n," because ").concat(r," "),i.priority>2&&(f+="(".concat(l," hidden, ").concat(u," composite ").concat(c," pickable)")),i.log(2,f)(),o&&o.increment("redraw layers",s)}}({renderStats:x,pass:p,redrawReason:v,stats:y})}(t,{layers:n,viewport:c,view:f,useDevicePixels:u,drawPickingColors:l,deviceRect:h,parameters:p,layerFilter:v,pass:m,redrawReason:_,stats:x})}))}var Ze={pickedColor:null,pickedLayer:null,pickedObjectIndex:-1};function Ke(t,e){for(var n=e.layers,r=e.viewports,i=e.x,o=e.y,a=e.radius,s=e.layerFilter,u=e.depth,c=void 0===u?1:u,l=e.mode,f=e.onViewportActive,h=e.pickingFBO,d=e.lastPickedInfo,p=e.useDevicePixels,g=He({useDevicePixels:p}),v=Math.round(i*g),y=Math.round(t.canvas.height-o*g),m=Math.round(a*g),b=function(t){var e=t.deviceX,n=t.deviceY,r=t.deviceRadius,i=t.deviceWidth,o=t.deviceHeight;if(!(e>=0&&n>=0&&e<i&&n<o))return null;var a=Math.max(0,e-r),s=Math.max(0,n-r),u=Math.min(i,e+r)-a+1,c=Math.min(o,n+r)-s+1;return{x:a,y:s,width:u,height:c}}({deviceX:v,deviceY:y,deviceRadius:m,deviceWidth:h.width,deviceHeight:h.height}),_=[],x={},w=0;w<c;w++){var E=b&&Qe(t,{layers:n,viewports:r,onViewportActive:f,useDevicePixels:p,pickingFBO:h,deviceRect:b,layerFilter:s,redrawReason:l}),S=E&&tn(t,{pickedColors:E,layers:n,deviceX:v,deviceY:y,deviceRadius:m,deviceRect:b})||Ze;if(S.pickedColor&&w+1<c){var O=S.pickedColor[3]-1;x[O]||(x[O]=n[O].copyPickingColors()),n[O].clearPickingColor(S.pickedColor)}var P=$e({pickInfo:S,lastPickedInfo:d,mode:l,layers:n,viewports:r,x:i,y:o,deviceX:v,deviceY:y,pixelRatio:g});if(P&&P.forEach((function(t){return _.push(t)})),!S.pickedColor)break}return Object.keys(x).forEach((function(t){return n[t].restorePickingColors(x[t])})),_}function Je(t,e){var n=e.layers,r=e.viewports,o=e.x,a=e.y,s=e.width,u=e.height,c=e.mode,l=e.layerFilter,f=e.onViewportActive,h=e.pickingFBO,d=e.useDevicePixels,p=He({useDevicePixels:d}),g=Math.round(o*p),v=Math.round(t.canvas.height-a*p),y=Math.round((o+s)*p),m=Math.round(t.canvas.height-(a+u)*p),b=function(t,e){var n=e.pickedColors,r=e.layers,o=new Map;if(n)for(var a=0;a<n.length;a+=4){var s=n[a+3]-1;if(s>=0){var u=n.slice(a,a+4),c=u.join(",");if(!o.has(c)){var l=r[s];l?o.set(c,{pickedColor:u,pickedLayer:l,pickedObjectIndex:l.decodePickingColor(u)}):i.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(o.values())}(0,{pickedColors:Qe(t,{layers:n,viewports:r,onViewportActive:f,pickingFBO:h,useDevicePixels:d,deviceRect:{x:g,y:m,width:y-g,height:v-m},layerFilter:l,redrawReason:c}),layers:n}),_=new Map;return b.forEach((function(t){var e={color:t.pickedColor,layer:null,index:t.pickedObjectIndex,picked:!0,x:o,y:a,width:s,height:u,pixelRatio:p};e=en({layer:t.pickedLayer,info:e,mode:c}),_.has(e.object)||_.set(e.object,e)})),Array.from(_.values())}function Qe(t,e){var n=e.layers,r=e.viewports,i=e.onViewportActive,a=e.useDevicePixels,s=e.pickingFBO,u=e.deviceRect,c=e.layerFilter,l=e.redrawReason;if(g(u),g(Number.isFinite(u.width)&&u.width>0,"`width` must be > 0"),g(Number.isFinite(u.height)&&u.height>0,"`height` must be > 0"),n.filter((function(t){return t.isPickable()})).length<1)return null;!function(t,e){var n=e.layers,r=e.viewports,i=e.onViewportActive,a=e.useDevicePixels,s=e.pickingFBO,u=e.deviceRect,c=u.x,l=u.y,f=u.width,h=u.height,d=e.layerFilter,p=void 0===d?null:d,g=e.redrawReason,v=void 0===g?"":g;Object(o.withParameters)(t,{framebuffer:s,scissorTest:!0,scissor:[c,l,f,h],clearColor:[0,0,0,0]},(function(){Ye(t,{layers:n,viewports:r,onViewportActive:i,useDevicePixels:a,drawPickingColors:!0,layerFilter:p,pass:"picking",redrawReason:v,parameters:{blend:!0,blendFunc:[t.ONE,t.ZERO,t.CONSTANT_ALPHA,t.ZERO],blendEquation:t.FUNC_ADD,blendColor:[0,0,0,0]}})}))}(t,{layers:n,viewports:r,onViewportActive:i,useDevicePixels:a,pickingFBO:s,deviceRect:u,layerFilter:c,redrawReason:l});var f=u.x,h=u.y,d=u.width,p=u.height,v=new Uint8Array(d*p*4);return s.readPixels({x:f,y:h,width:d,height:p,pixelArray:v}),v}function $e(t){var e=t.pickInfo,n=t.lastPickedInfo,r=t.mode,i=t.layers,o=t.viewports,a=t.x,s=t.y,u=t.deviceX,c=t.deviceY,l=t.pixelRatio,f=e.pickedColor,h=e.pickedLayer,d=e.pickedObjectIndex,p=h?[h]:[];if("hover"===r){var g=n.index,v=n.layerId,y=h&&h.props.id;if(y!==v||d!==g){if(y!==v){var m=i.find((function(t){return t.props.id===v}));m&&p.unshift(m)}n.layerId=y,n.index=d,n.info=null}}var b={viewports:o}.viewports[0],_=b&&b.unproject([a,s]),x={color:null,layer:null,index:-1,picked:!1,x:a,y:s,pixel:[a,s],coordinate:_,lngLat:_,devicePixel:[u,c],pixelRatio:l},w=new Map;return p.forEach((function(t){var e=Object.assign({},x);if(t===h&&(e.color=f,e.index=d,e.picked=!0),e=en({layer:t,info:e,mode:r}),t===h&&"hover"===r&&(n.info=e),"hover"===r){var i=t.props.autoHighlight&&h===t?f:null;t.setModuleParameters({pickingSelectedColor:i}),t.setNeedsRedraw()}e&&w.set(e.layer.id,e)})),function(t,e){var n=[];return t.forEach((function(t){var r=!1;switch(e){case"click":r=t.layer.onClick(t);break;case"hover":r=t.layer.onHover(t);break;case"query":break;default:throw new Error("unknown pick type")}r||n.push(t)})),n}(w,r)}function tn(t,e){var n=e.pickedColors,r=e.layers,o=e.deviceX,a=e.deviceY,s=e.deviceRadius,u=e.deviceRect;g(n);for(var c=u.x,l=u.y,f=u.width,h=u.height,d=s*s,p=-1,v=0,y=0;y<h;y++){var m=y+l-a,b=m*m;if(b>d)v+=4*f;else for(var _=0;_<f;_++){if(n[v+3]-1>=0){var x=_+c-o,w=x*x+b;w<=d&&(d=w,p=v)}v+=4}}if(p>=0){var E=n[p+3]-1,S=n.slice(p,p+4),O=r[E];if(O){var P=O.decodePickingColor(S);return{pickedColor:S,pickedLayer:O,pickedObjectIndex:P}}i.error("Picked non-existent layer. Is picking buffer corrupt?")()}return Ze}function en(t){for(var e=t.layer,n=t.info,r=t.mode;e&&n;){var i=n.layer||e;n.layer=e,n=e.pickLayer({info:n,mode:r,sourceLayer:i}),e=e.parent}return n}function nn(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.filter,r=void 0===n?function(){return!0}:n,i=e.map,o=void 0===i?function(t){return t}:i,a=e.result,s=void 0===a?[]:a;return Array.isArray(t)?rn(t,r,o,s):r(t)?[o(t)]:[]}function rn(t,e,n,r){for(var i=-1;++i<t.length;){var o=t[i];Array.isArray(o)?rn(o,e,n,r):e(o)&&r.push(n(o))}return r}function on(t){for(var e=t.target,n=t.source,r=t.start,i=void 0===r?0:r,o=t.count,a=void 0===o?1:o,s=n.length,u=a*s,c=0,l=i;c<s;c++)e[l++]=n[c];for(;c<u;)c<u-c?(e.copyWithin(i+c,i,i+c),c*=2):(e.copyWithin(i+c,i,i+u-c),c=u);return e}var an=n(1),sn=n(2),un=n(45),cn=n(59),ln=function(){function t(e){var n=e.id;Object(an.a)(this,t),this.id=n,this.time=Object(un.a)(),this.counters={},Object.seal(this)}return Object(sn.a)(t,[{key:"addCounter",value:function(t){return this._getCounter(t),this}},{key:"bump",value:function(t){var e=this._getCounter(t);return e.call++,e.count++,this}},{key:"increment",value:function(t,e){var n=this._getCounter(t);return n.call++,n.count+=e,this}},{key:"addTimer",value:function(t){return this._getCounter(t).time=0,this}},{key:"addTime",value:function(t,e){var n=this._getCounter(t);return n.time+=e,n.count++,this}},{key:"timeStart",value:function(t,e){this._getCounter(t)._startTime=Object(un.a)()}},{key:"timeEnd",value:function(t,e){var n=this._getCounter(t);this.addTime(t,Object(un.a)()-n._startTime)}},{key:"reset",value:function(){for(var t in this.time=Object(un.a)(),this.counters){var e=this.counters[t];e.count=0,e.time=0}return this}},{key:"hasTimeElapsed",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Object(un.a)()-this.time>1e3}},{key:"getStats",value:function(){var t=(Object(un.a)()-this.time)/1e3,e={};for(var n in this.counters){var r=this.counters[n];e[r.title]={total:r.count,fps:Math.round(r.count/t)},r.time&&(e[r.title].totalTime=Object(cn.b)(r.time),e[r.title].avgTime=Object(cn.b)(r.time/r.count))}return e}},{key:"getStatsTable",value:function(){var t=this.getStats();for(var e in t)0===t[e].total&&delete t[e];return t}},{key:"getStatNames",value:function(){return Object.keys(this.counters)}},{key:"get",value:function(t){return this._getCounter(t).count}},{key:"getCount",value:function(t){return this._getCounter(t).count}},{key:"getFPS",value:function(t){var e=this._getCounter(t),n=(Object(un.a)()-this.time)/1e3;return Math.round(e.count/n)}},{key:"getTimeString",value:function(){return"".concat(this.id,":").concat(Object(cn.b)(this.time),"(").concat(this.count,")")}},{key:"oneSecondPassed",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;return this.hasTimeElapsed(t)}},{key:"_getCounter",value:function(t){var e=this.counters[t];return e||(e={title:t,unit:"",timer:!1,count:0,time:0,totalTime:0,averageTime:0},this.counters[t]=e),e}},{key:"_incrementTimer",value:function(t,e,n){t.count+=n,t.totalTime+=e,t.averageTime=t.totalTime/n}}]),t}();function fn(t,e){if(!t)return null;var n=l.c([0,0,0,0],e,t),r=1/n[3];return l.a(n,n,[r,r,r,r]),n}var hn=n(18),dn=n(556),pn=n(103);function gn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function vn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var mn=Math.PI/180,bn=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],_n=[0,0,0],xn={pixelsPerMeter:[1,1,1],metersPerPixel:[1,1,1],pixelsPerDegree:[1,1,1],degreesPerPixel:[1,1,1]},wn=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};vn(this,t);var n=e.id,r=void 0===n?null:n,i=e.x,o=void 0===i?0:i,a=e.y,s=void 0===a?0:a,u=e.width,c=void 0===u?1:u,l=e.height,f=void 0===l?1:l;this.id=r||this.constructor.displayName||"viewport",this.x=o,this.y=s,this.width=c||1,this.height=f||1,this._initViewMatrix(e),this._initProjectionMatrix(e),this._initPixelMatrices(),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this),this.getMatrices=this.getMatrices.bind(this)}var e,n,r;return e=t,(n=[{key:"equals",value:function(e){return e instanceof t&&e.width===this.width&&e.height===this.height&&Object(hn.e)(e.projectionMatrix,this.projectionMatrix)&&Object(hn.e)(e.viewMatrix,this.viewMatrix)}},{key:"project",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.topLeft,r=void 0===n||n,i=this.projectPosition(t),o=K(i,this.pixelProjectionMatrix),a=gn(o,2),s=a[0],u=a[1],c=r?u:this.height-u;return 2===t.length?[s,c]:[s,c,o[2]]}},{key:"unproject",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.topLeft,r=void 0===n||n,i=e.targetZ,o=gn(t,3),a=o[0],s=o[1],u=o[2],c=r?s:this.height-s,l=i&&i*this.distanceScales.pixelsPerMeter[2],f=J([a,c,u],this.pixelUnprojectionMatrix,l),h=this.unprojectPosition(f),d=gn(h,3),p=d[0],g=d[1],v=d[2];return Number.isFinite(u)?[p,g,v]:Number.isFinite(i)?[p,g,i]:[p,g]}},{key:"projectPosition",value:function(t){var e=gn(this.projectFlat(t),2);return[e[0],e[1],(t[2]||0)*this.distanceScales.pixelsPerMeter[2]]}},{key:"unprojectPosition",value:function(t){var e=gn(this.unprojectFlat(t),2);return[e[0],e[1],(t[2]||0)*this.distanceScales.metersPerPixel[2]]}},{key:"projectFlat",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale;return this.isGeospatial?U(t,e):t}},{key:"unprojectFlat",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale;return this.isGeospatial?W(t,e):t}},{key:"getDistanceScales",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return t?q({longitude:t[0],latitude:t[1],scale:this.scale,highPrecision:!0}):this.distanceScales}},{key:"getMatrices",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.modelMatrix,n=void 0===e?null:e,r=this.viewProjectionMatrix,i=this.pixelProjectionMatrix,o=this.pixelUnprojectionMatrix;n&&(r=c.g([],this.viewProjectionMatrix,n),i=c.g([],this.pixelProjectionMatrix,n),o=c.e([],i));var a=Object.assign({modelViewProjectionMatrix:r,viewProjectionMatrix:this.viewProjectionMatrix,viewMatrix:this.viewMatrix,projectionMatrix:this.projectionMatrix,pixelProjectionMatrix:i,pixelUnprojectionMatrix:o,width:this.width,height:this.height,scale:this.scale});return a}},{key:"containsPixel",value:function(t){var e=t.x,n=t.y,r=t.width,i=void 0===r?1:r,o=t.height,a=void 0===o?1:o;return e<this.x+this.width&&this.x<e+i&&n<this.y+this.height&&this.y<n+a}},{key:"getCameraPosition",value:function(){return this.cameraPosition}},{key:"getCameraDirection",value:function(){return this.cameraDirection}},{key:"getCameraUp",value:function(){return this.cameraUp}},{key:"_addMetersToLngLat",value:function(t,e){var n=gn(t,3),r=n[0],i=n[1],o=n[2],a=void 0===o?0:o,s=gn(this._metersToLngLatDelta(e),3),u=s[0],c=s[1],l=s[2],f=void 0===l?0:l;return 2===t.length?[r+u,i+c]:[r+u,i+c,a+f]}},{key:"_metersToLngLatDelta",value:function(t){var e=gn(t,3),n=e[0],r=e[1],i=e[2],o=void 0===i?0:i;g(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(o),"Illegal argument to Viewport");var a=this.distanceScales,s=a.pixelsPerMeter,u=a.degreesPerPixel,c=n*s[0]*u[0],l=r*s[1]*u[1];return 2===t.length?[c,l]:[c,l,o]}},{key:"_createProjectionMatrix",value:function(t){var e=t.orthographic,n=t.fovyRadians,r=t.aspect,i=t.focalDistance,o=t.near,a=t.far;return g(Number.isFinite(n)),e?(new dn.a).orthographic({fovy:n,aspect:r,focalDistance:i,near:o,far:a}):(new dn.a).perspective({fovy:n,aspect:r,near:o,far:a})}},{key:"_initViewMatrix",value:function(t){var e=t.viewMatrix,n=void 0===e?bn:e,r=t.longitude,i=void 0===r?null:r,o=t.latitude,a=void 0===o?null:o,s=t.zoom,u=void 0===s?null:s,l=t.position,f=void 0===l?null:l,h=t.modelMatrix,d=void 0===h?null:h,p=t.focalDistance,g=void 0===p?1:p,v=t.distanceScales,y=void 0===v?null:v;this.isGeospatial=Number.isFinite(a)&&Number.isFinite(i),this.zoom=u,Number.isFinite(this.zoom)||(this.zoom=this.isGeospatial?function(t){var e=t.latitude;return j(Number.isFinite(e)),G(4003e4*Math.cos(e*B))-9}({latitude:a})+Math.log2(g):0),this.scale=Math.pow(2,this.zoom),this.distanceScales=this.isGeospatial?q({latitude:a,longitude:i,scale:this.scale}):y||xn,this.focalDistance=g,this.distanceScales.metersPerPixel=new pn.a(this.distanceScales.metersPerPixel),this.distanceScales.pixelsPerMeter=new pn.a(this.distanceScales.pixelsPerMeter),this.position=_n,this.meterOffset=_n,f&&(this.position=f,this.modelMatrix=d,this.meterOffset=d?d.transformVector(f):f),this.isGeospatial?(this.longitude=i,this.latitude=a,this.center=this._getCenterInWorld({longitude:i,latitude:a}),this.viewMatrixUncentered=c.n([],n,[1,-1,1]),this.viewMatrix=(new dn.a).multiplyRight(this.viewMatrixUncentered).translate(new pn.a(this.center||_n).negate())):(this.center=f,this.viewMatrixUncentered=n,this.viewMatrix=n)}},{key:"_getCenterInWorld",value:function(t){var e=t.longitude,n=t.latitude,r=this.meterOffset,i=this.scale,o=this.distanceScales,a=this.projectFlat([e,n],i),s=new pn.a(a[0],a[1],0);if(r){var u=new pn.a(r).scale(o.pixelsPerMeter);s.add(u)}return s}},{key:"_initProjectionMatrix",value:function(t){var e=t.projectionMatrix,n=void 0===e?null:e,r=t.orthographic,i=void 0!==r&&r,o=t.fovyRadians,a=t.fovyDegrees,s=t.fovy,u=t.near,c=void 0===u?.1:u,l=t.far,f=void 0===l?1e3:l,h=t.focalDistance,d=void 0===h?1:h,p=t.orthographicFocalDistance,g=o||(a||s||75)*mn;this.projectionMatrix=n||this._createProjectionMatrix({orthographic:i,fovyRadians:g,aspect:this.width/this.height,focalDistance:p||d,near:c,far:f})}},{key:"_initPixelMatrices",value:function(){var t=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];c.g(t,t,this.projectionMatrix),c.g(t,t,this.viewMatrix),this.viewProjectionMatrix=t,this.viewMatrixInverse=c.e([],this.viewMatrix)||this.viewMatrix;var e,n,r,o=(e={viewMatrix:this.viewMatrix,viewMatrixInverse:this.viewMatrixInverse},n=e.viewMatrix,{eye:[(r=e.viewMatrixInverse)[12],r[13],r[14]],direction:[n[2],n[6],n[10]],up:[n[1],n[5],n[9]]}),a=o.eye,s=o.direction,u=o.up;this.cameraPosition=a,this.cameraDirection=s,this.cameraUp=u;var l=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],f=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];c.n(l,l,[this.width/2,-this.height/2,1]),c.o(l,l,[1,-1,0]),c.g(f,l,this.viewProjectionMatrix),this.pixelProjectionMatrix=f,this.viewportMatrix=l,this.pixelUnprojectionMatrix=c.e([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||i.warn("Pixel project matrix not invertible")()}}])&&yn(e.prototype,n),r&&yn(e,r),t}();function En(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Sn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function On(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}wn.displayName="Viewport";var Pn=Object.seal({layerManager:null,gl:null,useDevicePixels:!0,stats:null,shaderCache:null,pickingFBO:null,pickingEvent:null,lastPickedInfo:null,animationProps:null,userData:{}}),Cn=function(t){return t instanceof qe?"".concat(t):t?"invalid":"null"},Mn=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.stats,i=n.viewport,a=void 0===i?null:i;Sn(this,t),this.lastRenderedLayers=[],this.layers=[],this.context=Object.assign({},Pn,{layerManager:this,gl:e,shaderCache:e&&new o._ShaderCache({gl:e,_cachePrograms:!0}),stats:r||new ln({id:"deck.gl"}),lastPickedInfo:{index:-1,layerId:null,info:null},viewport:a||new wn({id:"DEFAULT-INITIAL-VIEWPORT"})}),this.layerFilter=null,this.drawPickingColors=!1,this._needsRedraw="Initial render",this._needsUpdate=!1,this._debug=!1,this._activateViewport=this._activateViewport.bind(this),this._initSeer=this._initSeer.bind(this),this._editSeer=this._editSeer.bind(this),Object.seal(this),qt(this._initSeer),Wt(this._editSeer)}var e,n,r;return e=t,(n=[{key:"finalize",value:function(){ut.a.removeListener(this._initSeer),ut.a.removeListener(this._editSeer)}},{key:"needsRedraw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.clearRedrawFlags,n=void 0===e||e;return this._checkIfNeedsRedraw(n)}},{key:"needsUpdate",value:function(){return this._needsUpdate}},{key:"setNeedsRedraw",value:function(t){this._needsRedraw=this._needsRedraw||t}},{key:"setNeedsUpdate",value:function(t){this._needsUpdate=this._needsUpdate||t}},{key:"getLayers",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.layerIds,n=void 0===e?null:e;return n?this.layers.filter((function(t){return n.find((function(e){return 0===t.id.indexOf(e)}))})):this.layers}},{key:"setProps",value:function(t){"debug"in t&&(this._debug=t.debug),"userData"in t&&(this.context.userData=t.userData),"useDevicePixels"in t&&(this.context.useDevicePixels=t.useDevicePixels),"layers"in t&&this.setLayers(t.layers),"layerFilter"in t&&this.layerFilter!==t.layerFilter&&(this.layerFilter=t.layerFilter,this.setNeedsRedraw("layerFilter changed")),"drawPickingColors"in t&&t.drawPickingColors!==this.drawPickingColors&&(this.drawPickingColors=t.drawPickingColors,this.setNeedsRedraw("drawPickingColors changed"))}},{key:"setLayers",value:function(t){if(t===this.lastRenderedLayers)return i.log(3,"Ignoring layer update due to layer array not changed")(),this;this.lastRenderedLayers=t,t=nn(t,{filter:Boolean});var e=!0,n=!1,r=void 0;try{for(var o,a=t[Symbol.iterator]();!(e=(o=a.next()).done);e=!0)o.value.context=this.context}catch(t){n=!0,r=t}finally{try{e||null==a.return||a.return()}finally{if(n)throw r}}var s=this._updateLayers({oldLayers:this.layers,newLayers:t}),u=s.error,c=s.generatedLayers;if(this.layers=c,u)throw u;return this}},{key:"updateLayers",value:function(){var t=this.needsUpdate();t&&(this.setNeedsRedraw("updating layers: ".concat(t)),this.setLayers(En(this.lastRenderedLayers)))}},{key:"drawLayers",value:function(t){var e=t.pass,n=void 0===e?"render to screen":e,r=t.viewports,i=t.views,o=t.redrawReason,a=void 0===o?"unknown reason":o,s=t.customRender,u=void 0!==s&&s,c=this.drawPickingColors,l=this.context,f=l.gl,h=l.useDevicePixels;Ye(f,{layers:this.layers,viewports:r,views:i,onViewportActive:this._activateViewport,useDevicePixels:h,drawPickingColors:c,pass:n,layerFilter:this.layerFilter,redrawReason:a,customRender:u})}},{key:"getLastPickedObject",value:function(t){var e=t.x,n=t.y,r=t.viewports,i=this.context.lastPickedInfo.info,o=i&&i.layer&&i.layer.id,a=o?this.layers.find((function(t){return t.id===o})):null,s=r[0]&&r[0].unproject([e,n]),u={x:e,y:n,coordinate:s,lngLat:s,layer:a};return a?Object.assign({},i,u):Object.assign(u,{color:null,object:null,index:-1})}},{key:"pickObject",value:function(t){var e=t.x,n=t.y,r=t.mode,i=t.radius,o=void 0===i?0:i,a=t.layerIds,s=t.viewports,u=t.depth,c=void 0===u?1:u,l=t.event,f=void 0===l?null:l,h=this.context,d=h.gl,p=h.useDevicePixels;this.context.pickingEvent=f;var g=Ke(d,{x:e,y:n,radius:o,layers:this.getLayers({layerIds:a}),mode:r,layerFilter:this.layerFilter,depth:c,viewports:s,onViewportActive:this._activateViewport,pickingFBO:this._getPickingBuffer(),lastPickedInfo:this.context.lastPickedInfo,useDevicePixels:p});return this.context.pickingEvent=null,g}},{key:"pickObjects",value:function(t){var e=t.x,n=t.y,r=t.width,i=t.height,o=t.layerIds,a=t.viewports,s=this.context,u=s.gl,c=s.useDevicePixels;return Je(u,{x:e,y:n,width:r,height:i,layers:this.getLayers({layerIds:o}),layerFilter:this.layerFilter,mode:"pickObjects",viewports:a,onViewportActive:this._activateViewport,pickingFBO:this._getPickingBuffer(),useDevicePixels:c})}},{key:"_checkIfNeedsRedraw",value:function(t){var e=this._needsRedraw;t&&(this._needsRedraw=!1);var n=!0,r=!1,i=void 0;try{for(var o,a=this.layers[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value.getNeedsRedraw({clearRedrawFlags:t});e=e||s}}catch(t){r=!0,i=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return e}},{key:"_activateViewport",value:function(t){var e=this.context.viewport;if(!e||!t.equals(e)){i.log(4,"Viewport changed",t)(),this.context.viewport=t;var n=!0,r=!1,o=void 0;try{for(var a,s=this.layers[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var u=a.value;u.setChangeFlags({viewportChanged:"Viewport changed"}),this._updateLayer(u)}}catch(t){r=!0,o=t}finally{try{n||null==s.return||s.return()}finally{if(r)throw o}}}return g(this.context.viewport,"LayerManager: viewport not set"),this}},{key:"_getPickingBuffer",value:function(){var t=this.context.gl;return this.context.pickingFBO=this.context.pickingFBO||new o.Framebuffer(t),this.context.pickingFBO.resize({width:t.canvas.width,height:t.canvas.height}),this.context.pickingFBO}},{key:"_updateLayers",value:function(t){var e=t.oldLayers,n=t.newLayers,r={},o=!0,a=!1,s=void 0;try{for(var u,c=e[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var l=u.value;r[l.id]?i.warn("Multiple old layers with same id ".concat(Cn(l)))():r[l.id]=l}}catch(t){a=!0,s=t}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}var f=[],h=this._updateSublayersRecursively({newLayers:n,oldLayerMap:r,generatedLayers:f}),d=this._finalizeOldLayers(r);return this._needsUpdate=!1,{error:h||d,generatedLayers:f}}},{key:"_updateSublayersRecursively",value:function(t){var e=t.newLayers,n=t.oldLayerMap,r=t.generatedLayers,o=null,a=!0,s=!1,u=void 0;try{for(var c,l=e[Symbol.iterator]();!(a=(c=l.next()).done);a=!0){var f=c.value;f.context=this.context;var h=n[f.id];null===h&&i.warn("Multiple new layers with same id ".concat(Cn(f)))(),n[f.id]=null;var d=null;try{this._debug&&h!==f&&f.validateProps(),h?(this._transferLayerState(h,f),this._updateLayer(f),Ht(f)):(this._initializeLayer(f),Xt(f)),r.push(f),d=f.isComposite&&f.getSubLayers()}catch(t){i.warn("error during matching of ".concat(Cn(f)),t)(),o=o||t}d&&this._updateSublayersRecursively({newLayers:d,oldLayerMap:n,generatedLayers:r})}}catch(t){s=!0,u=t}finally{try{a||null==l.return||l.return()}finally{if(s)throw u}}return o}},{key:"_finalizeOldLayers",value:function(t){var e=null;for(var n in t){var r=t[n];r&&(e=e||this._finalizeLayer(r))}return e}},{key:"_initializeLayer",value:function(t){i.log(2,"initializing ".concat(Cn(t)))();var e=null;try{t._initialize(),t.lifecycle=re}catch(n){i.warn("error while initializing ".concat(Cn(t),"\n"),n)(),e=e||n}t.internalState.layer=t;var n=!0,r=!1,o=void 0;try{for(var a,s=t.getModels()[Symbol.iterator]();!(n=(a=s.next()).done);n=!0)a.value.userData.layer=t}catch(t){r=!0,o=t}finally{try{n||null==s.return||s.return()}finally{if(r)throw o}}return e}},{key:"_transferLayerState",value:function(t,e){e._transferState(t),e.lifecycle=ne,e!==t?(i.log(4,"matched ".concat(Cn(e)),t,"->",e)(),t.lifecycle=ie):i.log(4,"Matching layer is unchanged ".concat(e.id))()}},{key:"_updateLayer",value:function(t){i.log(4,"updating ".concat(t," because: ").concat(t.printChangeFlags()))();var e=null;try{t._update()}catch(n){i.warn("error during update of ".concat(Cn(t)),n)(),e=n}return e}},{key:"_finalizeLayer",value:function(t){g(t.lifecycle!==oe),t.lifecycle=oe;var e=null;this.setNeedsRedraw("finalized ".concat(Cn(t)));try{t._finalize()}catch(n){i.warn("error during finalization of ".concat(Cn(t)),n)(),e=n}return t.lifecycle=ae,i.log(2,"finalizing ".concat(Cn(t)))(),e}},{key:"_initSeer",value:function(){this.layers.forEach((function(t){Xt(t),Ht(t)}))}},{key:"_editSeer",value:function(t){if("edit"===t.type&&"props"===t.valuePath[0]){var e,n,r;e=t.itemKey,n=t.valuePath.slice(1),r=t.value,ut.a.isReady()&&(Gt.has(e)||Gt.set(e,new Map),Gt.get(e).set(n,r));var i=this.layers.map((function(t){return new t.constructor(t.props)}));this.updateLayers({newLayers:i})}}}])&&On(e.prototype,n),r&&On(e,r),t}();function In(t,e){return t===e||Object.keys(t).every((function(n){return Array.isArray(t[n])&&Array.isArray(e[n])?In(t[n],e[n]):t[n]===e[n]}))}function An(t){return(An="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var Tn=/([0-9]+\.?[0-9]*)(%|px)/;function Nn(t){switch(An(t)){case"number":return{position:t,relative:!1};case"string":var e=t.match(Tn);if(e&&e.length>=3){var n="%"===e[2],r=parseFloat(e[1]);return{position:n?r/100:r,relative:n}}default:throw new Error("Could not parse position string ".concat(t))}}function Ln(t,e){return t.relative?Math.round(t.position*e):t.position}function Rn(t){return(Rn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function kn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function jn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Fn=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};kn(this,t);var n=e.id,r=void 0===n?null:n,i=e.x,o=void 0===i?0:i,a=e.y,s=void 0===a?0:a,u=e.width,c=void 0===u?"100%":u,l=e.height,f=void 0===l?"100%":l,h=e.projectionMatrix,d=void 0===h?null:h,p=e.fovy,v=void 0===p?75:p,y=e.near,m=void 0===y?.1:y,b=e.far,_=void 0===b?1e3:b,x=e.modelMatrix,w=void 0===x?null:x,E=e.viewportInstance,S=void 0===E?null:E,O=e.type,P=void 0===O?wn:O;g(!S||S instanceof wn),this.viewportInstance=S,this.id=r||this.constructor.displayName||"view",this.type=P,this.props=Object.assign({},e,{projectionMatrix:d,fovy:v,near:m,far:_,modelMatrix:w}),this._parseDimensions({x:o,y:s,width:c,height:f}),this.equals=this.equals.bind(this),Object.seal(this)}var e,n,r;return e=t,(n=[{key:"equals",value:function(t){return this===t||(this.viewportInstance?t.viewportInstance&&this.viewportInstance.equals(t.viewportInstance):In(this.props,t.props))}},{key:"makeViewport",value:function(t){var e=t.width,n=t.height,r=t.viewState;if(this.viewportInstance)return this.viewportInstance;r=this.filterViewState(r);var i=this.getDimensions({width:e,height:n}),o=Object.assign({viewState:r},r,this.props,i);return this._getViewport(o)}},{key:"getViewStateId",value:function(){switch(Rn(this.props.viewState)){case"string":return this.props.viewState;case"object":return this.props.viewState&&this.props.viewState.id;default:return this.id}}},{key:"filterViewState",value:function(t){if(this.props.viewState&&"object"===Rn(this.props.viewState)){if(!this.props.viewState.id)return this.props.viewState;var e=Object.assign({},t);for(var n in this.props.viewState)"id"!==n&&(e[n]=this.props.viewState[n]);return e}return t}},{key:"getDimensions",value:function(t){var e=t.width,n=t.height;return{x:Ln(this._x,e),y:Ln(this._y,n),width:Ln(this._width,e),height:Ln(this._height,n)}}},{key:"_getControllerProps",value:function(t){var e=this.props.controller;return e?!0===e?t:("function"==typeof e&&(e={type:e}),Object.assign({},t,e)):null}},{key:"_getViewport",value:function(t){return new(0,this.type)(t)}},{key:"_parseDimensions",value:function(t){var e=t.x,n=t.y,r=t.width,i=t.height;this._x=Nn(e),this._y=Nn(n),this._width=Nn(r),this._height=Nn(i)}}])&&jn(e.prototype,n),r&&jn(e,r),t}();function Dn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Bn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var zn=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Dn(this,t),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="Initial render",this._needsUpdate=!0,this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractiveStateChange:e.onInteractiveStateChange},Object.seal(this),this.setProps(e)}var e,n,r;return e=t,(n=[{key:"finalize",value:function(){for(var t in this.controllers)this.controllers[t]&&this.controllers[t].finalize();this.controllers={}}},{key:"needsRedraw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.clearRedrawFlags,n=void 0===e||e,r=this._needsRedraw;return n&&(this._needsRedraw=!1),r}},{key:"setNeedsRedraw",value:function(t){this._needsRedraw=this._needsRedraw||t}},{key:"setNeedsUpdate",value:function(t){this._needsUpdate=this._needsUpdate||t,this._needsRedraw=this._needsRedraw||t}},{key:"getViewports",value:function(t){return t?this._viewports.filter((function(e){return e.containsPixel(t)})):this._viewports}},{key:"getViews",value:function(){var t={};return this.views.forEach((function(e){t[e.id]=e})),t}},{key:"getView",value:function(t){return"string"==typeof t?this.views.find((function(e){return e.id===t})):t}},{key:"getViewState",value:function(t){var e=this.getView(t),n=e&&this.viewState[e.getViewStateId()]||this.viewState;return e?e.filterViewState(n):n}},{key:"getViewport",value:function(t){return this._viewportMap[t]}},{key:"project",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{topLeft:!0},n=this.getViewports(),r=n.length-1;r>=0;--r){var i=n[r];if(i.contains(t,e))return i.project(t,e)}return null}},{key:"unproject",value:function(t,e){for(var n=this.getViewports(),r=n.length-1;r>=0;--r){var i=n[r];if(i.containsPixel(t,e))return i.unproject(t)}return null}},{key:"setProps",value:function(t){"views"in t&&this._setViews(t.views),"viewState"in t&&this._setViewState(t.viewState),("width"in t||"height"in t)&&this._setSize(t.width,t.height),this._isUpdating||this._update()}},{key:"_update",value:function(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}},{key:"_setSize",value:function(t,e){g(Number.isFinite(t)&&Number.isFinite(e)),t===this.width&&e===this.height||(this.width=t,this.height=e,this.setNeedsUpdate("Size changed"))}},{key:"_setViews",value:function(t){t=nn(t,{filter:Boolean}).map((function(t){return t instanceof wn?new Fn({viewportInstance:t}):t})),this._diffViews(t,this.views)&&this.setNeedsUpdate("views changed"),this.views=t}},{key:"_setViewState",value:function(t){t?(!In(t,this.viewState)&&this.setNeedsUpdate("viewState changed"),this.viewState=t):i.warn("setting null viewState")()}},{key:"_onViewStateChange",value:function(t,e){e.viewId=t,this._eventCallbacks.onViewStateChange(e)}},{key:"_createController",value:function(t){return new(0,t.type)(Object.assign({eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,t.id),onStateChange:this._eventCallbacks.onInteractiveStateChange},t))}},{key:"_updateController",value:function(t,e,n,r){if(t.controller){var i=Object.assign({},t.controller,e,{id:t.id,x:n.x,y:n.y,width:n.width,height:n.height});return r?r.setProps(i):r=this._createController(i),r}return null}},{key:"_rebuildViewports",value:function(){var t=this,e=this.width,n=this.height,r=this.views,i=this.controllers;for(var o in this.controllers={},this._viewports=r.map((function(r){var o=t.getViewState(r),a=r.makeViewport({width:e,height:n,viewState:o});return t.controllers[r.id]=t._updateController(r,o,a,i[r.id]),a})),i)i[o]&&!this.controllers[o]&&i[o].finalize();this._buildViewportMap()}},{key:"_buildViewportMap",value:function(){var t=this;this._viewportMap={},this._viewports.forEach((function(e){e.id&&(t._viewportMap[e.id]=t._viewportMap[e.id]||e)}))}},{key:"_diffViews",value:function(t,e){return t.length!==e.length||t.some((function(n,r){return!t[r].equals(e[r])}))}}])&&Bn(e.prototype,n),r&&Bn(e,r),t}(),Vn=n(9),Gn=n(8),Un=n(10),Wn=n(17),qn=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Xn=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.width,i=n.height,o=n.latitude,a=void 0===o?0:o,s=n.longitude,u=void 0===s?0:s,c=n.zoom,l=void 0===c?0:c,f=n.pitch,h=void 0===f?0:f,d=n.bearing,p=void 0===d?0:d,g=n.altitude,v=void 0===g?1.5:g,y=n.nearZMultiplier,m=n.farZMultiplier;Object(an.a)(this,e),r=r||1,i=i||1;var b=V(l);v=Math.max(.75,v);var _=U([u,a],b);_[2]=0;var x=Z({width:r,height:i,pitch:h,bearing:p,altitude:v,nearZMultiplier:y||1/i,farZMultiplier:m||1.01}),w=H({height:i,center:_,pitch:h,bearing:p,altitude:v,flipY:!0});return(t=Object(Vn.a)(this,Object(Gn.a)(e).call(this,{width:r,height:i,viewMatrix:w,projectionMatrix:x}))).latitude=a,t.longitude=u,t.zoom=l,t.pitch=h,t.bearing=p,t.altitude=v,t.scale=b,t.center=_,t.pixelsPerMeter=q(Object(Wn.a)(Object(Wn.a)(t))).pixelsPerMeter[2],Object.freeze(Object(Wn.a)(Object(Wn.a)(t))),t}return Object(Un.a)(e,t),Object(sn.a)(e,[{key:"projectFlat",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale;return U(t,e)}},{key:"unprojectFlat",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale;return W(t,e)}},{key:"getMapCenterByLngLatPosition",value:function(t){var e=t.lngLat,n=J(t.pos,this.pixelUnprojectionMatrix),r=U(e,this.scale),i=k.a([],r,k.e([],n));return W(k.a([],this.center,i),this.scale)}},{key:"getLocationAtPoint",value:function(t){var e=t.lngLat,n=t.pos;return this.getMapCenterByLngLatPosition({lngLat:e,pos:n})}},{key:"fitBounds",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.width,i=this.height,o=Hn(Object.assign({width:r,height:i,bounds:t},n)),a=o.longitude,s=o.latitude,u=o.zoom;return new e({width:r,height:i,longitude:a,latitude:s,zoom:u})}}]),e}(function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.width,r=e.height,i=e.viewMatrix,o=void 0===i?qn:i,a=e.projectionMatrix,s=void 0===a?qn:a;Object(an.a)(this,t),this.width=n||1,this.height=r||1,this.scale=1,this.pixelsPerMeter=1,this.viewMatrix=o,this.projectionMatrix=s;var u=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];c.g(u,u,this.projectionMatrix),c.g(u,u,this.viewMatrix),this.viewProjectionMatrix=u;var l=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];c.n(l,l,[this.width/2,-this.height/2,1]),c.o(l,l,[1,-1,0]),c.g(l,l,this.viewProjectionMatrix);var f=c.e([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],l);if(!f)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=l,this.pixelUnprojectionMatrix=f,this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}return Object(sn.a)(t,[{key:"equals",value:function(e){return e instanceof t&&(e.width===this.width&&e.height===this.height&&c.b(e.projectionMatrix,this.projectionMatrix)&&c.b(e.viewMatrix,this.viewMatrix))}},{key:"project",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.topLeft,r=void 0===n||n,i=this.projectPosition(t),o=K(i,this.pixelProjectionMatrix),a=Object(T.a)(o,2),s=a[0],u=a[1],c=r?u:this.height-u;return 2===t.length?[s,c]:[s,c,o[2]]}},{key:"unproject",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.topLeft,r=void 0===n||n,i=e.targetZ,o=Object(T.a)(t,3),a=o[0],s=o[1],u=o[2],c=r?s:this.height-s,l=i&&i*this.pixelsPerMeter,f=J([a,c,u],this.pixelUnprojectionMatrix,l),h=this.unprojectPosition(f),d=Object(T.a)(h,3),p=d[0],g=d[1],v=d[2];return Number.isFinite(u)?[p,g,v]:Number.isFinite(i)?[p,g,i]:[p,g]}},{key:"projectPosition",value:function(t){var e=this.projectFlat(t),n=Object(T.a)(e,2);return[n[0],n[1],(t[2]||0)*this.pixelsPerMeter]}},{key:"unprojectPosition",value:function(t){var e=this.unprojectFlat(t),n=Object(T.a)(e,2);return[n[0],n[1],(t[2]||0)/this.pixelsPerMeter]}},{key:"projectFlat",value:function(t){arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale;return t}},{key:"unprojectFlat",value:function(t){arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale;return t}}]),t}());function Hn(t){var e=t.width,n=t.height,r=t.bounds,i=t.minExtent,o=void 0===i?0:i,a=t.maxZoom,s=void 0===a?24:a,u=t.padding,c=void 0===u?0:u,l=t.offset,f=void 0===l?[0,0]:l,h=Object(T.a)(r,2),d=Object(T.a)(h[0],2),p=d[0],g=d[1],v=Object(T.a)(h[1],2),y=v[0],m=v[1];if(Number.isFinite(c)){c={top:c,bottom:c,left:c,right:c}}else j(Number.isFinite(c.top)&&Number.isFinite(c.bottom)&&Number.isFinite(c.left)&&Number.isFinite(c.right));var b=new Xn({width:e,height:n,longitude:0,latitude:0,zoom:0}),_=b.project([p,m]),x=b.project([y,g]),w=[Math.max(Math.abs(x[0]-_[0]),o),Math.max(Math.abs(x[1]-_[1]),o)],E=[e-c.left-c.right-2*Math.abs(f[0]),n-c.top-c.bottom-2*Math.abs(f[1])];j(E[0]>0&&E[1]>0);var S=E[0]/w[0],O=E[1]/w[1],P=(c.right-c.left)/2/S,C=(c.bottom-c.top)/2/O,M=[(x[0]+_[0])/2+P,(x[1]+_[1])/2+C],I=b.unproject(M),A=b.zoom+Math.log2(Math.abs(Math.min(S,O)));return{longitude:I[0],latitude:I[1],zoom:Math.min(A,s)}}function Yn(t){return(Yn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Kn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Jn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Qn(t,e){return!e||"object"!==Yn(e)&&"function"!=typeof e?er(t):e}function $n(t){return($n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function tr(t,e){return(tr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function er(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var nr=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Kn(this,e);var r=n.latitude,i=void 0===r?0:r,o=n.longitude,a=void 0===o?0:o,s=n.zoom,u=void 0===s?11:s,c=n.pitch,l=void 0===c?0:c,f=n.bearing,h=void 0===f?0:f,d=n.nearZMultiplier,p=void 0===d?.1:d,g=n.farZMultiplier,v=void 0===g?10:g,y=n.orthographic,m=void 0!==y&&y,b=n.width,_=n.height,x=n.altitude,w=void 0===x?1.5:x,E=Y({width:b=b||1,height:_=_||1,pitch:l,altitude:w=Math.max(.75,w),nearZMultiplier:p,farZMultiplier:v}),S=E.fov,O=E.aspect,P=E.focalDistance,C=E.near,M=E.far,I=H({height:_,pitch:l,bearing:h,altitude:w}),A=n.position&&[n.position[0],n.position[1],0],T=Object.assign({},n,{width:b,height:_,viewMatrix:I,longitude:a,latitude:i,zoom:u,position:A,orthographic:m,fovyRadians:S,aspect:O,orthographicFocalDistance:P,near:C,far:M});return(t=Qn(this,$n(e).call(this,T))).latitude=i,t.longitude=a,t.zoom=u,t.pitch=l,t.bearing=h,t.altitude=w,t.orthographic=m,t.metersToLngLatDelta=t.metersToLngLatDelta.bind(er(er(t))),t.lngLatDeltaToMeters=t.lngLatDeltaToMeters.bind(er(er(t))),t.addMetersToLngLat=t.addMetersToLngLat.bind(er(er(t))),Object.freeze(er(er(t))),t}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&tr(t,e)}(e,t),n=e,(r=[{key:"metersToLngLatDelta",value:function(t){var e=Zn(t,3),n=e[0],r=e[1],i=e[2],o=void 0===i?0:i;g(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(o),"Illegal argument to WebMercatorViewport");var a=this.distanceScales,s=a.pixelsPerMeter,u=a.degreesPerPixel,c=n*s[0]*u[0],l=r*s[1]*u[1];return 2===t.length?[c,l]:[c,l,o]}},{key:"lngLatDeltaToMeters",value:function(t){var e=Zn(t,3),n=e[0],r=e[1],i=e[2],o=void 0===i?0:i;g(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(o),"Illegal argument to WebMercatorViewport");var a=this.distanceScales,s=a.pixelsPerDegree,u=a.metersPerPixel,c=n*s[0]*u[0],l=r*s[1]*u[1];return 2===t.length?[c,l]:[c,l,o]}},{key:"addMetersToLngLat",value:function(t,e){return X(t,e)}},{key:"getMapCenterByLngLatPosition",value:function(t){var e=t.lngLat,n=J(t.pos,this.pixelUnprojectionMatrix),r=this.projectFlat(e),i=k.a([],r,k.e([],n)),o=k.a([],this.center,i);return this.unprojectFlat(o)}},{key:"getLocationAtPoint",value:function(t){var e=t.lngLat,n=t.pos;return this.getMapCenterByLngLatPosition({lngLat:e,pos:n})}},{key:"fitBounds",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.width,i=this.height,o=Hn(Object.assign({width:r,height:i,bounds:t},n)),a=o.longitude,s=o.latitude,u=o.zoom;return new e({width:r,height:i,longitude:a,latitude:s,zoom:u})}}])&&Jn(n.prototype,r),i&&Jn(n,i),e}(wn);function rr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ir(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}nr.displayName="WebMercatorViewport";var or=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};rr(this,t),Array.isArray(e)&&(e={compare:e,extract:e,required:e});var n=e,r=n.compare,i=n.extract,o=n.required;this._propsToCompare=r,this._propsToExtract=i,this._requiredProps=o}var e,n,r;return e=t,(n=[{key:"arePropsEqual",value:function(t,e){var n=!0,r=!1,i=void 0;try{for(var o,a=(this._propsToCompare||Object.keys(e))[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;if(!Object(hn.e)(t[s],e[s]))return!1}}catch(t){r=!0,i=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return!0}},{key:"initializeProps",value:function(t,e){var n;if(this._propsToExtract){var r={},i={},o=!0,a=!1,s=void 0;try{for(var u,c=this._propsToExtract[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var l=u.value;r[l]=t[l],i[l]=e[l]}}catch(t){a=!0,s=t}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}n={start:r,end:i}}else n={start:t,end:e};return this._checkRequiredProps(n.start),this._checkRequiredProps(n.end),n}},{key:"interpolateProps",value:function(t,e,n){g(!1,"interpolateProps is not implemented")}},{key:"_checkRequiredProps",value:function(t){this._requiredProps&&this._requiredProps.forEach((function(e){var n=t[e];g(Number.isFinite(n)||Array.isArray(n),"".concat(e," is required for transition"))}))}}])&&ir(e.prototype,n),r&&ir(e,r),t}();function ar(t){return(ar="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function sr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ur(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function cr(t,e){return!e||"object"!==ar(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function lr(t){return(lr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function fr(t,e){return(fr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var hr=["longitude","latitude","zoom","bearing","pitch"],dr=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:hr;return sr(this,e),cr(this,lr(e).call(this,t))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&fr(t,e)}(e,t),n=e,(r=[{key:"interpolateProps",value:function(t,e,n){var r={};for(var i in e)r[i]=Object(hn.g)(t[i],e[i],n);return r}}])&&ur(n.prototype,r),i&&ur(n,i),e}(or);function pr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function gr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var vr=function(){},yr={BREAK:1,SNAP_TO_END:2,IGNORE:3},mr={transitionDuration:0,transitionEasing:function(t){return t},transitionInterpolator:new dr,transitionInterruption:yr.BREAK,onTransitionStart:vr,onTransitionInterrupt:vr,onTransitionEnd:vr},br=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};pr(this,t),g(e),this.ControllerState=e,this.props=Object.assign({},mr,n),this.animation=null,this.propsInTransition=null,this.transition=new At,this.onViewStateChange=n.onViewStateChange,this._onTransitionFrame=this._onTransitionFrame.bind(this),this._onTransitionUpdate=this._onTransitionUpdate.bind(this)}var e,n,r;return e=t,(n=[{key:"finalize",value:function(){cancelAnimationFrame(this.animation)}},{key:"getViewportInTransition",value:function(){return this.propsInTransition}},{key:"processViewStateChange",value:function(t){var e=!1,n=this.props;if(t=Object.assign({},mr,t),this.props=t,this._shouldIgnoreViewportChange(n,t))return e;if(this._isTransitionEnabled(t)){var r=Object.assign({},n,this.transition.interruption===yr.SNAP_TO_END?this.transition.endProps:this.propsInTransition||n);this._triggerTransition(r,t),e=!0}else this.transition.cancel();return e}},{key:"_isTransitionEnabled",value:function(t){return t.transitionDuration>0&&t.transitionInterpolator}},{key:"_isUpdateDueToCurrentTransition",value:function(t){return!!this.transition.inProgress&&this.transition.interpolator.arePropsEqual(t,this.propsInTransition)}},{key:"_shouldIgnoreViewportChange",value:function(t,e){return this.transition.inProgress?this.transition.interruption===yr.IGNORE||this._isUpdateDueToCurrentTransition(e):!this._isTransitionEnabled(e)||e.transitionInterpolator.arePropsEqual(t,e)}},{key:"_triggerTransition",value:function(t,e){g(this._isTransitionEnabled(e),"Transition is not enabled"),cancelAnimationFrame(this.animation);var n=new this.ControllerState(t),r=new this.ControllerState(e).shortestPathFrom(n),i=e.transitionInterpolator.initializeProps(t,r);this.propsInTransition={},this.transition.start({duration:e.transitionDuration,easing:e.transitionEasing,interpolator:e.transitionInterpolator,interruption:e.transitionInterruption,startProps:i.start,endProps:i.end,onStart:e.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(e.onTransitionInterrupt),onEnd:this._onTransitionEnd(e.onTransitionEnd)}),this._onTransitionFrame()}},{key:"_onTransitionFrame",value:function(){this.animation=requestAnimationFrame(this._onTransitionFrame),this.transition.update(Date.now())}},{key:"_onTransitionEnd",value:function(t){var e=this;return function(n){cancelAnimationFrame(e.animation),e.propsInTransition=null,t(n)}}},{key:"_onTransitionUpdate",value:function(t){var e=t.interpolator,n=t.startProps,r=t.endProps,i=t.time,o=e.interpolateProps(n,r,i);this.propsInTransition=new this.ControllerState(Object.assign({},this.props,o)).getViewportProps(),this.onViewStateChange&&this.onViewStateChange({viewState:this.propsInTransition,interactionState:{inTransition:!0}})}}])&&gr(e.prototype,n),r&&gr(e,r),t}();function _r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function xr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function wr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}br.defaultProps=mr;var Er={transitionDuration:0},Sr=["wheel"],Or=["panstart","panmove","panend"],Pr=["pinchstart","pinchmove","pinchend"],Cr=["doubletap"],Mr=["keydown"],Ir=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};xr(this,t),g(e),this.ControllerState=e,this.controllerState=null,this.controllerStateProps=null,this.eventManager=null,this.transitionManager=new br(e,n),this._events=null,this._state={isDragging:!1},this.events=[],this.onViewStateChange=null,this.onStateChange=null,this.invertPan=!1,this.handleEvent=this.handleEvent.bind(this),this.setProps(n)}var e,n,r;return e=t,(n=[{key:"finalize",value:function(){for(var t in this._events)this._events[t]&&this.eventManager.off(t,this.handleEvent);this.transitionManager.finalize()}},{key:"handleEvent",value:function(t){var e=this.ControllerState;switch(this.controllerState=new e(Object.assign({},this.controllerStateProps,this._state)),t.type){case"panstart":return this._onPanStart(t);case"panmove":return this._onPan(t);case"panend":return this._onPanEnd(t);case"pinchstart":return this._onPinchStart(t);case"pinchmove":return this._onPinch(t);case"pinchend":return this._onPinchEnd(t);case"doubletap":return this._onDoubleTap(t);case"wheel":return this._onWheel(t);case"keydown":return this._onKeyDown(t);default:return!1}}},{key:"getCenter",value:function(t){var e=this.controllerStateProps,n=e.x,r=e.y,i=t.offsetCenter;return[i.x-n,i.y-r]}},{key:"isPointInBounds",value:function(t){var e=this.controllerStateProps,n=e.width,r=e.height;return t[0]>=0&&t[0]<=n&&t[1]>=0&&t[1]<=r}},{key:"isFunctionKeyPressed",value:function(t){var e=t.srcEvent;return Boolean(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}},{key:"isDragging",value:function(){return this._state.isDragging}},{key:"setProps",value:function(t){"onViewportChange"in t&&i.removed("onViewportChange")(),"onViewStateChange"in t&&(this.onViewStateChange=t.onViewStateChange),"onStateChange"in t&&(this.onStateChange=t.onStateChange),this.controllerStateProps=t,"eventManager"in t&&this.eventManager!==t.eventManager&&(this.eventManager=t.eventManager,this._events={},this.toggleEvents(this.events,!0)),this.transitionManager.processViewStateChange(this.controllerStateProps);var e=t.scrollZoom,n=void 0===e||e,r=t.dragPan,o=void 0===r||r,a=t.dragRotate,s=void 0===a||a,u=t.doubleClickZoom,c=void 0===u||u,l=t.touchZoom,f=void 0===l||l,h=t.touchRotate,d=void 0!==h&&h,p=t.keyboard,g=void 0===p||p,v=Boolean(this.onViewStateChange);this.toggleEvents(Sr,v&&n),this.toggleEvents(Or,v&&(o||s)),this.toggleEvents(Pr,v&&(f||d)),this.toggleEvents(Cr,v&&c),this.toggleEvents(Mr,v&&g),this.scrollZoom=n,this.dragPan=o,this.dragRotate=s,this.doubleClickZoom=c,this.touchZoom=f,this.touchRotate=d,this.keyboard=g}},{key:"toggleEvents",value:function(t,e){var n=this;this.eventManager&&t.forEach((function(t){n._events[t]!==e&&(n._events[t]=e,e?n.eventManager.on(t,n.handleEvent):n.eventManager.off(t,n.handleEvent))}))}},{key:"setOptions",value:function(t){return this.setProps(t)}},{key:"updateViewport",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=Object.assign({},t.getViewportProps(),e),i=this.controllerState!==t;if(i){var o=this.controllerState?this.controllerState.getViewportProps():null;this.onViewStateChange&&this.onViewStateChange({viewState:r,interactionState:n,oldViewState:o})}Object.assign(this._state,Object.assign({},t.getInteractiveState(),n)),this.onStateChange&&this.onStateChange(this._state)}},{key:"_onPanStart",value:function(t){var e=this.getCenter(t);if(!this.isPointInBounds(e))return!1;var n=this.controllerState.panStart({pos:e}).rotateStart({pos:e});return this.updateViewport(n,Er,{isDragging:!0})}},{key:"_onPan",value:function(t){var e=this.isFunctionKeyPressed(t)||t.rightButton;return(e=this.invertPan?!e:e)?this._onPanMove(t):this._onPanRotate(t)}},{key:"_onPanEnd",value:function(t){var e=this.controllerState.panEnd().rotateEnd();return this.updateViewport(e,null,{isDragging:!1})}},{key:"_onPanMove",value:function(t){if(!this.dragPan)return!1;var e=this.getCenter(t);if(!this.isDragging())return!1;var n=this.controllerState.pan({pos:e});return this.updateViewport(n,Er,{isDragging:!0})}},{key:"_onPanRotate",value:function(t){return!!this.dragRotate&&this._onPanRotateStandard(t)}},{key:"_onPanRotateStandard",value:function(t){var e=t.deltaX,n=t.deltaY,r=this.controllerState.getViewportProps(),i=e/r.width,o=n/r.height,a=this.controllerState.rotate({deltaScaleX:i,deltaScaleY:o});return this.updateViewport(a,Er,{isDragging:!0})}},{key:"_onPanRotateMap",value:function(t){var e=t.deltaX,n=t.deltaY,r=_r(this.getCenter(t),2)[1],i=r-n,o=this.controllerState.getViewportProps(),a=o.width,s=o.height,u=e/a,c=0;n>0?Math.abs(s-i)>5&&(c=n/(i-s)*1.2):n<0&&i>5&&(c=1-r/i),c=Math.min(1,Math.max(-1,c));var l=this.controllerState.rotate({deltaScaleX:u,deltaScaleY:c});return this.updateViewport(l,Er,{isDragging:!0})}},{key:"_onWheel",value:function(t){if(!this.scrollZoom)return!1;t.preventDefault();var e=this.getCenter(t);if(!this.isPointInBounds(e))return!1;var n=t.delta,r=2/(1+Math.exp(-Math.abs(.01*n)));n<0&&0!==r&&(r=1/r);var i=this.controllerState.zoom({pos:e,scale:r});return this.updateViewport(i,Er)}},{key:"_onPinchStart",value:function(t){var e=this.getCenter(t);if(!this.isPointInBounds(e))return!1;var n=this.controllerState.zoomStart({pos:e}).rotateStart({pos:e});return this._state.startPinchRotation=t.rotation,this.updateViewport(n,Er,{isDragging:!0})}},{key:"_onPinch",value:function(t){if(!this.touchZoom&&!this.touchRotate)return!1;var e=this.controllerState;if(this.touchZoom){var n=t.scale,r=this.getCenter(t);e=e.zoom({pos:r,scale:n})}if(this.touchRotate){var i=t.rotation,o=this._state.startPinchRotation;e=e.rotate({deltaScaleX:-(i-o)/180})}return this.updateViewport(e,Er,{isDragging:!0})}},{key:"_onPinchEnd",value:function(t){var e=this.controllerState.zoomEnd().rotateEnd();return this._state.startPinchRotation=0,this.updateViewport(e,null,{isDragging:!1})}},{key:"_onDoubleTap",value:function(t){if(!this.doubleClickZoom)return!1;var e=this.getCenter(t);if(!this.isPointInBounds(e))return!1;var n=this.isFunctionKeyPressed(t),r=this.controllerState.zoom({pos:e,scale:n?.5:2});return this.updateViewport(r,this._getTransitionProps())}},{key:"_onKeyDown",value:function(t){if(!this.keyboard)return!1;var e,n=this.isFunctionKeyPressed(t),r=this.controllerState;switch(t.srcEvent.keyCode){case 189:e=n?r.zoomOut().zoomOut():r.zoomOut();break;case 187:e=n?r.zoomIn().zoomIn():r.zoomIn();break;case 37:e=n?r.rotateLeft():r.moveLeft();break;case 39:e=n?r.rotateRight():r.moveRight();break;case 38:e=n?r.rotateUp():r.moveUp();break;case 40:e=n?r.rotateDown():r.moveDown();break;default:return!1}return this.updateViewport(e,this._getTransitionProps())}},{key:"_getTransitionProps",value:function(){return Er}}])&&wr(e.prototype,n),r&&wr(e,r),t}(),Ar=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.phi,r=e.theta,i=e.radius,o=e.bearing,a=e.pitch,s=(e.altitude,e.radiusScale),u=void 0===s?6371e3:s;Object(an.a)(this,t),0===arguments.length?(this.phi=0,this.theta=0,this.radius=1):Number.isFinite(n)||Number.isFinite(r)?(this.phi=n||0,this.theta=r||0):(Number.isFinite(o)||Number.isFinite(a))&&(this.bearing=o||0,this.pitch=a||0),this.radius=i||1,this.radiusScale=u||1,this.check()}return Object(sn.a)(t,[{key:"toString",value:function(){return this.formatString(hn.c)}},{key:"formatString",value:function(t){var e=t.printTypes,n=(t.printDegrees,hn.f);return"".concat(e?"Spherical":"","[rho:").concat(n(this.radius),",theta:").concat(n(this.theta),",phi:").concat(n(this.phi),"]")}},{key:"equals",value:function(t){return Object(hn.e)(this.radius,t.radius)&&Object(hn.e)(this.theta,t.theta)&&Object(hn.e)(this.phi,t.phi)}},{key:"exactEquals",value:function(t){return this.radius===t.radius&&this.theta===t.theta&&this.phi===t.phi}},{key:"set",value:function(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this.check()}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this.check()}},{key:"fromLngLatZ",value:function(t){var e=Object(T.a)(t,3),n=e[0],r=e[1],i=e[2];this.radius=1+i/this.radiusScale,this.phi=Object(hn.h)(r),this.theta=Object(hn.h)(n)}},{key:"fromVector3",value:function(t){return this.radius=A.c(t),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t[0],t[1]),this.phi=Math.acos(Object(hn.b)(t[2]/this.radius,-1,1))),this.check()}},{key:"toVector3",value:function(){return new pn.a(0,0,this.radius).rotateX({radians:this.theta}).rotateZ({radians:this.phi})}},{key:"makeSafe",value:function(){this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi))}},{key:"check",value:function(){if(!(Number.isFinite(this.phi)&&Number.isFinite(this.theta)&&this.radius>0))throw new Error("SphericalCoordinates: some fields set to invalid numbers");return this}},{key:"bearing",get:function(){return 180-Object(hn.d)(this.phi)},set:function(t){this.phi=Math.PI-Object(hn.h)(t)}},{key:"pitch",get:function(){return Object(hn.d)(this.theta)},set:function(t){this.theta=Object(hn.h)(t)}},{key:"longitude",get:function(){return Object(hn.d)(this.phi)}},{key:"latitude",get:function(){return Object(hn.d)(this.theta)}},{key:"lng",get:function(){return Object(hn.d)(this.phi)}},{key:"lat",get:function(){return Object(hn.d)(this.theta)}},{key:"z",get:function(){return(this.radius-1)*this.radiusScale}}]),t}();function Tr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Nr={position:[0,0,0],lookAt:[0,0,0],up:[0,0,1],rotationX:0,rotationY:0,fov:50,near:1,far:100},Lr=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var n=e.width,r=e.height,i=e.position,o=void 0===i?Nr.position:i;g(Number.isFinite(n),"`width` must be supplied"),g(Number.isFinite(r),"`height` must be supplied"),this._viewportProps=this._applyConstraints(Object.assign({},e,{position:new pn.a(o)}))}var e,n,r;return e=t,(n=[{key:"getViewportProps",value:function(){return this._viewportProps}},{key:"getDirection",value:function(){return new Ar({bearing:this._viewportProps.bearing,pitch:this._viewportProps.pitch}).toVector3().normalize()}},{key:"getDirectionFromBearing",value:function(t){return new Ar({bearing:t,pitch:90}).toVector3().normalize()}},{key:"shortestPathFrom",value:function(t){return this._viewportProps}},{key:"_applyConstraints",value:function(t){return t}}])&&Tr(e.prototype,n),r&&Tr(e,r),t}();function Rr(t){return(Rr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function kr(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function jr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Fr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Dr(t,e,n){return e&&Fr(t.prototype,e),n&&Fr(t,n),t}function Br(t,e){return!e||"object"!==Rr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function zr(t){return(zr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Vr(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Gr(t,e)}function Gr(t,e){return(Gr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ur={transitionDuration:300,transitionEasing:function(t){return t},transitionInterpolator:new dr,transitionInterruption:yr.BREAK},Wr=0,qr=20,Xr=0,Hr=60,Yr=0,Zr=0,Kr=1.5,Jr=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.width,i=n.height,o=n.latitude,a=n.longitude,s=n.zoom,u=n.bearing,c=void 0===u?Zr:u,l=n.pitch,f=void 0===l?Yr:l,h=n.altitude,d=void 0===h?Kr:h,p=n.maxZoom,v=void 0===p?qr:p,y=n.minZoom,m=void 0===y?Wr:y,b=n.maxPitch,_=void 0===b?Hr:b,x=n.minPitch,w=void 0===x?Xr:x,E=n.startPanLngLat,S=n.startZoomLngLat,O=n.startBearing,P=n.startPitch,C=n.startZoom;return jr(this,e),g(Number.isFinite(a),"`longitude` must be supplied"),g(Number.isFinite(o),"`latitude` must be supplied"),g(Number.isFinite(s),"`zoom` must be supplied"),(t=Br(this,zr(e).call(this,{width:r,height:i,latitude:o,longitude:a,zoom:s,bearing:c,pitch:f,altitude:d,maxZoom:v,minZoom:m,maxPitch:_,minPitch:w})))._interactiveState={startPanLngLat:E,startZoomLngLat:S,startBearing:O,startPitch:P,startZoom:C},t}return Vr(e,t),Dr(e,[{key:"getViewportProps",value:function(){return this._viewportProps}},{key:"getInteractiveState",value:function(){return this._interactiveState}},{key:"panStart",value:function(t){var e=t.pos;return this._getUpdatedState({startPanLngLat:this._unproject(e)})}},{key:"pan",value:function(t){var e=t.pos,n=t.startPos,r=this._interactiveState.startPanLngLat||this._unproject(n);if(!r)return this;var i=kr(this._calculateNewLngLat({startPanLngLat:r,pos:e}),2),o=i[0],a=i[1];return this._getUpdatedState({longitude:o,latitude:a})}},{key:"panEnd",value:function(){return this._getUpdatedState({startPanLngLat:null})}},{key:"rotateStart",value:function(t){t.pos;return this._getUpdatedState({startBearing:this._viewportProps.bearing,startPitch:this._viewportProps.pitch})}},{key:"rotate",value:function(t){var e=t.deltaScaleX,n=void 0===e?0:e,r=t.deltaScaleY,i=void 0===r?0:r,o=this._interactiveState,a=o.startBearing,s=o.startPitch;if(!Number.isFinite(a)||!Number.isFinite(s))return this;var u=this._calculateNewPitchAndBearing({deltaScaleX:n,deltaScaleY:i,startBearing:a,startPitch:s}),c=u.pitch,l=u.bearing;return this._getUpdatedState({bearing:l,pitch:c})}},{key:"rotateEnd",value:function(){return this._getUpdatedState({startBearing:null,startPitch:null})}},{key:"zoomStart",value:function(t){var e=t.pos;return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this._viewportProps.zoom})}},{key:"zoom",value:function(t){var e=t.pos,n=t.startPos,r=t.scale;g(r>0,"`scale` must be a positive number");var i=this._interactiveState,o=i.startZoom,a=i.startZoomLngLat;Number.isFinite(o)||(o=this._viewportProps.zoom,a=this._unproject(n)||this._unproject(e)),g(a,"`startZoomLngLat` prop is required for zoom behavior to calculate where to position the map.");var s=this._calculateNewZoom({scale:r,startZoom:o}),u=kr(new Xn(Object.assign({},this._viewportProps,{zoom:s})).getLocationAtPoint({lngLat:a,pos:e}),2),c=u[0],l=u[1];return this._getUpdatedState({zoom:s,longitude:c,latitude:l})}},{key:"zoomEnd",value:function(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}},{key:"zoomIn",value:function(){return this._zoomFromCenter(2)}},{key:"zoomOut",value:function(){return this._zoomFromCenter(.5)}},{key:"moveLeft",value:function(){return this._panFromCenter([100,0])}},{key:"moveRight",value:function(){return this._panFromCenter([-100,0])}},{key:"moveUp",value:function(){return this._panFromCenter([0,100])}},{key:"moveDown",value:function(){return this._panFromCenter([0,-100])}},{key:"rotateLeft",value:function(){return this._getUpdatedState({bearing:this._viewportProps.bearing-15})}},{key:"rotateRight",value:function(){return this._getUpdatedState({bearing:this._viewportProps.bearing+15})}},{key:"rotateUp",value:function(){return this._getUpdatedState({pitch:this._viewportProps.pitch+10})}},{key:"rotateDown",value:function(){return this._getUpdatedState({pitch:this._viewportProps.pitch-10})}},{key:"shortestPathFrom",value:function(t){var e=t.getViewportProps(),n=Object.assign({},this._viewportProps),r=n.bearing,i=n.longitude;return Math.abs(r-e.bearing)>180&&(n.bearing=r<0?r+360:r-360),Math.abs(i-e.longitude)>180&&(n.longitude=i<0?i+360:i-360),n}},{key:"_zoomFromCenter",value:function(t){var e=this._viewportProps,n=e.width,r=e.height;return this.zoom({pos:[n/2,r/2],scale:t})}},{key:"_panFromCenter",value:function(t){var e=this._viewportProps,n=e.width,r=e.height;return this.pan({startPos:[n/2,r/2],pos:[n/2+t[0],r/2+t[1]]})}},{key:"_getUpdatedState",value:function(t){return new e(Object.assign({},this._viewportProps,this._interactiveState,t))}},{key:"_applyConstraints",value:function(t){var e=t.maxZoom,n=t.minZoom,r=t.zoom;t.zoom=Object(hn.b)(r,n,e);var i=t.maxPitch,o=t.minPitch,a=t.pitch;return t.pitch=Object(hn.b)(a,o,i),Object.assign(t,function(t){var e=t.width,n=t.height,r=t.longitude,i=t.latitude,o=t.zoom,a=t.pitch,s=void 0===a?0:a,u=t.bearing,c=void 0===u?0:u;(r<-180||r>180)&&(r=L(r+180,360)-180),(c<-180||c>180)&&(c=L(c+180,360)-180);var l=new Xn({width:e,height:n,longitude:r,latitude:i,zoom:o}),f=l.project([r,85.05113])[1],h=l.project([r,-85.05113])[1],d=0;return h-f<n&&(o+=Math.log2(n/(h-f)),f=(l=new Xn({width:e,height:n,longitude:r,latitude:i,zoom:o})).project([r,85.05113])[1],h=l.project([r,-85.05113])[1]),f>0?d=f:h<n&&(d=h-n),d&&(i=l.unproject([e/2,n/2+d])[1]),{width:e,height:n,longitude:r,latitude:i,zoom:o,pitch:s,bearing:c}}(t)),t}},{key:"_unproject",value:function(t){var e=new Xn(this._viewportProps);return t&&e.unproject(t)}},{key:"_calculateNewLngLat",value:function(t){var e=t.startPanLngLat,n=t.pos;return new Xn(this._viewportProps).getMapCenterByLngLatPosition({lngLat:e,pos:n})}},{key:"_calculateNewZoom",value:function(t){var e=t.scale,n=t.startZoom,r=this._viewportProps,i=r.maxZoom,o=r.minZoom,a=n+Math.log2(e);return Object(hn.b)(a,o,i)}},{key:"_calculateNewPitchAndBearing",value:function(t){var e=t.deltaScaleX,n=t.deltaScaleY,r=t.startBearing,i=t.startPitch;n=Object(hn.b)(n,-1,1);var o=this._viewportProps,a=o.minPitch,s=o.maxPitch,u=i;return n>0?u=i+n*(s-i):n<0&&(u=i-n*(a-i)),{pitch:u,bearing:r+180*e}}}]),e}(Lr),Qr=function(t){function e(t){var n;return jr(this,e),(n=Br(this,zr(e).call(this,Jr,t))).invertPan=!0,n}return Vr(e,t),Dr(e,[{key:"_getTransitionProps",value:function(){return Ur}},{key:"_onPanRotate",value:function(t){return!!this.dragRotate&&this._onPanRotateMap(t)}}]),e}(Ir);function $r(t){return($r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ti(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ei(t,e){return!e||"object"!==$r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ni(t){return(ni=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ri(t,e){return(ri=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ii=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),ei(this,ni(e).call(this,Object.assign({},t,{type:nr})))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ri(t,e)}(e,t),n=e,(r=[{key:"controller",get:function(){return this._getControllerProps({type:Qr})}}])&&ti(n.prototype,r),i&&ti(n,i),e}(Fn);function oi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}ii.displayName="MapView";var ai=function(){function t(e){var n=e.gl,r=e.layerManager;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.gl=n,this.layerManager=r,this._effects=[]}var e,n,r;return e=t,(n=[{key:"addEffect",value:function(t){this._effects.push(t),this._sortEffects(),t.initialize({gl:this.gl,layerManager:this.layerManager})}},{key:"removeEffect",value:function(t){var e=this._effects.indexOf(t);return e>=0&&(t.finalize({gl:this.gl,layerManager:this.layerManager}),this._effects.splice(e,1),!0)}},{key:"preDraw",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=this._effects[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var o=r.value;o.needsRedraw&&o.preDraw({gl:this.gl,layerManager:this.layerManager})}}catch(t){e=!0,n=t}finally{try{t||null==i.return||i.return()}finally{if(e)throw n}}}},{key:"draw",value:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=this._effects[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var o=r.value;o.needsRedraw&&o.draw({gl:this.gl,layerManager:this.layerManager})}}catch(t){e=!0,n=t}finally{try{t||null==i.return||i.return()}finally{if(e)throw n}}}},{key:"_sortEffects",value:function(){this._effects.sort((function(t,e){return t.priority>e.priority?-1:t.priority<e.priority?1:t.count-e.count}))}}])&&oi(e.prototype,n),r&&oi(e,r),t}();function si(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ui,ci,li=0,fi=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id="effect",this.count=li++,this.visible=!0,this.priority=0,this.needsRedraw=!1}var e,n,r;return e=t,(n=[{key:"initialize",value:function(t){t.gl,t.layerManager}},{key:"finalize",value:function(t){t.gl,t.layerManager}},{key:"preDraw",value:function(t){t.gl,t.layerManager}},{key:"draw",value:function(t){t.gl,t.layerManager}},{key:"setNeedsRedraw",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.needsRedraw=t}}])&&si(e.prototype,n),r&&si(e,r),t}(),hi=n(106),di=n.n(hi),pi={mousedown:1,mousemove:2,mouseup:4};ui=di.a.PointerEventInput,ci=ui.prototype.handler,ui.prototype.handler=function(t){var e=this.store;t.button>0&&(function(t,e){for(var n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}(e,(function(e){return e.pointerId===t.pointerId}))||e.push(t)),ci.call(this,t)},di.a.MouseInput.prototype.handler=function(t){var e=pi[t.type];1&e&&t.button>=0&&(this.pressed=!0),2&e&&0===t.which&&(e=4),this.pressed&&(4&e&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))};var gi=di.a.Manager,vi=di.a,yi=vi?[[vi.Rotate,{enable:!1}],[vi.Pinch,{enable:!1}],[vi.Swipe,{enable:!1}],[vi.Pan,{threshold:0,enable:!1}],[vi.Press,{enable:!1}],[vi.Tap,{event:"doubletap",taps:2,enable:!1}],[vi.Tap,{event:"anytap",enable:!1}],[vi.Tap,{enable:!1}]]:null,mi={rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},bi={doubletap:["tap"]},_i={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},xi=["keydown","keyup"],wi=["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],Ei=["wheel","mousewheel","DOMMouseScroll"],Si={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},Oi={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},Pi=n(76),Ci=-1!==Pi.b.indexOf("firefox"),Mi=Ei,Ii=function(){function t(e,n){var r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(an.a)(this,t),this.element=e,this.callback=n,this.options=Object.assign({enable:!0},i),this.events=Mi.concat(i.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach((function(t){return e.addEventListener(t,r.handleEvent,!!Pi.a&&{passive:!1})}))}return Object(sn.a)(t,[{key:"destroy",value:function(){var t=this;this.events.forEach((function(e){return t.element.removeEventListener(e,t.handleEvent)}))}},{key:"enableEventType",value:function(t,e){"wheel"===t&&(this.options.enable=e)}},{key:"handleEvent",value:function(t){if(this.options.enable){var e=t.deltaY;Pi.c.WheelEvent&&(Ci&&t.deltaMode===Pi.c.WheelEvent.DOM_DELTA_PIXEL&&(e/=Pi.c.devicePixelRatio),t.deltaMode===Pi.c.WheelEvent.DOM_DELTA_LINE&&(e*=40));var n={x:t.clientX,y:t.clientY};0!==e&&e%4.000244140625==0&&(e=Math.floor(e/4.000244140625)),t.shiftKey&&e&&(e*=.25),this._onWheel(t,-e,n)}}},{key:"_onWheel",value:function(t,e,n){this.callback({type:"wheel",center:n,delta:e,srcEvent:t,pointerType:"mouse",target:t.target})}}]),t}(),Ai=wi,Ti=function(){function t(e,n){var r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(an.a)(this,t),this.element=e,this.callback=n,this.pressed=!1,this.options=Object.assign({enable:!0},i),this.enableMoveEvent=this.options.enable,this.enableLeaveEvent=this.options.enable,this.enableOutEvent=this.options.enable,this.enableOverEvent=this.options.enable,this.events=Ai.concat(i.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach((function(t){return e.addEventListener(t,r.handleEvent)}))}return Object(sn.a)(t,[{key:"destroy",value:function(){var t=this;this.events.forEach((function(e){return t.element.removeEventListener(e,t.handleEvent)}))}},{key:"enableEventType",value:function(t,e){"pointermove"===t&&(this.enableMoveEvent=e),"pointerover"===t&&(this.enableOverEvent=e),"pointerout"===t&&(this.enableOutEvent=e),"pointerleave"===t&&(this.enableLeaveEvent=e)}},{key:"handleEvent",value:function(t){this.handleOverEvent(t),this.handleOutEvent(t),this.handleLeaveEvent(t),this.handleMoveEvent(t)}},{key:"handleOverEvent",value:function(t){this.enableOverEvent&&"mouseover"===t.type&&this.callback({type:"pointerover",srcEvent:t,pointerType:"mouse",target:t.target})}},{key:"handleOutEvent",value:function(t){this.enableOutEvent&&"mouseout"===t.type&&this.callback({type:"pointerout",srcEvent:t,pointerType:"mouse",target:t.target})}},{key:"handleLeaveEvent",value:function(t){this.enableLeaveEvent&&"mouseleave"===t.type&&this.callback({type:"pointerleave",srcEvent:t,pointerType:"mouse",target:t.target})}},{key:"handleMoveEvent",value:function(t){if(this.enableMoveEvent)switch(t.type){case"mousedown":t.button>=0&&(this.pressed=!0);break;case"mousemove":0===t.which&&(this.pressed=!1),this.pressed||this.callback({type:"pointermove",srcEvent:t,pointerType:"mouse",target:t.target});break;case"mouseup":this.pressed=!1}}}]),t}(),Ni=xi,Li=function(){function t(e,n){var r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(an.a)(this,t),this.element=e,this.callback=n,this.options=Object.assign({enable:!0},i),this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=Ni.concat(i.events||[]),this.handleEvent=this.handleEvent.bind(this),e.tabIndex=i.tabIndex||0,e.style.outline="none",this.events.forEach((function(t){return e.addEventListener(t,r.handleEvent)}))}return Object(sn.a)(t,[{key:"destroy",value:function(){var t=this;this.events.forEach((function(e){return t.element.removeEventListener(e,t.handleEvent)}))}},{key:"enableEventType",value:function(t,e){"keydown"===t&&(this.enableDownEvent=e),"keyup"===t&&(this.enableUpEvent=e)}},{key:"handleEvent",value:function(t){var e=t.target||t.srcElement;"INPUT"===e.tagName&&"text"===e.type||"TEXTAREA"===e.tagName||(this.enableDownEvent&&"keydown"===t.type&&this.callback({type:"keydown",srcEvent:t,key:t.key,target:t.target}),this.enableUpEvent&&"keyup"===t.type&&this.callback({type:"keyup",srcEvent:t,key:t.key,target:t.target}))}}]),t}(),Ri=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(an.a)(this,t),this.element=e,this.callback=n,this.options=Object.assign({enable:!0},r),this.handleEvent=this.handleEvent.bind(this),e.addEventListener("contextmenu",this.handleEvent)}return Object(sn.a)(t,[{key:"destroy",value:function(){this.element.removeEventListener("contextmenu",this.handleEvent)}},{key:"enableEventType",value:function(t,e){"contextmenu"===t&&(this.options.enable=e)}},{key:"handleEvent",value:function(t){this.options.enable&&this.callback({type:"contextmenu",center:{x:t.clientX,y:t.clientY},srcEvent:t,pointerType:"mouse",target:t.target})}}]),t}(),ki=n(22),ji={pointerdown:1,pointermove:2,pointerup:4,mousedown:1,mousemove:2,mouseup:4};var Fi={srcElement:"root",priority:0},Di=function(){function t(e){Object(an.a)(this,t),this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this.handleEvent=this.handleEvent.bind(this),this._active=!1}return Object(sn.a)(t,[{key:"isEmpty",value:function(){return!this._active}},{key:"add",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=this.handlers,a=this.handlersByElement;n&&("object"!==Object(ki.a)(n)||n.addEventListener)&&(n={srcElement:n}),n=n?Object.assign({},Fi,n):Fi;var s=a.get(n.srcElement);s||(s=[],a.set(n.srcElement,s));var u={type:t,handler:e,srcElement:n.srcElement,priority:n.priority};r&&(u.once=!0),i&&(u.passive=!0),o.push(u),this._active=this._active||!u.passive;for(var c=s.length-1;c>=0&&!(s[c].priority>=u.priority);)c--;s.splice(c+1,0,u)}},{key:"remove",value:function(t,e){for(var n=this.handlers,r=this.handlersByElement,i=n.length-1;i>=0;i--){var o=n[i];if(o.type===t&&o.handler===e){n.splice(i,1);var a=r.get(o.srcElement);a.splice(a.indexOf(o),1),0===a.length&&r.delete(o.srcElement)}}this._active=n.some((function(t){return!t.passive}))}},{key:"handleEvent",value:function(t){if(!this.isEmpty()){for(var e=this._normalizeEvent(t),n=t.srcEvent.target;n&&n!==e.rootElement;){if(this._emit(e,n),e.handled)return;n=n.parentNode}this._emit(e,"root")}}},{key:"_emit",value:function(t,e){var n=this.handlersByElement.get(e);if(n){for(var r=!1,i=function(){t.handled=!0},o=function(){t.handled=!0,r=!0},a=[],s=0;s<n.length;s++){var u=n[s],c=u.type,l=u.handler,f=u.once;if(l(Object.assign({},t,{type:c,stopPropagation:i,stopImmediatePropagation:o})),f&&a.push(n[s]),r)break}for(var h=0;h<a.length;h++){var d=a[h];c=d.type,l=d.handler;this.remove(c,l)}}}},{key:"_normalizeEvent",value:function(t){var e=this.eventManager.element;return Object.assign({},t,function(t){var e=ji[t.srcEvent.type];if(!e)return null;var n=t.srcEvent,r=n.buttons,i=n.button,o=n.which,a=!1,s=!1,u=!1;return 4===e||2===e&&!Number.isFinite(r)?(a=1===o,s=2===o,u=3===o):2===e?(a=Boolean(1&r),s=Boolean(4&r),u=Boolean(2&r)):1===e&&(a=0===i,s=1===i,u=2===i),{leftButton:a,middleButton:s,rightButton:u}}(t),function(t,e){var n=t.srcEvent;if(!t.center&&!Number.isFinite(n.clientX))return null;var r=t.center||{x:n.clientX,y:n.clientY},i=e.getBoundingClientRect(),o=i.width/e.offsetWidth,a=i.height/e.offsetHeight;return{center:r,offsetCenter:{x:(r.x-i.left-e.clientLeft)/o,y:(r.y-i.top-e.clientTop)/a}}}(t,e),{handled:!1,rootElement:e})}}]),t}(),Bi={events:null,recognizers:null,recognizerOptions:{},Manager:gi,touchAction:"none",tabIndex:0},zi=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(an.a)(this,t),this.options=Object.assign({},Bi,n),this.events=new Map,this._onBasicInput=this._onBasicInput.bind(this),this._onOtherEvent=this._onOtherEvent.bind(this),this.setElement(e);var r=n.events;r&&this.on(r)}return Object(sn.a)(t,[{key:"setElement",value:function(t){var e=this;if(this.element&&this.destroy(),this.element=t,t){var n=this.options,r=n.Manager;for(var i in this.manager=new r(t,{touchAction:n.touchAction,recognizers:n.recognizers||yi}).on("hammer.input",this._onBasicInput),n.recognizers||Object.keys(mi).forEach((function(t){var n=e.manager.get(t);n&&mi[t].forEach((function(t){n.recognizeWith(t)}))})),n.recognizerOptions){var o=this.manager.get(i);if(o){var a=n.recognizerOptions[i];delete a.enable,o.set(a)}}this.wheelInput=new Ii(t,this._onOtherEvent,{enable:!1}),this.moveInput=new Ti(t,this._onOtherEvent,{enable:!1}),this.keyInput=new Li(t,this._onOtherEvent,{enable:!1,tabIndex:n.tabIndex}),this.contextmenuInput=new Ri(t,this._onOtherEvent,{enable:!1});var s=!0,u=!1,c=void 0;try{for(var l,f=this.events[Symbol.iterator]();!(s=(l=f.next()).done);s=!0){var h=Object(T.a)(l.value,2),d=h[0],p=h[1];p.isEmpty()||(this._toggleRecognizer(p.recognizerName,!0),this.manager.on(d,p.handleEvent))}}catch(t){u=!0,c=t}finally{try{s||null==f.return||f.return()}finally{if(u)throw c}}}}},{key:"destroy",value:function(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}},{key:"on",value:function(t,e,n){this._addEventHandler(t,e,n,!1)}},{key:"once",value:function(t,e,n){this._addEventHandler(t,e,n,!0)}},{key:"watch",value:function(t,e,n){this._addEventHandler(t,e,n,!1,!0)}},{key:"off",value:function(t,e){this._removeEventHandler(t,e)}},{key:"_toggleRecognizer",value:function(t,e){var n=this.manager;if(n){var r=n.get(t);if(r&&r.options.enable!==e){r.set({enable:e});var i=bi[t];i&&!this.options.recognizers&&i.forEach((function(i){var o=n.get(i);e?(o.requireFailure(t),r.dropRequireFailure(i)):o.dropRequireFailure(t)}))}this.wheelInput.enableEventType(t,e),this.moveInput.enableEventType(t,e),this.keyInput.enableEventType(t,e),this.contextmenuInput.enableEventType(t,e)}}},{key:"_addEventHandler",value:function(t,e,n,r,i){if("string"==typeof t){var o=this.manager,a=this.events,s=Oi[t]||t,u=a.get(s);u||(u=new Di(this),a.set(s,u),u.recognizerName=Si[s]||s,o&&o.on(s,u.handleEvent)),u.add(t,e,n,r,i),u.isEmpty()||this._toggleRecognizer(u.recognizerName,!0)}else for(var c in n=e,t)this._addEventHandler(c,t[c],n,r,i)}},{key:"_removeEventHandler",value:function(t,e){if("string"==typeof t){var n=this.events,r=Oi[t]||t,i=n.get(r);if(i&&(i.remove(t,e),i.isEmpty())){var o=i.recognizerName,a=!1,s=!0,u=!1,c=void 0;try{for(var l,f=n.values()[Symbol.iterator]();!(s=(l=f.next()).done);s=!0){var h=l.value;if(h.recognizerName===o&&!h.isEmpty()){a=!0;break}}}catch(t){u=!0,c=t}finally{try{s||null==f.return||f.return()}finally{if(u)throw c}}a||this._toggleRecognizer(o,!1)}}else for(var d in t)this._removeEventHandler(d,t[d])}},{key:"_onBasicInput",value:function(t){var e=t.srcEvent,n=_i[e.type];n&&this.manager.emit(n,t)}},{key:"_onOtherEvent",value:function(t){this.manager.emit(t.type,t)}}]),t}();function Vi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Gi(){}var Ui={id:"deckgl-overlay",width:"100%",height:"100%",pickingRadius:0,layerFilter:null,glOptions:{},gl:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,_animate:!1,onWebGLInitialized:Gi,onResize:Gi,onViewStateChange:Gi,onBeforeRender:Gi,onAfterRender:Gi,onLayerClick:null,onLayerHover:null,onLoad:Gi,_onMetrics:null,getCursor:function(t){return t.isDragging?"grabbing":"grab"},debug:!1,drawPickingColors:!1},Wi=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=Object.assign({},Ui,e),this.width=0,this.height=0,this.viewManager=null,this.layerManager=null,this.effectManager=null,this.stats=new ln({id:"deck.gl"}),this._needsRedraw=!0,this.viewState=e.initialViewState||null,this.interactiveState={isDragging:!1},this._onEvent=this._onEvent.bind(this),this._onClick=this._onClick.bind(this),this._onPointerMove=this._onPointerMove.bind(this),this._onPointerLeave=this._onPointerLeave.bind(this),this._pickAndCallback=this._pickAndCallback.bind(this),this._onRendererInitialized=this._onRendererInitialized.bind(this),this._onRenderFrame=this._onRenderFrame.bind(this),this._onViewStateChange=this._onViewStateChange.bind(this),this._onInteractiveStateChange=this._onInteractiveStateChange.bind(this),e.gl||"undefined"!=typeof document&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.setProps(e),this.animationLoop.start()}var e,n,r;return e=t,(n=[{key:"finalize",value:function(){this.animationLoop.stop(),this.animationLoop=null,this.layerManager&&(this.layerManager.finalize(),this.layerManager=null),this.viewManager&&(this.viewManager.finalize(),this.viewManager=null),this.eventManager&&this.eventManager.destroy()}},{key:"setProps",value:function(t){this.stats.timeStart("deck.setProps"),t=Object.assign({},this.props,t),this.props=t,this._setCanvasSize(t);var e=Object.assign({},t,{views:this._getViews(t),width:this.width,height:this.height}),n=this._getViewState(t);n&&(e.viewState=n),this.viewManager&&this.viewManager.setProps(e),this.layerManager&&this.layerManager.setProps(e),this.animationLoop&&this.animationLoop.setProps(e),this.stats.timeEnd("deck.setProps")}},{key:"needsRedraw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.clearRedrawFlags,n=void 0===e||e;if(this.props._animate)return"Deck._animate";var r=this._needsRedraw;n&&(this._needsRedraw=!1);var i=this.viewManager.needsRedraw({clearRedrawFlags:n}),o=this.layerManager.needsRedraw({clearRedrawFlags:n});return r=r||i||o}},{key:"getViews",value:function(){return this.viewManager.views}},{key:"getViewports",value:function(t){return this.viewManager.getViewports(t)}},{key:"pickObject",value:function(t){var e=t.x,n=t.y,r=t.radius,i=void 0===r?0:r,o=t.layerIds,a=void 0===o?null:o;this.stats.timeStart("deck.pickObject");var s=this.layerManager.pickObject({x:e,y:n,radius:i,layerIds:a,viewports:this.getViewports({x:e,y:n}),mode:"query",depth:1});return this.stats.timeEnd("deck.pickObject"),s.length?s[0]:null}},{key:"pickMultipleObjects",value:function(t){var e=t.x,n=t.y,r=t.radius,i=void 0===r?0:r,o=t.layerIds,a=void 0===o?null:o,s=t.depth,u=void 0===s?10:s;this.stats.timeStart("deck.pickMultipleObjects");var c=this.layerManager.pickObject({x:e,y:n,radius:i,layerIds:a,viewports:this.getViewports({x:e,y:n}),mode:"query",depth:u});return this.stats.timeEnd("deck.pickMultipleObjects"),c}},{key:"pickObjects",value:function(t){var e=t.x,n=t.y,r=t.width,i=void 0===r?1:r,o=t.height,a=void 0===o?1:o,s=t.layerIds,u=void 0===s?null:s;this.stats.timeStart("deck.pickObjects");var c=this.layerManager.pickObjects({x:e,y:n,width:i,height:a,layerIds:u,viewports:this.getViewports({x:e,y:n,width:i,height:a})});return this.stats.timeEnd("deck.pickObjects"),c}},{key:"_createCanvas",value:function(t){var e=t.canvas;"string"==typeof e&&g(e=document.getElementById(e)),e||(e=document.createElement("canvas"),(t.parent||document.body).appendChild(e));var n=t.id,r=t.style;return e.id=n,Object.assign(e.style,r),e}},{key:"_setCanvasSize",value:function(t){if(this.canvas){var e=t.width,n=t.height;(e||0===e)&&(e=Number.isFinite(e)?"".concat(e,"px"):e,this.canvas.style.width=e),(n||0===n)&&(n=Number.isFinite(n)?"".concat(n,"px"):n,this.canvas.style.position="absolute",this.canvas.style.height=n)}}},{key:"_updateCanvasSize",value:function(){if(this._checkForCanvasSizeChange()){var t=this.width,e=this.height;this.viewManager.setProps({width:t,height:e}),this.props.onResize({width:this.width,height:this.height})}}},{key:"_checkForCanvasSizeChange",value:function(){var t=this.canvas;if(!t)return!1;var e=t.clientWidth||t.width,n=t.clientHeight||t.height;return(e!==this.width||n!==this.height)&&(this.width=e,this.height=n,!0)}},{key:"_createAnimationLoop",value:function(t){var e=this,n=t.width,r=t.height,i=t.gl,a=t.glOptions,s=t.debug,u=t.useDevicePixels,c=t.autoResizeDrawingBuffer;return new o.AnimationLoop({width:n,height:r,useDevicePixels:u,autoResizeDrawingBuffer:c,onCreateContext:function(t){return i||Object(o.createGLContext)(Object.assign({},a,t,{canvas:e.canvas,debug:s}))},onInitialize:this._onRendererInitialized,onRender:this._onRenderFrame,onBeforeRender:t.onBeforeRender,onAfterRender:t.onAfterRender})}},{key:"_getViewState",value:function(t){return t.viewState||this.viewState}},{key:"_getViews",value:function(t){var e=t.views||[new ii({id:"default-view"})];return(e=Array.isArray(e)?e:[e]).length&&t.controller&&(e[0].props.controller=t.controller),e}},{key:"_pickAndCallback",value:function(t){var e=t.event.offsetCenter;if(e){var n=this.props.pickingRadius,r=this.layerManager.pickObject({x:e.x,y:e.y,radius:n,viewports:this.getViewports(e),mode:t.mode,depth:1,event:t.event});if(t.callback&&r){var i=r.find((function(t){return t.index>=0}))||null;t.callback(i,r,t.event.srcEvent)}}}},{key:"_updateCursor",value:function(){this.canvas&&(this.canvas.style.cursor=this.props.getCursor(this.interactiveState))}},{key:"_updateAnimationProps",value:function(t){this.layerManager.context.animationProps=t}},{key:"_setGLContext",value:function(t){if(!this.layerManager){if(this.canvas||(this.canvas=t.canvas,Object(o.trackContextState)(t,{enable:!0,copyState:!0})),Object(o.setParameters)(t,{blend:!0,blendFunc:[lt.a.SRC_ALPHA,lt.a.ONE_MINUS_SRC_ALPHA,lt.a.ONE,lt.a.ONE_MINUS_SRC_ALPHA],polygonOffsetFill:!0,depthTest:!0,depthFunc:lt.a.LEQUAL}),this.props.onWebGLInitialized(t),!this.props._customRender)for(var e in this.eventManager=new zi(t.canvas,{events:{click:this._onClick,pointermove:this._onPointerMove,pointerleave:this._onPointerLeave}}),h)this.eventManager.on(e,this._onEvent);this.viewManager=new zn({eventManager:this.eventManager,onViewStateChange:this._onViewStateChange,onInteractiveStateChange:this._onInteractiveStateChange,views:this._getViews(this.props),viewState:this._getViewState(this.props),width:this.width,height:this.height}),g(this.viewManager);var n=this.viewManager.getViewports()[0];this.layerManager=new Mn(t,{stats:this.stats,viewport:n}),this.effectManager=new ai({gl:t,layerManager:this.layerManager});var r=!0,i=!1,a=void 0;try{for(var s,u=this.props.effects[Symbol.iterator]();!(r=(s=u.next()).done);r=!0){var c=s.value;this.effectManager.addEffect(c)}}catch(t){i=!0,a=t}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}}},{key:"_drawLayers",value:function(t){var e=this.layerManager.context.gl;Object(o.setParameters)(e,this.props.parameters),this.props.onBeforeRender({gl:e}),this.layerManager.drawLayers({pass:"screen",viewports:this.viewManager.getViewports(),views:this.viewManager.getViews(),redrawReason:t,drawPickingColors:this.props.drawPickingColors,customRender:Boolean(this.props._customRender)}),this.props.onAfterRender({gl:e})}},{key:"_onRendererInitialized",value:function(t){var e=t.gl;this._setGLContext(e)}},{key:"_onRenderFrame",value:function(t){if(this.stats.oneSecondPassed()){var e=this.stats.getStatsTable();if(this.stats.reset(),i.table(3,e)(),this.props._onMetrics){for(var n in e)e[n]=e[n].total;this.props._onMetrics(e)}}this._updateCanvasSize(),this._updateCursor(),this.layerManager.updateLayers(),this.stats.bump("fps"),this._updateAnimationProps(t);var r=this.needsRedraw({clearRedrawFlags:!0});r&&(this.stats.bump("redraw"),this.props._customRender?this.props._customRender():this._drawLayers(r))}},{key:"_onViewStateChange",value:function(t){var e=this.props.onViewStateChange(t)||t.viewState;this.viewState&&(this.viewState[t.viewId]=e,this.viewManager.setProps({viewState:e}))}},{key:"_onInteractiveStateChange",value:function(t){var e=t.isDragging,n=void 0!==e&&e;n!==this.interactiveState.isDragging&&(this.interactiveState.isDragging=n)}},{key:"_onClick",value:function(t){this._pickAndCallback({callback:this.props.onLayerClick,event:t,mode:"click"})}},{key:"_onEvent",value:function(t){var e=h[t.type],n=t.offsetCenter;if(e&&n){var r=this.layerManager.getLastPickedObject({x:n.x,y:n.y,viewports:this.getViewports(n)}),i=r.layer,o=i&&(i[e.handler]||i.props[e.handler]),a=this.props[e.handler],s=!1;o&&(s=o.call(i,r,t)),!s&&a&&a(r,t)}}},{key:"_onPointerMove",value:function(t){t.leftButton||t.rightButton||this._pickAndCallback({callback:this.props.onLayerHover,event:t,mode:"hover"})}},{key:"_onPointerLeave",value:function(t){this.layerManager.pickObject({x:-1,y:-1,viewports:[],radius:1,mode:"hover"}),this.props.onLayerHover&&this.props.onLayerHover(null,[],t.srcEvent)}}])&&Vi(e.prototype,n),r&&Vi(e,r),t}();function qi(t){return(qi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xi(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Hi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Yi(t,e){return!e||"object"!==qi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Zi(t,e,n){return(Zi="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ki(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function Ki(t){return(Ki=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ji(t,e){return(Ji=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Wi.getPropTypes=function(t){return{id:t.string,width:t.oneOfType([t.number,t.string]),height:t.oneOfType([t.number,t.string]),layers:t.oneOfType([t.object,t.array]),layerFilter:t.func,views:t.oneOfType([t.object,t.array]),viewState:t.object,effects:t.arrayOf(t.instanceOf(fi)),controller:t.oneOfType([t.func,t.bool,t.object]),gl:t.object,glOptions:t.object,parameters:t.object,pickingRadius:t.number,useDevicePixels:t.bool,onWebGLInitialized:t.func,onResize:t.func,onViewStateChange:t.func,onBeforeRender:t.func,onAfterRender:t.func,onLayerClick:t.func,onLayerHover:t.func,onLoad:t.func,debug:t.bool,drawPickingColors:t.bool,_animate:t.bool}},Wi.defaultProps=Ui;var Qi=function(t){function e(){return Xi(this,e),Yi(this,Ki(e).apply(this,arguments))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ji(t,e)}(e,t),n=e,(r=[{key:"getSubLayers",value:function(){return this.internalState&&this.internalState.subLayers||[]}},{key:"initializeState",value:function(){}},{key:"setState",value:function(t){Zi(Ki(e.prototype),"setState",this).call(this,t),this.setLayerNeedsUpdate()}},{key:"getPickingInfo",value:function(t){return t.info}},{key:"renderLayers",value:function(){return null}},{key:"shouldRenderSubLayer",value:function(t,e){var n=this.props._subLayerProps;return e&&e.length||n&&n[t]}},{key:"getSubLayerClass",value:function(t,e){var n=this.props._subLayerProps;return n&&n[t]&&n[t].type||e}},{key:"getSubLayerProps",value:function(t){var e=this.props,n=e.opacity,r=e.pickable,i=e.visible,o=e.parameters,a=e.getPolygonOffset,s=e.highlightedObjectIndex,u=e.autoHighlight,c=e.highlightColor,l=e.coordinateSystem,f=e.coordinateOrigin,h=e.wrapLongitude,d=e.positionFormat,p=e.modelMatrix,g=e._subLayerProps,v={opacity:n,pickable:r,visible:i,parameters:o,getPolygonOffset:a,highlightedObjectIndex:s,autoHighlight:u,highlightColor:c,coordinateSystem:l,coordinateOrigin:f,wrapLongitude:h,positionFormat:d,modelMatrix:p};return t&&Object.assign(v,t,g&&g[t.id],{id:"".concat(this.props.id,"-").concat(t.id),updateTriggers:Object.assign({all:this.props.updateTriggers.all},t.updateTriggers)}),v}},{key:"_getAttributeManager",value:function(){return null}},{key:"_renderLayers",value:function(){var t=this.internalState.subLayers;t&&!this.needsUpdate()?i.log(3,"Composite layer reused subLayers ".concat(this),this.internalState.subLayers)():(t=nn(t=this.renderLayers(),{filter:Boolean}),this.internalState.subLayers=t,i.log(2,"Composite layer rendered new subLayers ".concat(this),t)());var e=!0,n=!1,r=void 0;try{for(var o,a=t[Symbol.iterator]();!(e=(o=a.next()).done);e=!0)o.value.parent=this}catch(t){n=!0,r=t}finally{try{e||null==a.return||a.return()}finally{if(n)throw r}}}},{key:"isComposite",get:function(){return!0}}])&&Hi(n.prototype,r),o&&Hi(n,o),e}(qe);function $i(t){return($i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function to(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function eo(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function no(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ro(t,e){return!e||"object"!==$i(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function io(t){return(io=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function oo(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ao(t,e)}function ao(t,e){return(ao=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Qi.layerName="CompositeLayer";function so(t,e){return Number.isFinite(t)?t:e}var uo=function(t){function e(t){var n,r=t.width,i=t.height,o=t.position,a=t.bearing,s=t.pitch,u=t.longitude,c=t.latitude,l=t.zoom,f=(t.syncBearing,t.bounds,t.startPanEventPosition),h=t.startPanPosition,d=t.startRotateCenter,p=t.startRotateViewport,g=t.startZoomPos,v=t.startZoom;return eo(this,e),(n=ro(this,io(e).call(this,{width:r,height:i,position:o,bearing:a,pitch:s,longitude:u,latitude:c,zoom:l})))._interactiveState={startPanEventPosition:f,startPanPosition:h,startRotateCenter:d,startRotateViewport:p,startZoomPos:g,startZoom:v},n}var n,r,i;return oo(e,t),n=e,(r=[{key:"getInteractiveState",value:function(){return this._interactiveState}},{key:"panStart",value:function(t){var e=t.pos,n=this._viewportProps,r=n.translationX,i=n.translationY;return this._getUpdatedState({startPanPosition:[r,i],startPanEventPosition:e})}},{key:"pan",value:function(t){var e=t.pos,n=t.startPos,r=this._interactiveState.startPanEventPosition||n;if(!r)return this;var i=to(this._interactiveState.startPanPosition||[],2),o=i[0],a=i[1];o=so(o,this._viewportProps.translationX),a=so(a,this._viewportProps.translationY);var s=e[0]-r[0],u=e[1]-r[1];return this._getUpdatedState({translationX:o+s,translationY:a-u})}},{key:"panEnd",value:function(){return this._getUpdatedState({startPanPosition:null,startPanPos:null})}},{key:"rotateStart",value:function(t){return t.pos,this._getUpdatedState({startRotateCenter:this._viewportProps.position,startRotateViewport:this._viewportProps})}},{key:"rotate",value:function(t){var e=t.deltaScaleX,n=t.deltaScaleY;if(!this._interactiveState.startRotateCenter)return this;var r=this._viewportProps,i=r.bearing,o=r.pitch;return this._getUpdatedState({bearing:i+10*e,pitch:o-10*n})}},{key:"rotateEnd",value:function(){return this._getUpdatedState({startRotateCenter:null,startRotateViewport:null})}},{key:"zoomStart",value:function(t){var e=t.pos;return this._getUpdatedState({startZoomPos:e,startZoom:this._viewportProps.zoom})}},{key:"zoom",value:function(t){var e=t.pos,n=t.startPos,r=t.scale,i=this._viewportProps,o=i.zoom,a=i.minZoom,s=i.maxZoom,u=(i.width,i.height,i.translationX,i.translationY,this._interactiveState.startZoomPos||n||e),c=Object(hn.b)(o*r,a,s);return e[0],u[0],e[1],u[1],u[0],u[1],c/o<1?this.moveBackward():this.moveForward()}},{key:"zoomEnd",value:function(){return this._getUpdatedState({startZoomPos:null,startZoom:null})}},{key:"moveLeft",value:function(){var t=this._viewportProps.bearing-2;return this._getUpdatedState({bearing:t})}},{key:"moveRight",value:function(){var t=this._viewportProps.bearing+2;return this._getUpdatedState({bearing:t})}},{key:"moveForward",value:function(){var t=this._viewportProps.position,e=this.getDirection(),n=new pn.a(e).normalize().scale(1);return this._getUpdatedState({position:new pn.a(t).add(n)})}},{key:"moveBackward",value:function(){var t=this._viewportProps.position,e=this.getDirection(),n=new pn.a(e).normalize().scale(-1);return this._getUpdatedState({position:new pn.a(t).add(n)})}},{key:"moveUp",value:function(){var t=this._viewportProps.position;return this._getUpdatedState({position:new pn.a(t).add([0,0,1])})}},{key:"moveDown",value:function(){var t=this._viewportProps.position,e=t[2]>=1?[0,0,-1]:[0,0,0];return this._getUpdatedState({position:new pn.a(t).add(e)})}},{key:"zoomIn",value:function(){return this._getUpdatedState({zoom:this._viewportProps.zoom+.2})}},{key:"zoomOut",value:function(){return this._getUpdatedState({zoom:this._viewportProps.zoom-.2})}},{key:"_getUpdatedState",value:function(t){return new e(Object.assign({},this._viewportProps,this._interactiveState,t))}}])&&no(n.prototype,r),i&&no(n,i),e}(Lr),co=function(t){function e(t){return eo(this,e),ro(this,io(e).call(this,uo,t))}return oo(e,t),e}(Ir);function lo(t){return(lo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function fo(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ho(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function po(t,e){return!e||"object"!==lo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function go(t){return(go=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function vo(t,e){return(vo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var yo=function(t){function e(){return fo(this,e),po(this,go(e).apply(this,arguments))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&vo(t,e)}(e,t),n=e,(r=[{key:"_getViewport",value:function(t){var e=t.viewState,n=e.modelMatrix,r=void 0===n?null:n,i=e.bearing,o=e.up,a=void 0===o?[0,0,1]:o,s=function(t){var e=t.bearing,n=t.pitch;return new Ar({bearing:e,pitch:n}).toVector3().normalize()}({bearing:i,pitch:89}),u=r?r.transformDirection(s):s,c=(new dn.a).lookAt({eye:[0,0,0],center:u,up:a});return new wn(Object.assign({},t,{zoom:null,viewMatrix:c}))}},{key:"controller",get:function(){return this._getControllerProps({type:co})}}])&&ho(n.prototype,r),i&&ho(n,i),e}(Fn);function mo(t){return(mo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bo(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function xo(t,e){return!e||"object"!==mo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function wo(t){return(wo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Eo(t,e){return(Eo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}yo.displayName="FirstPersonView";var So=function(t){function e(){return bo(this,e),xo(this,wo(e).apply(this,arguments))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Eo(t,e)}(e,t),n=e,(r=[{key:"_getViewport",value:function(t){var e=t.viewState,n=e.bearing,r=e.pitch,i=e.position,o=e.up,a=50*e.zoom,s=function(t){var e=t.bearing,n=t.pitch;return new Ar({bearing:e,pitch:n}).toVector3().normalize()}({bearing:n,pitch:r}).scale(-a).multiply(new pn.a(1,1,-1)),u=(new dn.a).multiplyRight((new dn.a).lookAt({eye:s,center:i,up:o}));return new wn(Object.assign({},t,{id:this.id,zoom:null,viewMatrix:u}))}}])&&_o(n.prototype,r),i&&_o(n,i),e}(Fn);function Oo(t){return(Oo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Po(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Co(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Mo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Io(t,e){return!e||"object"!==Oo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ao(t){return(Ao=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function To(t,e){return(To=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}So.displayName="ThirdPersonView";var No=Math.PI/180,Lo=function(t){function e(t){var n,r=t.id,i=void 0===r?"orbit-viewport":r,o=t.width,a=t.height,s=t.distance,u=t.rotationX,l=void 0===u?0:u,f=t.rotationOrbit,h=void 0===f?0:f,d=t.orbitAxis,p=void 0===d?"Z":d,g=t.lookAt,v=void 0===g?[0,0,0]:g,y=t.up,m=void 0===y?[0,1,0]:y,b=t.fov,_=void 0===b?75:b,x=t.near,w=void 0===x?1:x,E=t.far,S=void 0===E?100:E,O=t.zoom,P=void 0===O?1:O;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var C=c.k([],[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],-l/180*Math.PI);"Z"===p?c.m(C,C,-h/180*Math.PI):c.l(C,C,-h/180*Math.PI);var M=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];c.n(M,M,[P,P,P]),c.o(M,M,[-v[0],-v[1],-v[2]]);var I=c.f([],[0,0,s],[0,0,0],m),A=_*No,T=o/a,N=c.i([],A,T,w,S);return(n=Io(this,Ao(e).call(this,{id:i,viewMatrix:c.g(I,I,c.g(C,C,M)),projectionMatrix:N,width:o,height:a}))).width=o,n.height=a,n.distance=s,n.rotationX=l,n.rotationOrbit=h,n.orbitAxis=p,n.lookAt=v,n.up=m,n.fov=_,n.near=w,n.far=S,n.zoom=P,n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&To(t,e)}(e,t),n=e,(r=[{key:"project",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.topLeft,r=void 0!==n&&n,i=fn(this.pixelProjectionMatrix,[].concat(Co(t),[1])),o=Po(i,3),a=o[0],s=o[1],u=o[2],c=r?this.height-s:s;return[a,c,u]}},{key:"unproject",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.topLeft,r=void 0!==n&&n,i=Po(t,3),o=i[0],a=i[1],s=i[2],u=r?this.height-a:a;return fn(this.pixelUnprojectionMatrix,[o,u,s,1])}},{key:"getDistance",value:function(t){var e=t.boundingBox,n=t.fov;return Math.max(e[0],e[1],e[2])/2/Math.tan(n/180*Math.PI/2)}},{key:"fitBounds",value:function(t){var n=this.width,r=this.height,i=this.rotationX,o=this.rotationOrbit,a=this.orbitAxis,s=this.lookAt,u=this.up,c=this.fov;return new e({width:n,height:r,rotationX:i,rotationOrbit:o,orbitAxis:a,up:u,fov:c,near:this.near,far:this.far,zoom:this.zoom,lookAt:s,distance:this.getDistance({boundingBox:t,fov:c})})}}])&&Mo(n.prototype,r),i&&Mo(n,i),e}(wn);function Ro(t){return(Ro="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ko(t,e){return!e||"object"!==Ro(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function jo(t){return(jo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Fo(t,e){return(Fo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Do(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Bo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function zo(t,e,n){return e&&Bo(t.prototype,e),n&&Bo(t,n),t}Lo.displayName="OrbitViewport";var Vo={transitionDuration:300,transitionEasing:function(t){return t},transitionInterpolator:new dr(["zoom"]),transitionInterruption:yr.BREAK},Go={lookAt:[0,0,0],rotationX:0,rotationOrbit:0,fov:50,near:1,far:100,translationX:0,translationY:0,zoom:1},Uo={minZoom:0,maxZoom:1/0};function Wo(t,e){return Number.isFinite(t)?t:e}var qo=function(){function t(e){var n=e.width,r=e.height,i=e.distance,o=e.rotationX,a=e.rotationOrbit,s=e.orbitAxis,u=e.bounds,c=e.lookAt,l=e.fov,f=e.near,h=e.far,d=e.translationX,p=e.translationY,v=e.zoom,y=e.minZoom,m=e.maxZoom,b=e.startPanViewport,_=e.startPanPos,x=e.isPanning,w=e.startRotateViewport,E=e.isRotating,S=e.startZoomViewport,O=e.startZoomPos;Do(this,t),g(Number.isFinite(n),"`width` must be supplied"),g(Number.isFinite(r),"`height` must be supplied"),g(Number.isFinite(i),"`distance` must be supplied"),this._viewportProps=this._applyConstraints({width:n,height:r,distance:i,rotationX:Wo(o,Go.rotationX),rotationOrbit:Wo(a,Go.rotationOrbit),orbitAxis:s,bounds:u,lookAt:c||Go.lookAt,fov:Wo(l,Go.fov),near:Wo(f,Go.near),far:Wo(h,Go.far),translationX:Wo(d,Go.translationX),translationY:Wo(p,Go.translationY),zoom:Wo(v,Go.zoom),minZoom:Wo(y,Uo.minZoom),maxZoom:Wo(m,Uo.maxZoom)}),this._interactiveState={startPanViewport:b,startPanPos:_,isPanning:x,startRotateViewport:w,isRotating:E,startZoomViewport:S,startZoomPos:O}}return zo(t,[{key:"getViewportProps",value:function(){return this._viewportProps}},{key:"getInteractiveState",value:function(){return this._interactiveState}},{key:"panStart",value:function(t){var e=t.pos,n=new Lo(this._viewportProps);return this._getUpdatedOrbitState({startPanPos:e,startPanViewport:n})}},{key:"pan",value:function(t){var e=t.pos,n=t.startPos;if(this._interactiveState.isRotating)return this._getUpdatedOrbitState();var r=this._interactiveState.startPanPos||n;g(r,"`startPanPos` props is required");var i=this._interactiveState.startPanViewport||new Lo(this._viewportProps),o=e[0]-r[0],a=e[1]-r[1],s=i.project(i.lookAt),u=i.unproject([s[0]-o,s[1]-a,s[2]]);return this._getUpdatedOrbitState({lookAt:u,isPanning:!0})}},{key:"panEnd",value:function(){return this._getUpdatedOrbitState({startPanViewport:null,startPanPos:null,isPanning:null})}},{key:"rotateStart",value:function(t){t.pos;var e=new Lo(this._viewportProps);return this._getUpdatedOrbitState({startRotateViewport:e})}},{key:"rotate",value:function(t){var e=t.deltaScaleX,n=t.deltaScaleY;if(this._interactiveState.isPanning)return this._getUpdatedOrbitState();var r=this._interactiveState.startRotateViewport||{},i=r.rotationX,o=r.rotationOrbit;i=Wo(i,this._viewportProps.rotationX),o=Wo(o,this._viewportProps.rotationOrbit);var a=Object(hn.b)(i-180*n,-89.999,89.999),s=(o-180*e)%360;return this._getUpdatedOrbitState({rotationX:a,rotationOrbit:s,isRotating:!0})}},{key:"rotateEnd",value:function(){return this._getUpdatedOrbitState({startRotateViewport:null,isRotating:null})}},{key:"shortestPathFrom",value:function(t){return Object.assign({},this._viewportProps)}},{key:"zoomStart",value:function(t){var e=t.pos,n=new Lo(this._viewportProps);return this._getUpdatedOrbitState({startZoomViewport:n,startZoomPos:e})}},{key:"zoom",value:function(t){var e=t.pos,n=t.startPos,r=t.scale,i=this._viewportProps,o=i.zoom,a=i.minZoom,s=i.maxZoom,u=i.width,c=i.height,l=this._interactiveState.startZoomPos||n||e,f=this._interactiveState.startZoomViewport||new Lo(this._viewportProps),h=Object(hn.b)(o*r,a,s),d=e[0]-l[0],p=e[1]-l[1],g=l[0]-u/2,v=c/2-l[1],y=f.project(f.lookAt),m=y[0]-g+g*h/o+d,b=y[1]+v-v*h/o-p,_=f.unproject([m,b,y[2]]);return this._getUpdatedOrbitState({lookAt:_,zoom:h})}},{key:"zoomEnd",value:function(){return this._getUpdatedOrbitState({startZoomPos:null})}},{key:"_getUpdatedOrbitState",value:function(e){return new t(Object.assign({},this._viewportProps,this._interactiveState,e))}},{key:"_applyConstraints",value:function(t){var e=t.maxZoom,n=t.minZoom,r=t.zoom;return t.zoom=r>e?e:r,t.zoom=r<n?n:r,t}}]),t}(),Xo=function(t){function e(t){return Do(this,e),ko(this,jo(e).call(this,qo,t))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Fo(t,e)}(e,t),zo(e,[{key:"_getTransitionProps",value:function(){return Vo}}]),e}(Ir);function Ho(t){return(Ho="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Yo(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Zo(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Ko(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Jo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Qo(t,e,n){return e&&Jo(t.prototype,e),n&&Jo(t,n),t}function $o(t,e){return!e||"object"!==Ho(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ta(t){return(ta=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ea(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&na(t,e)}function na(t,e){return(na=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ra=Math.PI/180,ia=function(t){function e(){return Ko(this,e),$o(this,ta(e).apply(this,arguments))}return ea(e,t),Qo(e,[{key:"project",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.topLeft,r=void 0!==n&&n,i=fn(this.pixelProjectionMatrix,[].concat(Zo(t),[1])),o=Yo(i,3),a=o[0],s=o[1],u=o[2],c=r?this.height-s:s;return[a,c,u]}},{key:"unproject",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.topLeft,r=void 0!==n&&n,i=Yo(t,3),o=i[0],a=i[1],s=i[2],u=r?this.height-a:a;return fn(this.pixelUnprojectionMatrix,[o,u,s,1])}}]),e}(wn),oa=function(t){function e(){return Ko(this,e),$o(this,ta(e).apply(this,arguments))}return ea(e,t),Qo(e,[{key:"_getViewport",value:function(t){var e=t.viewState,n=t.width||1,r=t.height||1,i=t.fov||t.fovy||e.fovy||75,o=t.near||e.near||1,a=t.far||e.far||100,s=Number.isFinite(e.aspect)?e.aspect:n/r,u=i*ra;return new ia({id:this.id,viewMatrix:this._getViewMatrix(t.viewState),projectionMatrix:c.i([],u,s,o,a),x:t.x,y:t.y,width:n,height:r})}},{key:"_getViewMatrix",value:function(t){var e=t.distance,n=t.rotationX,r=void 0===n?0:n,i=t.rotationOrbit,o=void 0===i?0:i,a=t.orbitAxis,s=void 0===a?"Z":a,u=t.lookAt,l=void 0===u?[0,0,0]:u,f=t.up,h=void 0===f?[0,1,0]:f,d=t.zoom,p=void 0===d?1:d,g=c.k([],[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],-r/180*Math.PI);"Z"===s?c.m(g,g,-o/180*Math.PI):c.l(g,g,-o/180*Math.PI);var v=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];c.n(v,v,[p,p,p]),c.o(v,v,[-l[0],-l[1],-l[2]]);var y=c.f([],[0,0,e],[0,0,0],h);return c.g(y,y,c.g(g,g,v)),y}},{key:"fitBounds",value:function(t,e){var n=this.width,r=this.height,i=this.fov,o=this.near,a=this.far;return this._getViewport({width:n,height:r,fov:i,near:o,far:a})}},{key:"controller",get:function(){return this._getControllerProps({type:Xo})}}],[{key:"getDistance",value:function(t){var e=t.boundingBox,n=t.fov;return Math.max(e[0],e[1],e[2])/2/Math.tan(n/180*Math.PI/2)}}]),e}(Fn);function aa(t){return(aa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function sa(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ua(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ca(t,e){return!e||"object"!==aa(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function la(t){return(la=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function fa(t,e){return(fa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}oa.displayName="OrbitView";var ha=Math.PI/180,da=function(t){function e(){return sa(this,e),ca(this,la(e).apply(this,arguments))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&fa(t,e)}(e,t),n=e,(r=[{key:"_getViewport",value:function(t){var e=t.x,n=t.y,r=t.width,i=t.height,o=t.viewState,a=o.eye,s=o.lookAt,u=void 0===s?[0,0,0]:s,l=o.up,f=void 0===l?[0,1,0]:l,h=t.fovy||o.fovy||75,d=t.near||o.near||1,p=t.far||o.far||100,g=Number.isFinite(o.aspect)?o.aspect:r/i,v=h*ha;return new wn({id:this.id,x:e,y:n,width:r,height:i,viewMatrix:c.f([],a,u,f),projectionMatrix:c.i([],v,g,d,p)})}}])&&ua(n.prototype,r),i&&ua(n,i),e}(Fn);da.displayName="PerspectiveView";var pa=n(189);function ga(t){return(ga="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function va(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ya(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ma(t,e,n){return e&&ya(t.prototype,e),n&&ya(t,n),t}function ba(t,e){return!e||"object"!==ga(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function _a(t){return(_a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function xa(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&wa(t,e)}function wa(t,e){return(wa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ea={zoom:0,offset:[0,0],minZoom:-10,maxZoom:10},Sa=function(t){return Math.pow(2,t)},Oa=function(t){function e(t){var n,r=t.width,i=t.height,o=t.offset,a=void 0===o?Ea.offset:o,s=t.zoom,u=void 0===s?Ea.zoom:s,c=t.minZoom,l=void 0===c?Ea.minZoom:c,f=t.maxZoom,h=void 0===f?Ea.maxZoom:f,d=t.startPanPosition,p=t.startPanOffset,g=t.startZoomPosition,v=t.startZoom;return va(this,e),(n=ba(this,_a(e).call(this,{width:r,height:i,offset:a,zoom:u,minZoom:l,maxZoom:h})))._interactiveState={startPanPosition:d,startPanOffset:p,startZoomPosition:g,startZoom:v},n}return xa(e,t),ma(e,[{key:"getInteractiveState",value:function(){return this._interactiveState}},{key:"panStart",value:function(t){var e=t.pos,n=this._viewportProps.offset;return this._getUpdatedState({startPanPosition:e,startPanOffset:n})}},{key:"pan",value:function(t){var e=t.pos,n=this._interactiveState,r=n.startPanPosition,i=n.startPanOffset,o=new pa.a(e).subtract(r);return this._getUpdatedState({offset:new pa.a(i).subtract(o)})}},{key:"panEnd",value:function(){return this._getUpdatedState({startPanPosition:null,startPanOffset:null})}},{key:"rotateStart",value:function(t){t.pos;return this}},{key:"rotate",value:function(t){t.deltaScaleX,t.deltaScaleY;return this}},{key:"rotateEnd",value:function(){return this}},{key:"_calculateNewZoom",value:function(t){var e=t.scale,n=t.startZoom,r=this._viewportProps,i=r.maxZoom,o=r.minZoom,a=n+Math.log2(e);return Object(hn.b)(a,o,i)}},{key:"zoomStart",value:function(t){var e=t.pos;return this._getUpdatedState({startZoomPosition:e,startZoom:this._viewportProps.zoom})}},{key:"zoom",value:function(t){var e=t.pos,n=t.startPos,r=t.scale,i=this._viewportProps,o=i.zoom,a=i.width,s=i.height,u=i.offset,c=this._interactiveState,l=c.startZoom,f=c.startZoomPosition;Number.isFinite(l)||(l=o,f=n||e);var h=this._calculateNewZoom({scale:r,startZoom:l}),d=Sa(l),p=Sa(h),g=a/2-u[0],v=s/2-u[1],y=(f[0]-g)*(p/d-1),m=(f[1]-v)*(p/d-1);return this._getUpdatedState({zoom:h,offset:[u[0]+y,u[1]+m]})}},{key:"zoomEnd",value:function(){return this._getUpdatedState({startZoomPosition:null,startZoom:null})}},{key:"_zoomFromCenter",value:function(t){var e=this._viewportProps,n=e.width,r=e.height,i=e.offset;return this.zoom({pos:[n/2-i[0],r/2-i[1]],scale:t})}},{key:"zoomIn",value:function(){return this._zoomFromCenter(2)}},{key:"zoomOut",value:function(){return this._zoomFromCenter(.5)}},{key:"moveLeft",value:function(){var t=this._viewportProps.offset,e=[10,0];return this._getUpdatedState({offset:new pa.a(t).add(e)})}},{key:"moveRight",value:function(){var t=this._viewportProps.offset,e=[-10,0];return this._getUpdatedState({offset:new pa.a(t).add(e)})}},{key:"moveUp",value:function(){var t=this._viewportProps.offset,e=[0,10];return this._getUpdatedState({offset:new pa.a(t).add(e)})}},{key:"moveDown",value:function(){var t=this._viewportProps.offset,e=[0,-10];return this._getUpdatedState({offset:new pa.a(t).add(e)})}},{key:"_getUpdatedState",value:function(t){return new e(Object.assign({},this._viewportProps,this._interactiveState,t))}}]),e}(Lr),Pa=function(t){function e(t){var n;return va(this,e),(n=ba(this,_a(e).call(this,Oa,t))).invertPan=!0,n}return xa(e,t),ma(e,[{key:"_onPanRotate",value:function(t){return!!this.dragRotate&&this._onPanRotateMap(t)}}]),e}(Ir);function Ca(t){return(Ca="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ma(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ia(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Aa(t,e){return!e||"object"!==Ca(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ta(t){return(Ta=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Na(t,e){return(Na=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var La=function(t){function e(){return Ma(this,e),Aa(this,Ta(e).apply(this,arguments))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Na(t,e)}(e,t),n=e,(r=[{key:"_getViewport",value:function(t){var e=t.x,n=t.y,r=t.width,i=t.height,o=t.viewState,a=o.offset,s=void 0===a?[0,0]:a,u=o.zoom,c=void 0===u?0:u;r=r||1,i=i||1;var l=Math.pow(2,c),f=this.props,h=f.eye,d=void 0===h?[0,0,1]:h,p=f.lookAt,g=void 0===p?[0,0,0]:p,v=f.up,y=void 0===v?[0,1,0]:v,m=f.left,b=void 0===m?(-r/2+s[0])/l:m,_=f.top,x=void 0===_?(-i/2+s[1])/l:_,w=f.right,E=void 0===w?(r/2+s[0])/l:w,S=f.bottom,O=void 0===S?(i/2+s[1])/l:S,P=f.near,C=void 0===P?1:P,M=f.far,I=void 0===M?100:M;return new wn({id:this.id,x:e,y:n,width:r,height:i,viewMatrix:(new dn.a).lookAt({eye:d,lookAt:g,up:y}),projectionMatrix:(new dn.a).ortho({left:b,right:E,bottom:O,top:x,near:C,far:I}),zoom:c})}},{key:"controller",get:function(){return this._getControllerProps({type:Pa})}}])&&Ia(n.prototype,r),i&&Ia(n,i),e}(Fn);La.displayName="OrthographicView";function Ra(t){return(Ra="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ka(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ja(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Fa(t,e){return!e||"object"!==Ra(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Da(t){return(Da=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ba(t,e){return(Ba=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var za=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;return ka(this,e),(t=Fa(this,Da(e).call(this))).reflectivity=n,t.blur=r,t.framebuffer=null,t.setNeedsRedraw(),t}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ba(t,e)}(e,t),n=e,(r=[{key:"getShaders",value:function(){return{vs:"#define SHADER_NAME reflection-effect-vs\n\nattribute vec3 vertices;\n\nvarying vec2 uv;\n\nvoid main(void) {\n  uv = vertices.xy;\n  gl_Position = vec4(2. * vertices.xy - vec2(1., 1.), 1., 1.);\n}\n",fs:'#define SHADER_NAME reflection-effect-fs\n\nprecision highp float;\n\nuniform sampler2D reflectionTexture;\nuniform int reflectionTextureWidth;\nuniform int reflectionTextureHeight;\n\nuniform float reflectivity;\nuniform float blur;\n\n\nvarying vec2 uv;\n\n#define KERNEL_SIZE 7\n\n/*\n * Samples from tex with a gaussian-shaped patch, centered at uv and\n * with standard deviation sigma.  The size of the texture in\n * pixels must be specified by dim\n */\nvec4 sample_gaussian(sampler2D tex, vec2 dim, vec2 uv, float sigma) {\n  if (sigma == 0.0) {\n    return texture2D(tex, uv);\n  }\n\n  vec2 delta = 1.0 / dim;\n  vec2 top_left = uv - delta * float(KERNEL_SIZE+1) / 2.0;\n\n  vec4 color = vec4(0);\n  float sum = 0.0;\n  for (int i = 0; i <  KERNEL_SIZE; ++i) {\n    for (int j = 0; j < KERNEL_SIZE; ++j) {\n      vec2 uv2 = top_left + vec2(i, j) * delta;\n      float d = length((uv2 - uv) * dim);\n      float f = exp(-(d*d) / (2.0*sigma * sigma));\n      color += f * texture2D(tex, uv2);\n      sum += f;\n    }\n  }\n  return color / sum;\n}\n\nvoid main(void) {\n  //map blur in [0, 1] to sigma in [0, inf]\n  //alpha will determine the "steepness" of our curve.\n  //this was picked just to make the scale feel "natural"\n  //if our image is 1000 pixels wide, a blur of 0.5 should correspond\n  //to a sigma of 1 pixels\n  float alpha = 1000.0;\n  float sigma = blur / (alpha * (1.0 - blur));\n  //let this be our standard deviation in terms of screen-widths.\n  //rewrite this in terms of pixels.\n  sigma *= float(reflectionTextureWidth);\n\n\n  gl_FragColor = sample_gaussian(reflectionTexture, vec2(reflectionTextureWidth,\n    reflectionTextureHeight), vec2(uv.x, 1. - uv.y), sigma);\n  //because our canvas expects alphas to be pre-multiplied, we multiply by whole\n  //color vector by reflectivity, not just the alpha channel\n  gl_FragColor *= reflectivity;\n}\n',modules:[],shaderCache:this.context.shaderCache}}},{key:"initialize",value:function(t){var e=t.gl;t.layerManager,this.unitQuad=new o.Model(e,Object.assign({},this.getShaders(),{id:"reflection-effect",geometry:new o.Geometry({drawMode:lt.a.TRIANGLE_FAN,vertices:new Float32Array([0,0,0,1,0,0,1,1,0,0,1,0])})})),this.framebuffer=new o.Framebuffer(e,{depth:!0})}},{key:"preDraw",value:function(t){var e=t.gl,n=t.layerManager,r=n.context.viewport,i="undefined"!=typeof window&&window.devicePixelRatio||1;this.framebuffer.resize({width:i*r.width,height:i*r.height});var o=r.pitch;this.framebuffer.bind(),n.setViewport(new nr(Object.assign({},r,{pitch:-180-o}))),e.clear(lt.a.COLOR_BUFFER_BIT|lt.a.DEPTH_BUFFER_BIT),n.drawLayers({pass:"reflection"}),n.setViewport(r),this.framebuffer.unbind()}},{key:"draw",value:function(t){t.gl,t.layerManager,this.unitQuad.render({reflectionTexture:this.framebuffer.texture,reflectionTextureWidth:this.framebuffer.width,reflectionTextureHeight:this.framebuffer.height,reflectivity:this.reflectivity,blur:this.blur})}},{key:"finalize",value:function(t){t.gl,t.layerManager}}])&&ja(n.prototype,r),i&&ja(n,i),e}(fi),Va=["longitude","latitude","zoom"],Ga={curve:1.414,speed:1.2};function Ua(t,e,n){var r=(n=Object.assign({},Ga,n)).curve,i=t.zoom,o=[t.longitude,t.latitude],a=V(i),s=e.zoom,u=[e.longitude,e.latitude],c=V(s-i),l=U(o,a),f=U(u,a),h=k.g([],f,l),d=Math.max(t.width,t.height),p=d/c,g=k.c(h),v=Math.max(g,.01),y=r*r,m=(p*p-d*d+y*y*v*v)/(2*d*y*v),b=(p*p-d*d-y*y*v*v)/(2*p*y*v),_=Math.log(Math.sqrt(m*m+1)-m),x=Math.log(Math.sqrt(b*b+1)-b);return{startZoom:i,startCenterXY:l,uDelta:h,w0:d,u1:g,S:(x-_)/r,rho:r,rho2:y,r0:_,r1:x}}function Wa(t){return(Wa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Xa(t,e){return!e||"object"!==Wa(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ha(t){return(Ha=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ya(t,e){return(Ya=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Za=["bearing","pitch"],Ka=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Xa(this,Ha(e).call(this,{compare:["longitude","latitude","zoom","bearing","pitch"],extract:["width","height","longitude","latitude","zoom","bearing","pitch"],required:["width","height","latitude","longitude","zoom"]}))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ya(t,e)}(e,t),n=e,(r=[{key:"interpolateProps",value:function(t,e,n){for(var r=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i={},o=Ua(t,e,r),a=o.startZoom,s=o.startCenterXY,u=o.uDelta,c=o.w0,l=o.u1,f=o.S,h=o.rho,d=o.rho2,p=o.r0;if(l<.01){for(var g=0;g<Va.length;g++){var v=Va[g],y=t[v],m=e[v];i[v]=R(y,m,n)}return i}var b=n*f,_=Math.cosh(p)/Math.cosh(p+h*b),x=c*((Math.cosh(p)*Math.tanh(p+h*b)-Math.sinh(p))/d)/l,w=1/_,E=a+G(w),S=k.f([],u,x);k.a(S,S,s),k.f(S,S,w);var O=W(S,V(E));return i.longitude=O[0],i.latitude=O[1],i.zoom=E,i}(t,e,n),i=0;i<Za.length;i++){var o=Za[i];r[o]=Object(hn.g)(t[o]||0,e[o]||0,n)}return r}}])&&qa(n.prototype,r),i&&qa(n,i),e}(or);function Ja(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Qa(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ts=function(t){return t.length},es=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ts;Qa(this,t),this.sortedBins=this.getSortedBins(e,n),this.maxCount=this.getMaxCount(),this.binMap=this.getBinMap()}var e,n,r;return e=t,(n=[{key:"getSortedBins",value:function(t,e){return t.reduce((function(t,n,r){var i=e(n.points);return null!=i&&t.push({i:Number.isFinite(n.index)?n.index:r,value:i,counts:n.points.length}),t}),[]).sort((function(t,e){return t.value-e.value}))}},{key:"getValueRange",value:function(t){var e=Ja(t,2),n=e[0],r=e[1],i=this.sortedBins.length;if(!i)return[0,0];var o=Math.ceil(n/100*(i-1)),a=Math.floor(r/100*(i-1));return[this.sortedBins[o].value,this.sortedBins[a].value]}},{key:"getMaxCount",value:function(){var t=0;return this.sortedBins.forEach((function(e){return t=t>e.counts?t:e.counts})),t}},{key:"getBinMap",value:function(){return this.sortedBins.reduce((function(t,e){return Object.assign(t,(n={},r=e.i,i=e,r in n?Object.defineProperty(n,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[r]=i,n));var n,r,i}),{})}}])&&$a(e.prototype,n),r&&$a(e,r),t}();function ns(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function rs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function is(t,e,n){return e&&rs(t.prototype,e),n&&rs(t,n),t}var os,as=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.overAlloc,r=void 0===n?1:n;ns(this,t),this.overAlloc=r}return is(t,[{key:"allocate",value:function(t,e,n){var r=n.size,i=n.type,o=n.copy,a=void 0!==o&&o,s=e*r;if(t&&s<=t.length)return t;var u=Math.max(Math.ceil(s*this.overAlloc),1),c=this._allocate(i,u);return t&&a&&c.set(t),this._release(t),c}},{key:"_allocate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Float32Array,e=arguments.length>1?arguments[1]:void 0;if(t===Uint16Array&&e>65535)throw new Error("Vertex count exceeds browser index limit");return new t(e)}},{key:"_release",value:function(t){}}]),t}(),ss=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ns(this,t);var n=e.attributes,r=void 0===n?{}:n;this.typedArrayManager=new as,this.indexLayout=null,this.bufferLayout=null,this.vertexCount=0,this.instanceCount=0,this.attributes={},this._attributeDefs=r,this.updateGeometry(e),Object.seal(this)}return is(t,[{key:"updateGeometry",value:function(t){var e=t.data,n=t.getGeometry,r=t.positionFormat,i=t.fp64;this.data=e,this.getGeometry=n,this.fp64=i,this.positionSize="XY"===r?2:3,this._rebuildGeometry()}},{key:"updatePartialGeometry",value:function(t){t.start,t.count,t.objects}},{key:"updateGeometryAttributes",value:function(t,e,n){throw new Error("Not implemented")}},{key:"getGeometrySize",value:function(t){throw new Error("Not implemented")}},{key:"_forEachGeometry",value:function(t){var e=this.data,n=this.getGeometry,r=0,i=!0,o=!1,a=void 0;try{for(var s,u=e[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){t(n(s.value),r++)}}catch(t){o=!0,a=t}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}}},{key:"_updateAttribute",value:function(t){var e=t.target,n=t.size,r=t.getValue,i=this.data,o=this.bufferLayout,a=0,s=0,u=!0,c=!1,l=void 0;try{for(var f,h=i[Symbol.iterator]();!(u=(f=h.next()).done);u=!0){var d=r(f.value,s),p=o[s++];on({target:e,source:d,start:a,count:p}),a+=p*n}}catch(t){c=!0,l=t}finally{try{u||null==h.return||h.return()}finally{if(c)throw l}}return e}},{key:"_rebuildGeometry",value:function(){var t=this;if(this.data&&this.getGeometry){var e=[],n=[],r=0;this._forEachGeometry((function(e,i){var o=t.getGeometrySize(e);r+=o,n[i]=o}));var i=this.attributes,o=this._attributeDefs,a=this.typedArrayManager,s=this.fp64;for(var u in o){var c=o[u];c.fp64Only&&!s||(i[u]=a.allocate(i[u],r,c))}this.indexLayout=e,this.bufferLayout=n,this.instanceCount=r;var l={vertexStart:0,indexStart:0};this._forEachGeometry((function(r,i){var o=n[i];l.geometryIndex=i,l.geometrySize=o,t.updateGeometryAttributes(r,l),l.vertexStart+=o,l.indexStart+=e[i]||0})),this.vertexCount=l.indexStart}}}]),t}();function us(t,e,n){var r=t[1]-t[0];if(r<=0)return i.warn("quantizeScale: invalid domain, returning range[0]")(),e[0];var o=r/e.length,a=Math.floor((n-t[0])/o);return e[Math.max(Math.min(a,e.length-1),0)]}function cs(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var ls={SUM:1,MEAN:2,MIN:3,MAX:4},fs={dataChanged:!0,viewportChanged:!0,cellSizeChanged:!0},hs={changeFlags:fs,projectPoints:!1,useGPU:!0,fp64:!1,viewport:null,gridTransformMatrix:null,createBufferObjects:!0},ds=3402823466e29,ps=[lt.a.MIN,lt.a.FUNC_ADD],gs=[lt.a.MAX,lt.a.FUNC_ADD],vs=[lt.a.MAX,lt.a.MIN],ys=(cs(os={},ls.SUM,lt.a.FUNC_ADD),cs(os,ls.MEAN,lt.a.FUNC_ADD),cs(os,ls.MIN,ps),cs(os,ls.MAX,gs),os),ms={size:1,operation:ls.SUM,needMin:!1,needMax:!1,combineMaxMin:!1},bs=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],_s="#define SHADER_NAME gpu-aggregation-to-grid-vs\n\nattribute vec2 positions;\nattribute vec3 weights;\nuniform vec2 windowSize;\nuniform vec2 cellSize;\nuniform vec2 gridSize;\nuniform mat4 uProjectionMatrix;\nuniform bool projectPoints;\n\nvarying vec3 vWeights;\n\nvec2 project_to_pixel(vec4 pos) {\n  vec4 result =  uProjectionMatrix * pos;\n  return result.xy/result.w;\n}\n\nvoid main(void) {\n\n  vWeights = weights;\n\n  vec4 windowPos = vec4(positions, 0, 1.);\n  if (projectPoints) {\n    windowPos = project_position_to_clipspace(vec3(positions, 0), vec2(0, 0), vec3(0, 0, 0));\n  }\n\n  vec2 pos = project_to_pixel(windowPos);\n\n  // Transform (0,0):windowSize -> (0, 0): gridSize\n  pos = floor(pos / cellSize);\n\n  // Transform (0,0):gridSize -> (-1, -1):(1,1)\n  pos = (pos * (2., 2.) / (gridSize)) - (1., 1.);\n\n  // Move to pixel center, pixel-size in screen sapce (2/gridSize) * 0.5 => 1/gridSize\n  vec2 offset = 1.0 / gridSize;\n  pos = pos + offset;\n\n  gl_Position = vec4(pos, 0.0, 1.0);\n}\n",xs="#define SHADER_NAME gpu-aggregation-to-grid-vs-64\n\nattribute vec2 positions;\nattribute vec2 positions64xyLow;\nattribute vec3 weights;\nuniform vec2 windowSize;\nuniform vec2 cellSize;\nuniform vec2 gridSize;\nuniform vec2 uProjectionMatrixFP64[16];\nuniform bool projectPoints;\n\nvarying vec3 vWeights;\n\nvoid project_to_pixel(vec2 pos, vec2 pos64xyLow, out vec2 pixelXY64[2]) {\n\n  vec2 result64[4];\n  vec2 position64[4];\n  position64[0] = vec2(pos.x, pos64xyLow.x);\n  position64[1] = vec2(pos.y, pos64xyLow.y);\n  position64[2] = vec2(0., 0.);\n  position64[3] = vec2(1., 0.);\n  mat4_vec4_mul_fp64(uProjectionMatrixFP64, position64,\n  result64);\n\n  pixelXY64[0] = div_fp64(result64[0], result64[3]);\n  pixelXY64[1] = div_fp64(result64[1], result64[3]);\n}\n\nvoid main(void) {\n\n  vWeights = weights;\n\n  vec2 windowPos = positions;\n  vec2 windowPos64xyLow = positions64xyLow;\n  if (projectPoints) {\n    vec2 projectedXY[2];\n    project_position_fp64(windowPos, windowPos64xyLow, projectedXY);\n    windowPos.x = projectedXY[0].x;\n    windowPos.y = projectedXY[1].x;\n    windowPos64xyLow.x = projectedXY[0].y;\n    windowPos64xyLow.y = projectedXY[1].y;\n  }\n\n  vec2 pixelXY64[2];\n  project_to_pixel(windowPos, windowPos64xyLow, pixelXY64);\n\n  // Transform (0,0):windowSize -> (0, 0): gridSize\n  vec2 gridXY64[2];\n  gridXY64[0] = div_fp64(pixelXY64[0], vec2(cellSize.x, 0));\n  gridXY64[1] = div_fp64(pixelXY64[1], vec2(cellSize.y, 0));\n  float x = floor(gridXY64[0].x);\n  float y = floor(gridXY64[1].x);\n  vec2 pos = vec2(x, y);\n\n  // Transform (0,0):gridSize -> (-1, -1):(1,1)\n  pos = (pos * (2., 2.) / (gridSize)) - (1., 1.);\n\n  // Move to pixel center, pixel-size in screen sapce (2/gridSize) * 0.5 => 1/gridSize\n  vec2 offset = 1.0 / gridSize;\n  pos = pos + offset;\n\n  gl_Position = vec4(pos, 0.0, 1.0);\n}\n",ws="#define SHADER_NAME gpu-aggregation-to-grid-fs\n\nprecision highp float;\n\nvarying vec3 vWeights;\n\nvoid main(void) {\n  gl_FragColor = vec4(vWeights, 1.0);\n}\n",Es="#version 300 es\n#define SHADER_NAME gpu-aggregation-all-vs-64\n\nin vec2 position;\nuniform vec2 gridSize;\n\nout vec2 vTextureCoord;\nvoid main(void) {\n  // Map each position to single pixel\n  vec2 pos = vec2(-1.0, -1.0);\n\n  // Move to pixel center, pixel-size in screen sapce (2/gridSize) * 0.5 => 1/gridSize\n  vec2 offset = 1.0 / gridSize;\n  pos = pos + offset;\n\n  gl_Position = vec4(pos, 0.0, 1.0);\n\n  float yIndex = floor(float(gl_InstanceID) / gridSize[0]);\n  float xIndex = float(gl_InstanceID) - (yIndex * gridSize[0]);\n\n  vec2 yIndexFP64 = vec2(yIndex, 0.);\n  vec2 xIndexFP64 = vec2(xIndex, 0.);\n  vec2 gridSizeYFP64 = vec2(gridSize[1], 0.);\n  vec2 gridSizeXFP64 = vec2(gridSize[0], 0.);\n\n  vec2 texCoordXFP64 = div_fp64(yIndexFP64, gridSizeYFP64);\n  vec2 texCoordYFP64 = div_fp64(xIndexFP64, gridSizeXFP64);\n\n  vTextureCoord = vec2(texCoordYFP64.x, texCoordXFP64.x);\n}\n",Ss="#version 300 es\n#define SHADER_NAME gpu-aggregation-all-fs\n\nprecision highp float;\n\nin vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform bool combineMaxMin;\nout vec4 fragColor;\nvoid main(void) {\n  vec4 textureColor = texture(uSampler, vec2(vTextureCoord.s, vTextureCoord.t));\n  if (textureColor.a == 0.) {\n    discard;\n  }\n  fragColor.rgb = textureColor.rgb;\n  // if combineMinMax is true, use Alpha channel for first weights min value.\n  fragColor.a = combineMaxMin ? textureColor.r : textureColor.a;\n}\n";function Os(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ps(t,e){var n,r=e.width,i=void 0===r?1:r,a=e.height,s=void 0===a?1:a;return new o.Texture2D(t,{data:null,format:lt.a.RGBA32F,type:lt.a.FLOAT,border:0,mipmaps:!1,parameters:(n={},Os(n,lt.a.TEXTURE_MAG_FILTER,lt.a.NEAREST),Os(n,lt.a.TEXTURE_MIN_FILTER,lt.a.NEAREST),n),dataFormat:lt.a.RGBA,width:i,height:s})}function Cs(t,e){var n=e.id,r=e.width,i=void 0===r?1:r,a=e.height,s=void 0===a?1:a,u=e.texture||Ps(t,e);return new o.Framebuffer(t,{id:n,width:i,height:s,attachments:Os({},lt.a.COLOR_ATTACHMENT0,u)})}function Ms(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return!t||t.length<e?new Float32Array(e).fill(n):t}function Is(t){var e=t.gl,n=t.bufferName,r=t.data,i=t.result;i[n]?i[n].subData({data:r}):i[n]=new o.Buffer(e,r)}function As(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ts(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Ns(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ls(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Rs(t,e,n){return e&&Ls(t.prototype,e),n&&Ls(t,n),t}var ks=o.fp64.fp64ifyMatrix4,js=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Ns(this,t),this.id=n.id||"gpu-grid-aggregator",this.shaderCache=n.shaderCache||null,this.gl=e,this.state={weights:null,gridPositions:null,positionsBuffer:null,positions64xyLowBuffer:null,vertexCount:0,fp64:null,useGPU:null,numCol:0,numRow:0,windowSize:null,cellSize:null,weightAttributes:{},textures:{},meanTextures:{},buffers:{},framebuffers:{},maxMinFramebuffers:{},minFramebuffers:{},maxFramebuffers:{},equations:{}},this._hasGPUSupport=Object(o.isWebGL2)(e)&&Object(o.hasFeatures)(this.gl,o.FEATURES.BLEND_EQUATION_MINMAX,o.FEATURES.COLOR_ATTACHMENT_RGBA32F,o.FEATURES.TEXTURE_FLOAT)}return Rs(t,null,[{key:"getAggregationData",value:function(t){var e=t.aggregationData,n=t.maxData,r=t.pixelIndex;g(e.length>=4*(r+1)),g(4===n.length);var i=4*r;return{cellCount:e[i+3],cellWeight:e[i],totalCount:n[3],maxCellWieght:n[0]}}},{key:"getCellData",value:function(t){for(var e=t.countsData,n=t.size,r=void 0===n?1:n,i=e.length/4,o=new Float32Array(i*r),a=new Uint32Array(i),s=0;s<i;s++){for(var u=0;u<r;u++)o[s*r+u]=e[4*s+u];a[s]=e[4*s+3]}return{cellCounts:a,cellWeights:o}}}]),Rs(t,[{key:"delete",value:function(){var t=this.gridAggregationModel,e=this.allAggregationModel,n=this.meanTransform,r=this.state,i=r.positionsBuffer,o=r.position64Buffer,a=r.framebuffers,s=r.maxMinFramebuffers,u=r.minFramebuffers,c=r.maxFramebuffers,l=r.meanTextures;t&&t.delete(),e&&e.delete(),n&&n.delete(),i&&i.delete(),o&&o.delete(),this.deleteResources(a),this.deleteResources(s),this.deleteResources(u),this.deleteResources(c),this.deleteResources(l)}},{key:"run",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this.getAggregationParams(t);this.updateGridSize(e);var n=e.useGPU;return this._hasGPUSupport&&n?this.runAggregationOnGPU(e):(n&&i.warn("ScreenGridAggregator: GPU Aggregation not supported, falling back to CPU")(),this.runAggregationOnCPU(e))}},{key:"deleteResources",value:function(t){for(var e in t)t[e].delete()}},{key:"getAggregationParams",value:function(t){var e=Object.assign({},hs,t),n=e.useGPU,r=e.gridTransformMatrix,i=e.viewport,o=e.weights,a=e.projectPoints,s=e.cellSize;return this.state.useGPU!==n&&(e.changeFlags=Object.assign({},e.changeFlags,fs)),!s||this.state.cellSize&&this.state.cellSize[0]===s[0]&&this.state.cellSize[1]===s[1]||(e.changeFlags.cellSizeChanged=!0,this.setState({cellSize:s})),this.validateProps(e,t),this.setState({useGPU:n}),e.gridTransformMatrix=(a?i.viewportMatrix:r)||bs,o&&(e.weights=this.normalizeWeightParams(o),this.setState({weights:e.weights})),e}},{key:"normalizeWeightParams",value:function(t){var e={};for(var n in t)e[n]=Object.assign({},ms,t[n]);return e}},{key:"setState",value:function(t){Object.assign(this.state,t)}},{key:"shouldTransformToGrid",value:function(t){var e=t.projectPoints,n=t.changeFlags;return!!(!this.state.gridPositions||n.dataChanged||e&&n.viewportChanged)}},{key:"updateGridSize",value:function(t){var e=t.viewport,n=t.cellSize,r=t.width||e.width,i=t.height||e.height,o=Math.ceil(r/n[0]),a=Math.ceil(i/n[1]);this.setState({numCol:o,numRow:a,windowSize:[r,i]})}},{key:"validateProps",value:function(t,e){var n=t.changeFlags,r=t.projectPoints,o=t.gridTransformMatrix;g(n.dataChanged||n.viewportChanged||n.cellSizeChanged),g(!n.dataChanged||e.positions&&e.weights&&(!e.projectPositions||e.viewport)&&e.cellSize),g(!n.cellSizeChanged||e.cellSize),g(!(n.viewportChanged&&r)||e.viewport),r&&o&&i.warn("projectPoints is true, gridTransformMatrix is ignored")()}},{key:"calculateAggregationData",value:function(t){var e=t.weights,n=t.results,r=t.cellIndex,i=t.posIndex;for(var o in e){for(var a=e[o],s=a.values,u=a.size,c=a.operation,l=n[o].aggregationData,f=0;f<u;f++){var h=r+f,d=s[3*i+f];if(0===l[r+3])l[h]=d;else switch(c){case ls.SUM:case ls.MEAN:l[h]+=d;break;case ls.MIN:l[h]=Math.min(l[h],d);break;case ls.MAX:l[h]=Math.max(l[h],d);break;default:g(!1)}}l[r+3]++}}},{key:"calculateMeanMaxMinData",value:function(t){var e=t.validCellIndices,n=t.results,r=t.weights;e.forEach((function(t){for(var e in n){for(var i=r[e],o=i.size,a=i.needMin,s=i.needMax,u=i.operation,c=n[e],l=c.aggregationData,f=c.minData,h=c.maxData,d=c.maxMinData,p=a||s,g=u===ls.MEAN,v=a&&s&&r[e].combineMaxMin,y=l[t+4-1],m=0;m<o&&(p||g);m++){var b=t+m,_=l[b];g&&(l[b]/=y,_=l[b]),v?d[m]=Math.max(d[m],_):(a&&(f[m]=Math.min(f[m],_)),s&&(h[m]=Math.max(h[m],_)))}v?d[3]=Math.min(d[3],l[t+0]):(a&&(f[3]+=y),s&&(h[3]+=y))}}))}},{key:"initCPUResults",value:function(t){var e=t.weights||this.state.weights,n=this.state,r=n.numCol,i=n.numRow,o={};for(var a in e){var s=e[a],u=s.aggregationData,c=s.minData,l=s.maxData,f=s.maxMinData,h=e[a],d=h.needMin,p=h.needMax,g=d&&p&&e[a].combineMaxMin;u=Ms(u,r*i*4),g?((f=Ms(f,4)).fill(-1/0,0,3),f[3]=1/0):(d&&((c=Ms(c,4,1/0))[3]=0),p&&((l=Ms(l,4,-1/0))[3]=0)),o[a]=Object.assign({},e[a],{aggregationData:u,minData:c,maxData:l,maxMinData:f})}return o}},{key:"runAggregationOnCPU",value:function(t){var e,n,r=t.positions,i=t.cellSize,o=t.gridTransformMatrix,a=t.viewport,s=t.projectPoints,u=t.weights,c=this.state,l=c.numCol,f=c.numRow,h=this.initCPUResults(t),d=this.shouldTransformToGrid(t),p=[0,0,0];g(d||t.changeFlags.cellSizeChanged),d?(n=r.length/2,e=new Float64Array(r.length),this.setState({gridPositions:e})):(e=this.state.gridPositions,u=this.state.weights,n=e.length/2);for(var v=new Set,y=0;y<n;y++){var m=void 0,b=void 0;if(d){if(p[0]=r[2*y],p[1]=r[2*y+1],s){var _=Ts(a.project(p),2);m=_[0],b=_[1]}else{var x=Ts(K(p,o),2);m=x[0],b=x[1]}e[2*y]=m,e[2*y+1]=b}else m=e[2*y],b=e[2*y+1];var w=Math.floor(m/i[0]),E=Math.floor(b/i[1]);if(w>=0&&w<l&&E>=0&&E<f){var S=4*(w+E*l);v.add(S),this.calculateAggregationData({weights:u,results:h,cellIndex:S,posIndex:y})}}return this.calculateMeanMaxMinData({validCellIndices:v,results:h,weights:u}),this.updateAggregationBuffers(t,h),h}},{key:"updateAggregationBuffers",value:function(t,e){if(t.createBufferObjects){var n=t.weights||this.state.weights;for(var r in e){var i=e[r],o=i.aggregationData,a=i.minData,s=i.maxData,u=i.maxMinData,c=n[r],l=c.needMin,f=c.needMax,h=l&&f&&n[r].combineMaxMin;Is({gl:this.gl,bufferName:"aggregationBuffer",data:o,result:e[r]}),h?Is({gl:this.gl,bufferName:"maxMinBuffer",data:u,result:e[r]}):(l&&Is({gl:this.gl,bufferName:"minBuffer",data:a,result:e[r]}),f&&Is({gl:this.gl,bufferName:"maxBuffer",data:s,result:e[r]}))}}}},{key:"getAggregateData",value:function(t){var e={},n=this.state,r=n.textures,i=n.framebuffers,o=n.maxMinFramebuffers,a=n.minFramebuffers,s=n.maxFramebuffers,u=n.weights;for(var c in u){e[c]={};var l=u[c],f=l.needMin,h=l.needMax,d=l.combineMaxMin;e[c].aggregationTexture=r[c],e[c].aggregationBuffer=i[c].readPixelsToBuffer({buffer:u[c].aggregationBuffer,type:lt.a.FLOAT}),f&&h&&d?e[c].maxMinBuffer=o[c].readPixelsToBuffer({buffer:u[c].maxMinBuffer,type:lt.a.FLOAT}):(f&&(e[c].minBuffer=a[c].readPixelsToBuffer({buffer:u[c].minBuffer,type:lt.a.FLOAT})),h&&(e[c].maxBuffer=s[c].readPixelsToBuffer({buffer:u[c].maxBuffer,type:lt.a.FLOAT})))}return e}},{key:"getAggregationModel",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.gl,n=this.shaderCache;return new o.Model(e,{id:"Gird-Aggregation-Model",vs:t?xs:_s,fs:ws,modules:t?["fp64","project64"]:["project32"],shaderCache:n,vertexCount:0,drawMode:lt.a.POINTS})}},{key:"getAllAggregationModel",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t=this.gl,e=this.shaderCache;return new o.Model(t,{id:"All-Aggregation-Model",vs:Es,fs:Ss,modules:["fp64"],shaderCache:e,vertexCount:1,drawMode:lt.a.POINTS,isInstanced:!0,instanceCount:0,attributes:{position:new o.Buffer(t,{size:2,data:new Float32Array([0,0])})}})}},{key:"getMeanTransform",value:function(t){return this.meanTransform?this.meanTransform.update(t):this.meanTransform=new o.Transform(this.gl,Object.assign({},{vs:"#define SHADER_NAME gpu-aggregation-transform-mean-vs\nattribute vec4 aggregationValues;\nvarying vec4 meanValues;\n\nvoid main()\n{\n  // TODO: Use 64-bit division ?? not needed given this is aggregation ??\n  bool isCellValid = bool(aggregationValues.w > 0.);\n  // aggregationValues:  XYZ contain aggregated values, W contains count\n  meanValues.xyz = isCellValid ? aggregationValues.xyz/aggregationValues.w : vec3(0, 0, 0);\n  meanValues.w = aggregationValues.w;\n}\n",_targetTextureVarying:"meanValues"},t)),this.meanTransform}},{key:"renderAggregateData",value:function(t){var e=t.cellSize,n=t.viewport,r=t.gridTransformMatrix,i=t.projectPoints,o=this.state,a=o.numCol,s=o.numRow,u=o.windowSize,c=o.maxMinFramebuffers,l=o.minFramebuffers,f=o.maxFramebuffers,h=o.weights,d=ks(r),p=[a,s],g={blend:!0,depthTest:!1,blendFunc:[lt.a.ONE,lt.a.ONE]},v={viewport:n},y={windowSize:u,cellSize:e,gridSize:p,uProjectionMatrix:r,uProjectionMatrixFP64:d,projectPoints:i};for(var m in h){var b=h[m],_=b.needMin,x=b.needMax,w=_&&x&&h[m].combineMaxMin;this.renderToWeightsTexture({id:m,parameters:g,moduleSettings:v,uniforms:y,gridSize:p}),w?this.renderToMaxMinTexture({id:m,parameters:Object.assign({},g,{blendEquation:vs}),gridSize:p,minOrMaxFb:c[m],clearParams:{clearColor:[0,0,0,ds]},combineMaxMin:w}):(_&&this.renderToMaxMinTexture({id:m,parameters:Object.assign({},g,{blendEquation:ps}),gridSize:p,minOrMaxFb:l[m],clearParams:{clearColor:[ds,ds,ds,0]},combineMaxMin:w}),x&&this.renderToMaxMinTexture({id:m,parameters:Object.assign({},g,{blendEquation:gs}),gridSize:p,minOrMaxFb:f[m],combineMaxMin:w}))}}},{key:"renderToMaxMinTexture",value:function(t){var e=t.id,n=t.parameters,r=t.gridSize,i=t.minOrMaxFb,a=t.combineMaxMin,s=t.clearParams,u=void 0===s?{}:s,c=this.state.framebuffers,l=this.gl,f=this.allAggregationModel;i.bind(),l.viewport(0,0,r[0],r[1]),Object(o.withParameters)(l,u,(function(){l.clear(l.COLOR_BUFFER_BIT)})),f.draw({parameters:n,uniforms:{uSampler:c[e].texture,gridSize:r,combineMaxMin:a}}),i.unbind()}},{key:"renderToWeightsTexture",value:function(t){var e=t.id,n=t.parameters,r=t.moduleSettings,i=t.uniforms,a=t.gridSize,s=this.state,u=s.framebuffers,c=s.equations,l=s.weightAttributes,f=s.weights,h=this.gl,d=this.gridAggregationModel,p=f[e].operation;u[e].bind(),h.viewport(0,0,a[0],a[1]);var g=p===ls.MIN?[ds,ds,ds,0]:[0,0,0,0];Object(o.withParameters)(h,{clearColor:g},(function(){h.clear(h.COLOR_BUFFER_BIT)}));var v={weights:l[e]};if(d.draw({parameters:Object.assign({},n,{blendEquation:c[e]}),moduleSettings:r,uniforms:i,attributes:v}),u[e].unbind(),p===ls.MEAN){var y=this.state,m=y.meanTextures,b=y.textures,_={_sourceTextures:{aggregationValues:m[e]},_targetTexture:b[e],elementCount:b[e].width*b[e].height};this.getMeanTransform(_).run({parameters:{blend:!1,depthTest:!1}}),u[e].attach(As({},lt.a.COLOR_ATTACHMENT0,b[e]))}}},{key:"runAggregationOnGPU",value:function(t){return this.updateModels(t),this.setupFramebuffers(t),this.renderAggregateData(t),this.getAggregateData(t)}},{key:"setupFramebuffers",value:function(t){var e=this.state,n=e.numCol,r=e.numRow,i=e.textures,o=e.framebuffers,a=e.maxMinFramebuffers,s=e.minFramebuffers,u=e.maxFramebuffers,c=e.meanTextures,l=e.equations,f=e.weights,h={width:n,height:r};for(var d in f){var p=f[d],g=p.needMin,v=p.needMax,y=p.combineMaxMin,m=p.operation;i[d]=f[d].aggregationTexture||i[d]||Ps(this.gl,{id:"".concat(d,"-texture"),width:n,height:r}),i[d].resize(h);var b=i[d];m===ls.MEAN&&(c[d]=c[d]||Ps(this.gl,{id:"".concat(d,"-mean-texture"),width:n,height:r}),c[d].resize(h),b=c[d]),o[d]?o[d].attach(As({},lt.a.COLOR_ATTACHMENT0,b)):o[d]=Cs(this.gl,{id:"".concat(d,"-fb"),width:n,height:r,texture:b}),o[d].resize(h),l[d]=ys[m],(g||v)&&(g&&v&&y?a[d]=a[d]||Cs(this.gl,{id:"".concat(d,"-maxMinFb")}):(g&&(s[d]=s[d]||Cs(this.gl,{id:"".concat(d,"-minFb")})),v&&(u[d]=u[d]||Cs(this.gl,{id:"".concat(d,"-maxFb")}))))}}},{key:"setupModels",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.gridAggregationModel&&this.gridAggregationModel.delete(),this.gridAggregationModel=this.getAggregationModel(t),this.allAggregationModel&&this.allAggregationModel.delete(),this.allAggregationModel=this.getAllAggregationModel(t)}},{key:"setupWeightAttributes",value:function(t){var e=this.state,n=e.weightAttributes,r=e.vertexCount,i=e.weights;for(var a in i){var s=i[a].values;if(Array.isArray(s)||s.constructor===Float32Array){g(s.length/3===r);var u=Array.isArray(s)?new Float32Array(s):s;n[a]instanceof o.Buffer?n[a].setData(u):n[a]=new o.Buffer(this.gl,u)}else g(s instanceof o.Buffer),n[a]=s}}},{key:"updateModels",value:function(t){var e=this.gl,n=t.positions,r=t.positions64xyLow,i=t.changeFlags,a=this.state,s=a.numCol,u=a.numRow,c=this.state,l=c.positionsBuffer,f=c.positions64xyLowBuffer,h={},d=!1;if(t.fp64!==this.state.fp64&&(this.setupModels(t.fp64),this.setState({fp64:t.fp64}),t.fp64&&(d=!0)),i.dataChanged||!l){l&&l.delete();var p=n.length/2;l=new o.Buffer(e,new Float32Array(n)),d=t.fp64,Object.assign(h,{positions:l}),this.setState({positionsBuffer:l,vertexCount:p}),this.setupWeightAttributes(t),this.gridAggregationModel.setVertexCount(p)}d&&(g(r),f&&f.delete(),f=new o.Buffer(e,{size:2,data:new Float32Array(r)}),Object.assign(h,{positions64xyLow:f}),this.setState({positions64xyLowBuffer:f})),this.gridAggregationModel.setAttributes(h),(i.cellSizeChanged||i.viewportChanged)&&this.allAggregationModel.setInstanceCount(s*u)}}]),t}(),Fs=[],Ds=[];function Bs(t){var e=Fs,n={index:-1,data:t,target:[]};return t?"function"==typeof t[Symbol.iterator]?e=t:t.length>0&&(Ds.length=t.length,e=Ds):e=Fs,{iterable:e,objectInfo:n}}o.fp64.fp64LowPart;var zs={BinSorter:es,Tesselator:ss,linearScale:function(t,e,n){return(n-t[0])/(t[1]-t[0])*(e[1]-e[0])+e[0]},getLinearScale:function(t,e){return function(n){return(n-t[0])/(t[1]-t[0])*(e[1]-e[0])+e[0]}},quantizeScale:us,getQuantizeScale:function(t,e){return function(n){return us(t,e,n)}},defaultColorRange:[[255,255,178],[254,217,118],[254,178,76],[253,141,60],[240,59,32],[189,0,38]],flattenVertices:function t(e){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.result,i=void 0===r?[]:r,o=n.dimensions,a=void 0===o?3:o,s=-1,u=0;++s<e.length;){var c=e[s];Array.isArray(c)||ArrayBuffer.isView(c)?t(c,{result:i,dimensions:a}):u<a&&(i.push(c),u++)}return u>0&&u<a&&i.push(0),i},fillArray:on,count:te},Vs="#define SHADER_NAME arc-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\n\nvoid main(void) {\n  gl_FragColor = vColor;\n\n  // use highlight color if this fragment belongs to the selected object.\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n\n  // use picking color if rendering to picking FBO.\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n}\n";function Gs(t){return(Gs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Us(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ws(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function qs(t,e){return!e||"object"!==Gs(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Xs(t,e,n){return(Xs="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Hs(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function Hs(t){return(Hs=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ys(t,e){return(Ys=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Zs=o.fp64.fp64LowPart,Ks=[0,0,0,255],Js={fp64:!1,getSourcePosition:{type:"accessor",value:function(t){return t.sourcePosition}},getTargetPosition:{type:"accessor",value:function(t){return t.targetPosition}},getSourceColor:{type:"accessor",value:Ks},getTargetColor:{type:"accessor",value:Ks},getStrokeWidth:{type:"accessor",value:1},widthScale:{type:"number",value:1,min:0},strokeWidth:{deprecatedFor:"getStrokeWidth"}},Qs=function(t){function e(){return Us(this,e),qs(this,Hs(e).apply(this,arguments))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ys(t,e)}(e,t),n=e,(r=[{key:"getShaders",value:function(){return this.use64bitProjection()?{vs:"#define SHADER_NAME arc-layer-vertex-shader-64\n\nattribute vec3 positions;\nattribute vec4 instanceSourceColors;\nattribute vec4 instanceTargetColors;\n\nattribute vec4 instancePositions;\nattribute vec4 instancePositions64Low;\n\nattribute vec3 instancePickingColors;\nattribute float instanceWidths;\n\nuniform float numSegments;\nuniform float opacity;\nuniform float widthScale;\n\nvarying vec4 vColor;\n\nvec2 paraboloid_fp64(vec2 source[2], vec2 target[2], float ratio) {\n\n  vec2 x[2];\n  vec2_mix_fp64(source, target, ratio, x);\n  vec2 center[2];\n  vec2_mix_fp64(source, target, 0.5, center);\n\n  vec2 dSourceCenter = vec2_distance_fp64(source, center);\n  vec2 dXCenter = vec2_distance_fp64(x, center);\n  return mul_fp64(sum_fp64(dSourceCenter, dXCenter), sub_fp64(dSourceCenter, dXCenter));\n}\n\n// offset vector by strokeWidth pixels\n// offset_direction is -1 (left) or 1 (right)\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace * project_uViewportSize);\n  // rotate by 90 degrees\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n\n  vec2 offset_screenspace = dir_screenspace * offset_direction * instanceWidths * widthScale / 2.0;\n  vec2 offset_clipspace = project_pixel_to_clipspace(offset_screenspace).xy;\n\n  return offset_clipspace;\n}\n\nfloat getSegmentRatio(float index) {\n  return smoothstep(0.0, 1.0, index / (numSegments - 1.0));\n}\n\nvoid get_pos_fp64(vec2 source[2], vec2 target[2], float segmentRatio, out vec2 position[4]) {\n\n  vec2 vertex_height = paraboloid_fp64(source, target, segmentRatio);\n\n  vec2 position_temp[2];\n\n  vec2_mix_fp64(source, target, segmentRatio, position_temp);\n\n  position[0] = position_temp[0];\n  position[1] = position_temp[1];\n\n  if (vertex_height.x < 0.0 || (vertex_height.x == 0.0 && vertex_height.y <= 0.0)) {\n    vertex_height = vec2(0.0, 0.0);\n  }\n\n  position[2] = sqrt_fp64(vertex_height);\n  position[3] = vec2(1.0, 0.0);\n}\n\nvoid main(void) {\n  vec2 projected_source_coord[2];\n  vec2 projected_target_coord[2];\n\n  project_position_fp64(instancePositions.xy, instancePositions64Low.xy, projected_source_coord);\n  project_position_fp64(instancePositions.zw, instancePositions64Low.zw, projected_target_coord);\n\n  float segmentIndex = positions.x;\n  float segmentRatio = getSegmentRatio(segmentIndex);\n\n  // if it's the first point, use next - current as direction\n  // otherwise use current - prev\n  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));\n  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);\n\n  vec2 curr_pos_modelspace[4];\n\n  get_pos_fp64(projected_source_coord, projected_target_coord, segmentRatio,\n    curr_pos_modelspace);\n\n  vec2 next_pos_modelspace[4];\n\n  get_pos_fp64(projected_source_coord, projected_target_coord, nextSegmentRatio,\n    next_pos_modelspace);\n\n  vec4 curr_pos_clipspace = project_to_clipspace_fp64(curr_pos_modelspace);\n  vec4 next_pos_clipspace = project_to_clipspace_fp64(next_pos_modelspace);\n\n  vec2 offset = getExtrusionOffset(next_pos_clipspace.xy - curr_pos_clipspace.xy, positions.y);\n\n  gl_Position = curr_pos_clipspace + vec4(offset, 0.0, 0.0);\n\n  vec4 color = mix(instanceSourceColors, instanceTargetColors, segmentRatio) / 255.;\n  vColor = vec4(color.rgb, color.a * opacity);\n\n  // Set color to be rendered to picking fbo (also used to check for selection highlight).\n  picking_setPickingColor(instancePickingColors);\n}\n",fs:Vs,modules:["project64","picking"]}:{vs:"#define SHADER_NAME arc-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec4 instanceSourceColors;\nattribute vec4 instanceTargetColors;\nattribute vec4 instancePositions;\nattribute vec4 instancePositions64Low;\nattribute vec3 instancePickingColors;\nattribute float instanceWidths;\n\nuniform float numSegments;\nuniform float opacity;\nuniform float widthScale;\n\nvarying vec4 vColor;\n\nfloat paraboloid(vec2 source, vec2 target, float ratio) {\n\n  vec2 x = mix(source, target, ratio);\n  vec2 center = mix(source, target, 0.5);\n\n  float dSourceCenter = distance(source, center);\n  float dXCenter = distance(x, center);\n  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);\n}\n\n// offset vector by strokeWidth pixels\n// offset_direction is -1 (left) or 1 (right)\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace * project_uViewportSize);\n  // rotate by 90 degrees\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n\n  vec2 offset_screenspace = dir_screenspace * offset_direction * instanceWidths * widthScale / 2.0;\n  vec2 offset_clipspace = project_pixel_to_clipspace(offset_screenspace).xy;\n\n  return offset_clipspace;\n}\n\nfloat getSegmentRatio(float index) {\n  return smoothstep(0.0, 1.0, index / (numSegments - 1.0));\n}\n\nvec3 getPos(vec2 source, vec2 target, float segmentRatio) {\n  float vertex_height = paraboloid(source, target, segmentRatio);\n\n  return vec3(\n    mix(source, target, segmentRatio),\n    sqrt(max(0.0, vertex_height))\n  );\n}\n\nvoid main(void) {\n  vec2 source = project_position(vec3(instancePositions.xy, 0.0), instancePositions64Low.xy).xy;\n  vec2 target = project_position(vec3(instancePositions.zw, 0.0), instancePositions64Low.zw).xy;\n\n  float segmentIndex = positions.x;\n  float segmentRatio = getSegmentRatio(segmentIndex);\n  // if it's the first point, use next - current as direction\n  // otherwise use current - prev\n  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));\n  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);\n\n  vec3 currPos = getPos(source, target, segmentRatio);\n  vec3 nextPos = getPos(source, target, nextSegmentRatio);\n  vec4 curr = project_to_clipspace(vec4(currPos, 1.0));\n  vec4 next = project_to_clipspace(vec4(nextPos, 1.0));\n\n  // extrude\n  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, positions.y);\n  gl_Position = curr + vec4(offset, 0.0, 0.0);\n\n  vec4 color = mix(instanceSourceColors, instanceTargetColors, segmentRatio) / 255.;\n  vColor = vec4(color.rgb, color.a * opacity);\n\n  // Set color to be rendered to picking fbo (also used to check for selection highlight).\n  picking_setPickingColor(instancePickingColors);\n}\n",fs:Vs,modules:["picking"]}}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instancePositions:{size:4,transition:!0,accessor:["getSourcePosition","getTargetPosition"],update:this.calculateInstancePositions},instancePositions64Low:{size:4,accessor:["getSourcePosition","getTargetPosition"],update:this.calculateInstancePositions64Low},instanceSourceColors:{size:4,type:lt.a.UNSIGNED_BYTE,transition:!0,accessor:"getSourceColor",defaultValue:Ks},instanceTargetColors:{size:4,type:lt.a.UNSIGNED_BYTE,transition:!0,accessor:"getTargetColor",defaultValue:Ks},instanceWidths:{size:1,transition:!0,accessor:"getStrokeWidth",defaultValue:1}})}},{key:"updateState",value:function(t){var n=t.props,r=t.oldProps,i=t.changeFlags;if(Xs(Hs(e.prototype),"updateState",this).call(this,{props:n,oldProps:r,changeFlags:i}),n.fp64!==r.fp64){var o=this.context.gl;this.state.model&&this.state.model.delete(),this.setState({model:this._getModel(o)}),this.getAttributeManager().invalidateAll()}this.state.model.setUniforms({widthScale:n.widthScale})}},{key:"_getModel",value:function(t){for(var e=[],n=0;n<50;n++)e=e.concat([n,-1,0,n,1,0]);var r=new o.Model(t,Object.assign({},this.getShaders(),{id:this.props.id,geometry:new o.Geometry({drawMode:lt.a.TRIANGLE_STRIP,attributes:{positions:new Float32Array(e)}}),isInstanced:!0,shaderCache:this.context.shaderCache}));return r.setUniforms({numSegments:50}),r}},{key:"calculateInstancePositions",value:function(t){var e=this.props,n=e.data,r=e.getSourcePosition,i=e.getTargetPosition,o=t.value,a=t.size,s=0,u=!0,c=!1,l=void 0;try{for(var f,h=n[Symbol.iterator]();!(u=(f=h.next()).done);u=!0){var d=f.value,p=r(d),g=i(d);o[s+0]=p[0],o[s+1]=p[1],o[s+2]=g[0],o[s+3]=g[1],s+=a}}catch(t){c=!0,l=t}finally{try{u||null==h.return||h.return()}finally{if(c)throw l}}}},{key:"calculateInstancePositions64Low",value:function(t){var e=this.use64bitPositions();if(t.constant=!e,e){var n=this.props,r=n.data,i=n.getSourcePosition,o=n.getTargetPosition,a=t.value,s=t.size,u=0,c=!0,l=!1,f=void 0;try{for(var h,d=r[Symbol.iterator]();!(c=(h=d.next()).done);c=!0){var p=h.value,g=i(p),v=o(p);a[u+0]=Zs(g[0]),a[u+1]=Zs(g[1]),a[u+2]=Zs(v[0]),a[u+3]=Zs(v[1]),u+=s}}catch(t){l=!0,f=t}finally{try{c||null==d.return||d.return()}finally{if(l)throw f}}}else t.value=new Float32Array(4)}}])&&Ws(n.prototype,r),i&&Ws(n,i),e}(qe);Qs.layerName="ArcLayer",Qs.defaultProps=Js;function $s(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function tu(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var nu=lt.a.LINEAR_MIPMAP_LINEAR,ru=lt.a.LINEAR,iu=function(){};function ou(t,e,n){for(var r=0;r<e.length;r++){var i=e[r],o=i.icon,a=i.xOffset;t[o.url]=Object.assign({},o,{x:a,y:n})}}function au(t){for(var e=t.icons,n=t.buffer,r=t.maxCanvasWidth,i=0,o=0,a=0,s=[],u={},c=0;c<e.length;c++){var l=e[c];if(!u[l.url]){var f=l.height,h=l.width;i+h+n>r&&(ou(u,s,o),i=0,o=a+o+n,a=0,s=[]),s.push({icon:l,xOffset:i}),i=i+h+n,a=Math.max(a,f)}}var d;return s.length>0&&ou(u,s,o),{mapping:u,canvasHeight:(d=a+o+n,Math.pow(2,Math.ceil(Math.log2(d))))}}var su=function(){function t(e,n){var r=n.onUpdate,i=void 0===r?iu:r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.gl=e,this.onUpdate=i,this._getIcon=null,this._mapping={},this._texture=null,this._autoPacking=!1,this._canvas=null}var e,n,r;return e=t,(n=[{key:"getTexture",value:function(){return this._texture}},{key:"getIconMapping",value:function(t){var e=this._getIcon(t),n=this._autoPacking?e.url:e;return this._mapping[n]||{}}},{key:"setProps",value:function(t){var e=t.autoPacking,n=t.iconAtlas,r=t.iconMapping,i=t.data,o=t.getIcon;void 0!==e&&(this._autoPacking=e),o&&(this._getIcon=o),r&&(this._mapping=r),n&&this._updateIconAtlas(n),this._autoPacking&&(i||o)&&(this._canvas=this._canvas||document.createElement("canvas"),this._updateAutoPacking({data:i,buffer:4,maxCanvasWidth:1024}))}},{key:"_updateIconAtlas",value:function(t){var e,n=this;if(t instanceof o.Texture2D)t.setParameters((tu(e={},lt.a.TEXTURE_MIN_FILTER,nu),tu(e,lt.a.TEXTURE_MAG_FILTER,ru),e)),this._texture=t,this.onUpdate();else if("string"==typeof t){var r;Object(o.loadTextures)(this.gl,{urls:[t],parameters:(r={},tu(r,lt.a.TEXTURE_MIN_FILTER,nu),tu(r,lt.a.TEXTURE_MAG_FILTER,ru),r)}).then((function(t){var e=$s(t,1)[0];n._texture=e,n.onUpdate()}))}}},{key:"_updateAutoPacking",value:function(t){var e=t.data,n=t.buffer,r=t.maxCanvasWidth,i=Object.values(function(t,e){if(!t||!e)return null;var n={},r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=e(a.value);if(!u)throw new Error("Icon is missing.");if(!u.url)throw new Error("Icon url is missing.");n[u.url]||(n[u.url]=u)}}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(e,this._getIcon)||{});if(i.length>0){var a=au({icons:i,buffer:n,maxCanvasWidth:r}),s=a.mapping,u=a.canvasHeight;this._mapping=s,this._texture=new o.Texture2D(this.gl,{width:r,height:u}),this.onUpdate(),this._loadImages(i)}}},{key:"_loadImages",value:function(t){var e=this,n=this._canvas.getContext("2d"),r=this._texture.height,i=!0,a=!1,s=void 0;try{for(var u,c=function(){var t=u.value;Object(o.loadImages)({urls:[t.url]}).then((function(i){var o,a=$s(i,1)[0],s=e._mapping[t.url],u=s.x,c=s.y,l=s.width,f=s.height,h=function(t,e,n,r){var i=e.naturalWidth,o=e.naturalHeight;return n===i&&r===o?e:(t.canvas.height=r,t.canvas.width=n,t.clearRect(0,0,t.canvas.width,t.canvas.height),t.drawImage(e,0,0,i,o,0,0,n,r),t.canvas)}(n,a,l,f);e._texture.setSubImageData({data:h,x:u,y:r-c-f,width:l,height:f,parameters:(o={},tu(o,lt.a.TEXTURE_MIN_FILTER,nu),tu(o,lt.a.TEXTURE_MAG_FILTER,ru),tu(o,lt.a.UNPACK_FLIP_Y_WEBGL,!0),o)}),e._texture.generateMipmap(),e.onUpdate()}))},l=t[Symbol.iterator]();!(i=(u=l.next()).done);i=!0)c()}catch(t){a=!0,s=t}finally{try{i||null==l.return||l.return()}finally{if(a)throw s}}}}])&&eu(e.prototype,n),r&&eu(e,r),t}();function uu(t){return(uu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function cu(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function lu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function fu(t,e){return!e||"object"!==uu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function hu(t,e,n){return(hu="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=du(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function du(t){return(du=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function pu(t,e){return(pu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var gu=o.fp64.fp64LowPart,vu=[0,0,0,255],yu={iconAtlas:null,iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},fp64:!1,getPosition:{type:"accessor",value:function(t){return t.position}},getIcon:{type:"accessor",value:function(t){return t.icon}},getColor:{type:"accessor",value:vu},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0}},mu=function(t){function e(){return cu(this,e),fu(this,du(e).apply(this,arguments))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&pu(t,e)}(e,t),n=e,(r=[{key:"getShaders",value:function(){return{vs:'#define SHADER_NAME icon-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec2 instancePositions64xyLow;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute vec4 instanceIconFrames;\nattribute float instanceColorModes;\nattribute vec2 instanceOffsets;\n\nuniform float sizeScale;\nuniform vec2 iconsTextureDim;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = angle * PI / 180.0;\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  vec2 iconSize = instanceIconFrames.zw;\n  // scale icon height to match instanceSize\n  float instanceScale = iconSize.y == 0.0 ? 0.0 : instanceSizes / iconSize.y;\n\n  // scale and rotate vertex in "pixel" value and convert back to fraction in clipspace\n  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * sizeScale * instanceScale;\n  pixelOffset.y *= -1.0;\n\n  gl_Position = project_position_to_clipspace(instancePositions, instancePositions64xyLow, vec3(0.0));\n  gl_Position += project_pixel_to_clipspace(pixelOffset);\n\n  vTextureCoords = mix(\n    instanceIconFrames.xy,\n    instanceIconFrames.xy + iconSize,\n    (positions.xy + 1.0) / 2.0\n  ) / iconsTextureDim;\n\n  vTextureCoords.y = 1.0 - vTextureCoords.y;\n\n  vColor = instanceColors / 255.;\n\n  vColorMode = instanceColorModes;\n\n  // Set color to be rendered to picking fbo (also used to check for selection highlight).\n  picking_setPickingColor(instancePickingColors);\n}\n',fs:"#define SHADER_NAME icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\n\nconst float MIN_ALPHA = 0.05;\n\nvoid main(void) {\n  vec4 texColor = texture2D(iconsTexture, vTextureCoords);\n\n  // if colorMode == 0, use pixel color from the texture\n  // if colorMode == 1 or rendering picking buffer, use texture as transparency mask\n  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);\n  // Take the global opacity and the alpha from vColor into account for the alpha component\n  float a = texColor.a * opacity * vColor.a;\n\n  if (a < MIN_ALPHA) {\n    discard;\n  }\n\n  gl_FragColor = vec4(color, a);\n\n  // use highlight color if this fragment belongs to the selected object.\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n\n  // use picking color if rendering to picking FBO.\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n}\n",modules:[this.use64bitProjection()?"project64":"project32","picking"]}}},{key:"initializeState",value:function(){var t=this;this.state={iconManager:new su(this.context.gl,{onUpdate:function(){return t._onUpdate()}})},this.getAttributeManager().addInstanced({instancePositions:{size:3,transition:!0,accessor:"getPosition"},instancePositions64xyLow:{size:2,accessor:"getPosition",update:this.calculateInstancePositions64xyLow},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",update:this.calculateInstanceOffsets},instanceIconFrames:{size:4,accessor:"getIcon",update:this.calculateInstanceIconFrames},instanceColorModes:{size:1,type:lt.a.UNSIGNED_BYTE,accessor:"getIcon",update:this.calculateInstanceColorMode},instanceColors:{size:4,type:lt.a.UNSIGNED_BYTE,transition:!0,accessor:"getColor",defaultValue:vu},instanceAngles:{size:1,transition:!0,accessor:"getAngle",defaultValue:0}})}},{key:"updateState",value:function(t){var n=t.oldProps,r=t.props,i=t.changeFlags;hu(du(e.prototype),"updateState",this).call(this,{props:r,oldProps:n,changeFlags:i});var o=this.getAttributeManager(),a=this.state.iconManager,s=r.iconAtlas,u=r.iconMapping,c=r.data,l=r.getIcon,f=!1;if(s?(n.iconAtlas!==r.iconAtlas&&a.setProps({iconAtlas:s,autoPacking:!1}),n.iconMapping!==r.iconMapping&&(a.setProps({iconMapping:u}),f=!0)):a.setProps({autoPacking:!0}),(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getIcon))&&(a.setProps({data:c,getIcon:l}),f=!0),f&&(o.invalidate("instanceOffsets"),o.invalidate("instanceIconFrames"),o.invalidate("instanceColorModes")),r.fp64!==n.fp64){var h=this.context.gl;this.state.model&&this.state.model.delete(),this.setState({model:this._getModel(h)}),o.invalidateAll()}}},{key:"draw",value:function(t){var e=t.uniforms,n=this.props.sizeScale,r=this.state.iconManager.getTexture();r&&this.state.model.render(Object.assign({},e,{iconsTexture:r,iconsTextureDim:[r.width,r.height],sizeScale:n}))}},{key:"_getModel",value:function(t){return new o.Model(t,Object.assign({},this.getShaders(),{id:this.props.id,geometry:new o.Geometry({drawMode:lt.a.TRIANGLE_FAN,attributes:{positions:new Float32Array([-1,-1,0,-1,1,0,1,1,0,1,-1,0])}}),isInstanced:!0,shaderCache:this.context.shaderCache}))}},{key:"_onUpdate",value:function(){this.setNeedsRedraw()}},{key:"calculateInstancePositions64xyLow",value:function(t){var e=this.use64bitPositions();if(t.constant=!e,e){var n=this.props,r=n.data,i=n.getPosition,o=t.value,a=0,s=!0,u=!1,c=void 0;try{for(var l,f=r[Symbol.iterator]();!(s=(l=f.next()).done);s=!0){var h=i(l.value);o[a++]=gu(h[0]),o[a++]=gu(h[1])}}catch(t){u=!0,c=t}finally{try{s||null==f.return||f.return()}finally{if(u)throw c}}}else t.value=new Float32Array(2)}},{key:"calculateInstanceOffsets",value:function(t){var e=this.props.data,n=this.state.iconManager,r=t.value,i=0,o=!0,a=!1,s=void 0;try{for(var u,c=e[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var l=u.value,f=n.getIconMapping(l);r[i++]=f.width/2-f.anchorX||0,r[i++]=f.height/2-f.anchorY||0}}catch(t){a=!0,s=t}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}}},{key:"calculateInstanceColorMode",value:function(t){var e=this.props.data,n=this.state.iconManager,r=t.value,i=0,o=!0,a=!1,s=void 0;try{for(var u,c=e[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var l=u.value,f=n.getIconMapping(l).mask;r[i++]=f?1:0}}catch(t){a=!0,s=t}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}}},{key:"calculateInstanceIconFrames",value:function(t){var e=this.props.data,n=this.state.iconManager,r=t.value,i=0,o=!0,a=!1,s=void 0;try{for(var u,c=e[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var l=u.value,f=n.getIconMapping(l);r[i++]=f.x||0,r[i++]=f.y||0,r[i++]=f.width||0,r[i++]=f.height||0}}catch(t){a=!0,s=t}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}}}])&&lu(n.prototype,r),i&&lu(n,i),e}(qe);mu.layerName="IconLayer",mu.defaultProps=yu;function bu(t){return(bu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function xu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function wu(t,e){return!e||"object"!==bu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Eu(t,e,n){return(Eu="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Su(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function Su(t){return(Su=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ou(t,e){return(Ou=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Pu=o.fp64.fp64LowPart,Cu={fp64:!1,getSourcePosition:{type:"accessor",value:function(t){return t.sourcePosition}},getTargetPosition:{type:"accessor",value:function(t){return t.targetPosition}},getColor:{type:"accessor",value:[0,0,0,255]},getStrokeWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getStrokeWidth"}},Mu=function(t){function e(){return _u(this,e),wu(this,Su(e).apply(this,arguments))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ou(t,e)}(e,t),n=e,(r=[{key:"getShaders",value:function(){return{vs:"#define SHADER_NAME line-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 instanceSourcePositions;\nattribute vec3 instanceTargetPositions;\nattribute vec4 instanceSourceTargetPositions64xyLow;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute float instanceWidths;\n\nuniform float opacity;\n\nvarying vec4 vColor;\n\n// offset vector by strokeWidth pixels\n// offset_direction is -1 (left) or 1 (right)\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace * project_uViewportSize);\n  // rotate by 90 degrees\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n\n  vec2 offset_screenspace = dir_screenspace * offset_direction * instanceWidths / 2.0;\n  vec2 offset_clipspace = project_pixel_to_clipspace(offset_screenspace).xy;\n\n  return offset_clipspace;\n}\n\nvoid main(void) {\n  // Position\n  vec4 source = project_position_to_clipspace(instanceSourcePositions, instanceSourceTargetPositions64xyLow.xy, vec3(0.));\n  vec4 target = project_position_to_clipspace(instanceTargetPositions, instanceSourceTargetPositions64xyLow.zw, vec3(0.));\n\n  // linear interpolation of source & target to pick right coord\n  float segmentIndex = positions.x;\n  vec4 p = mix(source, target, segmentIndex);\n\n  // extrude\n  vec2 offset = getExtrusionOffset(target.xy - source.xy, positions.y);\n  gl_Position = p + vec4(offset, 0.0, 0.0);\n\n  // Color\n  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity) / 255.;\n\n  // Set color to be rendered to picking fbo (also used to check for selection highlight).\n  picking_setPickingColor(instancePickingColors);\n}\n",fs:"#define SHADER_NAME line-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\n\nvoid main(void) {\n  gl_FragColor = vColor;\n\n  // use highlight color if this fragment belongs to the selected object.\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n\n  // use picking color if rendering to picking FBO.\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n}\n",modules:[this.use64bitProjection()?"project64":"project32","picking"]}}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instanceSourcePositions:{size:3,transition:!0,accessor:"getSourcePosition"},instanceTargetPositions:{size:3,transition:!0,accessor:"getTargetPosition"},instanceSourceTargetPositions64xyLow:{size:4,accessor:["getSourcePosition","getTargetPosition"],update:this.calculateInstanceSourceTargetPositions64xyLow},instanceColors:{size:4,type:lt.a.UNSIGNED_BYTE,transition:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceWidths:{size:1,transition:!0,accessor:"getStrokeWidth",defaultValue:1}})}},{key:"updateState",value:function(t){var n=t.props,r=t.oldProps,i=t.changeFlags;if(Eu(Su(e.prototype),"updateState",this).call(this,{props:n,oldProps:r,changeFlags:i}),n.fp64!==r.fp64){var o=this.context.gl;this.state.model&&this.state.model.delete(),this.setState({model:this._getModel(o)}),this.getAttributeManager().invalidateAll()}}},{key:"_getModel",value:function(t){return new o.Model(t,Object.assign({},this.getShaders(),{id:this.props.id,geometry:new o.Geometry({drawMode:lt.a.TRIANGLE_STRIP,attributes:{positions:new Float32Array([0,-1,0,0,1,0,1,-1,0,1,1,0])}}),isInstanced:!0,shaderCache:this.context.shaderCache}))}},{key:"calculateInstanceSourceTargetPositions64xyLow",value:function(t){var e=this.use64bitPositions();if(t.constant=!e,e){var n=this.props,r=n.data,i=n.getSourcePosition,o=n.getTargetPosition,a=t.value,s=t.size,u=0,c=!0,l=!1,f=void 0;try{for(var h,d=r[Symbol.iterator]();!(c=(h=d.next()).done);c=!0){var p=h.value,g=i(p),v=o(p);a[u+0]=Pu(g[0]),a[u+1]=Pu(g[1]),a[u+2]=Pu(v[0]),a[u+3]=Pu(v[1]),u+=s}}catch(t){l=!0,f=t}finally{try{c||null==d.return||d.return()}finally{if(l)throw f}}}else t.value=new Float32Array(4)}}])&&xu(n.prototype,r),i&&xu(n,i),e}(qe);Mu.layerName="LineLayer",Mu.defaultProps=Cu;function Iu(t){return(Iu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Au(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Tu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Nu(t,e){return!e||"object"!==Iu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Lu(t,e,n){return(Lu="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ru(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function Ru(t){return(Ru=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ku(t,e){return(ku=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ju=o.fp64.fp64LowPart,Fu=[0,0,0,255],Du=[0,0,1],Bu={radiusPixels:{type:"number",min:0,value:10},fp64:!1,getPosition:{type:"accessor",value:function(t){return t.position}},getNormal:{type:"accessor",value:Du},getColor:{type:"accessor",value:Fu},lightSettings:{}},zu=function(t){function e(){return Au(this,e),Nu(this,Ru(e).apply(this,arguments))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ku(t,e)}(e,t),n=e,(r=[{key:"getShaders",value:function(t){return{vs:"#define SHADER_NAME point-cloud-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 instanceNormals;\nattribute vec4 instanceColors;\nattribute vec3 instancePositions;\nattribute vec2 instancePositions64xyLow;\nattribute vec3 instancePickingColors;\n\nuniform float opacity;\nuniform float radiusPixels;\n\nvarying vec4 vColor;\nvarying vec2 unitPosition;\n\nvoid main(void) {\n  // position on the containing square in [-1, 1] space\n  unitPosition = positions.xy;\n\n  // Find the center of the point and add the current vertex\n  vec4 position_worldspace;\n  gl_Position = project_position_to_clipspace(instancePositions, instancePositions64xyLow, vec3(0.), position_worldspace);\n  gl_Position += project_pixel_to_clipspace(positions.xy * radiusPixels);\n\n  // Apply lighting\n  float lightWeight = lighting_getLightWeight(position_worldspace.xyz, // the w component is always 1.0\n    project_normal(instanceNormals));\n\n  // Apply opacity to instance color, or return instance picking color\n  vColor = vec4(lightWeight * instanceColors.rgb, instanceColors.a * opacity) / 255.;\n\n  // Set color to be rendered to picking fbo (also used to check for selection highlight).\n  picking_setPickingColor(instancePickingColors);\n}\n",fs:"#define SHADER_NAME point-cloud-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\nvarying vec2 unitPosition;\n\nvoid main(void) {\n\n  float distToCenter = length(unitPosition);\n\n  if (distToCenter > 1.0) {\n    discard;\n  }\n\n  gl_FragColor = vColor;\n\n  // use highlight color if this fragment belongs to the selected object.\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n\n  // use picking color if rendering to picking FBO.\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n}\n",modules:[this.use64bitProjection()?"project64":"project32","lighting","picking"]}}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instancePositions:{size:3,transition:!0,accessor:"getPosition"},instancePositions64xyLow:{size:2,accessor:"getPosition",update:this.calculateInstancePositions64xyLow},instanceNormals:{size:3,transition:!0,accessor:"getNormal",defaultValue:Du},instanceColors:{size:4,type:lt.a.UNSIGNED_BYTE,transition:!0,accessor:"getColor",defaultValue:Fu}})}},{key:"updateState",value:function(t){var n=t.props,r=t.oldProps,i=t.changeFlags;if(Lu(Ru(e.prototype),"updateState",this).call(this,{props:n,oldProps:r,changeFlags:i}),n.fp64!==r.fp64){var o=this.context.gl;this.state.model&&this.state.model.delete(),this.setState({model:this._getModel(o)}),this.getAttributeManager().invalidateAll()}}},{key:"draw",value:function(t){var e=t.uniforms,n=this.props.radiusPixels;this.state.model.render(Object.assign({},e,{radiusPixels:n}))}},{key:"_getModel",value:function(t){for(var e=[],n=0;n<3;n++){var r=n/3*Math.PI*2;e.push(2*Math.cos(r),2*Math.sin(r),0)}return new o.Model(t,Object.assign({},this.getShaders(),{id:this.props.id,geometry:new o.Geometry({drawMode:lt.a.TRIANGLES,attributes:{positions:new Float32Array(e)}}),isInstanced:!0,shaderCache:this.context.shaderCache}))}},{key:"calculateInstancePositions64xyLow",value:function(t){var e=this.use64bitPositions();if(t.constant=!e,e){var n=this.props,r=n.data,i=n.getPosition,o=t.value,a=0,s=!0,u=!1,c=void 0;try{for(var l,f=r[Symbol.iterator]();!(s=(l=f.next()).done);s=!0){var h=i(l.value);o[a++]=ju(h[0]),o[a++]=ju(h[1])}}catch(t){u=!0,c=t}finally{try{s||null==f.return||f.return()}finally{if(u)throw c}}}else t.value=new Float32Array(2)}}])&&Tu(n.prototype,r),i&&Tu(n,i),e}(qe);zu.layerName="PointCloudLayer",zu.defaultProps=Bu;function Vu(t){return(Vu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Gu(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Uu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Wu(t,e){return!e||"object"!==Vu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function qu(t,e,n){return(qu="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Xu(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function Xu(t){return(Xu=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Hu(t,e){return(Hu=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Yu=o.fp64.fp64LowPart,Zu=[0,0,0,255],Ku={radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,fp64:!1,filled:!0,getPosition:{type:"accessor",value:function(t){return t.position}},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:Zu},getLineColor:{type:"accessor",value:Zu},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}},Ju=function(t){function e(){return Gu(this,e),Wu(this,Xu(e).apply(this,arguments))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Hu(t,e)}(e,t),n=e,(r=[{key:"getShaders",value:function(t){return{vs:"#define SHADER_NAME scatterplot-layer-vertex-shader\n\nattribute vec3 positions;\n\nattribute vec3 instancePositions;\nattribute vec2 instancePositions64xyLow;\nattribute float instanceRadius;\nattribute float instanceLineWidths;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\nuniform float opacity;\nuniform float radiusScale;\nuniform float radiusMinPixels;\nuniform float radiusMaxPixels;\nuniform float lineWidthScale;\nuniform float lineWidthMinPixels;\nuniform float lineWidthMaxPixels;\nuniform float stroked;\nuniform bool filled;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\n\nvoid main(void) {\n  // Multiply out radius and clamp to limits\n  float outerRadiusPixels = clamp(\n    project_scale(radiusScale * instanceRadius),\n    radiusMinPixels, radiusMaxPixels\n  );\n  \n  // Multiply out line width and clamp to limits\n  float lineWidth = clamp(\n    project_scale(lineWidthScale * instanceLineWidths), \n    lineWidthMinPixels, lineWidthMaxPixels\n  );\n\n  // outer radius needs to offset by half stroke width\n  outerRadiusPixels += stroked * lineWidth / 2.0;\n\n  // position on the containing square in [-1, 1] space\n  unitPosition = positions.xy;\n\n  innerUnitRadius = 1.0 - stroked * lineWidth / outerRadiusPixels;\n  \n  vec3 offset = positions * outerRadiusPixels;\n  gl_Position = project_position_to_clipspace(instancePositions, instancePositions64xyLow, offset);\n\n  // Apply opacity to instance color, or return instance picking color\n  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity) / 255.;\n  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity) / 255.;\n  \n  // Set color to be rendered to picking fbo (also used to check for selection highlight).\n  picking_setPickingColor(instancePickingColors);\n}\n",fs:"#define SHADER_NAME scatterplot-layer-fragment-shader\n\nprecision highp float;\n\nuniform bool filled;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\n\nvoid main(void) {\n\n  float distToCenter = length(unitPosition);\n\n  if (distToCenter > 1.0) {\n    discard;\n  } \n  if (distToCenter > innerUnitRadius) {\n    gl_FragColor = vLineColor;\n  } else if (filled) {\n    gl_FragColor = vFillColor;\n  } else {\n    discard;\n  }\n\n  // use highlight color if this fragment belongs to the selected object.\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n\n  // use picking color if rendering to picking FBO.\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n}\n",modules:[this.use64bitProjection()?"project64":"project32","picking"]}}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instancePositions:{size:3,transition:!0,accessor:"getPosition"},instancePositions64xyLow:{size:2,accessor:"getPosition",update:this.calculateInstancePositions64xyLow},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:4,transition:!0,type:lt.a.UNSIGNED_BYTE,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,type:lt.a.UNSIGNED_BYTE,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}},{key:"updateState",value:function(t){var n=t.props,r=t.oldProps,i=t.changeFlags;if(qu(Xu(e.prototype),"updateState",this).call(this,{props:n,oldProps:r,changeFlags:i}),n.fp64!==r.fp64){var o=this.context.gl;this.state.model&&this.state.model.delete(),this.setState({model:this._getModel(o)}),this.getAttributeManager().invalidateAll()}}},{key:"draw",value:function(t){var e=t.uniforms,n=this.props,r=n.radiusScale,i=n.radiusMinPixels,o=n.radiusMaxPixels,a=n.stroked,s=n.filled,u=n.lineWidthScale,c=n.lineWidthMinPixels,l=n.lineWidthMaxPixels;this.state.model.render(Object.assign({},e,{stroked:a?1:0,filled:s,radiusScale:r,radiusMinPixels:i,radiusMaxPixels:o,lineWidthScale:u,lineWidthMinPixels:c,lineWidthMaxPixels:l}))}},{key:"_getModel",value:function(t){return new o.Model(t,Object.assign(this.getShaders(),{id:this.props.id,geometry:new o.Geometry({drawMode:lt.a.TRIANGLE_FAN,attributes:{positions:new Float32Array([-1,-1,0,-1,1,0,1,1,0,1,-1,0])}}),isInstanced:!0,shaderCache:this.context.shaderCache}))}},{key:"calculateInstancePositions64xyLow",value:function(t){var e=this.use64bitPositions();if(t.constant=!e,e){var n=this.props,r=n.data,i=n.getPosition,o=t.value,a=0,s=!0,u=!1,c=void 0;try{for(var l,f=r[Symbol.iterator]();!(s=(l=f.next()).done);s=!0){var h=i(l.value);o[a++]=Yu(h[0]),o[a++]=Yu(h[1])}}catch(t){u=!0,c=t}finally{try{s||null==f.return||f.return()}finally{if(u)throw c}}}else t.value=new Float32Array(2)}}])&&Uu(n.prototype,r),i&&Uu(n,i),e}(qe);Ju.layerName="ScatterplotLayer",Ju.defaultProps=Ku;function Qu(t){return(Qu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function tc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ec(t,e){return!e||"object"!==Qu(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function nc(t,e,n){return(nc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=rc(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function rc(t){return(rc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ic(t,e){return(ic=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var oc=zs.count,ac=[0,0,0,0],sc=[0,255,0,255],uc=["minColor","maxColor","colorRange","colorDomain"],cc={cellSizePixels:{value:100,min:1},cellMarginPixels:{value:2,min:0,max:5},colorDomain:null,colorRange:zs.defaultColorRange,getPosition:{type:"accessor",value:function(t){return t.position}},getWeight:{type:"accessor",value:function(t){return[1,0,0]}},gpuAggregation:!0,aggregation:"SUM"},lc=function(t){function e(){return $u(this,e),ec(this,rc(e).apply(this,arguments))}var n,r,a;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ic(t,e)}(e,t),n=e,(r=[{key:"getShaders",value:function(){var t=Object(o.isWebGL2)(this.context.gl)?{vs:"#version 300 es\n#define SHADER_NAME screen-grid-layer-vertex-shader\n#define RANGE_COUNT 6\n\nin vec3 vertices;\nin vec3 instancePositions;\nin vec4 instanceCounts;\nin vec3 instancePickingColors;\n\nlayout(std140) uniform;\nuniform float opacity;\nuniform vec3 cellScale;\nuniform vec4 minColor;\nuniform vec4 maxColor;\nuniform AggregationData\n{\n  vec4 maxCount;\n} aggregationData;\n\nuniform vec4 colorRange[RANGE_COUNT];\nuniform vec2 colorDomain;\nuniform bool shouldUseMinMax;\n\nout vec4 vColor;\nout float vSampleCount;\n\nvec4 quantizeScale(vec2 domain, vec4 range[RANGE_COUNT], float value) {\n  vec4 outColor = vec4(0., 0., 0., 0.);\n  if (value >= domain.x && value <= domain.y) {\n    float domainRange = domain.y - domain.x;\n    if (domainRange <= 0.) {\n      outColor = colorRange[0];\n    } else {\n      float rangeCount = float(RANGE_COUNT);\n      float rangeStep = domainRange / rangeCount;\n      float idx = floor((value - domain.x) / rangeStep);\n      idx = clamp(idx, 0., rangeCount - 1.);\n      int intIdx = int(idx);\n      outColor = colorRange[intIdx];\n    }\n  }\n  outColor = outColor / 255.;\n  return outColor;\n}\n\nvoid main(void) {\n  vSampleCount = instanceCounts.a;\n\n  float weight = instanceCounts.r ;\n  float maxWeight = aggregationData.maxCount.r;\n  float step = weight / maxWeight;\n  vec4 minMaxColor = mix(minColor, maxColor, step) / 255.;\n\n  vec2 domain = colorDomain;\n  float domainMaxValid = float(colorDomain.y != 0.);\n  domain.y = mix(maxWeight, colorDomain.y, domainMaxValid);\n  vec4 rangeColor = quantizeScale(domain, colorRange, weight);\n\n  float rangeMinMax = float(shouldUseMinMax);\n  vec4 color = mix(rangeColor, minMaxColor, rangeMinMax);\n  vColor = vec4(color.rgb, color.a * opacity);\n\n  // Set color to be rendered to picking fbo (also used to check for selection highlight).\n  picking_setPickingColor(instancePickingColors);\n\n  gl_Position = vec4(instancePositions + vertices * cellScale, 1.);\n}\n",fs:"#version 300 es\n#define SHADER_NAME screen-grid-layer-fragment-shader\n\nprecision highp float;\n\nin vec4 vColor;\nin float vSampleCount;\nout vec4 fragColor;\n\nvoid main(void) {\n  if (vSampleCount <= 0.0) {\n    discard;\n  }\n  fragColor = vColor;\n\n  fragColor = picking_filterColor(fragColor);\n}\n"}:{vs:"#define SHADER_NAME screen-grid-layer-vertex-shader-webgl1\n#define RANGE_COUNT 6\n\nattribute vec3 vertices;\nattribute vec3 instancePositions;\nattribute vec4 instanceCounts;\nattribute vec3 instancePickingColors;\n\nuniform float opacity;\nuniform vec3 cellScale;\nuniform vec4 minColor;\nuniform vec4 maxColor;\nuniform float maxWeight;\nuniform vec4 colorRange[RANGE_COUNT];\nuniform vec2 colorDomain;\nuniform bool shouldUseMinMax;\n\nvarying vec4 vColor;\nvarying float vSampleCount;\n\nvec4 quantizeScale(vec2 domain, vec4 range[RANGE_COUNT], float value) {\n  vec4 outColor = vec4(0., 0., 0., 0.);\n  if (value >= domain.x && value <= domain.y) {\n    float domainRange = domain.y - domain.x;\n    if (domainRange <= 0.) {\n      outColor = colorRange[0];\n    } else {\n      float rangeCount = float(RANGE_COUNT);\n      float rangeStep = domainRange / rangeCount;\n      float idx = floor((value - domain.x) / rangeStep);\n      idx = clamp(idx, 0., rangeCount - 1.);\n      int intIdx = int(idx);\n      outColor = colorRange[intIdx];\n    }\n  }\n  outColor = outColor / 255.;\n  return outColor;\n}\n\nvoid main(void) {\n  vSampleCount = instanceCounts.a;\n\n  float weight = instanceCounts.r;\n  float step = weight / maxWeight;\n  vec4 minMaxColor = mix(minColor, maxColor, step) / 255.;\n\n  vec2 domain = colorDomain;\n  float domainMaxValid = float(colorDomain.y != 0.);\n  domain.y = mix(maxWeight, colorDomain.y, domainMaxValid);\n  vec4 rangeColor = quantizeScale(domain, colorRange, weight);\n\n  float rangeMinMax = float(shouldUseMinMax);\n  vec4 color = mix(rangeColor, minMaxColor, rangeMinMax);\n  vColor = vec4(color.rgb, color.a * opacity);\n\n  // Set color to be rendered to picking fbo (also used to check for selection highlight).\n  picking_setPickingColor(instancePickingColors);\n\n  gl_Position = vec4(instancePositions + vertices * cellScale, 1.);\n}\n",fs:"#define SHADER_NAME screen-grid-layer-fragment-shader-webgl1\n\nprecision highp float;\n\nvarying vec4 vColor;\nvarying float vSampleCount;\n\nvoid main(void) {\n  if (vSampleCount <= 0.0) {\n    discard;\n  }\n  gl_FragColor = vColor;\n\n  gl_FragColor = picking_filterColor(gl_FragColor);\n}\n"};return t.modules=["picking"],t}},{key:"initializeState",value:function(){var t=this.getAttributeManager(),e=this.context.gl;t.addInstanced({instancePositions:{size:3,update:this.calculateInstancePositions},instanceCounts:{size:4,transition:!0,accessor:["getPosition","getWeight"],update:this.calculateInstanceCounts,noAlloc:!0}});var n={id:"".concat(this.id,"-aggregator"),shaderCache:this.context.shaderCache},r=this._getMaxCountBuffer(e),i={color:{size:1,operation:ls.SUM,needMax:!0,maxBuffer:r}};this.setState({model:this._getModel(e),gpuGridAggregator:new js(e,n),maxBuffer:r,weights:i,aggregationResults:null}),this._setupUniformBuffer()}},{key:"shouldUpdateState",value:function(t){return t.changeFlags.somethingChanged}},{key:"updateState",value:function(t){nc(rc(e.prototype),"updateState",this).call(this,t),this._updateUniforms(t),t.changeFlags.dataChanged&&this._processData();var n=this._getAggregationChangeFlags(t);n&&this._updateAggregation(n)}},{key:"draw",value:function(t){var e=t.uniforms,n=this.context.gl,r=this.props.parameters,i=void 0===r?{}:r,a=this.props.minColor||ac,s=this.props.maxColor||sc,u=this.props.colorDomain||[1,0],c=this.state,l=c.model,f=c.maxBuffer,h=c.cellScale,d=c.shouldUseMinMax,p=c.colorRange,g=c.maxWeight,v={minColor:a,maxColor:s,cellScale:h,colorRange:p,colorDomain:u,shouldUseMinMax:d};Object(o.isWebGL2)(n)?f.bind({target:lt.a.UNIFORM_BUFFER}):v.maxWeight=g,e=Object.assign(v,e),l.draw({uniforms:e,parameters:Object.assign({depthTest:!1,depthMask:!1},i)}),Object(o.isWebGL2)(n)&&f.unbind()}},{key:"calculateInstancePositions",value:function(t,e){for(var n=e.numInstances,r=this.context.viewport,i=r.width,o=r.height,a=this.props.cellSizePixels,s=this.state.numCol,u=t.value,c=t.size,l=0;l<n;l++){var f=l%s,h=Math.floor(l/s);u[l*c+0]=f*a/i*2-1,u[l*c+1]=1-h*a/o*2,u[l*c+2]=0}}},{key:"calculateInstanceCounts",value:function(t,e){e.numInstances;var n=this.state.aggregationBuffer;t.update({buffer:n})}},{key:"getPickingInfo",value:function(t){var e=t.info,n=(t.mode,e.index);if(n>=0){var r=this.state.aggregationResults;r.aggregationData=r.aggregationData||this.state.aggregationBuffer.getData(),r.maxData=r.maxData||this.state.maxBuffer.getData();var i=r.aggregationData,o=r.maxData;e.object=js.getAggregationData({aggregationData:i,maxData:o,pixelIndex:n})}return e}},{key:"_getAggregationChangeFlags",value:function(t){var e=t.oldProps,n=t.props,r=t.changeFlags,i=n.cellSizePixels!==e.cellSizePixels||n.cellMarginPixels!==e.cellMarginPixels,o=r.dataChanged||n.aggregation!==e.aggregation,a=r.viewportChanged;return i||o||a?{cellSizeChanged:i,dataChanged:o,viewportChanged:a}:null}},{key:"_getModel",value:function(t){return new o.Model(t,Object.assign({},this.getShaders(),{id:this.props.id,geometry:new o.Geometry({drawMode:lt.a.TRIANGLE_FAN,attributes:{vertices:new Float32Array([0,0,0,1,0,0,1,1,0,0,1,0])}}),isInstanced:!0,shaderCache:this.context.shaderCache}))}},{key:"_getMaxCountBuffer",value:function(t){return new o.Buffer(t,{bytes:16,size:4,index:0})}},{key:"_processData",value:function(){var t=this.props,e=t.data,n=t.getPosition,r=t.getWeight,i=oc(e),o=new Float64Array(2*i),a=new Float32Array(3*i),s=this.state.weights,u=Bs(e),c=u.iterable,l=u.objectInfo,f=!0,h=!1,d=void 0;try{for(var p,g=c[Symbol.iterator]();!(f=(p=g.next()).done);f=!0){var v=p.value;l.index++;var y=n(v,l),m=r(v,l),b=l.index;o[2*b]=y[0],o[2*b+1]=y[1],Array.isArray(m)?(a[3*b]=m[0],a[3*b+1]=m[1],a[3*b+2]=m[2]):a[3*b]=m}}catch(t){h=!0,d=t}finally{try{f||null==g.return||g.return()}finally{if(h)throw d}}s.color.values=a,this.setState({positions:o})}},{key:"_setupUniformBuffer",value:function(){var t=this.context.gl;if(Object(o.isWebGL2)(t)){var e=this.state.model.program.handle,n=t.getUniformBlockIndex(e,"AggregationData");t.uniformBlockBinding(e,n,0)}}},{key:"_shouldUseMinMax",value:function(){var t=this.props,e=t.minColor,n=t.maxColor,r=t.colorDomain,o=t.colorRange;return e||n?(i.deprecated("ScreenGridLayer props: minColor and maxColor","colorRange, colorDomain")(),!0):!r&&!o}},{key:"_updateAggregation",value:function(t){var e=this.getAttributeManager();(t.cellSizeChanged||t.viewportChanged)&&(this._updateGridParams(),e.invalidateAll());var n=this.props,r=n.cellSizePixels,i=n.gpuAggregation,o=this.state,a=o.positions,s=o.weights,u=this.context.viewport;s.color.operation=ls[this.props.aggregation.toUpperCase()]||ls.SUM;var c=!1,l=null;this.context.viewport instanceof nr?c=!0:(c=!1,l=u.pixelProjectionMatrix);var f=this.state.gpuGridAggregator.run({positions:a,weights:s,cellSize:[r,r],viewport:u,changeFlags:t,useGPU:i,projectPoints:c,gridTransformMatrix:l}),h=f.color.maxData&&Number.isFinite(f.color.maxData[0])?f.color.maxData[0]:0,d={aggregationData:f.color.aggregationData,maxData:f.color.maxData};this.setState({aggregationResults:d,maxWeight:h}),e.invalidate("instanceCounts")}},{key:"_updateUniforms",value:function(t){var e=t.oldProps,n=t.props,r=t.changeFlags,i={};if(uc.some((function(t){return e[t]!==n[t]}))&&(i.shouldUseMinMax=this._shouldUseMinMax()),e.colorRange!==n.colorRange){var o=[];n.colorRange.forEach((function(t){o.push(t[0],t[1],t[2],t[3]||255)})),i.colorRange=o}if(e.cellMarginPixels!==n.cellMarginPixels||e.cellSizePixels!==n.cellSizePixels||r.viewportChanged){var a=this.context.viewport,s=a.width,u=a.height,c=this.props,l=c.cellSizePixels,f=c.cellMarginPixels,h=l>f?f:0;i.cellScale=new Float32Array([(l-h)/s*2,-(l-h)/u*2,1])}this.setState(i)}},{key:"_updateGridParams",value:function(){var t=this.context.viewport,e=t.width,n=t.height,r=this.props.cellSizePixels,i=this.context.gl,a=Math.ceil(e/r),s=Math.ceil(n/r),u=a*s,c=4*u*4,l=this.state.aggregationBuffer;l&&l.delete(),l=new o.Buffer(i,{size:4,bytes:c,type:lt.a.FLOAT,instanced:1}),this.state.weights.color.aggregationBuffer=l,this.setState({numCol:a,numRow:s,numInstances:u,aggregationBuffer:l})}}])&&tc(n.prototype,r),a&&tc(n,a),e}(qe);lc.layerName="ScreenGridLayer",lc.defaultProps=cc;function fc(t){return(fc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function hc(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function dc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function pc(t,e){return!e||"object"!==fc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function gc(t,e,n){return(gc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=vc(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function vc(t){return(vc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function yc(t,e){return(yc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var mc=o.fp64.fp64LowPart,bc=[255,0,255,255],_c={cellSize:{type:"number",min:0,max:1e3,value:1e3},coverage:{type:"number",min:0,max:1,value:1},elevationScale:{type:"number",min:0,value:1},extruded:!0,fp64:!1,getPosition:{type:"accessor",value:function(t){return t.position}},getElevation:{type:"accessor",value:1e3},getColor:{type:"accessor",value:bc},lightSettings:{}},xc=function(t){function e(){return hc(this,e),pc(this,vc(e).apply(this,arguments))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yc(t,e)}(e,t),n=e,(r=[{key:"getShaders",value:function(){return{vs:"#define SHADER_NAME grid-cell-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 normals;\n\nattribute vec3 instancePositions;\nattribute vec2 instancePositions64xyLow;\nattribute float instanceElevations;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\n\n// Custom uniforms\nuniform float extruded;\nuniform float cellSize;\nuniform float coverage;\nuniform float opacity;\nuniform float elevationScale;\n\n// A magic number to scale elevation so that 1 unit approximate to 1 meter\n#define ELEVATION_SCALE 0.8\n\n// Result\nvarying vec4 vColor;\n\nvoid main(void) {\n\n  // if ahpha == 0.0 or z < 0.0, do not render element\n  float noRender = float(instanceColors.a == 0.0 || instanceElevations < 0.0);\n  float finalCellSize = project_scale(cellSize) * mix(1.0, 0.0, noRender);\n\n  float elevation = 0.0;\n\n  if (extruded > 0.5) {\n    elevation = instanceElevations  * (positions.z + 1.0) *\n      ELEVATION_SCALE * elevationScale;\n  }\n\n  // cube geometry vertics are between -1 to 1, scale and transform it to between 0, 1\n  vec3 extrudedPosition = vec3(instancePositions.xy, elevation);\n  vec2 extrudedPosition64xyLow = instancePositions64xyLow;\n  vec3 offset = vec3(\n    (positions.x * coverage + 1.0) / 2.0 * finalCellSize,\n    (positions.y * coverage - 1.0) / 2.0 * finalCellSize,\n    1.0);\n\n  // extrude positions\n  vec4 position_worldspace;\n  gl_Position = project_position_to_clipspace(extrudedPosition, extrudedPosition64xyLow, offset, position_worldspace);\n\n  float lightWeight = 1.0;\n\n  if (extruded > 0.5) {\n    lightWeight = lighting_getLightWeight(\n      position_worldspace.xyz, // the w component is always 1.0\n      normals\n    );\n  }\n\n  vec3 lightWeightedColor = lightWeight * instanceColors.rgb;\n  vec4 color = vec4(lightWeightedColor, instanceColors.a * opacity) / 255.0;\n  vColor = color;\n\n  // Set color to be rendered to picking fbo (also used to check for selection highlight).\n  picking_setPickingColor(instancePickingColors);\n}\n",fs:"#define SHADER_NAME grid-cell-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\n\nvoid main(void) {\n  gl_FragColor = vColor;\n\n  // use highlight color if this fragment belongs to the selected object.\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n\n  // use picking color if rendering to picking FBO.\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n}\n",modules:[this.use64bitProjection()?"project64":"project32","lighting","picking"]}}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instancePositions:{size:3,transition:!0,accessor:"getPosition"},instanceElevations:{size:1,transition:!0,accessor:"getElevation"},instancePositions64xyLow:{size:2,accessor:"getPosition",update:this.calculateInstancePositions64xyLow},instanceColors:{size:4,type:lt.a.UNSIGNED_BYTE,transition:!0,accessor:"getColor",defaultValue:bc}})}},{key:"updateState",value:function(t){var n=t.props,r=t.oldProps,i=t.changeFlags;if(gc(vc(e.prototype),"updateState",this).call(this,{props:n,oldProps:r,changeFlags:i}),n.fp64!==r.fp64){var o=this.context.gl;this.state.model&&this.state.model.delete(),this.setState({model:this._getModel(o)}),this.getAttributeManager().invalidateAll()}}},{key:"_getModel",value:function(t){return new o.Model(t,Object.assign({},this.getShaders(),{id:this.props.id,geometry:new o.CubeGeometry,isInstanced:!0,shaderCache:this.context.shaderCache}))}},{key:"draw",value:function(t){var e=t.uniforms,n=this.props,r=n.cellSize,i=n.extruded,o=n.elevationScale,a=n.coverage;this.state.model.render(Object.assign({},e,{cellSize:r,extruded:i,elevationScale:o,coverage:a}))}},{key:"calculateInstancePositions64xyLow",value:function(t){var e=this.use64bitPositions();if(t.constant=!e,e){var n=this.props,r=n.data,i=n.getPosition,o=t.value,a=0,s=!0,u=!1,c=void 0;try{for(var l,f=r[Symbol.iterator]();!(s=(l=f.next()).done);s=!0){var h=i(l.value);o[a++]=mc(h[0]),o[a++]=mc(h[1])}}catch(t){u=!0,c=t}finally{try{s||null==f.return||f.return()}finally{if(u)throw c}}}else t.value=new Float32Array(2)}}])&&dc(n.prototype,r),i&&dc(n,i),e}(qe);xc.layerName="GridCellLayer",xc.defaultProps=_c;function wc(t,e,n){var r=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,i=1/0,o=-1/0,a=!0,s=!1,u=void 0;try{for(var c,l=e[Symbol.iterator]();!(a=(c=l.next()).done);a=!0){var f=c.value;t=r(f)[1],Number.isFinite(t)&&(i=t<i?t:i,o=t>o?t:o)}}catch(t){s=!0,u=t}finally{try{a||null==l.return||l.return()}finally{if(s)throw u}}var h=(i+o)/2,d=Ec(n,h);if(d.xOffset<=0||d.yOffset<=0)return{gridHash:{},gridOffset:d};var p={},g=!0,v=!1,y=void 0;try{for(var m,b=e[Symbol.iterator]();!(g=(m=b.next()).done);g=!0){var _=m.value,x=r(_)[1],w=r(_)[0];if(Number.isFinite(x)&&Number.isFinite(w)){var E=Math.floor((x+90)/d.yOffset),S=Math.floor((w+180)/d.xOffset),O="".concat(E,"-").concat(S);p[O]=p[O]||{count:0,points:[]},p[O].count+=1,p[O].points.push(_)}}}catch(t){v=!0,y=t}finally{try{g||null==b.return||b.return()}finally{if(v)throw y}}return{gridHash:p,gridOffset:d}}(t,e,n),i=r.gridHash,o=r.gridOffset;return{gridOffset:o,layerData:function(t,e){return Object.keys(t).reduce((function(n,r,i){var o=r.split("-"),a=parseInt(o[0],10),s=parseInt(o[1],10);return n.push(Object.assign({index:i,position:[e.xOffset*s-180,e.yOffset*a-90]},t[r])),n}),[])}(i,o)}}function Ec(t,e){var n;return{yOffset:t/6378e3*(180/Math.PI),xOffset:(n=e,t/6378e3*(180/Math.PI)/Math.cos(n*Math.PI/180))}}function Sc(t){return(Sc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Oc(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Pc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Cc(t,e){return!e||"object"!==Sc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Mc(t){return(Mc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ic(t,e){return(Ic=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ac=zs.BinSorter,Tc=zs.getQuantizeScale,Nc=zs.getLinearScale;function Lc(){}var Rc={colorDomain:null,colorRange:zs.defaultColorRange,getColorValue:{type:"accessor",value:function(t){return t.length}},lowerPercentile:{type:"number",min:0,max:100,value:0},upperPercentile:{type:"number",min:0,max:100,value:100},onSetColorDomain:Lc,elevationDomain:null,elevationRange:[0,1e3],getElevationValue:{type:"accessor",value:function(t){return t.length}},elevationLowerPercentile:{type:"number",min:0,max:100,value:0},elevationUpperPercentile:{type:"number",min:0,max:100,value:100},elevationScale:1,onSetElevationDomain:Lc,cellSize:{type:"number",min:0,max:1e3,value:1e3},coverage:{type:"number",min:0,max:1,value:1},getPosition:{type:"accessor",value:function(t){return t.position}},extruded:!1,fp64:!1,lightSettings:{}},kc=function(t){function e(){return Oc(this,e),Cc(this,Mc(e).apply(this,arguments))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ic(t,e)}(e,t),n=e,(r=[{key:"initializeState",value:function(){this.state={layerData:[],sortedColorBins:null,sortedElevationBins:null,colorValueDomain:null,elevationValueDomain:null,colorScaleFunc:Lc,elevationScaleFunc:Lc,dimensionUpdaters:this.getDimensionUpdaters()}}},{key:"updateState",value:function(t){var e=this,n=t.oldProps,r=t.props,i=t.changeFlags,o=this.needsReProjectPoints(n,r,i);i.dataChanged||o?this.getLayerData():(this.getDimensionChanges(n,r)||[]).forEach((function(t){return"function"==typeof t&&t.apply(e)}))}},{key:"needsReProjectPoints",value:function(t,e,n){return t.cellSize!==e.cellSize||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPosition)}},{key:"getDimensionUpdaters",value:function(){return{getColor:[{id:"value",triggers:["getColorValue"],updater:this.getSortedColorBins},{id:"domain",triggers:["lowerPercentile","upperPercentile"],updater:this.getColorValueDomain},{id:"scaleFunc",triggers:["colorDomain","colorRange"],updater:this.getColorScale}],getElevation:[{id:"value",triggers:["getElevationValue"],updater:this.getSortedElevationBins},{id:"domain",triggers:["elevationLowerPercentile","elevationUpperPercentile"],updater:this.getElevationValueDomain},{id:"scaleFunc",triggers:["elevationDomain","elevationRange"],updater:this.getElevationScale}]}}},{key:"getDimensionChanges",value:function(t,e){var n=this.state.dimensionUpdaters,r=[];for(var i in n){var o=n[i].find((function(n){return n.triggers.some((function(n){return t[n]!==e[n]}))}));o&&r.push(o.updater)}return r.length?r:null}},{key:"getPickingInfo",value:function(t){var e=t.info,n=this.state,r=n.sortedColorBins,i=n.sortedElevationBins,o=null;if(e.picked&&e.index>-1){var a=this.state.layerData[e.index],s=r.binMap[a.index]&&r.binMap[a.index].value,u=i.binMap[a.index]&&i.binMap[a.index].value;o=Object.assign({colorValue:s,elevationValue:u},a)}return Object.assign(e,{picked:Boolean(o),object:o})}},{key:"getUpdateTriggers",value:function(){var t=this,e=this.state.dimensionUpdaters,n={},r=function(r){n[r]={};var i=!0,o=!1,a=void 0;try{for(var s,u=e[r][Symbol.iterator]();!(i=(s=u.next()).done);i=!0)s.value.triggers.forEach((function(e){n[r][e]=t.props[e]}))}catch(t){o=!0,a=t}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}};for(var i in e)r(i);return n}},{key:"getLayerData",value:function(){var t=this.props,e=wc(t.data,t.cellSize,t.getPosition).layerData;this.setState({layerData:e}),this.getSortedBins()}},{key:"getValueDomain",value:function(){this.getColorValueDomain(),this.getElevationValueDomain()}},{key:"getSortedBins",value:function(){this.getSortedColorBins(),this.getSortedElevationBins()}},{key:"getSortedColorBins",value:function(){var t=this.props.getColorValue,e=new Ac(this.state.layerData||[],t);this.setState({sortedColorBins:e}),this.getColorValueDomain()}},{key:"getSortedElevationBins",value:function(){var t=this.props.getElevationValue,e=new Ac(this.state.layerData||[],t);this.setState({sortedElevationBins:e}),this.getElevationValueDomain()}},{key:"getColorValueDomain",value:function(){var t=this.props,e=t.lowerPercentile,n=t.upperPercentile,r=t.onSetColorDomain;this.state.colorValueDomain=this.state.sortedColorBins.getValueRange([e,n]),"function"==typeof r&&r(this.state.colorValueDomain),this.getColorScale()}},{key:"getElevationValueDomain",value:function(){var t=this.props,e=t.elevationLowerPercentile,n=t.elevationUpperPercentile,r=t.onSetElevationDomain;this.state.elevationValueDomain=this.state.sortedElevationBins.getValueRange([e,n]),"function"==typeof r&&r(this.state.elevationValueDomain),this.getElevationScale()}},{key:"getColorScale",value:function(){var t=this.props.colorRange,e=this.props.colorDomain||this.state.colorValueDomain;this.state.colorScaleFunc=Tc(e,t)}},{key:"getElevationScale",value:function(){var t=this.props.elevationRange,e=this.props.elevationDomain||this.state.elevationValueDomain;this.state.elevationScaleFunc=Nc(e,t)}},{key:"_onGetSublayerColor",value:function(t){var e=this.state,n=e.sortedColorBins,r=e.colorScaleFunc,i=e.colorValueDomain,o=n.binMap[t.index]&&n.binMap[t.index].value,a=this.props.colorDomain||i,s=o>=a[0]&&o<=a[a.length-1]?r(o):[0,0,0,0];return s[3]=Number.isFinite(s[3])?s[3]:255,s}},{key:"_onGetSublayerElevation",value:function(t){var e=this.state,n=e.sortedElevationBins,r=e.elevationScaleFunc,i=e.elevationValueDomain,o=n.binMap[t.index]&&n.binMap[t.index].value,a=this.props.elevationDomain||i;return o>=a[0]&&o<=a[a.length-1]?r(o):-1}},{key:"renderLayers",value:function(){var t=this.props,e=t.elevationScale,n=t.fp64,r=t.extruded,i=t.cellSize,o=t.coverage,a=t.lightSettings,s=t.transitions;return new(this.getSubLayerClass("grid-cell",xc))({fp64:n,cellSize:i,coverage:o,lightSettings:a,elevationScale:e,extruded:r,getColor:this._onGetSublayerColor.bind(this),getElevation:this._onGetSublayerElevation.bind(this),transitions:s&&{getColor:s.getColorValue,getElevation:s.getElevationValue}},this.getSubLayerProps({id:"grid-cell",updateTriggers:this.getUpdateTriggers()}),{data:this.state.layerData})}}])&&Pc(n.prototype,r),i&&Pc(n,i),e}(Qi);kc.layerName="GridLayer",kc.defaultProps=Rc;function jc(t){return(jc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Fc(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Dc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Bc(t,e){return!e||"object"!==jc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function zc(t,e,n){return(zc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Vc(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function Vc(t){return(Vc=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Gc(t,e){return(Gc=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Uc=o.fp64.fp64LowPart,Wc=[255,0,255,255],qc={hexagonVertices:null,radius:{type:"number",min:0,value:1e3},angle:{type:"number",value:0},coverage:{type:"number",min:0,max:1,value:1},elevationScale:{type:"number",min:0,value:1},extruded:!0,fp64:!1,getCentroid:{type:"accessor",value:function(t){return t.centroid}},getColor:{type:"accessor",value:Wc},getElevation:{type:"accessor",value:1e3},lightSettings:{}},Xc=function(t){function e(){return Fc(this,e),Bc(this,Vc(e).apply(this,arguments))}var n,r,a;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Gc(t,e)}(e,t),n=e,(r=[{key:"getShaders",value:function(){return{vs:"\n#define SHADER_NAME hexagon-cell-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 normals;\n\nattribute vec2 instancePositions;\nattribute float instanceElevations;\nattribute vec2 instancePositions64xyLow;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\n\n// Custom uniforms\nuniform float opacity;\nuniform float radius;\nuniform float angle;\nuniform float extruded;\nuniform float coverage;\nuniform float elevationScale;\n\n// Result\nvarying vec4 vColor;\n\n// A magic number to scale elevation so that 1 unit approximate to 1 meter.\n#define ELEVATION_SCALE 0.8\n\nvoid main(void) {\n\n  // rotate primitive position and normal\n  mat2 rotationMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));\n\n  // calculate elevation, if 3d not enabled set to 0\n  // cylindar gemoetry height are between -0.5 to 0.5, transform it to between 0, 1\n  float elevation = 0.0;\n\n  if (extruded > 0.5) {\n    elevation = instanceElevations * (positions.z + 0.5) *\n      ELEVATION_SCALE * elevationScale;\n  }\n\n  // if ahpha == 0.0 or z < 0.0, do not render element\n  float noRender = float(instanceColors.a == 0.0 || instanceElevations < 0.0);\n  float dotRadius = project_scale(radius) * mix(coverage, 0.0, noRender);\n\n  // project center of hexagon\n  vec3 centroidPosition = vec3(instancePositions, elevation);\n  vec2 centroidPosition64xyLow = instancePositions64xyLow;\n  vec3 offset = vec3(rotationMatrix * positions.xy * dotRadius, 0.);\n\n  vec4 position_worldspace;\n  gl_Position = project_position_to_clipspace(centroidPosition, centroidPosition64xyLow, offset, position_worldspace);\n\n  // Light calculations\n  // Worldspace is the linear space after Mercator projection\n\n  vec3 normals_worldspace = vec3(rotationMatrix * normals.xy, normals.z);\n\n  float lightWeight = 1.0;\n\n  if (extruded > 0.5) {\n    lightWeight = lighting_getLightWeight(\n      position_worldspace.xyz, // the w component is always 1.0\n      normals_worldspace\n    );\n  }\n\n  vec3 lightWeightedColor = lightWeight * instanceColors.rgb;\n\n  // opacity-multiplied instance color\n  vColor = vec4(lightWeightedColor, opacity * instanceColors.a) / 255.0;\n\n  // Set color to be rendered to picking fbo (also used to check for selection highlight).\n  picking_setPickingColor(instancePickingColors);\n}\n",fs:"#define SHADER_NAME hexagon-cell-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\n\nvoid main(void) {\n  gl_FragColor = vColor;\n\n  // use highlight color if this fragment belongs to the selected object.\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n\n  // use picking color if rendering to picking FBO.\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n}\n",modules:[this.use64bitProjection()?"project64":"project32","lighting","picking"]}}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instancePositions:{size:2,transition:!0,accessor:"getCentroid"},instanceElevations:{size:1,transition:!0,accessor:"getElevation"},instancePositions64xyLow:{size:2,accessor:"getCentroid",update:this.calculateInstancePositions64xyLow},instanceColors:{size:4,type:lt.a.UNSIGNED_BYTE,transition:!0,accessor:"getColor",defaultValue:Wc}})}},{key:"updateState",value:function(t){var n=t.props,r=t.oldProps,i=t.changeFlags;if(zc(Vc(e.prototype),"updateState",this).call(this,{props:n,oldProps:r,changeFlags:i}),n.fp64!==r.fp64){var o=this.context.gl;this.state.model&&this.state.model.delete(),this.setState({model:this._getModel(o)}),this.getAttributeManager().invalidateAll()}n.hexagonVertices===r.hexagonVertices&&n.radius===r.radius&&n.angle===r.angle||this.updateRadiusAngle()}},{key:"updateRadiusAngle",value:function(){var t=this.props,e=t.angle,n=t.radius,r=this.props.hexagonVertices;if(Array.isArray(r)){r.length<6&&i.error("HexagonCellLayer: hexagonVertices needs to be an array of 6 points")();var o=this.props.hexagonVertices,a=o[0],s=o[3],u=this.context.viewport.getDistanceScales().pixelsPerMeter,c=this.projectFlat(a),l=this.projectFlat(s),f=c[0]-l[0],h=c[1]-l[1],d=Math.sqrt(f*f+h*h);e=Math.acos(f/d)*-Math.sign(h)+Math.PI/2,n=d/2/u[0]}this.setState({angle:e,radius:n})}},{key:"getCylinderGeometry",value:function(t){return new o.CylinderGeometry({radius:t,topRadius:t,bottomRadius:t,topCap:!0,bottomCap:!0,height:1,verticalAxis:"z",nradial:6,nvertical:1})}},{key:"_getModel",value:function(t){return new o.Model(t,Object.assign({},this.getShaders(),{id:this.props.id,geometry:this.getCylinderGeometry(1),isInstanced:!0,shaderCache:this.context.shaderCache}))}},{key:"draw",value:function(t){var e=t.uniforms,n=this.props,r=n.elevationScale,i=n.extruded,o=n.coverage,a=this.state,s=a.radius,u=a.angle;this.state.model.render(Object.assign({},e,{radius:s,angle:u,extruded:i,coverage:o,elevationScale:r}))}},{key:"calculateInstancePositions64xyLow",value:function(t){var e=this.use64bitPositions();if(t.constant=!e,e){var n=this.props,r=n.data,i=n.getCentroid,o=t.value,a=0,s=!0,u=!1,c=void 0;try{for(var l,f=r[Symbol.iterator]();!(s=(l=f.next()).done);s=!0){var h=i(l.value);o[a++]=Uc(h[0]),o[a++]=Uc(h[1])}}catch(t){u=!0,c=t}finally{try{s||null==f.return||f.return()}finally{if(u)throw c}}}else t.value=new Float32Array(2)}}])&&Dc(n.prototype,r),a&&Dc(n,a),e}(qe);Xc.layerName="HexagonCellLayer",Xc.defaultProps=qc;var Hc=Math.PI/3,Yc=[0,Hc,2*Hc,3*Hc,4*Hc,5*Hc];function Zc(t){return t[0]}function Kc(t){return t[1]}function Jc(t){return(Jc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Qc(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function tl(t,e){return!e||"object"!==Jc(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function el(t){return(el=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function nl(t,e){return(nl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var rl=zs.BinSorter,il=zs.getQuantizeScale,ol=zs.getLinearScale;function al(){}var sl={colorDomain:null,colorRange:zs.defaultColorRange,getColorValue:{type:"accessor",value:function(t){return t.length}},lowerPercentile:{type:"number",value:0,min:0,max:100},upperPercentile:{type:"number",value:100,min:0,max:100},onSetColorDomain:al,elevationDomain:null,elevationRange:[0,1e3],getElevationValue:{type:"accessor",value:function(t){return t.length}},elevationLowerPercentile:{type:"number",value:0,min:0,max:100},elevationUpperPercentile:{type:"number",value:100,min:0,max:100},elevationScale:{type:"number",min:0,value:1},onSetElevationDomain:al,radius:{type:"number",value:1e3,min:1},coverage:{type:"number",min:0,max:1,value:1},extruded:!1,hexagonAggregator:function(t,e){var n=t.data,r=t.radius,i=t.getPosition,o=function(t,e){var n=e.getDistanceScales().pixelsPerMeter;return t*n[0]}(r,e),a=[],s=!0,u=!1,c=void 0;try{for(var l,f=n[Symbol.iterator]();!(s=(l=f.next()).done);s=!0){var h=l.value;a.push(Object.assign({screenCoord:e.projectFlat(i(h))},h))}}catch(t){u=!0,c=t}finally{try{s||null==f.return||f.return()}finally{if(u)throw c}}return{hexagons:function(){var t,e,n,r=0,i=0,o=1,a=1,s=Zc,u=Kc;function c(t){var r,i={},o=[],a=t.length;for(r=0;r<a;++r)if(!isNaN(l=+s.call(null,c=t[r],r,t))&&!isNaN(f=+u.call(null,c,r,t))){var c,l,f,h=Math.round(f/=n),d=Math.round(l=l/e-(1&h)/2),p=f-h;if(3*Math.abs(p)>1){var g=l-d,v=d+(l<d?-1:1)/2,y=h+(f<h?-1:1),m=l-v,b=f-y;g*g+p*p>m*m+b*b&&(d=v+(1&h?1:-1)/2,h=y)}var _=d+"-"+h,x=i[_];x?x.push(c):(o.push(x=i[_]=[c]),x.x=(d+(1&h)/2)*e,x.y=h*n)}return o}function l(t){var e=0,n=0;return Yc.map((function(r){var i=Math.sin(r)*t,o=-Math.cos(r)*t,a=i-e,s=o-n;return e=i,n=o,[a,s]}))}return c.hexagon=function(e){return"m"+l(null==e?t:+e).join("l")+"z"},c.centers=function(){for(var s=[],u=Math.round(i/n),c=Math.round(r/e),l=u*n;l<a+t;l+=n,++u)for(var f=c*e+(1&u)*e/2;f<o+e/2;f+=e)s.push([f,l]);return s},c.mesh=function(){var e=l(t).slice(0,4).join("l");return c.centers().map((function(t){return"M"+t+"m"+e})).join("")},c.x=function(t){return arguments.length?(s=t,c):s},c.y=function(t){return arguments.length?(u=t,c):u},c.radius=function(r){return arguments.length?(e=2*(t=+r)*Math.sin(Hc),n=1.5*t,c):t},c.size=function(t){return arguments.length?(r=i=0,o=+t[0],a=+t[1],c):[o-r,a-i]},c.extent=function(t){return arguments.length?(r=+t[0][0],i=+t[0][1],o=+t[1][0],a=+t[1][1],c):[[r,i],[o,a]]},c.radius(1)}().radius(o).x((function(t){return t.screenCoord[0]})).y((function(t){return t.screenCoord[1]}))(a).map((function(t,n){return{centroid:e.unprojectFlat([t.x,t.y]),points:t,index:n}}))}},getPosition:{type:"accessor",value:function(t){return t.position}},fp64:!1,lightSettings:{}},ul=function(t){function e(){return Qc(this,e),tl(this,el(e).apply(this,arguments))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&nl(t,e)}(e,t),n=e,(r=[{key:"initializeState",value:function(){this.state={hexagons:[],hexagonVertices:null,sortedColorBins:null,sortedElevationBins:null,colorValueDomain:null,elevationValueDomain:null,colorScaleFunc:al,elevationScaleFunc:al,dimensionUpdaters:this.getDimensionUpdaters()}}},{key:"updateState",value:function(t){var e=this,n=t.oldProps,r=t.props,i=t.changeFlags,o=this.getDimensionChanges(n,r);i.dataChanged||this.needsReProjectPoints(n,r)?this.getHexagons():o&&o.forEach((function(t){return"function"==typeof t&&t.apply(e)}))}},{key:"needsReProjectPoints",value:function(t,e){return t.radius!==e.radius||t.hexagonAggregator!==e.hexagonAggregator}},{key:"getDimensionUpdaters",value:function(){return{getColor:[{id:"value",triggers:["getColorValue"],updater:this.getSortedColorBins},{id:"domain",triggers:["lowerPercentile","upperPercentile"],updater:this.getColorValueDomain},{id:"scaleFunc",triggers:["colorDomain","colorRange"],updater:this.getColorScale}],getElevation:[{id:"value",triggers:["getElevationValue"],updater:this.getSortedElevationBins},{id:"domain",triggers:["elevationLowerPercentile","elevationUpperPercentile"],updater:this.getElevationValueDomain},{id:"scaleFunc",triggers:["elevationDomain","elevationRange"],updater:this.getElevationScale}]}}},{key:"getDimensionChanges",value:function(t,e){var n=this.state.dimensionUpdaters,r=[];for(var i in n){var o=n[i].find((function(n){return n.triggers.some((function(n){return t[n]!==e[n]}))}));o&&r.push(o.updater)}return r.length?r:null}},{key:"getHexagons",value:function(){var t=this.props.hexagonAggregator,e=this.context.viewport,n=t(this.props,e),r=n.hexagons,i=n.hexagonVertices;this.setState({hexagons:r,hexagonVertices:i}),this.getSortedBins()}},{key:"getPickingInfo",value:function(t){var e=t.info,n=this.state,r=n.sortedColorBins,i=n.sortedElevationBins,o=null;if(e.picked&&e.index>-1){var a=this.state.hexagons[e.index],s=r.binMap[a.index]&&r.binMap[a.index].value,u=i.binMap[a.index]&&i.binMap[a.index].value;o=Object.assign({colorValue:s,elevationValue:u},a)}return Object.assign(e,{picked:Boolean(o),object:o})}},{key:"getUpdateTriggers",value:function(){var t=this,e=this.state.dimensionUpdaters,n={},r=function(r){n[r]={};var i=!0,o=!1,a=void 0;try{for(var s,u=e[r][Symbol.iterator]();!(i=(s=u.next()).done);i=!0)s.value.triggers.forEach((function(e){n[r][e]=t.props[e]}))}catch(t){o=!0,a=t}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}};for(var i in e)r(i);return n}},{key:"getValueDomain",value:function(){this.getColorValueDomain(),this.getElevationValueDomain()}},{key:"getSortedBins",value:function(){this.getSortedColorBins(),this.getSortedElevationBins()}},{key:"getSortedColorBins",value:function(){var t=this.props.getColorValue,e=new rl(this.state.hexagons||[],t);this.setState({sortedColorBins:e}),this.getColorValueDomain()}},{key:"getSortedElevationBins",value:function(){var t=this.props.getElevationValue,e=new rl(this.state.hexagons||[],t);this.setState({sortedElevationBins:e}),this.getElevationValueDomain()}},{key:"getColorValueDomain",value:function(){var t=this.props,e=t.lowerPercentile,n=t.upperPercentile,r=t.onSetColorDomain;e>n&&i.warn("HexagonLayer: lowerPercentile is bigger than upperPercentile")(),this.state.colorValueDomain=this.state.sortedColorBins.getValueRange([e,n]),"function"==typeof r&&r(this.state.colorValueDomain),this.getColorScale()}},{key:"getElevationValueDomain",value:function(){var t=this.props,e=t.elevationLowerPercentile,n=t.elevationUpperPercentile,r=t.onSetElevationDomain;this.state.elevationValueDomain=this.state.sortedElevationBins.getValueRange([e,n]),"function"==typeof r&&r(this.state.elevationValueDomain),this.getElevationScale()}},{key:"getColorScale",value:function(){var t=this.props.colorRange,e=this.props.colorDomain||this.state.colorValueDomain;this.state.colorScaleFunc=il(e,t)}},{key:"getElevationScale",value:function(){var t=this.props.elevationRange,e=this.props.elevationDomain||this.state.elevationValueDomain;this.state.elevationScaleFunc=ol(e,t)}},{key:"_onGetSublayerColor",value:function(t){var e=this.state,n=e.sortedColorBins,r=e.colorScaleFunc,i=e.colorValueDomain,o=n.binMap[t.index]&&n.binMap[t.index].value,a=this.props.colorDomain||i,s=o>=a[0]&&o<=a[a.length-1]?r(o):[0,0,0,0];return s[3]=Number.isFinite(s[3])?s[3]:255,s}},{key:"_onGetSublayerElevation",value:function(t){var e=this.state,n=e.sortedElevationBins,r=e.elevationScaleFunc,i=e.elevationValueDomain,o=n.binMap[t.index]&&n.binMap[t.index].value,a=this.props.elevationDomain||i;return o>=a[0]&&o<=a[a.length-1]?r(o):-1}},{key:"renderLayers",value:function(){var t=this.props,e=t.radius,n=t.elevationScale,r=t.extruded,i=t.coverage,o=t.lightSettings,a=t.fp64,s=t.transitions;return new(this.getSubLayerClass("hexagon-cell",Xc))({fp64:a,radius:e,elevationScale:n,angle:Math.PI/2,extruded:r,coverage:i,lightSettings:o,getColor:this._onGetSublayerColor.bind(this),getElevation:this._onGetSublayerElevation.bind(this),transitions:s&&{getColor:s.getColorValue,getElevation:s.getElevationValue}},this.getSubLayerProps({id:"hexagon-cell",updateTriggers:this.getUpdateTriggers()}),{data:this.state.hexagons,hexagonVertices:this.state.hexagonVertices})}}])&&$c(n.prototype,r),o&&$c(n,o),e}(Qi);function cl(t){return(cl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ll(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function fl(t,e){return!e||"object"!==cl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function hl(t){return(hl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function dl(t,e){return(dl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}ul.layerName="HexagonLayer",ul.defaultProps=sl;var pl=zs.Tesselator,gl=o.fp64.fp64LowPart,vl=[0,0,0,255],yl=function(t){function e(t){var n=t.data,r=t.getGeometry,i=t.positionFormat,o=t.fp64;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),fl(this,hl(e).call(this,{data:n,getGeometry:r,fp64:o,positionFormat:i,attributes:{startPositions:{size:3},endPositions:{size:3},leftDeltas:{size:3},rightDeltas:{size:3},startEndPositions64XyLow:{size:4,fp64Only:!0}}}))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&dl(t,e)}(e,t),n=e,(r=[{key:"get",value:function(t,e,n){if(this.attributes[t])return this.attributes[t];switch(t){case"strokeWidths":return this._updateAttribute({target:e,size:1,getValue:function(t){return[n(t)]}});case"dashArrays":return this._updateAttribute({target:e,size:2,getValue:n});case"colors":return this._updateAttribute({target:e,size:4,getValue:function(t){var e=n(t);return 4===e.length?e:(vl[0]=e[0],vl[1]=e[1],vl[2]=e[2],vl)}});case"pickingColors":return this._updateAttribute({target:e,size:3,getValue:function(t,e){return n(e)}});default:return null}}},{key:"getGeometrySize",value:function(t){return Math.max(0,this.getPathLength(t)-1)}},{key:"updateGeometryAttributes",value:function(t,e){var n=this.attributes,r=n.startPositions,i=n.endPositions,o=n.leftDeltas,a=n.rightDeltas,s=n.startEndPositions64XyLow,u=this.fp64,c=e.geometrySize+1;if(!(c<2))for(var l,f=this.isClosed(t),h=this.getPointOnPath(t,0),d=this.getPointOnPath(t,1),p=f?this.getPointOnPath(t,c-2):h,g=e.vertexStart,v=1;v<c;g++,v++)l=v+1<c?this.getPointOnPath(t,v+1):f?this.getPointOnPath(t,1):d,r[3*g]=h[0],r[3*g+1]=h[1],r[3*g+2]=h[2]||0,i[3*g]=d[0],i[3*g+1]=d[1],i[3*g+2]=d[2]||0,o[3*g]=h[0]-p[0],o[3*g+1]=h[1]-p[1],o[3*g+2]=h[2]-p[2]||0,a[3*g]=l[0]-d[0],a[3*g+1]=l[1]-d[1],a[3*g+2]=l[2]-d[2]||0,u&&(s[4*g]=gl(h[0]),s[4*g+1]=gl(h[1]),s[4*g+2]=gl(d[0]),s[4*g+3]=gl(d[1])),p=h,h=d,d=l}},{key:"getPathLength",value:function(t){return Number.isFinite(t[0])?t.length/this.positionSize:t.length}},{key:"getPointOnPath",value:function(t,e){if(Number.isFinite(t[0])){var n=this.positionSize;return[t[e*n],t[e*n+1],3===n?t[e*n+2]:0]}return t[e]}},{key:"isClosed",value:function(t){var e=this.getPathLength(t),n=this.getPointOnPath(t,0),r=this.getPointOnPath(t,e-1);return n[0]===r[0]&&n[1]===r[1]&&n[2]===r[2]}}])&&ll(n.prototype,r),i&&ll(n,i),e}(pl),ml="#define SHADER_NAME path-layer-fragment-shader\n\nprecision highp float;\n\nuniform float jointType;\nuniform float miterLimit;\nuniform float alignMode;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\nvarying vec2 vDashArray;\n/*\n * vPathPosition represents the relative coordinates of the current fragment on the path segment.\n * vPathPosition.x - position along the width of the path, between [-1, 1]. 0 is the center line.\n * vPathPosition.y - position along the length of the path, between [0, L / width].\n */\nvarying vec2 vPathPosition;\nvarying float vPathLength;\n\n// mod doesn't work correctly for negative numbers\nfloat mod2(float a, float b) {\n  return a - floor(a / b) * b;\n}\n\nfloat round(float x) {\n  return floor(x + 0.5);\n}\n\n// if given position is in the gap part of the dashed line\n// dashArray.x: solid stroke length, relative to width\n// dashArray.y: gap length, relative to width\n// alignMode:\n// 0 - no adjustment\n// o----     ----     ----     ---- o----     -o----     ----     o\n// 1 - stretch to fit, draw half dash at each end for nicer joints\n// o--    ----    ----    ----    --o--      --o--     ----     --o\nbool dash_isFragInGap() {\n  float solidLength = vDashArray.x;\n  float gapLength = vDashArray.y;\n\n  float unitLength = solidLength + gapLength;\n\n  if (unitLength == 0.0) {\n    return false;\n  }\n\n  unitLength = mix(\n    unitLength,\n    vPathLength / round(vPathLength / unitLength),\n    alignMode\n  );\n\n  float offset = alignMode * solidLength / 2.0;\n\n  return gapLength > 0.0 &&\n    vPathPosition.y >= 0.0 &&\n    vPathPosition.y <= vPathLength &&\n    mod2(vPathPosition.y + offset, unitLength) > solidLength;\n}\n\nvoid main(void) {\n  // if joint is rounded, test distance from the corner\n  if (jointType > 0.0 && vMiterLength > 0.0 && length(vCornerOffset) > 1.0) {\n    // Enable to debug joints\n    // gl_FragColor = vec4(0., 1., 0., 1.);\n    // return;\n    discard;\n  }\n  if (jointType == 0.0 && vMiterLength > miterLimit) {\n    // Enable to debug joints\n    // gl_FragColor = vec4(0., 0., 1., 1.);\n    // return;\n    discard;\n  }\n  if (vColor.a == 0.0 || dash_isFragInGap()) {\n    // Enable to debug joints\n    // gl_FragColor = vec4(0., 1., 1., 1.);\n    // return;\n    discard;\n  }\n  gl_FragColor = vColor;\n\n  // use highlight color if this fragment belongs to the selected object.\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n\n  // use picking color if rendering to picking FBO.\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n}\n";function bl(t){return(bl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function xl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function wl(t,e){return!e||"object"!==bl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function El(t,e,n){return(El="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Sl(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function Sl(t){return(Sl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ol(t,e){return(Ol=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Pl=[0,0,0,255],Cl={widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},rounded:!1,miterLimit:{type:"number",min:0,value:4},fp64:!1,dashJustified:!1,getPath:{type:"accessor",value:function(t){return t.path}},getColor:{type:"accessor",value:Pl},getWidth:{type:"accessor",value:1},getDashArray:{type:"accessor",value:[0,0]}},Ml={enter:function(t,e){return e.length?e.subarray(e.length-t.length):t}},Il=function(t){function e(){return _l(this,e),wl(this,Sl(e).apply(this,arguments))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ol(t,e)}(e,t),n=e,(r=[{key:"getShaders",value:function(){return this.use64bitProjection()?{vs:"\n#define SHADER_NAME path-layer-vertex-shader\n\nattribute vec3 positions;\n\nattribute vec3 instanceStartPositions;\nattribute vec3 instanceEndPositions;\nattribute vec4 instanceStartEndPositions64xyLow;\nattribute vec3 instanceLeftDeltas;\nattribute vec3 instanceRightDeltas;\nattribute float instanceStrokeWidths;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute vec2 instanceDashArrays;\n\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform float jointType;\nuniform float miterLimit;\n\nuniform float opacity;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\nvarying vec2 vDashArray;\nvarying vec2 vPathPosition;\nvarying float vPathLength;\n\nconst float EPSILON = 0.001;\n\nfloat flipIfTrue(bool flag) {\n  return -(float(flag) * 2. - 1.);\n}\n\nvec3 lineJoin(vec2 prevPoint64[2], vec2 currPoint64[2], vec2 nextPoint64[2]) {\n\n  float width = clamp(project_scale(instanceStrokeWidths * widthScale),\n    widthMinPixels, widthMaxPixels) / 2.0;\n\n  vec2 deltaA64[2];\n  vec2 deltaB64[2];\n\n  vec2_sub_fp64(currPoint64, prevPoint64, deltaA64);\n  vec2_sub_fp64(nextPoint64, currPoint64, deltaB64);\n\n  vec2 lengthA64 = vec2_length_fp64(deltaA64);\n  vec2 lengthB64 = vec2_length_fp64(deltaB64);\n\n  vec2 deltaA = vec2(deltaA64[0].x, deltaA64[1].x);\n  vec2 deltaB = vec2(deltaB64[0].x, deltaB64[1].x);\n\n  float lenA = lengthA64.x;\n  float lenB = lengthB64.x;\n\n  vec2 offsetVec;\n  float offsetScale;\n  float offsetDirection;\n\n  // when two points are closer than PIXEL_EPSILON in pixels,\n  // assume they are the same point to avoid precision issue\n  lenA = lenA / width > EPSILON ? lenA : 0.0;\n  lenB = lenB / width > EPSILON ? lenB : 0.0;\n  vec2 dirA = lenA > 0. ? deltaA / lenA : vec2(0.0, 0.0);\n  vec2 dirB = lenB > 0. ? deltaB / lenB : vec2(0.0, 0.0);\n\n  vec2 perpA = vec2(-dirA.y, dirA.x);\n  vec2 perpB = vec2(-dirB.y, dirB.x);\n\n  // tangent of the corner\n  vec2 tangent = vec2(dirA + dirB);\n  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;\n  // direction of the corner\n  vec2 miterVec = vec2(-tangent.y, tangent.x);\n  // width offset from current position\n  vec2 perp = mix(perpB, perpA, positions.x);\n  float L = mix(lenB, lenA, positions.x);\n\n  // cap super sharp angles\n  float sinHalfA = abs(dot(miterVec, perp));\n  float cosHalfA = abs(dot(dirA, miterVec));\n  bool turnsRight = dirA.x * dirB.y > dirA.y * dirB.x;\n\n  // relative position to the corner:\n  // -1: inside (smaller side of the angle)\n  // 0: center\n  // 1: outside (bigger side of the angle)\n  float cornerPosition = mix(\n    flipIfTrue(turnsRight == (positions.y > 0.0)),\n    0.0,\n    positions.z\n  );\n\n  offsetScale = 1.0 / max(sinHalfA, EPSILON);\n\n  // do not bevel if line segment is too short\n  cornerPosition *= float(cornerPosition <= 0.0 || sinHalfA < min(lenA, lenB) / width * cosHalfA);\n  // trim if inside corner extends further than the line segment\n  offsetScale = mix(\n    offsetScale,\n    min(offsetScale, L / width / max(cosHalfA, EPSILON)),\n    float(cornerPosition < 0.0)\n  );\n\n  vMiterLength = mix(\n    offsetScale * cornerPosition,\n    mix(offsetScale, 0.0, cornerPosition),\n    step(0.0, cornerPosition)\n  ) - sinHalfA * jointType;\n  offsetDirection = mix(\n    positions.y,\n    mix(\n      flipIfTrue(turnsRight),\n      positions.y * flipIfTrue(turnsRight == (positions.x == 1.)),\n      cornerPosition\n    ),\n    step(0.0, cornerPosition)\n  );\n  offsetVec = mix(miterVec, -tangent, step(0.5, cornerPosition));\n  offsetScale = mix(offsetScale, 1.0 / max(cosHalfA, 0.001), step(0.5, cornerPosition));\n\n  // special treatment for start cap and end cap\n  // using a small number as the limit for determining if the lenA or lenB is 0\n  float isStartCap = step(lenA, 1.0e-5);\n  float isEndCap = step(lenB, 1.0e-5);\n  float isCap = max(isStartCap, isEndCap);\n\n  // 0: center, 1: side\n  cornerPosition = isCap * (1.0 - positions.z);\n\n  // start of path: use next - curr\n  offsetVec = mix(offsetVec, mix(dirB, perpB, cornerPosition), isStartCap);\n  // end of path: use curr - prev\n  offsetVec = mix(offsetVec, mix(dirA, perpA, cornerPosition), isEndCap);\n\n  // extend out a triangle to envelope the round cap\n  offsetScale = mix(\n    offsetScale,\n    mix(4.0 * jointType, 1.0, cornerPosition),\n    isCap\n  );\n  vMiterLength = mix(vMiterLength, 1.0 - cornerPosition, isCap);\n\n  offsetDirection = mix(\n    offsetDirection,\n    mix(flipIfTrue(isStartCap > 0.), positions.y, cornerPosition),\n    isCap\n  );\n\n  vCornerOffset = offsetVec * offsetDirection * offsetScale;\n\n  // Generate variables for dash calculation\n  vDashArray = instanceDashArrays;\n  vPathLength = L / width;\n  float isEnd = positions.x;\n  vec2 offsetFromStartOfPath = mix(vCornerOffset, vCornerOffset + deltaA / width, isEnd);\n  vec2 dir = mix(dirB, dirA, isEnd);\n  vPathPosition = vec2(\n    positions.y + positions.z * offsetDirection,\n    dot(offsetFromStartOfPath, dir)\n  );\n\n  return vec3(vCornerOffset * width, 0.0);\n}\n\nvoid main() {\n  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity) / 255.;\n\n  // Set color to be rendered to picking fbo (also used to check for selection highlight).\n  picking_setPickingColor(instancePickingColors);\n\n  float isEnd = positions.x;\n\n  // Calculate current position 64bit\n\n  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);\n  vec2 currPosition64xyLow = mix(instanceStartEndPositions64xyLow.xy, instanceStartEndPositions64xyLow.zw, isEnd);\n  vec2 projected_curr_position[2];\n  project_position_fp64(currPosition.xy, currPosition64xyLow, projected_curr_position);\n  float projected_curr_position_z = project_scale(currPosition.z);\n\n  // Calculate previous position\n\n  vec3 prevPosition = mix(-instanceLeftDeltas, vec3(0.0), isEnd) + instanceStartPositions;\n\n  // Calculate prev position 64bit\n\n  vec2 projected_prev_position[2];\n  project_position_fp64(prevPosition.xy, instanceStartEndPositions64xyLow.xy, projected_prev_position);\n\n  // Calculate next positions\n  vec3 nextPosition = mix(vec3(0.0), instanceRightDeltas, isEnd) + instanceEndPositions;\n\n  // Calculate next position 64bit\n\n  vec2 projected_next_position[2];\n  project_position_fp64(nextPosition.xy, instanceStartEndPositions64xyLow.zw, projected_next_position);\n\n  vec3 pos = lineJoin(projected_prev_position, projected_curr_position, projected_next_position);\n  vec2 vertex_pos_modelspace[4];\n\n  vertex_pos_modelspace[0] = sum_fp64(vec2(pos.x, 0.0), projected_curr_position[0]);\n  vertex_pos_modelspace[1] = sum_fp64(vec2(pos.y, 0.0), projected_curr_position[1]);\n  vertex_pos_modelspace[2] = vec2(pos.z + projected_curr_position_z, 0.0);\n  vertex_pos_modelspace[3] = vec2(1.0, 0.0);\n\n  gl_Position = project_to_clipspace_fp64(vertex_pos_modelspace);\n}\n",fs:ml,modules:["project64","picking"]}:{vs:"#define SHADER_NAME path-layer-vertex-shader-64\n\nattribute vec3 positions;\n\nattribute vec3 instanceStartPositions;\nattribute vec3 instanceEndPositions;\nattribute vec4 instanceStartEndPositions64xyLow;\nattribute vec3 instanceLeftDeltas;\nattribute vec3 instanceRightDeltas;\nattribute float instanceStrokeWidths;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute vec2 instanceDashArrays;\n\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform float jointType;\nuniform float miterLimit;\n\nuniform float opacity;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\nvarying vec2 vDashArray;\nvarying vec2 vPathPosition;\nvarying float vPathLength;\n\nconst float EPSILON = 0.001;\n\nfloat flipIfTrue(bool flag) {\n  return -(float(flag) * 2. - 1.);\n}\n\n// calculate line join positions\nvec3 lineJoin(\n  vec3 prevPoint, vec3 currPoint, vec3 nextPoint,\n  float relativePosition, bool isEnd, bool isJoint,\n  float width\n) {\n  vec2 deltaA = currPoint.xy - prevPoint.xy;\n  vec2 deltaB = nextPoint.xy - currPoint.xy;\n\n  float lenA = length(deltaA);\n  float lenB = length(deltaB);\n\n  // when two points are closer than PIXEL_EPSILON in pixels,\n  // assume they are the same point to avoid precision issue\n  lenA = lenA / width > EPSILON ? lenA : 0.0;\n  lenB = lenB / width > EPSILON ? lenB : 0.0;\n\n  vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);\n  vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);\n\n  vec2 perpA = vec2(-dirA.y, dirA.x);\n  vec2 perpB = vec2(-dirB.y, dirB.x);\n\n  // tangent of the corner\n  vec2 tangent = vec2(dirA + dirB);\n  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;\n  // direction of the corner\n  vec2 miterVec = vec2(-tangent.y, tangent.x);\n  // width offset from current position\n  vec2 perp = isEnd ? perpA : perpB;\n  float L = isEnd ? lenA : lenB;\n\n  // cap super sharp angles\n  float sinHalfA = abs(dot(miterVec, perp));\n  float cosHalfA = abs(dot(dirA, miterVec));\n\n  bool turnsRight = dirA.x * dirB.y > dirA.y * dirB.x;\n\n  float offsetScale = 1.0 / max(sinHalfA, EPSILON);\n\n  float cornerPosition = isJoint ?\n    0.0 :\n    flipIfTrue(turnsRight == (relativePosition > 0.0));\n\n  // do not bevel if line segment is too short\n  cornerPosition *=\n    float(cornerPosition <= 0.0 || sinHalfA < min(lenA, lenB) / width * cosHalfA);\n\n  // trim if inside corner extends further than the line segment\n  if (cornerPosition < 0.0) {\n    offsetScale = min(offsetScale, L / width / max(cosHalfA, EPSILON));\n  }\n\n  vMiterLength = cornerPosition >= 0.0 ?\n    mix(offsetScale, 0.0, cornerPosition) :\n    offsetScale * cornerPosition;\n  vMiterLength -= sinHalfA * jointType;\n\n  float offsetDirection = mix(\n    positions.y,\n    mix(\n      flipIfTrue(turnsRight),\n      positions.y * flipIfTrue(turnsRight == (positions.x == 1.)),\n      cornerPosition\n    ),\n    step(0.0, cornerPosition)\n  );\n\n  vec2 offsetVec = mix(miterVec, -tangent, step(0.5, cornerPosition));\n  offsetScale = mix(offsetScale, 1.0 / max(cosHalfA, 0.001), step(0.5, cornerPosition));\n\n  // special treatment for start cap and end cap\n  // TODO - This has an issue. len is always positive because it is length.\n  // Step returns zero if -lenA<0, so practically this is a comparison of\n  // lenA with zero, with lots of problems because of the -lenA. Can we use EPSILON?\n  bool isStartCap = step(0.0, -lenA) > 0.5;\n  bool isEndCap = step(0.0, -lenB) > 0.5;\n  bool isCap = isStartCap || isEndCap;\n\n  // 0: center, 1: side\n  cornerPosition = isCap ? (1.0 - positions.z) : 0.;\n\n  // start of path: use next - curr\n  if (isStartCap) {\n    offsetVec = mix(dirB, perpB, cornerPosition);\n  }\n\n  // end of path: use curr - prev\n  if (isEndCap) {\n    offsetVec = mix(dirA, perpA, cornerPosition);\n  }\n\n  // extend out a triangle to envelope the round cap\n  if (isCap) {\n    offsetScale = mix(4.0 * jointType, 1.0, cornerPosition);\n    vMiterLength = 1.0 - cornerPosition;\n    offsetDirection = mix(flipIfTrue(isStartCap), positions.y, cornerPosition);\n  }\n\n  vCornerOffset = offsetVec * offsetDirection * offsetScale;\n\n  // Generate variables for dash calculation\n  vDashArray = instanceDashArrays;\n  vPathLength = L / width;\n  // vec2 offsetFromStartOfPath = isEnd ? vCornerOffset + deltaA / width : vCornerOffset;\n  vec2 offsetFromStartOfPath = vCornerOffset;\n  if (isEnd) {\n    offsetFromStartOfPath += deltaA / width;\n  }\n  vec2 dir = isEnd ? dirA : dirB;\n  vPathPosition = vec2(\n    positions.y + positions.z * offsetDirection,\n    dot(offsetFromStartOfPath, dir)\n  );\n\n  return currPoint + vec3(vCornerOffset * width, 0.0);\n}\n\n// calculate line join positions\n// extract params from attributes and uniforms\nvec3 lineJoin(vec3 prevPoint, vec3 currPoint, vec3 nextPoint) {\n\n  // relative position to the corner:\n  // -1: inside (smaller side of the angle)\n  // 0: center\n  // 1: outside (bigger side of the angle)\n\n  float relativePosition = positions.y;\n  bool isEnd = positions.x > EPSILON;\n  bool isJoint = positions.z > EPSILON;\n\n  float width = clamp(project_scale(instanceStrokeWidths * widthScale),\n    widthMinPixels, widthMaxPixels) / 2.0;\n\n  return lineJoin(\n    prevPoint, currPoint, nextPoint,\n    relativePosition, isEnd, isJoint,\n    width\n  );\n}\n\nvoid main() {\n  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity) / 255.;\n\n  // Set color to be rendered to picking fbo (also used to check for selection highlight).\n  picking_setPickingColor(instancePickingColors);\n\n  float isEnd = positions.x;\n\n  vec3 prevPosition = instanceStartPositions;\n  vec2 prevPosition64xyLow = instanceStartEndPositions64xyLow.xy;\n  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_AUTO_OFFSET) {\n    // In auto offset mode, add delta to low part of the positions for better precision\n    prevPosition64xyLow += mix(-instanceLeftDeltas, vec3(0.0), isEnd).xy;\n  } else {\n    prevPosition += mix(-instanceLeftDeltas, vec3(0.0), isEnd);\n  }\n  prevPosition = project_position(prevPosition, prevPosition64xyLow);\n\n  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);\n  vec2 currPosition64xyLow = mix(instanceStartEndPositions64xyLow.xy, instanceStartEndPositions64xyLow.zw, isEnd);\n  currPosition = project_position(currPosition, currPosition64xyLow);\n\n  vec3 nextPosition = instanceEndPositions;\n  vec2 nextPosition64xyLow = instanceStartEndPositions64xyLow.zw;\n  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_AUTO_OFFSET) {\n    // In auto offset mode, add delta to low part of the positions for better precision\n    nextPosition64xyLow += mix(vec3(0.0), instanceRightDeltas, isEnd).xy;\n  } else {\n    nextPosition += mix(vec3(0.0), instanceRightDeltas, isEnd);\n  }\n  nextPosition = project_position(nextPosition, nextPosition64xyLow);\n\n  vec3 pos = lineJoin(prevPosition, currPosition, nextPosition);\n\n  gl_Position = project_to_clipspace(vec4(pos, 1.0));\n}\n",fs:ml,modules:["picking"]}}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instanceStartPositions:{size:3,transition:Ml,accessor:"getPath",update:this.calculateStartPositions,noAlloc:!0},instanceEndPositions:{size:3,transition:Ml,accessor:"getPath",update:this.calculateEndPositions,noAlloc:!0},instanceStartEndPositions64xyLow:{size:4,update:this.calculateInstanceStartEndPositions64xyLow,noAlloc:!0},instanceLeftDeltas:{size:3,update:this.calculateLeftDeltas,noAlloc:!0},instanceRightDeltas:{size:3,update:this.calculateRightDeltas,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:Ml,update:this.calculateStrokeWidths,defaultValue:1},instanceDashArrays:{size:2,accessor:"getDashArray",update:this.calculateDashArrays},instanceColors:{size:4,type:lt.a.UNSIGNED_BYTE,accessor:"getColor",transition:Ml,update:this.calculateColors,defaultValue:Pl},instancePickingColors:{size:3,type:lt.a.UNSIGNED_BYTE,update:this.calculatePickingColors}}),this.setState({pathTesselator:new yl({})})}},{key:"updateState",value:function(t){var n=t.oldProps,r=t.props,i=t.changeFlags;El(Sl(e.prototype),"updateState",this).call(this,{props:r,oldProps:n,changeFlags:i});var o=this.getAttributeManager();if((i.dataChanged||r.fp64!==n.fp64||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getPath))&&(this.state.pathTesselator.updateGeometry({data:r.data,getGeometry:r.getPath,positionFormat:r.positionFormat,fp64:this.use64bitPositions()}),this.setState({numInstances:this.state.pathTesselator.instanceCount}),o.invalidateAll()),r.fp64!==n.fp64){var a=this.context.gl;this.state.model&&this.state.model.delete(),this.setState({model:this._getModel(a)}),o.invalidateAll()}}},{key:"draw",value:function(t){var e=t.uniforms,n=this.props,r=n.rounded,i=n.miterLimit,o=n.widthScale,a=n.widthMinPixels,s=n.widthMaxPixels,u=n.dashJustified;this.state.model.render(Object.assign({},e,{jointType:Number(r),alignMode:Number(u),widthScale:o,miterLimit:i,widthMinPixels:a,widthMaxPixels:s}))}},{key:"_getModel",value:function(t){return new o.Model(t,Object.assign({},this.getShaders(),{id:this.props.id,geometry:new o.Geometry({drawMode:lt.a.TRIANGLES,attributes:{indices:new Uint16Array([0,2,1,1,2,4,1,4,3,3,4,5]),positions:new Float32Array([0,0,1,0,-1,0,0,1,0,1,-1,0,1,1,0,1,0,1])}}),isInstanced:!0,shaderCache:this.context.shaderCache}))}},{key:"calculateStartPositions",value:function(t){var e=this.state.pathTesselator;t.bufferLayout=e.bufferLayout,t.value=e.get("startPositions")}},{key:"calculateEndPositions",value:function(t){var e=this.state.pathTesselator;t.bufferLayout=e.bufferLayout,t.value=e.get("endPositions")}},{key:"calculateInstanceStartEndPositions64xyLow",value:function(t){var e=this.use64bitPositions();t.constant=!e,t.value=e?this.state.pathTesselator.get("startEndPositions64XyLow"):new Float32Array(4)}},{key:"calculateLeftDeltas",value:function(t){var e=this.state.pathTesselator;t.value=e.get("leftDeltas")}},{key:"calculateRightDeltas",value:function(t){var e=this.state.pathTesselator;t.value=e.get("rightDeltas")}},{key:"calculateStrokeWidths",value:function(t){var e=this.props.getWidth,n=this.state.pathTesselator;t.bufferLayout=n.bufferLayout,t.value=n.get("strokeWidths",t.value,e)}},{key:"calculateDashArrays",value:function(t){var e=this.props.getDashArray,n=this.state.pathTesselator;t.value=n.get("dashArrays",t.value,e)}},{key:"calculateColors",value:function(t){var e=this.props.getColor,n=this.state.pathTesselator;t.bufferLayout=n.bufferLayout,t.value=n.get("colors",t.value,e)}},{key:"calculatePickingColors",value:function(t){var e=this,n=this.state.pathTesselator,r=[];t.value=n.get("pickingColors",t.value,(function(t){return e.encodePickingColor(t,r)}))}},{key:"clearPickingColor",value:function(t){for(var e=this.decodePickingColor(t),n=this.state.pathTesselator.bufferLayout,r=n[e],i=0,o=0;o<e;o++)i+=n[o];var a=this.getAttributeManager().attributes.instancePickingColors,s=a.value,u=i+r;s.fill(0,3*i,3*u),a.update({value:s})}}])&&xl(n.prototype,r),i&&xl(n,i),e}(qe);Il.layerName="PathLayer",Il.defaultProps=Cl;var Al=n(188),Tl=n.n(Al);function Nl(t){if(t=t&&t.positions||t,!Array.isArray(t)&&!ArrayBuffer.isView(t))throw new Error("invalid polygon")}function Ll(t){return t.length>=1&&t[0].length>=2&&Number.isFinite(t[0][0])}function Rl(t){var e=t[0],n=t[t.length-1];return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}function kl(t,e,n,r){for(var i=0;i<e;i++)if(t[n+i]!==t[r-e+i])return!1;return!0}function jl(t,e,n,r){for(var i=e,o=n.length,a=0;a<o;a++)for(var s=0;s<r;s++)t[i++]=n[a][s]||0;if(!Rl(n))for(var u=0;u<r;u++)t[i++]=n[0][u]||0;return i}function Fl(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5?arguments[5]:void 0,a=(o=o||n.length)-i;if(a<=0)return e;for(var s=e,u=0;u<a;u++)t[s++]=n[i+u];if(!kl(n,r,i,o))for(var c=0;c<r;c++)t[s++]=n[i+c];return s}function Dl(t){return(Rl(t)?0:1)+t.length}function Bl(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0;return n>=(r=r||t.length)?0:(kl(t,e,n,r)?0:1)+(r-n)/e}function zl(t,e){if(Nl(t),t.positions){var n=t,r=n.positions,i=n.holeIndices;if(i){for(var o=0,a=0;a<=i.length;a++)o+=Bl(t.positions,e,i[a-1],i[a]);return o}t=r}if(Number.isFinite(t[0]))return Bl(t,e);if(!Ll(t)){var s=0,u=!0,c=!1,l=void 0;try{for(var f,h=t[Symbol.iterator]();!(u=(f=h.next()).done);u=!0){s+=Dl(f.value)}}catch(t){c=!0,l=t}finally{try{u||null==h.return||h.return()}finally{if(c)throw l}}return s}return Dl(t)}function Vl(t,e,n){Nl(t),n=n||zl(t,e);var r=new Float64Array(n*e),i=[];if(t.positions){var o=t,a=o.positions,s=o.holeIndices;if(s){for(var u=0,c=0;c<=s.length;c++)u=Fl(r,u,a,e,s[c-1],s[c]),i.push(u);return i.pop(),{positions:r,holeIndices:i}}t=a}if(Number.isFinite(t[0]))return Fl(r,0,t,e),{positions:r,holeIndices:null};if(!Ll(t)){var l=0,f=!0,h=!1,d=void 0;try{for(var p,g=t[Symbol.iterator]();!(f=(p=g.next()).done);f=!0){l=jl(r,l,p.value,e),i.push(l)}}catch(t){h=!0,d=t}finally{try{f||null==g.return||g.return()}finally{if(h)throw d}}return i.pop(),{positions:r,holeIndices:i}}return jl(r,0,t,e),{positions:r,holeIndices:null}}function Gl(t){return(Gl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ul(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Wl(t,e){return!e||"object"!==Gl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ql(t){return(ql=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xl(t,e){return(Xl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Hl=zs.Tesselator,Yl=o.fp64.fp64LowPart,Zl=[0,0,0,255],Kl=function(t){function e(t){var n=t.data,r=t.getGeometry,i=t.fp64,o=t.positionFormat,a=t.IndexType,s=void 0===a?Uint32Array:a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Wl(this,ql(e).call(this,{data:n,getGeometry:r,fp64:i,positionFormat:o,attributes:{positions:{size:3},positions64xyLow:{size:2,fp64Only:!0},vertexValid:{type:Uint8ClampedArray,size:1},indices:{type:s,size:1}}}))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Xl(t,e)}(e,t),n=e,(r=[{key:"get",value:function(t,e,n){if("indices"===t)return this.attributes.indices.subarray(0,this.vertexCount);if(this.attributes[t])return this.attributes[t];switch(t){case"elevations":return this._updateAttribute({target:e,size:1,getValue:function(t){return[n(t)]}});case"colors":return this._updateAttribute({target:e,size:4,getValue:function(t){var e=n(t);return 4===e.length?e:(Zl[0]=e[0],Zl[1]=e[1],Zl[2]=e[2],Zl)}});case"pickingColors":return this._updateAttribute({target:e,size:3,getValue:function(t,e){return n(e)}});default:return null}}},{key:"getGeometrySize",value:function(t){return zl(t,this.positionSize)}},{key:"updateGeometryAttributes",value:function(t,e){t=Vl(t,this.positionSize,e.geometrySize),this._updateIndices(t,e),this._updatePositions(t,e)}},{key:"_updateIndices",value:function(t,e){var n,r,i,o=e.geometryIndex,a=e.vertexStart,s=e.indexStart,u=this.attributes,c=this.indexLayout,l=this.typedArrayManager,f=u.indices,h=f.length,d=s,p=(n=t,r=this.positionSize,i=null,n.holeIndices&&(i=n.holeIndices.map((function(t){return t/r}))),Tl()(n.positions,i,r));h<d+p.length&&(h=2*(d+p.length),f=l.allocate(f,h,{type:f.constructor,size:1,copy:!0}));for(var g=0;g<p.length;g++)f[d++]=p[g]+a;c[o]=p.length,u.indices=f}},{key:"_updatePositions",value:function(t,e){for(var n=e.vertexStart,r=e.geometrySize,i=this.attributes,o=i.positions,a=i.positions64xyLow,s=i.vertexValid,u=this.fp64,c=this.positionSize,l=n,f=t.positions,h=t.holeIndices,d=0;d<r;d++){var p=f[d*c],g=f[d*c+1],v=c>2?f[d*c+2]:0;o[3*l]=p,o[3*l+1]=g,o[3*l+2]=v,u&&(a[2*l]=Yl(p),a[2*l+1]=Yl(g)),s[l]=1,l++}if(h)for(var y=0;y<h.length;y++)s[n+h[y]/c-1]=0;s[n+r-1]=0}}])&&Ul(n.prototype,r),i&&Ul(n,i),e}(Hl);function Jl(t){return(Jl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ql(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function tf(t,e){return!e||"object"!==Jl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ef(t,e,n){return(ef="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=nf(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function nf(t){return(nf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function rf(t,e){return(rf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var of=[0,0,0,255],af={filled:!0,extruded:!1,wireframe:!1,fp64:!1,elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:function(t){return t.polygon}},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:of},getLineColor:{type:"accessor",value:of},lightSettings:{}},sf={enter:function(t,e){return e.length?e.subarray(e.length-t.length):t}},uf=function(t){function e(){return Ql(this,e),tf(this,nf(e).apply(this,arguments))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&rf(t,e)}(e,t),n=e,(r=[{key:"getShaders",value:function(){return{vs:"#define SHADER_NAME solid-polygon-layer-vertex-shader\n\nattribute vec2 vertexPositions;\nattribute float vertexValid;\nattribute vec3 positions;\nattribute vec2 positions64xyLow;\nattribute vec3 nextPositions;\nattribute vec2 nextPositions64xyLow;\nattribute float elevations;\nattribute vec4 fillColors;\nattribute vec4 lineColors;\nattribute vec3 pickingColors;\n\nuniform bool isSideVertex;\nuniform bool extruded;\nuniform bool isWireframe;\nuniform float elevationScale;\nuniform float opacity;\n\nvarying vec4 vColor;\nvarying float isValid;\n\nvoid main(void) {\n  vec3 pos;\n  vec2 pos64xyLow;\n  vec3 normal;\n  vec4 colors = isWireframe ? lineColors : fillColors;\n\n  if (isSideVertex) {\n    pos = mix(positions, nextPositions, vertexPositions.x);\n    pos64xyLow = mix(positions64xyLow, nextPositions64xyLow, vertexPositions.x);\n    isValid = vertexValid;\n  } else {\n    pos = positions;\n    pos64xyLow = positions64xyLow;\n    isValid = 1.0;\n  }\n  if (extruded) {\n    pos.z += elevations * vertexPositions.y;\n  }\n  pos.z *= elevationScale;\n\n  vec4 position_worldspace;\n  gl_Position = project_position_to_clipspace(pos, pos64xyLow, vec3(0.), position_worldspace);\n\n  float lightWeight = 1.0;\n  \n  if (extruded) {\n    if (isSideVertex) {\n      normal = vec3(positions.y - nextPositions.y, nextPositions.x - positions.x, 0.0);\n      normal = project_normal(normal);\n    } else {\n      normal = vec3(0.0, 0.0, 1.0);\n    }\n\n    lightWeight = lighting_getLightWeight(position_worldspace.xyz, normal);\n  }\n\n  vec3 lightWeightedColor = lightWeight * colors.rgb;\n  vColor = vec4(lightWeightedColor, colors.a * opacity) / 255.0;\n\n  // Set color to be rendered to picking fbo (also used to check for selection highlight).\n  picking_setPickingColor(pickingColors);\n}\n",fs:"#define SHADER_NAME solid-polygon-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\nvarying float isValid;\n\nvoid main(void) {\n  if (isValid < 0.5) {\n    discard;\n  }\n\n  gl_FragColor = vColor;\n\n  // use highlight color if this fragment belongs to the selected object.\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n\n  // use picking color if rendering to picking FBO.\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n}\n",modules:[this.use64bitProjection()?"project64":"project32","lighting","picking"]}}},{key:"initializeState",value:function(){var t=this.context.gl;this.setState({numInstances:0,polygonTesselator:new Kl({IndexType:!t||Object(o.hasFeature)(t,o.FEATURES.ELEMENT_INDEX_UINT32)?Uint32Array:Uint16Array})});var e=this.getAttributeManager();e.remove(["instancePickingColors"]),e.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:!0},positions:{size:3,transition:sf,accessor:"getPolygon",update:this.calculatePositions,noAlloc:!0},positions64xyLow:{size:2,update:this.calculatePositionsLow,noAlloc:!0},vertexValid:{size:1,type:lt.a.UNSIGNED_BYTE,update:this.calculateVertexValid,noAlloc:!0},elevations:{size:1,transition:sf,accessor:"getElevation",update:this.calculateElevations},fillColors:{alias:"colors",size:4,type:lt.a.UNSIGNED_BYTE,transition:sf,accessor:"getFillColor",update:this.calculateFillColors,defaultValue:of},lineColors:{alias:"colors",size:4,type:lt.a.UNSIGNED_BYTE,transition:sf,accessor:"getLineColor",update:this.calculateLineColors,defaultValue:of},pickingColors:{size:3,type:lt.a.UNSIGNED_BYTE,update:this.calculatePickingColors}})}},{key:"draw",value:function(t){var e=t.uniforms,n=this.props,r=n.extruded,i=n.filled,o=n.wireframe,a=n.elevationScale,s=this.state,u=s.topModel,c=s.sideModel,l=Object.assign({},e,{extruded:Boolean(r),elevationScale:a});c&&(c.setUniforms(l),o&&(c.setDrawMode(lt.a.LINE_STRIP),c.render({isWireframe:!0})),i&&(c.setDrawMode(lt.a.TRIANGLE_FAN),c.render({isWireframe:!1}))),u&&u.render(l)}},{key:"updateState",value:function(t){ef(nf(e.prototype),"updateState",this).call(this,t),this.updateGeometry(t);var n=t.props,r=t.oldProps,i=this.getAttributeManager();(n.fp64!==r.fp64||n.filled!==r.filled||n.extruded!==r.extruded)&&(this.state.models&&this.state.models.forEach((function(t){return t.delete()})),this.setState(this._getModels(this.context.gl)),i.invalidateAll())}},{key:"updateGeometry",value:function(t){var e=t.props,n=t.oldProps,r=t.changeFlags;if(r.dataChanged||e.fp64!==n.fp64||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPolygon)){var i=this.state.polygonTesselator;i.updateGeometry({data:e.data,getGeometry:e.getPolygon,positionFormat:e.positionFormat,fp64:this.use64bitPositions()}),this.setState({numInstances:i.instanceCount}),this.getAttributeManager().invalidateAll()}}},{key:"updateAttributes",value:function(t){ef(nf(e.prototype),"updateAttributes",this).call(this,t);var n=this.getAttributeManager().getChangedAttributes({clearChangedFlags:!0}),r=this.state,i=r.topModel,o=r.sideModel,a=this.getNumInstances();if(i){if(n.indices){var s=n.indices.value.length;i.setVertexCount(s)}i.setAttributes(n)}if(o){o.setInstanceCount(a-1);var u={};for(var c in n){var l=n[c];"indices"!==c&&(u[c]=Object.assign({},l,{isInstanced:!0,buffer:l.getBuffer()}))}u.positions&&(u.nextPositions=Object.assign({},u.positions,{id:"nextPositions",offset:12})),u.positions64xyLow&&(u.nextPositions64xyLow=Object.assign({},u.positions64xyLow,{id:"nextPositions64xyLow",offset:8})),o.setAttributes(u)}}},{key:"_getModels",value:function(t){var e,n,r=this.props,i=r.id,a=r.filled,s=r.extruded;return a&&(e=new o.Model(t,Object.assign({},this.getShaders(),{id:"".concat(i,"-top"),geometry:new o.Geometry({drawMode:lt.a.TRIANGLES,attributes:{vertexPositions:{size:2,constant:!0,value:new Float32Array([0,1])},nextPositions:{size:3,constant:!0,value:new Float32Array(3)},nextPositions64xyLow:{size:2,constant:!0,value:new Float32Array(2)}}}),uniforms:{isWireframe:!1,isSideVertex:!1},vertexCount:0,isIndexed:!0,shaderCache:this.context.shaderCache}))),s&&(n=new o.Model(t,Object.assign({},this.getShaders(),{id:"".concat(i,"-side"),geometry:new o.Geometry({drawMode:lt.a.LINES,vertexCount:4,attributes:{vertexPositions:{size:2,value:new Float32Array([1,1,0,1,0,0,1,0])}}}),uniforms:{isSideVertex:!0},isInstanced:1,shaderCache:this.context.shaderCache}))),{models:[n,e].filter(Boolean),topModel:e,sideModel:n}}},{key:"calculateIndices",value:function(t){var e=this.state.polygonTesselator;t.bufferLayout=e.indexLayout,t.value=e.get("indices")}},{key:"calculatePositions",value:function(t){var e=this.state.polygonTesselator;t.bufferLayout=e.bufferLayout,t.value=e.get("positions")}},{key:"calculatePositionsLow",value:function(t){var e=this.use64bitPositions();t.constant=!e,t.value=e?this.state.polygonTesselator.get("positions64xyLow"):new Float32Array(2)}},{key:"calculateVertexValid",value:function(t){t.value=this.state.polygonTesselator.get("vertexValid")}},{key:"calculateElevations",value:function(t){var e=this.state.polygonTesselator;t.bufferLayout=e.bufferLayout;var n=this.props,r=n.extruded,i=n.getElevation;r?(t.constant=!1,t.value=e.get("elevations",t.value,i)):(t.constant=!0,t.value=new Float32Array(1))}},{key:"calculateFillColors",value:function(t){var e=this.state.polygonTesselator;t.bufferLayout=e.bufferLayout,t.value=e.get("colors",t.value,this.props.getFillColor)}},{key:"calculateLineColors",value:function(t){var e=this.state.polygonTesselator;t.bufferLayout=e.bufferLayout,t.value=e.get("colors",t.value,this.props.getLineColor)}},{key:"calculatePickingColors",value:function(t){var e=this,n=[];t.value=this.state.polygonTesselator.get("pickingColors",t.value,(function(t){return e.encodePickingColor(t,n)}))}},{key:"clearPickingColor",value:function(t){for(var e=this.decodePickingColor(t),n=this.state.polygonTesselator.bufferLayout,r=n[e],i=0,o=0;o<e;o++)i+=n[o];var a=this.getAttributeManager().attributes.pickingColors,s=a.value,u=i+r;s.fill(0,3*i,3*u),a.update({value:s})}}])&&$l(n.prototype,r),i&&$l(n,i),e}(qe);function cf(t){return(cf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function lf(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ff(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function hf(t,e){return!e||"object"!==cf(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function df(t){return(df=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function pf(t,e){return(pf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}uf.layerName="SolidPolygonLayer",uf.defaultProps=af;var gf={stroked:!0,filled:!0,extruded:!1,elevationScale:1,wireframe:!1,lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,lineDashJustified:!1,fp64:!1,getPolygon:{type:"accessor",value:function(t){return t.polygon}},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1},getLineDashArray:{type:"accessor",value:[0,0]},getElevation:{type:"accessor",value:1e3},lightSettings:{}},vf=function(t){function e(){return lf(this,e),hf(this,df(e).apply(this,arguments))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&pf(t,e)}(e,t),n=e,(r=[{key:"initializeState",value:function(){this.state={paths:[]}}},{key:"updateState",value:function(t){t.oldProps;var e=t.props,n=t.changeFlags;(n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPolygon))&&(this.state.paths=this._getPaths(e))}},{key:"getPickingInfo",value:function(t){var e=t.info;return Object.assign(e,{object:e.object&&e.object.object||e.object})}},{key:"_getPaths",value:function(t){var e=t.data,n=t.getPolygon,r=[],i="XY"===t.positionFormat?2:3,o=!0,a=!1,s=void 0;try{for(var u,c=e[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var l=u.value,f=Vl(n(l),i),h=f.positions,d=f.holeIndices;if(d)for(var p=0;p<=d.length;p++){var g=h.subarray(d[p-1]||0,d[p]||h.length);r.push({path:g,object:l})}else r.push({path:h,object:l})}}catch(t){a=!0,s=t}finally{try{o||null==c.return||c.return()}finally{if(a)throw s}}return r}},{key:"_getAccessor",value:function(t){return"function"==typeof t?function(e){return t(e.object)}:t}},{key:"renderLayers",value:function(){var t=this.props,e=t.data,n=t.stroked,r=t.filled,i=t.extruded,o=t.wireframe,a=t.elevationScale,s=t.transitions,u=this.props,c=u.lineWidthScale,l=u.lineWidthMinPixels,f=u.lineWidthMaxPixels,h=u.lineJointRounded,d=u.lineMiterLimit,p=u.lineDashJustified,g=u.fp64,v=this.props,y=v.getFillColor,m=v.getLineColor,b=v.getLineWidth,_=v.getLineDashArray,x=v.getElevation,w=v.getPolygon,E=v.updateTriggers,S=v.lightSettings,O=this.state.paths,P=this.getSubLayerClass("fill",uf),C=this.getSubLayerClass("stroke",Il),M=this.shouldRenderSubLayer("fill",O)&&new P({extruded:i,elevationScale:a,fp64:g,filled:r,wireframe:o,getElevation:x,getFillColor:y,getLineColor:m,lightSettings:S,transitions:s},this.getSubLayerProps({id:"fill",updateTriggers:{getPolygon:E.getPolygon,getElevation:E.getElevation,getFillColor:E.getFillColor,getLineColor:E.getLineColor}}),{data:e,getPolygon:w});return[!i&&M,!i&&n&&this.shouldRenderSubLayer("stroke",O)&&new C({fp64:g,widthScale:c,widthMinPixels:l,widthMaxPixels:f,rounded:h,miterLimit:d,dashJustified:p,transitions:s&&{getWidth:s.getLineWidth,getColor:s.getLineColor,getPath:s.getPolygon},getColor:this._getAccessor(m),getWidth:this._getAccessor(b),getDashArray:this._getAccessor(_)},this.getSubLayerProps({id:"stroke",updateTriggers:{getWidth:E.getLineWidth,getColor:E.getLineColor,getDashArray:E.getLineDashArray}}),{data:O,getPath:function(t){return t.path}}),i&&M]}}])&&ff(n.prototype,r),i&&ff(n,i),e}(Qi);function yf(t,e){if(!t)throw new Error("deck.gl: ".concat(e))}function mf(t,e,n){var r=t.type,i=t.coordinates,o=e.pointFeatures,a=e.lineFeatures,s=e.polygonFeatures,u=e.polygonOutlineFeatures;switch(function(t,e){var n=_f[t];yf(n,"Unknown GeoJSON type ".concat(t));for(;e&&--n>0;)e=e[0];yf(e&&Number.isFinite(e[0]),"".concat(t," coordinates are malformed"))}(r,i),r){case"Point":o.push({geometry:t,sourceFeature:n});break;case"MultiPoint":i.forEach((function(t){o.push({geometry:{type:"Point",coordinates:t},sourceFeature:n})}));break;case"LineString":a.push({geometry:t,sourceFeature:n});break;case"MultiLineString":i.forEach((function(t){a.push({geometry:{type:"LineString",coordinates:t},sourceFeature:n})}));break;case"Polygon":s.push({geometry:t,sourceFeature:n}),i.forEach((function(t){u.push({geometry:{type:"LineString",coordinates:t},sourceFeature:n})}));break;case"MultiPolygon":i.forEach((function(t){s.push({geometry:{type:"Polygon",coordinates:t},sourceFeature:n}),t.forEach((function(t){u.push({geometry:{type:"LineString",coordinates:t},sourceFeature:n})}))}))}}function bf(t){return t.sourceFeature.feature}vf.layerName="PolygonLayer",vf.defaultProps=gf;var _f={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function xf(t){return(xf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function wf(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ef(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Sf(t,e){return!e||"object"!==xf(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Of(t){return(Of=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Pf(t,e){return(Pf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Cf={stroked:!0,filled:!0,extruded:!1,wireframe:!1,lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,elevationScale:1,pointRadiusScale:1,pointRadiusMinPixels:0,pointRadiusMaxPixels:Number.MAX_SAFE_INTEGER,lineDashJustified:!1,fp64:!1,getLineColor:{type:"accessor",value:[0,0,0,255]},getFillColor:{type:"accessor",value:[0,0,0,255]},getRadius:{type:"accessor",value:1},getLineWidth:{type:"accessor",value:1},getLineDashArray:{type:"accessor",value:[0,0]},getElevation:{type:"accessor",value:1e3},lightSettings:{}};function Mf(t){return t.geometry.coordinates}function If(t){return"function"!=typeof t?t:function(e){return t(bf(e))}}var Af=function(t){function e(){return wf(this,e),Sf(this,Of(e).apply(this,arguments))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Pf(t,e)}(e,t),n=e,(r=[{key:"initializeState",value:function(){this.state={features:{}}}},{key:"updateState",value:function(t){t.oldProps;var e=t.props;if(t.changeFlags.dataChanged){var n=function(t){if(Array.isArray(t))return t;switch(yf(t.type,"GeoJSON does not have type"),t.type){case"Feature":return[t];case"FeatureCollection":return yf(Array.isArray(t.features),"GeoJSON does not have features array"),t.features;default:return[{geometry:t}]}}(e.data);this.state.features=function(t){for(var e={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},n=0;n<t.length;n++){var r=t[n];yf(r&&r.geometry,"GeoJSON does not have geometry");var i=r.geometry,o={feature:r,index:n};if("GeometryCollection"===i.type){yf(Array.isArray(i.geometries),"GeoJSON does not have geometries array");for(var a=i.geometries,s=0;s<a.length;s++)mf(a[s],e,o)}else mf(i,e,o)}return e}(n)}}},{key:"getPickingInfo",value:function(t){var e,n=t.info;return t.sourceLayer,Object.assign(n,{object:n.object?bf(n.object):n.object,index:n.object?(e=n.object,e.sourceFeature.index):n.index})}},{key:"renderLayers",value:function(){var t=this.state.features,e=t.pointFeatures,n=t.lineFeatures,r=t.polygonFeatures,i=t.polygonOutlineFeatures,o=this.props,a=o.stroked,s=o.filled,u=o.extruded,c=o.wireframe,l=o.lightSettings,f=o.transitions,h=this.props,d=h.lineWidthScale,p=h.lineWidthMinPixels,g=h.lineWidthMaxPixels,v=h.lineJointRounded,y=h.lineMiterLimit,m=h.pointRadiusScale,b=h.pointRadiusMinPixels,_=h.pointRadiusMaxPixels,x=h.elevationScale,w=h.lineDashJustified,E=h.fp64,S=this.props,O=S.getLineColor,P=S.getFillColor,C=S.getRadius,M=S.getLineWidth,I=S.getLineDashArray,A=S.getElevation,T=S.updateTriggers,N=this.getSubLayerClass("polygons-fill",uf),L=this.getSubLayerClass("polygons-stroke",Il),R=this.getSubLayerClass("line-strings",Il),k=this.getSubLayerClass("points",Ju),j=this.shouldRenderSubLayer("polygons-fill",r)&&new N({fp64:E,extruded:u,elevationScale:x,filled:s,wireframe:c,lightSettings:l,getElevation:If(A),getFillColor:If(P),getLineColor:If(O),transitions:f&&{getPolygon:f.geometry,getElevation:f.getElevation,getFillColor:f.getFillColor,getLineColor:f.getLineColor}},this.getSubLayerProps({id:"polygons-fill",updateTriggers:{getElevation:T.getElevation,getFillColor:T.getFillColor,getLineColor:T.getLineColor}}),{data:r,getPolygon:Mf});return[!u&&j,!u&&a&&this.shouldRenderSubLayer("polygons-stroke",i)&&new L({fp64:E,widthScale:d,widthMinPixels:p,widthMaxPixels:g,rounded:v,miterLimit:y,dashJustified:w,getColor:If(O),getWidth:If(M),getDashArray:If(I),transitions:f&&{getPath:f.geometry,getColor:f.getLineColor,getWidth:f.getLineWidth}},this.getSubLayerProps({id:"polygons-stroke",updateTriggers:{getColor:T.getLineColor,getWidth:T.getLineWidth,getDashArray:T.getLineDashArray}}),{data:i,getPath:Mf}),this.shouldRenderSubLayer("linestrings",n)&&new R({fp64:E,widthScale:d,widthMinPixels:p,widthMaxPixels:g,rounded:v,miterLimit:y,dashJustified:w,getColor:If(O),getWidth:If(M),getDashArray:If(I),transitions:f&&{getPath:f.geometry,getColor:f.getLineColor,getWidth:f.getLineWidth}},this.getSubLayerProps({id:"line-strings",updateTriggers:{getColor:T.getLineColor,getWidth:T.getLineWidth,getDashArray:T.getLineDashArray}}),{data:n,getPath:Mf}),this.shouldRenderSubLayer("points",e)&&new k({fp64:E,stroked:a,filled:s,radiusScale:m,radiusMinPixels:b,radiusMaxPixels:_,lineWidthScale:d,lineWidthMinPixels:p,lineWidthMaxPixels:g,getFillColor:If(P),getLineColor:If(O),getRadius:If(C),getLineWidth:If(M),transitions:f&&{getPosition:f.geometry,getFillColor:f.getFillColor,getLineColor:f.getLineColor,getRadius:f.getRadius,getLineWidth:f.getLineWidth}},this.getSubLayerProps({id:"points",updateTriggers:{getFillColor:T.getFillColor,getLineColor:T.getLineColor,getRadius:T.getRadius,getLineWidth:T.getLineWidth}}),{data:e,getPosition:Mf}),u&&j]}}])&&Ef(n.prototype,r),i&&Ef(n,i),e}(Qi);Af.layerName="GeoJsonLayer",Af.defaultProps=Cf;function Tf(t){return(Tf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Nf(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Lf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Rf(t,e){return!e||"object"!==Tf(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function kf(t,e,n){return(kf="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=jf(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function jf(t){return(jf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ff(t,e){return(Ff=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Df=function(t){function e(){return Nf(this,e),Rf(this,jf(e).apply(this,arguments))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ff(t,e)}(e,t),n=e,(r=[{key:"getShaders",value:function(){return Object.assign({},kf(jf(e.prototype),"getShaders",this).call(this),{vs:'#define SHADER_NAME multi-icon-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec2 instancePositions64xyLow;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute vec4 instanceIconFrames;\nattribute float instanceColorModes;\nattribute vec2 instanceOffsets;\n\n// the following three attributes are for the multi-icon layer\nattribute vec2 instancePixelOffset;\n\nuniform float sizeScale;\nuniform vec2 iconsTextureDim;\nuniform float gamma;\nuniform float opacity;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying float vGamma;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = angle * PI / 180.0;\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  vec2 iconSize = instanceIconFrames.zw;\n  // scale icon height to match instanceSize\n  float instanceScale = iconSize.y == 0.0 ? 0.0 : instanceSizes / iconSize.y;\n\n  // scale and rotate vertex in "pixel" value and convert back to fraction in clipspace\n  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;\n\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * sizeScale * instanceScale;\n  pixelOffset += instancePixelOffset;\n  pixelOffset.y *= -1.0;\n\n  gl_Position = project_position_to_clipspace(instancePositions, instancePositions64xyLow, vec3(0.0));\n  gl_Position += project_pixel_to_clipspace(pixelOffset);\n\n  vTextureCoords = mix(\n    instanceIconFrames.xy,\n    instanceIconFrames.xy + iconSize,\n    (positions.xy + 1.0) / 2.0\n  ) / iconsTextureDim;\n\n  vTextureCoords.y = 1.0 - vTextureCoords.y;\n\n  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity) / 255.;\n  picking_setPickingColor(instancePickingColors);\n\n  vGamma = gamma / (sizeScale * iconSize.y);\n}\n',fs:"#define SHADER_NAME multi-icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform sampler2D iconsTexture;\nuniform float buffer;\nuniform bool sdf;\n\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying float vGamma;\n\nconst float MIN_ALPHA = 0.05;\n\nvoid main(void) {\n  vec4 texColor = texture2D(iconsTexture, vTextureCoords);\n  \n  float alpha = texColor.a;\n  // if enable sdf (signed distance fields)\n  if (sdf) {\n    float distance = texture2D(iconsTexture, vTextureCoords).a;\n    alpha = smoothstep(buffer - vGamma, buffer + vGamma, distance);\n  }\n\n  // Take the global opacity and the alpha from vColor into account for the alpha component\n  float a = alpha * vColor.a;\n\n  if (a < MIN_ALPHA) {\n    discard;\n  }\n\n  gl_FragColor = vec4(vColor.rgb, a);\n\n  // use highlight color if this fragment belongs to the selected object.\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n\n  // use picking color if rendering to picking FBO.\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n}\n"})}},{key:"initializeState",value:function(){kf(jf(e.prototype),"initializeState",this).call(this),this.getAttributeManager().addInstanced({instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}},{key:"updateState",value:function(t){kf(jf(e.prototype),"updateState",this).call(this,t);var n=t.changeFlags;n.updateTriggersChanged&&(n.updateTriggersChanged.getAnchorX||n.updateTriggersChanged.getAnchorY)&&this.getAttributeManager().invalidate("instanceOffsets")}},{key:"draw",value:function(t){var n=t.uniforms,r=this.props.sdf;kf(jf(e.prototype),"draw",this).call(this,{uniforms:Object.assign({},n,{buffer:.75,gamma:.2,sdf:Boolean(r)})})}},{key:"calculateInstanceOffsets",value:function(t){var e=this.props,n=e.data,r=e.iconMapping,i=e.getIcon,o=e.getAnchorX,a=e.getAnchorY,s=e.getLengthOfQueue,u=e.getShiftInQueue,c=t.value,l=0,f=!0,h=!1,d=void 0;try{for(var p,g=n[Symbol.iterator]();!(f=(p=g.next()).done);f=!0){var v=p.value,y=r[i(v)]||{},m=s(v),b=u(v);c[l++]=(o(v)-1)*m/2+y.width/2+b||0,c[l++]=y.height/2*a(v)||0}}catch(t){h=!0,d=t}finally{try{f||null==g.return||g.return()}finally{if(h)throw d}}}},{key:"calculateInstancePickingColors",value:function(t){var e=this.props,n=e.data,r=e.getPickingIndex,i=t.value,o=0,a=[],s=!0,u=!1,c=void 0;try{for(var l,f=n[Symbol.iterator]();!(s=(l=f.next()).done);s=!0){var h=r(l.value);this.encodePickingColor(h,a),i[o++]=a[0],i[o++]=a[1],i[o++]=a[2]}}catch(t){u=!0,c=t}finally{try{s||null==f.return||f.return()}finally{if(u)throw c}}}}])&&Lf(n.prototype,r),i&&Lf(n,i),e}(mu);Df.layerName="MultiIconLayer",Df.defaultProps={getShiftInQueue:{type:"accessor",value:function(t){return t.shift||0}},getLengthOfQueue:{type:"accessor",value:function(t){return t.len||1}},getAnchorX:{type:"accessor",value:function(t){return t.anchorX||0}},getAnchorY:{type:"accessor",value:function(t){return t.anchorY||0}},getPixelOffset:{type:"accessor",value:[0,0]},getPickingIndex:{type:"accessor",value:function(t){return t.objectIndex}}};var Bf=n(295),zf=n.n(Bf);function Vf(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Gf=function(){for(var t=[],e=32;e<128;e++)t.push(String.fromCharCode(e));return t}(),Uf={fontSize:64,buffer:2,sdf:!1,cutoff:.25,radius:3};function Wf(t,e){for(var n=0;n<t.length;n++)e.data[4*n+3]=t[n]}function qf(t,e,n,r){t.font="".concat(r," ").concat(n,"px ").concat(e),t.fillStyle="#000",t.textBaseline="baseline",t.textAlign="left"}function Xf(t,e){var n,r=Object.assign({fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:Gf},Uf,e),i=r.fontFamily,a=r.fontWeight,s=r.characterSet,u=r.fontSize,c=r.buffer,l=r.sdf,f=r.radius,h=r.cutoff,d=document.createElement("canvas"),p=d.getContext("2d");qf(p,i,u,a);var g=function(t){var e=t.ctx,n=t.fontHeight,r=t.buffer,i=t.characterSet,o=t.maxCanvasWidth,a={},s=0,u=0;return Array.from(i).forEach((function(t){var i=e.measureText(t).width;u+i+2*r>o&&(u=0,s++),a[t]={x:u+r,y:s*(n+2*r)+r,width:i,height:n,mask:!0},u+=i+2*r})),{mapping:a,canvasHeight:(s+1)*(n+2*r)}}({ctx:p,fontHeight:1.2*u,buffer:c,characterSet:s,maxCanvasWidth:1024}),v=g.canvasHeight,y=g.mapping;if(d.width=1024,d.height=v,qf(p,i,u,a),l){var m=new zf.a(u,c,f,h,i,a),b=p.createImageData(m.size,m.size),_=!0,x=!1,w=void 0;try{for(var E,S=s[Symbol.iterator]();!(_=(E=S.next()).done);_=!0){var O=E.value;Wf(m.draw(O),b),p.putImageData(b,y[O].x-c,y[O].y-c)}}catch(t){x=!0,w=t}finally{try{_||null==S.return||S.return()}finally{if(x)throw w}}}else{var P=!0,C=!1,M=void 0;try{for(var I,A=s[Symbol.iterator]();!(P=(I=A.next()).done);P=!0){var T=I.value;p.fillText(T,y[T].x,y[T].y+.9*u)}}catch(t){C=!0,M=t}finally{try{P||null==A.return||A.return()}finally{if(C)throw M}}}return{scale:1.2,mapping:y,texture:new o.Texture2D(t,{pixels:d,parameters:(n={},Vf(n,10242,33071),Vf(n,10243,33071),n)})}}function Hf(t){return(Hf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Yf(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Zf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Kf(t,e){return!e||"object"!==Hf(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Jf(t){return(Jf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Qf(t,e){return(Qf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var $f={start:1,middle:0,end:-1},th={top:1,center:0,bottom:-1},eh=["fontSize","buffer","sdf","radius","cutoff"],nh={fp64:!1,sizeScale:1,characterSet:Gf,fontFamily:"Monaco, monospace",fontWeight:"normal",fontSettings:{},getText:{type:"accessor",value:function(t){return t.text}},getPosition:{type:"accessor",value:function(t){return t.position}},getColor:{type:"accessor",value:[0,0,0,255]},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]}},rh=function(t){function e(){return Yf(this,e),Kf(this,Jf(e).apply(this,arguments))}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Qf(t,e)}(e,t),n=e,(r=[{key:"updateState",value:function(t){var e=t.props,n=t.oldProps,r=t.changeFlags,i=this.fontChanged(n,e);i&&this.updateFontAtlas(),(r.dataChanged||i||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getText))&&this.transformStringToLetters()}},{key:"updateFontAtlas",value:function(){var t=this.context.gl,e=this.props,n=e.fontSettings,r=e.fontFamily,i=e.fontWeight,o=e.characterSet,a=Xf(t,Object.assign({},Uf,n,{fontFamily:r,fontWeight:i,characterSet:o})),s=a.scale,u=a.mapping,c=a.texture;this.setState({scale:s,iconAtlas:c,iconMapping:u})}},{key:"fontChanged",value:function(t,e){if(t.fontFamily!==e.fontFamily||t.characterSet!==e.characterSet||t.fontWeight!==e.fontWeight)return!0;if(t.fontSettings===e.fontSettings)return!1;var n=t.fontSettings||{},r=e.fontSettings||{};return eh.some((function(t){return n[t]!==r[t]}))}},{key:"getPickingInfo",value:function(t){var e=t.info;return Object.assign(e,{object:e.index>=0?this.props.data[e.index]:null})}},{key:"transformStringToLetters",value:function(){var t=this.props,e=t.data,n=t.getText,r=this.state.iconMapping,o=[],a=0,s=!0,u=!1,c=void 0;try{for(var l,f=function(){var t=l.value,e=n(t);if(e){var s=Array.from(e),u=[0],c=0;s.forEach((function(n,s){var l={text:n,index:s,offsets:u,len:e.length,object:t,objectIndex:a},f=r[n];f?c+=f.width:(i.warn("Missing character: ".concat(n))(),c+=32),u.push(c),o.push(l)}))}a++},h=e[Symbol.iterator]();!(s=(l=h.next()).done);s=!0)f()}catch(t){u=!0,c=t}finally{try{s||null==h.return||h.return()}finally{if(u)throw c}}this.setState({data:o})}},{key:"getLetterOffset",value:function(t){return t.offsets[t.index]}},{key:"getTextLength",value:function(t){return t.offsets[t.offsets.length-1]}},{key:"_getAccessor",value:function(t){return"function"==typeof t?function(e){return t(e.object)}:t}},{key:"getAnchorXFromTextAnchor",value:function(t){return function(e){var n="function"==typeof t?t(e.object):t;if(!$f.hasOwnProperty(n))throw new Error("Invalid text anchor parameter: ".concat(n));return $f[n]}}},{key:"getAnchorYFromAlignmentBaseline",value:function(t){return function(e){var n="function"==typeof t?t(e.object):t;if(!th.hasOwnProperty(n))throw new Error("Invalid alignment baseline parameter: ".concat(n));return th[n]}}},{key:"renderLayers",value:function(){var t=this,e=this.state,n=e.data,r=e.scale,i=e.iconAtlas,o=e.iconMapping,a=this.props,s=a.getPosition,u=a.getColor,c=a.getSize,l=a.getAngle,f=a.getTextAnchor,h=a.getAlignmentBaseline,d=a.getPixelOffset,p=a.fp64,g=a.sdf,v=a.sizeScale,y=a.transitions,m=a.updateTriggers;return new(this.getSubLayerClass("characters",Df))({sdf:g,iconAtlas:i,iconMapping:o,getPosition:function(t){return s(t.object)},getColor:this._getAccessor(u),getSize:this._getAccessor(c),getAngle:this._getAccessor(l),getAnchorX:this.getAnchorXFromTextAnchor(f),getAnchorY:this.getAnchorYFromAlignmentBaseline(h),getPixelOffset:this._getAccessor(d),fp64:p,sizeScale:v*r,transitions:y&&{getPosition:y.getPosition,getAngle:y.getAngle,getColor:y.getColor,getSize:y.getSize,getPixelOffset:m.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{getPosition:m.getPosition,getAngle:m.getAngle,getColor:m.getColor,getSize:m.getSize,getPixelOffset:m.getPixelOffset,getAnchorX:m.getTextAnchor,getAnchorY:m.getAlignmentBaseline}}),{data:n,getIcon:function(t){return t.text},getShiftInQueue:function(e){return t.getLetterOffset(e)},getLengthOfQueue:function(e){return t.getTextLength(e)}})}}])&&Zf(n.prototype,r),o&&Zf(n,o),e}(Qi);rh.layerName="TextLayer",rh.defaultProps=nh;var ih=n(23),oh=n.n(ih),ah=n(40),sh=n.n(ah);function uh(t,e){for(;t;){if(t===e)return!0;t=Object.getPrototypeOf(t)}return!1}function ch(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function lh(t){return t?"function"==typeof t?Object(ih.createElement)(Fn,{},t):Array.isArray(t)?t.map(lh):(uh(t.type,Fn),t):t}var fh=["constructor","render","componentWillMount","componentDidMount","componentWillReceiveProps","shouldComponentUpdate","componentWillUpdate","componentDidUpdate","componentWillUnmount"];function hh(t){return(hh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function dh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ph(t){return(ph=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function gh(t,e){return(gh=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function vh(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var yh=Wi.getPropTypes(sh.a),mh=Wi.defaultProps,bh=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=function(t,e){return!e||"object"!==hh(e)&&"function"!=typeof e?vh(t):e}(this,ph(e).call(this,t))).state={width:0,height:0,viewState:t.initialViewState},n.children=[],function(t){var e=Object.getPrototypeOf(t),n=Object.getOwnPropertyNames(e),r=!0,i=!1,o=void 0;try{for(var a,s=function(){var e=a.value;"function"==typeof t[e]&&(fh.find((function(t){return e===t}))||(t[e]=t[e].bind(t)))},u=n[Symbol.iterator]();!(r=(a=u.next()).done);r=!0)s()}catch(t){i=!0,o=t}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}}(vh(vh(n))),n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&gh(t,e)}(e,t),n=e,(r=[{key:"componentDidMount",value:function(){var t=this.props.Deck||Wi;this.deck=this.deck||new t(Object.assign({},this.props,{initialViewState:null,canvas:this.deckCanvas,viewState:this._getViewState(this.props),onViewStateChange:this._onViewStateChange,onResize:this._onResize}))}},{key:"componentWillUnmount",value:function(){this.deck.finalize()}},{key:"pickObject",value:function(t){var e=t.x,n=t.y,r=t.radius,i=void 0===r?0:r,o=t.layerIds,a=void 0===o?null:o;return this.deck.pickObject({x:e,y:n,radius:i,layerIds:a})}},{key:"pickMultipleObjects",value:function(t){var e=t.x,n=t.y,r=t.radius,i=void 0===r?0:r,o=t.layerIds,a=void 0===o?null:o,s=t.depth,u=void 0===s?10:s;return this.deck.pickMultipleObjects({x:e,y:n,radius:i,layerIds:a,depth:u})}},{key:"pickObjects",value:function(t){var e=t.x,n=t.y,r=t.width,i=void 0===r?1:r,o=t.height,a=void 0===o?1:o,s=t.layerIds,u=void 0===s?null:s;return this.deck.pickObjects({x:e,y:n,width:i,height:a,layerIds:u})}},{key:"queryObject",value:function(t){i.removed("queryObject","pickObject")()}},{key:"queryVisibleObjects",value:function(t){i.removed("queryVisibleObjects","pickObjects")()}},{key:"_onResize",value:function(t){this.setState(t),this.props.onResize(t)}},{key:"_onViewStateChange",value:function(t){var e,n,r,i=this.props.onViewStateChange(t)||t.viewState;this.state.viewState&&this.setState({viewState:Object.assign({},this.state.viewState,(e={},n=t.viewId,r=i,n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e))})}},{key:"_updateFromProps",value:function(t){if(this.deck){(t.viewports||t.viewport)&&i.removed("DeckGL.viewport(s)","DeckGL.views")();var e=function(t){var e=t.children,n=t.layers,r=t.views,i=[],o=[],a={};return oh.a.Children.forEach(lh(e),(function(t){if(t){var e=t.type;if(uh(e,qe)){var n=function(t,e){var n={},r=t.defaultProps||{};for(var i in e)r[i]!==e[i]&&(n[i]=e[i]);return new t(n)}(e,t.props);o.push(n)}else i.push(t);if(e!==Fn&&uh(e,Fn)&&t.props.id){var r=new e(t.props);a[r.id]=r}}})),Object.keys(a).length>0&&(Array.isArray(r)?r.forEach((function(t){a[t.id]=t})):r&&(a[r.id]=r),r=Object.values(a)),{layers:n=o.length>0?[].concat(o,ch(n)):n,children:i,views:r}}(t),n=e.layers,r=e.views,o=e.children,a=Object.assign({},t,{onViewStateChange:this._onViewStateChange,onResize:this._onResize,layers:n,views:r}),s=this._getViewState(t);s&&(a.viewState=s),this.deck.setProps(a),this.children=o}}},{key:"_getViewState",value:function(t){if(!t.viewState&&"latitude"in t&&"longitude"in t&&"zoom"in t){("maxZoom"in t||"minZoom"in t)&&i.removed("maxZoom/minZoom","viewState");var e=t.latitude,n=t.longitude,r=t.zoom,o=t.pitch,a=void 0===o?0:o,s=t.bearing;return{latitude:e,longitude:n,zoom:r,pitch:a,bearing:void 0===s?0:s}}return t.viewState||this.state.viewState}},{key:"_positionChildrenUnderViews",value:function(t){var e=(this.deck||{}).viewManager;if(!e||!e.views.length)return[];var n=e.views[0].id;return t.map((function(t,r){t.props.viewportId&&i.removed("viewportId","<View>")(),t.props.viewId&&i.removed("viewId","<View>")();var o=n,a=t;uh(t.type,Fn)&&(o=t.props.id||n,a=t.props.children);var s=e.getViewport(o),u=e.getViewState(o);if(!s)return null;var c=s.x,l=s.y,f=s.width,h=s.height;a=function t(e,n){return e?"function"==typeof e?e(n):Array.isArray(e)?e.map((function(e){return t(e,n)})):Object(ih.cloneElement)(e,n):e}(a,{x:c,y:l,width:f,height:h,viewport:s,viewState:u});var d={position:"absolute",left:c,top:l,width:f,height:h},p="view-child-".concat(o,"-").concat(r);return Object(ih.createElement)("div",{key:p,id:p,style:d},a)}))}},{key:"render",value:function(){var t=this;this._updateFromProps(this.props);var e=this._positionChildrenUnderViews(this.children),n=Object.assign({},{position:"absolute",left:0,top:0},this.props.style),r=Object(ih.createElement)("canvas",{ref:function(e){return t.deckCanvas=e},key:"deck-canvas",id:this.props.id,style:n});return e.push(r),Object(ih.createElement)("div",{id:"deckgl-wrapper"},e)}}])&&dh(n.prototype,r),o&&dh(n,o),e}(oh.a.PureComponent);bh.propTypes=yh,bh.defaultProps=mh;var _h={},xh=zs.BinSorter,wh=zs.linearScale,Eh=zs.getLinearScale,Sh=zs.quantizeScale,Oh=zs.getQuantizeScale,Ph=zs.defaultColorRange,Ch=zs.flattenVertices,Mh=zs.fillArray;Object.assign(_h,{BinSorter:xh,linearScale:wh,getLinearScale:Eh,quantizeScale:Sh,getQuantizeScale:Oh,defaultColorRange:Ph,flattenVertices:Ch,fillArray:Mh})},function(t,e,n){"use strict";(function(t,r){n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return s}));var i=n(22),o={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:void 0!==t&&t,document:"undefined"!=typeof document&&document,process:"object"===(void 0===r?"undefined":Object(i.a)(r))&&r},a=o.window||o.self||o.global,s=o.process||{};console}).call(this,n(50),n(61))},function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return a}));var r=n(14);function i(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t}function o(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function a(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*a,t[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*a,t[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*a,t[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*a,t}var s,u;s=new r.a(4),r.a!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0,s[3]=0),u=s},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(57),i=n(43);function o(){if(!r.b){var t=i.a.hrtime();return t[0]+t[1]/1e6}return i.b.performance?i.b.performance.now():Date.now()}o()},function(t,e,n){var r=n(16),i=r.getCoord,o=r.getCoords;function a(t,e,n){var r=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var i=0,o=e.length-1;i<e.length;o=i++){var a=e[i][0],s=e[i][1],u=e[o][0],c=e[o][1];if(t[1]*(a-u)+s*(u-t[0])+c*(t[0]-a)==0&&(a-t[0])*(u-t[0])<=0&&(s-t[1])*(c-t[1])<=0)return!n;s>t[1]!=c>t[1]&&t[0]<(u-a)*(t[1]-s)/(c-s)+a&&(r=!r)}return r}t.exports=function(t,e,n){if(!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");var r=i(t),s=o(e),u=e.geometry?e.geometry.type:e.type,c=e.bbox;if(c&&!1===function(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}(r,c))return!1;"Polygon"===u&&(s=[s]);for(var l=0,f=!1;l<s.length&&!f;l++)if(a(r,s[l][0],n)){for(var h=!1,d=1;d<s[l].length&&!h;)a(r,s[l][d],!n)&&(h=!0),d++;h||(f=!0)}return f}},function(t,e,n){"use strict";n.d(e,"a",(function(){return _}));var r,i=n(1),o=n(9),a=n(8),s=n(2),u=n(10),c=n(0),l=n(26),f=n(19),h=n(24),d=n(6),p=n(4),g=n(3),v=[9729,9728],y=(r={},Object(c.a)(r,6407,{dataFormat:6407,types:[5121,33635]}),Object(c.a)(r,6408,{dataFormat:6408,types:[5121,32819,32820]}),Object(c.a)(r,6406,{dataFormat:6406,types:[5121]}),Object(c.a)(r,6409,{dataFormat:6409,types:[5121]}),Object(c.a)(r,6410,{dataFormat:6410,types:[5121]}),Object(c.a)(r,33326,{dataFormat:6403,types:[5126],gl2:!0}),Object(c.a)(r,33328,{dataFormat:33319,types:[5126],gl2:!0}),Object(c.a)(r,34837,{dataFormat:6407,types:[5126],gl2:!0}),Object(c.a)(r,34836,{dataFormat:6408,types:[5126],gl2:!0}),r);function m(t,e){var n=y[e];if(!n)return!1;if(void 0===n.gl1&&void 0===n.gl2)return!0;var r=Object(d.n)(t)&&n.gl2||n.gl1;return"string"==typeof r?t.getExtension(r):r}function b(t,e){var n=y[e];switch(n&&n.types[0]){case 5126:return t.getExtension("OES_texture_float_linear");case 5131:return t.getExtension("OES_texture_half_float_linear");default:return!0}}var _=function(t){function e(t,n){var r;Object(i.a)(this,e);var s=n.id,u=void 0===s?Object(p.i)("texture"):s,c=n.handle,l=n.target;return(r=Object(o.a)(this,Object(a.a)(e).call(this,t,{id:u,handle:c}))).target=l,r.hasFloatTexture=t.getExtension("OES_texture_float"),r.textureUnit=void 0,r}return Object(u.a)(e,t),Object(s.a)(e,null,[{key:"isSupported",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.format,r=e.linearFiltering,i=!0;return n&&(i=(i=i&&m(t,n))&&(!r||b(t,n))),i}}]),Object(s.a)(e,[{key:"toString",value:function(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}},{key:"initialize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.data,n=t.pixels,r=void 0===n?null:n,i=t.format,o=void 0===i?6408:i,a=t.type,s=void 0===a?5121:a,u=t.border,l=void 0===u?0:u,f=t.recreate,h=void 0!==f&&f,d=t.parameters,g=void 0===d?{}:d,v=t.pixelStore,y=void 0===v?{}:v,m=t.textureUnit,b=void 0===m?void 0:m,_=t.unpackFlipY,x=void 0===_||_,w=t.mipmaps,E=void 0===w||w;e||(e=r);var S=t.width,O=t.height,P=t.dataFormat,C=this._deduceParameters({format:o,type:s,dataFormat:P,compressed:!1,data:e,width:S,height:O});S=C.width,O=C.height,P=C.dataFormat,this.width=S,this.height=O,this.format=o,this.type=s,this.dataFormat=P,this.border=l,this.textureUnit=b,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle));var M=Object(c.a)({},37440,x),I=Object.assign({},M,y);this._isNPOT()&&E&&(p.g.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),E=!1,this._updateForNPOT(g)),this.mipmaps=E,this.setImageData({data:e,width:S,height:O,format:o,type:s,dataFormat:P,border:l,mipmaps:E,parameters:I}),E&&this.generateMipmap(),this.setParameters(g),h&&(this.data=e)}},{key:"resize",value:function(t){var e=t.width,n=t.height;return e!==this.width||n!==this.height?this.initialize({width:e,height:n,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:!1}):this}},{key:"generateMipmap",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.gl.bindTexture(this.target,this.handle),Object(h.g)(this.gl,e,(function(){t.gl.generateMipmap(t.target)})),this.gl.bindTexture(this.target,null),this}},{key:"setImageData",value:function(t){var e=t.target,n=void 0===e?this.target:e,r=t.pixels,i=void 0===r?null:r,o=t.data,a=void 0===o?null:o,s=t.width,u=void 0===s?this.width:s,c=t.height,l=void 0===c?this.height:c,f=t.level,p=void 0===f?0:f,v=t.format,y=void 0===v?this.format:v,m=t.type,b=void 0===m?this.type:m,_=t.dataFormat,x=void 0===_?this.dataFormat:_,w=t.offset,E=void 0===w?0:w,S=t.border,O=void 0===S?this.border:S,P=t.compressed,C=void 0!==P&&P,M=t.parameters,I=void 0===M?{}:M;a||(a=i);var A=this._deduceParameters({format:y,type:b,dataFormat:x,compressed:C,data:a,width:u,height:l});b=A.type,x=A.dataFormat,C=A.compressed,u=A.width,l=A.height;var T=this.gl;T.bindTexture(this.target,this.handle);var N,L=this._getDataType({data:a,compressed:C});a=L.data,N=L.dataType,Object(h.g)(this.gl,I,(function(){switch(N){case"null":T.texImage2D(n,p,y,u,l,O,x,b,a);break;case"typed-array":T.texImage2D(n,p,y,u,l,O,x,b,a,E);break;case"buffer":Object(d.d)(T),T.bindBuffer(35052,a.handle||a),T.texImage2D(n,p,y,u,l,O,x,b,E),T.bindBuffer(35052,null);break;case"browser-object":Object(d.n)(T)?T.texImage2D(n,p,y,u,l,O,x,b,a):T.texImage2D(n,p,y,x,b,a);break;case"compressed":T.compressedTexImage2D(n,p,y,u,l,O,a);break;default:Object(g.a)(!1,"Unknown image data type")}}))}},{key:"setSubImageData",value:function(t){var e=this,n=t.target,r=void 0===n?this.target:n,i=t.pixels,o=void 0===i?null:i,a=t.data,s=void 0===a?null:a,u=t.x,c=void 0===u?0:u,l=t.y,p=void 0===l?0:l,g=t.width,v=void 0===g?this.width:g,y=t.height,m=void 0===y?this.height:y,b=t.level,_=void 0===b?0:b,x=t.format,w=void 0===x?this.format:x,E=t.type,S=void 0===E?this.type:E,O=t.dataFormat,P=void 0===O?this.dataFormat:O,C=t.compressed,M=void 0!==C&&C,I=t.offset,A=void 0===I?0:I,T=t.border,N=(void 0===T&&this.border,t.parameters),L=void 0===N?{}:N,R=this._deduceParameters({format:w,type:S,dataFormat:P,compressed:M,data:s,width:v,height:m});if(S=R.type,P=R.dataFormat,M=R.compressed,v=R.width,m=R.height,s||(s=o),s&&s.data){var k=s;s=k.data,v=k.shape[0],m=k.shape[1]}s instanceof f.a&&(s=s.handle),this.gl.bindTexture(this.target,this.handle),Object(h.g)(this.gl,L,(function(){M?e.gl.compressedTexSubImage2D(r,_,c,p,v,m,w,s):null===s?e.gl.texSubImage2D(r,_,c,p,v,m,P,S,null):ArrayBuffer.isView(s)?e.gl.texSubImage2D(r,_,c,p,v,m,P,S,s,A):s instanceof d.b?(Object(d.d)(e.gl),e.gl.bindBuffer(35052,s),e.gl.texSubImage2D(r,_,c,p,v,m,P,S,A),e.gl.bindBuffer(35052,null)):Object(d.n)(e.gl)?e.gl.texSubImage2D(r,_,c,p,v,m,P,S,s):e.gl.texSubImage2D(r,_,c,p,P,S,s)})),this.gl.bindTexture(this.target,null)}},{key:"copyFramebuffer",value:function(t){var e=t.target,n=(void 0===e&&this.target,t.framebuffer),r=t.x,i=void 0===r?0:r,o=t.y,a=void 0===o?0:o,s=t.width,u=t.height,c=t.level,l=void 0===c?0:c,f=t.internalFormat,h=void 0===f?6408:f,d=t.border,p=void 0===d?0:d;n&&n.bind(),this.bind(0),this.gl.copyTexImage2D(this.target,l,h,i,a,s,u,p),this.unbind(),n&&n.unbind()}},{key:"getActiveUnit",value:function(){return this.gl.getParameter(34016)-33984}},{key:"bind",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.textureUnit;if(void 0===t)throw new Error("Texture.bind: must specify texture unit");return this.textureUnit=t,this.gl.activeTexture(33984+t),this.gl.bindTexture(this.target,this.handle),t}},{key:"unbind",value:function(){if(void 0===this.textureUnit)throw new Error("Texture.unbind: texture unit not specified");return this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,null),this.textureUnit}},{key:"_getDataType",value:function(t){var e=t.data,n=t.compressed;return void 0!==n&&n?{data:e,dataType:"compressed"}:null===e?{data:e,dataType:"null"}:ArrayBuffer.isView(e)?{data:e,dataType:"typed-array"}:e instanceof f.a?{data:e.handle,dataType:"buffer"}:e instanceof d.b?{data:e,dataType:"buffer"}:{data:e,dataType:"browser-object"}}},{key:"setImage3D",value:function(t){var e=t.level,n=void 0===e?0:e,r=t.internalformat,i=void 0===r?6408:r,o=t.width,a=t.height,s=t.depth,u=void 0===s?1:s,c=t.border,l=void 0===c?0:c,h=t.format,d=t.type,p=void 0===d?5121:d,g=t.offset,v=void 0===g?0:g,y=t.pixels;return ArrayBuffer.isView(y)?(this.gl.texImage3D(this.target,n,i,o,a,u,l,h,p,y),this):(y instanceof f.a&&(this.gl.bindBuffer(35052,y.handle),this.gl.texImage3D(this.target,n,i,o,a,u,l,h,p,v)),this)}},{key:"_deduceParameters",value:function(t){var e=t.format,n=t.data,r=t.width,i=t.height,o=t.dataFormat,a=t.type,s=t.compressed,u=y[e];o=o||u&&u.dataFormat,a=a||u&&u.types[0],s=s||u&&u.compressed;var c=this._deduceImageSize(n,r,i);return{dataFormat:o,type:a,compressed:s,width:r=c.width,height:i=c.height,format:e,data:n}}},{key:"_deduceImageSize",value:function(t,e,n){var r;return r="undefined"!=typeof ImageData&&t instanceof ImageData?{width:t.width,height:t.height}:"undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement?{width:t.naturalWidth,height:t.naturalHeight}:"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement?{width:t.width,height:t.height}:"undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement?{width:t.videoWidth,height:t.videoHeight}:t?{width:e,height:n}:{width:e>=0?e:1,height:n>=0?n:1},Object(g.a)(r,"Could not deduced texture size"),Object(g.a)(void 0===e||r.width===e,"Deduced texture width does not match supplied width"),Object(g.a)(void 0===n||r.height===n,"Deduced texture height does not match supplied height"),r}},{key:"_createHandle",value:function(){return this.gl.createTexture()}},{key:"_deleteHandle",value:function(){this.gl.deleteTexture(this.handle)}},{key:"_getParameter",value:function(t){switch(t){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);var e=this.gl.getTexParameter(this.target,t);return this.gl.bindTexture(this.target,null),e}}},{key:"_setParameter",value:function(t,e){switch(this.gl.bindTexture(this.target,this.handle),e=this._getNPOTParam(t,e),t){case 33082:case 33083:this.gl.texParameterf(this.handle,t,e);break;case 4096:case 4097:Object(g.a)(!1);break;default:this.gl.texParameteri(this.target,t,e)}return this.gl.bindTexture(this.target,null),this}},{key:"_isNPOT",value:function(){return!(Object(d.n)(this.gl)||Object(p.f)(this.width)&&Object(p.f)(this.height))}},{key:"_updateForNPOT",value:function(t){void 0===t[this.gl.TEXTURE_MIN_FILTER]&&(t[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),void 0===t[this.gl.TEXTURE_WRAP_S]&&(t[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),void 0===t[this.gl.TEXTURE_WRAP_T]&&(t[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}},{key:"_getNPOTParam",value:function(t,e){if(this._isNPOT())switch(t){case 10241:-1===v.indexOf(e)&&(e=9729);break;case 10242:case 10243:33071!==e&&(e=33071)}return e}}]),e}(l.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n(138),i=n(1),o=n(2),a=n(41),s=n(36),u=n(3),c={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},l=function(){function t(){var e=this;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];r.forEach((function(t){return e._assign(t)})),Object.freeze(this)}return Object(o.a)(t,null,[{key:"getBytesPerElement",value:function(t){return Object(a.c)(t.type||5126).BYTES_PER_ELEMENT}},{key:"getBytesPerVertex",value:function(t){return Object(u.a)(t.size),Object(a.c)(t.type||5126).BYTES_PER_ELEMENT*t.size}},{key:"resolve",value:function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return Object(r.a)(t,[c].concat(n))}}]),Object(o.a)(t,[{key:"toString",value:function(){return JSON.stringify(this)}},{key:"_assign",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return void 0!==t.type&&(this.type!==t.type&&s.a.warn("accessor type mismatch"),this.type=t.type,5124!==t.type&&5125!==t.type||(this.integer=!0)),void 0!==t.size&&(this.size!==t.size&&s.a.warn("accessor size mismatch"),this.size=t.size),void 0!==t.divisor&&(this.divisor=t.divisor),void 0!==t.offset&&(this.offset=t.offset),void 0!==t.stride&&(this.stride=t.stride),void 0!==t.normalized&&(this.normalized=t.normalized),void 0!==t.integer&&(this.integer=t.integer),void 0!==t.instanced&&(s.a.deprecated("Accessor.instanced","Accessor.divisor"),this.divisor=t.instanced?1:0),void 0!==t.isInstanced&&(s.a.deprecated("Accessor.isInstanced","Accessor.divisor"),this.divisor=t.isInstanced?1:0),void 0!==t.index&&(this.index=t.index?1:0),this}},{key:"BYTES_PER_ELEMENT",get:function(){return t.getBytesPerElement(this)}},{key:"BYTES_PER_VERTEX",get:function(){return t.getBytesPerVertex(this)}}]),t}()},function(t,e,n){"use strict";n.d(e,"c",(function(){return i})),n.d(e,"d",(function(){return o})),n.d(e,"b",(function(){return a})),n.d(e,"i",(function(){return s})),n.d(e,"e",(function(){return u})),n.d(e,"f",(function(){return c})),n.d(e,"g",(function(){return l})),n.d(e,"a",(function(){return f})),n.d(e,"h",(function(){return p}));var r=n(14);function i(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}function o(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function a(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[0],s=n[1],u=n[2];return t[0]=i*u-o*s,t[1]=o*a-r*u,t[2]=r*s-i*a,t}function s(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[3]*r+n[7]*i+n[11]*o+n[15];return a=a||1,t[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/a,t[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/a,t[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/a,t}function u(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function c(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function l(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function f(t,e){var n=t[0],r=t[1],i=t[2],o=e[0],a=e[1],s=e[2],u=Math.sqrt(n*n+r*r+i*i)*Math.sqrt(o*o+a*a+s*s),c=u&&function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}(t,e)/u;return Math.acos(Math.min(Math.max(c,-1),1))}var h,d,p=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t};h=new r.a(3),r.a!=Float32Array&&(h[0]=0,h[1]=0,h[2]=0),d=h},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=g(n(84)),i=g(n(31)),o=g(n(32)),a=g(n(33)),s=g(n(34)),u=g(n(35)),c=n(23),l=g(c),f=g(n(40)),h=n(5),d=g(n(42)),p=g(n(204));function g(t){return t&&t.__esModule?t:{default:t}}n(362),deck.log.priority=0,luma.log.priority=-1;var v=0,y=function(t){function e(t){(0,o.default)(this,e);var n=(0,s.default)(this,(e.__proto__||(0,i.default)(e)).call(this,t));if(n._onChangeViewport=function(t){},window.map=n._map=n.props.map||n.context&&n.context.map,!n._map)throw new Error("Map instance is required");var r=n.center=n._map.getCenter(),a=n._map.getSize();return n.state={viewPoint:{maxZoom:n._map.maxZoom||16,minZoom:n._map.minZoom||1,pitch:0,bearing:0},latitude:r.lat,longitude:r.lng,width:a.x,height:a.y,zoom:n._map.getZoom()},"trip"===t.type&&(n.state.tripTime=0),n.layerId=n.props.id||"gas-layer-gl-"+v++,n.layer=n.getLayerGL(n.props,n.state),n.timeoutId=null,n.deckGL=null,n.hasZoom=!1,n}return(0,u.default)(e,t),(0,a.default)(e,[{key:"getLayerGL",value:function(t){throw new Error("layer must implements getLayerGL method")}},{key:"_initialize",value:function(t){this.gl=t,(0,h.setParameters)(t,{depthTest:!0,depthFunc:t.LEQUAL})}},{key:"debounceFunc",value:function(t,e){this.timeoutId&&clearTimeout(this.timeoutId),this.timeoutId=setTimeout(t,e)}},{key:"_onMapClick",value:function(t){var e=t.layerPoint,n=e.x,r=e.y,i=this.deckGL.pickObject({x:n,y:r});return this.onLayerClick(i,[i],event)}},{key:"__onMapResizeAction",value:function(t){var e=t.newSize;this.fixContainerPos(),this.setState((function(t,n){return{width:e.x,height:e.y}})),this.timeoutId=null}},{key:"_onMapResize",value:function(t){var e=this.props.debounceTime,n=void 0===e?100:e;return n?this.debounceFunc(this.__onMapResizeAction.bind(this,t),n):this.__onMapResizeAction(t)}},{key:"_onMapMovestart",value:function(){0}},{key:"_onMapMove",value:function(t){if(this.hasZoom)return this.hasZoom=!1;var e=this.props.debounceTime,n=void 0===e?100:e;return n?this.debounceFunc(this.__onMapMoveendAction.bind(this,t),n):this.__onMapMoveendAction(t)}},{key:"fixContainerPos",value:function(){var t=this._map.getPanes().mapPane.style.transform.match(/^translate3d\((-?\d+\.?\d*?)px, (-?\d+\.?\d*?)px, (-?\d+\.?\d*?)px\)$/);if(t){var e=t[1],n=t[2],r=t[3];this.container.style.transform="translate3d("+-e+"px, "+-n+"px, "+-r+"px)",this.props.zIndex&&(this.container.style.zIndex=this.props.zIndex)}}},{key:"__onMapMoveendAction",value:function(t){var e=this._map.getCenter(),n={zoom:t.target._zoom,latitude:e.lat,longitude:e.lng};this.fixContainerPos(),this.setState((function(t,e){return n})),this.timeoutId=null}},{key:"_onMapMoveend",value:function(t){0}},{key:"__onMapZoomAnimateAction",value:function(t){var e=t.center,n={zoom:t.zoom,latitude:e.lat,longitude:e.lng};this.fixContainerPos(),this.setState((function(t,e){return n}))}},{key:"_onZoomAnim",value:function(t){return this.hasZoom=!0,this.__onMapZoomAnimateAction(t)}},{key:"_onZoomstart",value:function(t){0}},{key:"_onZoomend",value:function(t){0}},{key:"componentWillUnmount",value:function(){if(this.gl){var t=this.gl.getExtension("WEBGL_lose_context");t&&t.loseContext()}this._destroy(),p.default.unregister(this.layerId),this._removeMapEvent(),this.timeoutId&&clearTimeout(this.timeoutId),this.animateTimeoutId&&clearTimeout(this.animateTimeoutId),this._animationFrame&&window.cancelAnimationFrame(this._animationFrame)}},{key:"_removeMapEvent",value:function(){p.default.removeListener("clickobject",this.onClickObject,this),p.default.removeListener("hoverobject",this.onHoverObject,this),p.default.removeListener("mapresize",this._onMapResize,this),p.default.removeListener("mapmovestart",this._onMapMovestart,this),p.default.removeListener("mapmove",this._onMapMove,this),p.default.removeListener("mapmoveend",this._onMapMoveend,this),p.default.removeListener("mapzoomstart",this._onZoomstart,this),p.default.removeListener("mapzoomend",this._onZoomend,this),p.default.removeListener("mapzoomanim",this._onZoomAnim,this)}},{key:"_destroy",value:function(){var t=this._map.getPanes(),e=this.props.paneId,n=t[void 0===e?"overlayPane":e],r=this.getContainer();n&&n.removeChild(r)}},{key:"componentDidMount",value:function(){this.props.data&&(this.getContainer(),this.registerToLayerDB(),this._initMapEvent(),this._animate&&this._animate())}},{key:"_initMapEvent",value:function(){p.default.on("clickobject",this.onClickObject,this),p.default.on("hoverobject",this.onHoverObject,this),p.default.on("mapresize",this._onMapResize,this),p.default.on("mapmovestart",this._onMapMovestart,this),p.default.on("mapmove",this._onMapMove,this),p.default.on("mapmoveend",this._onMapMoveend,this),p.default.on("mapzoomstart",this._onZoomstart,this),p.default.on("mapzoomend",this._onZoomend,this),p.default.on("mapzoomanim",this._onZoomAnim,this)}},{key:"onClickObject",value:function(t,e){"function"==typeof this.props.onClickObject&&(t&&t.layerName===this.layerId?this.props.onClickObject(t,e):this.props.onClickObject(null,e))}},{key:"onHoverObject",value:function(t,e){"function"==typeof this.props.onHoverObject&&(t&&t.layerName===this.layerId?this.props.onHoverObject(t,e):this.props.onHoverObject(null,e))}},{key:"findObjectByXy",value:function(t,e){var n=this.deckGL.pickMultipleObjects({x:t,y:e,depth:10});return n&&n.length>0&&n.map((function(t){return t.object}))}},{key:"registerToLayerDB",value:function(){p.default.register(this.layerId,this)}},{key:"componentWillReceiveProps",value:function(t){t.redraw&&this.redraw(t)}},{key:"componentWillUpdate",value:function(t,e){e.redraw&&this.redraw(t)}},{key:"redraw",value:function(t){var e=this;this.container&&this.props.fadeAnimation&&(this.container.classList="fadeOut",setTimeout((function(){e.container.classList="fadeIn"}),500)),this.layer=this.getLayerGL(t,this.state)}},{key:"getContainer",value:function(){if(this.container)return this.container;var t=this._map.getPanes(),e=this.props.paneId,n=t[void 0===e?"overlayPane":e],r=t.mapPane;window.map.gasLayers?window.map.gasLayers.push(this.deckGL):window.map.gasLayers=[this.deckGL],this.container=this.deckGL.deckCanvas;var i=r.style.transform.match(/^translate3d\((-?\d+\.?\d*?)px, (-?\d+\.?\d*?)px, (-?\d+\.?\d*?)px\)$/);if(i){var o=i[1],a=i[2],s=i[3];return this.container.style.transform="translate3d("+-o+"px, "+-a+"px, "+-s+"px)",n.appendChild(this.container),this.container}}},{key:"render",value:function(){var t=this;this._map.getCenter();return l.default.createElement(d.default,(0,r.default)({id:this.layerId,style:(0,r.default)({},this.props.style),pickingRadius:3},this.state.viewPoint,this.props,{layers:Array.isArray(this.layer)&&this.layer||[this.layer],onViewportChange:this._onChangeViewport,ref:function(e){t.deckGL=e},zoom:this.state.zoom-1,width:this.state.width,height:this.state.height,latitude:this.state.latitude,longitude:this.state.longitude,onWebGLInitialized:this._initialize.bind(this)}))}}]),e}(c.Component);y.propTypes={data:f.default.object.isRequired,visible:f.default.bool,pickable:f.default.bool,opacity:f.default.number,onClickObject:f.default.func,onHoverObject:f.default.func,redraw:f.default.bool,debounceTime:f.default.number,paneId:f.default.string,autoHighlight:f.default.bool,highlightColor:f.default.arrayOf(f.default.number),coordinateSystem:f.default.number,coordinateOrigin:f.default.arrayOf(f.default.number),coordinateZoom:f.default.number},e.default=y},function(t,e,n){var r=n(145)("wks"),i=n(110),o=n(62).Symbol,a="function"==typeof o;(t.exports=function(t){return r[t]||(r[t]=a&&o[t]||(a?o:i)("Symbol."+t))}).store=r},function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var r=n(1),i=n(9),o=n(8),a=n(2),s=n(10),u=n(17),c=n(47),l=n(6),f=function(t){function e(t){var n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(r.a)(this,e),Object(l.e)(t),(n=Object(i.a)(this,Object(o.a)(e).call(this,t,Object.assign({},a,{target:3553})))).initialize(a),Object.seal(Object(u.a)(Object(u.a)(n))),n}return Object(s.a)(e,t),Object(a.a)(e,null,[{key:"isSupported",value:function(t,e){return c.a.isSupported(t,e)}}]),Object(a.a)(e,[{key:"bind",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.textureUnit,e=this.gl;if(void 0===t)throw new Error("Texture.bind: must specify texture unit");return this.textureUnit=t,e.activeTexture(33984+t),e.bindTexture(this.target,this.handle),t}},{key:"unbind",value:function(){var t=this.gl;if(void 0===this.textureUnit)throw new Error("Texture.unbind: texture unit not specified");return t.activeTexture(33984+this.textureUnit),t.bindTexture(this.target,null),this.textureUnit}},{key:"getActiveUnit",value:function(){return this.gl.getParameter(34016)-33984}}]),e}(c.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return l})),n.d(e,"f",(function(){return b})),n.d(e,"g",(function(){return _})),n.d(e,"c",(function(){return x})),n.d(e,"d",(function(){return w})),n.d(e,"e",(function(){return E})),n.d(e,"b",(function(){return S}));var r,i,o,a=n(20),s=n(0),u=n(6),c=n(3),l=(r={},Object(s.a)(r,3042,!1),Object(s.a)(r,32773,new Float32Array([0,0,0,0])),Object(s.a)(r,32777,32774),Object(s.a)(r,34877,32774),Object(s.a)(r,32969,1),Object(s.a)(r,32968,0),Object(s.a)(r,32971,1),Object(s.a)(r,32970,0),Object(s.a)(r,3106,new Float32Array([0,0,0,0])),Object(s.a)(r,3107,[!0,!0,!0,!0]),Object(s.a)(r,2884,!1),Object(s.a)(r,2885,1029),Object(s.a)(r,2929,!1),Object(s.a)(r,2931,1),Object(s.a)(r,2932,513),Object(s.a)(r,2928,new Float32Array([0,1])),Object(s.a)(r,2930,!0),Object(s.a)(r,3024,!0),Object(s.a)(r,36006,null),Object(s.a)(r,2886,2305),Object(s.a)(r,33170,4352),Object(s.a)(r,2849,1),Object(s.a)(r,32823,!1),Object(s.a)(r,32824,0),Object(s.a)(r,10752,0),Object(s.a)(r,32938,1),Object(s.a)(r,32939,!1),Object(s.a)(r,3089,!1),Object(s.a)(r,3088,new Int32Array([0,0,1024,1024])),Object(s.a)(r,2960,!1),Object(s.a)(r,2961,0),Object(s.a)(r,2968,4294967295),Object(s.a)(r,36005,4294967295),Object(s.a)(r,2962,519),Object(s.a)(r,2967,0),Object(s.a)(r,2963,4294967295),Object(s.a)(r,34816,519),Object(s.a)(r,36003,0),Object(s.a)(r,36004,4294967295),Object(s.a)(r,2964,7680),Object(s.a)(r,2965,7680),Object(s.a)(r,2966,7680),Object(s.a)(r,34817,7680),Object(s.a)(r,34818,7680),Object(s.a)(r,34819,7680),Object(s.a)(r,2978,new Int32Array([0,0,1024,1024])),Object(s.a)(r,3333,4),Object(s.a)(r,3317,4),Object(s.a)(r,37440,!1),Object(s.a)(r,37441,!1),Object(s.a)(r,37443,37444),Object(s.a)(r,35723,4352),Object(s.a)(r,36010,null),Object(s.a)(r,35977,!1),Object(s.a)(r,3330,0),Object(s.a)(r,3332,0),Object(s.a)(r,3331,0),Object(s.a)(r,3314,0),Object(s.a)(r,32878,0),Object(s.a)(r,3316,0),Object(s.a)(r,3315,0),Object(s.a)(r,32877,0),r),f=function(t,e,n){return e?t.enable(n):t.disable(n)},h=function(t,e,n){return t.hint(n,e)},d=function(t,e,n){return t.pixelStorei(n,e)},p=(i={},Object(s.a)(i,3042,f),Object(s.a)(i,32773,(function(t,e){return t.blendColor.apply(t,Object(a.a)(e))})),Object(s.a)(i,32777,"blendEquation"),Object(s.a)(i,34877,"blendEquation"),Object(s.a)(i,32969,"blendFunc"),Object(s.a)(i,32968,"blendFunc"),Object(s.a)(i,32971,"blendFunc"),Object(s.a)(i,32970,"blendFunc"),Object(s.a)(i,3106,(function(t,e){return t.clearColor.apply(t,Object(a.a)(e))})),Object(s.a)(i,3107,(function(t,e){return t.colorMask.apply(t,Object(a.a)(e))})),Object(s.a)(i,2884,f),Object(s.a)(i,2885,(function(t,e){return t.cullFace(e)})),Object(s.a)(i,2929,f),Object(s.a)(i,2931,(function(t,e){return t.clearDepth(e)})),Object(s.a)(i,2932,(function(t,e){return t.depthFunc(e)})),Object(s.a)(i,2928,(function(t,e){return t.depthRange.apply(t,Object(a.a)(e))})),Object(s.a)(i,2930,(function(t,e){return t.depthMask(e)})),Object(s.a)(i,3024,f),Object(s.a)(i,35723,h),Object(s.a)(i,36006,(function(t,e){var n=Object(u.n)(t)?36009:36160;return t.bindFramebuffer(n,e)})),Object(s.a)(i,2886,(function(t,e){return t.frontFace(e)})),Object(s.a)(i,33170,h),Object(s.a)(i,2849,(function(t,e){return t.lineWidth(e)})),Object(s.a)(i,32823,f),Object(s.a)(i,32824,"polygonOffset"),Object(s.a)(i,10752,"polygonOffset"),Object(s.a)(i,35977,f),Object(s.a)(i,32938,"sampleCoverage"),Object(s.a)(i,32939,"sampleCoverage"),Object(s.a)(i,3089,f),Object(s.a)(i,3088,(function(t,e){return t.scissor.apply(t,Object(a.a)(e))})),Object(s.a)(i,2960,f),Object(s.a)(i,2961,(function(t,e){return t.clearStencil(e)})),Object(s.a)(i,2968,(function(t,e){return t.stencilMaskSeparate(1028,e)})),Object(s.a)(i,36005,(function(t,e){return t.stencilMaskSeparate(1029,e)})),Object(s.a)(i,2962,"stencilFuncFront"),Object(s.a)(i,2967,"stencilFuncFront"),Object(s.a)(i,2963,"stencilFuncFront"),Object(s.a)(i,34816,"stencilFuncBack"),Object(s.a)(i,36003,"stencilFuncBack"),Object(s.a)(i,36004,"stencilFuncBack"),Object(s.a)(i,2964,"stencilOpFront"),Object(s.a)(i,2965,"stencilOpFront"),Object(s.a)(i,2966,"stencilOpFront"),Object(s.a)(i,34817,"stencilOpBack"),Object(s.a)(i,34818,"stencilOpBack"),Object(s.a)(i,34819,"stencilOpBack"),Object(s.a)(i,2978,(function(t,e){return t.viewport.apply(t,Object(a.a)(e))})),Object(s.a)(i,3333,d),Object(s.a)(i,3317,d),Object(s.a)(i,37440,d),Object(s.a)(i,37441,d),Object(s.a)(i,37443,d),Object(s.a)(i,3330,d),Object(s.a)(i,3332,d),Object(s.a)(i,3331,d),Object(s.a)(i,36010,(function(t,e){return t.bindFramebuffer(36008,e)})),Object(s.a)(i,3314,d),Object(s.a)(i,32878,d),Object(s.a)(i,3316,d),Object(s.a)(i,3315,d),Object(s.a)(i,32877,d),i),g={blendEquation:function(t,e){return t.blendEquationSeparate(e[32777],e[34877])},blendFunc:function(t,e){return t.blendFuncSeparate(e[32969],e[32968],e[32971],e[32970])},polygonOffset:function(t,e){return t.polygonOffset(e[32824],e[10752])},sampleCoverage:function(t,e){return t.sampleCoverage(e[32938],e[32939])},stencilFuncFront:function(t,e){return t.stencilFuncSeparate(1028,e[2962],e[2967],e[2963])},stencilFuncBack:function(t,e){return t.stencilFuncSeparate(1029,e[34816],e[36003],e[36004])},stencilOpFront:function(t,e){return t.stencilOpSeparate(1028,e[2964],e[2965],e[2966])},stencilOpBack:function(t,e){return t.stencilOpSeparate(1029,e[34817],e[34818],e[34819])}},v=function(t,e){return t.isEnabled(e)},y=(o={},Object(s.a)(o,3042,v),Object(s.a)(o,2884,v),Object(s.a)(o,2929,v),Object(s.a)(o,3024,v),Object(s.a)(o,32823,v),Object(s.a)(o,32926,v),Object(s.a)(o,32928,v),Object(s.a)(o,3089,v),Object(s.a)(o,2960,v),Object(s.a)(o,35977,v),o),m=function(t,e){if(t===e)return!0;var n=Array.isArray(t)||ArrayBuffer.isView(t),r=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&r&&t.length===e.length){for(var i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0}return!1};function b(t,e,n){var r=y[e],i=r?r(t,Number(e)):t.getParameter(Number(e)),o=p[e];return Object(c.a)("function"==typeof o),o(t,n,Number(e)),i}function _(t,e){var n={};for(var r in e){var i=Number(r),o=p[r];o&&("string"==typeof o?n[o]=!0:o(t,e[r],i))}var a=t.state&&t.state.cache;if(a){var s=Object.assign({},a,e);for(var u in n){(0,g[u])(t,s)}}}function x(t,e){var n=y[e];return n?n(t,Number(e)):t.getParameter(Number(e))}function w(t,e){e=e||l;var n=Array.isArray(e)?e:Object.keys(e),r={},i=!0,o=!1,a=void 0;try{for(var s,u=n[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value;r[c]=x(t,c)}}catch(t){o=!0,a=t}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}return r}function E(t){_(t,Object.assign({},l,{}))}function S(t){var e=w(l),n={};for(var r in l)m(e[r],l[r])||(n[r]=e[r]);return n}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=f(n(84)),i=f(n(363)),o=f(n(369)),a=f(n(156)),s=f(n(146));e.getScale=d,e.lineToPixels=p,e.polygonToPixels=g,e.pixelToPoint=y,e.getPolygonCoords=m,e.getKey=function(t){if("object"!==(void 0===t?"undefined":(0,s.default)(t)))return(0,c.default)(t);if(Array.isArray(t))return v(t);var e=[],n=!0,r=!1,i=void 0;try{for(var u,l=(0,a.default)((0,o.default)(t).sort());!(n=(u=l.next()).done);n=!0){var f=u.value;e.push(f+"_"+t[f])}}catch(t){r=!0,i=t}finally{try{!n&&l.return&&l.return()}finally{if(r)throw i}}return v(e)},e.getValueByKeys=function(t,e,n){return t.split(".").reduce((function(t,e){return t&&null!=t[e]?t[e]:n||null}),e)},e.pointToPixel=b,e.arcToPixel=_,e.meterToPixel=function(t,e,n,r){var i=r.latLngToContainerPoint([0,0]),o=(s=L.latLng([0,0]),u=t,c=s.toBounds(2*u),[(c._southWest.lat+c._northEast.lat)/2,c._northEast.lng]),a=function(t,e){var n=t.toBounds(2*e);return[n._southWest.lat,(n._southWest.lng+n._northEast.lng)/2]}(L.latLng([0,0]),e);var s,u,c;return t=Math.abs(r.latLngToContainerPoint(o).x-i.x),e=Math.abs(r.latLngToContainerPoint(a).y-i.y),{width:t<n?n:t,height:e<n?n:e}},e.meterPerPixel=function(t){return 40075016.686*Math.abs(Math.cos(180*t.getCenter().lat/Math.PI))/Math.pow(2,t.getZoom()+8)},e.arcPerPixel=function(t){var e=t.latLngToContainerPoint([0,0]);return t.latLngToContainerPoint([1,1]).x-e.x},e.isAnyRenderOptionsChange=x,e.between=w,e.distance=E,e.isPointOnLine=P,e.geoJsonToMarkerList=function(t){return t.features.map((function(t){if(t.geometry&&"point"===t.geometry.type.toLowerCase()){var e=(0,i.default)(t.geometry.coordinates,2),n=e[0],o=e[1],a=t.properties||{};return(0,r.default)({},a,{position:[o,n]})}return null})).filter((function(t){return null!==t}))};var u=f(n(157)),c=f(n(372));n(158);var l=n(16);function f(t){return t&&t.__esModule?t:{default:t}}function h(t,e){return L.point(t.x,t.y).add(e)}function d(t,e){if(null==e)throw new Error("scaleOpts cannot be empty");return u.default.isArray(e)?e:u.default.isObject(e)?function(t,e){var n=e.domain,r=e.range;if(!u.default.isArray(r)||0===r.length)throw new Error("range must be an not empty array");if(null==n||0===n.length)return r[0];if(!u.default.isArray(n))throw new Error("domain must be an array or void 0");var i=Math.min(n.length,r.length);if(isNaN(t))return r[0];for(var o=0,a=0;a<i-1&&n[a]<t;a++)o=a+1;return r[o]}(t,e):e}function p(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;try{for(var i=[],o=void 0,a=0,s=t.geometry.coordinates.length;a<s;a++){var u=t.geometry.coordinates[a],c=n.latLngToContainerPoint([u[1],u[0]]),l=c;o||e.contains([l.x,l.y])&&(o=!0),r&&(l=h(l,r));var f=i[i.length-1]||{};f.x===l.x&&f.y===l.y||i.push(l)}return 1===i.length&&i.push({x:i[0].x+.1,y:i[0].y+.1}),o?i:null}catch(t){return null}}function g(t,n,r){for(var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=[],a=void 0,s=0,u=t.geometry.coordinates.length;s<u;s++){var c=t.geometry.coordinates[s],l=e.lineToPixels({geometry:{coordinates:c}},n,r,i);if(l&&(l.forEach((function(t){o.push(t)})),!a))for(var f=0,h=l.length;f<h;++f)if(n.contains(l[f])){a=!0;break}}return 1===o.length&&o.push({x:o[0].x+.1,y:o[0].y+.1}),a?o:null}function v(t){return(0,c.default)(t.join("_"))}function y(t,e,n){return n.containerPointToLatLng(L.point(t,e))}function m(t){var e=(0,l.getCoords)(t).reduce((function(t,e){return t.concat(e)}));return e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]||e.push(e[0]),[e]}function b(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=t.geometry.coordinates,o=n.latLngToContainerPoint([i[1],i[0]]),a=o;return e.contains(a)?(r&&(a=h(o,r)),a):null}function _(t,e,n,r){var i=r.latLngToContainerPoint([0,0]);return{width:(t=Math.abs(r.latLngToContainerPoint([0,t]).x-i.x))<n?n:t,height:(e=Math.abs(r.latLngToContainerPoint([e,0]).y-i.y))<n?n:e}}function x(t,e,n){for(var r=0,i=n.length;r<i;r++){var o=n[r];if(t[o]&&!u.default.isEqual(t[o],e[o]))return!0}return!1}function w(t,e,n){if(e>n){var r=n;n=e,e=r}return e<=t&&t<=n}function E(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function S(t,e,n){return t+n*(e-t)}function O(t,e,n,r){var i=e.x-t.x,o=e.y-t.y,a=((n-t.x)*i+(r-t.y)*o)/(i*i+o*o);return{x:S(t.x,e.x,a),y:S(t.y,e.y,a)}}function P(t,e,n,r){for(var i=r/2,o={x:t,y:e},a=0,s=n.length;a<s-1;a++){var u=n[a],c=n[a+1];if(u.x!==c.x){if(u.y!==c.y){if(w(t,u.x,c.x))if(E(O(u,c,t,e),o)<=i)return!0}else if(w(e,u.y+i,u.y-i)&&w(t,u.x,c.x))return!0}else if(w(t,u.x+i,u.x-i)&&w(e,u.y,c.y))return!0}return!1}e.default={getScale:d,polygonToPixels:g,lineToPixels:p,pointToPixel:b,arcToPixel:_,isAnyRenderOptionsChange:x,isPointOnLine:P,distance:E,between:w,pixelToPoint:y,getPolygonCoords:m}},function(t,e,n){var r=n(278),i="object"==typeof self&&self&&self.Object===Object&&self,o=r||i||Function("return this")();t.exports=o},function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return o}));var r=n(135),i="2.1.0",o=Object(r.a)()},function(t,e,n){"use strict";(function(e){var r=n(347);
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function i(t,e){if(t===e)return 0;for(var n=t.length,r=e.length,i=0,o=Math.min(n,r);i<o;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0}function o(t){return e.Buffer&&"function"==typeof e.Buffer.isBuffer?e.Buffer.isBuffer(t):!(null==t||!t._isBuffer)}var a=n(348),s=Object.prototype.hasOwnProperty,u=Array.prototype.slice,c="foo"===function(){}.name;function l(t){return Object.prototype.toString.call(t)}function f(t){return!o(t)&&("function"==typeof e.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):!!t&&(t instanceof DataView||!!(t.buffer&&t.buffer instanceof ArrayBuffer))))}var h=t.exports=m,d=/\s*function\s+([^\(\s]*)\s*/;function p(t){if(a.isFunction(t)){if(c)return t.name;var e=t.toString().match(d);return e&&e[1]}}function g(t,e){return"string"==typeof t?t.length<e?t:t.slice(0,e):t}function v(t){if(c||!a.isFunction(t))return a.inspect(t);var e=p(t);return"[Function"+(e?": "+e:"")+"]"}function y(t,e,n,r,i){throw new h.AssertionError({message:n,actual:t,expected:e,operator:r,stackStartFunction:i})}function m(t,e){t||y(t,!0,e,"==",h.ok)}function b(t,e,n,r){if(t===e)return!0;if(o(t)&&o(e))return 0===i(t,e);if(a.isDate(t)&&a.isDate(e))return t.getTime()===e.getTime();if(a.isRegExp(t)&&a.isRegExp(e))return t.source===e.source&&t.global===e.global&&t.multiline===e.multiline&&t.lastIndex===e.lastIndex&&t.ignoreCase===e.ignoreCase;if(null!==t&&"object"==typeof t||null!==e&&"object"==typeof e){if(f(t)&&f(e)&&l(t)===l(e)&&!(t instanceof Float32Array||t instanceof Float64Array))return 0===i(new Uint8Array(t.buffer),new Uint8Array(e.buffer));if(o(t)!==o(e))return!1;var s=(r=r||{actual:[],expected:[]}).actual.indexOf(t);return-1!==s&&s===r.expected.indexOf(e)||(r.actual.push(t),r.expected.push(e),function(t,e,n,r){if(null==t||null==e)return!1;if(a.isPrimitive(t)||a.isPrimitive(e))return t===e;if(n&&Object.getPrototypeOf(t)!==Object.getPrototypeOf(e))return!1;var i=_(t),o=_(e);if(i&&!o||!i&&o)return!1;if(i)return t=u.call(t),e=u.call(e),b(t,e,n);var s,c,l=E(t),f=E(e);if(l.length!==f.length)return!1;for(l.sort(),f.sort(),c=l.length-1;c>=0;c--)if(l[c]!==f[c])return!1;for(c=l.length-1;c>=0;c--)if(s=l[c],!b(t[s],e[s],n,r))return!1;return!0}(t,e,n,r))}return n?t===e:t==e}function _(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function x(t,e){if(!t||!e)return!1;if("[object RegExp]"==Object.prototype.toString.call(e))return e.test(t);try{if(t instanceof e)return!0}catch(t){}return!Error.isPrototypeOf(e)&&!0===e.call({},t)}function w(t,e,n,r){var i;if("function"!=typeof e)throw new TypeError('"block" argument must be a function');"string"==typeof n&&(r=n,n=null),i=function(t){var e;try{t()}catch(t){e=t}return e}(e),r=(n&&n.name?" ("+n.name+").":".")+(r?" "+r:"."),t&&!i&&y(i,n,"Missing expected exception"+r);var o="string"==typeof r,s=!t&&i&&!n;if((!t&&a.isError(i)&&o&&x(i,n)||s)&&y(i,n,"Got unwanted exception"+r),t&&i&&n&&!x(i,n)||!t&&i)throw i}h.AssertionError=function(t){this.name="AssertionError",this.actual=t.actual,this.expected=t.expected,this.operator=t.operator,t.message?(this.message=t.message,this.generatedMessage=!1):(this.message=function(t){return g(v(t.actual),128)+" "+t.operator+" "+g(v(t.expected),128)}(this),this.generatedMessage=!0);var e=t.stackStartFunction||y;if(Error.captureStackTrace)Error.captureStackTrace(this,e);else{var n=new Error;if(n.stack){var r=n.stack,i=p(e),o=r.indexOf("\n"+i);if(o>=0){var a=r.indexOf("\n",o+1);r=r.substring(a+1)}this.stack=r}}},a.inherits(h.AssertionError,Error),h.fail=y,h.ok=m,h.equal=function(t,e,n){t!=e&&y(t,e,n,"==",h.equal)},h.notEqual=function(t,e,n){t==e&&y(t,e,n,"!=",h.notEqual)},h.deepEqual=function(t,e,n){b(t,e,!1)||y(t,e,n,"deepEqual",h.deepEqual)},h.deepStrictEqual=function(t,e,n){b(t,e,!0)||y(t,e,n,"deepStrictEqual",h.deepStrictEqual)},h.notDeepEqual=function(t,e,n){b(t,e,!1)&&y(t,e,n,"notDeepEqual",h.notDeepEqual)},h.notDeepStrictEqual=function t(e,n,r){b(e,n,!0)&&y(e,n,r,"notDeepStrictEqual",t)},h.strictEqual=function(t,e,n){t!==e&&y(t,e,n,"===",h.strictEqual)},h.notStrictEqual=function(t,e,n){t===e&&y(t,e,n,"!==",h.notStrictEqual)},h.throws=function(t,e,n){w(!0,t,e,n)},h.doesNotThrow=function(t,e,n){w(!1,t,e,n)},h.ifError=function(t){if(t)throw t},h.strict=r((function t(e,n){e||y(e,!0,n,"==",t)}),h,{equal:h.strictEqual,deepEqual:h.deepStrictEqual,notEqual:h.notStrictEqual,notDeepEqual:h.notDeepStrictEqual}),h.strict.strict=h.strict;var E=Object.keys||function(t){var e=[];for(var n in t)s.call(t,n)&&e.push(n);return e}}).call(this,n(50))},function(t,e,n){"use strict";function r(t){return t<10?"".concat(t.toFixed(2),"ms"):t<100?"".concat(t.toFixed(1),"ms"):t<1e3?"".concat(t.toFixed(0),"ms"):"".concat((t/1e3).toFixed(2),"s")}function i(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function o(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:600,i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));var o=t.width*n,a=t.height*n,s=["font-size:1px;","padding:".concat(Math.floor(a/2),"px ").concat(Math.floor(o/2),"px;"),"line-height:".concat(a,"px;"),"background:url(".concat(i,");"),"background-size:".concat(o,"px ").concat(a,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),s]}n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return o}))},function(t,e,n){var r=n(62),i=n(38),o=n(141),a=n(78),s=n(70),u=function(t,e,n){var c,l,f,h=t&u.F,d=t&u.G,p=t&u.S,g=t&u.P,v=t&u.B,y=t&u.W,m=d?i:i[e]||(i[e]={}),b=m.prototype,_=d?r:p?r[e]:(r[e]||{}).prototype;for(c in d&&(n=e),n)(l=!h&&_&&void 0!==_[c])&&s(m,c)||(f=l?_[c]:n[c],m[c]=d&&"function"!=typeof _[c]?n[c]:v&&l?o(f,r):y&&_[c]==f?function(t){var e=function(e,n,r){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,n)}return new t(e,n,r)}return t.apply(this,arguments)};return e.prototype=t.prototype,e}(f):g&&"function"==typeof f?o(Function.call,f):f,g&&((m.virtual||(m.virtual={}))[c]=f,t&u.R&&b&&!b[c]&&a(b,c,f)))};u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,t.exports=u},function(t,e){var n,r,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(t){r=a}}();var u,c=[],l=!1,f=-1;function h(){l&&u&&(l=!1,u.length?c=u.concat(c):f=-1,c.length&&d())}function d(){if(!l){var t=s(h);l=!0;for(var e=c.length;e;){for(u=c,c=[];++f<e;)u&&u[f].run();f=-1,e=c.length}u=null,l=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function g(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new p(t,e)),1!==c.length||l||s(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.prependListener=g,i.prependOnceListener=g,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(t,e,n){var r=n(69),i=n(191),o=n(142),a=Object.defineProperty;e.f=n(64)?Object.defineProperty:function(t,e,n){if(r(t),e=o(e,!0),r(n),i)try{return a(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){t.exports=!n(80)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(t,e,n){"use strict";n.d(e,"c",(function(){return o})),n.d(e,"d",(function(){return a})),n.d(e,"b",(function(){return s})),n.d(e,"a",(function(){return u}));var r=n(28),i=n(3);function o(t){return Boolean(t&&(t instanceof r.c||34962===t.ARRAY_BUFFER))}function a(t){return Boolean(t&&(t instanceof r.a||32874===t.TEXTURE_BINDING_3D))}function s(t){Object(i.a)(o(t),"Invalid WebGLRenderingContext")}function u(t){Object(i.a)(a(t),"Requires WebGL2")}},function(t,e,n){var r=n(16).getCoord,i=n(11),o=i.point,a=i.distanceToRadians;t.exports=function(t,e,n,i){var s=Math.PI/180,u=180/Math.PI,c=r(t),l=s*c[0],f=s*c[1],h=s*n,d=a(e,i),p=Math.asin(Math.sin(f)*Math.cos(d)+Math.cos(f)*Math.sin(d)*Math.cos(h)),g=l+Math.atan2(Math.sin(h)*Math.sin(d)*Math.cos(f),Math.cos(d)-Math.sin(f)*Math.sin(p));return o([u*g,u*p])}},function(t,e,n){"use strict";(function(t){var r=n(22),i=n(293),o=!("object"===(void 0===t?"undefined":Object(r.a)(t))&&"[object process]"===String(t)&&!t.browser)||i.a;e.a=o}).call(this,n(61))},function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return d})),n.d(e,"c",(function(){return p})),n.d(e,"b",(function(){return g}));var r=n(1),i=n(2),o=n(0),a=n(54),s=n(3),u=function(t,e){var n=Array.isArray(t)||ArrayBuffer.isView(t),r=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&r&&t.length===e.length){for(var i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0}return t===e},c={enable:function(t,e){return t(Object(o.a)({},e,!0))},disable:function(t,e){return t(Object(o.a)({},e,!1))},pixelStorei:function(t,e,n){return t(Object(o.a)({},e,n))},hint:function(t,e,n){return t(Object(o.a)({},e,n))},bindFramebuffer:function(t,e,n){var r;switch(e){case 36160:return t((r={},Object(o.a)(r,36006,n),Object(o.a)(r,36010,n),r));case 36009:return t(Object(o.a)({},36006,n));case 36008:return t(Object(o.a)({},36010,n));default:return null}},blendColor:function(t,e,n,r,i){return t(Object(o.a)({},32773,new Float32Array([e,n,r,i])))},blendEquation:function(t,e){var n;return t((n={},Object(o.a)(n,32777,e),Object(o.a)(n,34877,e),n))},blendEquationSeparate:function(t,e,n){var r;return t((r={},Object(o.a)(r,32777,e),Object(o.a)(r,34877,n),r))},blendFunc:function(t,e,n){var r;return t((r={},Object(o.a)(r,32969,e),Object(o.a)(r,32968,n),Object(o.a)(r,32971,e),Object(o.a)(r,32970,n),r))},blendFuncSeparate:function(t,e,n,r,i){var a;return t((a={},Object(o.a)(a,32969,e),Object(o.a)(a,32968,n),Object(o.a)(a,32971,r),Object(o.a)(a,32970,i),a))},clearColor:function(t,e,n,r,i){return t(Object(o.a)({},3106,new Float32Array([e,n,r,i])))},clearDepth:function(t,e){return t(Object(o.a)({},2931,e))},clearStencil:function(t,e){return t(Object(o.a)({},2961,e))},colorMask:function(t,e,n,r,i){return t(Object(o.a)({},3107,[e,n,r,i]))},cullFace:function(t,e){return t(Object(o.a)({},2885,e))},depthFunc:function(t,e){return t(Object(o.a)({},2932,e))},depthRange:function(t,e,n){return t(Object(o.a)({},2928,new Float32Array([e,n])))},depthMask:function(t,e){return t(Object(o.a)({},2930,e))},frontFace:function(t,e){return t(Object(o.a)({},2886,e))},lineWidth:function(t,e){return t(Object(o.a)({},2849,e))},polygonOffset:function(t,e,n){var r;return t((r={},Object(o.a)(r,32824,e),Object(o.a)(r,10752,n),r))},sampleCoverage:function(t,e,n){var r;return t((r={},Object(o.a)(r,32938,e),Object(o.a)(r,32939,n),r))},scissor:function(t,e,n,r,i){return t(Object(o.a)({},3088,new Int32Array([e,n,r,i])))},stencilMask:function(t,e){var n;return t((n={},Object(o.a)(n,2968,e),Object(o.a)(n,36005,e),n))},stencilMaskSeparate:function(t,e,n){return t(Object(o.a)({},1028===e?2968:36005,n))},stencilFunc:function(t,e,n,r){var i;return t((i={},Object(o.a)(i,2962,e),Object(o.a)(i,2967,n),Object(o.a)(i,2963,r),Object(o.a)(i,34816,e),Object(o.a)(i,36003,n),Object(o.a)(i,36004,r),i))},stencilFuncSeparate:function(t,e,n,r,i){var a;return t((a={},Object(o.a)(a,1028===e?2962:34816,n),Object(o.a)(a,1028===e?2967:36003,r),Object(o.a)(a,1028===e?2963:36004,i),a))},stencilOp:function(t,e,n,r){var i;return t((i={},Object(o.a)(i,2964,e),Object(o.a)(i,2965,n),Object(o.a)(i,2966,r),Object(o.a)(i,34817,e),Object(o.a)(i,34818,n),Object(o.a)(i,34819,r),i))},stencilOpSeparate:function(t,e,n,r,i){var a;return t((a={},Object(o.a)(a,1028===e?2964:34817,n),Object(o.a)(a,1028===e?2965:34818,r),Object(o.a)(a,1028===e?2966:34819,i),a))},viewport:function(t,e,n,r,i){return t(Object(o.a)({},2978,new Int32Array([e,n,r,i])))}};function l(t,e){var n=t[e].bind(t);t[e]=function(){var e=arguments.length<=0?void 0:arguments[0];return e in t.state.cache||(t.state.cache[e]=n.apply(void 0,arguments)),t.state.enable?t.state.cache[e]:n.apply(void 0,arguments)},Object.defineProperty(t[e],"name",{value:"".concat(e,"-from-cache"),configurable:!1})}function f(t,e,n){var r=t[e].bind(t);t[e]=function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];var s,u=n.apply(void 0,[t.state._updateCache].concat(o)),c=u.valueChanged,l=u.oldValue;c&&((s=t.state).log.apply(s,["gl.".concat(e)].concat(o)),r.apply(void 0,o));return l},Object.defineProperty(t[e],"name",{value:"".concat(e,"-to-cache"),configurable:!1})}var h=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.copyState,o=void 0!==i&&i,s=n.log,u=void 0===s?function(){}:s;Object(r.a)(this,t),this.gl=e,this.stateStack=[],this.enable=!0,this.cache=o?Object(a.d)(e):Object.assign({},a.a),this.log=u,this._updateCache=this._updateCache.bind(this),Object.seal(this)}return Object(i.a)(t,[{key:"push",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.stateStack.push({})}},{key:"pop",value:function(){Object(s.a)(this.stateStack.length>0);var t=this.stateStack[this.stateStack.length-1];Object(a.g)(this.gl,t,this.cache),this.stateStack.pop()}},{key:"_updateCache",value:function(t){var e,n=!1,r=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(var i in t)Object(s.a)(void 0!==i),u(t[i],this.cache[i])||(n=!0,e=this.cache[i],r&&!(i in r)&&(r[i]=this.cache[i]),this.cache[i]=t[i]);return{valueChanged:n,oldValue:e}}}]),t}();function d(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.enable,i=void 0===r||r,o=n.copyState;if(Object(s.a)(void 0!==o),!e.state){var a=void 0!==t?t:window;for(var u in a.polyfillContext&&a.polyfillContext(e),e.state=new h(e,{copyState:o,enable:i}),c){var d=c[u];f(e,u,d)}l(e,"getParameter"),l(e,"isEnabled")}return e.state.enable=i,e}function p(t){t.state||d(t,{copyState:!1}),t.state.push()}function g(t){Object(s.a)(t.state),t.state.pop()}}).call(this,n(50))},function(t,e,n){var r=n(79);t.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){"use strict";t.exports=i,t.exports.default=i;var r=n(396);function i(t,e){if(!(this instanceof i))return new i(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear()}function o(t,e,n){if(!n)return e.indexOf(t);for(var r=0;r<e.length;r++)if(n(t,e[r]))return r;return-1}function a(t,e){s(t,0,t.children.length,e,t)}function s(t,e,n,r,i){i||(i=g(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var o,a=e;a<n;a++)o=t.children[a],u(i,t.leaf?r(o):o);return i}function u(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function c(t,e){return t.minX-e.minX}function l(t,e){return t.minY-e.minY}function f(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function h(t){return t.maxX-t.minX+(t.maxY-t.minY)}function d(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function p(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function g(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function v(t,e,n,i,o){for(var a,s=[e,n];s.length;)(n=s.pop())-(e=s.pop())<=i||(a=e+Math.ceil((n-e)/i/2)*i,r(t,a,e,n,o),s.push(e,a,a,n))}i.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,n=[],r=this.toBBox;if(!p(t,e))return n;for(var i,o,a,s,u=[];e;){for(i=0,o=e.children.length;i<o;i++)a=e.children[i],p(t,s=e.leaf?r(a):a)&&(e.leaf?n.push(a):d(t,s)?this._all(a,n):u.push(a));e=u.pop()}return n},collides:function(t){var e=this.data,n=this.toBBox;if(!p(t,e))return!1;for(var r,i,o,a,s=[];e;){for(r=0,i=e.children.length;r<i;r++)if(o=e.children[r],p(t,a=e.leaf?n(o):o)){if(e.leaf||d(t,a))return!0;s.push(o)}e=s.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,n=t.length;e<n;e++)this.insert(t[e]);return this}var r=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var i=this.data;this.data=r,r=i}this._insert(r,this.data.height-r.height-1,!0)}else this.data=r;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=g([]),this},remove:function(t,e){if(!t)return this;for(var n,r,i,a,s=this.data,u=this.toBBox(t),c=[],l=[];s||c.length;){if(s||(s=c.pop(),r=c[c.length-1],n=l.pop(),a=!0),s.leaf&&-1!==(i=o(t,s.children,e)))return s.children.splice(i,1),c.push(s),this._condense(c),this;a||s.leaf||!d(s,u)?r?(n++,s=r.children[n],a=!1):s=null:(c.push(s),l.push(n),n=0,r=s,s=s.children[0])}return this},toBBox:function(t){return t},compareMinX:c,compareMinY:l,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},_build:function(t,e,n,r){var i,o=n-e+1,s=this._maxEntries;if(o<=s)return a(i=g(t.slice(e,n+1)),this.toBBox),i;r||(r=Math.ceil(Math.log(o)/Math.log(s)),s=Math.ceil(o/Math.pow(s,r-1))),(i=g([])).leaf=!1,i.height=r;var u,c,l,f,h=Math.ceil(o/s),d=h*Math.ceil(Math.sqrt(s));for(v(t,e,n,d,this.compareMinX),u=e;u<=n;u+=d)for(v(t,u,l=Math.min(u+d-1,n),h,this.compareMinY),c=u;c<=l;c+=h)f=Math.min(c+h-1,l),i.children.push(this._build(t,c,f,r-1));return a(i,this.toBBox),i},_chooseSubtree:function(t,e,n,r){for(var i,o,a,s,u,c,l,h,d,p;r.push(e),!e.leaf&&r.length-1!==n;){for(l=h=1/0,i=0,o=e.children.length;i<o;i++)u=f(a=e.children[i]),d=t,p=a,(c=(Math.max(p.maxX,d.maxX)-Math.min(p.minX,d.minX))*(Math.max(p.maxY,d.maxY)-Math.min(p.minY,d.minY))-u)<h?(h=c,l=u<l?u:l,s=a):c===h&&u<l&&(l=u,s=a);e=s||e.children[0]}return e},_insert:function(t,e,n){var r=this.toBBox,i=n?t:r(t),o=[],a=this._chooseSubtree(i,this.data,e,o);for(a.children.push(t),u(a,i);e>=0&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(i,o,e)},_split:function(t,e){var n=t[e],r=n.children.length,i=this._minEntries;this._chooseSplitAxis(n,i,r);var o=this._chooseSplitIndex(n,i,r),s=g(n.children.splice(o,n.children.length-o));s.height=n.height,s.leaf=n.leaf,a(n,this.toBBox),a(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(n,s)},_splitRoot:function(t,e){this.data=g([t,e]),this.data.height=t.height+1,this.data.leaf=!1,a(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,n){var r,i,o,a,u,c,l,h,d,p,g,v,y,m;for(c=l=1/0,r=e;r<=n-e;r++)i=s(t,0,r,this.toBBox),o=s(t,r,n,this.toBBox),d=i,p=o,g=void 0,v=void 0,y=void 0,m=void 0,g=Math.max(d.minX,p.minX),v=Math.max(d.minY,p.minY),y=Math.min(d.maxX,p.maxX),m=Math.min(d.maxY,p.maxY),a=Math.max(0,y-g)*Math.max(0,m-v),u=f(i)+f(o),a<c?(c=a,h=r,l=u<l?u:l):a===c&&u<l&&(l=u,h=r);return h},_chooseSplitAxis:function(t,e,n){var r=t.leaf?this.compareMinX:c,i=t.leaf?this.compareMinY:l;this._allDistMargin(t,e,n,r)<this._allDistMargin(t,e,n,i)&&t.children.sort(r)},_allDistMargin:function(t,e,n,r){t.children.sort(r);var i,o,a=this.toBBox,c=s(t,0,e,a),l=s(t,n-e,n,a),f=h(c)+h(l);for(i=e;i<n-e;i++)o=t.children[i],u(c,t.leaf?a(o):o),f+=h(c);for(i=n-e-1;i>=e;i--)o=t.children[i],u(l,t.leaf?a(o):o),f+=h(l);return f},_adjustParentBBoxes:function(t,e,n){for(var r=n;r>=0;r--)u(e[r],t)},_condense:function(t){for(var e,n=t.length-1;n>=0;n--)0===t[n].children.length?n>0?(e=t[n-1].children).splice(e.indexOf(t[n]),1):this.clear():a(t[n],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}}},function(t,e,n){var r=n(16).getCoord;function i(t,e,n){if(!0===n)return function(t,e){var n=i(e,t);return n=(n+180)%360}(t,e);var o=Math.PI/180,a=180/Math.PI,s=r(t),u=r(e),c=o*s[0],l=o*u[0],f=o*s[1],h=o*u[1],d=Math.sin(l-c)*Math.cos(h),p=Math.cos(f)*Math.sin(h)-Math.sin(f)*Math.cos(h)*Math.cos(l-c);return a*Math.atan2(d,p)}t.exports=i},function(t,e,n){var r=n(15),i=n(165),o=n(11),a=n(16).getCoords,s=n(93),u=o.point,c=r.featureEach,l=o.featureCollection;function f(t,e){var n=a(t),r=a(e);if(2!==n.length)throw new Error("<intersects> line1 must only contain 2 coordinates");if(2!==r.length)throw new Error("<intersects> line2 must only contain 2 coordinates");var i=n[0][0],o=n[0][1],s=n[1][0],c=n[1][1],l=r[0][0],f=r[0][1],h=r[1][0],d=r[1][1],p=(d-f)*(s-i)-(h-l)*(c-o),g=(h-l)*(o-f)-(d-f)*(i-l),v=(s-i)*(o-f)-(c-o)*(i-l);if(0===p)return null;var y=g/p,m=v/p;return y>=0&&y<=1&&m>=0&&m<=1?u([i+y*(s-i),o+y*(c-o)]):null}t.exports=function(t,e){var n={},r=[];if("LineString"===t.type&&(t=o.feature(t)),"LineString"===e.type&&(e=o.feature(e)),"Feature"===t.type&&"Feature"===e.type&&"LineString"===t.geometry.type&&"LineString"===e.geometry.type&&2===t.geometry.coordinates.length&&2===e.geometry.coordinates.length){var u=f(t,e);return u&&r.push(u),l(r)}var h=i();return h.load(s(e)),c(s(t),(function(t){c(h.search(t),(function(e){var i=f(t,e);if(i){var o=a(i).join(",");n[o]||(n[o]=!0,r.push(i))}}))})),l(r)}},function(t,e,n){var r=n(489),i=n(494);t.exports=function(t,e){var n=i(t,e);return r(n)?n:void 0}},function(t,e,n){"use strict";(function(t,r){function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}n.d(e,"a",(function(){return o}));"object"!==(void 0===t?"undefined":i(t))||"[object process]"!==String(t)||t.browser,"undefined"!=typeof window&&window;var o=void 0!==r?r:window;"undefined"!=typeof document&&document}).call(this,n(61),n(50))},function(t,e,n){"use strict";(function(t){n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return o}));var r="undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",i="undefined"!=typeof window?window:t,o=(void 0!==t||window,"undefined"!=typeof document&&document,!1);try{var a={get passive(){return o=!0,!0}};i.addEventListener("test",a,a),i.removeEventListener("test",a,a)}catch(t){}}).call(this,n(50))},,function(t,e,n){var r=n(63),i=n(89);t.exports=n(64)?function(t,e,n){return r.f(t,e,i(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,n){var r=n(143);t.exports=function(t){return Object(r(t))}},function(t,e){t.exports={}},function(t,e,n){var r=n(198),i=n(143);t.exports=function(t){return r(i(t))}},function(t,e,n){"use strict";e.__esModule=!0;var r,i=n(203),o=(r=i)&&r.__esModule?r:{default:r};e.default=o.default||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}},function(t,e,n){var r=n(15).coordEach,i=n(11).point;t.exports=function(t,e){var n=0,o=0,a=0;return r(t,(function(t){n+=t[0],o+=t[1],a++}),!0),i([n/a,o/a],e)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));var r=n(1),i=n(2),o=n(9),a=n(8),s=n(10),u=n(17),c=n(47),l=n(3),f=[34069,34070,34071,34072,34073,34074],h=function(t){function e(t){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(r.a)(this,e),(n=Object(o.a)(this,Object(a.a)(e).call(this,t,Object.assign({},i,{target:34067})))).initialize(i),Object.seal(Object(u.a)(Object(u.a)(n))),n}return Object(s.a)(e,t),Object(i.a)(e,[{key:"initialize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.format,n=void 0===e?6408:e,r=t.mipmaps,i=void 0===r||r,o=t.width,a=void 0===o?1:o,s=t.height,u=void 0===s?1:s,c=t.type,f=void 0===c?5121:c,h=t.dataFormat,d=this._deduceParameters({format:n,type:f,dataFormat:h});f=d.type,h=d.dataFormat;var p=this._deduceImageSize({data:t[34069],width:a,height:u});a=p.width,u=p.height,Object(l.a)(a===u),this.setCubeMapImageData(t),i&&this.generateMipmap(t),this.opts=t}},{key:"subImage",value:function(t){var e=t.face,n=t.data,r=t.x,i=void 0===r?0:r,o=t.y,a=void 0===o?0:o,s=t.mipmapLevel,u=void 0===s?0:s;return this._subImage({target:e,data:n,x:i,y:a,mipmapLevel:u})}},{key:"setCubeMapImageData",value:function(t){var e=t.width,n=t.height,r=t.pixels,i=t.data,o=t.border,a=void 0===o?0:o,s=t.format,u=void 0===s?6408:s,c=t.type,l=void 0===c?5121:c,h=(t.generateMipmap,this.gl);if(r=r||i,this.bind(),this.width||this.height)for(var d=0;d<f.length;d++){var p=f[d];h.texImage2D(p,0,u,e,n,a,u,l,r[p])}else for(var g=0;g<f.length;g++){var v=f[g];h.texImage2D(v,0,u,u,l,r[v])}}},{key:"bind",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.index;return void 0!==e&&this.gl.activeTexture(33984+e),this.gl.bindTexture(34067,this.handle),e}},{key:"unbind",value:function(){return this.gl.bindTexture(34067,null),this}}]),e}(c.a);h.FACES=f},function(t,e,n){"use strict";function r(t,e){return(r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var r=n(1),i=n(2),o=n(9),a=n(8),s=n(10),u=n(137),c=n(18),l=function(t,e){if(!t)throw new Error(e)},f=function(t){function e(){return Object(r.a)(this,e),Object(o.a)(this,Object(a.a)(e).apply(this,arguments))}return Object(s.a)(e,t),Object(i.a)(e,[{key:"len",value:function(){return Math.sqrt(this.lengthSquared())}},{key:"magnitude",value:function(){return Math.sqrt(this.lengthSquared())}},{key:"lengthSquared",value:function(){for(var t=0,e=0;e<this.ELEMENTS;++e)t+=this[e]*this[e];return t}},{key:"distance",value:function(t){return Math.sqrt(this.distanceSquared(t))}},{key:"distanceSquared",value:function(t){for(var e=0,n=0;n<this.ELEMENTS;++n){var r=this[n]-t[n];e+=r*r}return Object(c.a)(e)}},{key:"dot",value:function(t){for(var e=0,n=0;n<this.ELEMENTS;++n)e+=this[n]*t[n];return Object(c.a)(e)}},{key:"normalize",value:function(){var t=this.magnitude();if(0!==t)for(var e=0;e<this.ELEMENTS;++e)this[e]/=t;return this.check()}},{key:"add",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0;r<e.length;r++)for(var i=e[r],o=0;o<this.ELEMENTS;++o)this[o]+=i[o];return this.check()}},{key:"subtract",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0;r<e.length;r++)for(var i=e[r],o=0;o<this.ELEMENTS;++o)this[o]-=i[o];return this.check()}},{key:"multiply",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0;r<e.length;r++)for(var i=e[r],o=0;o<this.ELEMENTS;++o)this[o]*=i[o];return this.check()}},{key:"divide",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0;r<e.length;r++)for(var i=e[r],o=0;o<this.ELEMENTS;++o)this[o]/=i[o];return this.check()}},{key:"scale",value:function(t){if(Array.isArray(t))return this.multiply(t);for(var e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}},{key:"scaleAndAdd",value:function(t,e){for(var n=0;n<this.ELEMENTS;++n)this[n]=this[n]*e+t[n];return this.check()}},{key:"lengthSq",value:function(){return this.lengthSquared()}},{key:"distanceTo",value:function(t){return this.distance(t)}},{key:"distanceToSquared",value:function(t){return this.distanceSquared(t)}},{key:"getComponent",value:function(t){return l(t>=0&&t<this.ELEMENTS,"index is out of range"),Object(c.a)(this[t])}},{key:"setComponent",value:function(t,e){return l(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=e,this.check()}},{key:"addVectors",value:function(t,e){return this.copy(t).add(e)}},{key:"subVectors",value:function(t,e){return this.copy(t).subtract(e)}},{key:"multiplyVectors",value:function(t,e){return this.copy(t).multiply(e)}},{key:"addScaledVector",value:function(t,e){return this.add(new this.constructor(t).multiplyScalar(e))}},{key:"x",get:function(){return this[0]},set:function(t){return this[0]=Object(c.a)(t)}},{key:"y",get:function(){return this[1]},set:function(t){return this[1]=Object(c.a)(t)}}]),e}(u.a)},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,n){var r=n(197),i=n(150);t.exports=Object.keys||function(t){return r(t,i)}},function(t,e){function n(t,e,r){var i,o,a,s,u,c,l,f,h,d,p=0,g=0,v="FeatureCollection"===t.type,y="Feature"===t.type,m=v?t.features.length:1;for(i=0;i<m;i++)for(l=(d="GeometryCollection"===(h=v?t.features[i].geometry:y?t.geometry:t).type)?h.geometries.length:1,s=0;s<l;s++)if(f=(c=d?h.geometries[s]:h).coordinates,p=!r||"Polygon"!==c.type&&"MultiPolygon"!==c.type?0:1,"Point"===c.type)e(f,g),g++;else if("LineString"===c.type||"MultiPoint"===c.type)for(o=0;o<f.length;o++)e(f[o],g),g++;else if("Polygon"===c.type||"MultiLineString"===c.type)for(o=0;o<f.length;o++)for(a=0;a<f[o].length-p;a++)e(f[o][a],g),g++;else if("MultiPolygon"===c.type)for(o=0;o<f.length;o++)for(a=0;a<f[o].length;a++)for(u=0;u<f[o][a].length-p;u++)e(f[o][a][u],g),g++;else{if("GeometryCollection"!==c.type)throw new Error("Unknown Geometry Type");for(o=0;o<c.geometries.length;o++)n(c.geometries[o],e,r)}}function r(t,e){var n;switch(t.type){case"FeatureCollection":for(n=0;n<t.features.length;n++)e(t.features[n].properties,n);break;case"Feature":e(t.properties,0)}}function i(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var n=0;n<t.features.length;n++)e(t.features[n],n)}function o(t,e){var n,r,i,o,a,s,u,c=0,l="FeatureCollection"===t.type,f="Feature"===t.type,h=l?t.features.length:1;for(n=0;n<h;n++)for(a=(u="GeometryCollection"===(s=l?t.features[n].geometry:f?t.geometry:t).type)?s.geometries.length:1,i=0;i<a;i++)if("Point"===(o=u?s.geometries[i]:s).type||"LineString"===o.type||"MultiPoint"===o.type||"Polygon"===o.type||"MultiLineString"===o.type||"MultiPolygon"===o.type)e(o,c),c++;else{if("GeometryCollection"!==o.type)throw new Error("Unknown Geometry Type");for(r=0;r<o.geometries.length;r++)e(o.geometries[r],c),c++}}t.exports.coordEach=n,t.exports.coordReduce=function(t,e,r,i){var o=r;return n(t,(function(t,n){o=0===n&&void 0===r?t:e(o,t,n)}),i),o},t.exports.propEach=r,t.exports.propReduce=function(t,e,n){var i=n;return r(t,(function(t,r){i=0===r&&void 0===n?t:e(i,t,r)})),i},t.exports.featureEach=i,t.exports.featureReduce=function(t,e,n){var r=n;return i(t,(function(t,i){r=0===i&&void 0===n?t:e(r,t,i)})),r},t.exports.coordAll=function(t){var e=[];return n(t,(function(t){e.push(t)})),e},t.exports.geomEach=o,t.exports.geomReduce=function(t,e,n){var r=n;return o(t,(function(t,i){r=0===i&&void 0===n?t:e(r,t,i)})),r}},function(t,e,n){"use strict";var r=n(215),i="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),o=Object.prototype.toString,a=Array.prototype.concat,s=Object.defineProperty,u=s&&function(){var t={};try{for(var e in s(t,"x",{enumerable:!1,value:t}),t)return!1;return t.x===t}catch(t){return!1}}(),c=function(t,e,n,r){var i;(!(e in t)||"function"==typeof(i=r)&&"[object Function]"===o.call(i)&&r())&&(u?s(t,e,{configurable:!0,enumerable:!1,value:n,writable:!0}):t[e]=n)},l=function(t,e){var n=arguments.length>2?arguments[2]:{},o=r(e);i&&(o=a.call(o,Object.getOwnPropertySymbols(e)));for(var s=0;s<o.length;s+=1)c(t,o[s],e[o[s]],n[o[s]])};l.supportsDescriptors=!!u,t.exports=l},function(t,e,n){var r=n(11),i=n(16).getCoords,o=n(15).flattenEach,a=r.lineString,s=r.featureCollection;t.exports=function(t){if(!t)throw new Error("geojson is required");var e=[];return o(t,(function(t){!function(t,e){var n=[],r=t.geometry;switch(r.type){case"Polygon":n=i(r);break;case"LineString":n=[i(r)]}n.forEach((function(n){(function(t,e){var n=[];return t.reduce((function(t,r){var i,o,s,u,c,l,f=a([t,r],e);return f.bbox=(o=r,s=(i=t)[0],u=i[1],c=o[0],l=o[1],[s<c?s:c,u<l?u:l,s>c?s:c,u>l?u:l]),n.push(f),r})),n})(n,t.properties).forEach((function(t){t.id=e.length,e.push(t)}))}))}(t,e)})),s(e)}},function(t,e,n){var r=n(15),i=n(11),o=n(72),a=n(37),s=n(16),u=n(66),c=n(73),l=i.point,f=s.getCoords,h=i.lineString,d=r.flattenEach;t.exports=function(t,e,n){var r=t.geometry?t.geometry.type:t.type;if("LineString"!==r&&"MultiLineString"!==r)throw new Error("lines must be LineString or MultiLineString");var i=l([1/0,1/0],{dist:1/0}),s=0;return d(t,(function(t){for(var r=f(t),d=0;d<r.length-1;d++){var p=l(r[d]);p.properties.dist=a(e,p,n);var g=l(r[d+1]);g.properties.dist=a(e,g,n);var v=a(p,g,n),y=Math.max(p.properties.dist,g.properties.dist),m=o(p,g),b=u(e,y,m+90,n),_=u(e,y,m-90,n),x=c(h([b.geometry.coordinates,_.geometry.coordinates]),h([p.geometry.coordinates,g.geometry.coordinates])),w=null;x.features.length>0&&((w=x.features[0]).properties.dist=a(e,w,n),w.properties.location=s+a(p,w,n)),p.properties.dist<i.properties.dist&&((i=p).properties.index=d,i.properties.location=s),g.properties.dist<i.properties.dist&&((i=g).properties.index=d+1,i.properties.location=s+v),w&&w.properties.dist<i.properties.dist&&((i=w).properties.index=d),s+=v}})),i}},function(t,e){function n(t){var e={type:"Feature"};return Object.keys(t).forEach((function(n){switch(n){case"type":case"properties":case"geometry":return;default:e[n]=t[n]}})),e.properties=function t(e){var n={};return e?(Object.keys(e).forEach((function(r){var i=e[r];"object"==typeof i?(i.length&&(n[r]=i.map((function(t){return t}))),n[r]=t(i)):n[r]=i})),n):n}(t.properties),e.geometry=r(t.geometry),e}function r(t){var e={type:t.type};return t.bbox&&(e.bbox=t.bbox),"GeometryCollection"===t.type?(e.geometries=t.geometries.map((function(t){return r(t)})),e):(e.coordinates=function t(e){if("object"!=typeof e[0])return e.slice();return e.map((function(e){return t(e)}))}(t.coordinates),e)}t.exports=function(t){if(!t)throw new Error("geojson is required");switch(t.type){case"Feature":return n(t);case"FeatureCollection":return function(t){var e={type:"FeatureCollection"};return Object.keys(t).forEach((function(n){switch(n){case"type":case"features":return;default:e[n]=t[n]}})),e.features=t.features.map((function(t){return n(t)})),e}(t);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return r(t);default:throw new Error("unknown GeoJSON type")}}},function(t,e,n){var r=n(16).getCoord,i=n(174).LatLonSpherical;t.exports=function(t,e,n){if(!t)throw new Error("start point is required");if(!e)throw new Error("end point is required");var o,a=r(t),s=r(e),u=new i(a[1],a[0]),c=new i(s[1],s[0]);return(o=n?c.rhumbBearingTo(u):u.rhumbBearingTo(c))>180?-(360-o):o}},function(t,e,n){"use strict";if(t.exports)var r=n(175);if(t.exports)var i=n(126);function o(t,e,n){if(!(this instanceof o))return new o(t,e,n);void 0===n&&(n=o.datum.WGS84),this.lat=Number(t),this.lon=Number(e),this.datum=n}o.ellipsoid={WGS84:{a:6378137,b:6356752.314245,f:1/298.257223563},Airy1830:{a:6377563.396,b:6356256.909,f:1/299.3249646},AiryModified:{a:6377340.189,b:6356034.448,f:1/299.3249646},Bessel1841:{a:6377397.155,b:6356078.962818,f:1/299.1528128},Clarke1866:{a:6378206.4,b:6356583.8,f:1/294.978698214},Clarke1880IGN:{a:6378249.2,b:6356515,f:1/293.466021294},GRS80:{a:6378137,b:6356752.31414,f:1/298.257222101},Intl1924:{a:6378388,b:6356911.946,f:1/297},WGS72:{a:6378135,b:6356750.5,f:1/298.26}},o.datum={ED50:{ellipsoid:o.ellipsoid.Intl1924,transform:[89.5,93.8,123.1,-1.2,0,0,.156]},Irl1975:{ellipsoid:o.ellipsoid.AiryModified,transform:[-482.53,130.596,-564.557,-8.15,-1.042,-.214,-.631]},NAD27:{ellipsoid:o.ellipsoid.Clarke1866,transform:[8,-160,-176,0,0,0,0]},NAD83:{ellipsoid:o.ellipsoid.GRS80,transform:[1.004,-1.91,-.515,-.0015,.0267,34e-5,.011]},NTF:{ellipsoid:o.ellipsoid.Clarke1880IGN,transform:[168,60,-320,0,0,0,0]},OSGB36:{ellipsoid:o.ellipsoid.Airy1830,transform:[-446.448,125.157,-542.06,20.4894,-.1502,-.247,-.8421]},Potsdam:{ellipsoid:o.ellipsoid.Bessel1841,transform:[-582,-105,-414,-8.3,1.04,.35,-3.08]},TokyoJapan:{ellipsoid:o.ellipsoid.Bessel1841,transform:[148,-507,-685,0,0,0,0]},WGS72:{ellipsoid:o.ellipsoid.WGS72,transform:[0,0,-4.5,-.22,0,0,.554]},WGS84:{ellipsoid:o.ellipsoid.WGS84,transform:[0,0,0,0,0,0,0]}},o.prototype.convertDatum=function(t){var e=this,n=null;if(e.datum==o.datum.WGS84&&(n=t.transform),t==o.datum.WGS84){n=[];for(var r=0;r<7;r++)n[r]=-e.datum.transform[r]}return null==n&&(e=this.convertDatum(o.datum.WGS84),n=t.transform),e.toCartesian().applyTransform(n).toLatLonE(t)},o.prototype.toCartesian=function(){var t=this.lat.toRadians(),e=this.lon.toRadians(),n=this.datum.ellipsoid.a,i=this.datum.ellipsoid.f,o=Math.sin(t),a=Math.cos(t),s=Math.sin(e),u=Math.cos(e),c=2*i-i*i,l=n/Math.sqrt(1-c*o*o);return new r((l+0)*a*u,(l+0)*a*s,(l*(1-c)+0)*o)},r.prototype.toLatLonE=function(t){var e=this.x,n=this.y,r=this.z,i=t.ellipsoid.a,a=t.ellipsoid.b,s=t.ellipsoid.f,u=2*s-s*s,c=u/(1-u),l=Math.sqrt(e*e+n*n),f=a*r/(i*l)*(1+c*a/Math.sqrt(l*l+r*r)),h=f/Math.sqrt(1+f*f),d=h/f,p=isNaN(d)?0:Math.atan2(r+c*a*h*h*h,l-u*i*d*d*d),g=Math.atan2(n,e),v=Math.sin(p);Math.cos(p),Math.sqrt(1-u*v*v);return new o(p.toDegrees(),g.toDegrees(),t)},r.prototype.applyTransform=function(t){var e=this.x,n=this.y,i=this.z,o=t[0],a=t[1],s=t[2],u=t[3]/1e6+1,c=(t[4]/3600).toRadians(),l=(t[5]/3600).toRadians(),f=(t[6]/3600).toRadians();return new r(o+e*u-n*f+i*l,a+e*f+n*u-i*c,s-e*l+n*c+i*u)},o.prototype.toString=function(t,e){return i.toLat(this.lat,t,e)+", "+i.toLon(this.lon,t,e)},void 0===Number.prototype.toRadians&&(Number.prototype.toRadians=function(){return this*Math.PI/180}),void 0===Number.prototype.toDegrees&&(Number.prototype.toDegrees=function(){return 180*this/Math.PI}),t.exports&&(t.exports=o,t.exports.Vector3d=r)},function(t,e,n){var r=n(11),i=n(16).getCoord,o=n(174).LatLonSpherical,a=r.radiansToDistance,s=r.distanceToRadians;t.exports=function(t,e,n){if(!t)throw new Error("from point is required");if(!e)throw new Error("to point is required");n=n||"kilometers";var r=i(t),u=i(e),c=new o(r[1],r[0]),l=new o(u[1],u[0]);l[0]+=l[0]-c[0]>180?-360:c[0]-l[0]>180?360:0;var f=c.rhumbDistanceTo(l);return a(s(f,"meters"),n)}},function(t,e,n){var r=n(11),i=n(16).getCoord,o=n(174).LatLonSpherical,a=r.point,s=r.radiansToDistance,u=r.distanceToRadians;t.exports=function(t,e,n,r){if(!t)throw new Error("origin is required");if(null==e)throw new Error("distance is required");if(null==n)throw new Error("bearing is required");if(!(e>=0))throw new Error("distance must be greater than 0");var c=s(u(e,r=r||"kilometers"),"meters"),l=i(t),f=new o(l[1],l[0]).rhumbDestinationPoint(c,n);return f.lon+=f.lon-l[0]>180?-360:l[0]-f.lon>180?360:0,a([f.lon,f.lat])}},function(t,e){t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},function(t,e){t.exports=function(t){return null!=t&&"object"==typeof t}},function(t,e,n){"use strict";function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));var r=n(1),i=n(2),o=n(9),a=n(8),s=n(10),u=n(88),c=n(18),l=n(49),f=[0,0,0],h=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Object(r.a)(this,e),t=Object(o.a)(this,Object(a.a)(e).call(this,3)),Array.isArray(n)&&1===arguments.length?t.copy(n):t.set(n,i,s),t}return Object(s.a)(e,t),Object(i.a)(e,[{key:"angle",value:function(t){return l.a(this,t)}},{key:"cross",value:function(t){return l.b(this,this,t),this.check()}},{key:"rotateX",value:function(t){var e=t.radians,n=t.origin,r=void 0===n?f:n;return l.e(this,this,r,e),this.check()}},{key:"rotateY",value:function(t){var e=t.radians,n=t.origin,r=void 0===n?f:n;return l.f(this,this,r,e),this.check()}},{key:"rotateZ",value:function(t){var e=t.radians,n=t.origin,r=void 0===n?f:n;return l.g(this,this,r,e),this.check()}},{key:"operation",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return t.apply(void 0,[this,this].concat(n)),this.check()}},{key:"ELEMENTS",get:function(){return 3}},{key:"z",get:function(){return this[2]},set:function(t){return this[2]=Object(c.a)(t)}}]),e}(u.a)},function(t,e){t.exports=function(t,e,n){var r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}},function(t,e){t.exports=function(t,e,n){var r,i,o,a,s,u,c,l,f,h,d,p,g=n[0],v=n[1],y=n[2];e===t?(t[12]=e[0]*g+e[4]*v+e[8]*y+e[12],t[13]=e[1]*g+e[5]*v+e[9]*y+e[13],t[14]=e[2]*g+e[6]*v+e[10]*y+e[14],t[15]=e[3]*g+e[7]*v+e[11]*y+e[15]):(r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=e[9],d=e[10],p=e[11],t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=c,t[7]=l,t[8]=f,t[9]=h,t[10]=d,t[11]=p,t[12]=r*g+s*v+f*y+e[12],t[13]=i*g+u*v+h*y+e[13],t[14]=o*g+c*v+d*y+e[14],t[15]=a*g+l*v+p*y+e[15]);return t}},function(t,e,n){var r;
/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */!function(i,o,a,s){"use strict";var u,c=["","webkit","Moz","MS","ms","o"],l=o.createElement("div"),f=Math.round,h=Math.abs,d=Date.now;function p(t,e,n){return setTimeout(x(t,n),e)}function g(t,e,n){return!!Array.isArray(t)&&(v(t,n[e],n),!0)}function v(t,e,n){var r;if(t)if(t.forEach)t.forEach(e,n);else if(void 0!==t.length)for(r=0;r<t.length;)e.call(n,t[r],r,t),r++;else for(r in t)t.hasOwnProperty(r)&&e.call(n,t[r],r,t)}function y(t,e,n){var r="DEPRECATED METHOD: "+e+"\n"+n+" AT \n";return function(){var e=new Error("get-stack-trace"),n=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=i.console&&(i.console.warn||i.console.log);return o&&o.call(i.console,r,n),t.apply(this,arguments)}}u="function"!=typeof Object.assign?function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var r=arguments[n];if(null!=r)for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])}return e}:Object.assign;var m=y((function(t,e,n){for(var r=Object.keys(e),i=0;i<r.length;)(!n||n&&void 0===t[r[i]])&&(t[r[i]]=e[r[i]]),i++;return t}),"extend","Use `assign`."),b=y((function(t,e){return m(t,e,!0)}),"merge","Use `assign`.");function _(t,e,n){var r,i=e.prototype;(r=t.prototype=Object.create(i)).constructor=t,r._super=i,n&&u(r,n)}function x(t,e){return function(){return t.apply(e,arguments)}}function w(t,e){return"function"==typeof t?t.apply(e&&e[0]||void 0,e):t}function E(t,e){return void 0===t?e:t}function S(t,e,n){v(M(e),(function(e){t.addEventListener(e,n,!1)}))}function O(t,e,n){v(M(e),(function(e){t.removeEventListener(e,n,!1)}))}function P(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function C(t,e){return t.indexOf(e)>-1}function M(t){return t.trim().split(/\s+/g)}function I(t,e,n){if(t.indexOf&&!n)return t.indexOf(e);for(var r=0;r<t.length;){if(n&&t[r][n]==e||!n&&t[r]===e)return r;r++}return-1}function A(t){return Array.prototype.slice.call(t,0)}function T(t,e,n){for(var r=[],i=[],o=0;o<t.length;){var a=e?t[o][e]:t[o];I(i,a)<0&&r.push(t[o]),i[o]=a,o++}return n&&(r=e?r.sort((function(t,n){return t[e]>n[e]})):r.sort()),r}function N(t,e){for(var n,r,i=e[0].toUpperCase()+e.slice(1),o=0;o<c.length;){if((r=(n=c[o])?n+i:e)in t)return r;o++}}var L=1;function R(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow||i}var k="ontouchstart"in i,j=void 0!==N(i,"PointerEvent"),F=k&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),D=["x","y"],B=["clientX","clientY"];function z(t,e){var n=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){w(t.options.enable,[t])&&n.handler(e)},this.init()}function V(t,e,n){var r=n.pointers.length,i=n.changedPointers.length,o=1&e&&r-i==0,a=12&e&&r-i==0;n.isFirst=!!o,n.isFinal=!!a,o&&(t.session={}),n.eventType=e,function(t,e){var n=t.session,r=e.pointers,i=r.length;n.firstInput||(n.firstInput=G(e));i>1&&!n.firstMultiple?n.firstMultiple=G(e):1===i&&(n.firstMultiple=!1);var o=n.firstInput,a=n.firstMultiple,s=a?a.center:o.center,u=e.center=U(r);e.timeStamp=d(),e.deltaTime=e.timeStamp-o.timeStamp,e.angle=H(s,u),e.distance=X(s,u),function(t,e){var n=e.center,r=t.offsetDelta||{},i=t.prevDelta||{},o=t.prevInput||{};1!==e.eventType&&4!==o.eventType||(i=t.prevDelta={x:o.deltaX||0,y:o.deltaY||0},r=t.offsetDelta={x:n.x,y:n.y});e.deltaX=i.x+(n.x-r.x),e.deltaY=i.y+(n.y-r.y)}(n,e),e.offsetDirection=q(e.deltaX,e.deltaY);var c=W(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=c.x,e.overallVelocityY=c.y,e.overallVelocity=h(c.x)>h(c.y)?c.x:c.y,e.scale=a?(l=a.pointers,f=r,X(f[0],f[1],B)/X(l[0],l[1],B)):1,e.rotation=a?function(t,e){return H(e[1],e[0],B)+H(t[1],t[0],B)}(a.pointers,r):0,e.maxPointers=n.prevInput?e.pointers.length>n.prevInput.maxPointers?e.pointers.length:n.prevInput.maxPointers:e.pointers.length,function(t,e){var n,r,i,o,a=t.lastInterval||e,s=e.timeStamp-a.timeStamp;if(8!=e.eventType&&(s>25||void 0===a.velocity)){var u=e.deltaX-a.deltaX,c=e.deltaY-a.deltaY,l=W(s,u,c);r=l.x,i=l.y,n=h(l.x)>h(l.y)?l.x:l.y,o=q(u,c),t.lastInterval=e}else n=a.velocity,r=a.velocityX,i=a.velocityY,o=a.direction;e.velocity=n,e.velocityX=r,e.velocityY=i,e.direction=o}(n,e);var l,f;var p=t.element;P(e.srcEvent.target,p)&&(p=e.srcEvent.target);e.target=p}(t,n),t.emit("hammer.input",n),t.recognize(n),t.session.prevInput=n}function G(t){for(var e=[],n=0;n<t.pointers.length;)e[n]={clientX:f(t.pointers[n].clientX),clientY:f(t.pointers[n].clientY)},n++;return{timeStamp:d(),pointers:e,center:U(e),deltaX:t.deltaX,deltaY:t.deltaY}}function U(t){var e=t.length;if(1===e)return{x:f(t[0].clientX),y:f(t[0].clientY)};for(var n=0,r=0,i=0;i<e;)n+=t[i].clientX,r+=t[i].clientY,i++;return{x:f(n/e),y:f(r/e)}}function W(t,e,n){return{x:e/t||0,y:n/t||0}}function q(t,e){return t===e?1:h(t)>=h(e)?t<0?2:4:e<0?8:16}function X(t,e,n){n||(n=D);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return Math.sqrt(r*r+i*i)}function H(t,e,n){n||(n=D);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return 180*Math.atan2(i,r)/Math.PI}z.prototype={handler:function(){},init:function(){this.evEl&&S(this.element,this.evEl,this.domHandler),this.evTarget&&S(this.target,this.evTarget,this.domHandler),this.evWin&&S(R(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&O(this.element,this.evEl,this.domHandler),this.evTarget&&O(this.target,this.evTarget,this.domHandler),this.evWin&&O(R(this.element),this.evWin,this.domHandler)}};var Y={mousedown:1,mousemove:2,mouseup:4};function Z(){this.evEl="mousedown",this.evWin="mousemove mouseup",this.pressed=!1,z.apply(this,arguments)}_(Z,z,{handler:function(t){var e=Y[t.type];1&e&&0===t.button&&(this.pressed=!0),2&e&&1!==t.which&&(e=4),this.pressed&&(4&e&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))}});var K={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},J={2:"touch",3:"pen",4:"mouse",5:"kinect"},Q="pointerdown",$="pointermove pointerup pointercancel";function tt(){this.evEl=Q,this.evWin=$,z.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}i.MSPointerEvent&&!i.PointerEvent&&(Q="MSPointerDown",$="MSPointerMove MSPointerUp MSPointerCancel"),_(tt,z,{handler:function(t){var e=this.store,n=!1,r=t.type.toLowerCase().replace("ms",""),i=K[r],o=J[t.pointerType]||t.pointerType,a="touch"==o,s=I(e,t.pointerId,"pointerId");1&i&&(0===t.button||a)?s<0&&(e.push(t),s=e.length-1):12&i&&(n=!0),s<0||(e[s]=t,this.callback(this.manager,i,{pointers:e,changedPointers:[t],pointerType:o,srcEvent:t}),n&&e.splice(s,1))}});var et={touchstart:1,touchmove:2,touchend:4,touchcancel:8};function nt(){this.evTarget="touchstart",this.evWin="touchstart touchmove touchend touchcancel",this.started=!1,z.apply(this,arguments)}function rt(t,e){var n=A(t.touches),r=A(t.changedTouches);return 12&e&&(n=T(n.concat(r),"identifier",!0)),[n,r]}_(nt,z,{handler:function(t){var e=et[t.type];if(1===e&&(this.started=!0),this.started){var n=rt.call(this,t,e);12&e&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:t})}}});var it={touchstart:1,touchmove:2,touchend:4,touchcancel:8};function ot(){this.evTarget="touchstart touchmove touchend touchcancel",this.targetIds={},z.apply(this,arguments)}function at(t,e){var n=A(t.touches),r=this.targetIds;if(3&e&&1===n.length)return r[n[0].identifier]=!0,[n,n];var i,o,a=A(t.changedTouches),s=[],u=this.target;if(o=n.filter((function(t){return P(t.target,u)})),1===e)for(i=0;i<o.length;)r[o[i].identifier]=!0,i++;for(i=0;i<a.length;)r[a[i].identifier]&&s.push(a[i]),12&e&&delete r[a[i].identifier],i++;return s.length?[T(o.concat(s),"identifier",!0),s]:void 0}_(ot,z,{handler:function(t){var e=it[t.type],n=at.call(this,t,e);n&&this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:t})}});function st(){z.apply(this,arguments);var t=x(this.handler,this);this.touch=new ot(this.manager,t),this.mouse=new Z(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}function ut(t,e){1&t?(this.primaryTouch=e.changedPointers[0].identifier,ct.call(this,e)):12&t&&ct.call(this,e)}function ct(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var n={x:e.clientX,y:e.clientY};this.lastTouches.push(n);var r=this.lastTouches;setTimeout((function(){var t=r.indexOf(n);t>-1&&r.splice(t,1)}),2500)}}function lt(t){for(var e=t.srcEvent.clientX,n=t.srcEvent.clientY,r=0;r<this.lastTouches.length;r++){var i=this.lastTouches[r],o=Math.abs(e-i.x),a=Math.abs(n-i.y);if(o<=25&&a<=25)return!0}return!1}_(st,z,{handler:function(t,e,n){var r="touch"==n.pointerType,i="mouse"==n.pointerType;if(!(i&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(r)ut.call(this,e,n);else if(i&&lt.call(this,n))return;this.callback(t,e,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var ft=N(l.style,"touchAction"),ht=void 0!==ft,dt=function(){if(!ht)return!1;var t={},e=i.CSS&&i.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(n){t[n]=!e||i.CSS.supports("touch-action",n)})),t}();function pt(t,e){this.manager=t,this.set(e)}pt.prototype={set:function(t){"compute"==t&&(t=this.compute()),ht&&this.manager.element.style&&dt[t]&&(this.manager.element.style[ft]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return v(this.manager.recognizers,(function(e){w(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))})),function(t){if(C(t,"none"))return"none";var e=C(t,"pan-x"),n=C(t,"pan-y");if(e&&n)return"none";if(e||n)return e?"pan-x":"pan-y";if(C(t,"manipulation"))return"manipulation";return"auto"}(t.join(" "))},preventDefaults:function(t){var e=t.srcEvent,n=t.offsetDirection;if(this.manager.session.prevented)e.preventDefault();else{var r=this.actions,i=C(r,"none")&&!dt.none,o=C(r,"pan-y")&&!dt["pan-y"],a=C(r,"pan-x")&&!dt["pan-x"];if(i){var s=1===t.pointers.length,u=t.distance<2,c=t.deltaTime<250;if(s&&u&&c)return}if(!a||!o)return i||o&&6&n||a&&24&n?this.preventSrc(e):void 0}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};function gt(t){this.options=u({},this.defaults,t||{}),this.id=L++,this.manager=null,this.options.enable=E(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function vt(t){return 16&t?"cancel":8&t?"end":4&t?"move":2&t?"start":""}function yt(t){return 16==t?"down":8==t?"up":2==t?"left":4==t?"right":""}function mt(t,e){var n=e.manager;return n?n.get(t):t}function bt(){gt.apply(this,arguments)}function _t(){bt.apply(this,arguments),this.pX=null,this.pY=null}function xt(){bt.apply(this,arguments)}function wt(){gt.apply(this,arguments),this._timer=null,this._input=null}function Et(){bt.apply(this,arguments)}function St(){bt.apply(this,arguments)}function Ot(){gt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Pt(t,e){return(e=e||{}).recognizers=E(e.recognizers,Pt.defaults.preset),new Ct(t,e)}gt.prototype={defaults:{},set:function(t){return u(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(g(t,"recognizeWith",this))return this;var e=this.simultaneous;return e[(t=mt(t,this)).id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return g(t,"dropRecognizeWith",this)||(t=mt(t,this),delete this.simultaneous[t.id]),this},requireFailure:function(t){if(g(t,"requireFailure",this))return this;var e=this.requireFail;return-1===I(e,t=mt(t,this))&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(g(t,"dropRequireFailure",this))return this;t=mt(t,this);var e=I(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){var e=this,n=this.state;function r(n){e.manager.emit(n,t)}n<8&&r(e.options.event+vt(n)),r(e.options.event),t.additionalEvent&&r(t.additionalEvent),n>=8&&r(e.options.event+vt(n))},tryEmit:function(t){if(this.canEmit())return this.emit(t);this.state=32},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(33&this.requireFail[t].state))return!1;t++}return!0},recognize:function(t){var e=u({},t);if(!w(this.options.enable,[this,e]))return this.reset(),void(this.state=32);56&this.state&&(this.state=1),this.state=this.process(e),30&this.state&&this.tryEmit(e)},process:function(t){},getTouchAction:function(){},reset:function(){}},_(bt,gt,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,n=t.eventType,r=6&e,i=this.attrTest(t);return r&&(8&n||!i)?16|e:r||i?4&n?8|e:2&e?4|e:2:32}}),_(_t,bt,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var t=this.options.direction,e=[];return 6&t&&e.push("pan-y"),24&t&&e.push("pan-x"),e},directionTest:function(t){var e=this.options,n=!0,r=t.distance,i=t.direction,o=t.deltaX,a=t.deltaY;return i&e.direction||(6&e.direction?(i=0===o?1:o<0?2:4,n=o!=this.pX,r=Math.abs(t.deltaX)):(i=0===a?1:a<0?8:16,n=a!=this.pY,r=Math.abs(t.deltaY))),t.direction=i,n&&r>e.threshold&&i&e.direction},attrTest:function(t){return bt.prototype.attrTest.call(this,t)&&(2&this.state||!(2&this.state)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=yt(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),_(xt,bt,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return["none"]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||2&this.state)},emit:function(t){if(1!==t.scale){var e=t.scale<1?"in":"out";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}}),_(wt,gt,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,i=t.deltaTime>e.time;if(this._input=t,!r||!n||12&t.eventType&&!i)this.reset();else if(1&t.eventType)this.reset(),this._timer=p((function(){this.state=8,this.tryEmit()}),e.time,this);else if(4&t.eventType)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(t){8===this.state&&(t&&4&t.eventType?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=d(),this.manager.emit(this.options.event,this._input)))}}),_(Et,bt,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return["none"]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||2&this.state)}}),_(St,bt,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return _t.prototype.getTouchAction.call(this)},attrTest:function(t){var e,n=this.options.direction;return 30&n?e=t.overallVelocity:6&n?e=t.overallVelocityX:24&n&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&n&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&h(e)>this.options.velocity&&4&t.eventType},emit:function(t){var e=yt(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),_(Ot,gt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return["manipulation"]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,i=t.deltaTime<e.time;if(this.reset(),1&t.eventType&&0===this.count)return this.failTimeout();if(r&&i&&n){if(4!=t.eventType)return this.failTimeout();var o=!this.pTime||t.timeStamp-this.pTime<e.interval,a=!this.pCenter||X(this.pCenter,t.center)<e.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,a&&o?this.count+=1:this.count=1,this._input=t,0===this.count%e.taps)return this.hasRequireFailures()?(this._timer=p((function(){this.state=8,this.tryEmit()}),e.interval,this),2):8}return 32},failTimeout:function(){return this._timer=p((function(){this.state=32}),this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Pt.VERSION="2.0.7",Pt.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[Et,{enable:!1}],[xt,{enable:!1},["rotate"]],[St,{direction:6}],[_t,{direction:6},["swipe"]],[Ot],[Ot,{event:"doubletap",taps:2},["tap"]],[wt]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};function Ct(t,e){var n;this.options=u({},Pt.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=new((n=this).options.inputClass||(j?tt:F?ot:k?st:Z))(n,V),this.touchAction=new pt(this,this.options.touchAction),Mt(this,!0),v(this.options.recognizers,(function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])}),this)}function Mt(t,e){var n,r=t.element;r.style&&(v(t.options.cssProps,(function(i,o){n=N(r.style,o),e?(t.oldCssProps[n]=r.style[n],r.style[n]=i):r.style[n]=t.oldCssProps[n]||""})),e||(t.oldCssProps={}))}Ct.prototype={set:function(t){return u(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?2:1},recognize:function(t){var e=this.session;if(!e.stopped){var n;this.touchAction.preventDefaults(t);var r=this.recognizers,i=e.curRecognizer;(!i||i&&8&i.state)&&(i=e.curRecognizer=null);for(var o=0;o<r.length;)n=r[o],2===e.stopped||i&&n!=i&&!n.canRecognizeWith(i)?n.reset():n.recognize(t),!i&&14&n.state&&(i=e.curRecognizer=n),o++}},get:function(t){if(t instanceof gt)return t;for(var e=this.recognizers,n=0;n<e.length;n++)if(e[n].options.event==t)return e[n];return null},add:function(t){if(g(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(g(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,n=I(e,t);-1!==n&&(e.splice(n,1),this.touchAction.update())}return this},on:function(t,e){if(void 0!==t&&void 0!==e){var n=this.handlers;return v(M(t),(function(t){n[t]=n[t]||[],n[t].push(e)})),this}},off:function(t,e){if(void 0!==t){var n=this.handlers;return v(M(t),(function(t){e?n[t]&&n[t].splice(I(n[t],e),1):delete n[t]})),this}},emit:function(t,e){this.options.domEvents&&function(t,e){var n=o.createEvent("Event");n.initEvent(t,!0,!0),n.gesture=e,e.target.dispatchEvent(n)}(t,e);var n=this.handlers[t]&&this.handlers[t].slice();if(n&&n.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var r=0;r<n.length;)n[r](e),r++}},destroy:function(){this.element&&Mt(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},u(Pt,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:Ct,Input:z,TouchAction:pt,TouchInput:ot,MouseInput:Z,PointerEventInput:tt,TouchMouseInput:st,SingleTouchInput:nt,Recognizer:gt,AttrRecognizer:bt,Tap:Ot,Pan:_t,Swipe:St,Pinch:xt,Rotate:Et,Press:wt,on:S,off:O,each:v,merge:b,extend:m,assign:u,inherit:_,bindFn:x,prefixed:N}),(void 0!==i?i:"undefined"!=typeof self?self:{}).Hammer=Pt,void 0===(r=function(){return Pt}.call(e,n,e,t))||(t.exports=r)}(window,document)},,function(t,e,n){t.exports={default:n(306),__esModule:!0}},function(t,e){t.exports=!0},function(t,e){var n=0,r=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+r).toString(36))}},function(t,e,n){"use strict";var r=n(316)(!0);n(195)(String,"String",(function(t){this._t=String(t),this._i=0}),(function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=r(e,n),this._i+=t.length,{value:t,done:!1})}))},function(t,e){e.f={}.propertyIsEnumerable},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(53),i=n(86),o=n(133),a=n(58),s=n.n(a);function u(t,e){s()(t instanceof r.a||t instanceof i.a||t instanceof o.a);var n=t.constructor,a=t.gl,u=t.width,c=t.height,l=t.format,f=t.type,h=t.dataFormat,d=t.border,p=t.mipmaps;return new n(a,Object.assign({width:u,height:c,format:l,type:f,dataFormat:h,border:d,mipmaps:p},e))}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(21);function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=r.d.navigator||{},n=t.userAgent||e.userAgent||"",i=-1!==n.indexOf("MSIE "),o=-1!==n.indexOf("Trident/");return i||o}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(36);function i(t,e,n,i){var o="See luma.gl ".concat(n," Upgrade Guide at http://uber.github.io/luma.gl/#/documentation/overview/upgrade-guide"),a=Object.getPrototypeOf(t);i.forEach((function(t){a.methodName||(a[t]=function(){throw r.a.removed("Calling removed method ".concat(e,".").concat(t,": "),o),new Error(t)})}))}},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,n){!function(t){"use strict";function e(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}function n(){}function r(){}function i(){}function o(){}function a(){}function s(){}function u(){}function c(t){this.name="RuntimeException",this.message=t,this.stack=(new Error).stack,Error.call(this,t)}function l(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t}function f(){if(0===arguments.length)c.call(this);else if(1===arguments.length){var t=arguments[0];c.call(this,t)}}function h(){}function d(){if(this.x=null,this.y=null,this.z=null,0===arguments.length)d.call(this,0,0);else if(1===arguments.length){var t=arguments[0];d.call(this,t.x,t.y,t.z)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];d.call(this,e,n,d.NULL_ORDINATE)}else if(3===arguments.length){var r=arguments[0],i=arguments[1],o=arguments[2];this.x=r,this.y=i,this.z=o}}function p(){if(this.dimensionsToTest=2,0===arguments.length)p.call(this,2);else if(1===arguments.length){var t=arguments[0];if(2!==t&&3!==t)throw new r("only 2 or 3 dimensions may be specified");this.dimensionsToTest=t}}function g(){}function v(){}function y(t){this.message=t||""}function m(){}function b(t){this.message=t||""}function _(t){this.message=t||""}function x(){this.array_=[],arguments[0]instanceof v&&this.addAll(arguments[0])}function w(){if(x.apply(this),0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.ensureCapacity(t.length),this.add(t,!0)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.ensureCapacity(e.length),this.add(e,n)}}function E(){if(this.minx=null,this.maxx=null,this.miny=null,this.maxy=null,0===arguments.length)this.init();else if(1===arguments.length){if(arguments[0]instanceof d){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof E){var e=arguments[0];this.init(e)}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];this.init(n.x,r.x,n.y,r.y)}else if(4===arguments.length){var i=arguments[0],o=arguments[1],a=arguments[2],s=arguments[3];this.init(i,o,a,s)}}function S(){}function O(){S.call(this,"Projective point not representable on the Cartesian plane.")}function P(){}function C(t,e){return t.interfaces_&&t.interfaces_().indexOf(e)>-1}function M(){}function I(t){this.str=t}function A(t){this.value=t}function T(){}function N(){if(this.hi=0,this.lo=0,0===arguments.length)this.init(0);else if(1===arguments.length){if("number"==typeof arguments[0]){var t=arguments[0];this.init(t)}else if(arguments[0]instanceof N){var e=arguments[0];this.init(e)}else if("string"==typeof arguments[0]){var n=arguments[0];N.call(this,N.parse(n))}}else if(2===arguments.length){var r=arguments[0],i=arguments[1];this.init(r,i)}}function L(){}function R(){}function k(){}function j(){if(this.x=null,this.y=null,this.w=null,0===arguments.length)this.x=0,this.y=0,this.w=1;else if(1===arguments.length){var t=arguments[0];this.x=t.x,this.y=t.y,this.w=1}else if(2===arguments.length){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var e=arguments[0],n=arguments[1];this.x=e,this.y=n,this.w=1}else if(arguments[0]instanceof j&&arguments[1]instanceof j){var r=arguments[0],i=arguments[1];this.x=r.y*i.w-i.y*r.w,this.y=i.x*r.w-r.x*i.w,this.w=r.x*i.y-i.x*r.y}else if(arguments[0]instanceof d&&arguments[1]instanceof d){var o=arguments[0],a=arguments[1];this.x=o.y-a.y,this.y=a.x-o.x,this.w=o.x*a.y-a.x*o.y}}else if(3===arguments.length){var s=arguments[0],u=arguments[1],c=arguments[2];this.x=s,this.y=u,this.w=c}else if(4===arguments.length){var l=arguments[0],f=arguments[1],h=arguments[2],p=arguments[3],g=l.y-f.y,v=f.x-l.x,y=l.x*f.y-f.x*l.y,m=h.y-p.y,b=p.x-h.x,_=h.x*p.y-p.x*h.y;this.x=v*_-b*y,this.y=m*y-g*_,this.w=g*b-m*v}}function F(){}function D(){}function B(){this.envelope=null,this.factory=null,this.SRID=null,this.userData=null;var t=arguments[0];this.factory=t,this.SRID=t.getSRID()}function z(){}function V(){}function G(){}function U(){}function W(){}function q(){}function X(){}function H(){}function Y(){}function Z(){}function K(){}function J(){}function Q(){this.array_=[],arguments[0]instanceof v&&this.addAll(arguments[0])}function $(t){return null==t?Vo:t.color}function tt(t){return null==t?null:t.parent}function et(t,e){null!==t&&(t.color=e)}function nt(t){return null==t?null:t.left}function rt(t){return null==t?null:t.right}function it(){this.root_=null,this.size_=0}function ot(){}function at(){}function st(){this.array_=[],arguments[0]instanceof v&&this.addAll(arguments[0])}function ut(){}function ct(){}function lt(){}function ft(){}function ht(){this.geometries=null;var t=arguments[0],e=arguments[1];if(B.call(this,e),null===t&&(t=[]),B.hasNullElements(t))throw new r("geometries must not contain null elements");this.geometries=t}function dt(){var t=arguments[0],e=arguments[1];ht.call(this,t,e)}function pt(){if(this.geom=null,this.geomFact=null,this.bnRule=null,this.endpointMap=null,1===arguments.length){var t=arguments[0];pt.call(this,t,V.MOD2_BOUNDARY_RULE)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.geom=e,this.geomFact=e.getFactory(),this.bnRule=n}}function gt(){this.count=null}function vt(){}function yt(){}function mt(){}function bt(){}function _t(){}function xt(){}function wt(){}function Et(){this.points=null;var t=arguments[0],e=arguments[1];B.call(this,e),this.init(t)}function St(){}function Ot(){this.coordinates=null;var t=arguments[0],e=arguments[1];B.call(this,e),this.init(t)}function Pt(){}function Ct(){this.shell=null,this.holes=null;var t=arguments[0],e=arguments[1],n=arguments[2];if(B.call(this,n),null===t&&(t=this.getFactory().createLinearRing()),null===e&&(e=[]),B.hasNullElements(e))throw new r("holes must not contain null elements");if(t.isEmpty()&&B.hasNonEmptyElements(e))throw new r("shell is empty but holes are not");this.shell=t,this.holes=e}function Mt(){var t=arguments[0],e=arguments[1];ht.call(this,t,e)}function It(){if(arguments[0]instanceof d&&arguments[1]instanceof Xt){var t=arguments[0],e=arguments[1];It.call(this,e.getCoordinateSequenceFactory().create(t),e)}else if(C(arguments[0],R)&&arguments[1]instanceof Xt){var n=arguments[0],r=arguments[1];Et.call(this,n,r),this.validateConstruction()}}function At(){var t=arguments[0],e=arguments[1];ht.call(this,t,e)}function Tt(){if(this.factory=null,this.isUserDataCopied=!1,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.factory=t}}function Nt(){}function Lt(){}function Rt(){}function kt(){}function jt(){if(this.dimension=3,this.coordinates=null,1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];jt.call(this,t,3)}else if(Number.isInteger(arguments[0])){var e=arguments[0];this.coordinates=new Array(e).fill(null);for(var n=0;n<e;n++)this.coordinates[n]=new d}else if(C(arguments[0],R)){var r=arguments[0];if(null===r)return this.coordinates=new Array(0).fill(null),null;for(this.dimension=r.getDimension(),this.coordinates=new Array(r.size()).fill(null),n=0;n<this.coordinates.length;n++)this.coordinates[n]=r.getCoordinateCopy(n)}}else if(2===arguments.length)if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var i=arguments[0],o=arguments[1];this.coordinates=i,this.dimension=o,null===i&&(this.coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var a=arguments[0],s=arguments[1];for(this.coordinates=new Array(a).fill(null),this.dimension=s,n=0;n<a;n++)this.coordinates[n]=new d}}function Ft(){}function Dt(t,e){return t===e||t!=t&&e!=e}function Bt(t){this.add?t.forEach(this.add,this):t.forEach((function(t){this.set(t[0],t[1])}),this)}function zt(t,e){if(this.objectOnly&&e!==Object(e))throw new TypeError("Invalid value used as weak collection key");if(e!=e||0===e)for(Uo=t.length;Uo--&&!Dt(t[Uo],e););else Uo=t.indexOf(e);return Uo>-1}function Vt(t,e,n){var r=[0],i=!1;return t.push(r),{next:function(){var o,a=r[0];return!i&&a<e.length?(o=n?[e[a],n[a]]:e[a],r[0]++):(i=!0,t.splice(t.indexOf(r),1)),{done:i,value:o}}}}function Gt(){return this._values.length}function Ut(){this.map_=new Xo}function Wt(){if(this.modelType=null,this.scale=null,0===arguments.length)this.modelType=Wt.FLOATING;else if(1===arguments.length)if(arguments[0]instanceof qt){var t=arguments[0];this.modelType=t,t===Wt.FIXED&&this.setScale(1)}else if("number"==typeof arguments[0]){var e=arguments[0];this.modelType=Wt.FIXED,this.setScale(e)}else if(arguments[0]instanceof Wt){var n=arguments[0];this.modelType=n.modelType,this.scale=n.scale}}function qt(){this.name=null;var t=arguments[0];this.name=t,qt.nameToTypeMap.put(t,this)}function Xt(){if(this.precisionModel=null,this.coordinateSequenceFactory=null,this.SRID=null,0===arguments.length)Xt.call(this,new Wt,0);else if(1===arguments.length){if(C(arguments[0],F)){var t=arguments[0];Xt.call(this,new Wt,0,t)}else if(arguments[0]instanceof Wt){var e=arguments[0];Xt.call(this,e,0,Xt.getDefaultCoordinateSequenceFactory())}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];Xt.call(this,n,r,Xt.getDefaultCoordinateSequenceFactory())}else if(3===arguments.length){var i=arguments[0],o=arguments[1],a=arguments[2];this.precisionModel=i,this.coordinateSequenceFactory=a,this.SRID=o}}function Ht(t){this.geometryFactory=t||new Xt}function Yt(t){this.parser=new Ht(t)}function Zt(){this.result=null,this.inputLines=Array(2).fill().map((function(){return Array(2)})),this.intPt=new Array(2).fill(null),this.intLineIndex=null,this._isProper=null,this.pa=null,this.pb=null,this.precisionModel=null,this.intPt[0]=new d,this.intPt[1]=new d,this.pa=this.intPt[0],this.pb=this.intPt[1],this.result=0}function Kt(){Zt.apply(this)}function Jt(){}function Qt(){this.p=null,this.crossingCount=0,this.isPointOnSegment=!1;var t=arguments[0];this.p=t}function $t(){}function te(){if(this.p0=null,this.p1=null,0===arguments.length)te.call(this,new d,new d);else if(1===arguments.length){var t=arguments[0];te.call(this,t.p0,t.p1)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.p0=e,this.p1=n}else if(4===arguments.length){var r=arguments[0],i=arguments[1],o=arguments[2],a=arguments[3];te.call(this,new d(r,i),new d(o,a))}}function ee(){if(this.matrix=null,0===arguments.length)this.matrix=Array(3).fill().map((function(){return Array(3)})),this.setAll(ct.FALSE);else if(1===arguments.length)if("string"==typeof arguments[0]){var t=arguments[0];ee.call(this),this.set(t)}else if(arguments[0]instanceof ee){var e=arguments[0];ee.call(this),this.matrix[P.INTERIOR][P.INTERIOR]=e.matrix[P.INTERIOR][P.INTERIOR],this.matrix[P.INTERIOR][P.BOUNDARY]=e.matrix[P.INTERIOR][P.BOUNDARY],this.matrix[P.INTERIOR][P.EXTERIOR]=e.matrix[P.INTERIOR][P.EXTERIOR],this.matrix[P.BOUNDARY][P.INTERIOR]=e.matrix[P.BOUNDARY][P.INTERIOR],this.matrix[P.BOUNDARY][P.BOUNDARY]=e.matrix[P.BOUNDARY][P.BOUNDARY],this.matrix[P.BOUNDARY][P.EXTERIOR]=e.matrix[P.BOUNDARY][P.EXTERIOR],this.matrix[P.EXTERIOR][P.INTERIOR]=e.matrix[P.EXTERIOR][P.INTERIOR],this.matrix[P.EXTERIOR][P.BOUNDARY]=e.matrix[P.EXTERIOR][P.BOUNDARY],this.matrix[P.EXTERIOR][P.EXTERIOR]=e.matrix[P.EXTERIOR][P.EXTERIOR]}}function ne(){this.areaBasePt=null,this.triangleCent3=new d,this.areasum2=0,this.cg3=new d,this.lineCentSum=new d,this.totalLength=0,this.ptCount=0,this.ptCentSum=new d;var t=arguments[0];this.areaBasePt=null,this.add(t)}function re(t){this.message=t||""}function ie(){this.array_=[]}function oe(){this.treeSet=new st,this.list=new x}function ae(){if(this.geomFactory=null,this.inputPts=null,1===arguments.length){var t=arguments[0];ae.call(this,ae.extractCoordinates(t),t.getFactory())}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.inputPts=oe.filterCoordinates(e),this.geomFactory=n}}function se(){this.origin=null;var t=arguments[0];this.origin=t}function ue(){this.inputGeom=null,this.factory=null,this.pruneEmptyGeometry=!0,this.preserveGeometryCollectionType=!0,this.preserveCollections=!1,this.preserveType=!1}function ce(){if(this.snapTolerance=0,this.srcPts=null,this.seg=new te,this.allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof Et&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];ce.call(this,t.getCoordinates(),e)}else if(arguments[0]instanceof Array&&"number"==typeof arguments[1]){var n=arguments[0],r=arguments[1];this.srcPts=n,this._isClosed=ce.isClosed(n),this.snapTolerance=r}}function le(){this.srcGeom=null;var t=arguments[0];this.srcGeom=t}function fe(){if(ue.apply(this),this.snapTolerance=null,this.snapPts=null,this.isSelfSnap=!1,2===arguments.length){var t=arguments[0],e=arguments[1];this.snapTolerance=t,this.snapPts=e}else if(3===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2];this.snapTolerance=n,this.snapPts=r,this.isSelfSnap=i}}function he(){this.isFirst=!0,this.commonMantissaBitsCount=53,this.commonBits=0,this.commonSignExp=null}function de(){this.commonCoord=null,this.ccFilter=new pe}function pe(){this.commonBitsX=new he,this.commonBitsY=new he}function ge(){this.trans=null;var t=arguments[0];this.trans=t}function ve(){this.parent=null,this.atStart=null,this.max=null,this.index=null,this.subcollectionIterator=null;var t=arguments[0];this.parent=t,this.atStart=!0,this.index=0,this.max=t.getNumGeometries()}function ye(){if(this.boundaryRule=V.OGC_SFS_BOUNDARY_RULE,this.isIn=null,this.numBoundaries=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];if(null===t)throw new r("Rule must be non-null");this.boundaryRule=t}}function me(){}function be(){}function _e(){this.pts=null,this.data=null;var t=arguments[0],e=arguments[1];this.pts=t,this.data=e}function xe(){}function we(){this.bounds=null,this.item=null;var t=arguments[0],e=arguments[1];this.bounds=t,this.item=e}function Ee(){this._size=null,this.items=null,this._size=0,this.items=new x,this.items.add(null)}function Se(){}function Oe(){}function Pe(){if(this.childBoundables=new x,this.bounds=null,this.level=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.level=t}}function Ce(){this.boundable1=null,this.boundable2=null,this._distance=null,this.itemDistance=null;var t=arguments[0],e=arguments[1],n=arguments[2];this.boundable1=t,this.boundable2=e,this.itemDistance=n,this._distance=this.distance()}function Me(){if(this.root=null,this.built=!1,this.itemBoundables=new x,this.nodeCapacity=null,0===arguments.length)Me.call(this,Me.DEFAULT_NODE_CAPACITY);else if(1===arguments.length){var t=arguments[0];h.isTrue(t>1,"Node capacity must be greater than 1"),this.nodeCapacity=t}}function Ie(){}function Ae(){if(0===arguments.length)Ae.call(this,Ae.DEFAULT_NODE_CAPACITY);else if(1===arguments.length){var t=arguments[0];Me.call(this,t)}}function Te(){var t=arguments[0];Pe.call(this,t)}function Ne(){}function Le(){this.segString=null,this.coord=null,this.segmentIndex=null,this.segmentOctant=null,this._isInterior=null;var t=arguments[0],e=arguments[1],n=arguments[2],r=arguments[3];this.segString=t,this.coord=new d(e),this.segmentIndex=n,this.segmentOctant=r,this._isInterior=!e.equals2D(t.getCoordinate(n))}function Re(){this.nodeMap=new it,this.edge=null;var t=arguments[0];this.edge=t}function ke(){this.nodeList=null,this.edge=null,this.nodeIt=null,this.currNode=null,this.nextNode=null,this.currSegIndex=0;var t=arguments[0];this.nodeList=t,this.edge=t.getEdge(),this.nodeIt=t.iterator(),this.readNextNode()}function je(){}function Fe(){this.nodeList=new Re(this),this.pts=null,this.data=null;var t=arguments[0],e=arguments[1];this.pts=t,this.data=e}function De(){this.tempEnv1=new E,this.tempEnv2=new E,this.overlapSeg1=new te,this.overlapSeg2=new te}function Be(){this.pts=null,this.start=null,this.end=null,this.env=null,this.context=null,this.id=null;var t=arguments[0],e=arguments[1],n=arguments[2],r=arguments[3];this.pts=t,this.start=e,this.end=n,this.context=r}function ze(){}function Ve(){}function Ge(){}function Ue(){if(this.segInt=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.setSegmentIntersector(t)}}function We(){if(this.monoChains=new x,this.index=new Ae,this.idCounter=0,this.nodedSegStrings=null,this.nOverlaps=0,0===arguments.length);else if(1===arguments.length){var t=arguments[0];Ue.call(this,t)}}function qe(){De.apply(this),this.si=null;var t=arguments[0];this.si=t}function Xe(){if(this.pt=null,1===arguments.length){var t=arguments[0];c.call(this,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];c.call(this,Xe.msgWithCoord(e,n)),this.name="TopologyException",this.pt=new d(n)}}function He(){}function Ye(){this.findAllIntersections=!1,this.isCheckEndSegmentsOnly=!1,this.li=null,this.interiorIntersection=null,this.intSegments=null,this.intersections=new x,this.intersectionCount=0,this.keepIntersections=!0;var t=arguments[0];this.li=t,this.interiorIntersection=null}function Ze(){this.li=new Kt,this.segStrings=null,this.findAllIntersections=!1,this.segInt=null,this._isValid=!0;var t=arguments[0];this.segStrings=t}function Ke(){this.nv=null;var t=arguments[0];this.nv=new Ze(Ke.toSegmentStrings(t))}function Je(){this.mapOp=null;var t=arguments[0];this.mapOp=t}function Qe(){}function $e(){if(this.location=null,1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];this.init(t.length)}else if(Number.isInteger(arguments[0])){var e=arguments[0];this.init(1),this.location[Qe.ON]=e}else if(arguments[0]instanceof $e){var n=arguments[0];if(this.init(n.location.length),null!==n)for(var r=0;r<this.location.length;r++)this.location[r]=n.location[r]}}else if(3===arguments.length){var i=arguments[0],o=arguments[1],a=arguments[2];this.init(3),this.location[Qe.ON]=i,this.location[Qe.LEFT]=o,this.location[Qe.RIGHT]=a}}function tn(){if(this.elt=new Array(2).fill(null),1===arguments.length){if(Number.isInteger(arguments[0])){var t=arguments[0];this.elt[0]=new $e(t),this.elt[1]=new $e(t)}else if(arguments[0]instanceof tn){var e=arguments[0];this.elt[0]=new $e(e.elt[0]),this.elt[1]=new $e(e.elt[1])}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];this.elt[0]=new $e(P.NONE),this.elt[1]=new $e(P.NONE),this.elt[n].setLocation(r)}else if(3===arguments.length){var i=arguments[0],o=arguments[1],a=arguments[2];this.elt[0]=new $e(i,o,a),this.elt[1]=new $e(i,o,a)}else if(4===arguments.length){var s=arguments[0],u=arguments[1],c=arguments[2],l=arguments[3];this.elt[0]=new $e(P.NONE,P.NONE,P.NONE),this.elt[1]=new $e(P.NONE,P.NONE,P.NONE),this.elt[s].setLocations(u,c,l)}}function en(){this.startDe=null,this.maxNodeDegree=-1,this.edges=new x,this.pts=new x,this.label=new tn(P.NONE),this.ring=null,this._isHole=null,this.shell=null,this.holes=new x,this.geometryFactory=null;var t=arguments[0],e=arguments[1];this.geometryFactory=e,this.computePoints(t),this.computeRing()}function nn(){var t=arguments[0],e=arguments[1];en.call(this,t,e)}function rn(){var t=arguments[0],e=arguments[1];en.call(this,t,e)}function on(){if(this.label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.label=t}}function an(){on.apply(this),this.coord=null,this.edges=null;var t=arguments[0],e=arguments[1];this.coord=t,this.edges=e,this.label=new tn(0,P.NONE)}function sn(){this.nodeMap=new it,this.nodeFact=null;var t=arguments[0];this.nodeFact=t}function un(){if(this.edge=null,this.label=null,this.node=null,this.p0=null,this.p1=null,this.dx=null,this.dy=null,this.quadrant=null,1===arguments.length){var t=arguments[0];this.edge=t}else if(3===arguments.length){var e=arguments[0],n=arguments[1],r=arguments[2];un.call(this,e,n,r,null)}else if(4===arguments.length){var i=arguments[0],o=arguments[1],a=arguments[2],s=arguments[3];un.call(this,i),this.init(o,a),this.label=s}}function cn(){this._isForward=null,this._isInResult=!1,this._isVisited=!1,this.sym=null,this.next=null,this.nextMin=null,this.edgeRing=null,this.minEdgeRing=null,this.depth=[0,-999,-999];var t=arguments[0],e=arguments[1];if(un.call(this,t),this._isForward=e,e)this.init(t.getCoordinate(0),t.getCoordinate(1));else{var n=t.getNumPoints()-1;this.init(t.getCoordinate(n),t.getCoordinate(n-1))}this.computeDirectedLabel()}function ln(){}function fn(){if(this.edges=new x,this.nodes=null,this.edgeEndList=new x,0===arguments.length)this.nodes=new sn(new ln);else if(1===arguments.length){var t=arguments[0];this.nodes=new sn(t)}}function hn(){this.geometryFactory=null,this.shellList=new x;var t=arguments[0];this.geometryFactory=t}function dn(){this.op=null,this.geometryFactory=null,this.ptLocator=null,this.lineEdgesList=new x,this.resultLineList=new x;var t=arguments[0],e=arguments[1],n=arguments[2];this.op=t,this.geometryFactory=e,this.ptLocator=n}function pn(){this.op=null,this.geometryFactory=null,this.resultPointList=new x;var t=arguments[0],e=arguments[1];arguments[2],this.op=t,this.geometryFactory=e}function gn(){}function vn(){this.geom=null;var t=arguments[0];this.geom=t}function yn(){this.edgeMap=new it,this.edgeList=null,this.ptInAreaLocation=[P.NONE,P.NONE]}function mn(){yn.apply(this),this.resultAreaEdgeList=null,this.label=null,this.SCANNING_FOR_INCOMING=1,this.LINKING_TO_OUTGOING=2}function bn(){ln.apply(this)}function _n(){this.mce=null,this.chainIndex=null;var t=arguments[0],e=arguments[1];this.mce=t,this.chainIndex=e}function xn(){if(this.label=null,this.xValue=null,this.eventType=null,this.insertEvent=null,this.deleteEventIndex=null,this.obj=null,2===arguments.length){var t=arguments[0],e=arguments[1];this.eventType=xn.DELETE,this.xValue=t,this.insertEvent=e}else if(3===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2];this.eventType=xn.INSERT,this.label=n,this.xValue=r,this.obj=i}}function wn(){}function En(){this._hasIntersection=!1,this.hasProper=!1,this.hasProperInterior=!1,this.properIntersectionPoint=null,this.li=null,this.includeProper=null,this.recordIsolated=null,this.isSelfIntersection=null,this.numIntersections=0,this.numTests=0,this.bdyNodes=null,this._isDone=!1,this.isDoneWhenProperInt=!1;var t=arguments[0],e=arguments[1],n=arguments[2];this.li=t,this.includeProper=e,this.recordIsolated=n}function Sn(){wn.apply(this),this.events=new x,this.nOverlaps=null}function On(){this.min=i.POSITIVE_INFINITY,this.max=i.NEGATIVE_INFINITY}function Pn(){}function Cn(){On.apply(this),this.item=null;var t=arguments[0],e=arguments[1],n=arguments[2];this.min=t,this.max=e,this.item=n}function Mn(){On.apply(this),this.node1=null,this.node2=null;var t=arguments[0],e=arguments[1];this.node1=t,this.node2=e,this.buildExtent(this.node1,this.node2)}function In(){this.leaves=new x,this.root=null,this.level=0}function An(){if(this.lines=null,this.isForcedToLineString=!1,1===arguments.length){var t=arguments[0];this.lines=t}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.lines=e,this.isForcedToLineString=n}}function Tn(){this.items=new x}function Nn(){this.index=null;var t=arguments[0];if(!C(t,Pt))throw new r("Argument must be Polygonal");this.index=new Rn(t)}function Ln(){this.counter=null;var t=arguments[0];this.counter=t}function Rn(){this.index=new In;var t=arguments[0];this.init(t)}function kn(){this.coord=null,this.segmentIndex=null,this.dist=null;var t=arguments[0],e=arguments[1],n=arguments[2];this.coord=new d(t),this.segmentIndex=e,this.dist=n}function jn(){this.nodeMap=new it,this.edge=null;var t=arguments[0];this.edge=t}function Fn(){}function Dn(){this.e=null,this.pts=null,this.startIndex=null,this.env1=new E,this.env2=new E;var t=arguments[0];this.e=t,this.pts=t.getCoordinates();var e=new Fn;this.startIndex=e.getChainStartIndices(this.pts)}function Bn(){this.depth=Array(2).fill().map((function(){return Array(3)}));for(var t=0;t<2;t++)for(var e=0;e<3;e++)this.depth[t][e]=Bn.NULL_VALUE}function zn(){if(on.apply(this),this.pts=null,this.env=null,this.eiList=new jn(this),this.name=null,this.mce=null,this._isIsolated=!0,this.depth=new Bn,this.depthDelta=0,1===arguments.length){var t=arguments[0];zn.call(this,t,null)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.pts=e,this.label=n}}function Vn(){if(fn.apply(this),this.parentGeom=null,this.lineEdgeMap=new Ut,this.boundaryNodeRule=null,this.useBoundaryDeterminationRule=!0,this.argIndex=null,this.boundaryNodes=null,this._hasTooFewPoints=!1,this.invalidPoint=null,this.areaPtLocator=null,this.ptLocator=new ye,2===arguments.length){var t=arguments[0],e=arguments[1];Vn.call(this,t,e,V.OGC_SFS_BOUNDARY_RULE)}else if(3===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2];this.argIndex=n,this.parentGeom=r,this.boundaryNodeRule=i,null!==r&&this.add(r)}}function Gn(){if(this.li=new Kt,this.resultPrecisionModel=null,this.arg=null,1===arguments.length){var t=arguments[0];this.setComputationPrecision(t.getPrecisionModel()),this.arg=new Array(1).fill(null),this.arg[0]=new Vn(0,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];Gn.call(this,e,n,V.OGC_SFS_BOUNDARY_RULE)}else if(3===arguments.length){var r=arguments[0],i=arguments[1],o=arguments[2];r.getPrecisionModel().compareTo(i.getPrecisionModel())>=0?this.setComputationPrecision(r.getPrecisionModel()):this.setComputationPrecision(i.getPrecisionModel()),this.arg=new Array(2).fill(null),this.arg[0]=new Vn(0,r,o),this.arg[1]=new Vn(1,i,o)}}function Un(){this.pts=null,this._orientation=null;var t=arguments[0];this.pts=t,this._orientation=Un.orientation(t)}function Wn(){this.edges=new x,this.ocaMap=new it}function qn(){this.ptLocator=new ye,this.geomFact=null,this.resultGeom=null,this.graph=null,this.edgeList=new Wn,this.resultPolyList=new x,this.resultLineList=new x,this.resultPointList=new x;var t=arguments[0],e=arguments[1];Gn.call(this,t,e),this.graph=new fn(new bn),this.geomFact=t.getFactory()}function Xn(){this.geom=new Array(2).fill(null),this.snapTolerance=null,this.cbr=null;var t=arguments[0],e=arguments[1];this.geom[0]=t,this.geom[1]=e,this.computeSnapTolerance()}function Hn(){this.geom=new Array(2).fill(null);var t=arguments[0],e=arguments[1];this.geom[0]=t,this.geom[1]=e}function Yn(){this.factory=null,this.interiorPoint=null,this.maxWidth=0;var t=arguments[0];this.factory=t.getFactory(),this.add(t)}function Zn(){this.poly=null,this.centreY=null,this.hiY=i.MAX_VALUE,this.loY=-i.MAX_VALUE;var t=arguments[0];this.poly=t,this.hiY=t.getEnvelopeInternal().getMaxY(),this.loY=t.getEnvelopeInternal().getMinY(),this.centreY=Yn.avg(this.loY,this.hiY)}function Kn(){this.centroid=null,this.minDistance=i.MAX_VALUE,this.interiorPoint=null;var t=arguments[0];this.centroid=t.getCentroid().getCoordinate(),this.addInterior(t),null===this.interiorPoint&&this.addEndpoints(t)}function Jn(){this.centroid=null,this.minDistance=i.MAX_VALUE,this.interiorPoint=null;var t=arguments[0];this.centroid=t.getCentroid().getCoordinate(),this.add(t)}function Qn(){this.tempEnv1=new E,this.selectedSegment=new te}function $n(){this.items=new x,this.subnode=[null,null]}function tr(){if(this.min=null,this.max=null,0===arguments.length)this.min=0,this.max=0;else if(1===arguments.length){var t=arguments[0];this.init(t.min,t.max)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.init(e,n)}}function er(){}function nr(){this.pt=0,this.level=0,this.interval=null;var t=arguments[0];this.computeKey(t)}function rr(){$n.apply(this),this.interval=null,this.centre=null,this.level=null;var t=arguments[0],e=arguments[1];this.interval=t,this.level=e,this.centre=(t.getMin()+t.getMax())/2}function ir(){}function or(){$n.apply(this)}function ar(){this.root=null,this.minExtent=1,this.root=new or}function sr(){}function ur(){this.ring=null,this.tree=null,this.crossings=0,this.interval=new tr;var t=arguments[0];this.ring=t,this.buildIndex()}function cr(){Qn.apply(this),this.mcp=null,this.p=null;var t=arguments[0],e=arguments[1];this.mcp=t,this.p=e}function lr(){}function fr(){this.p0=null,this.p1=null,this.p2=null;var t=arguments[0],e=arguments[1],n=arguments[2];this.p0=t,this.p1=e,this.p2=n}function hr(){this.input=null,this.extremalPts=null,this.centre=null,this.radius=0;var t=arguments[0];this.input=t}function dr(){if(this.inputGeom=null,this.isConvex=null,this.convexHullPts=null,this.minBaseSeg=new te,this.minWidthPt=null,this.minPtIndex=null,this.minWidth=0,1===arguments.length){var t=arguments[0];dr.call(this,t,!1)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.inputGeom=e,this.isConvex=n}}function pr(){this.inputGeom=null,this.distanceTolerance=null;var t=arguments[0];this.inputGeom=t}function gr(){ue.apply(this),this.distanceTolerance=null;var t=arguments[0];this.distanceTolerance=t}function vr(){this._orig=null,this._sym=null,this._next=null;var t=arguments[0];this._orig=t}function yr(){this._isMarked=!1;var t=arguments[0];vr.call(this,t)}function mr(){this.vertexMap=new Ut}function br(){this._isStart=!1;var t=arguments[0];yr.call(this,t)}function _r(){mr.apply(this)}function xr(){this.result=null,this.factory=null,this.graph=null,this.lines=new x,this.nodeEdgeStack=new ie,this.ringStartEdge=null,this.graph=new _r}function wr(){this.items=new x,this.subnode=new Array(4).fill(null)}function Er(){this.pt=new d,this.level=0,this.env=null;var t=arguments[0];this.computeKey(t)}function Sr(){wr.apply(this),this.env=null,this.centrex=null,this.centrey=null,this.level=null;var t=arguments[0],e=arguments[1];this.env=t,this.level=e,this.centrex=(t.getMinX()+t.getMaxX())/2,this.centrey=(t.getMinY()+t.getMaxY())/2}function Or(){wr.apply(this)}function Pr(){this.root=null,this.minExtent=1,this.root=new Or}function Cr(t){this.geometryFactory=t||new Xt}function Mr(t){this.geometryFactory=t||new Xt,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new Cr(this.geometryFactory)}function Ir(){this.parser=new Cr(this.geometryFactory)}function Ar(t){this.geometryFactory=t||new Xt,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new Ht(this.geometryFactory)}function Tr(t){return[t.x,t.y]}function Nr(t,e){this.geometryFactory=t||new Xt,this.ol=e||"undefined"!=typeof ol&&ol}function Lr(){if(this.noder=null,this.scaleFactor=null,this.offsetX=null,this.offsetY=null,this.isScaled=!1,2===arguments.length){var t=arguments[0],e=arguments[1];Lr.call(this,t,e,0,0)}else if(4===arguments.length){var n=arguments[0],r=arguments[1];arguments[2],arguments[3],this.noder=n,this.scaleFactor=r,this.isScaled=!this.isIntegerPrecision()}}function Rr(){if(this.inputGeom=null,this.isClosedEndpointsInInterior=!0,this.nonSimpleLocation=null,1===arguments.length){var t=arguments[0];this.inputGeom=t}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.inputGeom=e,this.isClosedEndpointsInInterior=!n.isInBoundary(2)}}function kr(){this.pt=null,this.isClosed=null,this.degree=null;var t=arguments[0];this.pt=t,this.isClosed=!1,this.degree=0}function jr(){if(this.quadrantSegments=jr.DEFAULT_QUADRANT_SEGMENTS,this.endCapStyle=jr.CAP_ROUND,this.joinStyle=jr.JOIN_ROUND,this.mitreLimit=jr.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this.simplifyFactor=jr.DEFAULT_SIMPLIFY_FACTOR,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.setQuadrantSegments(t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.setQuadrantSegments(e),this.setEndCapStyle(n)}else if(4===arguments.length){var r=arguments[0],i=arguments[1],o=arguments[2],a=arguments[3];this.setQuadrantSegments(r),this.setEndCapStyle(i),this.setJoinStyle(o),this.setMitreLimit(a)}}function Fr(){this.minIndex=-1,this.minCoord=null,this.minDe=null,this.orientedDe=null}function Dr(){this.array_=[]}function Br(){this.finder=null,this.dirEdgeList=new x,this.nodes=new x,this.rightMostCoord=null,this.env=null,this.finder=new Fr}function zr(){this.inputLine=null,this.distanceTol=null,this.isDeleted=null,this.angleOrientation=$t.COUNTERCLOCKWISE;var t=arguments[0];this.inputLine=t}function Vr(){this.ptList=null,this.precisionModel=null,this.minimimVertexDistance=0,this.ptList=new x}function Gr(){this.maxCurveSegmentError=0,this.filletAngleQuantum=null,this.closingSegLengthFactor=1,this.segList=null,this.distance=0,this.precisionModel=null,this.bufParams=null,this.li=null,this.s0=null,this.s1=null,this.s2=null,this.seg0=new te,this.seg1=new te,this.offset0=new te,this.offset1=new te,this.side=0,this._hasNarrowConcaveAngle=!1;var t=arguments[0],e=arguments[1],n=arguments[2];this.precisionModel=t,this.bufParams=e,this.li=new Kt,this.filletAngleQuantum=Math.PI/2/e.getQuadrantSegments(),e.getQuadrantSegments()>=8&&e.getJoinStyle()===jr.JOIN_ROUND&&(this.closingSegLengthFactor=Gr.MAX_CLOSING_SEG_LEN_FACTOR),this.init(n)}function Ur(){this.distance=0,this.precisionModel=null,this.bufParams=null;var t=arguments[0],e=arguments[1];this.precisionModel=t,this.bufParams=e}function Wr(){this.subgraphs=null,this.seg=new te,this.cga=new $t;var t=arguments[0];this.subgraphs=t}function qr(){this.upwardSeg=null,this.leftDepth=null;var t=arguments[0],e=arguments[1];this.upwardSeg=new te(t),this.leftDepth=e}function Xr(){this.inputGeom=null,this.distance=null,this.curveBuilder=null,this.curveList=new x;var t=arguments[0],e=arguments[1],n=arguments[2];this.inputGeom=t,this.distance=e,this.curveBuilder=n}function Hr(){this._hasIntersection=!1,this.hasProper=!1,this.hasProperInterior=!1,this.hasInterior=!1,this.properIntersectionPoint=null,this.li=null,this.isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var t=arguments[0];this.li=t}function Yr(){this.bufParams=null,this.workingPrecisionModel=null,this.workingNoder=null,this.geomFact=null,this.graph=null,this.edgeList=new Wn;var t=arguments[0];this.bufParams=t}function Zr(){this.li=new Kt,this.segStrings=null;var t=arguments[0];this.segStrings=t}function Kr(){this.li=null,this.pt=null,this.originalPt=null,this.ptScaled=null,this.p0Scaled=null,this.p1Scaled=null,this.scaleFactor=null,this.minx=null,this.maxx=null,this.miny=null,this.maxy=null,this.corner=new Array(4).fill(null),this.safeEnv=null;var t=arguments[0],e=arguments[1],n=arguments[2];if(this.originalPt=t,this.pt=t,this.scaleFactor=e,this.li=n,e<=0)throw new r("Scale factor must be non-zero");1!==e&&(this.pt=new d(this.scale(t.x),this.scale(t.y)),this.p0Scaled=new d,this.p1Scaled=new d),this.initCorners(this.pt)}function Jr(){this.index=null;var t=arguments[0];this.index=t}function Qr(){Qn.apply(this),this.hotPixel=null,this.parentEdge=null,this.hotPixelVertexIndex=null,this._isNodeAdded=!1;var t=arguments[0],e=arguments[1],n=arguments[2];this.hotPixel=t,this.parentEdge=e,this.hotPixelVertexIndex=n}function $r(){this.li=null,this.interiorIntersections=null;var t=arguments[0];this.li=t,this.interiorIntersections=new x}function ti(){this.pm=null,this.li=null,this.scaleFactor=null,this.noder=null,this.pointSnapper=null,this.nodedSegStrings=null;var t=arguments[0];this.pm=t,this.li=new Kt,this.li.setPrecisionModel(t),this.scaleFactor=t.getScale()}function ei(){if(this.argGeom=null,this.distance=null,this.bufParams=new jr,this.resultGeometry=null,this.saveException=null,1===arguments.length){var t=arguments[0];this.argGeom=t}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.argGeom=e,this.bufParams=n}}function ni(){this.comps=null;var t=arguments[0];this.comps=t}function ri(){if(this.component=null,this.segIndex=null,this.pt=null,2===arguments.length){var t=arguments[0],e=arguments[1];ri.call(this,t,ri.INSIDE_AREA,e)}else if(3===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2];this.component=n,this.segIndex=r,this.pt=i}}function ii(){this.pts=null;var t=arguments[0];this.pts=t}function oi(){this.locations=null;var t=arguments[0];this.locations=t}function ai(){if(this.geom=null,this.terminateDistance=0,this.ptLocator=new ye,this.minDistanceLocation=null,this.minDistance=i.MAX_VALUE,2===arguments.length){var t=arguments[0],e=arguments[1];ai.call(this,t,e,0)}else if(3===arguments.length){var n=arguments[0],r=arguments[1],o=arguments[2];this.geom=new Array(2).fill(null),this.geom[0]=n,this.geom[1]=r,this.terminateDistance=o}}function si(){this.factory=null,this.directedEdges=new x,this.coordinates=null;var t=arguments[0];this.factory=t}function ui(){this._isMarked=!1,this._isVisited=!1,this.data=null}function ci(){ui.apply(this),this.parentEdge=null,this.from=null,this.to=null,this.p0=null,this.p1=null,this.sym=null,this.edgeDirection=null,this.quadrant=null,this.angle=null;var t=arguments[0],e=arguments[1],n=arguments[2],r=arguments[3];this.from=t,this.to=e,this.edgeDirection=r,this.p0=t.getCoordinate(),this.p1=n;var i=this.p1.x-this.p0.x,o=this.p1.y-this.p0.y;this.quadrant=ze.quadrant(i,o),this.angle=Math.atan2(o,i)}function li(){var t=arguments[0],e=arguments[1],n=arguments[2],r=arguments[3];ci.call(this,t,e,n,r)}function fi(){if(ui.apply(this),this.dirEdge=null,0===arguments.length);else if(2===arguments.length){var t=arguments[0],e=arguments[1];this.setDirectedEdges(t,e)}}function hi(){this.outEdges=new x,this.sorted=!1}function di(){if(ui.apply(this),this.pt=null,this.deStar=null,1===arguments.length){var t=arguments[0];di.call(this,t,new hi)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.pt=e,this.deStar=n}}function pi(){fi.apply(this),this.line=null;var t=arguments[0];this.line=t}function gi(){this.nodeMap=new it}function vi(){this.edges=new Q,this.dirEdges=new Q,this.nodeMap=new gi}function yi(){vi.apply(this)}function mi(){this.graph=new yi,this.mergedLineStrings=null,this.factory=null,this.edgeStrings=null}function bi(){this.edgeRing=null,this.next=null,this.label=-1;var t=arguments[0],e=arguments[1],n=arguments[2],r=arguments[3];ci.call(this,t,e,n,r)}function _i(){fi.apply(this),this.line=null;var t=arguments[0];this.line=t}function xi(){this.geometryFactory=new Xt,this.geomGraph=null,this.disconnectedRingcoord=null;var t=arguments[0];this.geomGraph=t}function wi(){}function Ei(){if(this.edgeEnds=new x,1===arguments.length){var t=arguments[0];Ei.call(this,null,t)}else if(2===arguments.length){var e=(arguments[0],arguments[1]);un.call(this,e.getEdge(),e.getCoordinate(),e.getDirectedCoordinate(),new tn(e.getLabel())),this.insert(e)}}function Si(){yn.apply(this)}function Oi(){var t=arguments[0],e=arguments[1];an.call(this,t,e)}function Pi(){ln.apply(this)}function Ci(){this.nodes=new sn(new Pi)}function Mi(){this.li=new Kt,this.geomGraph=null,this.nodeGraph=new Ci,this.invalidPoint=null;var t=arguments[0];this.geomGraph=t}function Ii(){this.graph=null,this.rings=new x,this.totalEnv=new E,this.index=null,this.nestedPt=null;var t=arguments[0];this.graph=t}function Ai(){if(this.errorType=null,this.pt=null,1===arguments.length){var t=arguments[0];Ai.call(this,t,null)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.errorType=e,null!==n&&(this.pt=n.copy())}}function Ti(){this.parentGeometry=null,this.isSelfTouchingRingFormingHoleValid=!1,this.validErr=null;var t=arguments[0];this.parentGeometry=t}function Ni(){this.factory=null,this.deList=new x,this.lowestEdge=null,this.ring=null,this.ringPts=null,this.holes=null,this.shell=null,this._isHole=null,this._isProcessed=!1,this._isIncludedSet=!1,this._isIncluded=!1;var t=arguments[0];this.factory=t}function Li(){}function Ri(){vi.apply(this),this.factory=null;var t=arguments[0];this.factory=t}function ki(){if(this.lineStringAdder=new ji(this),this.graph=null,this.dangles=new x,this.cutEdges=new x,this.invalidRingLines=new x,this.holeList=null,this.shellList=null,this.polyList=null,this.isCheckingRingsValid=!0,this.extractOnlyPolygonal=null,this.geomFactory=null,0===arguments.length)ki.call(this,!1);else if(1===arguments.length){var t=arguments[0];this.extractOnlyPolygonal=t}}function ji(){this.p=null;var t=arguments[0];this.p=t}function Fi(){this.li=new Kt,this.ptLocator=new ye,this.arg=null,this.nodes=new sn(new Pi),this.im=null,this.isolatedEdges=new x,this.invalidPoint=null;var t=arguments[0];this.arg=t}function Di(){this.rectEnv=null;var t=arguments[0];this.rectEnv=t.getEnvelopeInternal()}function Bi(){this.li=new Kt,this.rectEnv=null,this.diagUp0=null,this.diagUp1=null,this.diagDown0=null,this.diagDown1=null;var t=arguments[0];this.rectEnv=t,this.diagUp0=new d(t.getMinX(),t.getMinY()),this.diagUp1=new d(t.getMaxX(),t.getMaxY()),this.diagDown0=new d(t.getMinX(),t.getMaxY()),this.diagDown1=new d(t.getMaxX(),t.getMinY())}function zi(){this._isDone=!1}function Vi(){this.rectangle=null,this.rectEnv=null;var t=arguments[0];this.rectangle=t,this.rectEnv=t.getEnvelopeInternal()}function Gi(){zi.apply(this),this.rectEnv=null,this._intersects=!1;var t=arguments[0];this.rectEnv=t}function Ui(){zi.apply(this),this.rectSeq=null,this.rectEnv=null,this._containsPoint=!1;var t=arguments[0];this.rectSeq=t.getExteriorRing().getCoordinateSequence(),this.rectEnv=t.getEnvelopeInternal()}function Wi(){zi.apply(this),this.rectEnv=null,this.rectIntersector=null,this.hasIntersection=!1,this.p0=new d,this.p1=new d;var t=arguments[0];this.rectEnv=t.getEnvelopeInternal(),this.rectIntersector=new Bi(this.rectEnv)}function qi(){if(this._relate=null,2===arguments.length){var t=arguments[0],e=arguments[1];Gn.call(this,t,e),this._relate=new Fi(this.arg)}else if(3===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2];Gn.call(this,n,r,i),this._relate=new Fi(this.arg)}}function Xi(){this.geomFactory=null,this.skipEmpty=!1,this.inputGeoms=null;var t=arguments[0];this.geomFactory=Xi.extractFactory(t),this.inputGeoms=t}function Hi(){this.pointGeom=null,this.otherGeom=null,this.geomFact=null;var t=arguments[0],e=arguments[1];this.pointGeom=t,this.otherGeom=e,this.geomFact=e.getFactory()}function Yi(){this.sortIndex=-1,this.comps=null;var t=arguments[0],e=arguments[1];this.sortIndex=t,this.comps=e}function Zi(){this.inputPolys=null,this.geomFactory=null;var t=arguments[0];this.inputPolys=t,null===this.inputPolys&&(this.inputPolys=new x)}function Ki(){if(this.polygons=new x,this.lines=new x,this.points=new x,this.geomFact=null,1===arguments.length){if(C(arguments[0],v)){var t=arguments[0];this.extract(t)}else if(arguments[0]instanceof B){var e=arguments[0];this.extract(e)}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];this.geomFact=r,this.extract(n)}}function Ji(){Tt.CoordinateOperation.apply(this),this.targetPM=null,this.removeCollapsed=!0;var t=arguments[0],e=arguments[1];this.targetPM=t,this.removeCollapsed=e}function Qi(){this.targetPM=null,this.removeCollapsed=!0,this.changePrecisionModel=!1,this.isPointwise=!1;var t=arguments[0];this.targetPM=t}function $i(){this.pts=null,this.usePt=null,this.distanceTolerance=null,this.seg=new te;var t=arguments[0];this.pts=t}function to(){this.inputGeom=null,this.distanceTolerance=null,this.isEnsureValidTopology=!0;var t=arguments[0];this.inputGeom=t}function eo(){ue.apply(this),this.isEnsureValidTopology=!0,this.distanceTolerance=null;var t=arguments[0],e=arguments[1];this.isEnsureValidTopology=t,this.distanceTolerance=e}function no(){if(this.parent=null,this.index=null,2===arguments.length){var t=arguments[0],e=arguments[1];no.call(this,t,e,null,-1)}else if(4===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2],o=arguments[3];te.call(this,n,r),this.parent=i,this.index=o}}function ro(){if(this.parentLine=null,this.segs=null,this.resultSegs=new x,this.minimumSize=null,1===arguments.length){var t=arguments[0];ro.call(this,t,2)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.parentLine=e,this.minimumSize=n,this.init()}}function io(){this.index=new Pr}function oo(){this.querySeg=null,this.items=new x;var t=arguments[0];this.querySeg=t}function ao(){this.li=new Kt,this.inputIndex=new io,this.outputIndex=new io,this.line=null,this.linePts=null,this.distanceTolerance=0;var t=arguments[0],e=arguments[1];this.inputIndex=t,this.outputIndex=e}function so(){this.inputIndex=new io,this.outputIndex=new io,this.distanceTolerance=0}function uo(){this.inputGeom=null,this.lineSimplifier=new so,this.linestringMap=null;var t=arguments[0];this.inputGeom=t}function co(){ue.apply(this),this.linestringMap=null;var t=arguments[0];this.linestringMap=t}function lo(){this.tps=null;var t=arguments[0];this.tps=t}function fo(){this.seg=null,this.segLen=null,this.splitPt=null,this.minimumLen=0;var t=arguments[0];this.seg=t,this.segLen=t.getLength()}function ho(){}function po(){}function go(){}function vo(){if(this.p=null,1===arguments.length){var t=arguments[0];this.p=new d(t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.p=new d(e,n)}else if(3===arguments.length){var r=arguments[0],i=arguments[1],o=arguments[2];this.p=new d(r,i,o)}}function yo(){this._isOnConstraint=null,this.constraint=null;var t=arguments[0];vo.call(this,t)}function mo(){this._rot=null,this.vertex=null,this.next=null,this.data=null}function bo(){this.subdiv=null,this.isUsingTolerance=!1;var t=arguments[0];this.subdiv=t,this.isUsingTolerance=t.getTolerance()>0}function _o(){}function xo(){this.subdiv=null,this.lastEdge=null;var t=arguments[0];this.subdiv=t,this.init()}function wo(){if(this.seg=null,1===arguments.length){if("string"==typeof arguments[0]){var t=arguments[0];c.call(this,t)}else if(arguments[0]instanceof te){var e=arguments[0];c.call(this,"Locate failed to converge (at edge: "+e+").  Possible causes include invalid Subdivision topology or very close sites"),this.seg=new te(e)}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];c.call(this,wo.msgWithSpatial(n,r)),this.seg=new te(r)}}function Eo(){}function So(){this.visitedKey=0,this.quadEdges=new x,this.startingEdge=null,this.tolerance=null,this.edgeCoincidenceTolerance=null,this.frameVertex=new Array(3).fill(null),this.frameEnv=null,this.locator=null,this.seg=new te,this.triEdges=new Array(3).fill(null);var t=arguments[0],e=arguments[1];this.tolerance=e,this.edgeCoincidenceTolerance=e/So.EDGE_COINCIDENCE_TOL_FACTOR,this.createFrame(t),this.startingEdge=this.initSubdiv(),this.locator=new xo(this)}function Oo(){}function Po(){this.triList=new x}function Co(){this.triList=new x}function Mo(){this.coordList=new w,this.triCoords=new x}function Io(){if(this.ls=null,this.data=null,2===arguments.length){var t=arguments[0],e=arguments[1];this.ls=new te(t,e)}else if(3===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2];this.ls=new te(n,r),this.data=i}else if(6===arguments.length){var o=arguments[0],a=arguments[1],s=arguments[2],u=arguments[3],c=arguments[4],l=arguments[5];Io.call(this,new d(o,a,s),new d(u,c,l))}else if(7===arguments.length){var f=arguments[0],h=arguments[1],p=arguments[2],g=arguments[3],v=arguments[4],y=arguments[5],m=arguments[6];Io.call(this,new d(f,h,p),new d(g,v,y),m)}}function Ao(){}function To(){if(this.p=null,this.data=null,this.left=null,this.right=null,this.count=null,2===arguments.length){var t=arguments[0],e=arguments[1];this.p=new d(t),this.left=null,this.right=null,this.count=1,this.data=e}else if(3===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2];this.p=new d(n,r),this.left=null,this.right=null,this.count=1,this.data=i}}function No(){if(this.root=null,this.numberOfNodes=null,this.tolerance=null,0===arguments.length)No.call(this,0);else if(1===arguments.length){var t=arguments[0];this.tolerance=t}}function Lo(){this.tolerance=null,this.matchNode=null,this.matchDist=0,this.p=null;var t=arguments[0],e=arguments[1];this.p=t,this.tolerance=e}function Ro(){this.initialVertices=null,this.segVertices=null,this.segments=new x,this.subdiv=null,this.incDel=null,this.convexHull=null,this.splitFinder=new po,this.kdt=null,this.vertexFactory=null,this.computeAreaEnv=null,this.splitPt=null,this.tolerance=null;var t=arguments[0],e=arguments[1];this.initialVertices=new x(t),this.tolerance=e,this.kdt=new No(e)}function ko(){this.siteCoords=null,this.tolerance=0,this.subdiv=null}function jo(){this.siteCoords=null,this.constraintLines=null,this.tolerance=0,this.subdiv=null,this.constraintVertexMap=new it}function Fo(){this.siteCoords=null,this.tolerance=0,this.subdiv=null,this.clipEnv=null,this.diagramEnv=null}function Do(){}"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(t){if(null==this)throw new TypeError(this+" is not an object");var e=Object(this),n=Math.max(Math.min(e.length,9007199254740991),0)||0,r=1 in arguments&&parseInt(Number(arguments[1]),10)||0;r=r<0?Math.max(n+r,0):Math.min(r,n);var i=2 in arguments&&void 0!==arguments[2]?parseInt(Number(arguments[2]),10)||0:n;for(i=i<0?Math.max(n+arguments[2],0):Math.min(i,n);r<i;)e[r]=t,++r;return e},writable:!0}),Number.isFinite=Number.isFinite||function(t){return"number"==typeof t&&isFinite(t)},Number.isInteger=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},Number.parseFloat=Number.parseFloat||parseFloat,Number.isNaN=Number.isNaN||function(t){return t!=t},Math.trunc=Math.trunc||function(t){return t<0?Math.ceil(t):Math.floor(t)},e(n.prototype,{interfaces_:function(){return[]},getClass:function(){return n}}),n.equalsWithTolerance=function(t,e,n){return Math.abs(t-e)<=n},i.isNaN=function(t){return Number.isNaN(t)},i.doubleToLongBits=function(t){return t},i.longBitsToDouble=function(t){return t},i.isInfinite=function(t){return!Number.isFinite(t)},i.MAX_VALUE=Number.MAX_VALUE,c.prototype=Object.create(Error.prototype),c.prototype.constructor=Error,l(f,c),e(f.prototype,{interfaces_:function(){return[]},getClass:function(){return f}}),e(h.prototype,{interfaces_:function(){return[]},getClass:function(){return h}}),h.shouldNeverReachHere=function(){if(0===arguments.length)h.shouldNeverReachHere(null);else if(1===arguments.length){var t=arguments[0];throw new f("Should never reach here"+(null!==t?": "+t:""))}},h.isTrue=function(){if(1===arguments.length){var t=arguments[0];h.isTrue(t,null)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(!e)throw null===n?new f:new f(n)}},h.equals=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];h.equals(t,e,null)}else if(3===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2];if(!r.equals(n))throw new f("Expected "+n+" but encountered "+r+(null!==i?": "+i:""))}},e(d.prototype,{setOrdinate:function(t,e){switch(t){case d.X:this.x=e;break;case d.Y:this.y=e;break;case d.Z:this.z=e;break;default:throw new r("Invalid ordinate index: "+t)}},equals2D:function(){if(1===arguments.length){var t=arguments[0];return this.x===t.x&&this.y===t.y}if(2===arguments.length){var e=arguments[0],r=arguments[1];return!!n.equalsWithTolerance(this.x,e.x,r)&&!!n.equalsWithTolerance(this.y,e.y,r)}},getOrdinate:function(t){switch(t){case d.X:return this.x;case d.Y:return this.y;case d.Z:return this.z}throw new r("Invalid ordinate index: "+t)},equals3D:function(t){return this.x===t.x&&this.y===t.y&&(this.z===t.z||i.isNaN(this.z)&&i.isNaN(t.z))},equals:function(t){return t instanceof d&&this.equals2D(t)},equalInZ:function(t,e){return n.equalsWithTolerance(this.z,t.z,e)},compareTo:function(t){var e=t;return this.x<e.x?-1:this.x>e.x?1:this.y<e.y?-1:this.y>e.y?1:0},clone:function(){try{var t=null;return null}catch(t){if(t instanceof CloneNotSupportedException)return h.shouldNeverReachHere("this shouldn't happen because this class is Cloneable"),null;throw t}},copy:function(){return new d(this)},toString:function(){return"("+this.x+", "+this.y+", "+this.z+")"},distance3D:function(t){var e=this.x-t.x,n=this.y-t.y,r=this.z-t.z;return Math.sqrt(e*e+n*n+r*r)},distance:function(t){var e=this.x-t.x,n=this.y-t.y;return Math.sqrt(e*e+n*n)},hashCode:function(){var t=17;return 37*(t=37*t+d.hashCode(this.x))+d.hashCode(this.y)},setCoordinate:function(t){this.x=t.x,this.y=t.y,this.z=t.z},interfaces_:function(){return[o,a,u]},getClass:function(){return d}}),d.hashCode=function(){if(1===arguments.length){var t=arguments[0],e=i.doubleToLongBits(t);return Math.trunc(e^e>>>32)}},e(p.prototype,{compare:function(t,e){var n=t,r=e,i=p.compare(n.x,r.x);if(0!==i)return i;var o=p.compare(n.y,r.y);return 0!==o?o:this.dimensionsToTest<=2?0:p.compare(n.z,r.z)},interfaces_:function(){return[s]},getClass:function(){return p}}),p.compare=function(t,e){return t<e?-1:t>e?1:i.isNaN(t)?i.isNaN(e)?0:-1:i.isNaN(e)?1:0},d.DimensionalComparator=p,d.serialVersionUID=0x5cbf2c235c7e5800,d.NULL_ORDINATE=i.NaN,d.X=0,d.Y=1,d.Z=2,g.prototype.hasNext=function(){},g.prototype.next=function(){},g.prototype.remove=function(){},v.prototype.add=function(){},v.prototype.addAll=function(){},v.prototype.isEmpty=function(){},v.prototype.iterator=function(){},v.prototype.size=function(){},v.prototype.toArray=function(){},v.prototype.remove=function(){},y.prototype=new Error,y.prototype.name="IndexOutOfBoundsException",m.prototype=Object.create(v.prototype),m.prototype.constructor=m,m.prototype.get=function(){},m.prototype.set=function(){},m.prototype.isEmpty=function(){},b.prototype=new Error,b.prototype.name="NoSuchElementException",_.prototype=new Error,_.prototype.name="OperationNotSupported",x.prototype=Object.create(m.prototype),x.prototype.constructor=x,x.prototype.ensureCapacity=function(){},x.prototype.interfaces_=function(){return[m,v]},x.prototype.add=function(t){return 1===arguments.length?this.array_.push(t):this.array_.splice(arguments[0],arguments[1]),!0},x.prototype.clear=function(){this.array_=[]},x.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},x.prototype.set=function(t,e){var n=this.array_[t];return this.array_[t]=e,n},x.prototype.iterator=function(){return new Bo(this)},x.prototype.get=function(t){if(t<0||t>=this.size())throw new y;return this.array_[t]},x.prototype.isEmpty=function(){return 0===this.array_.length},x.prototype.size=function(){return this.array_.length},x.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},x.prototype.remove=function(t){for(var e=!1,n=0,r=this.array_.length;n<r;n++)if(this.array_[n]===t){this.array_.splice(n,1),e=!0;break}return e};var Bo=function(t){this.arrayList_=t,this.position_=0};Bo.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new b;return this.arrayList_.get(this.position_++)},Bo.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},Bo.prototype.set=function(t){return this.arrayList_.set(this.position_-1,t)},Bo.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},l(w,x),e(w.prototype,{getCoordinate:function(t){return this.get(t)},addAll:function(){if(2===arguments.length){for(var t=arguments[0],e=arguments[1],n=!1,r=t.iterator();r.hasNext();)this.add(r.next(),e),n=!0;return n}return x.prototype.addAll.apply(this,arguments)},clone:function(){for(var t=x.prototype.clone.call(this),e=0;e<this.size();e++)t.add(e,this.get(e).copy());return t},toCoordinateArray:function(){return this.toArray(w.coordArrayType)},add:function(){if(1===arguments.length){var t=arguments[0];x.prototype.add.call(this,t)}else if(2===arguments.length){if(arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var e=arguments[0],n=arguments[1];return this.add(e,n,!0),!0}if(arguments[0]instanceof d&&"boolean"==typeof arguments[1]){var r=arguments[0],i=arguments[1];if(!i&&this.size()>=1){var o=this.get(this.size()-1);if(o.equals2D(r))return null}x.prototype.add.call(this,r)}else if(arguments[0]instanceof Object&&"boolean"==typeof arguments[1]){var a=arguments[0],s=arguments[1];return this.add(a,s),!0}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var u=arguments[0],c=arguments[1],l=arguments[2];if(l)for(var f=0;f<u.length;f++)this.add(u[f],c);else for(f=u.length-1;f>=0;f--)this.add(u[f],c);return!0}if("boolean"==typeof arguments[2]&&Number.isInteger(arguments[0])&&arguments[1]instanceof d){var h=arguments[0],p=arguments[1],g=arguments[2];if(!g){var v=this.size();if(v>0){if(h>0){var y=this.get(h-1);if(y.equals2D(p))return null}if(h<v){var m=this.get(h);if(m.equals2D(p))return null}}}x.prototype.add.call(this,h,p)}}else if(4===arguments.length){var b=arguments[0],_=arguments[1],w=arguments[2],E=arguments[3],S=1;for(w>E&&(S=-1),f=w;f!==E;f+=S)this.add(b[f],_);return!0}},closeRing:function(){this.size()>0&&this.add(new d(this.get(0)),!1)},interfaces_:function(){return[]},getClass:function(){return w}}),w.coordArrayType=new Array(0).fill(null),e(E.prototype,{getArea:function(){return this.getWidth()*this.getHeight()},equals:function(t){if(!(t instanceof E))return!1;var e=t;return this.isNull()?e.isNull():this.maxx===e.getMaxX()&&this.maxy===e.getMaxY()&&this.minx===e.getMinX()&&this.miny===e.getMinY()},intersection:function(t){if(this.isNull()||t.isNull()||!this.intersects(t))return new E;var e=this.minx>t.minx?this.minx:t.minx,n=this.miny>t.miny?this.miny:t.miny;return new E(e,this.maxx<t.maxx?this.maxx:t.maxx,n,this.maxy<t.maxy?this.maxy:t.maxy)},isNull:function(){return this.maxx<this.minx},getMaxX:function(){return this.maxx},covers:function(){if(1===arguments.length){if(arguments[0]instanceof d){var t=arguments[0];return this.covers(t.x,t.y)}if(arguments[0]instanceof E){var e=arguments[0];return!this.isNull()&&!e.isNull()&&e.getMinX()>=this.minx&&e.getMaxX()<=this.maxx&&e.getMinY()>=this.miny&&e.getMaxY()<=this.maxy}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];return!this.isNull()&&n>=this.minx&&n<=this.maxx&&r>=this.miny&&r<=this.maxy}},intersects:function(){if(1===arguments.length){if(arguments[0]instanceof E){var t=arguments[0];return!this.isNull()&&!t.isNull()&&!(t.minx>this.maxx||t.maxx<this.minx||t.miny>this.maxy||t.maxy<this.miny)}if(arguments[0]instanceof d){var e=arguments[0];return this.intersects(e.x,e.y)}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];return!this.isNull()&&!(n>this.maxx||n<this.minx||r>this.maxy||r<this.miny)}},getMinY:function(){return this.miny},getMinX:function(){return this.minx},expandToInclude:function(){if(1===arguments.length){if(arguments[0]instanceof d){var t=arguments[0];this.expandToInclude(t.x,t.y)}else if(arguments[0]instanceof E){var e=arguments[0];if(e.isNull())return null;this.isNull()?(this.minx=e.getMinX(),this.maxx=e.getMaxX(),this.miny=e.getMinY(),this.maxy=e.getMaxY()):(e.minx<this.minx&&(this.minx=e.minx),e.maxx>this.maxx&&(this.maxx=e.maxx),e.miny<this.miny&&(this.miny=e.miny),e.maxy>this.maxy&&(this.maxy=e.maxy))}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];this.isNull()?(this.minx=n,this.maxx=n,this.miny=r,this.maxy=r):(n<this.minx&&(this.minx=n),n>this.maxx&&(this.maxx=n),r<this.miny&&(this.miny=r),r>this.maxy&&(this.maxy=r))}},minExtent:function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t<e?t:e},getWidth:function(){return this.isNull()?0:this.maxx-this.minx},compareTo:function(t){var e=t;return this.isNull()?e.isNull()?0:-1:e.isNull()?1:this.minx<e.minx?-1:this.minx>e.minx?1:this.miny<e.miny?-1:this.miny>e.miny?1:this.maxx<e.maxx?-1:this.maxx>e.maxx?1:this.maxy<e.maxy?-1:this.maxy>e.maxy?1:0},translate:function(t,e){return this.isNull()?null:void this.init(this.getMinX()+t,this.getMaxX()+t,this.getMinY()+e,this.getMaxY()+e)},toString:function(){return"Env["+this.minx+" : "+this.maxx+", "+this.miny+" : "+this.maxy+"]"},setToNull:function(){this.minx=0,this.maxx=-1,this.miny=0,this.maxy=-1},getHeight:function(){return this.isNull()?0:this.maxy-this.miny},maxExtent:function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t>e?t:e},expandBy:function(){if(1===arguments.length){var t=arguments[0];this.expandBy(t,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this.isNull())return null;this.minx-=e,this.maxx+=e,this.miny-=n,this.maxy+=n,(this.minx>this.maxx||this.miny>this.maxy)&&this.setToNull()}},contains:function(){if(1===arguments.length){if(arguments[0]instanceof E){var t=arguments[0];return this.covers(t)}if(arguments[0]instanceof d){var e=arguments[0];return this.covers(e)}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];return this.covers(n,r)}},centre:function(){return this.isNull()?null:new d((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)},init:function(){if(0===arguments.length)this.setToNull();else if(1===arguments.length){if(arguments[0]instanceof d){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof E){var e=arguments[0];this.minx=e.minx,this.maxx=e.maxx,this.miny=e.miny,this.maxy=e.maxy}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];this.init(n.x,r.x,n.y,r.y)}else if(4===arguments.length){var i=arguments[0],o=arguments[1],a=arguments[2],s=arguments[3];i<o?(this.minx=i,this.maxx=o):(this.minx=o,this.maxx=i),a<s?(this.miny=a,this.maxy=s):(this.miny=s,this.maxy=a)}},getMaxY:function(){return this.maxy},distance:function(t){if(this.intersects(t))return 0;var e=0;this.maxx<t.minx?e=t.minx-this.maxx:this.minx>t.maxx&&(e=this.minx-t.maxx);var n=0;return this.maxy<t.miny?n=t.miny-this.maxy:this.miny>t.maxy&&(n=this.miny-t.maxy),0===e?n:0===n?e:Math.sqrt(e*e+n*n)},hashCode:function(){var t=17;return 37*(t=37*(t=37*(t=37*t+d.hashCode(this.minx))+d.hashCode(this.maxx))+d.hashCode(this.miny))+d.hashCode(this.maxy)},interfaces_:function(){return[o,u]},getClass:function(){return E}}),E.intersects=function(){if(3===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2];return n.x>=(t.x<e.x?t.x:e.x)&&n.x<=(t.x>e.x?t.x:e.x)&&n.y>=(t.y<e.y?t.y:e.y)&&n.y<=(t.y>e.y?t.y:e.y)}if(4===arguments.length){var r=arguments[0],i=arguments[1],o=arguments[2],a=arguments[3],s=Math.min(o.x,a.x),u=Math.max(o.x,a.x),c=Math.min(r.x,i.x),l=Math.max(r.x,i.x);return!(c>u||l<s||(s=Math.min(o.y,a.y),u=Math.max(o.y,a.y),c=Math.min(r.y,i.y),l=Math.max(r.y,i.y),c>u||l<s))}},E.serialVersionUID=0x51845cd552189800,l(O,S),e(O.prototype,{interfaces_:function(){return[]},getClass:function(){return O}}),e(P.prototype,{interfaces_:function(){return[]},getClass:function(){return P}}),P.toLocationSymbol=function(t){switch(t){case P.EXTERIOR:return"e";case P.BOUNDARY:return"b";case P.INTERIOR:return"i";case P.NONE:return"-"}throw new r("Unknown location value: "+t)},P.INTERIOR=0,P.BOUNDARY=1,P.EXTERIOR=2,P.NONE=-1,e(M.prototype,{interfaces_:function(){return[]},getClass:function(){return M}}),M.log10=function(t){var e=Math.log(t);return i.isInfinite(e)||i.isNaN(e)?e:e/M.LOG_10},M.min=function(t,e,n,r){var i=t;return e<i&&(i=e),n<i&&(i=n),r<i&&(i=r),i},M.clamp=function(){if("number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1],n=arguments[2];return t<e?e:t>n?n:t}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var r=arguments[0],i=arguments[1],o=arguments[2];return r<i?i:r>o?o:r}},M.wrap=function(t,e){return t<0?e- -t%e:t%e},M.max=function(){if(3===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2];return e>(r=t)&&(r=e),n>r&&(r=n),r}if(4===arguments.length){var r,i=arguments[0],o=arguments[1],a=arguments[2],s=arguments[3];return o>(r=i)&&(r=o),a>r&&(r=a),s>r&&(r=s),r}},M.average=function(t,e){return(t+e)/2},M.LOG_10=Math.log(10),I.prototype.append=function(t){this.str+=t},I.prototype.setCharAt=function(t,e){this.str=this.str.substr(0,t)+e+this.str.substr(t+1)},I.prototype.toString=function(t){return this.str},A.prototype.intValue=function(){return this.value},A.prototype.compareTo=function(t){return this.value<t?-1:this.value>t?1:0},A.isNaN=function(t){return Number.isNaN(t)},T.isWhitespace=function(t){return t<=32&&t>=0||127==t},T.toUpperCase=function(t){return t.toUpperCase()},e(N.prototype,{le:function(t){return this.hi<t.hi||this.hi===t.hi&&this.lo<=t.lo},extractSignificantDigits:function(t,e){var n=this.abs(),r=N.magnitude(n.hi),i=N.TEN.pow(r);(n=n.divide(i)).gt(N.TEN)?(n=n.divide(N.TEN),r+=1):n.lt(N.ONE)&&(n=n.multiply(N.TEN),r-=1);for(var o=r+1,a=new I,s=N.MAX_PRINT_DIGITS-1,u=0;u<=s;u++){t&&u===o&&a.append(".");var c=Math.trunc(n.hi);if(c<0)break;var l=!1,f=0;c>9?(l=!0,f="9"):f="0"+c,a.append(f),n=n.subtract(N.valueOf(c)).multiply(N.TEN),l&&n.selfAdd(N.TEN);var h=!0,d=N.magnitude(n.hi);if(d<0&&Math.abs(d)>=s-u&&(h=!1),!h)break}return e[0]=r,a.toString()},sqr:function(){return this.multiply(this)},doubleValue:function(){return this.hi+this.lo},subtract:function(){if(arguments[0]instanceof N){var t=arguments[0];return this.add(t.negate())}if("number"==typeof arguments[0]){var e=arguments[0];return this.add(-e)}},equals:function(){if(1===arguments.length){var t=arguments[0];return this.hi===t.hi&&this.lo===t.lo}},isZero:function(){return 0===this.hi&&0===this.lo},selfSubtract:function(){if(arguments[0]instanceof N){var t=arguments[0];return this.isNaN()?this:this.selfAdd(-t.hi,-t.lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.isNaN()?this:this.selfAdd(-e,0)}},getSpecialNumberString:function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null},min:function(t){return this.le(t)?this:t},selfDivide:function(){if(1===arguments.length){if(arguments[0]instanceof N){var t=arguments[0];return this.selfDivide(t.hi,t.lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.selfDivide(e,0)}}else if(2===arguments.length){var n=arguments[0],r=arguments[1],i=null,o=null,a=null,s=null,u=null,c=null,l=null,f=null;return u=this.hi/n,f=(i=(c=N.SPLIT*u)-(i=c-u))*(a=(f=N.SPLIT*n)-(a=f-n))-(l=u*n)+i*(s=n-a)+(o=u-i)*a+o*s,f=u+(c=(this.hi-l-f+this.lo-u*r)/n),this.hi=f,this.lo=u-f+c,this}},dump:function(){return"DD<"+this.hi+", "+this.lo+">"},divide:function(){if(arguments[0]instanceof N){var t=arguments[0],e=null,n=null,r=null,o=null,a=null,s=null,u=null,c=null;n=(a=this.hi/t.hi)-(e=(s=N.SPLIT*a)-(e=s-a)),c=e*(r=(c=N.SPLIT*t.hi)-(r=c-t.hi))-(u=a*t.hi)+e*(o=t.hi-r)+n*r+n*o;var l=c=a+(s=(this.hi-u-c+this.lo-a*t.lo)/t.hi),f=a-c+s;return new N(l,f)}if("number"==typeof arguments[0]){var h=arguments[0];return i.isNaN(h)?N.createNaN():N.copy(this).selfDivide(h,0)}},ge:function(t){return this.hi>t.hi||this.hi===t.hi&&this.lo>=t.lo},pow:function(t){if(0===t)return N.valueOf(1);var e=new N(this),n=N.valueOf(1),r=Math.abs(t);if(r>1)for(;r>0;)r%2==1&&n.selfMultiply(e),(r/=2)>0&&(e=e.sqr());else n=e;return t<0?n.reciprocal():n},ceil:function(){if(this.isNaN())return N.NaN;var t=Math.ceil(this.hi),e=0;return t===this.hi&&(e=Math.ceil(this.lo)),new N(t,e)},compareTo:function(t){var e=t;return this.hi<e.hi?-1:this.hi>e.hi?1:this.lo<e.lo?-1:this.lo>e.lo?1:0},rint:function(){return this.isNaN()?this:this.add(.5).floor()},setValue:function(){if(arguments[0]instanceof N){var t=arguments[0];return this.init(t),this}if("number"==typeof arguments[0]){var e=arguments[0];return this.init(e),this}},max:function(t){return this.ge(t)?this:t},sqrt:function(){if(this.isZero())return N.valueOf(0);if(this.isNegative())return N.NaN;var t=1/Math.sqrt(this.hi),e=this.hi*t,n=N.valueOf(e),r=this.subtract(n.sqr()).hi*(.5*t);return n.add(r)},selfAdd:function(){if(1===arguments.length){if(arguments[0]instanceof N){var t=arguments[0];return this.selfAdd(t.hi,t.lo)}if("number"==typeof arguments[0]){var e=arguments[0],n=null,r=null,i=null,o=null,a=null,s=null;return o=(i=this.hi+e)-(a=i-this.hi),r=(s=(o=e-a+(this.hi-o))+this.lo)+(i-(n=i+s)),this.hi=n+r,this.lo=r+(n-this.hi),this}}else if(2===arguments.length){var u=arguments[0],c=arguments[1],l=(n=null,r=null,null),f=null;i=null,o=null,a=null,s=null,i=this.hi+u,l=this.lo+c,o=i-(a=i-this.hi),f=l-(s=l-this.lo);var h=(n=i+(a=(o=u-a+(this.hi-o))+l))+(a=(f=c-s+(this.lo-f))+(r=a+(i-n))),d=a+(n-h);return this.hi=h,this.lo=d,this}},selfMultiply:function(){if(1===arguments.length){if(arguments[0]instanceof N){var t=arguments[0];return this.selfMultiply(t.hi,t.lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.selfMultiply(e,0)}}else if(2===arguments.length){var n=arguments[0],r=arguments[1],i=null,o=null,a=null,s=null,u=null,c=null;i=(u=N.SPLIT*this.hi)-this.hi,c=N.SPLIT*n,i=u-i,o=this.hi-i,a=c-n;var l=(u=this.hi*n)+(c=i*(a=c-a)-u+i*(s=n-a)+o*a+o*s+(this.hi*r+this.lo*n)),f=c+(i=u-l);return this.hi=l,this.lo=f,this}},selfSqr:function(){return this.selfMultiply(this)},floor:function(){if(this.isNaN())return N.NaN;var t=Math.floor(this.hi),e=0;return t===this.hi&&(e=Math.floor(this.lo)),new N(t,e)},negate:function(){return this.isNaN()?this:new N(-this.hi,-this.lo)},clone:function(){try{return null}catch(t){if(t instanceof CloneNotSupportedException)return null;throw t}},multiply:function(){if(arguments[0]instanceof N){var t=arguments[0];return t.isNaN()?N.createNaN():N.copy(this).selfMultiply(t)}if("number"==typeof arguments[0]){var e=arguments[0];return i.isNaN(e)?N.createNaN():N.copy(this).selfMultiply(e,0)}},isNaN:function(){return i.isNaN(this.hi)},intValue:function(){return Math.trunc(this.hi)},toString:function(){var t=N.magnitude(this.hi);return t>=-3&&t<=20?this.toStandardNotation():this.toSciNotation()},toStandardNotation:function(){var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),n=this.extractSignificantDigits(!0,e),r=e[0]+1,i=n;if("."===n.charAt(0))i="0"+n;else if(r<0)i="0."+N.stringOfChar("0",-r)+n;else if(-1===n.indexOf(".")){var o=r-n.length;i=n+N.stringOfChar("0",o)+".0"}return this.isNegative()?"-"+i:i},reciprocal:function(){var t,e,n,r,i=null,o=null,a=null,s=null;t=(n=1/this.hi)-(i=(a=N.SPLIT*n)-(i=a-n)),o=(s=N.SPLIT*this.hi)-this.hi;var u=n+(a=(1-(r=n*this.hi)-(s=i*(o=s-o)-r+i*(e=this.hi-o)+t*o+t*e)-n*this.lo)/this.hi);return new N(u,n-u+a)},toSciNotation:function(){if(this.isZero())return N.SCI_NOT_ZERO;var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),n=this.extractSignificantDigits(!1,e),r=N.SCI_NOT_EXPONENT_CHAR+e[0];if("0"===n.charAt(0))throw new IllegalStateException("Found leading zero: "+n);var i="";n.length>1&&(i=n.substring(1));var o=n.charAt(0)+"."+i;return this.isNegative()?"-"+o+r:o+r},abs:function(){return this.isNaN()?N.NaN:this.isNegative()?this.negate():new N(this)},isPositive:function(){return this.hi>0||0===this.hi&&this.lo>0},lt:function(t){return this.hi<t.hi||this.hi===t.hi&&this.lo<t.lo},add:function(){if(arguments[0]instanceof N){var t=arguments[0];return N.copy(this).selfAdd(t)}if("number"==typeof arguments[0]){var e=arguments[0];return N.copy(this).selfAdd(e)}},init:function(){if(1===arguments.length){if("number"==typeof arguments[0]){var t=arguments[0];this.hi=t,this.lo=0}else if(arguments[0]instanceof N){var e=arguments[0];this.hi=e.hi,this.lo=e.lo}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];this.hi=n,this.lo=r}},gt:function(t){return this.hi>t.hi||this.hi===t.hi&&this.lo>t.lo},isNegative:function(){return this.hi<0||0===this.hi&&this.lo<0},trunc:function(){return this.isNaN()?N.NaN:this.isPositive()?this.floor():this.ceil()},signum:function(){return this.hi>0?1:this.hi<0?-1:this.lo>0?1:this.lo<0?-1:0},interfaces_:function(){return[u,o,a]},getClass:function(){return N}}),N.sqr=function(t){return N.valueOf(t).selfMultiply(t)},N.valueOf=function(){if("string"==typeof arguments[0]){var t=arguments[0];return N.parse(t)}if("number"==typeof arguments[0]){var e=arguments[0];return new N(e)}},N.sqrt=function(t){return N.valueOf(t).sqrt()},N.parse=function(t){for(var e=0,n=t.length;T.isWhitespace(t.charAt(e));)e++;var r=!1;if(e<n){var i=t.charAt(e);"-"!==i&&"+"!==i||(e++,"-"===i&&(r=!0))}for(var o=new N,a=0,s=0,u=0;!(e>=n);){var c=t.charAt(e);if(e++,T.isDigit(c)){var l=c-"0";o.selfMultiply(N.TEN),o.selfAdd(l),a++}else{if("."!==c){if("e"===c||"E"===c){var f=t.substring(e);try{u=A.parseInt(f)}catch(e){throw e instanceof NumberFormatException?new NumberFormatException("Invalid exponent "+f+" in string "+t):e}break}throw new NumberFormatException("Unexpected character '"+c+"' at position "+e+" in string "+t)}s=a}}var h=o,d=a-s-u;if(0===d)h=o;else if(d>0){var p=N.TEN.pow(d);h=o.divide(p)}else d<0&&(p=N.TEN.pow(-d),h=o.multiply(p));return r?h.negate():h},N.createNaN=function(){return new N(i.NaN,i.NaN)},N.copy=function(t){return new N(t)},N.magnitude=function(t){var e=Math.abs(t),n=Math.log(e)/Math.log(10),r=Math.trunc(Math.floor(n));return 10*Math.pow(10,r)<=e&&(r+=1),r},N.stringOfChar=function(t,e){for(var n=new I,r=0;r<e;r++)n.append(t);return n.toString()},N.PI=new N(3.141592653589793,12246467991473532e-32),N.TWO_PI=new N(6.283185307179586,24492935982947064e-32),N.PI_2=new N(1.5707963267948966,6123233995736766e-32),N.E=new N(2.718281828459045,14456468917292502e-32),N.NaN=new N(i.NaN,i.NaN),N.EPS=123259516440783e-46,N.SPLIT=134217729,N.MAX_PRINT_DIGITS=32,N.TEN=N.valueOf(10),N.ONE=N.valueOf(1),N.SCI_NOT_EXPONENT_CHAR="E",N.SCI_NOT_ZERO="0.0E0",e(L.prototype,{interfaces_:function(){return[]},getClass:function(){return L}}),L.orientationIndex=function(t,e,n){var r=L.orientationIndexFilter(t,e,n);if(r<=1)return r;var i=N.valueOf(e.x).selfAdd(-t.x),o=N.valueOf(e.y).selfAdd(-t.y),a=N.valueOf(n.x).selfAdd(-e.x),s=N.valueOf(n.y).selfAdd(-e.y);return i.selfMultiply(s).selfSubtract(o.selfMultiply(a)).signum()},L.signOfDet2x2=function(t,e,n,r){return t.multiply(r).selfSubtract(e.multiply(n)).signum()},L.intersection=function(t,e,n,r){var i=N.valueOf(r.y).selfSubtract(n.y).selfMultiply(N.valueOf(e.x).selfSubtract(t.x)),o=N.valueOf(r.x).selfSubtract(n.x).selfMultiply(N.valueOf(e.y).selfSubtract(t.y)),a=i.subtract(o),s=N.valueOf(r.x).selfSubtract(n.x).selfMultiply(N.valueOf(t.y).selfSubtract(n.y)),u=N.valueOf(r.y).selfSubtract(n.y).selfMultiply(N.valueOf(t.x).selfSubtract(n.x)),c=s.subtract(u).selfDivide(a).doubleValue(),l=N.valueOf(t.x).selfAdd(N.valueOf(e.x).selfSubtract(t.x).selfMultiply(c)).doubleValue(),f=N.valueOf(e.x).selfSubtract(t.x).selfMultiply(N.valueOf(t.y).selfSubtract(n.y)),h=N.valueOf(e.y).selfSubtract(t.y).selfMultiply(N.valueOf(t.x).selfSubtract(n.x)),p=f.subtract(h).selfDivide(a).doubleValue();return new d(l,N.valueOf(n.y).selfAdd(N.valueOf(r.y).selfSubtract(n.y).selfMultiply(p)).doubleValue())},L.orientationIndexFilter=function(t,e,n){var r=null,i=(t.x-n.x)*(e.y-n.y),o=(t.y-n.y)*(e.x-n.x),a=i-o;if(i>0){if(o<=0)return L.signum(a);r=i+o}else{if(!(i<0))return L.signum(a);if(o>=0)return L.signum(a);r=-i-o}var s=L.DP_SAFE_EPSILON*r;return a>=s||-a>=s?L.signum(a):2},L.signum=function(t){return t>0?1:t<0?-1:0},L.DP_SAFE_EPSILON=1e-15,e(R.prototype,{setOrdinate:function(t,e,n){},size:function(){},getOrdinate:function(t,e){},getCoordinate:function(){1===arguments.length?arguments[0]:2===arguments.length&&(arguments[0],arguments[1])},getCoordinateCopy:function(t){},getDimension:function(){},getX:function(t){},clone:function(){},expandEnvelope:function(t){},copy:function(){},getY:function(t){},toCoordinateArray:function(){},interfaces_:function(){return[a]},getClass:function(){return R}}),R.X=0,R.Y=1,R.Z=2,R.M=3,k.arraycopy=function(t,e,n,r,i){for(var o=0,a=e;a<e+i;a++)n[r+o]=t[a],o++},k.getProperty=function(t){return{"line.separator":"\n"}[t]},e(j.prototype,{getY:function(){var t=this.y/this.w;if(i.isNaN(t)||i.isInfinite(t))throw new O;return t},getX:function(){var t=this.x/this.w;if(i.isNaN(t)||i.isInfinite(t))throw new O;return t},getCoordinate:function(){var t=new d;return t.x=this.getX(),t.y=this.getY(),t},interfaces_:function(){return[]},getClass:function(){return j}}),j.intersection=function(t,e,n,r){var o=t.y-e.y,a=e.x-t.x,s=t.x*e.y-e.x*t.y,u=n.y-r.y,c=r.x-n.x,l=n.x*r.y-r.x*n.y,f=o*c-u*a,h=(a*l-c*s)/f,p=(u*s-o*l)/f;if(i.isNaN(h)||i.isInfinite(h)||i.isNaN(p)||i.isInfinite(p))throw new O;return new d(h,p)},e(F.prototype,{create:function(){1===arguments.length?(arguments[0]instanceof Array||C(arguments[0],R))&&arguments[0]:2===arguments.length&&(arguments[0],arguments[1])},interfaces_:function(){return[]},getClass:function(){return F}}),e(D.prototype,{filter:function(t){},interfaces_:function(){return[]},getClass:function(){return D}}),e(B.prototype,{isGeometryCollection:function(){return this.getSortIndex()===B.SORTINDEX_GEOMETRYCOLLECTION},getFactory:function(){return this.factory},getGeometryN:function(t){return this},getArea:function(){return 0},isRectangle:function(){return!1},equals:function(){if(1===arguments.length){if(arguments[0]instanceof B){var t=arguments[0];return null!==t&&this.equalsTopo(t)}if(arguments[0]instanceof Object){var e=arguments[0];if(!(e instanceof B))return!1;var n=e;return this.equalsExact(n)}}},equalsExact:function(t){return this===t||this.equalsExact(t,0)},geometryChanged:function(){this.apply(B.geometryChangedFilter)},geometryChangedAction:function(){this.envelope=null},equalsNorm:function(t){return null!==t&&this.norm().equalsExact(t.norm())},getLength:function(){return 0},getNumGeometries:function(){return 1},compareTo:function(){if(1===arguments.length){var t=arguments[0],e=t;return this.getSortIndex()!==e.getSortIndex()?this.getSortIndex()-e.getSortIndex():this.isEmpty()&&e.isEmpty()?0:this.isEmpty()?-1:e.isEmpty()?1:this.compareToSameClass(t)}if(2===arguments.length){var n=arguments[0],r=arguments[1];return e=n,this.getSortIndex()!==e.getSortIndex()?this.getSortIndex()-e.getSortIndex():this.isEmpty()&&e.isEmpty()?0:this.isEmpty()?-1:e.isEmpty()?1:this.compareToSameClass(n,r)}},getUserData:function(){return this.userData},getSRID:function(){return this.SRID},getEnvelope:function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())},checkNotGeometryCollection:function(t){if(t.getSortIndex()===B.SORTINDEX_GEOMETRYCOLLECTION)throw new r("This method does not support GeometryCollection arguments")},equal:function(t,e,n){return 0===n?t.equals(e):t.distance(e)<=n},norm:function(){var t=this.copy();return t.normalize(),t},getPrecisionModel:function(){return this.factory.getPrecisionModel()},getEnvelopeInternal:function(){return null===this.envelope&&(this.envelope=this.computeEnvelopeInternal()),new E(this.envelope)},setSRID:function(t){this.SRID=t},setUserData:function(t){this.userData=t},compare:function(t,e){for(var n=t.iterator(),r=e.iterator();n.hasNext()&&r.hasNext();){var i=n.next(),o=r.next(),a=i.compareTo(o);if(0!==a)return a}return n.hasNext()?1:r.hasNext()?-1:0},hashCode:function(){return this.getEnvelopeInternal().hashCode()},isGeometryCollectionOrDerived:function(){return this.getSortIndex()===B.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===B.SORTINDEX_MULTIPOINT||this.getSortIndex()===B.SORTINDEX_MULTILINESTRING||this.getSortIndex()===B.SORTINDEX_MULTIPOLYGON},interfaces_:function(){return[a,o,u]},getClass:function(){return B}}),B.hasNonEmptyElements=function(t){for(var e=0;e<t.length;e++)if(!t[e].isEmpty())return!0;return!1},B.hasNullElements=function(t){for(var e=0;e<t.length;e++)if(null===t[e])return!0;return!1},B.serialVersionUID=0x799ea46522854c00,B.SORTINDEX_POINT=0,B.SORTINDEX_MULTIPOINT=1,B.SORTINDEX_LINESTRING=2,B.SORTINDEX_LINEARRING=3,B.SORTINDEX_MULTILINESTRING=4,B.SORTINDEX_POLYGON=5,B.SORTINDEX_MULTIPOLYGON=6,B.SORTINDEX_GEOMETRYCOLLECTION=7,B.geometryChangedFilter={interfaces_:function(){return[D]},filter:function(t){t.geometryChangedAction()}},e(z.prototype,{filter:function(t){},interfaces_:function(){return[]},getClass:function(){return z}}),e(V.prototype,{isInBoundary:function(t){},interfaces_:function(){return[]},getClass:function(){return V}}),e(G.prototype,{isInBoundary:function(t){return t%2==1},interfaces_:function(){return[V]},getClass:function(){return G}}),e(U.prototype,{isInBoundary:function(t){return t>0},interfaces_:function(){return[V]},getClass:function(){return U}}),e(W.prototype,{isInBoundary:function(t){return t>1},interfaces_:function(){return[V]},getClass:function(){return W}}),e(q.prototype,{isInBoundary:function(t){return 1===t},interfaces_:function(){return[V]},getClass:function(){return q}}),V.Mod2BoundaryNodeRule=G,V.EndPointBoundaryNodeRule=U,V.MultiValentEndPointBoundaryNodeRule=W,V.MonoValentEndPointBoundaryNodeRule=q,V.MOD2_BOUNDARY_RULE=new G,V.ENDPOINT_BOUNDARY_RULE=new U,V.MULTIVALENT_ENDPOINT_BOUNDARY_RULE=new W,V.MONOVALENT_ENDPOINT_BOUNDARY_RULE=new q,V.OGC_SFS_BOUNDARY_RULE=V.MOD2_BOUNDARY_RULE,e(X.prototype,{interfaces_:function(){return[]},getClass:function(){return X}}),X.isRing=function(t){return!(t.length<4||!t[0].equals2D(t[t.length-1]))},X.ptNotInList=function(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(X.indexOf(r,e)<0)return r}return null},X.scroll=function(t,e){var n=X.indexOf(e,t);if(n<0)return null;var r=new Array(t.length).fill(null);k.arraycopy(t,n,r,0,t.length-n),k.arraycopy(t,0,r,t.length-n,n),k.arraycopy(r,0,t,0,t.length)},X.equals=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(t===e)return!0;if(null===t||null===e)return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].equals(e[n]))return!1;return!0}if(3===arguments.length){var r=arguments[0],i=arguments[1],o=arguments[2];if(r===i)return!0;if(null===r||null===i)return!1;if(r.length!==i.length)return!1;for(n=0;n<r.length;n++)if(0!==o.compare(r[n],i[n]))return!1;return!0}},X.intersection=function(t,e){for(var n=new w,r=0;r<t.length;r++)e.intersects(t[r])&&n.add(t[r],!0);return n.toCoordinateArray()},X.hasRepeatedPoints=function(t){for(var e=1;e<t.length;e++)if(t[e-1].equals(t[e]))return!0;return!1},X.removeRepeatedPoints=function(t){return X.hasRepeatedPoints(t)?new w(t,!1).toCoordinateArray():t},X.reverse=function(t){for(var e=t.length-1,n=Math.trunc(e/2),r=0;r<=n;r++){var i=t[r];t[r]=t[e-r],t[e-r]=i}},X.removeNull=function(t){for(var e=0,n=0;n<t.length;n++)null!==t[n]&&e++;var r=new Array(e).fill(null);if(0===e)return r;var i=0;for(n=0;n<t.length;n++)null!==t[n]&&(r[i++]=t[n]);return r},X.copyDeep=function(){if(1===arguments.length){for(var t=arguments[0],e=new Array(t.length).fill(null),n=0;n<t.length;n++)e[n]=new d(t[n]);return e}if(5===arguments.length){var r=arguments[0],i=arguments[1],o=arguments[2],a=arguments[3],s=arguments[4];for(n=0;n<s;n++)o[a+n]=new d(r[i+n])}},X.isEqualReversed=function(t,e){for(var n=0;n<t.length;n++){var r=t[n],i=e[t.length-n-1];if(0!==r.compareTo(i))return!1}return!0},X.envelope=function(t){for(var e=new E,n=0;n<t.length;n++)e.expandToInclude(t[n]);return e},X.toCoordinateArray=function(t){return t.toArray(X.coordArrayType)},X.atLeastNCoordinatesOrNothing=function(t,e){return e.length>=t?e:[]},X.indexOf=function(t,e){for(var n=0;n<e.length;n++)if(t.equals(e[n]))return n;return-1},X.increasingDirection=function(t){for(var e=0;e<Math.trunc(t.length/2);e++){var n=t.length-1-e,r=t[e].compareTo(t[n]);if(0!==r)return r}return 1},X.compare=function(t,e){for(var n=0;n<t.length&&n<e.length;){var r=t[n].compareTo(e[n]);if(0!==r)return r;n++}return n<e.length?-1:n<t.length?1:0},X.minCoordinate=function(t){for(var e=null,n=0;n<t.length;n++)(null===e||e.compareTo(t[n])>0)&&(e=t[n]);return e},X.extract=function(t,e,n){e=M.clamp(e,0,t.length);var r=(n=M.clamp(n,-1,t.length))-e+1;n<0&&(r=0),e>=t.length&&(r=0),n<e&&(r=0);var i=new Array(r).fill(null);if(0===r)return i;for(var o=0,a=e;a<=n;a++)i[o++]=t[a];return i},e(H.prototype,{compare:function(t,e){var n=t,r=e;return X.compare(n,r)},interfaces_:function(){return[s]},getClass:function(){return H}}),e(Y.prototype,{compare:function(t,e){var n=t,r=e;if(n.length<r.length)return-1;if(n.length>r.length)return 1;if(0===n.length)return 0;var i=X.compare(n,r);return X.isEqualReversed(n,r)?0:i},OLDcompare:function(t,e){var n=t,r=e;if(n.length<r.length)return-1;if(n.length>r.length)return 1;if(0===n.length)return 0;for(var i=X.increasingDirection(n),o=X.increasingDirection(r),a=i>0?0:n.length-1,s=o>0?0:n.length-1,u=0;u<n.length;u++){var c=n[a].compareTo(r[s]);if(0!==c)return c;a+=i,s+=o}return 0},interfaces_:function(){return[s]},getClass:function(){return Y}}),X.ForwardComparator=H,X.BidirectionalComparator=Y,X.coordArrayType=new Array(0).fill(null),Z.prototype.get=function(){},Z.prototype.put=function(){},Z.prototype.size=function(){},Z.prototype.values=function(){},Z.prototype.entrySet=function(){},K.prototype=new Z,J.prototype=new v,J.prototype.contains=function(){},Q.prototype=new J,Q.prototype.contains=function(t){for(var e=0,n=this.array_.length;e<n;e++)if(this.array_[e]===t)return!0;return!1},Q.prototype.add=function(t){return!this.contains(t)&&(this.array_.push(t),!0)},Q.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},Q.prototype.remove=function(t){throw new javascript.util.OperationNotSupported},Q.prototype.size=function(){return this.array_.length},Q.prototype.isEmpty=function(){return 0===this.array_.length},Q.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},Q.prototype.iterator=function(){return new zo(this)};var zo=function(t){this.hashSet_=t,this.position_=0};zo.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new b;return this.hashSet_.array_[this.position_++]},zo.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},zo.prototype.remove=function(){throw new _};var Vo=0;it.prototype=new K,it.prototype.get=function(t){for(var e=this.root_;null!==e;){var n=t.compareTo(e.key);if(n<0)e=e.left;else{if(!(n>0))return e.value;e=e.right}}return null},it.prototype.put=function(t,e){if(null===this.root_)return this.root_={key:t,value:e,left:null,right:null,parent:null,color:Vo,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var n,r,i=this.root_;do{if(n=i,(r=t.compareTo(i.key))<0)i=i.left;else{if(!(r>0)){var o=i.value;return i.value=e,o}i=i.right}}while(null!==i);var a={key:t,left:null,right:null,value:e,parent:n,color:Vo,getValue:function(){return this.value},getKey:function(){return this.key}};return r<0?n.left=a:n.right=a,this.fixAfterInsertion(a),this.size_++,null},it.prototype.fixAfterInsertion=function(t){for(t.color=1;null!=t&&t!=this.root_&&1==t.parent.color;)if(tt(t)==nt(tt(tt(t))))1==$(e=rt(tt(tt(t))))?(et(tt(t),Vo),et(e,Vo),et(tt(tt(t)),1),t=tt(tt(t))):(t==rt(tt(t))&&(t=tt(t),this.rotateLeft(t)),et(tt(t),Vo),et(tt(tt(t)),1),this.rotateRight(tt(tt(t))));else{var e;1==$(e=nt(tt(tt(t))))?(et(tt(t),Vo),et(e,Vo),et(tt(tt(t)),1),t=tt(tt(t))):(t==nt(tt(t))&&(t=tt(t),this.rotateRight(t)),et(tt(t),Vo),et(tt(tt(t)),1),this.rotateLeft(tt(tt(t))))}this.root_.color=Vo},it.prototype.values=function(){var t=new x,e=this.getFirstEntry();if(null!==e)for(t.add(e.value);null!==(e=it.successor(e));)t.add(e.value);return t},it.prototype.entrySet=function(){var t=new Q,e=this.getFirstEntry();if(null!==e)for(t.add(e);null!==(e=it.successor(e));)t.add(e);return t},it.prototype.rotateLeft=function(t){if(null!=t){var e=t.right;t.right=e.left,null!=e.left&&(e.left.parent=t),e.parent=t.parent,null==t.parent?this.root_=e:t.parent.left==t?t.parent.left=e:t.parent.right=e,e.left=t,t.parent=e}},it.prototype.rotateRight=function(t){if(null!=t){var e=t.left;t.left=e.right,null!=e.right&&(e.right.parent=t),e.parent=t.parent,null==t.parent?this.root_=e:t.parent.right==t?t.parent.right=e:t.parent.left=e,e.right=t,t.parent=e}},it.prototype.getFirstEntry=function(){var t=this.root_;if(null!=t)for(;null!=t.left;)t=t.left;return t},it.successor=function(t){if(null===t)return null;if(null!==t.right){for(var e=t.right;null!==e.left;)e=e.left;return e}e=t.parent;for(var n=t;null!==e&&n===e.right;)n=e,e=e.parent;return e},it.prototype.size=function(){return this.size_},e(ot.prototype,{interfaces_:function(){return[]},getClass:function(){return ot}}),at.prototype=new J,st.prototype=new at,st.prototype.contains=function(t){for(var e=0,n=this.array_.length;e<n;e++)if(0===this.array_[e].compareTo(t))return!0;return!1},st.prototype.add=function(t){if(this.contains(t))return!1;for(var e=0,n=this.array_.length;e<n;e++)if(1===this.array_[e].compareTo(t))return this.array_.splice(e,0,t),!0;return this.array_.push(t),!0},st.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},st.prototype.remove=function(t){throw new _},st.prototype.size=function(){return this.array_.length},st.prototype.isEmpty=function(){return 0===this.array_.length},st.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},st.prototype.iterator=function(){return new Go(this)};var Go=function(t){this.treeSet_=t,this.position_=0};Go.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new b;return this.treeSet_.array_[this.position_++]},Go.prototype.hasNext=function(){return this.position_<this.treeSet_.size()},Go.prototype.remove=function(){throw new _},ut.sort=function(){var t,e,n,r,i=arguments[0];if(1===arguments.length)return r=function(t,e){return t.compareTo(e)},void i.sort(r);if(2===arguments.length)n=arguments[1],r=function(t,e){return n.compare(t,e)},i.sort(r);else{if(3===arguments.length){(e=i.slice(arguments[1],arguments[2])).sort();var o=i.slice(0,arguments[1]).concat(e,i.slice(arguments[2],i.length));for(i.splice(0,i.length),t=0;t<o.length;t++)i.push(o[t]);return}if(4===arguments.length){for(e=i.slice(arguments[1],arguments[2]),n=arguments[3],r=function(t,e){return n.compare(t,e)},e.sort(r),o=i.slice(0,arguments[1]).concat(e,i.slice(arguments[2],i.length)),i.splice(0,i.length),t=0;t<o.length;t++)i.push(o[t]);return}}},ut.asList=function(t){for(var e=new x,n=0,r=t.length;n<r;n++)e.add(t[n]);return e},e(ct.prototype,{interfaces_:function(){return[]},getClass:function(){return ct}}),ct.toDimensionSymbol=function(t){switch(t){case ct.FALSE:return ct.SYM_FALSE;case ct.TRUE:return ct.SYM_TRUE;case ct.DONTCARE:return ct.SYM_DONTCARE;case ct.P:return ct.SYM_P;case ct.L:return ct.SYM_L;case ct.A:return ct.SYM_A}throw new r("Unknown dimension value: "+t)},ct.toDimensionValue=function(t){switch(T.toUpperCase(t)){case ct.SYM_FALSE:return ct.FALSE;case ct.SYM_TRUE:return ct.TRUE;case ct.SYM_DONTCARE:return ct.DONTCARE;case ct.SYM_P:return ct.P;case ct.SYM_L:return ct.L;case ct.SYM_A:return ct.A}throw new r("Unknown dimension symbol: "+t)},ct.P=0,ct.L=1,ct.A=2,ct.FALSE=-1,ct.TRUE=-2,ct.DONTCARE=-3,ct.SYM_FALSE="F",ct.SYM_TRUE="T",ct.SYM_DONTCARE="*",ct.SYM_P="0",ct.SYM_L="1",ct.SYM_A="2",e(lt.prototype,{filter:function(t){},interfaces_:function(){return[]},getClass:function(){return lt}}),e(ft.prototype,{filter:function(t,e){},isDone:function(){},isGeometryChanged:function(){},interfaces_:function(){return[]},getClass:function(){return ft}}),l(ht,B),e(ht.prototype,{computeEnvelopeInternal:function(){for(var t=new E,e=0;e<this.geometries.length;e++)t.expandToInclude(this.geometries[e].getEnvelopeInternal());return t},getGeometryN:function(t){return this.geometries[t]},getSortIndex:function(){return B.SORTINDEX_GEOMETRYCOLLECTION},getCoordinates:function(){for(var t=new Array(this.getNumPoints()).fill(null),e=-1,n=0;n<this.geometries.length;n++)for(var r=this.geometries[n].getCoordinates(),i=0;i<r.length;i++)t[++e]=r[i];return t},getArea:function(){for(var t=0,e=0;e<this.geometries.length;e++)t+=this.geometries[e].getArea();return t},equalsExact:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(!this.isEquivalentClass(t))return!1;var n=t;if(this.geometries.length!==n.geometries.length)return!1;for(var r=0;r<this.geometries.length;r++)if(!this.geometries[r].equalsExact(n.geometries[r],e))return!1;return!0}return B.prototype.equalsExact.apply(this,arguments)},normalize:function(){for(var t=0;t<this.geometries.length;t++)this.geometries[t].normalize();ut.sort(this.geometries)},getCoordinate:function(){return this.isEmpty()?null:this.geometries[0].getCoordinate()},getBoundaryDimension:function(){for(var t=ct.FALSE,e=0;e<this.geometries.length;e++)t=Math.max(t,this.geometries[e].getBoundaryDimension());return t},getDimension:function(){for(var t=ct.FALSE,e=0;e<this.geometries.length;e++)t=Math.max(t,this.geometries[e].getDimension());return t},getLength:function(){for(var t=0,e=0;e<this.geometries.length;e++)t+=this.geometries[e].getLength();return t},getNumPoints:function(){for(var t=0,e=0;e<this.geometries.length;e++)t+=this.geometries[e].getNumPoints();return t},getNumGeometries:function(){return this.geometries.length},reverse:function(){for(var t=this.geometries.length,e=new Array(t).fill(null),n=0;n<this.geometries.length;n++)e[n]=this.geometries[n].reverse();return this.getFactory().createGeometryCollection(e)},compareToSameClass:function(){if(1===arguments.length){var t=arguments[0],e=new st(ut.asList(this.geometries)),n=new st(ut.asList(t.geometries));return this.compare(e,n)}if(2===arguments.length){for(var r=arguments[0],i=arguments[1],o=r,a=this.getNumGeometries(),s=o.getNumGeometries(),u=0;u<a&&u<s;){var c=this.getGeometryN(u),l=o.getGeometryN(u),f=c.compareToSameClass(l,i);if(0!==f)return f;u++}return u<a?1:u<s?-1:0}},apply:function(){if(C(arguments[0],z))for(var t=arguments[0],e=0;e<this.geometries.length;e++)this.geometries[e].apply(t);else if(C(arguments[0],ft)){var n=arguments[0];if(0===this.geometries.length)return null;for(e=0;e<this.geometries.length&&(this.geometries[e].apply(n),!n.isDone());e++);n.isGeometryChanged()&&this.geometryChanged()}else if(C(arguments[0],lt)){var r=arguments[0];for(r.filter(this),e=0;e<this.geometries.length;e++)this.geometries[e].apply(r)}else if(C(arguments[0],D)){var i=arguments[0];for(i.filter(this),e=0;e<this.geometries.length;e++)this.geometries[e].apply(i)}},getBoundary:function(){return this.checkNotGeometryCollection(this),h.shouldNeverReachHere(),null},clone:function(){var t=B.prototype.clone.call(this);t.geometries=new Array(this.geometries.length).fill(null);for(var e=0;e<this.geometries.length;e++)t.geometries[e]=this.geometries[e].clone();return t},getGeometryType:function(){return"GeometryCollection"},copy:function(){for(var t=new Array(this.geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this.geometries[e].copy();return new ht(t,this.factory)},isEmpty:function(){for(var t=0;t<this.geometries.length;t++)if(!this.geometries[t].isEmpty())return!1;return!0},interfaces_:function(){return[]},getClass:function(){return ht}}),ht.serialVersionUID=-0x4f07bcb1f857d800,l(dt,ht),e(dt.prototype,{getSortIndex:function(){return B.SORTINDEX_MULTILINESTRING},equalsExact:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&ht.prototype.equalsExact.call(this,t,e)}return ht.prototype.equalsExact.apply(this,arguments)},getBoundaryDimension:function(){return this.isClosed()?ct.FALSE:0},isClosed:function(){if(this.isEmpty())return!1;for(var t=0;t<this.geometries.length;t++)if(!this.geometries[t].isClosed())return!1;return!0},getDimension:function(){return 1},reverse:function(){for(var t=this.geometries.length,e=new Array(t).fill(null),n=0;n<this.geometries.length;n++)e[t-1-n]=this.geometries[n].reverse();return this.getFactory().createMultiLineString(e)},getBoundary:function(){return new pt(this).getBoundary()},getGeometryType:function(){return"MultiLineString"},copy:function(){for(var t=new Array(this.geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this.geometries[e].copy();return new dt(t,this.factory)},interfaces_:function(){return[ot]},getClass:function(){return dt}}),dt.serialVersionUID=0x7155d2ab4afa8000,e(pt.prototype,{boundaryMultiLineString:function(t){if(this.geom.isEmpty())return this.getEmptyMultiPoint();var e=this.computeBoundaryCoordinates(t);return 1===e.length?this.geomFact.createPoint(e[0]):this.geomFact.createMultiPointFromCoords(e)},getBoundary:function(){return this.geom instanceof Et?this.boundaryLineString(this.geom):this.geom instanceof dt?this.boundaryMultiLineString(this.geom):this.geom.getBoundary()},boundaryLineString:function(t){return this.geom.isEmpty()?this.getEmptyMultiPoint():t.isClosed()?this.bnRule.isInBoundary(2)?t.getStartPoint():this.geomFact.createMultiPoint():this.geomFact.createMultiPoint([t.getStartPoint(),t.getEndPoint()])},getEmptyMultiPoint:function(){return this.geomFact.createMultiPoint()},computeBoundaryCoordinates:function(t){var e=new x;this.endpointMap=new it;for(var n=0;n<t.getNumGeometries();n++){var r=t.getGeometryN(n);0!==r.getNumPoints()&&(this.addEndpoint(r.getCoordinateN(0)),this.addEndpoint(r.getCoordinateN(r.getNumPoints()-1)))}for(var i=this.endpointMap.entrySet().iterator();i.hasNext();){var o=i.next(),a=o.getValue().count;this.bnRule.isInBoundary(a)&&e.add(o.getKey())}return X.toCoordinateArray(e)},addEndpoint:function(t){var e=this.endpointMap.get(t);null===e&&(e=new gt,this.endpointMap.put(t,e)),e.count++},interfaces_:function(){return[]},getClass:function(){return pt}}),pt.getBoundary=function(){if(1===arguments.length){var t=arguments[0];return new pt(t).getBoundary()}if(2===arguments.length){var e=arguments[0],n=arguments[1];return new pt(e,n).getBoundary()}},e(gt.prototype,{interfaces_:function(){return[]},getClass:function(){return gt}}),e(xt.prototype,{interfaces_:function(){return[]},getClass:function(){return xt}}),xt.chars=function(t,e){for(var n=new Array(e).fill(null),r=0;r<e;r++)n[r]=t;return new String(n)},xt.getStackTrace=function(){if(1===arguments.length){var t=arguments[0],e=new mt,n=new vt(e);return t.printStackTrace(n),e.toString()}if(2===arguments.length){for(var r=arguments[0],i=arguments[1],o="",a=new yt(xt.getStackTrace(r)),s=new _t(a),u=0;u<i;u++)try{o+=s.readLine()+xt.NEWLINE}catch(t){if(!(t instanceof bt))throw t;h.shouldNeverReachHere()}return o}},xt.split=function(t,e){for(var n=e.length,r=new x,i=""+t,o=i.indexOf(e);o>=0;){var a=i.substring(0,o);r.add(a),o=(i=i.substring(o+n)).indexOf(e)}i.length>0&&r.add(i);for(var s=new Array(r.size()).fill(null),u=0;u<s.length;u++)s[u]=r.get(u);return s},xt.toString=function(){if(1===arguments.length){var t=arguments[0];return xt.SIMPLE_ORDINATE_FORMAT.format(t)}},xt.spaces=function(t){return xt.chars(" ",t)},xt.NEWLINE=k.getProperty("line.separator"),xt.SIMPLE_ORDINATE_FORMAT=new function(){}("0.#"),e(wt.prototype,{interfaces_:function(){return[]},getClass:function(){return wt}}),wt.copyCoord=function(t,e,n,r){for(var i=Math.min(t.getDimension(),n.getDimension()),o=0;o<i;o++)n.setOrdinate(r,o,t.getOrdinate(e,o))},wt.isRing=function(t){var e=t.size();return 0===e||!(e<=3)&&t.getOrdinate(0,R.X)===t.getOrdinate(e-1,R.X)&&t.getOrdinate(0,R.Y)===t.getOrdinate(e-1,R.Y)},wt.isEqual=function(t,e){var n=t.size();if(n!==e.size())return!1;for(var r=Math.min(t.getDimension(),e.getDimension()),o=0;o<n;o++)for(var a=0;a<r;a++){var s=t.getOrdinate(o,a),u=e.getOrdinate(o,a);if(!(t.getOrdinate(o,a)===e.getOrdinate(o,a)||i.isNaN(s)&&i.isNaN(u)))return!1}return!0},wt.extend=function(t,e,n){var r=t.create(n,e.getDimension()),i=e.size();if(wt.copy(e,0,r,0,i),i>0)for(var o=i;o<n;o++)wt.copy(e,i-1,r,o,1);return r},wt.reverse=function(t){for(var e=t.size()-1,n=Math.trunc(e/2),r=0;r<=n;r++)wt.swap(t,r,e-r)},wt.swap=function(t,e,n){if(e===n)return null;for(var r=0;r<t.getDimension();r++){var i=t.getOrdinate(e,r);t.setOrdinate(e,r,t.getOrdinate(n,r)),t.setOrdinate(n,r,i)}},wt.copy=function(t,e,n,r,i){for(var o=0;o<i;o++)wt.copyCoord(t,e+o,n,r+o)},wt.toString=function(){if(1===arguments.length){var t=arguments[0],e=t.size();if(0===e)return"()";var n=t.getDimension(),r=new I;r.append("(");for(var i=0;i<e;i++){i>0&&r.append(" ");for(var o=0;o<n;o++)o>0&&r.append(","),r.append(xt.toString(t.getOrdinate(i,o)))}return r.append(")"),r.toString()}},wt.ensureValidRing=function(t,e){var n=e.size();return 0===n?e:n<=3?wt.createClosedRing(t,e,4):e.getOrdinate(0,R.X)===e.getOrdinate(n-1,R.X)&&e.getOrdinate(0,R.Y)===e.getOrdinate(n-1,R.Y)?e:wt.createClosedRing(t,e,n+1)},wt.createClosedRing=function(t,e,n){var r=t.create(n,e.getDimension()),i=e.size();wt.copy(e,0,r,0,i);for(var o=i;o<n;o++)wt.copy(e,0,r,o,1);return r},l(Et,B),e(Et.prototype,{computeEnvelopeInternal:function(){return this.isEmpty()?new E:this.points.expandEnvelope(new E)},isRing:function(){return this.isClosed()&&this.isSimple()},getSortIndex:function(){return B.SORTINDEX_LINESTRING},getCoordinates:function(){return this.points.toCoordinateArray()},equalsExact:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(!this.isEquivalentClass(t))return!1;var n=t;if(this.points.size()!==n.points.size())return!1;for(var r=0;r<this.points.size();r++)if(!this.equal(this.points.getCoordinate(r),n.points.getCoordinate(r),e))return!1;return!0}return B.prototype.equalsExact.apply(this,arguments)},normalize:function(){for(var t=0;t<Math.trunc(this.points.size()/2);t++){var e=this.points.size()-1-t;if(!this.points.getCoordinate(t).equals(this.points.getCoordinate(e)))return this.points.getCoordinate(t).compareTo(this.points.getCoordinate(e))>0&&wt.reverse(this.points),null}},getCoordinate:function(){return this.isEmpty()?null:this.points.getCoordinate(0)},getBoundaryDimension:function(){return this.isClosed()?ct.FALSE:0},isClosed:function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},getEndPoint:function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},getDimension:function(){return 1},getLength:function(){return $t.computeLength(this.points)},getNumPoints:function(){return this.points.size()},reverse:function(){var t=this.points.copy();return wt.reverse(t),this.getFactory().createLineString(t)},compareToSameClass:function(){if(1===arguments.length){for(var t=arguments[0],e=t,n=0,r=0;n<this.points.size()&&r<e.points.size();){var i=this.points.getCoordinate(n).compareTo(e.points.getCoordinate(r));if(0!==i)return i;n++,r++}return n<this.points.size()?1:r<e.points.size()?-1:0}if(2===arguments.length){var o=arguments[0],a=arguments[1];return e=o,a.compare(this.points,e.points)}},apply:function(){if(C(arguments[0],z))for(var t=arguments[0],e=0;e<this.points.size();e++)t.filter(this.points.getCoordinate(e));else if(C(arguments[0],ft)){var n=arguments[0];if(0===this.points.size())return null;for(e=0;e<this.points.size()&&(n.filter(this.points,e),!n.isDone());e++);n.isGeometryChanged()&&this.geometryChanged()}else if(C(arguments[0],lt)){var r=arguments[0];r.filter(this)}else if(C(arguments[0],D)){var i=arguments[0];i.filter(this)}},getBoundary:function(){return new pt(this).getBoundary()},isEquivalentClass:function(t){return t instanceof Et},clone:function(){var t=B.prototype.clone.call(this);return t.points=this.points.clone(),t},getCoordinateN:function(t){return this.points.getCoordinate(t)},getGeometryType:function(){return"LineString"},copy:function(){return new Et(this.points.copy(),this.factory)},getCoordinateSequence:function(){return this.points},isEmpty:function(){return 0===this.points.size()},init:function(t){if(null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),1===t.size())throw new r("Invalid number of points in LineString (found "+t.size()+" - must be 0 or >= 2)");this.points=t},isCoordinate:function(t){for(var e=0;e<this.points.size();e++)if(this.points.getCoordinate(e).equals(t))return!0;return!1},getStartPoint:function(){return this.isEmpty()?null:this.getPointN(0)},getPointN:function(t){return this.getFactory().createPoint(this.points.getCoordinate(t))},interfaces_:function(){return[ot]},getClass:function(){return Et}}),Et.serialVersionUID=0x2b2b51ba435c8e00,e(St.prototype,{interfaces_:function(){return[]},getClass:function(){return St}}),l(Ot,B),e(Ot.prototype,{computeEnvelopeInternal:function(){if(this.isEmpty())return new E;var t=new E;return t.expandToInclude(this.coordinates.getX(0),this.coordinates.getY(0)),t},getSortIndex:function(){return B.SORTINDEX_POINT},getCoordinates:function(){return this.isEmpty()?[]:[this.getCoordinate()]},equalsExact:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&(!(!this.isEmpty()||!t.isEmpty())||this.isEmpty()===t.isEmpty()&&this.equal(t.getCoordinate(),this.getCoordinate(),e))}return B.prototype.equalsExact.apply(this,arguments)},normalize:function(){},getCoordinate:function(){return 0!==this.coordinates.size()?this.coordinates.getCoordinate(0):null},getBoundaryDimension:function(){return ct.FALSE},getDimension:function(){return 0},getNumPoints:function(){return this.isEmpty()?0:1},reverse:function(){return this.copy()},getX:function(){if(null===this.getCoordinate())throw new IllegalStateException("getX called on empty Point");return this.getCoordinate().x},compareToSameClass:function(){if(1===arguments.length){var t=arguments[0],e=t;return this.getCoordinate().compareTo(e.getCoordinate())}if(2===arguments.length){var n=arguments[0],r=arguments[1];return e=n,r.compare(this.coordinates,e.coordinates)}},apply:function(){if(C(arguments[0],z)){var t=arguments[0];if(this.isEmpty())return null;t.filter(this.getCoordinate())}else if(C(arguments[0],ft)){var e=arguments[0];if(this.isEmpty())return null;e.filter(this.coordinates,0),e.isGeometryChanged()&&this.geometryChanged()}else if(C(arguments[0],lt)){var n=arguments[0];n.filter(this)}else if(C(arguments[0],D)){var r=arguments[0];r.filter(this)}},getBoundary:function(){return this.getFactory().createGeometryCollection(null)},clone:function(){var t=B.prototype.clone.call(this);return t.coordinates=this.coordinates.clone(),t},getGeometryType:function(){return"Point"},copy:function(){return new Ot(this.coordinates.copy(),this.factory)},getCoordinateSequence:function(){return this.coordinates},getY:function(){if(null===this.getCoordinate())throw new IllegalStateException("getY called on empty Point");return this.getCoordinate().y},isEmpty:function(){return 0===this.coordinates.size()},init:function(t){null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),h.isTrue(t.size()<=1),this.coordinates=t},isSimple:function(){return!0},interfaces_:function(){return[St]},getClass:function(){return Ot}}),Ot.serialVersionUID=0x44077bad161cbc00,e(Pt.prototype,{interfaces_:function(){return[]},getClass:function(){return Pt}}),l(Ct,B),e(Ct.prototype,{computeEnvelopeInternal:function(){return this.shell.getEnvelopeInternal()},getSortIndex:function(){return B.SORTINDEX_POLYGON},getCoordinates:function(){if(this.isEmpty())return[];for(var t=new Array(this.getNumPoints()).fill(null),e=-1,n=this.shell.getCoordinates(),r=0;r<n.length;r++)t[++e]=n[r];for(var i=0;i<this.holes.length;i++)for(var o=this.holes[i].getCoordinates(),a=0;a<o.length;a++)t[++e]=o[a];return t},getArea:function(){var t=0;t+=Math.abs($t.signedArea(this.shell.getCoordinateSequence()));for(var e=0;e<this.holes.length;e++)t-=Math.abs($t.signedArea(this.holes[e].getCoordinateSequence()));return t},isRectangle:function(){if(0!==this.getNumInteriorRing())return!1;if(null===this.shell)return!1;if(5!==this.shell.getNumPoints())return!1;for(var t=this.shell.getCoordinateSequence(),e=this.getEnvelopeInternal(),n=0;n<5;n++){if((o=t.getX(n))!==e.getMinX()&&o!==e.getMaxX())return!1;if((a=t.getY(n))!==e.getMinY()&&a!==e.getMaxY())return!1}var r=t.getX(0),i=t.getY(0);for(n=1;n<=4;n++){var o,a;if((o=t.getX(n))!==r==((a=t.getY(n))!==i))return!1;r=o,i=a}return!0},equalsExact:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(!this.isEquivalentClass(t))return!1;var n=t,r=this.shell,i=n.shell;if(!r.equalsExact(i,e))return!1;if(this.holes.length!==n.holes.length)return!1;for(var o=0;o<this.holes.length;o++)if(!this.holes[o].equalsExact(n.holes[o],e))return!1;return!0}return B.prototype.equalsExact.apply(this,arguments)},normalize:function(){if(0===arguments.length){this.normalize(this.shell,!0);for(var t=0;t<this.holes.length;t++)this.normalize(this.holes[t],!1);ut.sort(this.holes)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(e.isEmpty())return null;var r=new Array(e.getCoordinates().length-1).fill(null);k.arraycopy(e.getCoordinates(),0,r,0,r.length);var i=X.minCoordinate(e.getCoordinates());X.scroll(r,i),k.arraycopy(r,0,e.getCoordinates(),0,r.length),e.getCoordinates()[r.length]=r[0],$t.isCCW(e.getCoordinates())===n&&X.reverse(e.getCoordinates())}},getCoordinate:function(){return this.shell.getCoordinate()},getNumInteriorRing:function(){return this.holes.length},getBoundaryDimension:function(){return 1},getDimension:function(){return 2},getLength:function(){var t=0;t+=this.shell.getLength();for(var e=0;e<this.holes.length;e++)t+=this.holes[e].getLength();return t},getNumPoints:function(){for(var t=this.shell.getNumPoints(),e=0;e<this.holes.length;e++)t+=this.holes[e].getNumPoints();return t},reverse:function(){var t=this.copy();t.shell=this.shell.copy().reverse(),t.holes=new Array(this.holes.length).fill(null);for(var e=0;e<this.holes.length;e++)t.holes[e]=this.holes[e].copy().reverse();return t},convexHull:function(){return this.getExteriorRing().convexHull()},compareToSameClass:function(){if(1===arguments.length){var t=arguments[0],e=this.shell,n=t.shell;return e.compareToSameClass(n)}if(2===arguments.length){var r=arguments[0],i=arguments[1],o=r,a=(e=this.shell,n=o.shell,e.compareToSameClass(n,i));if(0!==a)return a;for(var s=this.getNumInteriorRing(),u=o.getNumInteriorRing(),c=0;c<s&&c<u;){var l=this.getInteriorRingN(c),f=o.getInteriorRingN(c),h=l.compareToSameClass(f,i);if(0!==h)return h;c++}return c<s?1:c<u?-1:0}},apply:function(){if(C(arguments[0],z)){var t=arguments[0];this.shell.apply(t);for(var e=0;e<this.holes.length;e++)this.holes[e].apply(t)}else if(C(arguments[0],ft)){var n=arguments[0];if(this.shell.apply(n),!n.isDone())for(e=0;e<this.holes.length&&(this.holes[e].apply(n),!n.isDone());e++);n.isGeometryChanged()&&this.geometryChanged()}else if(C(arguments[0],lt)){var r=arguments[0];r.filter(this)}else if(C(arguments[0],D)){var i=arguments[0];for(i.filter(this),this.shell.apply(i),e=0;e<this.holes.length;e++)this.holes[e].apply(i)}},getBoundary:function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var t=new Array(this.holes.length+1).fill(null);t[0]=this.shell;for(var e=0;e<this.holes.length;e++)t[e+1]=this.holes[e];return t.length<=1?this.getFactory().createLinearRing(t[0].getCoordinateSequence()):this.getFactory().createMultiLineString(t)},clone:function(){var t=B.prototype.clone.call(this);t.shell=this.shell.clone(),t.holes=new Array(this.holes.length).fill(null);for(var e=0;e<this.holes.length;e++)t.holes[e]=this.holes[e].clone();return t},getGeometryType:function(){return"Polygon"},copy:function(){for(var t=this.shell.copy(),e=new Array(this.holes.length).fill(null),n=0;n<e.length;n++)e[n]=this.holes[n].copy();return new Ct(t,e,this.factory)},getExteriorRing:function(){return this.shell},isEmpty:function(){return this.shell.isEmpty()},getInteriorRingN:function(t){return this.holes[t]},interfaces_:function(){return[Pt]},getClass:function(){return Ct}}),Ct.serialVersionUID=-0x307ffefd8dc97200,l(Mt,ht),e(Mt.prototype,{getSortIndex:function(){return B.SORTINDEX_MULTIPOINT},isValid:function(){return!0},equalsExact:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&ht.prototype.equalsExact.call(this,t,e)}return ht.prototype.equalsExact.apply(this,arguments)},getCoordinate:function(){if(1===arguments.length){var t=arguments[0];return this.geometries[t].getCoordinate()}return ht.prototype.getCoordinate.apply(this,arguments)},getBoundaryDimension:function(){return ct.FALSE},getDimension:function(){return 0},getBoundary:function(){return this.getFactory().createGeometryCollection(null)},getGeometryType:function(){return"MultiPoint"},copy:function(){for(var t=new Array(this.geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this.geometries[e].copy();return new Mt(t,this.factory)},interfaces_:function(){return[St]},getClass:function(){return Mt}}),Mt.serialVersionUID=-0x6fb1ed4162e0fc00,l(It,Et),e(It.prototype,{getSortIndex:function(){return B.SORTINDEX_LINEARRING},getBoundaryDimension:function(){return ct.FALSE},isClosed:function(){return!!this.isEmpty()||Et.prototype.isClosed.call(this)},reverse:function(){var t=this.points.copy();return wt.reverse(t),this.getFactory().createLinearRing(t)},validateConstruction:function(){if(!this.isEmpty()&&!Et.prototype.isClosed.call(this))throw new r("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<It.MINIMUM_VALID_SIZE)throw new r("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},getGeometryType:function(){return"LinearRing"},copy:function(){return new It(this.points.copy(),this.factory)},interfaces_:function(){return[]},getClass:function(){return It}}),It.MINIMUM_VALID_SIZE=4,It.serialVersionUID=-0x3b229e262367a600,l(At,ht),e(At.prototype,{getSortIndex:function(){return B.SORTINDEX_MULTIPOLYGON},equalsExact:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&ht.prototype.equalsExact.call(this,t,e)}return ht.prototype.equalsExact.apply(this,arguments)},getBoundaryDimension:function(){return 1},getDimension:function(){return 2},reverse:function(){for(var t=this.geometries.length,e=new Array(t).fill(null),n=0;n<this.geometries.length;n++)e[n]=this.geometries[n].reverse();return this.getFactory().createMultiPolygon(e)},getBoundary:function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var t=new x,e=0;e<this.geometries.length;e++)for(var n=this.geometries[e].getBoundary(),r=0;r<n.getNumGeometries();r++)t.add(n.getGeometryN(r));var i=new Array(t.size()).fill(null);return this.getFactory().createMultiLineString(t.toArray(i))},getGeometryType:function(){return"MultiPolygon"},copy:function(){for(var t=new Array(this.geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this.geometries[e].copy();return new At(t,this.factory)},interfaces_:function(){return[Pt]},getClass:function(){return At}}),At.serialVersionUID=-0x7a5aa1369171980,e(Tt.prototype,{setCopyUserData:function(t){this.isUserDataCopied=t},edit:function(t,e){if(null===t)return null;var n=this.editInternal(t,e);return this.isUserDataCopied&&n.setUserData(t.getUserData()),n},editInternal:function(t,e){return null===this.factory&&(this.factory=t.getFactory()),t instanceof ht?this.editGeometryCollection(t,e):t instanceof Ct?this.editPolygon(t,e):t instanceof Ot||t instanceof Et?e.edit(t,this.factory):(h.shouldNeverReachHere("Unsupported Geometry class: "+t.getClass().getName()),null)},editGeometryCollection:function(t,e){for(var n=e.edit(t,this.factory),r=new x,i=0;i<n.getNumGeometries();i++){var o=this.edit(n.getGeometryN(i),e);null===o||o.isEmpty()||r.add(o)}return n.getClass()===Mt?this.factory.createMultiPoint(r.toArray([])):n.getClass()===dt?this.factory.createMultiLineString(r.toArray([])):n.getClass()===At?this.factory.createMultiPolygon(r.toArray([])):this.factory.createGeometryCollection(r.toArray([]))},editPolygon:function(t,e){var n=e.edit(t,this.factory);if(null===n&&(n=this.factory.createPolygon(null)),n.isEmpty())return n;var r=this.edit(n.getExteriorRing(),e);if(null===r||r.isEmpty())return this.factory.createPolygon();for(var i=new x,o=0;o<n.getNumInteriorRing();o++){var a=this.edit(n.getInteriorRingN(o),e);null===a||a.isEmpty()||i.add(a)}return this.factory.createPolygon(r,i.toArray([]))},interfaces_:function(){return[]},getClass:function(){return Tt}}),Tt.GeometryEditorOperation=Nt,e(Lt.prototype,{edit:function(t,e){return t},interfaces_:function(){return[Nt]},getClass:function(){return Lt}}),e(Rt.prototype,{edit:function(t,e){var n=this.editCoordinates(t.getCoordinates(),t);return null===n?t:t instanceof It?e.createLinearRing(n):t instanceof Et?e.createLineString(n):t instanceof Ot?n.length>0?e.createPoint(n[0]):e.createPoint():t},interfaces_:function(){return[Nt]},getClass:function(){return Rt}}),e(kt.prototype,{edit:function(t,e){return t instanceof It?e.createLinearRing(this.edit(t.getCoordinateSequence(),t)):t instanceof Et?e.createLineString(this.edit(t.getCoordinateSequence(),t)):t instanceof Ot?e.createPoint(this.edit(t.getCoordinateSequence(),t)):t},interfaces_:function(){return[Nt]},getClass:function(){return kt}}),Tt.NoOpGeometryOperation=Lt,Tt.CoordinateOperation=Rt,Tt.CoordinateSequenceOperation=kt,e(jt.prototype,{setOrdinate:function(t,e,n){switch(e){case R.X:this.coordinates[t].x=n;break;case R.Y:this.coordinates[t].y=n;break;case R.Z:this.coordinates[t].z=n;break;default:throw new r("invalid ordinateIndex")}},size:function(){return this.coordinates.length},getOrdinate:function(t,e){switch(e){case R.X:return this.coordinates[t].x;case R.Y:return this.coordinates[t].y;case R.Z:return this.coordinates[t].z}return i.NaN},getCoordinate:function(){if(1===arguments.length){var t=arguments[0];return this.coordinates[t]}if(2===arguments.length){var e=arguments[0],n=arguments[1];n.x=this.coordinates[e].x,n.y=this.coordinates[e].y,n.z=this.coordinates[e].z}},getCoordinateCopy:function(t){return new d(this.coordinates[t])},getDimension:function(){return this.dimension},getX:function(t){return this.coordinates[t].x},clone:function(){for(var t=new Array(this.size()).fill(null),e=0;e<this.coordinates.length;e++)t[e]=this.coordinates[e].clone();return new jt(t,this.dimension)},expandEnvelope:function(t){for(var e=0;e<this.coordinates.length;e++)t.expandToInclude(this.coordinates[e]);return t},copy:function(){for(var t=new Array(this.size()).fill(null),e=0;e<this.coordinates.length;e++)t[e]=this.coordinates[e].copy();return new jt(t,this.dimension)},toString:function(){if(this.coordinates.length>0){var t=new I(17*this.coordinates.length);t.append("("),t.append(this.coordinates[0]);for(var e=1;e<this.coordinates.length;e++)t.append(", "),t.append(this.coordinates[e]);return t.append(")"),t.toString()}return"()"},getY:function(t){return this.coordinates[t].y},toCoordinateArray:function(){return this.coordinates},interfaces_:function(){return[R,u]},getClass:function(){return jt}}),jt.serialVersionUID=-0xcb44a778db18e00,e(Ft.prototype,{readResolve:function(){return Ft.instance()},create:function(){if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return new jt(t)}if(C(arguments[0],R)){var e=arguments[0];return new jt(e)}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];return r>3&&(r=3),r<2?new jt(n):new jt(n,r)}},interfaces_:function(){return[F,u]},getClass:function(){return Ft}}),Ft.instance=function(){return Ft.instanceObject},Ft.serialVersionUID=-0x38e49fa6cf6f2e00,Ft.instanceObject=new Ft;var Uo,Wo=Object.defineProperty,qo=function(t,e){function n(t){return this&&this.constructor===n?(this._keys=[],this._values=[],this._itp=[],this.objectOnly=e,void(t&&Bt.call(this,t))):new n(t)}return e||Wo(t,"size",{get:Gt}),t.constructor=n,n.prototype=t,n}({delete:function(t){return this.has(t)&&(this._keys.splice(Uo,1),this._values.splice(Uo,1),this._itp.forEach((function(t){Uo<t[0]&&t[0]--}))),Uo>-1},has:function(t){return zt.call(this,this._keys,t)},get:function(t){return this.has(t)?this._values[Uo]:void 0},set:function(t,e){return this.has(t)?this._values[Uo]=e:this._values[this._keys.push(t)-1]=e,this},keys:function(){return Vt(this._itp,this._keys)},values:function(){return Vt(this._itp,this._values)},entries:function(){return Vt(this._itp,this._keys,this._values)},forEach:function(t,e){for(var n=this.entries();;){var r=n.next();if(r.done)break;t.call(e,r.value[1],r.value[0],this)}},clear:function(){(this._keys||0).length=this._values.length=0}}),Xo="undefined"!=typeof Map&&Map.prototype.values?Map:qo;Ut.prototype=new Z,Ut.prototype.get=function(t){return this.map_.get(t)||null},Ut.prototype.put=function(t,e){return this.map_.set(t,e),e},Ut.prototype.values=function(){for(var t=new x,e=this.map_.values(),n=e.next();!n.done;)t.add(n.value),n=e.next();return t},Ut.prototype.entrySet=function(){var t=new Q;return this.map_.entries().forEach((function(e){return t.add(e)})),t},Ut.prototype.size=function(){return this.map_.size()},e(Wt.prototype,{equals:function(t){if(!(t instanceof Wt))return!1;var e=t;return this.modelType===e.modelType&&this.scale===e.scale},compareTo:function(t){var e=t,n=this.getMaximumSignificantDigits(),r=e.getMaximumSignificantDigits();return new A(n).compareTo(new A(r))},getScale:function(){return this.scale},isFloating:function(){return this.modelType===Wt.FLOATING||this.modelType===Wt.FLOATING_SINGLE},getType:function(){return this.modelType},toString:function(){var t="UNKNOWN";return this.modelType===Wt.FLOATING?t="Floating":this.modelType===Wt.FLOATING_SINGLE?t="Floating-Single":this.modelType===Wt.FIXED&&(t="Fixed (Scale="+this.getScale()+")"),t},makePrecise:function(){if("number"==typeof arguments[0]){var t=arguments[0];return i.isNaN(t)||this.modelType===Wt.FLOATING_SINGLE?t:this.modelType===Wt.FIXED?Math.round(t*this.scale)/this.scale:t}if(arguments[0]instanceof d){var e=arguments[0];if(this.modelType===Wt.FLOATING)return null;e.x=this.makePrecise(e.x),e.y=this.makePrecise(e.y)}},getMaximumSignificantDigits:function(){var t=16;return this.modelType===Wt.FLOATING?t=16:this.modelType===Wt.FLOATING_SINGLE?t=6:this.modelType===Wt.FIXED&&(t=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),t},setScale:function(t){this.scale=Math.abs(t)},interfaces_:function(){return[u,o]},getClass:function(){return Wt}}),Wt.mostPrecise=function(t,e){return t.compareTo(e)>=0?t:e},e(qt.prototype,{readResolve:function(){return qt.nameToTypeMap.get(this.name)},toString:function(){return this.name},interfaces_:function(){return[u]},getClass:function(){return qt}}),qt.serialVersionUID=-552860263173159e4,qt.nameToTypeMap=new Ut,Wt.Type=qt,Wt.serialVersionUID=0x6bee6404e9a25c00,Wt.FIXED=new qt("FIXED"),Wt.FLOATING=new qt("FLOATING"),Wt.FLOATING_SINGLE=new qt("FLOATING SINGLE"),Wt.maximumPreciseValue=9007199254740992,e(Xt.prototype,{toGeometry:function(t){return t.isNull()?this.createPoint(null):t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new d(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new d(t.getMinX(),t.getMinY()),new d(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new d(t.getMinX(),t.getMinY()),new d(t.getMinX(),t.getMaxY()),new d(t.getMaxX(),t.getMaxY()),new d(t.getMaxX(),t.getMinY()),new d(t.getMinX(),t.getMinY())]),null)},createLineString:function(){if(0===arguments.length)return this.createLineString(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return this.createLineString(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(C(arguments[0],R)){var e=arguments[0];return new Et(e,this)}}},createMultiLineString:function(){if(0===arguments.length)return new dt(null,this);if(1===arguments.length){var t=arguments[0];return new dt(t,this)}},buildGeometry:function(t){for(var e=null,n=!1,r=!1,i=t.iterator();i.hasNext();){var o=i.next(),a=o.getClass();null===e&&(e=a),a!==e&&(n=!0),o.isGeometryCollectionOrDerived()&&(r=!0)}if(null===e)return this.createGeometryCollection();if(n||r)return this.createGeometryCollection(Xt.toGeometryArray(t));var s=t.iterator().next();if(t.size()>1){if(s instanceof Ct)return this.createMultiPolygon(Xt.toPolygonArray(t));if(s instanceof Et)return this.createMultiLineString(Xt.toLineStringArray(t));if(s instanceof Ot)return this.createMultiPoint(Xt.toPointArray(t));h.shouldNeverReachHere("Unhandled class: "+s.getClass().getName())}return s},createMultiPointFromCoords:function(t){return this.createMultiPoint(null!==t?this.getCoordinateSequenceFactory().create(t):null)},createPoint:function(){if(0===arguments.length)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof d){var t=arguments[0];return this.createPoint(null!==t?this.getCoordinateSequenceFactory().create([t]):null)}if(C(arguments[0],R)){var e=arguments[0];return new Ot(e,this)}}},getCoordinateSequenceFactory:function(){return this.coordinateSequenceFactory},createPolygon:function(){if(0===arguments.length)return new Ct(null,null,this);if(1===arguments.length){if(C(arguments[0],R)){var t=arguments[0];return this.createPolygon(this.createLinearRing(t))}if(arguments[0]instanceof Array){var e=arguments[0];return this.createPolygon(this.createLinearRing(e))}if(arguments[0]instanceof It){var n=arguments[0];return this.createPolygon(n,null)}}else if(2===arguments.length){var r=arguments[0],i=arguments[1];return new Ct(r,i,this)}},getSRID:function(){return this.SRID},createGeometryCollection:function(){if(0===arguments.length)return new ht(null,this);if(1===arguments.length){var t=arguments[0];return new ht(t,this)}},createGeometry:function(t){return new Tt(this).edit(t,{edit:function(){if(2===arguments.length){var t=arguments[0];return arguments[1],this.coordinateSequenceFactory.create(t)}}})},getPrecisionModel:function(){return this.precisionModel},createLinearRing:function(){if(0===arguments.length)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return this.createLinearRing(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(C(arguments[0],R)){var e=arguments[0];return new It(e,this)}}},createMultiPolygon:function(){if(0===arguments.length)return new At(null,this);if(1===arguments.length){var t=arguments[0];return new At(t,this)}},createMultiPoint:function(){if(0===arguments.length)return new Mt(null,this);if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return new Mt(t,this)}if(arguments[0]instanceof Array){var e=arguments[0];return this.createMultiPoint(null!==e?this.getCoordinateSequenceFactory().create(e):null)}if(C(arguments[0],R)){var n=arguments[0];if(null===n)return this.createMultiPoint(new Array(0).fill(null));for(var r=new Array(n.size()).fill(null),i=0;i<n.size();i++){var o=this.getCoordinateSequenceFactory().create(1,n.getDimension());wt.copy(n,i,o,0,1),r[i]=this.createPoint(o)}return this.createMultiPoint(r)}}},interfaces_:function(){return[u]},getClass:function(){return Xt}}),Xt.toMultiPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},Xt.toGeometryArray=function(t){if(null===t)return null;var e=new Array(t.size()).fill(null);return t.toArray(e)},Xt.getDefaultCoordinateSequenceFactory=function(){return Ft.instance()},Xt.toMultiLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},Xt.toLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},Xt.toMultiPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},Xt.toLinearRingArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},Xt.toPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},Xt.toPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},Xt.createPointFromInternalCoord=function(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)},Xt.serialVersionUID=-0x5ea75f2051eeb400;var Ho={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/};e(Ht.prototype,{read:function(t){var e,n,r;t=t.replace(/[\n\r]/g," ");var i=Ho.typeStr.exec(t);if(-1!==t.search("EMPTY")&&((i=Ho.emptyTypeStr.exec(t))[2]=void 0),i&&(n=i[1].toLowerCase(),r=i[2],Zo[n]&&(e=Zo[n].apply(this,[r]))),void 0===e)throw new Error("Could not parse WKT "+t);return e},write:function(t){return this.extractGeometry(t)},extractGeometry:function(t){var e=t.getGeometryType().toLowerCase();if(!Yo[e])return null;var n=e.toUpperCase();return t.isEmpty()?n+" EMPTY":n+"("+Yo[e].apply(this,[t])+")"}});var Yo={coordinate:function(t){return t.x+" "+t.y},point:function(t){return Yo.coordinate.call(this,t.coordinates.coordinates[0])},multipoint:function(t){for(var e=[],n=0,r=t.geometries.length;n<r;++n)e.push("("+Yo.point.apply(this,[t.geometries[n]])+")");return e.join(",")},linestring:function(t){for(var e=[],n=0,r=t.points.coordinates.length;n<r;++n)e.push(Yo.coordinate.apply(this,[t.points.coordinates[n]]));return e.join(",")},linearring:function(t){for(var e=[],n=0,r=t.points.coordinates.length;n<r;++n)e.push(Yo.coordinate.apply(this,[t.points.coordinates[n]]));return e.join(",")},multilinestring:function(t){for(var e=[],n=0,r=t.geometries.length;n<r;++n)e.push("("+Yo.linestring.apply(this,[t.geometries[n]])+")");return e.join(",")},polygon:function(t){var e=[];e.push("("+Yo.linestring.apply(this,[t.shell])+")");for(var n=0,r=t.holes.length;n<r;++n)e.push("("+Yo.linestring.apply(this,[t.holes[n]])+")");return e.join(",")},multipolygon:function(t){for(var e=[],n=0,r=t.geometries.length;n<r;++n)e.push("("+Yo.polygon.apply(this,[t.geometries[n]])+")");return e.join(",")},geometrycollection:function(t){for(var e=[],n=0,r=t.geometries.length;n<r;++n)e.push(this.extractGeometry(t.geometries[n]));return e.join(",")}},Zo={point:function(t){if(void 0===t)return this.geometryFactory.createPoint();var e=t.trim().split(Ho.spaces);return this.geometryFactory.createPoint(new d(Number.parseFloat(e[0]),Number.parseFloat(e[1])))},multipoint:function(t){if(void 0===t)return this.geometryFactory.createMultiPoint();for(var e,n=t.trim().split(","),r=[],i=0,o=n.length;i<o;++i)e=n[i].replace(Ho.trimParens,"$1"),r.push(Zo.point.apply(this,[e]));return this.geometryFactory.createMultiPoint(r)},linestring:function(t){if(void 0===t)return this.geometryFactory.createLineString();for(var e,n=t.trim().split(","),r=[],i=0,o=n.length;i<o;++i)e=n[i].trim().split(Ho.spaces),r.push(new d(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLineString(r)},linearring:function(t){if(void 0===t)return this.geometryFactory.createLinearRing();for(var e,n=t.trim().split(","),r=[],i=0,o=n.length;i<o;++i)e=n[i].trim().split(Ho.spaces),r.push(new d(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLinearRing(r)},multilinestring:function(t){if(void 0===t)return this.geometryFactory.createMultiLineString();for(var e,n=t.trim().split(Ho.parenComma),r=[],i=0,o=n.length;i<o;++i)e=n[i].replace(Ho.trimParens,"$1"),r.push(Zo.linestring.apply(this,[e]));return this.geometryFactory.createMultiLineString(r)},polygon:function(t){if(void 0===t)return this.geometryFactory.createPolygon();for(var e,n,r,i,o=t.trim().split(Ho.parenComma),a=[],s=0,u=o.length;s<u;++s)e=o[s].replace(Ho.trimParens,"$1"),n=Zo.linestring.apply(this,[e]),r=this.geometryFactory.createLinearRing(n.points),0===s?i=r:a.push(r);return this.geometryFactory.createPolygon(i,a)},multipolygon:function(t){if(void 0===t)return this.geometryFactory.createMultiPolygon();for(var e,n=t.trim().split(Ho.doubleParenComma),r=[],i=0,o=n.length;i<o;++i)e=n[i].replace(Ho.trimParens,"$1"),r.push(Zo.polygon.apply(this,[e]));return this.geometryFactory.createMultiPolygon(r)},geometrycollection:function(t){if(void 0===t)return this.geometryFactory.createGeometryCollection();for(var e=(t=t.replace(/,\s*([A-Za-z])/g,"|$1")).trim().split("|"),n=[],r=0,i=e.length;r<i;++r)n.push(this.read(e[r]));return this.geometryFactory.createGeometryCollection(n)}};e(Yt.prototype,{write:function(t){return this.parser.write(t)}}),e(Yt,{toLineString:function(t,e){if(2!==arguments.length)throw new Error("Not implemented");return"LINESTRING ( "+t.x+" "+t.y+", "+e.x+" "+e.y+" )"}}),e(Zt.prototype,{getIndexAlongSegment:function(t,e){return this.computeIntLineIndex(),this.intLineIndex[t][e]},getTopologySummary:function(){var t=new I;return this.isEndPoint()&&t.append(" endpoint"),this._isProper&&t.append(" proper"),this.isCollinear()&&t.append(" collinear"),t.toString()},computeIntersection:function(t,e,n,r){this.inputLines[0][0]=t,this.inputLines[0][1]=e,this.inputLines[1][0]=n,this.inputLines[1][1]=r,this.result=this.computeIntersect(t,e,n,r)},getIntersectionNum:function(){return this.result},computeIntLineIndex:function(){if(0===arguments.length)null===this.intLineIndex&&(this.intLineIndex=Array(2).fill().map((function(){return Array(2)})),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(1===arguments.length){var t=arguments[0],e=this.getEdgeDistance(t,0),n=this.getEdgeDistance(t,1);e>n?(this.intLineIndex[t][0]=0,this.intLineIndex[t][1]=1):(this.intLineIndex[t][0]=1,this.intLineIndex[t][1]=0)}},isProper:function(){return this.hasIntersection()&&this._isProper},setPrecisionModel:function(t){this.precisionModel=t},isInteriorIntersection:function(){if(0===arguments.length)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(1===arguments.length){for(var t=arguments[0],e=0;e<this.result;e++)if(!this.intPt[e].equals2D(this.inputLines[t][0])&&!this.intPt[e].equals2D(this.inputLines[t][1]))return!0;return!1}},getIntersection:function(t){return this.intPt[t]},isEndPoint:function(){return this.hasIntersection()&&!this._isProper},hasIntersection:function(){return this.result!==Zt.NO_INTERSECTION},getEdgeDistance:function(t,e){return Zt.computeEdgeDistance(this.intPt[e],this.inputLines[t][0],this.inputLines[t][1])},isCollinear:function(){return this.result===Zt.COLLINEAR_INTERSECTION},toString:function(){return Yt.toLineString(this.inputLines[0][0],this.inputLines[0][1])+" - "+Yt.toLineString(this.inputLines[1][0],this.inputLines[1][1])+this.getTopologySummary()},getEndpoint:function(t,e){return this.inputLines[t][e]},isIntersection:function(t){for(var e=0;e<this.result;e++)if(this.intPt[e].equals2D(t))return!0;return!1},getIntersectionAlongSegment:function(t,e){return this.computeIntLineIndex(),this.intPt[this.intLineIndex[t][e]]},interfaces_:function(){return[]},getClass:function(){return Zt}}),Zt.computeEdgeDistance=function(t,e,n){var r=Math.abs(n.x-e.x),i=Math.abs(n.y-e.y),o=-1;if(t.equals(e))o=0;else if(t.equals(n))o=r>i?r:i;else{var a=Math.abs(t.x-e.x),s=Math.abs(t.y-e.y);0!==(o=r>i?a:s)||t.equals(e)||(o=Math.max(a,s))}return h.isTrue(!(0===o&&!t.equals(e)),"Bad distance calculation"),o},Zt.nonRobustComputeEdgeDistance=function(t,e,n){var r=t.x-e.x,i=t.y-e.y,o=Math.sqrt(r*r+i*i);return h.isTrue(!(0===o&&!t.equals(e)),"Invalid distance calculation"),o},Zt.DONT_INTERSECT=0,Zt.DO_INTERSECT=1,Zt.COLLINEAR=2,Zt.NO_INTERSECTION=0,Zt.POINT_INTERSECTION=1,Zt.COLLINEAR_INTERSECTION=2,l(Kt,Zt),e(Kt.prototype,{isInSegmentEnvelopes:function(t){var e=new E(this.inputLines[0][0],this.inputLines[0][1]),n=new E(this.inputLines[1][0],this.inputLines[1][1]);return e.contains(t)&&n.contains(t)},computeIntersection:function(){if(3!==arguments.length)return Zt.prototype.computeIntersection.apply(this,arguments);var t=arguments[0],e=arguments[1],n=arguments[2];return this._isProper=!1,E.intersects(e,n,t)&&0===$t.orientationIndex(e,n,t)&&0===$t.orientationIndex(n,e,t)?(this._isProper=!0,(t.equals(e)||t.equals(n))&&(this._isProper=!1),this.result=Zt.POINT_INTERSECTION,null):void(this.result=Zt.NO_INTERSECTION)},normalizeToMinimum:function(t,e,n,r,i){i.x=this.smallestInAbsValue(t.x,e.x,n.x,r.x),i.y=this.smallestInAbsValue(t.y,e.y,n.y,r.y),t.x-=i.x,t.y-=i.y,e.x-=i.x,e.y-=i.y,n.x-=i.x,n.y-=i.y,r.x-=i.x,r.y-=i.y},safeHCoordinateIntersection:function(t,e,n,r){var i=null;try{i=j.intersection(t,e,n,r)}catch(o){if(!(o instanceof O))throw o;i=Kt.nearestEndpoint(t,e,n,r)}return i},intersection:function(t,e,n,r){var i=this.intersectionWithNormalization(t,e,n,r);return this.isInSegmentEnvelopes(i)||(i=new d(Kt.nearestEndpoint(t,e,n,r))),null!==this.precisionModel&&this.precisionModel.makePrecise(i),i},smallestInAbsValue:function(t,e,n,r){var i=t,o=Math.abs(i);return Math.abs(e)<o&&(i=e,o=Math.abs(e)),Math.abs(n)<o&&(i=n,o=Math.abs(n)),Math.abs(r)<o&&(i=r),i},checkDD:function(t,e,n,r,i){var o=L.intersection(t,e,n,r),a=this.isInSegmentEnvelopes(o);k.out.println("DD in env = "+a+"  --------------------- "+o),i.distance(o)>1e-4&&k.out.println("Distance = "+i.distance(o))},intersectionWithNormalization:function(t,e,n,r){var i=new d(t),o=new d(e),a=new d(n),s=new d(r),u=new d;this.normalizeToEnvCentre(i,o,a,s,u);var c=this.safeHCoordinateIntersection(i,o,a,s);return c.x+=u.x,c.y+=u.y,c},computeCollinearIntersection:function(t,e,n,r){var i=E.intersects(t,e,n),o=E.intersects(t,e,r),a=E.intersects(n,r,t),s=E.intersects(n,r,e);return i&&o?(this.intPt[0]=n,this.intPt[1]=r,Zt.COLLINEAR_INTERSECTION):a&&s?(this.intPt[0]=t,this.intPt[1]=e,Zt.COLLINEAR_INTERSECTION):i&&a?(this.intPt[0]=n,this.intPt[1]=t,!n.equals(t)||o||s?Zt.COLLINEAR_INTERSECTION:Zt.POINT_INTERSECTION):i&&s?(this.intPt[0]=n,this.intPt[1]=e,!n.equals(e)||o||a?Zt.COLLINEAR_INTERSECTION:Zt.POINT_INTERSECTION):o&&a?(this.intPt[0]=r,this.intPt[1]=t,!r.equals(t)||i||s?Zt.COLLINEAR_INTERSECTION:Zt.POINT_INTERSECTION):o&&s?(this.intPt[0]=r,this.intPt[1]=e,!r.equals(e)||i||a?Zt.COLLINEAR_INTERSECTION:Zt.POINT_INTERSECTION):Zt.NO_INTERSECTION},normalizeToEnvCentre:function(t,e,n,r,i){var o=t.x<e.x?t.x:e.x,a=t.y<e.y?t.y:e.y,s=t.x>e.x?t.x:e.x,u=t.y>e.y?t.y:e.y,c=n.x<r.x?n.x:r.x,l=n.y<r.y?n.y:r.y,f=n.x>r.x?n.x:r.x,h=n.y>r.y?n.y:r.y,d=((o>c?o:c)+(s<f?s:f))/2,p=((a>l?a:l)+(u<h?u:h))/2;i.x=d,i.y=p,t.x-=i.x,t.y-=i.y,e.x-=i.x,e.y-=i.y,n.x-=i.x,n.y-=i.y,r.x-=i.x,r.y-=i.y},computeIntersect:function(t,e,n,r){if(this._isProper=!1,!E.intersects(t,e,n,r))return Zt.NO_INTERSECTION;var i=$t.orientationIndex(t,e,n),o=$t.orientationIndex(t,e,r);if(i>0&&o>0||i<0&&o<0)return Zt.NO_INTERSECTION;var a=$t.orientationIndex(n,r,t),s=$t.orientationIndex(n,r,e);return a>0&&s>0||a<0&&s<0?Zt.NO_INTERSECTION:0===i&&0===o&&0===a&&0===s?this.computeCollinearIntersection(t,e,n,r):(0===i||0===o||0===a||0===s?(this._isProper=!1,t.equals2D(n)||t.equals2D(r)?this.intPt[0]=t:e.equals2D(n)||e.equals2D(r)?this.intPt[0]=e:0===i?this.intPt[0]=new d(n):0===o?this.intPt[0]=new d(r):0===a?this.intPt[0]=new d(t):0===s&&(this.intPt[0]=new d(e))):(this._isProper=!0,this.intPt[0]=this.intersection(t,e,n,r)),Zt.POINT_INTERSECTION)},interfaces_:function(){return[]},getClass:function(){return Kt}}),Kt.nearestEndpoint=function(t,e,n,r){var i=t,o=$t.distancePointLine(t,n,r),a=$t.distancePointLine(e,n,r);return a<o&&(o=a,i=e),(a=$t.distancePointLine(n,t,e))<o&&(o=a,i=n),(a=$t.distancePointLine(r,t,e))<o&&(o=a,i=r),i},e(Jt.prototype,{interfaces_:function(){return[]},getClass:function(){return Jt}}),Jt.orientationIndex=function(t,e,n){var r=e.x-t.x,i=e.y-t.y,o=n.x-e.x,a=n.y-e.y;return Jt.signOfDet2x2(r,i,o,a)},Jt.signOfDet2x2=function(t,e,n,r){var i=null,o=null,a=null;if(i=1,0===t||0===r)return 0===e||0===n?0:e>0?n>0?-i:i:n>0?i:-i;if(0===e||0===n)return r>0?t>0?i:-i:t>0?-i:i;if(0<e?0<r?e<=r||(i=-i,o=t,t=n,n=o,o=e,e=r,r=o):e<=-r?(i=-i,n=-n,r=-r):(o=t,t=-n,n=o,o=e,e=-r,r=o):0<r?-e<=r?(i=-i,t=-t,e=-e):(o=-t,t=n,n=o,o=-e,e=r,r=o):e>=r?(t=-t,e=-e,n=-n,r=-r):(i=-i,o=-t,t=-n,n=o,o=-e,e=-r,r=o),0<t){if(!(0<n))return i;if(!(t<=n))return i}else{if(0<n)return-i;if(!(t>=n))return-i;i=-i,t=-t,n=-n}for(;;){if((r-=(a=Math.floor(n/t))*e)<0)return-i;if(r>e)return i;if(t>(n-=a*t)+n){if(e<r+r)return i}else{if(e>r+r)return-i;n=t-n,r=e-r,i=-i}if(0===r)return 0===n?0:-i;if(0===n)return i;if((e-=(a=Math.floor(t/n))*r)<0)return i;if(e>r)return-i;if(n>(t-=a*n)+t){if(r<e+e)return-i}else{if(r>e+e)return i;t=n-t,e=r-e,i=-i}if(0===e)return 0===t?0:i;if(0===t)return-i}},e(Qt.prototype,{countSegment:function(t,e){if(t.x<this.p.x&&e.x<this.p.x)return null;if(this.p.x===e.x&&this.p.y===e.y)return this.isPointOnSegment=!0,null;if(t.y===this.p.y&&e.y===this.p.y){var n=t.x,r=e.x;return n>r&&(n=e.x,r=t.x),this.p.x>=n&&this.p.x<=r&&(this.isPointOnSegment=!0),null}if(t.y>this.p.y&&e.y<=this.p.y||e.y>this.p.y&&t.y<=this.p.y){var i=t.x-this.p.x,o=t.y-this.p.y,a=e.x-this.p.x,s=e.y-this.p.y,u=Jt.signOfDet2x2(i,o,a,s);if(0===u)return this.isPointOnSegment=!0,null;s<o&&(u=-u),u>0&&this.crossingCount++}},isPointInPolygon:function(){return this.getLocation()!==P.EXTERIOR},getLocation:function(){return this.isPointOnSegment?P.BOUNDARY:this.crossingCount%2==1?P.INTERIOR:P.EXTERIOR},isOnSegment:function(){return this.isPointOnSegment},interfaces_:function(){return[]},getClass:function(){return Qt}}),Qt.locatePointInRing=function(){if(arguments[0]instanceof d&&C(arguments[1],R)){for(var t=arguments[0],e=arguments[1],n=new Qt(t),r=new d,i=new d,o=1;o<e.size();o++)if(e.getCoordinate(o,r),e.getCoordinate(o-1,i),n.countSegment(r,i),n.isOnSegment())return n.getLocation();return n.getLocation()}if(arguments[0]instanceof d&&arguments[1]instanceof Array){var a=arguments[0],s=arguments[1];for(n=new Qt(a),o=1;o<s.length;o++)if(r=s[o],i=s[o-1],n.countSegment(r,i),n.isOnSegment())return n.getLocation();return n.getLocation()}},e($t.prototype,{interfaces_:function(){return[]},getClass:function(){return $t}}),$t.orientationIndex=function(t,e,n){return L.orientationIndex(t,e,n)},$t.signedArea=function(){if(arguments[0]instanceof Array){var t=arguments[0];if(t.length<3)return 0;for(var e=0,n=t[0].x,r=1;r<t.length-1;r++){var i=t[r].x-n,o=t[r+1].y,a=t[r-1].y;e+=i*(a-o)}return e/2}if(C(arguments[0],R)){var s=arguments[0],u=s.size();if(u<3)return 0;var c=new d,l=new d,f=new d;for(s.getCoordinate(0,l),s.getCoordinate(1,f),n=l.x,f.x-=n,e=0,r=1;r<u-1;r++)c.y=l.y,l.x=f.x,l.y=f.y,s.getCoordinate(r+1,f),f.x-=n,e+=l.x*(c.y-f.y);return e/2}},$t.distanceLineLine=function(t,e,n,r){if(t.equals(e))return $t.distancePointLine(t,n,r);if(n.equals(r))return $t.distancePointLine(r,t,e);var i=!1;if(E.intersects(t,e,n,r)){var o=(e.x-t.x)*(r.y-n.y)-(e.y-t.y)*(r.x-n.x);if(0===o)i=!0;else{var a=(t.y-n.y)*(r.x-n.x)-(t.x-n.x)*(r.y-n.y),s=((t.y-n.y)*(e.x-t.x)-(t.x-n.x)*(e.y-t.y))/o,u=a/o;(u<0||u>1||s<0||s>1)&&(i=!0)}}else i=!0;return i?M.min($t.distancePointLine(t,n,r),$t.distancePointLine(e,n,r),$t.distancePointLine(n,t,e),$t.distancePointLine(r,t,e)):0},$t.isPointInRing=function(t,e){return $t.locatePointInRing(t,e)!==P.EXTERIOR},$t.computeLength=function(t){var e=t.size();if(e<=1)return 0;var n=0,r=new d;t.getCoordinate(0,r);for(var i=r.x,o=r.y,a=1;a<e;a++){t.getCoordinate(a,r);var s=r.x,u=r.y,c=s-i,l=u-o;n+=Math.sqrt(c*c+l*l),i=s,o=u}return n},$t.isCCW=function(t){var e=t.length-1;if(e<3)throw new r("Ring has fewer than 4 points, so orientation cannot be determined");for(var n=t[0],i=0,o=1;o<=e;o++){var a=t[o];a.y>n.y&&(n=a,i=o)}var s=i;do{(s-=1)<0&&(s=e)}while(t[s].equals2D(n)&&s!==i);var u=i;do{u=(u+1)%e}while(t[u].equals2D(n)&&u!==i);var c=t[s],l=t[u];if(c.equals2D(n)||l.equals2D(n)||c.equals2D(l))return!1;var f=$t.computeOrientation(c,n,l);return 0===f?c.x>l.x:f>0},$t.locatePointInRing=function(t,e){return Qt.locatePointInRing(t,e)},$t.distancePointLinePerpendicular=function(t,e,n){var r=(n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y),i=((e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y))/r;return Math.abs(i)*Math.sqrt(r)},$t.computeOrientation=function(t,e,n){return $t.orientationIndex(t,e,n)},$t.distancePointLine=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(0===e.length)throw new r("Line array must contain at least one vertex");for(var n=t.distance(e[0]),i=0;i<e.length-1;i++){var o=$t.distancePointLine(t,e[i],e[i+1]);o<n&&(n=o)}return n}if(3===arguments.length){var a=arguments[0],s=arguments[1],u=arguments[2];if(s.x===u.x&&s.y===u.y)return a.distance(s);var c=(u.x-s.x)*(u.x-s.x)+(u.y-s.y)*(u.y-s.y),l=((a.x-s.x)*(u.x-s.x)+(a.y-s.y)*(u.y-s.y))/c;if(l<=0)return a.distance(s);if(l>=1)return a.distance(u);var f=((s.y-a.y)*(u.x-s.x)-(s.x-a.x)*(u.y-s.y))/c;return Math.abs(f)*Math.sqrt(c)}},$t.isOnLine=function(t,e){for(var n=new Kt,r=1;r<e.length;r++){var i=e[r-1],o=e[r];if(n.computeIntersection(t,i,o),n.hasIntersection())return!0}return!1},$t.CLOCKWISE=-1,$t.RIGHT=$t.CLOCKWISE,$t.COUNTERCLOCKWISE=1,$t.LEFT=$t.COUNTERCLOCKWISE,$t.COLLINEAR=0,$t.STRAIGHT=$t.COLLINEAR,e(te.prototype,{minX:function(){return Math.min(this.p0.x,this.p1.x)},orientationIndex:function(){if(arguments[0]instanceof te){var t=arguments[0],e=$t.orientationIndex(this.p0,this.p1,t.p0),n=$t.orientationIndex(this.p0,this.p1,t.p1);return e>=0&&n>=0||e<=0&&n<=0?Math.max(e,n):0}if(arguments[0]instanceof d){var r=arguments[0];return $t.orientationIndex(this.p0,this.p1,r)}},toGeometry:function(t){return t.createLineString([this.p0,this.p1])},isVertical:function(){return this.p0.x===this.p1.x},equals:function(t){if(!(t instanceof te))return!1;var e=t;return this.p0.equals(e.p0)&&this.p1.equals(e.p1)},intersection:function(t){var e=new Kt;return e.computeIntersection(this.p0,this.p1,t.p0,t.p1),e.hasIntersection()?e.getIntersection(0):null},project:function(){if(arguments[0]instanceof d){var t=arguments[0];if(t.equals(this.p0)||t.equals(this.p1))return new d(t);var e=this.projectionFactor(t),n=new d;return n.x=this.p0.x+e*(this.p1.x-this.p0.x),n.y=this.p0.y+e*(this.p1.y-this.p0.y),n}if(arguments[0]instanceof te){var r=arguments[0],i=this.projectionFactor(r.p0),o=this.projectionFactor(r.p1);if(i>=1&&o>=1)return null;if(i<=0&&o<=0)return null;var a=this.project(r.p0);i<0&&(a=this.p0),i>1&&(a=this.p1);var s=this.project(r.p1);return o<0&&(s=this.p0),o>1&&(s=this.p1),new te(a,s)}},normalize:function(){this.p1.compareTo(this.p0)<0&&this.reverse()},angle:function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)},getCoordinate:function(t){return 0===t?this.p0:this.p1},distancePerpendicular:function(t){return $t.distancePointLinePerpendicular(t,this.p0,this.p1)},minY:function(){return Math.min(this.p0.y,this.p1.y)},midPoint:function(){return te.midPoint(this.p0,this.p1)},projectionFactor:function(t){if(t.equals(this.p0))return 0;if(t.equals(this.p1))return 1;var e=this.p1.x-this.p0.x,n=this.p1.y-this.p0.y,r=e*e+n*n;return r<=0?i.NaN:((t.x-this.p0.x)*e+(t.y-this.p0.y)*n)/r},closestPoints:function(t){var e=this.intersection(t);if(null!==e)return[e,e];var n=new Array(2).fill(null),r=i.MAX_VALUE,o=null,a=this.closestPoint(t.p0);r=a.distance(t.p0),n[0]=a,n[1]=t.p0;var s=this.closestPoint(t.p1);(o=s.distance(t.p1))<r&&(r=o,n[0]=s,n[1]=t.p1);var u=t.closestPoint(this.p0);(o=u.distance(this.p0))<r&&(r=o,n[0]=this.p0,n[1]=u);var c=t.closestPoint(this.p1);return(o=c.distance(this.p1))<r&&(r=o,n[0]=this.p1,n[1]=c),n},closestPoint:function(t){var e=this.projectionFactor(t);return e>0&&e<1?this.project(t):this.p0.distance(t)<this.p1.distance(t)?this.p0:this.p1},maxX:function(){return Math.max(this.p0.x,this.p1.x)},getLength:function(){return this.p0.distance(this.p1)},compareTo:function(t){var e=t,n=this.p0.compareTo(e.p0);return 0!==n?n:this.p1.compareTo(e.p1)},reverse:function(){var t=this.p0;this.p0=this.p1,this.p1=t},equalsTopo:function(t){return this.p0.equals(t.p0)&&this.p1.equals(t.p1)||this.p0.equals(t.p1)&&this.p1.equals(t.p0)},lineIntersection:function(t){try{return j.intersection(this.p0,this.p1,t.p0,t.p1)}catch(t){if(!(t instanceof O))throw t}return null},maxY:function(){return Math.max(this.p0.y,this.p1.y)},pointAlongOffset:function(t,e){var n=this.p0.x+t*(this.p1.x-this.p0.x),r=this.p0.y+t*(this.p1.y-this.p0.y),i=this.p1.x-this.p0.x,o=this.p1.y-this.p0.y,a=Math.sqrt(i*i+o*o),s=0,u=0;if(0!==e){if(a<=0)throw new IllegalStateException("Cannot compute offset from zero-length line segment");s=e*i/a,u=e*o/a}return new d(n-u,r+s)},setCoordinates:function(){if(1===arguments.length){var t=arguments[0];this.setCoordinates(t.p0,t.p1)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.p0.x=e.x,this.p0.y=e.y,this.p1.x=n.x,this.p1.y=n.y}},segmentFraction:function(t){var e=this.projectionFactor(t);return e<0?e=0:(e>1||i.isNaN(e))&&(e=1),e},toString:function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"},isHorizontal:function(){return this.p0.y===this.p1.y},distance:function(){if(arguments[0]instanceof te){var t=arguments[0];return $t.distanceLineLine(this.p0,this.p1,t.p0,t.p1)}if(arguments[0]instanceof d){var e=arguments[0];return $t.distancePointLine(e,this.p0,this.p1)}},pointAlong:function(t){var e=new d;return e.x=this.p0.x+t*(this.p1.x-this.p0.x),e.y=this.p0.y+t*(this.p1.y-this.p0.y),e},hashCode:function(){var t=java.lang.Double.doubleToLongBits(this.p0.x);t^=31*java.lang.Double.doubleToLongBits(this.p0.y);var e=Math.trunc(t)^Math.trunc(t>>32),n=java.lang.Double.doubleToLongBits(this.p1.x);return n^=31*java.lang.Double.doubleToLongBits(this.p1.y),e^Math.trunc(n)^Math.trunc(n>>32)},interfaces_:function(){return[o,u]},getClass:function(){return te}}),te.midPoint=function(t,e){return new d((t.x+e.x)/2,(t.y+e.y)/2)},te.serialVersionUID=0x2d2172135f411c00,e(ee.prototype,{isIntersects:function(){return!this.isDisjoint()},isCovers:function(){return(ee.isTrue(this.matrix[P.INTERIOR][P.INTERIOR])||ee.isTrue(this.matrix[P.INTERIOR][P.BOUNDARY])||ee.isTrue(this.matrix[P.BOUNDARY][P.INTERIOR])||ee.isTrue(this.matrix[P.BOUNDARY][P.BOUNDARY]))&&this.matrix[P.EXTERIOR][P.INTERIOR]===ct.FALSE&&this.matrix[P.EXTERIOR][P.BOUNDARY]===ct.FALSE},isCoveredBy:function(){return(ee.isTrue(this.matrix[P.INTERIOR][P.INTERIOR])||ee.isTrue(this.matrix[P.INTERIOR][P.BOUNDARY])||ee.isTrue(this.matrix[P.BOUNDARY][P.INTERIOR])||ee.isTrue(this.matrix[P.BOUNDARY][P.BOUNDARY]))&&this.matrix[P.INTERIOR][P.EXTERIOR]===ct.FALSE&&this.matrix[P.BOUNDARY][P.EXTERIOR]===ct.FALSE},set:function(){if(1===arguments.length)for(var t=arguments[0],e=0;e<t.length;e++){var n=Math.trunc(e/3),r=e%3;this.matrix[n][r]=ct.toDimensionValue(t.charAt(e))}else if(3===arguments.length){var i=arguments[0],o=arguments[1],a=arguments[2];this.matrix[i][o]=a}},isContains:function(){return ee.isTrue(this.matrix[P.INTERIOR][P.INTERIOR])&&this.matrix[P.EXTERIOR][P.INTERIOR]===ct.FALSE&&this.matrix[P.EXTERIOR][P.BOUNDARY]===ct.FALSE},setAtLeast:function(){if(1===arguments.length)for(var t=arguments[0],e=0;e<t.length;e++){var n=Math.trunc(e/3),r=e%3;this.setAtLeast(n,r,ct.toDimensionValue(t.charAt(e)))}else if(3===arguments.length){var i=arguments[0],o=arguments[1],a=arguments[2];this.matrix[i][o]<a&&(this.matrix[i][o]=a)}},setAtLeastIfValid:function(t,e,n){t>=0&&e>=0&&this.setAtLeast(t,e,n)},isWithin:function(){return ee.isTrue(this.matrix[P.INTERIOR][P.INTERIOR])&&this.matrix[P.INTERIOR][P.EXTERIOR]===ct.FALSE&&this.matrix[P.BOUNDARY][P.EXTERIOR]===ct.FALSE},isTouches:function(t,e){return t>e?this.isTouches(e,t):(t===ct.A&&e===ct.A||t===ct.L&&e===ct.L||t===ct.L&&e===ct.A||t===ct.P&&e===ct.A||t===ct.P&&e===ct.L)&&this.matrix[P.INTERIOR][P.INTERIOR]===ct.FALSE&&(ee.isTrue(this.matrix[P.INTERIOR][P.BOUNDARY])||ee.isTrue(this.matrix[P.BOUNDARY][P.INTERIOR])||ee.isTrue(this.matrix[P.BOUNDARY][P.BOUNDARY]))},isOverlaps:function(t,e){return t===ct.P&&e===ct.P||t===ct.A&&e===ct.A?ee.isTrue(this.matrix[P.INTERIOR][P.INTERIOR])&&ee.isTrue(this.matrix[P.INTERIOR][P.EXTERIOR])&&ee.isTrue(this.matrix[P.EXTERIOR][P.INTERIOR]):t===ct.L&&e===ct.L&&1===this.matrix[P.INTERIOR][P.INTERIOR]&&ee.isTrue(this.matrix[P.INTERIOR][P.EXTERIOR])&&ee.isTrue(this.matrix[P.EXTERIOR][P.INTERIOR])},isEquals:function(t,e){return t===e&&ee.isTrue(this.matrix[P.INTERIOR][P.INTERIOR])&&this.matrix[P.INTERIOR][P.EXTERIOR]===ct.FALSE&&this.matrix[P.BOUNDARY][P.EXTERIOR]===ct.FALSE&&this.matrix[P.EXTERIOR][P.INTERIOR]===ct.FALSE&&this.matrix[P.EXTERIOR][P.BOUNDARY]===ct.FALSE},toString:function(){for(var t=new I("123456789"),e=0;e<3;e++)for(var n=0;n<3;n++)t.setCharAt(3*e+n,ct.toDimensionSymbol(this.matrix[e][n]));return t.toString()},setAll:function(t){for(var e=0;e<3;e++)for(var n=0;n<3;n++)this.matrix[e][n]=t},get:function(t,e){return this.matrix[t][e]},transpose:function(){var t=this.matrix[1][0];return this.matrix[1][0]=this.matrix[0][1],this.matrix[0][1]=t,t=this.matrix[2][0],this.matrix[2][0]=this.matrix[0][2],this.matrix[0][2]=t,t=this.matrix[2][1],this.matrix[2][1]=this.matrix[1][2],this.matrix[1][2]=t,this},matches:function(t){if(9!==t.length)throw new r("Should be length 9: "+t);for(var e=0;e<3;e++)for(var n=0;n<3;n++)if(!ee.matches(this.matrix[e][n],t.charAt(3*e+n)))return!1;return!0},add:function(t){for(var e=0;e<3;e++)for(var n=0;n<3;n++)this.setAtLeast(e,n,t.get(e,n))},isDisjoint:function(){return this.matrix[P.INTERIOR][P.INTERIOR]===ct.FALSE&&this.matrix[P.INTERIOR][P.BOUNDARY]===ct.FALSE&&this.matrix[P.BOUNDARY][P.INTERIOR]===ct.FALSE&&this.matrix[P.BOUNDARY][P.BOUNDARY]===ct.FALSE},isCrosses:function(t,e){return t===ct.P&&e===ct.L||t===ct.P&&e===ct.A||t===ct.L&&e===ct.A?ee.isTrue(this.matrix[P.INTERIOR][P.INTERIOR])&&ee.isTrue(this.matrix[P.INTERIOR][P.EXTERIOR]):t===ct.L&&e===ct.P||t===ct.A&&e===ct.P||t===ct.A&&e===ct.L?ee.isTrue(this.matrix[P.INTERIOR][P.INTERIOR])&&ee.isTrue(this.matrix[P.EXTERIOR][P.INTERIOR]):t===ct.L&&e===ct.L&&0===this.matrix[P.INTERIOR][P.INTERIOR]},interfaces_:function(){return[a]},getClass:function(){return ee}}),ee.matches=function(){if(Number.isInteger(arguments[0])&&"string"==typeof arguments[1]){var t=arguments[0],e=arguments[1];return e===ct.SYM_DONTCARE||e===ct.SYM_TRUE&&(t>=0||t===ct.TRUE)||e===ct.SYM_FALSE&&t===ct.FALSE||e===ct.SYM_P&&t===ct.P||e===ct.SYM_L&&t===ct.L||e===ct.SYM_A&&t===ct.A}if("string"==typeof arguments[0]&&"string"==typeof arguments[1]){var n=arguments[0],r=arguments[1],i=new ee(n);return i.matches(r)}},ee.isTrue=function(t){return t>=0||t===ct.TRUE};var Ko=Object.freeze({Coordinate:d,CoordinateList:w,Envelope:E,LineSegment:te,GeometryFactory:Xt,Geometry:B,Point:Ot,LineString:Et,LinearRing:It,Polygon:Ct,GeometryCollection:ht,MultiPoint:Mt,MultiLineString:dt,MultiPolygon:At,Dimension:ct,IntersectionMatrix:ee,PrecisionModel:Wt});e(ne.prototype,{addPoint:function(t){this.ptCount+=1,this.ptCentSum.x+=t.x,this.ptCentSum.y+=t.y},setBasePoint:function(t){null===this.areaBasePt&&(this.areaBasePt=t)},addLineSegments:function(t){for(var e=0,n=0;n<t.length-1;n++){var r=t[n].distance(t[n+1]);if(0!==r){e+=r;var i=(t[n].x+t[n+1].x)/2;this.lineCentSum.x+=r*i;var o=(t[n].y+t[n+1].y)/2;this.lineCentSum.y+=r*o}}this.totalLength+=e,0===e&&t.length>0&&this.addPoint(t[0])},addHole:function(t){for(var e=$t.isCCW(t),n=0;n<t.length-1;n++)this.addTriangle(this.areaBasePt,t[n],t[n+1],e);this.addLineSegments(t)},getCentroid:function(){var t=new d;if(Math.abs(this.areasum2)>0)t.x=this.cg3.x/3/this.areasum2,t.y=this.cg3.y/3/this.areasum2;else if(this.totalLength>0)t.x=this.lineCentSum.x/this.totalLength,t.y=this.lineCentSum.y/this.totalLength;else{if(!(this.ptCount>0))return null;t.x=this.ptCentSum.x/this.ptCount,t.y=this.ptCentSum.y/this.ptCount}return t},addShell:function(t){t.length>0&&this.setBasePoint(t[0]);for(var e=!$t.isCCW(t),n=0;n<t.length-1;n++)this.addTriangle(this.areaBasePt,t[n],t[n+1],e);this.addLineSegments(t)},addTriangle:function(t,e,n,r){var i=r?1:-1;ne.centroid3(t,e,n,this.triangleCent3);var o=ne.area2(t,e,n);this.cg3.x+=i*o*this.triangleCent3.x,this.cg3.y+=i*o*this.triangleCent3.y,this.areasum2+=i*o},add:function(){if(arguments[0]instanceof Ct){var t=arguments[0];this.addShell(t.getExteriorRing().getCoordinates());for(var e=0;e<t.getNumInteriorRing();e++)this.addHole(t.getInteriorRingN(e).getCoordinates())}else if(arguments[0]instanceof B){var n=arguments[0];if(n.isEmpty())return null;if(n instanceof Ot)this.addPoint(n.getCoordinate());else if(n instanceof Et)this.addLineSegments(n.getCoordinates());else if(n instanceof Ct){var r=n;this.add(r)}else if(n instanceof ht){var i=n;for(e=0;e<i.getNumGeometries();e++)this.add(i.getGeometryN(e))}}},interfaces_:function(){return[]},getClass:function(){return ne}}),ne.area2=function(t,e,n){return(e.x-t.x)*(n.y-t.y)-(n.x-t.x)*(e.y-t.y)},ne.centroid3=function(t,e,n,r){return r.x=t.x+e.x+n.x,r.y=t.y+e.y+n.y,null},ne.getCentroid=function(t){return new ne(t).getCentroid()},re.prototype=new Error,re.prototype.name="EmptyStackException",ie.prototype=new m,ie.prototype.add=function(t){return this.array_.push(t),!0},ie.prototype.get=function(t){if(t<0||t>=this.size())throw new IndexOutOfBoundsException;return this.array_[t]},ie.prototype.push=function(t){return this.array_.push(t),t},ie.prototype.pop=function(t){if(0===this.array_.length)throw new re;return this.array_.pop()},ie.prototype.peek=function(){if(0===this.array_.length)throw new re;return this.array_[this.array_.length-1]},ie.prototype.empty=function(){return 0===this.array_.length},ie.prototype.isEmpty=function(){return this.empty()},ie.prototype.search=function(t){return this.array_.indexOf(t)},ie.prototype.size=function(){return this.array_.length},ie.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},e(oe.prototype,{filter:function(t){this.treeSet.contains(t)||(this.list.add(t),this.treeSet.add(t))},getCoordinates:function(){var t=new Array(this.list.size()).fill(null);return this.list.toArray(t)},interfaces_:function(){return[z]},getClass:function(){return oe}}),oe.filterCoordinates=function(t){for(var e=new oe,n=0;n<t.length;n++)e.filter(t[n]);return e.getCoordinates()},e(ae.prototype,{preSort:function(t){for(var e=null,n=1;n<t.length;n++)(t[n].y<t[0].y||t[n].y===t[0].y&&t[n].x<t[0].x)&&(e=t[0],t[0]=t[n],t[n]=e);return ut.sort(t,1,t.length,new se(t[0])),t},computeOctRing:function(t){var e=this.computeOctPts(t),n=new w;return n.add(e,!1),n.size()<3?null:(n.closeRing(),n.toCoordinateArray())},lineOrPolygon:function(t){if(3===(t=this.cleanRing(t)).length)return this.geomFactory.createLineString([t[0],t[1]]);var e=this.geomFactory.createLinearRing(t);return this.geomFactory.createPolygon(e,null)},cleanRing:function(t){h.equals(t[0],t[t.length-1]);for(var e=new x,n=null,r=0;r<=t.length-2;r++){var i=t[r],o=t[r+1];i.equals(o)||null!==n&&this.isBetween(n,i,o)||(e.add(i),n=i)}e.add(t[t.length-1]);var a=new Array(e.size()).fill(null);return e.toArray(a)},isBetween:function(t,e,n){if(0!==$t.computeOrientation(t,e,n))return!1;if(t.x!==n.x){if(t.x<=e.x&&e.x<=n.x)return!0;if(n.x<=e.x&&e.x<=t.x)return!0}if(t.y!==n.y){if(t.y<=e.y&&e.y<=n.y)return!0;if(n.y<=e.y&&e.y<=t.y)return!0}return!1},reduce:function(t){var e=this.computeOctRing(t);if(null===e)return t;for(var n=new st,r=0;r<e.length;r++)n.add(e[r]);for(r=0;r<t.length;r++)$t.isPointInRing(t[r],e)||n.add(t[r]);var i=X.toCoordinateArray(n);return i.length<3?this.padArray3(i):i},getConvexHull:function(){if(0===this.inputPts.length)return this.geomFactory.createGeometryCollection(null);if(1===this.inputPts.length)return this.geomFactory.createPoint(this.inputPts[0]);if(2===this.inputPts.length)return this.geomFactory.createLineString(this.inputPts);var t=this.inputPts;this.inputPts.length>50&&(t=this.reduce(this.inputPts));var e=this.preSort(t),n=this.grahamScan(e),r=this.toCoordinateArray(n);return this.lineOrPolygon(r)},padArray3:function(t){for(var e=new Array(3).fill(null),n=0;n<e.length;n++)n<t.length?e[n]=t[n]:e[n]=t[0];return e},computeOctPts:function(t){for(var e=new Array(8).fill(null),n=0;n<e.length;n++)e[n]=t[0];for(var r=1;r<t.length;r++)t[r].x<e[0].x&&(e[0]=t[r]),t[r].x-t[r].y<e[1].x-e[1].y&&(e[1]=t[r]),t[r].y>e[2].y&&(e[2]=t[r]),t[r].x+t[r].y>e[3].x+e[3].y&&(e[3]=t[r]),t[r].x>e[4].x&&(e[4]=t[r]),t[r].x-t[r].y>e[5].x-e[5].y&&(e[5]=t[r]),t[r].y<e[6].y&&(e[6]=t[r]),t[r].x+t[r].y<e[7].x+e[7].y&&(e[7]=t[r]);return e},toCoordinateArray:function(t){for(var e=new Array(t.size()).fill(null),n=0;n<t.size();n++){var r=t.get(n);e[n]=r}return e},grahamScan:function(t){var e=null,n=new ie;e=n.push(t[0]),e=n.push(t[1]),e=n.push(t[2]);for(var r=3;r<t.length;r++){for(e=n.pop();!n.empty()&&$t.computeOrientation(n.peek(),e,t[r])>0;)e=n.pop();e=n.push(e),e=n.push(t[r])}return e=n.push(t[0]),n},interfaces_:function(){return[]},getClass:function(){return ae}}),ae.extractCoordinates=function(t){var e=new oe;return t.apply(e),e.getCoordinates()},e(se.prototype,{compare:function(t,e){var n=t,r=e;return se.polarCompare(this.origin,n,r)},interfaces_:function(){return[s]},getClass:function(){return se}}),se.polarCompare=function(t,e,n){var r=e.x-t.x,i=e.y-t.y,o=n.x-t.x,a=n.y-t.y,s=$t.computeOrientation(t,e,n);if(s===$t.COUNTERCLOCKWISE)return 1;if(s===$t.CLOCKWISE)return-1;var u=r*r+i*i,c=o*o+a*a;return u<c?-1:u>c?1:0},ae.RadialComparator=se,e(ue.prototype,{transformPoint:function(t,e){return this.factory.createPoint(this.transformCoordinates(t.getCoordinateSequence(),t))},transformPolygon:function(t,e){var n=!0,r=this.transformLinearRing(t.getExteriorRing(),t);null!==r&&r instanceof It&&!r.isEmpty()||(n=!1);for(var i=new x,o=0;o<t.getNumInteriorRing();o++){var a=this.transformLinearRing(t.getInteriorRingN(o),t);null===a||a.isEmpty()||(a instanceof It||(n=!1),i.add(a))}if(n)return this.factory.createPolygon(r,i.toArray([]));var s=new x;return null!==r&&s.add(r),s.addAll(i),this.factory.buildGeometry(s)},createCoordinateSequence:function(t){return this.factory.getCoordinateSequenceFactory().create(t)},getInputGeometry:function(){return this.inputGeom},transformMultiLineString:function(t,e){for(var n=new x,r=0;r<t.getNumGeometries();r++){var i=this.transformLineString(t.getGeometryN(r),t);null!==i&&(i.isEmpty()||n.add(i))}return this.factory.buildGeometry(n)},transformCoordinates:function(t,e){return this.copy(t)},transformLineString:function(t,e){return this.factory.createLineString(this.transformCoordinates(t.getCoordinateSequence(),t))},transformMultiPoint:function(t,e){for(var n=new x,r=0;r<t.getNumGeometries();r++){var i=this.transformPoint(t.getGeometryN(r),t);null!==i&&(i.isEmpty()||n.add(i))}return this.factory.buildGeometry(n)},transformMultiPolygon:function(t,e){for(var n=new x,r=0;r<t.getNumGeometries();r++){var i=this.transformPolygon(t.getGeometryN(r),t);null!==i&&(i.isEmpty()||n.add(i))}return this.factory.buildGeometry(n)},copy:function(t){return t.copy()},transformGeometryCollection:function(t,e){for(var n=new x,r=0;r<t.getNumGeometries();r++){var i=this.transform(t.getGeometryN(r));null!==i&&(this.pruneEmptyGeometry&&i.isEmpty()||n.add(i))}return this.preserveGeometryCollectionType?this.factory.createGeometryCollection(Xt.toGeometryArray(n)):this.factory.buildGeometry(n)},transform:function(t){if(this.inputGeom=t,this.factory=t.getFactory(),t instanceof Ot)return this.transformPoint(t,null);if(t instanceof Mt)return this.transformMultiPoint(t,null);if(t instanceof It)return this.transformLinearRing(t,null);if(t instanceof Et)return this.transformLineString(t,null);if(t instanceof dt)return this.transformMultiLineString(t,null);if(t instanceof Ct)return this.transformPolygon(t,null);if(t instanceof At)return this.transformMultiPolygon(t,null);if(t instanceof ht)return this.transformGeometryCollection(t,null);throw new r("Unknown Geometry subtype: "+t.getClass().getName())},transformLinearRing:function(t,e){var n=this.transformCoordinates(t.getCoordinateSequence(),t);if(null===n)return this.factory.createLinearRing(null);var r=n.size();return r>0&&r<4&&!this.preserveType?this.factory.createLineString(n):this.factory.createLinearRing(n)},interfaces_:function(){return[]},getClass:function(){return ue}}),e(ce.prototype,{snapVertices:function(t,e){for(var n=this._isClosed?t.size()-1:t.size(),r=0;r<n;r++){var i=t.get(r),o=this.findSnapForVertex(i,e);null!==o&&(t.set(r,new d(o)),0===r&&this._isClosed&&t.set(t.size()-1,new d(o)))}},findSnapForVertex:function(t,e){for(var n=0;n<e.length;n++){if(t.equals2D(e[n]))return null;if(t.distance(e[n])<this.snapTolerance)return e[n]}return null},snapTo:function(t){var e=new w(this.srcPts);return this.snapVertices(e,t),this.snapSegments(e,t),e.toCoordinateArray()},snapSegments:function(t,e){if(0===e.length)return null;var n=e.length;e[0].equals2D(e[e.length-1])&&(n=e.length-1);for(var r=0;r<n;r++){var i=e[r],o=this.findSegmentIndexToSnap(i,t);o>=0&&t.add(o+1,new d(i),!1)}},findSegmentIndexToSnap:function(t,e){for(var n=i.MAX_VALUE,r=-1,o=0;o<e.size()-1;o++){if(this.seg.p0=e.get(o),this.seg.p1=e.get(o+1),this.seg.p0.equals2D(t)||this.seg.p1.equals2D(t)){if(this.allowSnappingToSourceVertices)continue;return-1}var a=this.seg.distance(t);a<this.snapTolerance&&a<n&&(n=a,r=o)}return r},setAllowSnappingToSourceVertices:function(t){this.allowSnappingToSourceVertices=t},interfaces_:function(){return[]},getClass:function(){return ce}}),ce.isClosed=function(t){return!(t.length<=1)&&t[0].equals2D(t[t.length-1])},e(le.prototype,{snapTo:function(t,e){return new fe(e,this.extractTargetCoordinates(t)).transform(this.srcGeom)},snapToSelf:function(t,e){var n=new fe(t,this.extractTargetCoordinates(this.srcGeom),!0).transform(this.srcGeom),r=n;return e&&C(r,Pt)&&(r=n.buffer(0)),r},computeSnapTolerance:function(t){return this.computeMinimumSegmentLength(t)/10},extractTargetCoordinates:function(t){for(var e=new st,n=t.getCoordinates(),r=0;r<n.length;r++)e.add(n[r]);return e.toArray(new Array(0).fill(null))},computeMinimumSegmentLength:function(t){for(var e=i.MAX_VALUE,n=0;n<t.length-1;n++){var r=t[n].distance(t[n+1]);r<e&&(e=r)}return e},interfaces_:function(){return[]},getClass:function(){return le}}),le.snap=function(t,e,n){var r=new Array(2).fill(null),i=new le(t);r[0]=i.snapTo(e,n);var o=new le(e);return r[1]=o.snapTo(r[0],n),r},le.computeOverlaySnapTolerance=function(){if(1===arguments.length){var t=arguments[0],e=le.computeSizeBasedSnapTolerance(t),n=t.getPrecisionModel();if(n.getType()===Wt.FIXED){var r=1/n.getScale()*2/1.415;r>e&&(e=r)}return e}if(2===arguments.length){var i=arguments[0],o=arguments[1];return Math.min(le.computeOverlaySnapTolerance(i),le.computeOverlaySnapTolerance(o))}},le.computeSizeBasedSnapTolerance=function(t){var e=t.getEnvelopeInternal();return Math.min(e.getHeight(),e.getWidth())*le.SNAP_PRECISION_FACTOR},le.snapToSelf=function(t,e,n){return new le(t).snapToSelf(e,n)},le.SNAP_PRECISION_FACTOR=1e-9,l(fe,ue),e(fe.prototype,{snapLine:function(t,e){var n=new ce(t,this.snapTolerance);return n.setAllowSnappingToSourceVertices(this.isSelfSnap),n.snapTo(e)},transformCoordinates:function(t,e){var n=t.toCoordinateArray(),r=this.snapLine(n,this.snapPts);return this.factory.getCoordinateSequenceFactory().create(r)},interfaces_:function(){return[]},getClass:function(){return fe}}),e(he.prototype,{getCommon:function(){return i.longBitsToDouble(this.commonBits)},add:function(t){var e=i.doubleToLongBits(t);return this.isFirst?(this.commonBits=e,this.commonSignExp=he.signExpBits(this.commonBits),this.isFirst=!1,null):he.signExpBits(e)!==this.commonSignExp?(this.commonBits=0,null):(this.commonMantissaBitsCount=he.numCommonMostSigMantissaBits(this.commonBits,e),void(this.commonBits=he.zeroLowerBits(this.commonBits,64-(12+this.commonMantissaBitsCount))))},toString:function(){if(1===arguments.length){var t=arguments[0],e=i.longBitsToDouble(t),n=Long.toBinaryString(t),r="0000000000000000000000000000000000000000000000000000000000000000"+n,o=r.substring(r.length-64),a=o.substring(0,1)+"  "+o.substring(1,12)+"(exp) "+o.substring(12)+" [ "+e+" ]";return a}},interfaces_:function(){return[]},getClass:function(){return he}}),he.getBit=function(t,e){return 0!=(t&1<<e)?1:0},he.signExpBits=function(t){return t>>52},he.zeroLowerBits=function(t,e){return t&~((1<<e)-1)},he.numCommonMostSigMantissaBits=function(t,e){for(var n=0,r=52;r>=0;r--){if(he.getBit(t,r)!==he.getBit(e,r))return n;n++}return 52},e(de.prototype,{addCommonBits:function(t){var e=new ge(this.commonCoord);t.apply(e),t.geometryChanged()},removeCommonBits:function(t){if(0===this.commonCoord.x&&0===this.commonCoord.y)return t;var e=new d(this.commonCoord);e.x=-e.x,e.y=-e.y;var n=new ge(e);return t.apply(n),t.geometryChanged(),t},getCommonCoordinate:function(){return this.commonCoord},add:function(t){t.apply(this.ccFilter),this.commonCoord=this.ccFilter.getCommonCoordinate()},interfaces_:function(){return[]},getClass:function(){return de}}),e(pe.prototype,{filter:function(t){this.commonBitsX.add(t.x),this.commonBitsY.add(t.y)},getCommonCoordinate:function(){return new d(this.commonBitsX.getCommon(),this.commonBitsY.getCommon())},interfaces_:function(){return[z]},getClass:function(){return pe}}),e(ge.prototype,{filter:function(t,e){var n=t.getOrdinate(e,0)+this.trans.x,r=t.getOrdinate(e,1)+this.trans.y;t.setOrdinate(e,0,n),t.setOrdinate(e,1,r)},isDone:function(){return!1},isGeometryChanged:function(){return!0},interfaces_:function(){return[ft]},getClass:function(){return ge}}),de.CommonCoordinateFilter=pe,de.Translater=ge,e(ve.prototype,{next:function(){if(this.atStart)return this.atStart=!1,ve.isAtomic(this.parent)&&this.index++,this.parent;if(null!==this.subcollectionIterator){if(this.subcollectionIterator.hasNext())return this.subcollectionIterator.next();this.subcollectionIterator=null}if(this.index>=this.max)throw new b;var t=this.parent.getGeometryN(this.index++);return t instanceof ht?(this.subcollectionIterator=new ve(t),this.subcollectionIterator.next()):t},remove:function(){throw new UnsupportedOperationException(this.getClass().getName())},hasNext:function(){if(this.atStart)return!0;if(null!==this.subcollectionIterator){if(this.subcollectionIterator.hasNext())return!0;this.subcollectionIterator=null}return!(this.index>=this.max)},interfaces_:function(){return[g]},getClass:function(){return ve}}),ve.isAtomic=function(t){return!(t instanceof ht)},e(ye.prototype,{locateInternal:function(){if(arguments[0]instanceof d&&arguments[1]instanceof Ct){var t=arguments[0],e=arguments[1];if(e.isEmpty())return P.EXTERIOR;var n=e.getExteriorRing(),r=this.locateInPolygonRing(t,n);if(r===P.EXTERIOR)return P.EXTERIOR;if(r===P.BOUNDARY)return P.BOUNDARY;for(var i=0;i<e.getNumInteriorRing();i++){var o=e.getInteriorRingN(i),a=this.locateInPolygonRing(t,o);if(a===P.INTERIOR)return P.EXTERIOR;if(a===P.BOUNDARY)return P.BOUNDARY}return P.INTERIOR}if(arguments[0]instanceof d&&arguments[1]instanceof Et){var s=arguments[0],u=arguments[1];if(!u.getEnvelopeInternal().intersects(s))return P.EXTERIOR;var c=u.getCoordinates();return u.isClosed()||!s.equals(c[0])&&!s.equals(c[c.length-1])?$t.isOnLine(s,c)?P.INTERIOR:P.EXTERIOR:P.BOUNDARY}if(arguments[0]instanceof d&&arguments[1]instanceof Ot){var l=arguments[0],f=arguments[1],h=f.getCoordinate();return h.equals2D(l)?P.INTERIOR:P.EXTERIOR}},locateInPolygonRing:function(t,e){return e.getEnvelopeInternal().intersects(t)?$t.locatePointInRing(t,e.getCoordinates()):P.EXTERIOR},intersects:function(t,e){return this.locate(t,e)!==P.EXTERIOR},updateLocationInfo:function(t){t===P.INTERIOR&&(this.isIn=!0),t===P.BOUNDARY&&this.numBoundaries++},computeLocation:function(t,e){if(e instanceof Ot&&this.updateLocationInfo(this.locateInternal(t,e)),e instanceof Et)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof Ct)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof dt)for(var n=e,r=0;r<n.getNumGeometries();r++){var i=n.getGeometryN(r);this.updateLocationInfo(this.locateInternal(t,i))}else if(e instanceof At){var o=e;for(r=0;r<o.getNumGeometries();r++){var a=o.getGeometryN(r);this.updateLocationInfo(this.locateInternal(t,a))}}else if(e instanceof ht)for(var s=new ve(e);s.hasNext();){var u=s.next();u!==e&&this.computeLocation(t,u)}},locate:function(t,e){return e.isEmpty()?P.EXTERIOR:e instanceof Et||e instanceof Ct?this.locateInternal(t,e):(this.isIn=!1,this.numBoundaries=0,this.computeLocation(t,e),this.boundaryRule.isInBoundary(this.numBoundaries)?P.BOUNDARY:this.numBoundaries>0||this.isIn?P.INTERIOR:P.EXTERIOR)},interfaces_:function(){return[]},getClass:function(){return ye}}),e(me.prototype,{interfaces_:function(){return[]},getClass:function(){return me}}),me.octant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new r("Cannot compute the octant for point ( "+t+", "+e+" )");var n=Math.abs(t),i=Math.abs(e);return t>=0?e>=0?n>=i?0:1:n>=i?7:6:e>=0?n>=i?3:2:n>=i?4:5}if(arguments[0]instanceof d&&arguments[1]instanceof d){var o=arguments[0],a=arguments[1],s=a.x-o.x,u=a.y-o.y;if(0===s&&0===u)throw new r("Cannot compute the octant for two identical points "+o);return me.octant(s,u)}},e(be.prototype,{getCoordinates:function(){},size:function(){},getCoordinate:function(t){},isClosed:function(){},setData:function(t){},getData:function(){},interfaces_:function(){return[]},getClass:function(){return be}}),e(_e.prototype,{getCoordinates:function(){return this.pts},size:function(){return this.pts.length},getCoordinate:function(t){return this.pts[t]},isClosed:function(){return this.pts[0].equals(this.pts[this.pts.length-1])},getSegmentOctant:function(t){return t===this.pts.length-1?-1:me.octant(this.getCoordinate(t),this.getCoordinate(t+1))},setData:function(t){this.data=t},getData:function(){return this.data},toString:function(){return Yt.toLineString(new jt(this.pts))},interfaces_:function(){return[be]},getClass:function(){return _e}}),e(xe.prototype,{getBounds:function(){},interfaces_:function(){return[]},getClass:function(){return xe}}),e(we.prototype,{getItem:function(){return this.item},getBounds:function(){return this.bounds},interfaces_:function(){return[xe,u]},getClass:function(){return we}}),e(Ee.prototype,{poll:function(){if(this.isEmpty())return null;var t=this.items.get(1);return this.items.set(1,this.items.get(this._size)),this._size-=1,this.reorder(1),t},size:function(){return this._size},reorder:function(t){for(var e=null,n=this.items.get(t);2*t<=this._size&&((e=2*t)!==this._size&&this.items.get(e+1).compareTo(this.items.get(e))<0&&e++,this.items.get(e).compareTo(n)<0);t=e)this.items.set(t,this.items.get(e));this.items.set(t,n)},clear:function(){this._size=0,this.items.clear()},isEmpty:function(){return 0===this._size},add:function(t){this.items.add(null),this._size+=1;var e=this._size;for(this.items.set(0,t);t.compareTo(this.items.get(Math.trunc(e/2)))<0;e/=2)this.items.set(e,this.items.get(Math.trunc(e/2)));this.items.set(e,t)},interfaces_:function(){return[]},getClass:function(){return Ee}}),e(Se.prototype,{visitItem:function(t){},interfaces_:function(){return[]},getClass:function(){return Se}}),e(Oe.prototype,{insert:function(t,e){},remove:function(t,e){},query:function(){1===arguments.length?arguments[0]:2===arguments.length&&(arguments[0],arguments[1])},interfaces_:function(){return[]},getClass:function(){return Oe}}),e(Pe.prototype,{getLevel:function(){return this.level},size:function(){return this.childBoundables.size()},getChildBoundables:function(){return this.childBoundables},addChildBoundable:function(t){h.isTrue(null===this.bounds),this.childBoundables.add(t)},isEmpty:function(){return this.childBoundables.isEmpty()},getBounds:function(){return null===this.bounds&&(this.bounds=this.computeBounds()),this.bounds},interfaces_:function(){return[xe,u]},getClass:function(){return Pe}}),Pe.serialVersionUID=0x5a1e55ec41369800;var Jo={reverseOrder:function(){return{compare:function(t,e){return e.compareTo(t)}}},min:function(t){return Jo.sort(t),t.get(0)},sort:function(t,e){var n=t.toArray();e?ut.sort(n,e):ut.sort(n);for(var r=t.iterator(),i=0,o=n.length;i<o;i++)r.next(),r.set(n[i])},singletonList:function(t){var e=new x;return e.add(t),e}};e(Ce.prototype,{expandToQueue:function(t,e){var n=Ce.isComposite(this.boundable1),i=Ce.isComposite(this.boundable2);if(n&&i)return Ce.area(this.boundable1)>Ce.area(this.boundable2)?(this.expand(this.boundable1,this.boundable2,t,e),null):(this.expand(this.boundable2,this.boundable1,t,e),null);if(n)return this.expand(this.boundable1,this.boundable2,t,e),null;if(i)return this.expand(this.boundable2,this.boundable1,t,e),null;throw new r("neither boundable is composite")},isLeaves:function(){return!(Ce.isComposite(this.boundable1)||Ce.isComposite(this.boundable2))},compareTo:function(t){var e=t;return this._distance<e._distance?-1:this._distance>e._distance?1:0},expand:function(t,e,n,r){for(var i=t.getChildBoundables().iterator();i.hasNext();){var o=new Ce(i.next(),e,this.itemDistance);o.getDistance()<r&&n.add(o)}},getBoundable:function(t){return 0===t?this.boundable1:this.boundable2},getDistance:function(){return this._distance},distance:function(){return this.isLeaves()?this.itemDistance.distance(this.boundable1,this.boundable2):this.boundable1.getBounds().distance(this.boundable2.getBounds())},interfaces_:function(){return[o]},getClass:function(){return Ce}}),Ce.area=function(t){return t.getBounds().getArea()},Ce.isComposite=function(t){return t instanceof Pe},e(Me.prototype,{getNodeCapacity:function(){return this.nodeCapacity},lastNode:function(t){return t.get(t.size()-1)},size:function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.size(this.root));if(1===arguments.length){for(var t=arguments[0],e=0,n=t.getChildBoundables().iterator();n.hasNext();){var r=n.next();r instanceof Pe?e+=this.size(r):r instanceof we&&(e+=1)}return e}},removeItem:function(t,e){for(var n=null,r=t.getChildBoundables().iterator();r.hasNext();){var i=r.next();i instanceof we&&i.getItem()===e&&(n=i)}return null!==n&&(t.getChildBoundables().remove(n),!0)},itemsTree:function(){if(0===arguments.length){this.build();var t=this.itemsTree(this.root);return null===t?new x:t}if(1===arguments.length){for(var e=arguments[0],n=new x,r=e.getChildBoundables().iterator();r.hasNext();){var i=r.next();if(i instanceof Pe){var o=this.itemsTree(i);null!==o&&n.add(o)}else i instanceof we?n.add(i.getItem()):h.shouldNeverReachHere()}return n.size()<=0?null:n}},insert:function(t,e){h.isTrue(!this.built,"Cannot insert items into an STR packed R-tree after it has been built."),this.itemBoundables.add(new we(t,e))},boundablesAtLevel:function(){if(1===arguments.length){var t=arguments[0],e=new x;return this.boundablesAtLevel(t,this.root,e),e}if(3===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2];if(h.isTrue(n>-2),r.getLevel()===n)return i.add(r),null;for(var o=r.getChildBoundables().iterator();o.hasNext();){var a=o.next();a instanceof Pe?this.boundablesAtLevel(n,a,i):(h.isTrue(a instanceof we),-1===n&&i.add(a))}return null}},query:function(){if(1===arguments.length){var t=arguments[0];this.build();var e=new x;return this.isEmpty()||this.getIntersectsOp().intersects(this.root.getBounds(),t)&&this.query(t,this.root,e),e}if(2===arguments.length){var n=arguments[0],r=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this.root.getBounds(),n)&&this.query(n,this.root,r)}else if(3===arguments.length)if(C(arguments[2],Se)&&arguments[0]instanceof Object&&arguments[1]instanceof Pe)for(var i=arguments[0],o=arguments[1],a=arguments[2],s=o.getChildBoundables(),u=0;u<s.size();u++){var c=s.get(u);this.getIntersectsOp().intersects(c.getBounds(),i)&&(c instanceof Pe?this.query(i,c,a):c instanceof we?a.visitItem(c.getItem()):h.shouldNeverReachHere())}else if(C(arguments[2],m)&&arguments[0]instanceof Object&&arguments[1]instanceof Pe){var l=arguments[0],f=arguments[1],d=arguments[2];for(s=f.getChildBoundables(),u=0;u<s.size();u++)c=s.get(u),this.getIntersectsOp().intersects(c.getBounds(),l)&&(c instanceof Pe?this.query(l,c,d):c instanceof we?d.add(c.getItem()):h.shouldNeverReachHere())}},build:function(){return this.built?null:(this.root=this.itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this.itemBoundables,-1),this.itemBoundables=null,void(this.built=!0))},getRoot:function(){return this.build(),this.root},remove:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this.root.getBounds(),t)&&this.remove(t,this.root,e)}if(3===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2],o=this.removeItem(r,i);if(o)return!0;for(var a=null,s=r.getChildBoundables().iterator();s.hasNext();){var u=s.next();if(this.getIntersectsOp().intersects(u.getBounds(),n)&&u instanceof Pe&&(o=this.remove(n,u,i))){a=u;break}}return null!==a&&a.getChildBoundables().isEmpty()&&r.getChildBoundables().remove(a),o}},createHigherLevels:function(t,e){h.isTrue(!t.isEmpty());var n=this.createParentBoundables(t,e+1);return 1===n.size()?n.get(0):this.createHigherLevels(n,e+1)},depth:function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.depth(this.root));if(1===arguments.length){for(var t=arguments[0],e=0,n=t.getChildBoundables().iterator();n.hasNext();){var r=n.next();if(r instanceof Pe){var i=this.depth(r);i>e&&(e=i)}}return e+1}},createParentBoundables:function(t,e){h.isTrue(!t.isEmpty());var n=new x;n.add(this.createNode(e));var r=new x(t);Jo.sort(r,this.getComparator());for(var i=r.iterator();i.hasNext();){var o=i.next();this.lastNode(n).getChildBoundables().size()===this.getNodeCapacity()&&n.add(this.createNode(e)),this.lastNode(n).addChildBoundable(o)}return n},isEmpty:function(){return this.built?this.root.isEmpty():this.itemBoundables.isEmpty()},interfaces_:function(){return[u]},getClass:function(){return Me}}),Me.compareDoubles=function(t,e){return t>e?1:t<e?-1:0},Me.IntersectsOp=function(){},Me.serialVersionUID=-0x35ef64c82d4c5400,Me.DEFAULT_NODE_CAPACITY=10,e(Ie.prototype,{distance:function(t,e){},interfaces_:function(){return[]},getClass:function(){return Ie}}),l(Ae,Me),e(Ae.prototype,{createParentBoundablesFromVerticalSlices:function(t,e){h.isTrue(t.length>0);for(var n=new x,r=0;r<t.length;r++)n.addAll(this.createParentBoundablesFromVerticalSlice(t[r],e));return n},createNode:function(t){return new Te(t)},size:function(){return 0===arguments.length?Me.prototype.size.call(this):Me.prototype.size.apply(this,arguments)},insert:function(){if(2!==arguments.length)return Me.prototype.insert.apply(this,arguments);var t=arguments[0],e=arguments[1];return t.isNull()?null:void Me.prototype.insert.call(this,t,e)},getIntersectsOp:function(){return Ae.intersectsOp},verticalSlices:function(t,e){for(var n=Math.trunc(Math.ceil(t.size()/e)),r=new Array(e).fill(null),i=t.iterator(),o=0;o<e;o++){r[o]=new x;for(var a=0;i.hasNext()&&a<n;){var s=i.next();r[o].add(s),a++}}return r},query:function(){if(1===arguments.length){var t=arguments[0];return Me.prototype.query.call(this,t)}if(2===arguments.length){var e=arguments[0],n=arguments[1];Me.prototype.query.call(this,e,n)}else if(3===arguments.length)if(C(arguments[2],Se)&&arguments[0]instanceof Object&&arguments[1]instanceof Pe){var r=arguments[0],i=arguments[1],o=arguments[2];Me.prototype.query.call(this,r,i,o)}else if(C(arguments[2],m)&&arguments[0]instanceof Object&&arguments[1]instanceof Pe){var a=arguments[0],s=arguments[1],u=arguments[2];Me.prototype.query.call(this,a,s,u)}},getComparator:function(){return Ae.yComparator},createParentBoundablesFromVerticalSlice:function(t,e){return Me.prototype.createParentBoundables.call(this,t,e)},remove:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return Me.prototype.remove.call(this,t,e)}return Me.prototype.remove.apply(this,arguments)},depth:function(){return 0===arguments.length?Me.prototype.depth.call(this):Me.prototype.depth.apply(this,arguments)},createParentBoundables:function(t,e){h.isTrue(!t.isEmpty());var n=Math.trunc(Math.ceil(t.size()/this.getNodeCapacity())),r=new x(t);Jo.sort(r,Ae.xComparator);var i=this.verticalSlices(r,Math.trunc(Math.ceil(Math.sqrt(n))));return this.createParentBoundablesFromVerticalSlices(i,e)},nearestNeighbour:function(){if(1===arguments.length){if(C(arguments[0],Ie)){var t=arguments[0],e=new Ce(this.getRoot(),this.getRoot(),t);return this.nearestNeighbour(e)}if(arguments[0]instanceof Ce){var n=arguments[0];return this.nearestNeighbour(n,i.POSITIVE_INFINITY)}}else if(2===arguments.length){if(arguments[0]instanceof Ae&&C(arguments[1],Ie)){var r=arguments[0],o=arguments[1];return e=new Ce(this.getRoot(),r.getRoot(),o),this.nearestNeighbour(e)}if(arguments[0]instanceof Ce&&"number"==typeof arguments[1]){var a=arguments[0],s=arguments[1],u=s,c=null,l=new Ee;for(l.add(a);!l.isEmpty()&&u>0;){var f=l.poll(),h=f.getDistance();if(h>=u)break;f.isLeaves()?(u=h,c=f):f.expandToQueue(l,u)}return[c.getBoundable(0).getItem(),c.getBoundable(1).getItem()]}}else if(3===arguments.length){var d=arguments[0],p=arguments[1],g=arguments[2],v=new we(d,p);return e=new Ce(this.getRoot(),v,g),this.nearestNeighbour(e)[0]}},interfaces_:function(){return[Oe,u]},getClass:function(){return Ae}}),Ae.centreX=function(t){return Ae.avg(t.getMinX(),t.getMaxX())},Ae.avg=function(t,e){return(t+e)/2},Ae.centreY=function(t){return Ae.avg(t.getMinY(),t.getMaxY())},l(Te,Pe),e(Te.prototype,{computeBounds:function(){for(var t=null,e=this.getChildBoundables().iterator();e.hasNext();){var n=e.next();null===t?t=new E(n.getBounds()):t.expandToInclude(n.getBounds())}return t},interfaces_:function(){return[]},getClass:function(){return Te}}),Ae.STRtreeNode=Te,Ae.serialVersionUID=0x39920f7d5f261e0,Ae.xComparator={interfaces_:function(){return[s]},compare:function(t,e){return Me.compareDoubles(Ae.centreX(t.getBounds()),Ae.centreX(e.getBounds()))}},Ae.yComparator={interfaces_:function(){return[s]},compare:function(t,e){return Me.compareDoubles(Ae.centreY(t.getBounds()),Ae.centreY(e.getBounds()))}},Ae.intersectsOp={interfaces_:function(){return[IntersectsOp]},intersects:function(t,e){return t.intersects(e)}},Ae.DEFAULT_NODE_CAPACITY=10,e(Ne.prototype,{interfaces_:function(){return[]},getClass:function(){return Ne}}),Ne.relativeSign=function(t,e){return t<e?-1:t>e?1:0},Ne.compare=function(t,e,n){if(e.equals2D(n))return 0;var r=Ne.relativeSign(e.x,n.x),i=Ne.relativeSign(e.y,n.y);switch(t){case 0:return Ne.compareValue(r,i);case 1:return Ne.compareValue(i,r);case 2:return Ne.compareValue(i,-r);case 3:return Ne.compareValue(-r,i);case 4:return Ne.compareValue(-r,-i);case 5:return Ne.compareValue(-i,-r);case 6:return Ne.compareValue(-i,r);case 7:return Ne.compareValue(r,-i)}return h.shouldNeverReachHere("invalid octant value"),0},Ne.compareValue=function(t,e){return t<0?-1:t>0?1:e<0?-1:e>0?1:0},e(Le.prototype,{getCoordinate:function(){return this.coord},print:function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex)},compareTo:function(t){var e=t;return this.segmentIndex<e.segmentIndex?-1:this.segmentIndex>e.segmentIndex?1:this.coord.equals2D(e.coord)?0:Ne.compare(this.segmentOctant,this.coord,e.coord)},isEndPoint:function(t){return 0===this.segmentIndex&&!this._isInterior||this.segmentIndex===t},isInterior:function(){return this._isInterior},interfaces_:function(){return[o]},getClass:function(){return Le}}),e(Re.prototype,{getSplitCoordinates:function(){var t=new w;this.addEndpoints();for(var e=this.iterator(),n=e.next();e.hasNext();){var r=e.next();this.addEdgeCoordinates(n,r,t),n=r}return t.toCoordinateArray()},addCollapsedNodes:function(){var t=new x;this.findCollapsesFromInsertedNodes(t),this.findCollapsesFromExistingVertices(t);for(var e=t.iterator();e.hasNext();){var n=e.next().intValue();this.add(this.edge.getCoordinate(n),n)}},print:function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(t)},findCollapsesFromExistingVertices:function(t){for(var e=0;e<this.edge.size()-2;e++){var n=this.edge.getCoordinate(e),r=(this.edge.getCoordinate(e+1),this.edge.getCoordinate(e+2));n.equals2D(r)&&t.add(new A(e+1))}},addEdgeCoordinates:function(t,e,n){e.segmentIndex,t.segmentIndex;var r=this.edge.getCoordinate(e.segmentIndex),i=e.isInterior()||!e.coord.equals2D(r);n.add(new d(t.coord),!1);for(var o=t.segmentIndex+1;o<=e.segmentIndex;o++)n.add(this.edge.getCoordinate(o));i&&n.add(new d(e.coord))},iterator:function(){return this.nodeMap.values().iterator()},addSplitEdges:function(t){this.addEndpoints(),this.addCollapsedNodes();for(var e=this.iterator(),n=e.next();e.hasNext();){var r=e.next(),i=this.createSplitEdge(n,r);t.add(i),n=r}},findCollapseIndex:function(t,e,n){if(!t.coord.equals2D(e.coord))return!1;var r=e.segmentIndex-t.segmentIndex;return e.isInterior()||r--,1===r&&(n[0]=t.segmentIndex+1,!0)},findCollapsesFromInsertedNodes:function(t){for(var e=new Array(1).fill(null),n=this.iterator(),r=n.next();n.hasNext();){var i=n.next();this.findCollapseIndex(r,i,e)&&t.add(new A(e[0])),r=i}},getEdge:function(){return this.edge},addEndpoints:function(){var t=this.edge.size()-1;this.add(this.edge.getCoordinate(0),0),this.add(this.edge.getCoordinate(t),t)},createSplitEdge:function(t,e){var n=e.segmentIndex-t.segmentIndex+2,r=this.edge.getCoordinate(e.segmentIndex),i=e.isInterior()||!e.coord.equals2D(r);i||n--;var o=new Array(n).fill(null),a=0;o[a++]=new d(t.coord);for(var s=t.segmentIndex+1;s<=e.segmentIndex;s++)o[a++]=this.edge.getCoordinate(s);return i&&(o[a]=new d(e.coord)),new Fe(o,this.edge.getData())},add:function(t,e){var n=new Le(this.edge,t,e,this.edge.getSegmentOctant(e)),r=this.nodeMap.get(n);return null!==r?(h.isTrue(r.coord.equals2D(t),"Found equal nodes with different coordinates"),r):(this.nodeMap.put(n,n),n)},checkSplitEdgesCorrectness:function(t){var e=this.edge.getCoordinates(),n=t.get(0).getCoordinate(0);if(!n.equals2D(e[0]))throw new c("bad split edge start point at "+n);var r=t.get(t.size()-1).getCoordinates(),i=r[r.length-1];if(!i.equals2D(e[e.length-1]))throw new c("bad split edge end point at "+i)},interfaces_:function(){return[]},getClass:function(){return Re}}),e(ke.prototype,{next:function(){return null===this.currNode?(this.currNode=this.nextNode,this.currSegIndex=this.currNode.segmentIndex,this.readNextNode(),this.currNode):null===this.nextNode?null:this.nextNode.segmentIndex===this.currNode.segmentIndex?(this.currNode=this.nextNode,this.currSegIndex=this.currNode.segmentIndex,this.readNextNode(),this.currNode):(this.nextNode.segmentIndex,this.currNode.segmentIndex,null)},remove:function(){throw new UnsupportedOperationException(this.getClass().getName())},hasNext:function(){return null!==this.nextNode},readNextNode:function(){this.nodeIt.hasNext()?this.nextNode=this.nodeIt.next():this.nextNode=null},interfaces_:function(){return[g]},getClass:function(){return ke}}),e(je.prototype,{addIntersection:function(t,e){},interfaces_:function(){return[be]},getClass:function(){return je}}),e(Fe.prototype,{getCoordinates:function(){return this.pts},size:function(){return this.pts.length},getCoordinate:function(t){return this.pts[t]},isClosed:function(){return this.pts[0].equals(this.pts[this.pts.length-1])},getSegmentOctant:function(t){return t===this.pts.length-1?-1:this.safeOctant(this.getCoordinate(t),this.getCoordinate(t+1))},setData:function(t){this.data=t},safeOctant:function(t,e){return t.equals2D(e)?0:me.octant(t,e)},getData:function(){return this.data},addIntersection:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.addIntersectionNode(t,e)}else if(4===arguments.length){var n=arguments[0],r=arguments[1],i=(arguments[2],arguments[3]),o=new d(n.getIntersection(i));this.addIntersection(o,r)}},toString:function(){return Yt.toLineString(new jt(this.pts))},getNodeList:function(){return this.nodeList},addIntersectionNode:function(t,e){var n=e,r=n+1;if(r<this.pts.length){var i=this.pts[r];t.equals2D(i)&&(n=r)}return this.nodeList.add(t,n)},addIntersections:function(t,e,n){for(var r=0;r<t.getIntersectionNum();r++)this.addIntersection(t,e,n,r)},interfaces_:function(){return[je]},getClass:function(){return Fe}}),Fe.getNodedSubstrings=function(){if(1===arguments.length){var t=arguments[0],e=new x;return Fe.getNodedSubstrings(t,e),e}if(2===arguments.length)for(var n=arguments[0],r=arguments[1],i=n.iterator();i.hasNext();){var o=i.next();o.getNodeList().addSplitEdges(r)}},e(De.prototype,{overlap:function(){if(2===arguments.length)arguments[0],arguments[1];else if(4===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2],r=arguments[3];t.getLineSegment(e,this.overlapSeg1),n.getLineSegment(r,this.overlapSeg2),this.overlap(this.overlapSeg1,this.overlapSeg2)}},interfaces_:function(){return[]},getClass:function(){return De}}),e(Be.prototype,{getLineSegment:function(t,e){e.p0=this.pts[t],e.p1=this.pts[t+1]},computeSelect:function(t,e,n,r){var i=this.pts[e],o=this.pts[n];if(r.tempEnv1.init(i,o),n-e==1)return r.select(this,e),null;if(!t.intersects(r.tempEnv1))return null;var a=Math.trunc((e+n)/2);e<a&&this.computeSelect(t,e,a,r),a<n&&this.computeSelect(t,a,n,r)},getCoordinates:function(){for(var t=new Array(this.end-this.start+1).fill(null),e=0,n=this.start;n<=this.end;n++)t[e++]=this.pts[n];return t},computeOverlaps:function(t,e){this.computeOverlapsInternal(this.start,this.end,t,t.start,t.end,e)},setId:function(t){this.id=t},select:function(t,e){this.computeSelect(t,this.start,this.end,e)},getEnvelope:function(){if(null===this.env){var t=this.pts[this.start],e=this.pts[this.end];this.env=new E(t,e)}return this.env},getEndIndex:function(){return this.end},getStartIndex:function(){return this.start},getContext:function(){return this.context},getId:function(){return this.id},computeOverlapsInternal:function(t,e,n,r,i,o){var a=this.pts[t],s=this.pts[e],u=n.pts[r],c=n.pts[i];if(e-t==1&&i-r==1)return o.overlap(this,t,n,r),null;if(o.tempEnv1.init(a,s),o.tempEnv2.init(u,c),!o.tempEnv1.intersects(o.tempEnv2))return null;var l=Math.trunc((t+e)/2),f=Math.trunc((r+i)/2);t<l&&(r<f&&this.computeOverlapsInternal(t,l,n,r,f,o),f<i&&this.computeOverlapsInternal(t,l,n,f,i,o)),l<e&&(r<f&&this.computeOverlapsInternal(l,e,n,r,f,o),f<i&&this.computeOverlapsInternal(l,e,n,f,i,o))},interfaces_:function(){return[]},getClass:function(){return Be}}),e(ze.prototype,{interfaces_:function(){return[]},getClass:function(){return ze}}),ze.isNorthern=function(t){return t===ze.NE||t===ze.NW},ze.isOpposite=function(t,e){return t!==e&&2==(t-e+4)%4},ze.commonHalfPlane=function(t,e){if(t===e)return t;if(2==(t-e+4)%4)return-1;var n=t<e?t:e;return 0===n&&3===(t>e?t:e)?3:n},ze.isInHalfPlane=function(t,e){return e===ze.SE?t===ze.SE||t===ze.SW:t===e||t===e+1},ze.quadrant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new r("Cannot compute the quadrant for point ( "+t+", "+e+" )");return t>=0?e>=0?ze.NE:ze.SE:e>=0?ze.NW:ze.SW}if(arguments[0]instanceof d&&arguments[1]instanceof d){var n=arguments[0],i=arguments[1];if(i.x===n.x&&i.y===n.y)throw new r("Cannot compute the quadrant for two identical points "+n);return i.x>=n.x?i.y>=n.y?ze.NE:ze.SE:i.y>=n.y?ze.NW:ze.SW}},ze.NE=0,ze.NW=1,ze.SW=2,ze.SE=3,e(Ve.prototype,{interfaces_:function(){return[]},getClass:function(){return Ve}}),Ve.getChainStartIndices=function(t){var e=0,n=new x;n.add(new A(e));do{var r=Ve.findChainEnd(t,e);n.add(new A(r)),e=r}while(e<t.length-1);return Ve.toIntArray(n)},Ve.findChainEnd=function(t,e){for(var n=e;n<t.length-1&&t[n].equals2D(t[n+1]);)n++;if(n>=t.length-1)return t.length-1;for(var r=ze.quadrant(t[n],t[n+1]),i=e+1;i<t.length&&(t[i-1].equals2D(t[i])||ze.quadrant(t[i-1],t[i])===r);)i++;return i-1},Ve.getChains=function(){if(1===arguments.length){var t=arguments[0];return Ve.getChains(t,null)}if(2===arguments.length){for(var e=arguments[0],n=arguments[1],r=new x,i=Ve.getChainStartIndices(e),o=0;o<i.length-1;o++){var a=new Be(e,i[o],i[o+1],n);r.add(a)}return r}},Ve.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e},e(Ge.prototype,{computeNodes:function(t){},getNodedSubstrings:function(){},interfaces_:function(){return[]},getClass:function(){return Ge}}),e(Ue.prototype,{setSegmentIntersector:function(t){this.segInt=t},interfaces_:function(){return[Ge]},getClass:function(){return Ue}}),l(We,Ue),e(We.prototype,{getMonotoneChains:function(){return this.monoChains},getNodedSubstrings:function(){return Fe.getNodedSubstrings(this.nodedSegStrings)},getIndex:function(){return this.index},add:function(t){for(var e=Ve.getChains(t.getCoordinates(),t).iterator();e.hasNext();){var n=e.next();n.setId(this.idCounter++),this.index.insert(n.getEnvelope(),n),this.monoChains.add(n)}},computeNodes:function(t){this.nodedSegStrings=t;for(var e=t.iterator();e.hasNext();)this.add(e.next());this.intersectChains()},intersectChains:function(){for(var t=new qe(this.segInt),e=this.monoChains.iterator();e.hasNext();)for(var n=e.next(),r=this.index.query(n.getEnvelope()).iterator();r.hasNext();){var i=r.next();if(i.getId()>n.getId()&&(n.computeOverlaps(i,t),this.nOverlaps++),this.segInt.isDone())return null}},interfaces_:function(){return[]},getClass:function(){return We}}),l(qe,De),e(qe.prototype,{overlap:function(){if(4!==arguments.length)return De.prototype.overlap.apply(this,arguments);var t=arguments[0],e=arguments[1],n=arguments[2],r=arguments[3],i=t.getContext(),o=n.getContext();this.si.processIntersections(i,e,o,r)},interfaces_:function(){return[]},getClass:function(){return qe}}),We.SegmentOverlapAction=qe,l(Xe,c),e(Xe.prototype,{getCoordinate:function(){return this.pt},interfaces_:function(){return[]},getClass:function(){return Xe}}),Xe.msgWithCoord=function(t,e){return null!==e?t+" [ "+e+" ]":t},e(He.prototype,{processIntersections:function(t,e,n,r){},isDone:function(){},interfaces_:function(){return[]},getClass:function(){return He}}),e(Ye.prototype,{getInteriorIntersection:function(){return this.interiorIntersection},setCheckEndSegmentsOnly:function(t){this.isCheckEndSegmentsOnly=t},getIntersectionSegments:function(){return this.intSegments},count:function(){return this.intersectionCount},getIntersections:function(){return this.intersections},setFindAllIntersections:function(t){this.findAllIntersections=t},setKeepIntersections:function(t){this.keepIntersections=t},processIntersections:function(t,e,n,r){if(!this.findAllIntersections&&this.hasIntersection())return null;if(t===n&&e===r)return null;if(this.isCheckEndSegmentsOnly&&!this.isEndSegment(t,e)&&!this.isEndSegment(n,r))return null;var i=t.getCoordinates()[e],o=t.getCoordinates()[e+1],a=n.getCoordinates()[r],s=n.getCoordinates()[r+1];this.li.computeIntersection(i,o,a,s),this.li.hasIntersection()&&this.li.isInteriorIntersection()&&(this.intSegments=new Array(4).fill(null),this.intSegments[0]=i,this.intSegments[1]=o,this.intSegments[2]=a,this.intSegments[3]=s,this.interiorIntersection=this.li.getIntersection(0),this.keepIntersections&&this.intersections.add(this.interiorIntersection),this.intersectionCount++)},isEndSegment:function(t,e){return 0===e||e>=t.size()-2},hasIntersection:function(){return null!==this.interiorIntersection},isDone:function(){return!this.findAllIntersections&&null!==this.interiorIntersection},interfaces_:function(){return[He]},getClass:function(){return Ye}}),Ye.createAllIntersectionsFinder=function(t){var e=new Ye(t);return e.setFindAllIntersections(!0),e},Ye.createAnyIntersectionFinder=function(t){return new Ye(t)},Ye.createIntersectionCounter=function(t){var e=new Ye(t);return e.setFindAllIntersections(!0),e.setKeepIntersections(!1),e},e(Ze.prototype,{execute:function(){return null!==this.segInt?null:void this.checkInteriorIntersections()},getIntersections:function(){return this.segInt.getIntersections()},isValid:function(){return this.execute(),this._isValid},setFindAllIntersections:function(t){this.findAllIntersections=t},checkInteriorIntersections:function(){this._isValid=!0,this.segInt=new Ye(this.li),this.segInt.setFindAllIntersections(this.findAllIntersections);var t=new We;if(t.setSegmentIntersector(this.segInt),t.computeNodes(this.segStrings),this.segInt.hasIntersection())return this._isValid=!1,null},checkValid:function(){if(this.execute(),!this._isValid)throw new Xe(this.getErrorMessage(),this.segInt.getInteriorIntersection())},getErrorMessage:function(){if(this._isValid)return"no intersections found";var t=this.segInt.getIntersectionSegments();return"found non-noded intersection between "+Yt.toLineString(t[0],t[1])+" and "+Yt.toLineString(t[2],t[3])},interfaces_:function(){return[]},getClass:function(){return Ze}}),Ze.computeIntersections=function(t){var e=new Ze(t);return e.setFindAllIntersections(!0),e.isValid(),e.getIntersections()},e(Ke.prototype,{checkValid:function(){this.nv.checkValid()},interfaces_:function(){return[]},getClass:function(){return Ke}}),Ke.toSegmentStrings=function(t){for(var e=new x,n=t.iterator();n.hasNext();){var r=n.next();e.add(new _e(r.getCoordinates(),r))}return e},Ke.checkValid=function(t){new Ke(t).checkValid()},e(Je.prototype,{map:function(t){for(var e=new x,n=0;n<t.getNumGeometries();n++){var r=this.mapOp.map(t.getGeometryN(n));r.isEmpty()||e.add(r)}return t.getFactory().createGeometryCollection(Xt.toGeometryArray(e))},interfaces_:function(){return[]},getClass:function(){return Je}}),Je.map=function(t,e){return new Je(e).map(t)},e(Qe.prototype,{interfaces_:function(){return[]},getClass:function(){return Qe}}),Qe.opposite=function(t){return t===Qe.LEFT?Qe.RIGHT:t===Qe.RIGHT?Qe.LEFT:t},Qe.ON=0,Qe.LEFT=1,Qe.RIGHT=2,e($e.prototype,{setAllLocations:function(t){for(var e=0;e<this.location.length;e++)this.location[e]=t},isNull:function(){for(var t=0;t<this.location.length;t++)if(this.location[t]!==P.NONE)return!1;return!0},setAllLocationsIfNull:function(t){for(var e=0;e<this.location.length;e++)this.location[e]===P.NONE&&(this.location[e]=t)},isLine:function(){return 1===this.location.length},merge:function(t){if(t.location.length>this.location.length){var e=new Array(3).fill(null);e[Qe.ON]=this.location[Qe.ON],e[Qe.LEFT]=P.NONE,e[Qe.RIGHT]=P.NONE,this.location=e}for(var n=0;n<this.location.length;n++)this.location[n]===P.NONE&&n<t.location.length&&(this.location[n]=t.location[n])},getLocations:function(){return this.location},flip:function(){if(this.location.length<=1)return null;var t=this.location[Qe.LEFT];this.location[Qe.LEFT]=this.location[Qe.RIGHT],this.location[Qe.RIGHT]=t},toString:function(){var t=new I;return this.location.length>1&&t.append(P.toLocationSymbol(this.location[Qe.LEFT])),t.append(P.toLocationSymbol(this.location[Qe.ON])),this.location.length>1&&t.append(P.toLocationSymbol(this.location[Qe.RIGHT])),t.toString()},setLocations:function(t,e,n){this.location[Qe.ON]=t,this.location[Qe.LEFT]=e,this.location[Qe.RIGHT]=n},get:function(t){return t<this.location.length?this.location[t]:P.NONE},isArea:function(){return this.location.length>1},isAnyNull:function(){for(var t=0;t<this.location.length;t++)if(this.location[t]===P.NONE)return!0;return!1},setLocation:function(){if(1===arguments.length){var t=arguments[0];this.setLocation(Qe.ON,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.location[e]=n}},init:function(t){this.location=new Array(t).fill(null),this.setAllLocations(P.NONE)},isEqualOnSide:function(t,e){return this.location[e]===t.location[e]},allPositionsEqual:function(t){for(var e=0;e<this.location.length;e++)if(this.location[e]!==t)return!1;return!0},interfaces_:function(){return[]},getClass:function(){return $e}}),e(tn.prototype,{getGeometryCount:function(){var t=0;return this.elt[0].isNull()||t++,this.elt[1].isNull()||t++,t},setAllLocations:function(t,e){this.elt[t].setAllLocations(e)},isNull:function(t){return this.elt[t].isNull()},setAllLocationsIfNull:function(){if(1===arguments.length){var t=arguments[0];this.setAllLocationsIfNull(0,t),this.setAllLocationsIfNull(1,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.elt[e].setAllLocationsIfNull(n)}},isLine:function(t){return this.elt[t].isLine()},merge:function(t){for(var e=0;e<2;e++)null===this.elt[e]&&null!==t.elt[e]?this.elt[e]=new $e(t.elt[e]):this.elt[e].merge(t.elt[e])},flip:function(){this.elt[0].flip(),this.elt[1].flip()},getLocation:function(){if(1===arguments.length){var t=arguments[0];return this.elt[t].get(Qe.ON)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return this.elt[e].get(n)}},toString:function(){var t=new I;return null!==this.elt[0]&&(t.append("A:"),t.append(this.elt[0].toString())),null!==this.elt[1]&&(t.append(" B:"),t.append(this.elt[1].toString())),t.toString()},isArea:function(){if(0===arguments.length)return this.elt[0].isArea()||this.elt[1].isArea();if(1===arguments.length){var t=arguments[0];return this.elt[t].isArea()}},isAnyNull:function(t){return this.elt[t].isAnyNull()},setLocation:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.elt[t].setLocation(Qe.ON,e)}else if(3===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2];this.elt[n].setLocation(r,i)}},isEqualOnSide:function(t,e){return this.elt[0].isEqualOnSide(t.elt[0],e)&&this.elt[1].isEqualOnSide(t.elt[1],e)},allPositionsEqual:function(t,e){return this.elt[t].allPositionsEqual(e)},toLine:function(t){this.elt[t].isArea()&&(this.elt[t]=new $e(this.elt[t].location[0]))},interfaces_:function(){return[]},getClass:function(){return tn}}),tn.toLineLabel=function(t){for(var e=new tn(P.NONE),n=0;n<2;n++)e.setLocation(n,t.getLocation(n));return e},e(en.prototype,{computeRing:function(){if(null!==this.ring)return null;for(var t=new Array(this.pts.size()).fill(null),e=0;e<this.pts.size();e++)t[e]=this.pts.get(e);this.ring=this.geometryFactory.createLinearRing(t),this._isHole=$t.isCCW(this.ring.getCoordinates())},isIsolated:function(){return 1===this.label.getGeometryCount()},computePoints:function(t){this.startDe=t;var e=t,n=!0;do{if(null===e)throw new Xe("Found null DirectedEdge");if(e.getEdgeRing()===this)throw new Xe("Directed Edge visited twice during ring-building at "+e.getCoordinate());this.edges.add(e);var r=e.getLabel();h.isTrue(r.isArea()),this.mergeLabel(r),this.addPoints(e.getEdge(),e.isForward(),n),n=!1,this.setEdgeRing(e,this),e=this.getNext(e)}while(e!==this.startDe)},getLinearRing:function(){return this.ring},getCoordinate:function(t){return this.pts.get(t)},computeMaxNodeDegree:function(){this.maxNodeDegree=0;var t=this.startDe;do{var e=t.getNode().getEdges().getOutgoingDegree(this);e>this.maxNodeDegree&&(this.maxNodeDegree=e),t=this.getNext(t)}while(t!==this.startDe);this.maxNodeDegree*=2},addPoints:function(t,e,n){var r=t.getCoordinates();if(e){var i=1;n&&(i=0);for(var o=i;o<r.length;o++)this.pts.add(r[o])}else for(i=r.length-2,n&&(i=r.length-1),o=i;o>=0;o--)this.pts.add(r[o])},isHole:function(){return this._isHole},setInResult:function(){var t=this.startDe;do{t.getEdge().setInResult(!0),t=t.getNext()}while(t!==this.startDe)},containsPoint:function(t){var e=this.getLinearRing();if(!e.getEnvelopeInternal().contains(t))return!1;if(!$t.isPointInRing(t,e.getCoordinates()))return!1;for(var n=this.holes.iterator();n.hasNext();)if(n.next().containsPoint(t))return!1;return!0},addHole:function(t){this.holes.add(t)},isShell:function(){return null===this.shell},getLabel:function(){return this.label},getEdges:function(){return this.edges},getMaxNodeDegree:function(){return this.maxNodeDegree<0&&this.computeMaxNodeDegree(),this.maxNodeDegree},getShell:function(){return this.shell},mergeLabel:function(){if(1===arguments.length){var t=arguments[0];this.mergeLabel(t,0),this.mergeLabel(t,1)}else if(2===arguments.length){var e=arguments[0],n=arguments[1],r=e.getLocation(n,Qe.RIGHT);if(r===P.NONE)return null;if(this.label.getLocation(n)===P.NONE)return this.label.setLocation(n,r),null}},setShell:function(t){this.shell=t,null!==t&&t.addHole(this)},toPolygon:function(t){for(var e=new Array(this.holes.size()).fill(null),n=0;n<this.holes.size();n++)e[n]=this.holes.get(n).getLinearRing();return t.createPolygon(this.getLinearRing(),e)},interfaces_:function(){return[]},getClass:function(){return en}}),l(nn,en),e(nn.prototype,{setEdgeRing:function(t,e){t.setMinEdgeRing(e)},getNext:function(t){return t.getNextMin()},interfaces_:function(){return[]},getClass:function(){return nn}}),l(rn,en),e(rn.prototype,{buildMinimalRings:function(){var t=new x,e=this.startDe;do{if(null===e.getMinEdgeRing()){var n=new nn(e,this.geometryFactory);t.add(n)}e=e.getNext()}while(e!==this.startDe);return t},setEdgeRing:function(t,e){t.setEdgeRing(e)},linkDirectedEdgesForMinimalEdgeRings:function(){var t=this.startDe;do{t.getNode().getEdges().linkMinimalDirectedEdges(this),t=t.getNext()}while(t!==this.startDe)},getNext:function(t){return t.getNext()},interfaces_:function(){return[]},getClass:function(){return rn}}),e(on.prototype,{setVisited:function(t){this._isVisited=t},setInResult:function(t){this._isInResult=t},isCovered:function(){return this._isCovered},isCoveredSet:function(){return this._isCoveredSet},setLabel:function(t){this.label=t},getLabel:function(){return this.label},setCovered:function(t){this._isCovered=t,this._isCoveredSet=!0},updateIM:function(t){h.isTrue(this.label.getGeometryCount()>=2,"found partial label"),this.computeIM(t)},isInResult:function(){return this._isInResult},isVisited:function(){return this._isVisited},interfaces_:function(){return[]},getClass:function(){return on}}),l(an,on),e(an.prototype,{isIncidentEdgeInResult:function(){for(var t=this.getEdges().getEdges().iterator();t.hasNext();)if(t.next().getEdge().isInResult())return!0;return!1},isIsolated:function(){return 1===this.label.getGeometryCount()},getCoordinate:function(){return this.coord},print:function(t){t.println("node "+this.coord+" lbl: "+this.label)},computeIM:function(t){},computeMergedLocation:function(t,e){var n=P.NONE;if(n=this.label.getLocation(e),!t.isNull(e)){var r=t.getLocation(e);n!==P.BOUNDARY&&(n=r)}return n},setLabel:function(){if(2!==arguments.length)return on.prototype.setLabel.apply(this,arguments);var t=arguments[0],e=arguments[1];null===this.label?this.label=new tn(t,e):this.label.setLocation(t,e)},getEdges:function(){return this.edges},mergeLabel:function(){if(arguments[0]instanceof an){var t=arguments[0];this.mergeLabel(t.label)}else if(arguments[0]instanceof tn)for(var e=arguments[0],n=0;n<2;n++){var r=this.computeMergedLocation(e,n),i=this.label.getLocation(n);i===P.NONE&&this.label.setLocation(n,r)}},add:function(t){this.edges.insert(t),t.setNode(this)},setLabelBoundary:function(t){if(null===this.label)return null;var e=P.NONE;null!==this.label&&(e=this.label.getLocation(t));var n=null;switch(e){case P.BOUNDARY:n=P.INTERIOR;break;case P.INTERIOR:n=P.BOUNDARY;break;default:n=P.BOUNDARY}this.label.setLocation(t,n)},interfaces_:function(){return[]},getClass:function(){return an}}),e(sn.prototype,{find:function(t){return this.nodeMap.get(t)},addNode:function(){if(arguments[0]instanceof d){var t=arguments[0];return null===(e=this.nodeMap.get(t))&&(e=this.nodeFact.createNode(t),this.nodeMap.put(t,e)),e}if(arguments[0]instanceof an){var e,n=arguments[0];return null===(e=this.nodeMap.get(n.getCoordinate()))?(this.nodeMap.put(n.getCoordinate(),n),n):(e.mergeLabel(n),e)}},print:function(t){for(var e=this.iterator();e.hasNext();)e.next().print(t)},iterator:function(){return this.nodeMap.values().iterator()},values:function(){return this.nodeMap.values()},getBoundaryNodes:function(t){for(var e=new x,n=this.iterator();n.hasNext();){var r=n.next();r.getLabel().getLocation(t)===P.BOUNDARY&&e.add(r)}return e},add:function(t){var e=t.getCoordinate();this.addNode(e).add(t)},interfaces_:function(){return[]},getClass:function(){return sn}}),e(un.prototype,{compareDirection:function(t){return this.dx===t.dx&&this.dy===t.dy?0:this.quadrant>t.quadrant?1:this.quadrant<t.quadrant?-1:$t.computeOrientation(t.p0,t.p1,this.p1)},getDy:function(){return this.dy},getCoordinate:function(){return this.p0},setNode:function(t){this.node=t},print:function(t){var e=Math.atan2(this.dy,this.dx),n=this.getClass().getName(),r=n.lastIndexOf("."),i=n.substring(r+1);t.print("  "+i+": "+this.p0+" - "+this.p1+" "+this.quadrant+":"+e+"   "+this.label)},compareTo:function(t){var e=t;return this.compareDirection(e)},getDirectedCoordinate:function(){return this.p1},getDx:function(){return this.dx},getLabel:function(){return this.label},getEdge:function(){return this.edge},getQuadrant:function(){return this.quadrant},getNode:function(){return this.node},toString:function(){var t=Math.atan2(this.dy,this.dx),e=this.getClass().getName(),n=e.lastIndexOf(".");return"  "+e.substring(n+1)+": "+this.p0+" - "+this.p1+" "+this.quadrant+":"+t+"   "+this.label},computeLabel:function(t){},init:function(t,e){this.p0=t,this.p1=e,this.dx=e.x-t.x,this.dy=e.y-t.y,this.quadrant=ze.quadrant(this.dx,this.dy),h.isTrue(!(0===this.dx&&0===this.dy),"EdgeEnd with identical endpoints found")},interfaces_:function(){return[o]},getClass:function(){return un}}),l(cn,un),e(cn.prototype,{getNextMin:function(){return this.nextMin},getDepth:function(t){return this.depth[t]},setVisited:function(t){this._isVisited=t},computeDirectedLabel:function(){this.label=new tn(this.edge.getLabel()),this._isForward||this.label.flip()},getNext:function(){return this.next},setDepth:function(t,e){if(-999!==this.depth[t]&&this.depth[t]!==e)throw new Xe("assigned depths do not match",this.getCoordinate());this.depth[t]=e},isInteriorAreaEdge:function(){for(var t=!0,e=0;e<2;e++)this.label.isArea(e)&&this.label.getLocation(e,Qe.LEFT)===P.INTERIOR&&this.label.getLocation(e,Qe.RIGHT)===P.INTERIOR||(t=!1);return t},setNextMin:function(t){this.nextMin=t},print:function(t){un.prototype.print.call(this,t),t.print(" "+this.depth[Qe.LEFT]+"/"+this.depth[Qe.RIGHT]),t.print(" ("+this.getDepthDelta()+")"),this._isInResult&&t.print(" inResult")},setMinEdgeRing:function(t){this.minEdgeRing=t},isLineEdge:function(){var t=this.label.isLine(0)||this.label.isLine(1),e=!this.label.isArea(0)||this.label.allPositionsEqual(0,P.EXTERIOR),n=!this.label.isArea(1)||this.label.allPositionsEqual(1,P.EXTERIOR);return t&&e&&n},setEdgeRing:function(t){this.edgeRing=t},getMinEdgeRing:function(){return this.minEdgeRing},getDepthDelta:function(){var t=this.edge.getDepthDelta();return this._isForward||(t=-t),t},setInResult:function(t){this._isInResult=t},getSym:function(){return this.sym},isForward:function(){return this._isForward},getEdge:function(){return this.edge},printEdge:function(t){this.print(t),t.print(" "),this._isForward?this.edge.print(t):this.edge.printReverse(t)},setSym:function(t){this.sym=t},setVisitedEdge:function(t){this.setVisited(t),this.sym.setVisited(t)},setEdgeDepths:function(t,e){var n=this.getEdge().getDepthDelta();this._isForward||(n=-n);var r=1;t===Qe.LEFT&&(r=-1);var i=Qe.opposite(t),o=e+n*r;this.setDepth(t,e),this.setDepth(i,o)},getEdgeRing:function(){return this.edgeRing},isInResult:function(){return this._isInResult},setNext:function(t){this.next=t},isVisited:function(){return this._isVisited},interfaces_:function(){return[]},getClass:function(){return cn}}),cn.depthFactor=function(t,e){return t===P.EXTERIOR&&e===P.INTERIOR?1:t===P.INTERIOR&&e===P.EXTERIOR?-1:0},e(ln.prototype,{createNode:function(t){return new an(t,null)},interfaces_:function(){return[]},getClass:function(){return ln}}),e(fn.prototype,{printEdges:function(t){t.println("Edges:");for(var e=0;e<this.edges.size();e++){t.println("edge "+e+":");var n=this.edges.get(e);n.print(t),n.eiList.print(t)}},find:function(t){return this.nodes.find(t)},addNode:function(){if(arguments[0]instanceof an){var t=arguments[0];return this.nodes.addNode(t)}if(arguments[0]instanceof d){var e=arguments[0];return this.nodes.addNode(e)}},getNodeIterator:function(){return this.nodes.iterator()},linkResultDirectedEdges:function(){for(var t=this.nodes.iterator();t.hasNext();)t.next().getEdges().linkResultDirectedEdges()},debugPrintln:function(t){k.out.println(t)},isBoundaryNode:function(t,e){var n=this.nodes.find(e);if(null===n)return!1;var r=n.getLabel();return null!==r&&r.getLocation(t)===P.BOUNDARY},linkAllDirectedEdges:function(){for(var t=this.nodes.iterator();t.hasNext();)t.next().getEdges().linkAllDirectedEdges()},matchInSameDirection:function(t,e,n,r){return!!t.equals(n)&&$t.computeOrientation(t,e,r)===$t.COLLINEAR&&ze.quadrant(t,e)===ze.quadrant(n,r)},getEdgeEnds:function(){return this.edgeEndList},debugPrint:function(t){k.out.print(t)},getEdgeIterator:function(){return this.edges.iterator()},findEdgeInSameDirection:function(t,e){for(var n=0;n<this.edges.size();n++){var r=this.edges.get(n),i=r.getCoordinates();if(this.matchInSameDirection(t,e,i[0],i[1]))return r;if(this.matchInSameDirection(t,e,i[i.length-1],i[i.length-2]))return r}return null},insertEdge:function(t){this.edges.add(t)},findEdgeEnd:function(t){for(var e=this.getEdgeEnds().iterator();e.hasNext();){var n=e.next();if(n.getEdge()===t)return n}return null},addEdges:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.edges.add(n);var r=new cn(n,!0),i=new cn(n,!1);r.setSym(i),i.setSym(r),this.add(r),this.add(i)}},add:function(t){this.nodes.add(t),this.edgeEndList.add(t)},getNodes:function(){return this.nodes.values()},findEdge:function(t,e){for(var n=0;n<this.edges.size();n++){var r=this.edges.get(n),i=r.getCoordinates();if(t.equals(i[0])&&e.equals(i[1]))return r}return null},interfaces_:function(){return[]},getClass:function(){return fn}}),fn.linkResultDirectedEdges=function(t){for(var e=t.iterator();e.hasNext();)e.next().getEdges().linkResultDirectedEdges()},e(hn.prototype,{sortShellsAndHoles:function(t,e,n){for(var r=t.iterator();r.hasNext();){var i=r.next();i.isHole()?n.add(i):e.add(i)}},computePolygons:function(t){for(var e=new x,n=t.iterator();n.hasNext();){var r=n.next().toPolygon(this.geometryFactory);e.add(r)}return e},placeFreeHoles:function(t,e){for(var n=e.iterator();n.hasNext();){var r=n.next();if(null===r.getShell()){var i=this.findEdgeRingContaining(r,t);if(null===i)throw new Xe("unable to assign hole to a shell",r.getCoordinate(0));r.setShell(i)}}},buildMinimalEdgeRings:function(t,e,n){for(var r=new x,i=t.iterator();i.hasNext();){var o=i.next();if(o.getMaxNodeDegree()>2){o.linkDirectedEdgesForMinimalEdgeRings();var a=o.buildMinimalRings(),s=this.findShell(a);null!==s?(this.placePolygonHoles(s,a),e.add(s)):n.addAll(a)}else r.add(o)}return r},containsPoint:function(t){for(var e=this.shellList.iterator();e.hasNext();)if(e.next().containsPoint(t))return!0;return!1},buildMaximalEdgeRings:function(t){for(var e=new x,n=t.iterator();n.hasNext();){var r=n.next();if(r.isInResult()&&r.getLabel().isArea()&&null===r.getEdgeRing()){var i=new rn(r,this.geometryFactory);e.add(i),i.setInResult()}}return e},placePolygonHoles:function(t,e){for(var n=e.iterator();n.hasNext();){var r=n.next();r.isHole()&&r.setShell(t)}},getPolygons:function(){return this.computePolygons(this.shellList)},findEdgeRingContaining:function(t,e){for(var n=t.getLinearRing(),r=n.getEnvelopeInternal(),i=n.getCoordinateN(0),o=null,a=null,s=e.iterator();s.hasNext();){var u=s.next(),c=u.getLinearRing(),l=c.getEnvelopeInternal();null!==o&&(a=o.getLinearRing().getEnvelopeInternal());var f=!1;l.contains(r)&&$t.isPointInRing(i,c.getCoordinates())&&(f=!0),f&&(null===o||a.contains(l))&&(o=u)}return o},findShell:function(t){for(var e=0,n=null,r=t.iterator();r.hasNext();){var i=r.next();i.isHole()||(n=i,e++)}return h.isTrue(e<=1,"found two shells in MinimalEdgeRing list"),n},add:function(){if(1===arguments.length){var t=arguments[0];this.add(t.getEdgeEnds(),t.getNodes())}else if(2===arguments.length){var e=arguments[0],n=arguments[1];fn.linkResultDirectedEdges(n);var r=this.buildMaximalEdgeRings(e),i=new x,o=this.buildMinimalEdgeRings(r,this.shellList,i);this.sortShellsAndHoles(o,this.shellList,i),this.placeFreeHoles(this.shellList,i)}},interfaces_:function(){return[]},getClass:function(){return hn}}),e(dn.prototype,{collectLines:function(t){for(var e=this.op.getGraph().getEdgeEnds().iterator();e.hasNext();){var n=e.next();this.collectLineEdge(n,t,this.lineEdgesList),this.collectBoundaryTouchEdge(n,t,this.lineEdgesList)}},labelIsolatedLine:function(t,e){var n=this.ptLocator.locate(t.getCoordinate(),this.op.getArgGeometry(e));t.getLabel().setLocation(e,n)},build:function(t){return this.findCoveredLineEdges(),this.collectLines(t),this.buildLines(t),this.resultLineList},collectLineEdge:function(t,e,n){var r=t.getLabel(),i=t.getEdge();t.isLineEdge()&&(t.isVisited()||!qn.isResultOfOp(r,e)||i.isCovered()||(n.add(i),t.setVisitedEdge(!0)))},findCoveredLineEdges:function(){for(var t=this.op.getGraph().getNodes().iterator();t.hasNext();)t.next().getEdges().findCoveredLineEdges();for(var e=this.op.getGraph().getEdgeEnds().iterator();e.hasNext();){var n=e.next(),r=n.getEdge();if(n.isLineEdge()&&!r.isCoveredSet()){var i=this.op.isCoveredByA(n.getCoordinate());r.setCovered(i)}}},labelIsolatedLines:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),r=n.getLabel();n.isIsolated()&&(r.isNull(0)?this.labelIsolatedLine(n,0):this.labelIsolatedLine(n,1))}},buildLines:function(t){for(var e=this.lineEdgesList.iterator();e.hasNext();){var n=e.next(),r=(n.getLabel(),this.geometryFactory.createLineString(n.getCoordinates()));this.resultLineList.add(r),n.setInResult(!0)}},collectBoundaryTouchEdge:function(t,e,n){var r=t.getLabel();return t.isLineEdge()||t.isVisited()||t.isInteriorAreaEdge()||t.getEdge().isInResult()?null:(h.isTrue(!(t.isInResult()||t.getSym().isInResult())||!t.getEdge().isInResult()),void(qn.isResultOfOp(r,e)&&e===qn.INTERSECTION&&(n.add(t.getEdge()),t.setVisitedEdge(!0))))},interfaces_:function(){return[]},getClass:function(){return dn}}),e(pn.prototype,{filterCoveredNodeToPoint:function(t){var e=t.getCoordinate();if(!this.op.isCoveredByLA(e)){var n=this.geometryFactory.createPoint(e);this.resultPointList.add(n)}},extractNonCoveredResultNodes:function(t){for(var e=this.op.getGraph().getNodes().iterator();e.hasNext();){var n=e.next();if(!(n.isInResult()||n.isIncidentEdgeInResult()||0!==n.getEdges().getDegree()&&t!==qn.INTERSECTION)){var r=n.getLabel();qn.isResultOfOp(r,t)&&this.filterCoveredNodeToPoint(n)}}},build:function(t){return this.extractNonCoveredResultNodes(t),this.resultPointList},interfaces_:function(){return[]},getClass:function(){return pn}}),e(gn.prototype,{locate:function(t){},interfaces_:function(){return[]},getClass:function(){return gn}}),e(vn.prototype,{locate:function(t){return vn.locate(t,this.geom)},interfaces_:function(){return[gn]},getClass:function(){return vn}}),vn.isPointInRing=function(t,e){return!!e.getEnvelopeInternal().intersects(t)&&$t.isPointInRing(t,e.getCoordinates())},vn.containsPointInPolygon=function(t,e){if(e.isEmpty())return!1;var n=e.getExteriorRing();if(!vn.isPointInRing(t,n))return!1;for(var r=0;r<e.getNumInteriorRing();r++){var i=e.getInteriorRingN(r);if(vn.isPointInRing(t,i))return!1}return!0},vn.containsPoint=function(t,e){if(e instanceof Ct)return vn.containsPointInPolygon(t,e);if(e instanceof ht)for(var n=new ve(e);n.hasNext();){var r=n.next();if(r!==e&&vn.containsPoint(t,r))return!0}return!1},vn.locate=function(t,e){return e.isEmpty()?P.EXTERIOR:vn.containsPoint(t,e)?P.INTERIOR:P.EXTERIOR},e(yn.prototype,{getNextCW:function(t){this.getEdges();var e=this.edgeList.indexOf(t),n=e-1;return 0===e&&(n=this.edgeList.size()-1),this.edgeList.get(n)},propagateSideLabels:function(t){for(var e=P.NONE,n=this.iterator();n.hasNext();)(o=(i=n.next()).getLabel()).isArea(t)&&o.getLocation(t,Qe.LEFT)!==P.NONE&&(e=o.getLocation(t,Qe.LEFT));if(e===P.NONE)return null;var r=e;for(n=this.iterator();n.hasNext();){var i,o;if((o=(i=n.next()).getLabel()).getLocation(t,Qe.ON)===P.NONE&&o.setLocation(t,Qe.ON,r),o.isArea(t)){var a=o.getLocation(t,Qe.LEFT),s=o.getLocation(t,Qe.RIGHT);if(s!==P.NONE){if(s!==r)throw new Xe("side location conflict",i.getCoordinate());a===P.NONE&&h.shouldNeverReachHere("found single null side (at "+i.getCoordinate()+")"),r=a}else h.isTrue(o.getLocation(t,Qe.LEFT)===P.NONE,"found single null side"),o.setLocation(t,Qe.RIGHT,r),o.setLocation(t,Qe.LEFT,r)}}},getCoordinate:function(){var t=this.iterator();return t.hasNext()?t.next().getCoordinate():null},print:function(t){k.out.println("EdgeEndStar:   "+this.getCoordinate());for(var e=this.iterator();e.hasNext();)e.next().print(t)},isAreaLabelsConsistent:function(t){return this.computeEdgeEndLabels(t.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)},checkAreaLabelsConsistent:function(t){var e=this.getEdges();if(e.size()<=0)return!0;var n=e.size()-1,r=e.get(n).getLabel().getLocation(t,Qe.LEFT);h.isTrue(r!==P.NONE,"Found unlabelled area edge");for(var i=r,o=this.iterator();o.hasNext();){var a=o.next().getLabel();h.isTrue(a.isArea(t),"Found non-area edge");var s=a.getLocation(t,Qe.LEFT),u=a.getLocation(t,Qe.RIGHT);if(s===u)return!1;if(u!==i)return!1;i=s}return!0},findIndex:function(t){this.iterator();for(var e=0;e<this.edgeList.size();e++)if(this.edgeList.get(e)===t)return e;return-1},iterator:function(){return this.getEdges().iterator()},getEdges:function(){return null===this.edgeList&&(this.edgeList=new x(this.edgeMap.values())),this.edgeList},getLocation:function(t,e,n){return this.ptInAreaLocation[t]===P.NONE&&(this.ptInAreaLocation[t]=vn.locate(e,n[t].getGeometry())),this.ptInAreaLocation[t]},toString:function(){var t=new I;t.append("EdgeEndStar:   "+this.getCoordinate()),t.append("\n");for(var e=this.iterator();e.hasNext();){var n=e.next();t.append(n),t.append("\n")}return t.toString()},computeEdgeEndLabels:function(t){for(var e=this.iterator();e.hasNext();)e.next().computeLabel(t)},computeLabelling:function(t){this.computeEdgeEndLabels(t[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var e=[!1,!1],n=this.iterator();n.hasNext();)for(var r=(o=n.next()).getLabel(),i=0;i<2;i++)r.isLine(i)&&r.getLocation(i)===P.BOUNDARY&&(e[i]=!0);for(n=this.iterator();n.hasNext();){var o;for(r=(o=n.next()).getLabel(),i=0;i<2;i++)if(r.isAnyNull(i)){var a=P.NONE;if(e[i])a=P.EXTERIOR;else{var s=o.getCoordinate();a=this.getLocation(i,s,t)}r.setAllLocationsIfNull(i,a)}}},getDegree:function(){return this.edgeMap.size()},insertEdgeEnd:function(t,e){this.edgeMap.put(t,e),this.edgeList=null},interfaces_:function(){return[]},getClass:function(){return yn}}),l(mn,yn),e(mn.prototype,{linkResultDirectedEdges:function(){this.getResultAreaEdges();for(var t=null,e=null,n=this.SCANNING_FOR_INCOMING,r=0;r<this.resultAreaEdgeList.size();r++){var i=this.resultAreaEdgeList.get(r),o=i.getSym();if(i.getLabel().isArea())switch(null===t&&i.isInResult()&&(t=i),n){case this.SCANNING_FOR_INCOMING:if(!o.isInResult())continue;e=o,n=this.LINKING_TO_OUTGOING;break;case this.LINKING_TO_OUTGOING:if(!i.isInResult())continue;e.setNext(i),n=this.SCANNING_FOR_INCOMING}}if(n===this.LINKING_TO_OUTGOING){if(null===t)throw new Xe("no outgoing dirEdge found",this.getCoordinate());h.isTrue(t.isInResult(),"unable to link last incoming dirEdge"),e.setNext(t)}},insert:function(t){var e=t;this.insertEdgeEnd(e,e)},getRightmostEdge:function(){var t=this.getEdges(),e=t.size();if(e<1)return null;var n=t.get(0);if(1===e)return n;var r=t.get(e-1),i=n.getQuadrant(),o=r.getQuadrant();return ze.isNorthern(i)&&ze.isNorthern(o)?n:ze.isNorthern(i)||ze.isNorthern(o)?0!==n.getDy()?n:0!==r.getDy()?r:(h.shouldNeverReachHere("found two horizontal edges incident on node"),null):r},print:function(t){k.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var e=this.iterator();e.hasNext();){var n=e.next();t.print("out "),n.print(t),t.println(),t.print("in "),n.getSym().print(t),t.println()}},getResultAreaEdges:function(){if(null!==this.resultAreaEdgeList)return this.resultAreaEdgeList;this.resultAreaEdgeList=new x;for(var t=this.iterator();t.hasNext();){var e=t.next();(e.isInResult()||e.getSym().isInResult())&&this.resultAreaEdgeList.add(e)}return this.resultAreaEdgeList},updateLabelling:function(t){for(var e=this.iterator();e.hasNext();){var n=e.next().getLabel();n.setAllLocationsIfNull(0,t.getLocation(0)),n.setAllLocationsIfNull(1,t.getLocation(1))}},linkAllDirectedEdges:function(){this.getEdges();for(var t=null,e=null,n=this.edgeList.size()-1;n>=0;n--){var r=this.edgeList.get(n),i=r.getSym();null===e&&(e=i),null!==t&&i.setNext(t),t=r}e.setNext(t)},computeDepths:function(){if(1===arguments.length){var t=arguments[0],e=this.findIndex(t),n=(t.getLabel(),t.getDepth(Qe.LEFT)),r=t.getDepth(Qe.RIGHT),i=this.computeDepths(e+1,this.edgeList.size(),n),o=this.computeDepths(0,e,i);if(o!==r)throw new Xe("depth mismatch at "+t.getCoordinate())}else if(3===arguments.length){for(var a=arguments[0],s=arguments[1],u=arguments[2],c=u,l=a;l<s;l++){var f=this.edgeList.get(l);f.getLabel(),f.setEdgeDepths(Qe.RIGHT,c),c=f.getDepth(Qe.LEFT)}return c}},mergeSymLabels:function(){for(var t=this.iterator();t.hasNext();){var e=t.next();e.getLabel().merge(e.getSym().getLabel())}},linkMinimalDirectedEdges:function(t){for(var e=null,n=null,r=this.SCANNING_FOR_INCOMING,i=this.resultAreaEdgeList.size()-1;i>=0;i--){var o=this.resultAreaEdgeList.get(i),a=o.getSym();switch(null===e&&o.getEdgeRing()===t&&(e=o),r){case this.SCANNING_FOR_INCOMING:if(a.getEdgeRing()!==t)continue;n=a,r=this.LINKING_TO_OUTGOING;break;case this.LINKING_TO_OUTGOING:if(o.getEdgeRing()!==t)continue;n.setNextMin(o),r=this.SCANNING_FOR_INCOMING}}r===this.LINKING_TO_OUTGOING&&(h.isTrue(null!==e,"found null for first outgoing dirEdge"),h.isTrue(e.getEdgeRing()===t,"unable to link last incoming dirEdge"),n.setNextMin(e))},getOutgoingDegree:function(){if(0===arguments.length){for(var t=0,e=this.iterator();e.hasNext();)e.next().isInResult()&&t++;return t}if(1===arguments.length){var n=arguments[0];for(t=0,e=this.iterator();e.hasNext();)e.next().getEdgeRing()===n&&t++;return t}},getLabel:function(){return this.label},findCoveredLineEdges:function(){for(var t=P.NONE,e=this.iterator();e.hasNext();){var n=(i=e.next()).getSym();if(!i.isLineEdge()){if(i.isInResult()){t=P.INTERIOR;break}if(n.isInResult()){t=P.EXTERIOR;break}}}if(t===P.NONE)return null;var r=t;for(e=this.iterator();e.hasNext();){var i;n=(i=e.next()).getSym(),i.isLineEdge()?i.getEdge().setCovered(r===P.INTERIOR):(i.isInResult()&&(r=P.EXTERIOR),n.isInResult()&&(r=P.INTERIOR))}},computeLabelling:function(t){yn.prototype.computeLabelling.call(this,t),this.label=new tn(P.NONE);for(var e=this.iterator();e.hasNext();)for(var n=e.next().getEdge().getLabel(),r=0;r<2;r++){var i=n.getLocation(r);i!==P.INTERIOR&&i!==P.BOUNDARY||this.label.setLocation(r,P.INTERIOR)}},interfaces_:function(){return[]},getClass:function(){return mn}}),l(bn,ln),e(bn.prototype,{createNode:function(t){return new an(t,new mn)},interfaces_:function(){return[]},getClass:function(){return bn}}),e(_n.prototype,{computeIntersections:function(t,e){this.mce.computeIntersectsForChain(this.chainIndex,t.mce,t.chainIndex,e)},interfaces_:function(){return[]},getClass:function(){return _n}}),e(xn.prototype,{isDelete:function(){return this.eventType===xn.DELETE},setDeleteEventIndex:function(t){this.deleteEventIndex=t},getObject:function(){return this.obj},compareTo:function(t){var e=t;return this.xValue<e.xValue?-1:this.xValue>e.xValue?1:this.eventType<e.eventType?-1:this.eventType>e.eventType?1:0},getInsertEvent:function(){return this.insertEvent},isInsert:function(){return this.eventType===xn.INSERT},isSameLabel:function(t){return null!==this.label&&this.label===t.label},getDeleteEventIndex:function(){return this.deleteEventIndex},interfaces_:function(){return[o]},getClass:function(){return xn}}),xn.INSERT=1,xn.DELETE=2,e(wn.prototype,{interfaces_:function(){return[]},getClass:function(){return wn}}),e(En.prototype,{isTrivialIntersection:function(t,e,n,r){if(t===n&&1===this.li.getIntersectionNum()){if(En.isAdjacentSegments(e,r))return!0;if(t.isClosed()){var i=t.getNumPoints()-1;if(0===e&&r===i||0===r&&e===i)return!0}}return!1},getProperIntersectionPoint:function(){return this.properIntersectionPoint},setIsDoneIfProperInt:function(t){this.isDoneWhenProperInt=t},hasProperInteriorIntersection:function(){return this.hasProperInterior},isBoundaryPointInternal:function(t,e){for(var n=e.iterator();n.hasNext();){var r=n.next().getCoordinate();if(t.isIntersection(r))return!0}return!1},hasProperIntersection:function(){return this.hasProper},hasIntersection:function(){return this._hasIntersection},isDone:function(){return this._isDone},isBoundaryPoint:function(t,e){return!(null===e||!this.isBoundaryPointInternal(t,e[0])&&!this.isBoundaryPointInternal(t,e[1]))},setBoundaryNodes:function(t,e){this.bdyNodes=new Array(2).fill(null),this.bdyNodes[0]=t,this.bdyNodes[1]=e},addIntersections:function(t,e,n,r){if(t===n&&e===r)return null;this.numTests++;var i=t.getCoordinates()[e],o=t.getCoordinates()[e+1],a=n.getCoordinates()[r],s=n.getCoordinates()[r+1];this.li.computeIntersection(i,o,a,s),this.li.hasIntersection()&&(this.recordIsolated&&(t.setIsolated(!1),n.setIsolated(!1)),this.numIntersections++,this.isTrivialIntersection(t,e,n,r)||(this._hasIntersection=!0,!this.includeProper&&this.li.isProper()||(t.addIntersections(this.li,e,0),n.addIntersections(this.li,r,1)),this.li.isProper()&&(this.properIntersectionPoint=this.li.getIntersection(0).copy(),this.hasProper=!0,this.isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this.li,this.bdyNodes)||(this.hasProperInterior=!0))))},interfaces_:function(){return[]},getClass:function(){return En}}),En.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)},l(Sn,wn),e(Sn.prototype,{prepareEvents:function(){Jo.sort(this.events);for(var t=0;t<this.events.size();t++){var e=this.events.get(t);e.isDelete()&&e.getInsertEvent().setDeleteEventIndex(t)}},computeIntersections:function(){if(1===arguments.length){var t=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var e=0;e<this.events.size();e++){var n=this.events.get(e);if(n.isInsert()&&this.processOverlaps(e,n.getDeleteEventIndex(),n,t),t.isDone())break}}else if(3===arguments.length)if(arguments[2]instanceof En&&C(arguments[0],m)&&C(arguments[1],m)){var r=arguments[0],i=arguments[1],o=arguments[2];this.addEdges(r,r),this.addEdges(i,i),this.computeIntersections(o)}else if("boolean"==typeof arguments[2]&&C(arguments[0],m)&&arguments[1]instanceof En){var a=arguments[0],s=arguments[1],u=arguments[2];u?this.addEdges(a,null):this.addEdges(a),this.computeIntersections(s)}},addEdge:function(t,e){for(var n=t.getMonotoneChainEdge(),r=n.getStartIndexes(),i=0;i<r.length-1;i++){var o=new _n(n,i),a=new xn(e,n.getMinX(i),o);this.events.add(a),this.events.add(new xn(n.getMaxX(i),a))}},processOverlaps:function(t,e,n,r){for(var i=n.getObject(),o=t;o<e;o++){var a=this.events.get(o);if(a.isInsert()){var s=a.getObject();n.isSameLabel(a)||(i.computeIntersections(s,r),this.nOverlaps++)}}},addEdges:function(){if(1===arguments.length)for(var t=arguments[0],e=t.iterator();e.hasNext();){var n=e.next();this.addEdge(n,n)}else if(2===arguments.length){var r=arguments[0],i=arguments[1];for(e=r.iterator();e.hasNext();)n=e.next(),this.addEdge(n,i)}},interfaces_:function(){return[]},getClass:function(){return Sn}}),e(On.prototype,{getMin:function(){return this.min},intersects:function(t,e){return!(this.min>e||this.max<t)},getMax:function(){return this.max},toString:function(){return Yt.toLineString(new d(this.min,0),new d(this.max,0))},interfaces_:function(){return[]},getClass:function(){return On}}),e(Pn.prototype,{compare:function(t,e){var n=t,r=e,i=(n.min+n.max)/2,o=(r.min+r.max)/2;return i<o?-1:i>o?1:0},interfaces_:function(){return[s]},getClass:function(){return Pn}}),On.NodeComparator=Pn,l(Cn,On),e(Cn.prototype,{query:function(t,e,n){return this.intersects(t,e)?void n.visitItem(this.item):null},interfaces_:function(){return[]},getClass:function(){return Cn}}),l(Mn,On),e(Mn.prototype,{buildExtent:function(t,e){this.min=Math.min(t.min,e.min),this.max=Math.max(t.max,e.max)},query:function(t,e,n){return this.intersects(t,e)?(null!==this.node1&&this.node1.query(t,e,n),void(null!==this.node2&&this.node2.query(t,e,n))):null},interfaces_:function(){return[]},getClass:function(){return Mn}}),e(In.prototype,{buildTree:function(){Jo.sort(this.leaves,new IntervalRTreeNode.NodeComparator);for(var t=this.leaves,e=null,n=new x;;){if(this.buildLevel(t,n),1===n.size())return n.get(0);e=t,t=n,n=e}},insert:function(t,e,n){if(null!==this.root)throw new IllegalStateException("Index cannot be added to once it has been queried");this.leaves.add(new Cn(t,e,n))},query:function(t,e,n){this.init(),this.root.query(t,e,n)},buildRoot:function(){return null!==this.root?null:void(this.root=this.buildTree())},printNode:function(t){k.out.println(Yt.toLineString(new d(t.min,this.level),new d(t.max,this.level)))},init:function(){return null!==this.root?null:void this.buildRoot()},buildLevel:function(t,e){this.level++,e.clear();for(var n=0;n<t.size();n+=2){var r=t.get(n);if(null===(n+1<t.size()?t.get(n):null))e.add(r);else{var i=new Mn(t.get(n),t.get(n+1));e.add(i)}}},interfaces_:function(){return[]},getClass:function(){return In}}),e(An.prototype,{filter:function(t){if(this.isForcedToLineString&&t instanceof It){var e=t.getFactory().createLineString(t.getCoordinateSequence());return this.lines.add(e),null}t instanceof Et&&this.lines.add(t)},setForceToLineString:function(t){this.isForcedToLineString=t},interfaces_:function(){return[D]},getClass:function(){return An}}),An.getGeometry=function(){if(1===arguments.length){var t=arguments[0];return t.getFactory().buildGeometry(An.getLines(t))}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e.getFactory().buildGeometry(An.getLines(e,n))}},An.getLines=function(){if(1===arguments.length){var t=arguments[0];return An.getLines(t,!1)}if(2===arguments.length){if(C(arguments[0],v)&&C(arguments[1],v)){for(var e=arguments[0],n=arguments[1],r=e.iterator();r.hasNext();){var i=r.next();An.getLines(i,n)}return n}if(arguments[0]instanceof B&&"boolean"==typeof arguments[1]){var o=arguments[0],a=arguments[1],s=new x;return o.apply(new An(s,a)),s}if(arguments[0]instanceof B&&C(arguments[1],v)){var u=arguments[0],c=arguments[1];return u instanceof Et?c.add(u):u.apply(new An(c)),c}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&C(arguments[0],v)&&C(arguments[1],v)){var l=arguments[0],f=arguments[1],h=arguments[2];for(r=l.iterator();r.hasNext();)i=r.next(),An.getLines(i,f,h);return f}if("boolean"==typeof arguments[2]&&arguments[0]instanceof B&&C(arguments[1],v)){var d=arguments[0],p=arguments[1],g=arguments[2];return d.apply(new An(p,g)),p}}},e(Tn.prototype,{visitItem:function(t){this.items.add(t)},getItems:function(){return this.items},interfaces_:function(){return[Se]},getClass:function(){return Tn}}),e(Nn.prototype,{locate:function(t){var e=new Qt(t),n=new Ln(e);return this.index.query(t.y,t.y,n),e.getLocation()},interfaces_:function(){return[gn]},getClass:function(){return Nn}}),e(Ln.prototype,{visitItem:function(t){var e=t;this.counter.countSegment(e.getCoordinate(0),e.getCoordinate(1))},interfaces_:function(){return[Se]},getClass:function(){return Ln}}),e(Rn.prototype,{init:function(t){for(var e=An.getLines(t).iterator();e.hasNext();){var n=e.next().getCoordinates();this.addLine(n)}},addLine:function(t){for(var e=1;e<t.length;e++){var n=new te(t[e-1],t[e]),r=Math.min(n.p0.y,n.p1.y),i=Math.max(n.p0.y,n.p1.y);this.index.insert(r,i,n)}},query:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=new Tn;return this.index.query(t,e,n),n.getItems()}if(3===arguments.length){var r=arguments[0],i=arguments[1],o=arguments[2];this.index.query(r,i,o)}},interfaces_:function(){return[]},getClass:function(){return Rn}}),Nn.SegmentVisitor=Ln,Nn.IntervalIndexedGeometry=Rn,e(kn.prototype,{getSegmentIndex:function(){return this.segmentIndex},getCoordinate:function(){return this.coord},print:function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex),t.println(" dist = "+this.dist)},compareTo:function(t){var e=t;return this.compare(e.segmentIndex,e.dist)},isEndPoint:function(t){return 0===this.segmentIndex&&0===this.dist||this.segmentIndex===t},toString:function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist},getDistance:function(){return this.dist},compare:function(t,e){return this.segmentIndex<t?-1:this.segmentIndex>t?1:this.dist<e?-1:this.dist>e?1:0},interfaces_:function(){return[o]},getClass:function(){return kn}}),e(jn.prototype,{print:function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(t)},iterator:function(){return this.nodeMap.values().iterator()},addSplitEdges:function(t){this.addEndpoints();for(var e=this.iterator(),n=e.next();e.hasNext();){var r=e.next(),i=this.createSplitEdge(n,r);t.add(i),n=r}},addEndpoints:function(){var t=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[t],t,0)},createSplitEdge:function(t,e){var n=e.segmentIndex-t.segmentIndex+2,r=this.edge.pts[e.segmentIndex],i=e.dist>0||!e.coord.equals2D(r);i||n--;var o=new Array(n).fill(null),a=0;o[a++]=new d(t.coord);for(var s=t.segmentIndex+1;s<=e.segmentIndex;s++)o[a++]=this.edge.pts[s];return i&&(o[a]=e.coord),new zn(o,new tn(this.edge.label))},add:function(t,e,n){var r=new kn(t,e,n),i=this.nodeMap.get(r);return null!==i?i:(this.nodeMap.put(r,r),r)},isIntersection:function(t){for(var e=this.iterator();e.hasNext();)if(e.next().coord.equals(t))return!0;return!1},interfaces_:function(){return[]},getClass:function(){return jn}}),e(Fn.prototype,{getChainStartIndices:function(t){var e=0,n=new x;n.add(new A(e));do{var r=this.findChainEnd(t,e);n.add(new A(r)),e=r}while(e<t.length-1);return Fn.toIntArray(n)},findChainEnd:function(t,e){for(var n=ze.quadrant(t[e],t[e+1]),r=e+1;r<t.length&&ze.quadrant(t[r-1],t[r])===n;)r++;return r-1},interfaces_:function(){return[]},getClass:function(){return Fn}}),Fn.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e},e(Dn.prototype,{getCoordinates:function(){return this.pts},getMaxX:function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return e>n?e:n},getMinX:function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return e<n?e:n},computeIntersectsForChain:function(){if(4===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2],r=arguments[3];this.computeIntersectsForChain(this.startIndex[t],this.startIndex[t+1],e,e.startIndex[n],e.startIndex[n+1],r)}else if(6===arguments.length){var i=arguments[0],o=arguments[1],a=arguments[2],s=arguments[3],u=arguments[4],c=arguments[5],l=this.pts[i],f=this.pts[o],h=a.pts[s],d=a.pts[u];if(o-i==1&&u-s==1)return c.addIntersections(this.e,i,a.e,s),null;if(this.env1.init(l,f),this.env2.init(h,d),!this.env1.intersects(this.env2))return null;var p=Math.trunc((i+o)/2),g=Math.trunc((s+u)/2);i<p&&(s<g&&this.computeIntersectsForChain(i,p,a,s,g,c),g<u&&this.computeIntersectsForChain(i,p,a,g,u,c)),p<o&&(s<g&&this.computeIntersectsForChain(p,o,a,s,g,c),g<u&&this.computeIntersectsForChain(p,o,a,g,u,c))}},getStartIndexes:function(){return this.startIndex},computeIntersects:function(t,e){for(var n=0;n<this.startIndex.length-1;n++)for(var r=0;r<t.startIndex.length-1;r++)this.computeIntersectsForChain(n,t,r,e)},interfaces_:function(){return[]},getClass:function(){return Dn}}),e(Bn.prototype,{getDepth:function(t,e){return this.depth[t][e]},setDepth:function(t,e,n){this.depth[t][e]=n},isNull:function(){if(0===arguments.length){for(var t=0;t<2;t++)for(var e=0;e<3;e++)if(this.depth[t][e]!==Bn.NULL_VALUE)return!1;return!0}if(1===arguments.length){var n=arguments[0];return this.depth[n][1]===Bn.NULL_VALUE}if(2===arguments.length){var r=arguments[0],i=arguments[1];return this.depth[r][i]===Bn.NULL_VALUE}},normalize:function(){for(var t=0;t<2;t++)if(!this.isNull(t)){var e=this.depth[t][1];this.depth[t][2]<e&&(e=this.depth[t][2]),e<0&&(e=0);for(var n=1;n<3;n++){var r=0;this.depth[t][n]>e&&(r=1),this.depth[t][n]=r}}},getDelta:function(t){return this.depth[t][Qe.RIGHT]-this.depth[t][Qe.LEFT]},getLocation:function(t,e){return this.depth[t][e]<=0?P.EXTERIOR:P.INTERIOR},toString:function(){return"A: "+this.depth[0][1]+","+this.depth[0][2]+" B: "+this.depth[1][1]+","+this.depth[1][2]},add:function(){if(1===arguments.length)for(var t=arguments[0],e=0;e<2;e++)for(var n=1;n<3;n++){var r=t.getLocation(e,n);r!==P.EXTERIOR&&r!==P.INTERIOR||(this.isNull(e,n)?this.depth[e][n]=Bn.depthAtLocation(r):this.depth[e][n]+=Bn.depthAtLocation(r))}else if(3===arguments.length){var i=arguments[0],o=arguments[1],a=arguments[2];a===P.INTERIOR&&this.depth[i][o]++}},interfaces_:function(){return[]},getClass:function(){return Bn}}),Bn.depthAtLocation=function(t){return t===P.EXTERIOR?0:t===P.INTERIOR?1:Bn.NULL_VALUE},Bn.NULL_VALUE=-1,l(zn,on),e(zn.prototype,{getDepth:function(){return this.depth},getCollapsedEdge:function(){var t=new Array(2).fill(null);return t[0]=this.pts[0],t[1]=this.pts[1],new zn(t,tn.toLineLabel(this.label))},isIsolated:function(){return this._isIsolated},getCoordinates:function(){return this.pts},setIsolated:function(t){this._isIsolated=t},setName:function(t){this.name=t},equals:function(t){if(!(t instanceof zn))return!1;var e=t;if(this.pts.length!==e.pts.length)return!1;for(var n=!0,r=!0,i=this.pts.length,o=0;o<this.pts.length;o++)if(this.pts[o].equals2D(e.pts[o])||(n=!1),this.pts[o].equals2D(e.pts[--i])||(r=!1),!n&&!r)return!1;return!0},getCoordinate:function(){if(0===arguments.length)return this.pts.length>0?this.pts[0]:null;if(1===arguments.length){var t=arguments[0];return this.pts[t]}},print:function(t){t.print("edge "+this.name+": "),t.print("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.print(","),t.print(this.pts[e].x+" "+this.pts[e].y);t.print(")  "+this.label+" "+this.depthDelta)},computeIM:function(t){zn.updateIM(this.label,t)},isCollapsed:function(){return!!this.label.isArea()&&3===this.pts.length&&!!this.pts[0].equals(this.pts[2])},isClosed:function(){return this.pts[0].equals(this.pts[this.pts.length-1])},getMaximumSegmentIndex:function(){return this.pts.length-1},getDepthDelta:function(){return this.depthDelta},getNumPoints:function(){return this.pts.length},printReverse:function(t){t.print("edge "+this.name+": ");for(var e=this.pts.length-1;e>=0;e--)t.print(this.pts[e]+" ");t.println("")},getMonotoneChainEdge:function(){return null===this.mce&&(this.mce=new Dn(this)),this.mce},getEnvelope:function(){if(null===this.env){this.env=new E;for(var t=0;t<this.pts.length;t++)this.env.expandToInclude(this.pts[t])}return this.env},addIntersection:function(t,e,n,r){var i=new d(t.getIntersection(r)),o=e,a=t.getEdgeDistance(n,r),s=o+1;if(s<this.pts.length){var u=this.pts[s];i.equals2D(u)&&(o=s,a=0)}this.eiList.add(i,o,a)},toString:function(){var t=new I;t.append("edge "+this.name+": "),t.append("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.append(","),t.append(this.pts[e].x+" "+this.pts[e].y);return t.append(")  "+this.label+" "+this.depthDelta),t.toString()},isPointwiseEqual:function(t){if(this.pts.length!==t.pts.length)return!1;for(var e=0;e<this.pts.length;e++)if(!this.pts[e].equals2D(t.pts[e]))return!1;return!0},setDepthDelta:function(t){this.depthDelta=t},getEdgeIntersectionList:function(){return this.eiList},addIntersections:function(t,e,n){for(var r=0;r<t.getIntersectionNum();r++)this.addIntersection(t,e,n,r)},interfaces_:function(){return[]},getClass:function(){return zn}}),zn.updateIM=function(){if(2!==arguments.length)return on.prototype.updateIM.apply(this,arguments);var t=arguments[0],e=arguments[1];e.setAtLeastIfValid(t.getLocation(0,Qe.ON),t.getLocation(1,Qe.ON),1),t.isArea()&&(e.setAtLeastIfValid(t.getLocation(0,Qe.LEFT),t.getLocation(1,Qe.LEFT),2),e.setAtLeastIfValid(t.getLocation(0,Qe.RIGHT),t.getLocation(1,Qe.RIGHT),2))},l(Vn,fn),e(Vn.prototype,{insertBoundaryPoint:function(t,e){var n=this.nodes.addNode(e).getLabel(),r=1;P.NONE,n.getLocation(t,Qe.ON)===P.BOUNDARY&&r++;var i=Vn.determineBoundary(this.boundaryNodeRule,r);n.setLocation(t,i)},computeSelfNodes:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this.computeSelfNodes(t,e,!1)}if(3===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2],o=new En(n,!0,!1);o.setIsDoneIfProperInt(i);var a=this.createEdgeSetIntersector(),s=this.parentGeom instanceof It||this.parentGeom instanceof Ct||this.parentGeom instanceof At,u=r||!s;return a.computeIntersections(this.edges,o,u),this.addSelfIntersectionNodes(this.argIndex),o}},computeSplitEdges:function(t){for(var e=this.edges.iterator();e.hasNext();)e.next().eiList.addSplitEdges(t)},computeEdgeIntersections:function(t,e,n){var r=new En(e,n,!0);return r.setBoundaryNodes(this.getBoundaryNodes(),t.getBoundaryNodes()),this.createEdgeSetIntersector().computeIntersections(this.edges,t.edges,r),r},getGeometry:function(){return this.parentGeom},getBoundaryNodeRule:function(){return this.boundaryNodeRule},hasTooFewPoints:function(){return this._hasTooFewPoints},addPoint:function(){if(arguments[0]instanceof Ot){var t=arguments[0],e=t.getCoordinate();this.insertPoint(this.argIndex,e,P.INTERIOR)}else if(arguments[0]instanceof d){var n=arguments[0];this.insertPoint(this.argIndex,n,P.INTERIOR)}},addPolygon:function(t){this.addPolygonRing(t.getExteriorRing(),P.EXTERIOR,P.INTERIOR);for(var e=0;e<t.getNumInteriorRing();e++){var n=t.getInteriorRingN(e);this.addPolygonRing(n,P.INTERIOR,P.EXTERIOR)}},addEdge:function(t){this.insertEdge(t);var e=t.getCoordinates();this.insertPoint(this.argIndex,e[0],P.BOUNDARY),this.insertPoint(this.argIndex,e[e.length-1],P.BOUNDARY)},addLineString:function(t){var e=X.removeRepeatedPoints(t.getCoordinates());if(e.length<2)return this._hasTooFewPoints=!0,this.invalidPoint=e[0],null;var n=new zn(e,new tn(this.argIndex,P.INTERIOR));this.lineEdgeMap.put(t,n),this.insertEdge(n),h.isTrue(e.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this.argIndex,e[0]),this.insertBoundaryPoint(this.argIndex,e[e.length-1])},getInvalidPoint:function(){return this.invalidPoint},getBoundaryPoints:function(){for(var t=this.getBoundaryNodes(),e=new Array(t.size()).fill(null),n=0,r=t.iterator();r.hasNext();){var i=r.next();e[n++]=i.getCoordinate().copy()}return e},getBoundaryNodes:function(){return null===this.boundaryNodes&&(this.boundaryNodes=this.nodes.getBoundaryNodes(this.argIndex)),this.boundaryNodes},addSelfIntersectionNode:function(t,e,n){return this.isBoundaryNode(t,e)?null:void(n===P.BOUNDARY&&this.useBoundaryDeterminationRule?this.insertBoundaryPoint(t,e):this.insertPoint(t,e,n))},addPolygonRing:function(t,e,n){if(t.isEmpty())return null;var r=X.removeRepeatedPoints(t.getCoordinates());if(r.length<4)return this._hasTooFewPoints=!0,this.invalidPoint=r[0],null;var i=e,o=n;$t.isCCW(r)&&(i=n,o=e);var a=new zn(r,new tn(this.argIndex,P.BOUNDARY,i,o));this.lineEdgeMap.put(t,a),this.insertEdge(a),this.insertPoint(this.argIndex,r[0],P.BOUNDARY)},insertPoint:function(t,e,n){var r=this.nodes.addNode(e),i=r.getLabel();null===i?r.label=new tn(t,n):i.setLocation(t,n)},createEdgeSetIntersector:function(){return new Sn},addSelfIntersectionNodes:function(t){for(var e=this.edges.iterator();e.hasNext();)for(var n=e.next(),r=n.getLabel().getLocation(t),i=n.eiList.iterator();i.hasNext();){var o=i.next();this.addSelfIntersectionNode(t,o.coord,r)}},add:function(){if(1!==arguments.length)return fn.prototype.add.apply(this,arguments);var t=arguments[0];if(t.isEmpty())return null;if(t instanceof At&&(this.useBoundaryDeterminationRule=!1),t instanceof Ct)this.addPolygon(t);else if(t instanceof Et)this.addLineString(t);else if(t instanceof Ot)this.addPoint(t);else if(t instanceof Mt)this.addCollection(t);else if(t instanceof dt)this.addCollection(t);else if(t instanceof At)this.addCollection(t);else{if(!(t instanceof ht))throw new UnsupportedOperationException(t.getClass().getName());this.addCollection(t)}},addCollection:function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);this.add(n)}},locate:function(t){return C(this.parentGeom,Pt)&&this.parentGeom.getNumGeometries()>50?(null===this.areaPtLocator&&(this.areaPtLocator=new Nn(this.parentGeom)),this.areaPtLocator.locate(t)):this.ptLocator.locate(t,this.parentGeom)},findEdge:function(){if(1===arguments.length){var t=arguments[0];return this.lineEdgeMap.get(t)}return fn.prototype.findEdge.apply(this,arguments)},interfaces_:function(){return[]},getClass:function(){return Vn}}),Vn.determineBoundary=function(t,e){return t.isInBoundary(e)?P.BOUNDARY:P.INTERIOR},e(Gn.prototype,{getArgGeometry:function(t){return this.arg[t].getGeometry()},setComputationPrecision:function(t){this.resultPrecisionModel=t,this.li.setPrecisionModel(this.resultPrecisionModel)},interfaces_:function(){return[]},getClass:function(){return Gn}}),e(Un.prototype,{compareTo:function(t){var e=t;return Un.compareOriented(this.pts,this._orientation,e.pts,e._orientation)},interfaces_:function(){return[o]},getClass:function(){return Un}}),Un.orientation=function(t){return 1===X.increasingDirection(t)},Un.compareOriented=function(t,e,n,r){for(var i=e?1:-1,o=r?1:-1,a=e?t.length:-1,s=r?n.length:-1,u=e?0:t.length-1,c=r?0:n.length-1;;){var l=t[u].compareTo(n[c]);if(0!==l)return l;var f=(u+=i)===a,h=(c+=o)===s;if(f&&!h)return-1;if(!f&&h)return 1;if(f&&h)return 0}},e(Wn.prototype,{print:function(t){t.print("MULTILINESTRING ( ");for(var e=0;e<this.edges.size();e++){var n=this.edges.get(e);e>0&&t.print(","),t.print("(");for(var r=n.getCoordinates(),i=0;i<r.length;i++)i>0&&t.print(","),t.print(r[i].x+" "+r[i].y);t.println(")")}t.print(")  ")},addAll:function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next())},findEdgeIndex:function(t){for(var e=0;e<this.edges.size();e++)if(this.edges.get(e).equals(t))return e;return-1},iterator:function(){return this.edges.iterator()},getEdges:function(){return this.edges},get:function(t){return this.edges.get(t)},findEqualEdge:function(t){var e=new Un(t.getCoordinates());return this.ocaMap.get(e)},add:function(t){this.edges.add(t);var e=new Un(t.getCoordinates());this.ocaMap.put(e,t)},interfaces_:function(){return[]},getClass:function(){return Wn}}),l(qn,Gn),e(qn.prototype,{insertUniqueEdge:function(t){var e=this.edgeList.findEqualEdge(t);if(null!==e){var n=e.getLabel(),r=t.getLabel();e.isPointwiseEqual(t)||(r=new tn(t.getLabel())).flip();var i=e.getDepth();i.isNull()&&i.add(n),i.add(r),n.merge(r)}else this.edgeList.add(t)},getGraph:function(){return this.graph},cancelDuplicateResultEdges:function(){for(var t=this.graph.getEdgeEnds().iterator();t.hasNext();){var e=t.next(),n=e.getSym();e.isInResult()&&n.isInResult()&&(e.setInResult(!1),n.setInResult(!1))}},isCoveredByLA:function(t){return!!this.isCovered(t,this.resultLineList)||!!this.isCovered(t,this.resultPolyList)},computeGeometry:function(t,e,n,r){var i=new x;return i.addAll(t),i.addAll(e),i.addAll(n),i.isEmpty()?qn.createEmptyResult(r,this.arg[0].getGeometry(),this.arg[1].getGeometry(),this.geomFact):this.geomFact.buildGeometry(i)},mergeSymLabels:function(){for(var t=this.graph.getNodes().iterator();t.hasNext();)t.next().getEdges().mergeSymLabels()},isCovered:function(t,e){for(var n=e.iterator();n.hasNext();){var r=n.next();if(this.ptLocator.locate(t,r)!==P.EXTERIOR)return!0}return!1},replaceCollapsedEdges:function(){for(var t=new x,e=this.edgeList.iterator();e.hasNext();){var n=e.next();n.isCollapsed()&&(e.remove(),t.add(n.getCollapsedEdge()))}this.edgeList.addAll(t)},updateNodeLabelling:function(){for(var t=this.graph.getNodes().iterator();t.hasNext();){var e=t.next(),n=e.getEdges().getLabel();e.getLabel().merge(n)}},getResultGeometry:function(t){return this.computeOverlay(t),this.resultGeom},insertUniqueEdges:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.insertUniqueEdge(n)}},computeOverlay:function(t){this.copyPoints(0),this.copyPoints(1),this.arg[0].computeSelfNodes(this.li,!1),this.arg[1].computeSelfNodes(this.li,!1),this.arg[0].computeEdgeIntersections(this.arg[1],this.li,!0);var e=new x;this.arg[0].computeSplitEdges(e),this.arg[1].computeSplitEdges(e),this.insertUniqueEdges(e),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),Ke.checkValid(this.edgeList.getEdges()),this.graph.addEdges(this.edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(t),this.cancelDuplicateResultEdges();var n=new hn(this.geomFact);n.add(this.graph),this.resultPolyList=n.getPolygons();var r=new dn(this,this.geomFact,this.ptLocator);this.resultLineList=r.build(t);var i=new pn(this,this.geomFact,this.ptLocator);this.resultPointList=i.build(t),this.resultGeom=this.computeGeometry(this.resultPointList,this.resultLineList,this.resultPolyList,t)},labelIncompleteNode:function(t,e){var n=this.ptLocator.locate(t.getCoordinate(),this.arg[e].getGeometry());t.getLabel().setLocation(e,n)},copyPoints:function(t){for(var e=this.arg[t].getNodeIterator();e.hasNext();){var n=e.next();this.graph.addNode(n.getCoordinate()).setLabel(t,n.getLabel().getLocation(t))}},findResultAreaEdges:function(t){for(var e=this.graph.getEdgeEnds().iterator();e.hasNext();){var n=e.next(),r=n.getLabel();r.isArea()&&!n.isInteriorAreaEdge()&&qn.isResultOfOp(r.getLocation(0,Qe.RIGHT),r.getLocation(1,Qe.RIGHT),t)&&n.setInResult(!0)}},computeLabelsFromDepths:function(){for(var t=this.edgeList.iterator();t.hasNext();){var e=t.next(),n=e.getLabel(),r=e.getDepth();if(!r.isNull()){r.normalize();for(var i=0;i<2;i++)n.isNull(i)||!n.isArea()||r.isNull(i)||(0===r.getDelta(i)?n.toLine(i):(h.isTrue(!r.isNull(i,Qe.LEFT),"depth of LEFT side has not been initialized"),n.setLocation(i,Qe.LEFT,r.getLocation(i,Qe.LEFT)),h.isTrue(!r.isNull(i,Qe.RIGHT),"depth of RIGHT side has not been initialized"),n.setLocation(i,Qe.RIGHT,r.getLocation(i,Qe.RIGHT))))}}},computeLabelling:function(){for(var t=this.graph.getNodes().iterator();t.hasNext();)t.next().getEdges().computeLabelling(this.arg);this.mergeSymLabels(),this.updateNodeLabelling()},labelIncompleteNodes:function(){for(var t=this.graph.getNodes().iterator();t.hasNext();){var e=t.next(),n=e.getLabel();e.isIsolated()&&(n.isNull(0)?this.labelIncompleteNode(e,0):this.labelIncompleteNode(e,1)),e.getEdges().updateLabelling(n)}},isCoveredByA:function(t){return!!this.isCovered(t,this.resultPolyList)},interfaces_:function(){return[]},getClass:function(){return qn}}),qn.overlayOp=function(t,e,n){return new qn(t,e).getResultGeometry(n)},qn.intersection=function(t,e){if(t.isEmpty()||e.isEmpty())return qn.createEmptyResult(qn.INTERSECTION,t,e,t.getFactory());if(t.isGeometryCollection()){var n=e;return Je.map(t,{interfaces_:function(){return[MapOp]},map:function(t){return t.intersection(n)}})}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),Hn.overlayOp(t,e,qn.INTERSECTION)},qn.symDifference=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return qn.createEmptyResult(qn.SYMDIFFERENCE,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),Hn.overlayOp(t,e,qn.SYMDIFFERENCE)},qn.resultDimension=function(t,e,n){var r=e.getDimension(),i=n.getDimension(),o=-1;switch(t){case qn.INTERSECTION:o=Math.min(r,i);break;case qn.UNION:o=Math.max(r,i);break;case qn.DIFFERENCE:o=r;break;case qn.SYMDIFFERENCE:o=Math.max(r,i)}return o},qn.createEmptyResult=function(t,e,n,r){var i=null;switch(qn.resultDimension(t,e,n)){case-1:i=r.createGeometryCollection(new Array(0).fill(null));break;case 0:i=r.createPoint();break;case 1:i=r.createLineString();break;case 2:i=r.createPolygon()}return i},qn.difference=function(t,e){return t.isEmpty()?qn.createEmptyResult(qn.DIFFERENCE,t,e,t.getFactory()):e.isEmpty()?t.copy():(t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),Hn.overlayOp(t,e,qn.DIFFERENCE))},qn.isResultOfOp=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=t.getLocation(0),r=t.getLocation(1);return qn.isResultOfOp(n,r,e)}if(3===arguments.length){var i=arguments[0],o=arguments[1],a=arguments[2];switch(i===P.BOUNDARY&&(i=P.INTERIOR),o===P.BOUNDARY&&(o=P.INTERIOR),a){case qn.INTERSECTION:return i===P.INTERIOR&&o===P.INTERIOR;case qn.UNION:return i===P.INTERIOR||o===P.INTERIOR;case qn.DIFFERENCE:return i===P.INTERIOR&&o!==P.INTERIOR;case qn.SYMDIFFERENCE:return i===P.INTERIOR&&o!==P.INTERIOR||i!==P.INTERIOR&&o===P.INTERIOR}return!1}},qn.INTERSECTION=1,qn.UNION=2,qn.DIFFERENCE=3,qn.SYMDIFFERENCE=4,e(Xn.prototype,{selfSnap:function(t){return new le(t).snapTo(t,this.snapTolerance)},removeCommonBits:function(t){this.cbr=new de,this.cbr.add(t[0]),this.cbr.add(t[1]);var e=new Array(2).fill(null);return e[0]=this.cbr.removeCommonBits(t[0].copy()),e[1]=this.cbr.removeCommonBits(t[1].copy()),e},prepareResult:function(t){return this.cbr.addCommonBits(t),t},getResultGeometry:function(t){var e=this.snap(this.geom),n=qn.overlayOp(e[0],e[1],t);return this.prepareResult(n)},checkValid:function(t){t.isValid()||k.out.println("Snapped geometry is invalid")},computeSnapTolerance:function(){this.snapTolerance=le.computeOverlaySnapTolerance(this.geom[0],this.geom[1])},snap:function(t){var e=this.removeCommonBits(t);return le.snap(e[0],e[1],this.snapTolerance)},interfaces_:function(){return[]},getClass:function(){return Xn}}),Xn.overlayOp=function(t,e,n){return new Xn(t,e).getResultGeometry(n)},Xn.union=function(t,e){return Xn.overlayOp(t,e,qn.UNION)},Xn.intersection=function(t,e){return Xn.overlayOp(t,e,qn.INTERSECTION)},Xn.symDifference=function(t,e){return Xn.overlayOp(t,e,qn.SYMDIFFERENCE)},Xn.difference=function(t,e){return Xn.overlayOp(t,e,qn.DIFFERENCE)},e(Hn.prototype,{getResultGeometry:function(t){var e=null,n=!1,r=null;try{e=qn.overlayOp(this.geom[0],this.geom[1],t),n=!0}catch(t){if(!(t instanceof c))throw t;r=t}if(!n)try{e=Xn.overlayOp(this.geom[0],this.geom[1],t)}catch(t){throw t instanceof c?r:t}return e},interfaces_:function(){return[]},getClass:function(){return Hn}}),Hn.overlayOp=function(t,e,n){return new Hn(t,e).getResultGeometry(n)},Hn.union=function(t,e){return Hn.overlayOp(t,e,qn.UNION)},Hn.intersection=function(t,e){return Hn.overlayOp(t,e,qn.INTERSECTION)},Hn.symDifference=function(t,e){return Hn.overlayOp(t,e,qn.SYMDIFFERENCE)},Hn.difference=function(t,e){return Hn.overlayOp(t,e,qn.DIFFERENCE)},e(Yn.prototype,{addPolygon:function(t){if(t.isEmpty())return null;var e=null,n=0,r=this.horizontalBisector(t);if(0===r.getLength())n=0,e=r.getCoordinate();else{var i=Hn.overlayOp(r,t,qn.INTERSECTION),o=this.widestGeometry(i);n=o.getEnvelopeInternal().getWidth(),e=Yn.centre(o.getEnvelopeInternal())}(null===this.interiorPoint||n>this.maxWidth)&&(this.interiorPoint=e,this.maxWidth=n)},getInteriorPoint:function(){return this.interiorPoint},widestGeometry:function(){if(arguments[0]instanceof ht){var t=arguments[0];if(t.isEmpty())return t;for(var e=t.getGeometryN(0),n=1;n<t.getNumGeometries();n++)t.getGeometryN(n).getEnvelopeInternal().getWidth()>e.getEnvelopeInternal().getWidth()&&(e=t.getGeometryN(n));return e}if(arguments[0]instanceof B){var r=arguments[0];return r instanceof ht?this.widestGeometry(r):r}},horizontalBisector:function(t){var e=t.getEnvelopeInternal(),n=Zn.getBisectorY(t);return this.factory.createLineString([new d(e.getMinX(),n),new d(e.getMaxX(),n)])},add:function(t){if(t instanceof Ct)this.addPolygon(t);else if(t instanceof ht)for(var e=t,n=0;n<e.getNumGeometries();n++)this.add(e.getGeometryN(n))},interfaces_:function(){return[]},getClass:function(){return Yn}}),Yn.centre=function(t){return new d(Yn.avg(t.getMinX(),t.getMaxX()),Yn.avg(t.getMinY(),t.getMaxY()))},Yn.avg=function(t,e){return(t+e)/2},e(Zn.prototype,{updateInterval:function(t){t<=this.centreY?t>this.loY&&(this.loY=t):t>this.centreY&&t<this.hiY&&(this.hiY=t)},getBisectorY:function(){this.process(this.poly.getExteriorRing());for(var t=0;t<this.poly.getNumInteriorRing();t++)this.process(this.poly.getInteriorRingN(t));return Yn.avg(this.hiY,this.loY)},process:function(t){for(var e=t.getCoordinateSequence(),n=0;n<e.size();n++){var r=e.getY(n);this.updateInterval(r)}},interfaces_:function(){return[]},getClass:function(){return Zn}}),Zn.getBisectorY=function(t){return new Zn(t).getBisectorY()},Yn.SafeBisectorFinder=Zn,e(Kn.prototype,{addEndpoints:function(){if(arguments[0]instanceof B){var t=arguments[0];if(t instanceof Et)this.addEndpoints(t.getCoordinates());else if(t instanceof ht)for(var e=t,n=0;n<e.getNumGeometries();n++)this.addEndpoints(e.getGeometryN(n))}else if(arguments[0]instanceof Array){var r=arguments[0];this.add(r[0]),this.add(r[r.length-1])}},getInteriorPoint:function(){return this.interiorPoint},addInterior:function(){if(arguments[0]instanceof B){var t=arguments[0];if(t instanceof Et)this.addInterior(t.getCoordinates());else if(t instanceof ht)for(var e=t,n=0;n<e.getNumGeometries();n++)this.addInterior(e.getGeometryN(n))}else if(arguments[0]instanceof Array){var r=arguments[0];for(n=1;n<r.length-1;n++)this.add(r[n])}},add:function(t){var e=t.distance(this.centroid);e<this.minDistance&&(this.interiorPoint=new d(t),this.minDistance=e)},interfaces_:function(){return[]},getClass:function(){return Kn}}),e(Jn.prototype,{getInteriorPoint:function(){return this.interiorPoint},add:function(){if(arguments[0]instanceof B){var t=arguments[0];if(t instanceof Ot)this.add(t.getCoordinate());else if(t instanceof ht)for(var e=t,n=0;n<e.getNumGeometries();n++)this.add(e.getGeometryN(n))}else if(arguments[0]instanceof d){var r=arguments[0],i=r.distance(this.centroid);i<this.minDistance&&(this.interiorPoint=new d(r),this.minDistance=i)}},interfaces_:function(){return[]},getClass:function(){return Jn}}),e(Qn.prototype,{select:function(){if(1===arguments.length)arguments[0];else if(2===arguments.length){var t=arguments[0],e=arguments[1];t.getLineSegment(e,this.selectedSegment),this.select(this.selectedSegment)}},interfaces_:function(){return[]},getClass:function(){return Qn}}),e($n.prototype,{hasChildren:function(){for(var t=0;t<2;t++)if(null!==this.subnode[t])return!0;return!1},isPrunable:function(){return!(this.hasChildren()||this.hasItems())},addAllItems:function(t){t.addAll(this.items);for(var e=0;e<2;e++)null!==this.subnode[e]&&this.subnode[e].addAllItems(t);return t},size:function(){for(var t=0,e=0;e<2;e++)null!==this.subnode[e]&&(t+=this.subnode[e].size());return t+this.items.size()},addAllItemsFromOverlapping:function(t,e){return null===t||this.isSearchMatch(t)?(e.addAll(this.items),null!==this.subnode[0]&&this.subnode[0].addAllItemsFromOverlapping(t,e),void(null!==this.subnode[1]&&this.subnode[1].addAllItemsFromOverlapping(t,e))):null},hasItems:function(){return!this.items.isEmpty()},remove:function(t,e){if(!this.isSearchMatch(t))return!1;for(var n=!1,r=0;r<2;r++)if(null!==this.subnode[r]&&(n=this.subnode[r].remove(t,e))){this.subnode[r].isPrunable()&&(this.subnode[r]=null);break}return n||(n=this.items.remove(e))},getItems:function(){return this.items},depth:function(){for(var t=0,e=0;e<2;e++)if(null!==this.subnode[e]){var n=this.subnode[e].depth();n>t&&(t=n)}return t+1},nodeSize:function(){for(var t=0,e=0;e<2;e++)null!==this.subnode[e]&&(t+=this.subnode[e].nodeSize());return t+1},add:function(t){this.items.add(t)},interfaces_:function(){return[]},getClass:function(){return $n}}),$n.getSubnodeIndex=function(t,e){var n=-1;return t.min>=e&&(n=1),t.max<=e&&(n=0),n},e(tr.prototype,{expandToInclude:function(t){t.max>this.max&&(this.max=t.max),t.min<this.min&&(this.min=t.min)},getWidth:function(){return this.max-this.min},overlaps:function(){if(1===arguments.length){var t=arguments[0];return this.overlaps(t.min,t.max)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return!(this.min>n||this.max<e)}},getMin:function(){return this.min},toString:function(){return"["+this.min+", "+this.max+"]"},contains:function(){if(1===arguments.length){if(arguments[0]instanceof tr){var t=arguments[0];return this.contains(t.min,t.max)}if("number"==typeof arguments[0]){var e=arguments[0];return e>=this.min&&e<=this.max}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];return n>=this.min&&r<=this.max}},init:function(t,e){this.min=t,this.max=e,t>e&&(this.min=e,this.max=t)},getMax:function(){return this.max},interfaces_:function(){return[]},getClass:function(){return tr}}),er.exponent=function(t){return function(t,e){var n,r,i,o,a={32:8,64:11}[t];if(o||(n=e<0||1/e<0,isFinite(e)||(o={32:{d:127,c:128,b:0,a:0},64:{d:32752,c:0,b:0,a:0}}[t],n&&(o.d+=1<<t/4-1),r=Math.pow(2,a)-1,i=0)),!o){for(r={32:127,64:1023}[t],i=Math.abs(e);i>=2;)r++,i/=2;for(;i<1&&r>0;)r--,i*=2;r<=0&&(i/=2),32===t&&r>254&&(o={d:n?255:127,c:128,b:0,a:0},r=Math.pow(2,a)-1,i=0)}return r}(64,t)-1023},er.powerOf2=function(t){return Math.pow(2,t)},e(nr.prototype,{getInterval:function(){return this.interval},getLevel:function(){return this.level},computeKey:function(t){for(this.level=nr.computeLevel(t),this.interval=new tr,this.computeInterval(this.level,t);!this.interval.contains(t);)this.level+=1,this.computeInterval(this.level,t)},computeInterval:function(t,e){var n=er.powerOf2(t);this.pt=Math.floor(e.getMin()/n)*n,this.interval.init(this.pt,this.pt+n)},getPoint:function(){return this.pt},interfaces_:function(){return[]},getClass:function(){return nr}}),nr.computeLevel=function(t){var e=t.getWidth();return er.exponent(e)+1},l(rr,$n),e(rr.prototype,{getInterval:function(){return this.interval},find:function(t){var e=$n.getSubnodeIndex(t,this.centre);return-1===e?this:null!==this.subnode[e]?this.subnode[e].find(t):this},insert:function(t){h.isTrue(null===this.interval||this.interval.contains(t.interval));var e=$n.getSubnodeIndex(t.interval,this.centre);if(t.level===this.level-1)this.subnode[e]=t;else{var n=this.createSubnode(e);n.insert(t),this.subnode[e]=n}},isSearchMatch:function(t){return t.overlaps(this.interval)},getSubnode:function(t){return null===this.subnode[t]&&(this.subnode[t]=this.createSubnode(t)),this.subnode[t]},getNode:function(t){var e=$n.getSubnodeIndex(t,this.centre);return-1!==e?this.getSubnode(e).getNode(t):this},createSubnode:function(t){var e=0,n=0;switch(t){case 0:e=this.interval.getMin(),n=this.centre;break;case 1:e=this.centre,n=this.interval.getMax()}return new rr(new tr(e,n),this.level-1)},interfaces_:function(){return[]},getClass:function(){return rr}}),rr.createNode=function(t){var e=new nr(t);return new rr(e.getInterval(),e.getLevel())},rr.createExpanded=function(t,e){var n=new tr(e);null!==t&&n.expandToInclude(t.interval);var r=rr.createNode(n);return null!==t&&r.insert(t),r},e(ir.prototype,{interfaces_:function(){return[]},getClass:function(){return ir}}),ir.isZeroWidth=function(t,e){var n=e-t;if(0===n)return!0;var r=n/Math.max(Math.abs(t),Math.abs(e));return er.exponent(r)<=ir.MIN_BINARY_EXPONENT},ir.MIN_BINARY_EXPONENT=-50,l(or,$n),e(or.prototype,{insert:function(t,e){var n=$n.getSubnodeIndex(t,or.origin);if(-1===n)return this.add(e),null;var r=this.subnode[n];if(null===r||!r.getInterval().contains(t)){var i=rr.createExpanded(r,t);this.subnode[n]=i}this.insertContained(this.subnode[n],t,e)},isSearchMatch:function(t){return!0},insertContained:function(t,e,n){h.isTrue(t.getInterval().contains(e)),(ir.isZeroWidth(e.getMin(),e.getMax())?t.find(e):t.getNode(e)).add(n)},interfaces_:function(){return[]},getClass:function(){return or}}),or.origin=0,e(ar.prototype,{size:function(){return null!==this.root?this.root.size():0},insert:function(t,e){this.collectStats(t);var n=ar.ensureExtent(t,this.minExtent);this.root.insert(n,e)},query:function(){if(1===arguments.length){if("number"==typeof arguments[0]){var t=arguments[0];return this.query(new tr(t,t))}if(arguments[0]instanceof tr){var e=arguments[0],n=new x;return this.query(e,n),n}}else if(2===arguments.length){var r=arguments[0],i=arguments[1];this.root.addAllItemsFromOverlapping(r,i)}},iterator:function(){var t=new x;return this.root.addAllItems(t),t.iterator()},remove:function(t,e){var n=ar.ensureExtent(t,this.minExtent);return this.root.remove(n,e)},collectStats:function(t){var e=t.getWidth();e<this.minExtent&&e>0&&(this.minExtent=e)},depth:function(){return null!==this.root?this.root.depth():0},nodeSize:function(){return null!==this.root?this.root.nodeSize():0},interfaces_:function(){return[]},getClass:function(){return ar}}),ar.ensureExtent=function(t,e){var n=t.getMin(),r=t.getMax();return n!==r?t:(n===r&&(r=(n-=e/2)+e/2),new tr(n,r))},e(sr.prototype,{isInside:function(t){},interfaces_:function(){return[]},getClass:function(){return sr}}),e(ur.prototype,{testLineSegment:function(t,e){var n,r,i,o,a=e.p0,s=e.p1;n=a.x-t.x,r=a.y-t.y,i=s.x-t.x,o=s.y-t.y,(r>0&&o<=0||o>0&&r<=0)&&0<Jt.signOfDet2x2(n,r,i,o)/(o-r)&&this.crossings++},buildIndex:function(){this.tree=new ar;for(var t=X.removeRepeatedPoints(this.ring.getCoordinates()),e=Ve.getChains(t),n=0;n<e.size();n++){var r=e.get(n),i=r.getEnvelope();this.interval.min=i.getMinY(),this.interval.max=i.getMaxY(),this.tree.insert(this.interval,r)}},testMonotoneChain:function(t,e,n){n.select(t,e)},isInside:function(t){this.crossings=0;var e=new E(i.NEGATIVE_INFINITY,i.POSITIVE_INFINITY,t.y,t.y);this.interval.min=t.y,this.interval.max=t.y;for(var n=this.tree.query(this.interval),r=new cr(this,t),o=n.iterator();o.hasNext();){var a=o.next();this.testMonotoneChain(e,r,a)}return this.crossings%2==1},interfaces_:function(){return[sr]},getClass:function(){return ur}}),l(cr,Qn),e(cr.prototype,{select:function(){if(1!==arguments.length)return Qn.prototype.select.apply(this,arguments);var t=arguments[0];this.mcp.testLineSegment(this.p,t)},interfaces_:function(){return[]},getClass:function(){return cr}}),ur.MCSelecter=cr,e(lr.prototype,{interfaces_:function(){return[]},getClass:function(){return lr}}),lr.toDegrees=function(t){return 180*t/Math.PI},lr.normalize=function(t){for(;t>Math.PI;)t-=lr.PI_TIMES_2;for(;t<=-Math.PI;)t+=lr.PI_TIMES_2;return t},lr.angle=function(){if(1===arguments.length){var t=arguments[0];return Math.atan2(t.y,t.x)}if(2===arguments.length){var e=arguments[0],n=arguments[1],r=n.x-e.x,i=n.y-e.y;return Math.atan2(i,r)}},lr.isAcute=function(t,e,n){var r=t.x-e.x,i=t.y-e.y;return r*(n.x-e.x)+i*(n.y-e.y)>0},lr.isObtuse=function(t,e,n){var r=t.x-e.x,i=t.y-e.y;return r*(n.x-e.x)+i*(n.y-e.y)<0},lr.interiorAngle=function(t,e,n){var r=lr.angle(e,t),i=lr.angle(e,n);return Math.abs(i-r)},lr.normalizePositive=function(t){if(t<0){for(;t<0;)t+=lr.PI_TIMES_2;t>=lr.PI_TIMES_2&&(t=0)}else{for(;t>=lr.PI_TIMES_2;)t-=lr.PI_TIMES_2;t<0&&(t=0)}return t},lr.angleBetween=function(t,e,n){var r=lr.angle(e,t),i=lr.angle(e,n);return lr.diff(r,i)},lr.diff=function(t,e){var n=null;return(n=t<e?e-t:t-e)>Math.PI&&(n=2*Math.PI-n),n},lr.toRadians=function(t){return t*Math.PI/180},lr.getTurn=function(t,e){var n=Math.sin(e-t);return n>0?lr.COUNTERCLOCKWISE:n<0?lr.CLOCKWISE:lr.NONE},lr.angleBetweenOriented=function(t,e,n){var r=lr.angle(e,t),i=lr.angle(e,n)-r;return i<=-Math.PI?i+lr.PI_TIMES_2:i>Math.PI?i-lr.PI_TIMES_2:i},lr.PI_TIMES_2=2*Math.PI,lr.PI_OVER_2=Math.PI/2,lr.PI_OVER_4=Math.PI/4,lr.COUNTERCLOCKWISE=$t.COUNTERCLOCKWISE,lr.CLOCKWISE=$t.CLOCKWISE,lr.NONE=$t.COLLINEAR,e(fr.prototype,{area:function(){return fr.area(this.p0,this.p1,this.p2)},signedArea:function(){return fr.signedArea(this.p0,this.p1,this.p2)},interpolateZ:function(t){if(null===t)throw new r("Supplied point is null.");return fr.interpolateZ(t,this.p0,this.p1,this.p2)},longestSideLength:function(){return fr.longestSideLength(this.p0,this.p1,this.p2)},isAcute:function(){return fr.isAcute(this.p0,this.p1,this.p2)},circumcentre:function(){return fr.circumcentre(this.p0,this.p1,this.p2)},area3D:function(){return fr.area3D(this.p0,this.p1,this.p2)},centroid:function(){return fr.centroid(this.p0,this.p1,this.p2)},inCentre:function(){return fr.inCentre(this.p0,this.p1,this.p2)},interfaces_:function(){return[]},getClass:function(){return fr}}),fr.area=function(t,e,n){return Math.abs(((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2)},fr.signedArea=function(t,e,n){return((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2},fr.det=function(t,e,n,r){return t*r-e*n},fr.interpolateZ=function(t,e,n,r){var i=e.x,o=e.y,a=n.x-i,s=r.x-i,u=n.y-o,c=r.y-o,l=a*c-s*u,f=t.x-i,h=t.y-o,d=(c*f-s*h)/l,p=(-u*f+a*h)/l;return e.z+d*(n.z-e.z)+p*(r.z-e.z)},fr.longestSideLength=function(t,e,n){var r=t.distance(e),i=e.distance(n),o=n.distance(t),a=r;return i>a&&(a=i),o>a&&(a=o),a},fr.isAcute=function(t,e,n){return!!lr.isAcute(t,e,n)&&!!lr.isAcute(e,n,t)&&!!lr.isAcute(n,t,e)},fr.circumcentre=function(t,e,n){var r=n.x,i=n.y,o=t.x-r,a=t.y-i,s=e.x-r,u=e.y-i,c=2*fr.det(o,a,s,u);return new d(r-fr.det(a,o*o+a*a,u,s*s+u*u)/c,i+fr.det(o,o*o+a*a,s,s*s+u*u)/c)},fr.perpendicularBisector=function(t,e){var n=e.x-t.x,r=e.y-t.y,i=new j(t.x+n/2,t.y+r/2,1),o=new j(t.x-r+n/2,t.y+n+r/2,1);return new j(i,o)},fr.angleBisector=function(t,e,n){var r=e.distance(t),i=r/(r+e.distance(n)),o=n.x-t.x,a=n.y-t.y;return new d(t.x+i*o,t.y+i*a)},fr.area3D=function(t,e,n){var r=e.x-t.x,i=e.y-t.y,o=e.z-t.z,a=n.x-t.x,s=n.y-t.y,u=n.z-t.z,c=i*u-o*s,l=o*a-r*u,f=r*s-i*a,h=c*c+l*l+f*f;return Math.sqrt(h)/2},fr.centroid=function(t,e,n){return new d((t.x+e.x+n.x)/3,(t.y+e.y+n.y)/3)},fr.inCentre=function(t,e,n){var r=e.distance(n),i=t.distance(n),o=t.distance(e),a=r+i+o;return new d((r*t.x+i*e.x+o*n.x)/a,(r*t.y+i*e.y+o*n.y)/a)},e(hr.prototype,{getRadius:function(){return this.compute(),this.radius},getDiameter:function(){switch(this.compute(),this.extremalPts.length){case 0:return this.input.getFactory().createLineString();case 1:return this.input.getFactory().createPoint(this.centre)}var t=this.extremalPts[0],e=this.extremalPts[1];return this.input.getFactory().createLineString([t,e])},getExtremalPoints:function(){return this.compute(),this.extremalPts},computeCirclePoints:function(){if(this.input.isEmpty())return this.extremalPts=new Array(0).fill(null),null;if(1===this.input.getNumPoints()){var t=this.input.getCoordinates();return this.extremalPts=[new d(t[0])],null}var e=this.input.convexHull().getCoordinates();if(t=e,e[0].equals2D(e[e.length-1])&&(t=new Array(e.length-1).fill(null),X.copyDeep(e,0,t,0,e.length-1)),t.length<=2)return this.extremalPts=X.copyDeep(t),null;for(var n=hr.lowestPoint(t),r=hr.pointWitMinAngleWithX(t,n),i=0;i<t.length;i++){var o=hr.pointWithMinAngleWithSegment(t,n,r);if(lr.isObtuse(n,o,r))return this.extremalPts=[new d(n),new d(r)],null;if(lr.isObtuse(o,n,r))n=o;else{if(!lr.isObtuse(o,r,n))return this.extremalPts=[new d(n),new d(r),new d(o)],null;r=o}}h.shouldNeverReachHere("Logic failure in Minimum Bounding Circle algorithm!")},compute:function(){return null!==this.extremalPts?null:(this.computeCirclePoints(),this.computeCentre(),void(null!==this.centre&&(this.radius=this.centre.distance(this.extremalPts[0]))))},getFarthestPoints:function(){switch(this.compute(),this.extremalPts.length){case 0:return this.input.getFactory().createLineString();case 1:return this.input.getFactory().createPoint(this.centre)}var t=this.extremalPts[0],e=this.extremalPts[this.extremalPts.length-1];return this.input.getFactory().createLineString([t,e])},getCircle:function(){if(this.compute(),null===this.centre)return this.input.getFactory().createPolygon();var t=this.input.getFactory().createPoint(this.centre);return 0===this.radius?t:t.buffer(this.radius)},getCentre:function(){return this.compute(),this.centre},computeCentre:function(){switch(this.extremalPts.length){case 0:this.centre=null;break;case 1:this.centre=this.extremalPts[0];break;case 2:this.centre=new d((this.extremalPts[0].x+this.extremalPts[1].x)/2,(this.extremalPts[0].y+this.extremalPts[1].y)/2);break;case 3:this.centre=fr.circumcentre(this.extremalPts[0],this.extremalPts[1],this.extremalPts[2])}},interfaces_:function(){return[]},getClass:function(){return hr}}),hr.pointWitMinAngleWithX=function(t,e){for(var n=i.MAX_VALUE,r=null,o=0;o<t.length;o++){var a=t[o];if(a!==e){var s=a.x-e.x,u=a.y-e.y;u<0&&(u=-u);var c=u/Math.sqrt(s*s+u*u);c<n&&(n=c,r=a)}}return r},hr.lowestPoint=function(t){for(var e=t[0],n=1;n<t.length;n++)t[n].y<e.y&&(e=t[n]);return e},hr.pointWithMinAngleWithSegment=function(t,e,n){for(var r=i.MAX_VALUE,o=null,a=0;a<t.length;a++){var s=t[a];if(s!==e&&s!==n){var u=lr.angleBetween(e,s,n);u<r&&(r=u,o=s)}}return o},e(dr.prototype,{getWidthCoordinate:function(){return this.computeMinimumDiameter(),this.minWidthPt},getSupportingSegment:function(){return this.computeMinimumDiameter(),this.inputGeom.getFactory().createLineString([this.minBaseSeg.p0,this.minBaseSeg.p1])},getDiameter:function(){if(this.computeMinimumDiameter(),null===this.minWidthPt)return this.inputGeom.getFactory().createLineString(null);var t=this.minBaseSeg.project(this.minWidthPt);return this.inputGeom.getFactory().createLineString([t,this.minWidthPt])},computeWidthConvex:function(t){this.convexHullPts=t instanceof Ct?t.getExteriorRing().getCoordinates():t.getCoordinates(),0===this.convexHullPts.length?(this.minWidth=0,this.minWidthPt=null,this.minBaseSeg=null):1===this.convexHullPts.length?(this.minWidth=0,this.minWidthPt=this.convexHullPts[0],this.minBaseSeg.p0=this.convexHullPts[0],this.minBaseSeg.p1=this.convexHullPts[0]):2===this.convexHullPts.length||3===this.convexHullPts.length?(this.minWidth=0,this.minWidthPt=this.convexHullPts[0],this.minBaseSeg.p0=this.convexHullPts[0],this.minBaseSeg.p1=this.convexHullPts[1]):this.computeConvexRingMinDiameter(this.convexHullPts)},computeConvexRingMinDiameter:function(t){this.minWidth=i.MAX_VALUE;for(var e=1,n=new te,r=0;r<t.length-1;r++)n.p0=t[r],n.p1=t[r+1],e=this.findMaxPerpDistance(t,n,e)},computeMinimumDiameter:function(){if(null!==this.minWidthPt)return null;if(this.isConvex)this.computeWidthConvex(this.inputGeom);else{var t=new ae(this.inputGeom).getConvexHull();this.computeWidthConvex(t)}},getLength:function(){return this.computeMinimumDiameter(),this.minWidth},findMaxPerpDistance:function(t,e,n){for(var r=e.distancePerpendicular(t[n]),i=r,o=n,a=o;i>=r;)r=i,o=a,a=dr.nextIndex(t,o),i=e.distancePerpendicular(t[a]);return r<this.minWidth&&(this.minPtIndex=o,this.minWidth=r,this.minWidthPt=t[this.minPtIndex],this.minBaseSeg=new te(e)),o},getMinimumRectangle:function(){if(this.computeMinimumDiameter(),0===this.minWidth)return this.minBaseSeg.p0.equals2D(this.minBaseSeg.p1)?this.inputGeom.getFactory().createPoint(this.minBaseSeg.p0):this.minBaseSeg.toGeometry(this.inputGeom.getFactory());for(var t=this.minBaseSeg.p1.x-this.minBaseSeg.p0.x,e=this.minBaseSeg.p1.y-this.minBaseSeg.p0.y,n=i.MAX_VALUE,r=-i.MAX_VALUE,o=i.MAX_VALUE,a=-i.MAX_VALUE,s=0;s<this.convexHullPts.length;s++){var u=dr.computeC(t,e,this.convexHullPts[s]);u>r&&(r=u),u<n&&(n=u);var c=dr.computeC(-e,t,this.convexHullPts[s]);c>a&&(a=c),c<o&&(o=c)}var l=dr.computeSegmentForLine(-t,-e,a),f=dr.computeSegmentForLine(-t,-e,o),h=dr.computeSegmentForLine(-e,t,r),d=dr.computeSegmentForLine(-e,t,n),p=h.lineIntersection(l),g=d.lineIntersection(l),v=d.lineIntersection(f),y=h.lineIntersection(f),m=this.inputGeom.getFactory().createLinearRing([p,g,v,y,p]);return this.inputGeom.getFactory().createPolygon(m,null)},interfaces_:function(){return[]},getClass:function(){return dr}}),dr.nextIndex=function(t,e){return++e>=t.length&&(e=0),e},dr.computeC=function(t,e,n){return t*n.y-e*n.x},dr.getMinimumDiameter=function(t){return new dr(t).getDiameter()},dr.getMinimumRectangle=function(t){return new dr(t).getMinimumRectangle()},dr.computeSegmentForLine=function(t,e,n){var r=null,i=null;return Math.abs(e)>Math.abs(t)?(r=new d(0,n/e),i=new d(1,n/e-t/e)):(r=new d(n/t,0),i=new d(n/t-e/t,1)),new te(r,i)};var Qo=Object.freeze({Centroid:ne,CGAlgorithms:$t,ConvexHull:ae,InteriorPointArea:Yn,InteriorPointLine:Kn,InteriorPointPoint:Jn,RobustLineIntersector:Kt,MCPointInRing:ur,MinimumBoundingCircle:hr,MinimumDiameter:dr});e(pr.prototype,{getResultGeometry:function(){return new gr(this.distanceTolerance).transform(this.inputGeom)},setDistanceTolerance:function(t){if(t<=0)throw new r("Tolerance must be positive");this.distanceTolerance=t},interfaces_:function(){return[]},getClass:function(){return pr}}),pr.densifyPoints=function(t,e,n){for(var r=new te,i=new w,o=0;o<t.length-1;o++){r.p0=t[o],r.p1=t[o+1],i.add(r.p0,!1);var a=r.getLength(),s=Math.trunc(a/e)+1;if(s>1)for(var u=a/s,c=1;c<s;c++){var l=c*u/a,f=r.pointAlong(l);n.makePrecise(f),i.add(f,!1)}}return i.add(t[t.length-1],!1),i.toCoordinateArray()},pr.densify=function(t,e){var n=new pr(t);return n.setDistanceTolerance(e),n.getResultGeometry()},l(gr,ue),e(gr.prototype,{transformMultiPolygon:function(t,e){var n=ue.prototype.transformMultiPolygon.call(this,t,e);return this.createValidArea(n)},transformPolygon:function(t,e){var n=ue.prototype.transformPolygon.call(this,t,e);return e instanceof At?n:this.createValidArea(n)},transformCoordinates:function(t,e){var n=t.toCoordinateArray(),r=pr.densifyPoints(n,this.distanceTolerance,e.getPrecisionModel());return e instanceof Et&&1===r.length&&(r=new Array(0).fill(null)),this.factory.getCoordinateSequenceFactory().create(r)},createValidArea:function(t){return t.buffer(0)},interfaces_:function(){return[]},getClass:function(){return gr}}),pr.DensifyTransformer=gr;var $o=Object.freeze({Densifier:pr});e(vr.prototype,{find:function(t){var e=this;do{if(null===e)return null;if(e.dest().equals2D(t))return e;e=e.oNext()}while(e!==this);return null},dest:function(){return this._sym._orig},oNext:function(){return this._sym._next},insert:function(t){if(this.oNext()===this)return this.insertAfter(t),null;var e=this.compareTo(t),n=this;do{var r=n.oNext();if(r.compareTo(t)!==e||r===this)return n.insertAfter(t),null;n=r}while(n!==this);h.shouldNeverReachHere()},insertAfter:function(t){h.equals(this._orig,t.orig());var e=this.oNext();this._sym.setNext(t),t.sym().setNext(e)},degree:function(){var t=0,e=this;do{t++,e=e.oNext()}while(e!==this);return t},equals:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this._orig.equals2D(t)&&this._sym._orig.equals(e)}},deltaY:function(){return this._sym._orig.y-this._orig.y},sym:function(){return this._sym},prev:function(){return this._sym.next()._sym},compareAngularDirection:function(t){var e=this.deltaX(),n=this.deltaY(),r=t.deltaX(),i=t.deltaY();if(e===r&&n===i)return 0;var o=ze.quadrant(e,n),a=ze.quadrant(r,i);return o>a?1:o<a?-1:$t.computeOrientation(t._orig,t.dest(),this.dest())},prevNode:function(){for(var t=this;2===t.degree();)if((t=t.prev())===this)return null;return t},compareTo:function(t){var e=t;return this.compareAngularDirection(e)},next:function(){return this._next},setSym:function(t){this._sym=t},orig:function(){return this._orig},toString:function(){return"HE("+this._orig.x+" "+this._orig.y+", "+this._sym._orig.x+" "+this._sym._orig.y+")"},setNext:function(t){this._next=t},init:function(t){this.setSym(t),t.setSym(this),this.setNext(t),t.setNext(this)},deltaX:function(){return this._sym._orig.x-this._orig.x},interfaces_:function(){return[]},getClass:function(){return vr}}),vr.init=function(t,e){if(null!==t._sym||null!==e._sym||null!==t._next||null!==e._next)throw new IllegalStateException("Edges are already initialized");return t.init(e),t},vr.create=function(t,e){var n=new vr(t),r=new vr(e);return n.init(r),n},l(yr,vr),e(yr.prototype,{mark:function(){this._isMarked=!0},setMark:function(t){this._isMarked=t},isMarked:function(){return this._isMarked},interfaces_:function(){return[]},getClass:function(){return yr}}),yr.setMarkBoth=function(t,e){t.setMark(e),t.sym().setMark(e)},yr.isMarked=function(t){return t.isMarked()},yr.setMark=function(t,e){t.setMark(e)},yr.markBoth=function(t){t.mark(),t.sym().mark()},yr.mark=function(t){t.mark()},e(mr.prototype,{insert:function(t,e,n){var r=this.create(t,e);null!==n?n.insert(r):this.vertexMap.put(t,r);var i=this.vertexMap.get(e);return null!==i?i.insert(r.sym()):this.vertexMap.put(e,r.sym()),r},create:function(t,e){var n=this.createEdge(t),r=this.createEdge(e);return vr.init(n,r),n},createEdge:function(t){return new vr(t)},addEdge:function(t,e){if(!mr.isValidEdge(t,e))return null;var n=this.vertexMap.get(t),r=null;return null!==n&&(r=n.find(e)),null!==r?r:this.insert(t,e,n)},getVertexEdges:function(){return this.vertexMap.values()},findEdge:function(t,e){var n=this.vertexMap.get(t);return null===n?null:n.find(e)},interfaces_:function(){return[]},getClass:function(){return mr}}),mr.isValidEdge=function(t,e){return 0!==e.compareTo(t)},l(br,yr),e(br.prototype,{setStart:function(){this._isStart=!0},isStart:function(){return this._isStart},interfaces_:function(){return[]},getClass:function(){return br}}),l(_r,mr),e(_r.prototype,{createEdge:function(t){return new br(t)},interfaces_:function(){return[]},getClass:function(){return _r}}),e(xr.prototype,{addLine:function(t){this.lines.add(this.factory.createLineString(t.toCoordinateArray()))},updateRingStartEdge:function(t){return t.isStart()||(t=t.sym()).isStart()?null===this.ringStartEdge?(this.ringStartEdge=t,null):void(t.orig().compareTo(this.ringStartEdge.orig())<0&&(this.ringStartEdge=t)):null},getResult:function(){return null===this.result&&this.computeResult(),this.result},process:function(t){var e=t.prevNode();null===e&&(e=t),this.stackEdges(e),this.buildLines()},buildRing:function(t){var e=new w,n=t;for(e.add(n.orig().copy(),!1);2===n.sym().degree();){var r=n.next();if(r===t)break;e.add(r.orig().copy(),!1),n=r}e.add(n.dest().copy(),!1),this.addLine(e)},buildLine:function(t){var e=new w,n=t;for(this.ringStartEdge=null,yr.markBoth(n),e.add(n.orig().copy(),!1);2===n.sym().degree();){this.updateRingStartEdge(n);var r=n.next();if(r===t)return this.buildRing(this.ringStartEdge),null;e.add(r.orig().copy(),!1),n=r,yr.markBoth(n)}e.add(n.dest().copy(),!1),this.stackEdges(n.sym()),this.addLine(e)},stackEdges:function(t){var e=t;do{yr.isMarked(e)||this.nodeEdgeStack.add(e),e=e.oNext()}while(e!==t)},computeResult:function(){for(var t=this.graph.getVertexEdges().iterator();t.hasNext();){var e=t.next();yr.isMarked(e)||this.process(e)}this.result=this.factory.buildGeometry(this.lines)},buildLines:function(){for(;!this.nodeEdgeStack.empty();){var t=this.nodeEdgeStack.pop();yr.isMarked(t)||this.buildLine(t)}},add:function(){if(arguments[0]instanceof B){var t=arguments[0];t.apply({interfaces_:function(){return[D]},filter:function(t){t instanceof Et&&this.add(t)}})}else if(C(arguments[0],v))for(var e=arguments[0],n=e.iterator();n.hasNext();){var r=n.next();this.add(r)}else if(arguments[0]instanceof Et){var i=arguments[0];null===this.factory&&(this.factory=i.getFactory());var o=i.getCoordinateSequence(),a=!1;for(n=1;n<o.size();n++){var s=this.graph.addEdge(o.getCoordinate(n-1),o.getCoordinate(n));null!==s&&(a||(s.setStart(),a=!0))}}},interfaces_:function(){return[]},getClass:function(){return xr}}),xr.dissolve=function(t){var e=new xr;return e.add(t),e.getResult()};var ta=Object.freeze({LineDissolver:xr}),ea=Object.freeze({GeometryGraph:Vn});e(wr.prototype,{hasChildren:function(){for(var t=0;t<4;t++)if(null!==this.subnode[t])return!0;return!1},isPrunable:function(){return!(this.hasChildren()||this.hasItems())},addAllItems:function(t){t.addAll(this.items);for(var e=0;e<4;e++)null!==this.subnode[e]&&this.subnode[e].addAllItems(t);return t},getNodeCount:function(){for(var t=0,e=0;e<4;e++)null!==this.subnode[e]&&(t+=this.subnode[e].size());return t+1},size:function(){for(var t=0,e=0;e<4;e++)null!==this.subnode[e]&&(t+=this.subnode[e].size());return t+this.items.size()},addAllItemsFromOverlapping:function(t,e){if(!this.isSearchMatch(t))return null;e.addAll(this.items);for(var n=0;n<4;n++)null!==this.subnode[n]&&this.subnode[n].addAllItemsFromOverlapping(t,e)},visitItems:function(t,e){for(var n=this.items.iterator();n.hasNext();)e.visitItem(n.next())},hasItems:function(){return!this.items.isEmpty()},remove:function(t,e){if(!this.isSearchMatch(t))return!1;for(var n=!1,r=0;r<4;r++)if(null!==this.subnode[r]&&(n=this.subnode[r].remove(t,e))){this.subnode[r].isPrunable()&&(this.subnode[r]=null);break}return n||(n=this.items.remove(e))},visit:function(t,e){if(!this.isSearchMatch(t))return null;this.visitItems(t,e);for(var n=0;n<4;n++)null!==this.subnode[n]&&this.subnode[n].visit(t,e)},getItems:function(){return this.items},depth:function(){for(var t=0,e=0;e<4;e++)if(null!==this.subnode[e]){var n=this.subnode[e].depth();n>t&&(t=n)}return t+1},isEmpty:function(){var t=!0;this.items.isEmpty()||(t=!1);for(var e=0;e<4;e++)null!==this.subnode[e]&&(this.subnode[e].isEmpty()||(t=!1));return t},add:function(t){this.items.add(t)},interfaces_:function(){return[u]},getClass:function(){return wr}}),wr.getSubnodeIndex=function(t,e,n){var r=-1;return t.getMinX()>=e&&(t.getMinY()>=n&&(r=3),t.getMaxY()<=n&&(r=1)),t.getMaxX()<=e&&(t.getMinY()>=n&&(r=2),t.getMaxY()<=n&&(r=0)),r},e(Er.prototype,{getLevel:function(){return this.level},computeKey:function(){if(1===arguments.length){var t=arguments[0];for(this.level=Er.computeQuadLevel(t),this.env=new E,this.computeKey(this.level,t);!this.env.contains(t);)this.level+=1,this.computeKey(this.level,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1],r=er.powerOf2(e);this.pt.x=Math.floor(n.getMinX()/r)*r,this.pt.y=Math.floor(n.getMinY()/r)*r,this.env.init(this.pt.x,this.pt.x+r,this.pt.y,this.pt.y+r)}},getEnvelope:function(){return this.env},getCentre:function(){return new d((this.env.getMinX()+this.env.getMaxX())/2,(this.env.getMinY()+this.env.getMaxY())/2)},getPoint:function(){return this.pt},interfaces_:function(){return[]},getClass:function(){return Er}}),Er.computeQuadLevel=function(t){var e=t.getWidth(),n=t.getHeight(),r=e>n?e:n;return er.exponent(r)+1},l(Sr,wr),e(Sr.prototype,{find:function(t){var e=wr.getSubnodeIndex(t,this.centrex,this.centrey);return-1===e?this:null!==this.subnode[e]?this.subnode[e].find(t):this},isSearchMatch:function(t){return this.env.intersects(t)},getSubnode:function(t){return null===this.subnode[t]&&(this.subnode[t]=this.createSubnode(t)),this.subnode[t]},getEnvelope:function(){return this.env},getNode:function(t){var e=wr.getSubnodeIndex(t,this.centrex,this.centrey);return-1!==e?this.getSubnode(e).getNode(t):this},createSubnode:function(t){var e=0,n=0,r=0,i=0;switch(t){case 0:e=this.env.getMinX(),n=this.centrex,r=this.env.getMinY(),i=this.centrey;break;case 1:e=this.centrex,n=this.env.getMaxX(),r=this.env.getMinY(),i=this.centrey;break;case 2:e=this.env.getMinX(),n=this.centrex,r=this.centrey,i=this.env.getMaxY();break;case 3:e=this.centrex,n=this.env.getMaxX(),r=this.centrey,i=this.env.getMaxY()}return new Sr(new E(e,n,r,i),this.level-1)},insertNode:function(t){h.isTrue(null===this.env||this.env.contains(t.env));var e=wr.getSubnodeIndex(t.env,this.centrex,this.centrey);if(t.level===this.level-1)this.subnode[e]=t;else{var n=this.createSubnode(e);n.insertNode(t),this.subnode[e]=n}},interfaces_:function(){return[]},getClass:function(){return Sr}}),Sr.createNode=function(t){var e=new Er(t);return new Sr(e.getEnvelope(),e.getLevel())},Sr.createExpanded=function(t,e){var n=new E(e);null!==t&&n.expandToInclude(t.env);var r=Sr.createNode(n);return null!==t&&r.insertNode(t),r},l(Or,wr),e(Or.prototype,{insert:function(t,e){var n=wr.getSubnodeIndex(t,Or.origin.x,Or.origin.y);if(-1===n)return this.add(e),null;var r=this.subnode[n];if(null===r||!r.getEnvelope().contains(t)){var i=Sr.createExpanded(r,t);this.subnode[n]=i}this.insertContained(this.subnode[n],t,e)},isSearchMatch:function(t){return!0},insertContained:function(t,e,n){h.isTrue(t.getEnvelope().contains(e));var r=ir.isZeroWidth(e.getMinX(),e.getMaxX()),i=ir.isZeroWidth(e.getMinY(),e.getMaxY());(r||i?t.find(e):t.getNode(e)).add(n)},interfaces_:function(){return[]},getClass:function(){return Or}}),Or.origin=new d(0,0),e(Pr.prototype,{size:function(){return null!==this.root?this.root.size():0},insert:function(t,e){this.collectStats(t);var n=Pr.ensureExtent(t,this.minExtent);this.root.insert(n,e)},query:function(){if(1===arguments.length){var t=arguments[0],e=new Tn;return this.query(t,e),e.getItems()}if(2===arguments.length){var n=arguments[0],r=arguments[1];this.root.visit(n,r)}},queryAll:function(){var t=new x;return this.root.addAllItems(t),t},remove:function(t,e){var n=Pr.ensureExtent(t,this.minExtent);return this.root.remove(n,e)},collectStats:function(t){var e=t.getWidth();e<this.minExtent&&e>0&&(this.minExtent=e);var n=t.getHeight();n<this.minExtent&&n>0&&(this.minExtent=n)},depth:function(){return null!==this.root?this.root.depth():0},isEmpty:function(){return null===this.root},interfaces_:function(){return[Oe,u]},getClass:function(){return Pr}}),Pr.ensureExtent=function(t,e){var n=t.getMinX(),r=t.getMaxX(),i=t.getMinY(),o=t.getMaxY();return n!==r&&i!==o?t:(n===r&&(r=(n-=e/2)+e/2),i===o&&(o=(i-=e/2)+e/2),new E(n,r,i,o))},Pr.serialVersionUID=-0x678b60c967a25400;var na=Object.freeze({Quadtree:Pr}),ra=Object.freeze({STRtree:Ae}),ia=Object.freeze({quadtree:na,strtree:ra}),oa=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"];e(Cr.prototype,{read:function(t){var e,n=(e="string"==typeof t?JSON.parse(t):t).type;if(!aa[n])throw new Error("Unknown GeoJSON type: "+e.type);return-1!==oa.indexOf(n)?aa[n].apply(this,[e.coordinates]):"GeometryCollection"===n?aa[n].apply(this,[e.geometries]):aa[n].apply(this,[e])},write:function(t){var e=t.getGeometryType();if(!sa[e])throw new Error("Geometry is not supported");return sa[e].apply(this,[t])}});var aa={Feature:function(t){var e={};for(var n in t)e[n]=t[n];if(t.geometry){var r=t.geometry.type;if(!aa[r])throw new Error("Unknown GeoJSON type: "+t.type);e.geometry=this.read(t.geometry)}return t.bbox&&(e.bbox=aa.bbox.apply(this,[t.bbox])),e},FeatureCollection:function(t){var e={};if(t.features){e.features=[];for(var n=0;n<t.features.length;++n)e.features.push(this.read(t.features[n]))}return t.bbox&&(e.bbox=this.parse.bbox.apply(this,[t.bbox])),e},coordinates:function(t){for(var e=[],n=0;n<t.length;++n){var r=t[n];e.push(new d(r[0],r[1]))}return e},bbox:function(t){return this.geometryFactory.createLinearRing([new d(t[0],t[1]),new d(t[2],t[1]),new d(t[2],t[3]),new d(t[0],t[3]),new d(t[0],t[1])])},Point:function(t){var e=new d(t[0],t[1]);return this.geometryFactory.createPoint(e)},MultiPoint:function(t){for(var e=[],n=0;n<t.length;++n)e.push(aa.Point.apply(this,[t[n]]));return this.geometryFactory.createMultiPoint(e)},LineString:function(t){var e=aa.coordinates.apply(this,[t]);return this.geometryFactory.createLineString(e)},MultiLineString:function(t){for(var e=[],n=0;n<t.length;++n)e.push(aa.LineString.apply(this,[t[n]]));return this.geometryFactory.createMultiLineString(e)},Polygon:function(t){for(var e=aa.coordinates.apply(this,[t[0]]),n=this.geometryFactory.createLinearRing(e),r=[],i=1;i<t.length;++i){var o=t[i],a=aa.coordinates.apply(this,[o]),s=this.geometryFactory.createLinearRing(a);r.push(s)}return this.geometryFactory.createPolygon(n,r)},MultiPolygon:function(t){for(var e=[],n=0;n<t.length;++n){var r=t[n];e.push(aa.Polygon.apply(this,[r]))}return this.geometryFactory.createMultiPolygon(e)},GeometryCollection:function(t){for(var e=[],n=0;n<t.length;++n){var r=t[n];e.push(this.read(r))}return this.geometryFactory.createGeometryCollection(e)}},sa={coordinate:function(t){return[t.x,t.y]},Point:function(t){return{type:"Point",coordinates:sa.coordinate.apply(this,[t.getCoordinate()])}},MultiPoint:function(t){for(var e=[],n=0;n<t.geometries.length;++n){var r=t.geometries[n],i=sa.Point.apply(this,[r]);e.push(i.coordinates)}return{type:"MultiPoint",coordinates:e}},LineString:function(t){for(var e=[],n=t.getCoordinates(),r=0;r<n.length;++r){var i=n[r];e.push(sa.coordinate.apply(this,[i]))}return{type:"LineString",coordinates:e}},MultiLineString:function(t){for(var e=[],n=0;n<t.geometries.length;++n){var r=t.geometries[n],i=sa.LineString.apply(this,[r]);e.push(i.coordinates)}return{type:"MultiLineString",coordinates:e}},Polygon:function(t){var e=[],n=sa.LineString.apply(this,[t.shell]);e.push(n.coordinates);for(var r=0;r<t.holes.length;++r){var i=t.holes[r],o=sa.LineString.apply(this,[i]);e.push(o.coordinates)}return{type:"Polygon",coordinates:e}},MultiPolygon:function(t){for(var e=[],n=0;n<t.geometries.length;++n){var r=t.geometries[n],i=sa.Polygon.apply(this,[r]);e.push(i.coordinates)}return{type:"MultiPolygon",coordinates:e}},GeometryCollection:function(t){for(var e=[],n=0;n<t.geometries.length;++n){var r=t.geometries[n],i=r.getGeometryType();e.push(sa[i].apply(this,[r]))}return{type:"GeometryCollection",geometries:e}}};e(Mr.prototype,{read:function(t){var e=this.parser.read(t);return this.precisionModel.getType()===Wt.FIXED&&this.reducePrecision(e),e},reducePrecision:function(t){var e,n;if(t.coordinate)this.precisionModel.makePrecise(t.coordinate);else if(t.points)for(e=0,n=t.points.length;e<n;e++)this.precisionModel.makePrecise(t.points[e]);else if(t.geometries)for(e=0,n=t.geometries.length;e<n;e++)this.reducePrecision(t.geometries[e])}}),e(Ir.prototype,{write:function(t){return this.parser.write(t)}}),e(Ar.prototype,{read:function(t){var e=this.parser.read(t);return this.precisionModel.getType()===Wt.FIXED&&this.reducePrecision(e),e},reducePrecision:function(t){if(t.coordinate)this.precisionModel.makePrecise(t.coordinate);else if(t.points)for(var e=0,n=t.points.coordinates.length;e<n;e++)this.precisionModel.makePrecise(t.points.coordinates[e]);else if(t.geometries)for(var r=0,i=t.geometries.length;r<i;r++)this.reducePrecision(t.geometries[r])}}),e(Nr.prototype,{read:function(t){var e=this.ol;return t instanceof e.geom.Point?this.convertFromPoint(t):t instanceof e.geom.LineString?this.convertFromLineString(t):t instanceof e.geom.LinearRing?this.convertFromLinearRing(t):t instanceof e.geom.Polygon?this.convertFromPolygon(t):t instanceof e.geom.MultiPoint?this.convertFromMultiPoint(t):t instanceof e.geom.MultiLineString?this.convertFromMultiLineString(t):t instanceof e.geom.MultiPolygon?this.convertFromMultiPolygon(t):t instanceof e.geom.GeometryCollection?this.convertFromCollection(t):void 0},convertFromPoint:function(t){var e=t.getCoordinates();return this.geometryFactory.createPoint(new d(e[0],e[1]))},convertFromLineString:function(t){return this.geometryFactory.createLineString(t.getCoordinates().map((function(t){return new d(t[0],t[1])})))},convertFromLinearRing:function(t){return this.geometryFactory.createLinearRing(t.getCoordinates().map((function(t){return new d(t[0],t[1])})))},convertFromPolygon:function(t){for(var e=t.getLinearRings(),n=null,r=[],i=0;i<e.length;i++){var o=this.convertFromLinearRing(e[i]);0===i?n=o:r.push(o)}return this.geometryFactory.createPolygon(n,r)},convertFromMultiPoint:function(t){var e=t.getPoints().map((function(t){return this.convertFromPoint(t)}),this);return this.geometryFactory.createMultiPoint(e)},convertFromMultiLineString:function(t){var e=t.getLineStrings().map((function(t){return this.convertFromLineString(t)}),this);return this.geometryFactory.createMultiLineString(e)},convertFromMultiPolygon:function(t){var e=t.getPolygons().map((function(t){return this.convertFromPolygon(t)}),this);return this.geometryFactory.createMultiPolygon(e)},convertFromCollection:function(t){var e=t.getGeometries().map((function(t){return this.read(t)}),this);return this.geometryFactory.createGeometryCollection(e)},write:function(t){return"Point"===t.getGeometryType()?this.convertToPoint(t.getCoordinate()):"LineString"===t.getGeometryType()?this.convertToLineString(t):"LinearRing"===t.getGeometryType()?this.convertToLinearRing(t):"Polygon"===t.getGeometryType()?this.convertToPolygon(t):"MultiPoint"===t.getGeometryType()?this.convertToMultiPoint(t):"MultiLineString"===t.getGeometryType()?this.convertToMultiLineString(t):"MultiPolygon"===t.getGeometryType()?this.convertToMultiPolygon(t):"GeometryCollection"===t.getGeometryType()?this.convertToCollection(t):void 0},convertToPoint:function(t){return new this.ol.geom.Point([t.x,t.y])},convertToLineString:function(t){var e=t.points.coordinates.map(Tr);return new this.ol.geom.LineString(e)},convertToLinearRing:function(t){var e=t.points.coordinates.map(Tr);return new this.ol.geom.LinearRing(e)},convertToPolygon:function(t){for(var e=[t.shell.points.coordinates.map(Tr)],n=0;n<t.holes.length;n++)e.push(t.holes[n].points.coordinates.map(Tr));return new this.ol.geom.Polygon(e)},convertToMultiPoint:function(t){return new this.ol.geom.MultiPoint(t.getCoordinates().map(Tr))},convertToMultiLineString:function(t){for(var e=[],n=0;n<t.geometries.length;n++)e.push(this.convertToLineString(t.geometries[n]).getCoordinates());return new this.ol.geom.MultiLineString(e)},convertToMultiPolygon:function(t){for(var e=[],n=0;n<t.geometries.length;n++)e.push(this.convertToPolygon(t.geometries[n]).getCoordinates());return new this.ol.geom.MultiPolygon(e)},convertToCollection:function(t){for(var e=[],n=0;n<t.geometries.length;n++){var r=t.geometries[n];e.push(this.write(r))}return new this.ol.geom.GeometryCollection(e)}});var ua=Object.freeze({GeoJSONReader:Mr,GeoJSONWriter:Ir,OL3Parser:Nr,WKTReader:Ar,WKTWriter:Yt});e(Lr.prototype,{rescale:function(){if(C(arguments[0],v))for(var t=arguments[0],e=t.iterator();e.hasNext();){var n=e.next();this.rescale(n.getCoordinates())}else if(arguments[0]instanceof Array){var r=arguments[0];for(2===r.length&&(new d(r[0]),new d(r[1])),e=0;e<r.length;e++)r[e].x=r[e].x/this.scaleFactor+this.offsetX,r[e].y=r[e].y/this.scaleFactor+this.offsetY;2===r.length&&r[0].equals2D(r[1])&&k.out.println(r)}},scale:function(){if(C(arguments[0],v)){for(var t=arguments[0],e=new x,n=t.iterator();n.hasNext();){var r=n.next();e.add(new Fe(this.scale(r.getCoordinates()),r.getData()))}return e}if(arguments[0]instanceof Array){var i=arguments[0],o=new Array(i.length).fill(null);for(n=0;n<i.length;n++)o[n]=new d(Math.round((i[n].x-this.offsetX)*this.scaleFactor),Math.round((i[n].y-this.offsetY)*this.scaleFactor),i[n].z);var a=X.removeRepeatedPoints(o);return a}},isIntegerPrecision:function(){return 1===this.scaleFactor},getNodedSubstrings:function(){var t=this.noder.getNodedSubstrings();return this.isScaled&&this.rescale(t),t},computeNodes:function(t){var e=t;this.isScaled&&(e=this.scale(t)),this.noder.computeNodes(e)},interfaces_:function(){return[Ge]},getClass:function(){return Lr}});var ca=Object.freeze({MCIndexNoder:We,ScaledNoder:Lr,SegmentString:be});e(Rr.prototype,{isSimpleMultiPoint:function(t){if(t.isEmpty())return!0;for(var e=new st,n=0;n<t.getNumGeometries();n++){var r=t.getGeometryN(n).getCoordinate();if(e.contains(r))return this.nonSimpleLocation=r,!1;e.add(r)}return!0},isSimplePolygonal:function(t){for(var e=An.getLines(t).iterator();e.hasNext();){var n=e.next();if(!this.isSimpleLinearGeometry(n))return!1}return!0},hasClosedEndpointIntersection:function(t){for(var e=new it,n=t.getEdgeIterator();n.hasNext();){var r=n.next(),i=(r.getMaximumSegmentIndex(),r.isClosed()),o=r.getCoordinate(0);this.addEndpoint(e,o,i);var a=r.getCoordinate(r.getNumPoints()-1);this.addEndpoint(e,a,i)}for(n=e.values().iterator();n.hasNext();){var s=n.next();if(s.isClosed&&2!==s.degree)return this.nonSimpleLocation=s.getCoordinate(),!0}return!1},getNonSimpleLocation:function(){return this.nonSimpleLocation},isSimpleLinearGeometry:function(t){if(t.isEmpty())return!0;var e=new Vn(0,t),n=new Kt,r=e.computeSelfNodes(n,!0);return!(r.hasIntersection()&&(r.hasProperIntersection()?(this.nonSimpleLocation=r.getProperIntersectionPoint(),1):this.hasNonEndpointIntersection(e)||this.isClosedEndpointsInInterior&&this.hasClosedEndpointIntersection(e)))},hasNonEndpointIntersection:function(t){for(var e=t.getEdgeIterator();e.hasNext();)for(var n=e.next(),r=n.getMaximumSegmentIndex(),i=n.getEdgeIntersectionList().iterator();i.hasNext();){var o=i.next();if(!o.isEndPoint(r))return this.nonSimpleLocation=o.getCoordinate(),!0}return!1},addEndpoint:function(t,e,n){var r=t.get(e);null===r&&(r=new kr(e),t.put(e,r)),r.addEndpoint(n)},computeSimple:function(t){return this.nonSimpleLocation=null,!!t.isEmpty()||(t instanceof Et||t instanceof dt?this.isSimpleLinearGeometry(t):t instanceof Mt?this.isSimpleMultiPoint(t):C(t,Pt)?this.isSimplePolygonal(t):!(t instanceof ht)||this.isSimpleGeometryCollection(t))},isSimple:function(){return this.nonSimpleLocation=null,this.computeSimple(this.inputGeom)},isSimpleGeometryCollection:function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);if(!this.computeSimple(n))return!1}return!0},interfaces_:function(){return[]},getClass:function(){return Rr}}),e(kr.prototype,{addEndpoint:function(t){this.degree++,this.isClosed|=t},getCoordinate:function(){return this.pt},interfaces_:function(){return[]},getClass:function(){return kr}}),Rr.EndpointInfo=kr,e(jr.prototype,{getEndCapStyle:function(){return this.endCapStyle},isSingleSided:function(){return this._isSingleSided},setQuadrantSegments:function(t){this.quadrantSegments=t,0===this.quadrantSegments&&(this.joinStyle=jr.JOIN_BEVEL),this.quadrantSegments<0&&(this.joinStyle=jr.JOIN_MITRE,this.mitreLimit=Math.abs(this.quadrantSegments)),t<=0&&(this.quadrantSegments=1),this.joinStyle!==jr.JOIN_ROUND&&(this.quadrantSegments=jr.DEFAULT_QUADRANT_SEGMENTS)},getJoinStyle:function(){return this.joinStyle},setJoinStyle:function(t){this.joinStyle=t},setSimplifyFactor:function(t){this.simplifyFactor=t<0?0:t},getSimplifyFactor:function(){return this.simplifyFactor},getQuadrantSegments:function(){return this.quadrantSegments},setEndCapStyle:function(t){this.endCapStyle=t},getMitreLimit:function(){return this.mitreLimit},setMitreLimit:function(t){this.mitreLimit=t},setSingleSided:function(t){this._isSingleSided=t},interfaces_:function(){return[]},getClass:function(){return jr}}),jr.bufferDistanceError=function(t){var e=Math.PI/2/t;return 1-Math.cos(e/2)},jr.CAP_ROUND=1,jr.CAP_FLAT=2,jr.CAP_SQUARE=3,jr.JOIN_ROUND=1,jr.JOIN_MITRE=2,jr.JOIN_BEVEL=3,jr.DEFAULT_QUADRANT_SEGMENTS=8,jr.DEFAULT_MITRE_LIMIT=5,jr.DEFAULT_SIMPLIFY_FACTOR=.01,e(Fr.prototype,{getCoordinate:function(){return this.minCoord},getRightmostSide:function(t,e){var n=this.getRightmostSideOfSegment(t,e);return n<0&&(n=this.getRightmostSideOfSegment(t,e-1)),n<0&&(this.minCoord=null,this.checkForRightmostCoordinate(t)),n},findRightmostEdgeAtVertex:function(){var t=this.minDe.getEdge().getCoordinates();h.isTrue(this.minIndex>0&&this.minIndex<t.length,"rightmost point expected to be interior vertex of edge");var e=t[this.minIndex-1],n=t[this.minIndex+1],r=$t.computeOrientation(this.minCoord,n,e),i=!1;(e.y<this.minCoord.y&&n.y<this.minCoord.y&&r===$t.COUNTERCLOCKWISE||e.y>this.minCoord.y&&n.y>this.minCoord.y&&r===$t.CLOCKWISE)&&(i=!0),i&&(this.minIndex=this.minIndex-1)},getRightmostSideOfSegment:function(t,e){var n=t.getEdge().getCoordinates();if(e<0||e+1>=n.length)return-1;if(n[e].y===n[e+1].y)return-1;var r=Qe.LEFT;return n[e].y<n[e+1].y&&(r=Qe.RIGHT),r},getEdge:function(){return this.orientedDe},checkForRightmostCoordinate:function(t){for(var e=t.getEdge().getCoordinates(),n=0;n<e.length-1;n++)(null===this.minCoord||e[n].x>this.minCoord.x)&&(this.minDe=t,this.minIndex=n,this.minCoord=e[n])},findRightmostEdgeAtNode:function(){var t=this.minDe.getNode().getEdges();this.minDe=t.getRightmostEdge(),this.minDe.isForward()||(this.minDe=this.minDe.getSym(),this.minIndex=this.minDe.getEdge().getCoordinates().length-1)},findEdge:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();n.isForward()&&this.checkForRightmostCoordinate(n)}h.isTrue(0!==this.minIndex||this.minCoord.equals(this.minDe.getCoordinate()),"inconsistency in rightmost processing"),0===this.minIndex?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this.orientedDe=this.minDe,this.getRightmostSide(this.minDe,this.minIndex)===Qe.LEFT&&(this.orientedDe=this.minDe.getSym())},interfaces_:function(){return[]},getClass:function(){return Fr}}),Dr.prototype.addLast=function(t){this.array_.push(t)},Dr.prototype.removeFirst=function(){return this.array_.shift()},Dr.prototype.isEmpty=function(){return 0===this.array_.length},e(Br.prototype,{clearVisitedEdges:function(){for(var t=this.dirEdgeList.iterator();t.hasNext();)t.next().setVisited(!1)},getRightmostCoordinate:function(){return this.rightMostCoord},computeNodeDepth:function(t){for(var e=null,n=t.getEdges().iterator();n.hasNext();)if((r=n.next()).isVisited()||r.getSym().isVisited()){e=r;break}if(null===e)throw new Xe("unable to find edge to compute depths at "+t.getCoordinate());for(t.getEdges().computeDepths(e),n=t.getEdges().iterator();n.hasNext();){var r;(r=n.next()).setVisited(!0),this.copySymDepths(r)}},computeDepth:function(t){this.clearVisitedEdges();var e=this.finder.getEdge();e.getNode(),e.getLabel(),e.setEdgeDepths(Qe.RIGHT,t),this.copySymDepths(e),this.computeDepths(e)},create:function(t){this.addReachable(t),this.finder.findEdge(this.dirEdgeList),this.rightMostCoord=this.finder.getCoordinate()},findResultEdges:function(){for(var t=this.dirEdgeList.iterator();t.hasNext();){var e=t.next();e.getDepth(Qe.RIGHT)>=1&&e.getDepth(Qe.LEFT)<=0&&!e.isInteriorAreaEdge()&&e.setInResult(!0)}},computeDepths:function(t){var e=new Q,n=new Dr,r=t.getNode();for(n.addLast(r),e.add(r),t.setVisited(!0);!n.isEmpty();){var i=n.removeFirst();e.add(i),this.computeNodeDepth(i);for(var o=i.getEdges().iterator();o.hasNext();){var a=o.next().getSym();if(!a.isVisited()){var s=a.getNode();e.contains(s)||(n.addLast(s),e.add(s))}}}},compareTo:function(t){var e=t;return this.rightMostCoord.x<e.rightMostCoord.x?-1:this.rightMostCoord.x>e.rightMostCoord.x?1:0},getEnvelope:function(){if(null===this.env){for(var t=new E,e=this.dirEdgeList.iterator();e.hasNext();)for(var n=e.next().getEdge().getCoordinates(),r=0;r<n.length-1;r++)t.expandToInclude(n[r]);this.env=t}return this.env},addReachable:function(t){var e=new ie;for(e.add(t);!e.empty();){var n=e.pop();this.add(n,e)}},copySymDepths:function(t){var e=t.getSym();e.setDepth(Qe.LEFT,t.getDepth(Qe.RIGHT)),e.setDepth(Qe.RIGHT,t.getDepth(Qe.LEFT))},add:function(t,e){t.setVisited(!0),this.nodes.add(t);for(var n=t.getEdges().iterator();n.hasNext();){var r=n.next();this.dirEdgeList.add(r);var i=r.getSym().getNode();i.isVisited()||e.push(i)}},getNodes:function(){return this.nodes},getDirectedEdges:function(){return this.dirEdgeList},interfaces_:function(){return[o]},getClass:function(){return Br}}),e(zr.prototype,{isDeletable:function(t,e,n,r){var i=this.inputLine[t],o=this.inputLine[e],a=this.inputLine[n];return!!this.isConcave(i,o,a)&&!!this.isShallow(i,o,a,r)&&this.isShallowSampled(i,o,t,n,r)},deleteShallowConcavities:function(){for(var t=1,e=(this.inputLine.length,this.findNextNonDeletedIndex(t)),n=this.findNextNonDeletedIndex(e),r=!1;n<this.inputLine.length;){var i=!1;this.isDeletable(t,e,n,this.distanceTol)&&(this.isDeleted[e]=zr.DELETE,i=!0,r=!0),t=i?n:e,e=this.findNextNonDeletedIndex(t),n=this.findNextNonDeletedIndex(e)}return r},isShallowConcavity:function(t,e,n,r){return $t.computeOrientation(t,e,n)===this.angleOrientation&&$t.distancePointLine(e,t,n)<r},isShallowSampled:function(t,e,n,r,i){var o=Math.trunc((r-n)/zr.NUM_PTS_TO_CHECK);o<=0&&(o=1);for(var a=n;a<r;a+=o)if(!this.isShallow(t,e,this.inputLine[a],i))return!1;return!0},isConcave:function(t,e,n){var r=$t.computeOrientation(t,e,n)===this.angleOrientation;return r},simplify:function(t){this.distanceTol=Math.abs(t),t<0&&(this.angleOrientation=$t.CLOCKWISE),this.isDeleted=new Array(this.inputLine.length).fill(null);var e=!1;do{e=this.deleteShallowConcavities()}while(e);return this.collapseLine()},findNextNonDeletedIndex:function(t){for(var e=t+1;e<this.inputLine.length&&this.isDeleted[e]===zr.DELETE;)e++;return e},isShallow:function(t,e,n,r){return $t.distancePointLine(e,t,n)<r},collapseLine:function(){for(var t=new w,e=0;e<this.inputLine.length;e++)this.isDeleted[e]!==zr.DELETE&&t.add(this.inputLine[e]);return t.toCoordinateArray()},interfaces_:function(){return[]},getClass:function(){return zr}}),zr.simplify=function(t,e){return new zr(t).simplify(e)},zr.INIT=0,zr.DELETE=1,zr.KEEP=1,zr.NUM_PTS_TO_CHECK=10,e(Vr.prototype,{getCoordinates:function(){return this.ptList.toArray(Vr.COORDINATE_ARRAY_TYPE)},setPrecisionModel:function(t){this.precisionModel=t},addPt:function(t){var e=new d(t);return this.precisionModel.makePrecise(e),this.isRedundant(e)?null:void this.ptList.add(e)},reverse:function(){},addPts:function(t,e){if(e)for(var n=0;n<t.length;n++)this.addPt(t[n]);else for(n=t.length-1;n>=0;n--)this.addPt(t[n])},isRedundant:function(t){if(this.ptList.size()<1)return!1;var e=this.ptList.get(this.ptList.size()-1);return t.distance(e)<this.minimimVertexDistance},toString:function(){return(new Xt).createLineString(this.getCoordinates()).toString()},closeRing:function(){if(this.ptList.size()<1)return null;var t=new d(this.ptList.get(0)),e=this.ptList.get(this.ptList.size()-1);return this.ptList.size()>=2&&this.ptList.get(this.ptList.size()-2),t.equals(e)?null:void this.ptList.add(t)},setMinimumVertexDistance:function(t){this.minimimVertexDistance=t},interfaces_:function(){return[]},getClass:function(){return Vr}}),Vr.COORDINATE_ARRAY_TYPE=new Array(0).fill(null),e(Gr.prototype,{addNextSegment:function(t,e){if(this.s0=this.s1,this.s1=this.s2,this.s2=t,this.seg0.setCoordinates(this.s0,this.s1),this.computeOffsetSegment(this.seg0,this.side,this.distance,this.offset0),this.seg1.setCoordinates(this.s1,this.s2),this.computeOffsetSegment(this.seg1,this.side,this.distance,this.offset1),this.s1.equals(this.s2))return null;var n=$t.computeOrientation(this.s0,this.s1,this.s2),r=n===$t.CLOCKWISE&&this.side===Qe.LEFT||n===$t.COUNTERCLOCKWISE&&this.side===Qe.RIGHT;0===n?this.addCollinear(e):r?this.addOutsideTurn(n,e):this.addInsideTurn(n,e)},addLineEndCap:function(t,e){var n=new te(t,e),r=new te;this.computeOffsetSegment(n,Qe.LEFT,this.distance,r);var i=new te;this.computeOffsetSegment(n,Qe.RIGHT,this.distance,i);var o=e.x-t.x,a=e.y-t.y,s=Math.atan2(a,o);switch(this.bufParams.getEndCapStyle()){case jr.CAP_ROUND:this.segList.addPt(r.p1),this.addFilletArc(e,s+Math.PI/2,s-Math.PI/2,$t.CLOCKWISE,this.distance),this.segList.addPt(i.p1);break;case jr.CAP_FLAT:this.segList.addPt(r.p1),this.segList.addPt(i.p1);break;case jr.CAP_SQUARE:var u=new d;u.x=Math.abs(this.distance)*Math.cos(s),u.y=Math.abs(this.distance)*Math.sin(s);var c=new d(r.p1.x+u.x,r.p1.y+u.y),l=new d(i.p1.x+u.x,i.p1.y+u.y);this.segList.addPt(c),this.segList.addPt(l)}},getCoordinates:function(){return this.segList.getCoordinates()},addMitreJoin:function(t,e,n,r){var i=!0,o=null;try{o=j.intersection(e.p0,e.p1,n.p0,n.p1),(r<=0?1:o.distance(t)/Math.abs(r))>this.bufParams.getMitreLimit()&&(i=!1)}catch(t){if(!(t instanceof O))throw t;o=new d(0,0),i=!1}i?this.segList.addPt(o):this.addLimitedMitreJoin(e,n,r,this.bufParams.getMitreLimit())},addFilletCorner:function(t,e,n,r,i){var o=e.x-t.x,a=e.y-t.y,s=Math.atan2(a,o),u=n.x-t.x,c=n.y-t.y,l=Math.atan2(c,u);r===$t.CLOCKWISE?s<=l&&(s+=2*Math.PI):s>=l&&(s-=2*Math.PI),this.segList.addPt(e),this.addFilletArc(t,s,l,r,i),this.segList.addPt(n)},addOutsideTurn:function(t,e){return this.offset0.p1.distance(this.offset1.p0)<this.distance*Gr.OFFSET_SEGMENT_SEPARATION_FACTOR?(this.segList.addPt(this.offset0.p1),null):void(this.bufParams.getJoinStyle()===jr.JOIN_MITRE?this.addMitreJoin(this.s1,this.offset0,this.offset1,this.distance):this.bufParams.getJoinStyle()===jr.JOIN_BEVEL?this.addBevelJoin(this.offset0,this.offset1):(e&&this.segList.addPt(this.offset0.p1),this.addFilletCorner(this.s1,this.offset0.p1,this.offset1.p0,t,this.distance),this.segList.addPt(this.offset1.p0)))},createSquare:function(t){this.segList.addPt(new d(t.x+this.distance,t.y+this.distance)),this.segList.addPt(new d(t.x+this.distance,t.y-this.distance)),this.segList.addPt(new d(t.x-this.distance,t.y-this.distance)),this.segList.addPt(new d(t.x-this.distance,t.y+this.distance)),this.segList.closeRing()},addSegments:function(t,e){this.segList.addPts(t,e)},addFirstSegment:function(){this.segList.addPt(this.offset1.p0)},addLastSegment:function(){this.segList.addPt(this.offset1.p1)},initSideSegments:function(t,e,n){this.s1=t,this.s2=e,this.side=n,this.seg1.setCoordinates(t,e),this.computeOffsetSegment(this.seg1,n,this.distance,this.offset1)},addLimitedMitreJoin:function(t,e,n,r){var i=this.seg0.p1,o=lr.angle(i,this.seg0.p0),a=(lr.angle(i,this.seg1.p1),lr.angleBetweenOriented(this.seg0.p0,i,this.seg1.p1)/2),s=lr.normalize(o+a),u=lr.normalize(s+Math.PI),c=r*n,l=n-c*Math.abs(Math.sin(a)),f=new te(i,new d(i.x+c*Math.cos(u),i.y+c*Math.sin(u))),h=f.pointAlongOffset(1,l),p=f.pointAlongOffset(1,-l);this.side===Qe.LEFT?(this.segList.addPt(h),this.segList.addPt(p)):(this.segList.addPt(p),this.segList.addPt(h))},computeOffsetSegment:function(t,e,n,r){var i=e===Qe.LEFT?1:-1,o=t.p1.x-t.p0.x,a=t.p1.y-t.p0.y,s=Math.sqrt(o*o+a*a),u=i*n*o/s,c=i*n*a/s;r.p0.x=t.p0.x-c,r.p0.y=t.p0.y+u,r.p1.x=t.p1.x-c,r.p1.y=t.p1.y+u},addFilletArc:function(t,e,n,r,i){var o,a=r===$t.CLOCKWISE?-1:1,s=Math.abs(e-n),u=Math.trunc(s/this.filletAngleQuantum+.5);if(u<1)return null;o=s/u;for(var c=0,l=new d;c<s;){var f=e+a*c;l.x=t.x+i*Math.cos(f),l.y=t.y+i*Math.sin(f),this.segList.addPt(l),c+=o}},addInsideTurn:function(t,e){if(this.li.computeIntersection(this.offset0.p0,this.offset0.p1,this.offset1.p0,this.offset1.p1),this.li.hasIntersection())this.segList.addPt(this.li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this.offset0.p1.distance(this.offset1.p0)<this.distance*Gr.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this.segList.addPt(this.offset0.p1);else{if(this.segList.addPt(this.offset0.p1),this.closingSegLengthFactor>0){var n=new d((this.closingSegLengthFactor*this.offset0.p1.x+this.s1.x)/(this.closingSegLengthFactor+1),(this.closingSegLengthFactor*this.offset0.p1.y+this.s1.y)/(this.closingSegLengthFactor+1));this.segList.addPt(n);var r=new d((this.closingSegLengthFactor*this.offset1.p0.x+this.s1.x)/(this.closingSegLengthFactor+1),(this.closingSegLengthFactor*this.offset1.p0.y+this.s1.y)/(this.closingSegLengthFactor+1));this.segList.addPt(r)}else this.segList.addPt(this.s1);this.segList.addPt(this.offset1.p0)}},createCircle:function(t){var e=new d(t.x+this.distance,t.y);this.segList.addPt(e),this.addFilletArc(t,0,2*Math.PI,-1,this.distance),this.segList.closeRing()},addBevelJoin:function(t,e){this.segList.addPt(t.p1),this.segList.addPt(e.p0)},init:function(t){this.distance=t,this.maxCurveSegmentError=t*(1-Math.cos(this.filletAngleQuantum/2)),this.segList=new Vr,this.segList.setPrecisionModel(this.precisionModel),this.segList.setMinimumVertexDistance(t*Gr.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)},addCollinear:function(t){this.li.computeIntersection(this.s0,this.s1,this.s1,this.s2),this.li.getIntersectionNum()>=2&&(this.bufParams.getJoinStyle()===jr.JOIN_BEVEL||this.bufParams.getJoinStyle()===jr.JOIN_MITRE?(t&&this.segList.addPt(this.offset0.p1),this.segList.addPt(this.offset1.p0)):this.addFilletCorner(this.s1,this.offset0.p1,this.offset1.p0,$t.CLOCKWISE,this.distance))},closeRing:function(){this.segList.closeRing()},hasNarrowConcaveAngle:function(){return this._hasNarrowConcaveAngle},interfaces_:function(){return[]},getClass:function(){return Gr}}),Gr.OFFSET_SEGMENT_SEPARATION_FACTOR=.001,Gr.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR=.001,Gr.CURVE_VERTEX_SNAP_DISTANCE_FACTOR=1e-6,Gr.MAX_CLOSING_SEG_LEN_FACTOR=80,e(Ur.prototype,{getOffsetCurve:function(t,e){if(this.distance=e,0===e)return null;var n=e<0,r=Math.abs(e),i=this.getSegGen(r);t.length<=1?this.computePointCurve(t[0],i):this.computeOffsetCurve(t,n,i);var o=i.getCoordinates();return n&&X.reverse(o),o},computeSingleSidedBufferCurve:function(t,e,n){var r=this.simplifyTolerance(this.distance);if(e){n.addSegments(t,!0);var i=zr.simplify(t,-r),o=i.length-1;n.initSideSegments(i[o],i[o-1],Qe.LEFT),n.addFirstSegment();for(var a=o-2;a>=0;a--)n.addNextSegment(i[a],!0)}else{n.addSegments(t,!1);var s=zr.simplify(t,r),u=s.length-1;for(n.initSideSegments(s[0],s[1],Qe.LEFT),n.addFirstSegment(),a=2;a<=u;a++)n.addNextSegment(s[a],!0)}n.addLastSegment(),n.closeRing()},computeRingBufferCurve:function(t,e,n){var r=this.simplifyTolerance(this.distance);e===Qe.RIGHT&&(r=-r);var i=zr.simplify(t,r),o=i.length-1;n.initSideSegments(i[o-1],i[0],e);for(var a=1;a<=o;a++){var s=1!==a;n.addNextSegment(i[a],s)}n.closeRing()},computeLineBufferCurve:function(t,e){var n=this.simplifyTolerance(this.distance),r=zr.simplify(t,n),i=r.length-1;e.initSideSegments(r[0],r[1],Qe.LEFT);for(var o=2;o<=i;o++)e.addNextSegment(r[o],!0);e.addLastSegment(),e.addLineEndCap(r[i-1],r[i]);var a=zr.simplify(t,-n),s=a.length-1;for(e.initSideSegments(a[s],a[s-1],Qe.LEFT),o=s-2;o>=0;o--)e.addNextSegment(a[o],!0);e.addLastSegment(),e.addLineEndCap(a[1],a[0]),e.closeRing()},computePointCurve:function(t,e){switch(this.bufParams.getEndCapStyle()){case jr.CAP_ROUND:e.createCircle(t);break;case jr.CAP_SQUARE:e.createSquare(t)}},getLineCurve:function(t,e){if(this.distance=e,e<0&&!this.bufParams.isSingleSided())return null;if(0===e)return null;var n=Math.abs(e),r=this.getSegGen(n);if(t.length<=1)this.computePointCurve(t[0],r);else if(this.bufParams.isSingleSided()){var i=e<0;this.computeSingleSidedBufferCurve(t,i,r)}else this.computeLineBufferCurve(t,r);return r.getCoordinates()},getBufferParameters:function(){return this.bufParams},simplifyTolerance:function(t){return t*this.bufParams.getSimplifyFactor()},getRingCurve:function(t,e,n){if(this.distance=n,t.length<=2)return this.getLineCurve(t,n);if(0===n)return Ur.copyCoordinates(t);var r=this.getSegGen(n);return this.computeRingBufferCurve(t,e,r),r.getCoordinates()},computeOffsetCurve:function(t,e,n){var r=this.simplifyTolerance(this.distance);if(e){var i=zr.simplify(t,-r),o=i.length-1;n.initSideSegments(i[o],i[o-1],Qe.LEFT),n.addFirstSegment();for(var a=o-2;a>=0;a--)n.addNextSegment(i[a],!0)}else{var s=zr.simplify(t,r),u=s.length-1;for(n.initSideSegments(s[0],s[1],Qe.LEFT),n.addFirstSegment(),a=2;a<=u;a++)n.addNextSegment(s[a],!0)}n.addLastSegment()},getSegGen:function(t){return new Gr(this.precisionModel,this.bufParams,t)},interfaces_:function(){return[]},getClass:function(){return Ur}}),Ur.copyCoordinates=function(t){for(var e=new Array(t.length).fill(null),n=0;n<e.length;n++)e[n]=new d(t[n]);return e},e(Wr.prototype,{findStabbedSegments:function(){if(1===arguments.length){for(var t=arguments[0],e=new x,n=this.subgraphs.iterator();n.hasNext();){var r=n.next(),i=r.getEnvelope();t.y<i.getMinY()||t.y>i.getMaxY()||this.findStabbedSegments(t,r.getDirectedEdges(),e)}return e}if(3===arguments.length)if(C(arguments[2],m)&&arguments[0]instanceof d&&arguments[1]instanceof cn){var o=arguments[0],a=arguments[1],s=arguments[2],u=a.getEdge().getCoordinates();for(n=0;n<u.length-1;n++){this.seg.p0=u[n],this.seg.p1=u[n+1],this.seg.p0.y>this.seg.p1.y&&this.seg.reverse();var c=Math.max(this.seg.p0.x,this.seg.p1.x);if(!(c<o.x||this.seg.isHorizontal()||o.y<this.seg.p0.y||o.y>this.seg.p1.y||$t.computeOrientation(this.seg.p0,this.seg.p1,o)===$t.RIGHT)){var l=a.getDepth(Qe.LEFT);this.seg.p0.equals(u[n])||(l=a.getDepth(Qe.RIGHT));var f=new qr(this.seg,l);s.add(f)}}}else if(C(arguments[2],m)&&arguments[0]instanceof d&&C(arguments[1],m)){var h=arguments[0],p=arguments[1],g=arguments[2];for(n=p.iterator();n.hasNext();){var v=n.next();v.isForward()&&this.findStabbedSegments(h,v,g)}}},getDepth:function(t){var e=this.findStabbedSegments(t);return 0===e.size()?0:Jo.min(e).leftDepth},interfaces_:function(){return[]},getClass:function(){return Wr}}),e(qr.prototype,{compareTo:function(t){var e=t;if(this.upwardSeg.minX()>=e.upwardSeg.maxX())return 1;if(this.upwardSeg.maxX()<=e.upwardSeg.minX())return-1;var n=this.upwardSeg.orientationIndex(e.upwardSeg);return 0!==n||0!=(n=-1*e.upwardSeg.orientationIndex(this.upwardSeg))?n:this.upwardSeg.compareTo(e.upwardSeg)},compareX:function(t,e){var n=t.p0.compareTo(e.p0);return 0!==n?n:t.p1.compareTo(e.p1)},toString:function(){return this.upwardSeg.toString()},interfaces_:function(){return[o]},getClass:function(){return qr}}),Wr.DepthSegment=qr,e(Xr.prototype,{addPoint:function(t){if(this.distance<=0)return null;var e=t.getCoordinates(),n=this.curveBuilder.getLineCurve(e,this.distance);this.addCurve(n,P.EXTERIOR,P.INTERIOR)},addPolygon:function(t){var e=this.distance,n=Qe.LEFT;this.distance<0&&(e=-this.distance,n=Qe.RIGHT);var r=t.getExteriorRing(),i=X.removeRepeatedPoints(r.getCoordinates());if(this.distance<0&&this.isErodedCompletely(r,this.distance))return null;if(this.distance<=0&&i.length<3)return null;this.addPolygonRing(i,e,n,P.EXTERIOR,P.INTERIOR);for(var o=0;o<t.getNumInteriorRing();o++){var a=t.getInteriorRingN(o),s=X.removeRepeatedPoints(a.getCoordinates());this.distance>0&&this.isErodedCompletely(a,-this.distance)||this.addPolygonRing(s,e,Qe.opposite(n),P.INTERIOR,P.EXTERIOR)}},isTriangleErodedCompletely:function(t,e){var n=new fr(t[0],t[1],t[2]),r=n.inCentre();return $t.distancePointLine(r,n.p0,n.p1)<Math.abs(e)},addLineString:function(t){if(this.distance<=0&&!this.curveBuilder.getBufferParameters().isSingleSided())return null;var e=X.removeRepeatedPoints(t.getCoordinates()),n=this.curveBuilder.getLineCurve(e,this.distance);this.addCurve(n,P.EXTERIOR,P.INTERIOR)},addCurve:function(t,e,n){if(null===t||t.length<2)return null;var r=new Fe(t,new tn(0,P.BOUNDARY,e,n));this.curveList.add(r)},getCurves:function(){return this.add(this.inputGeom),this.curveList},addPolygonRing:function(t,e,n,r,i){if(0===e&&t.length<It.MINIMUM_VALID_SIZE)return null;var o=r,a=i;t.length>=It.MINIMUM_VALID_SIZE&&$t.isCCW(t)&&(o=i,a=r,n=Qe.opposite(n));var s=this.curveBuilder.getRingCurve(t,n,e);this.addCurve(s,o,a)},add:function(t){if(t.isEmpty())return null;if(t instanceof Ct)this.addPolygon(t);else if(t instanceof Et)this.addLineString(t);else if(t instanceof Ot)this.addPoint(t);else if(t instanceof Mt)this.addCollection(t);else if(t instanceof dt)this.addCollection(t);else if(t instanceof At)this.addCollection(t);else{if(!(t instanceof ht))throw new UnsupportedOperationException(t.getClass().getName());this.addCollection(t)}},isErodedCompletely:function(t,e){var n=t.getCoordinates();if(n.length<4)return e<0;if(4===n.length)return this.isTriangleErodedCompletely(n,e);var r=t.getEnvelopeInternal(),i=Math.min(r.getHeight(),r.getWidth());return e<0&&2*Math.abs(e)>i},addCollection:function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);this.add(n)}},interfaces_:function(){return[]},getClass:function(){return Xr}}),e(Hr.prototype,{isTrivialIntersection:function(t,e,n,r){if(t===n&&1===this.li.getIntersectionNum()){if(Hr.isAdjacentSegments(e,r))return!0;if(t.isClosed()){var i=t.size()-1;if(0===e&&r===i||0===r&&e===i)return!0}}return!1},getProperIntersectionPoint:function(){return this.properIntersectionPoint},hasProperInteriorIntersection:function(){return this.hasProperInterior},getLineIntersector:function(){return this.li},hasProperIntersection:function(){return this.hasProper},processIntersections:function(t,e,n,r){if(t===n&&e===r)return null;this.numTests++;var i=t.getCoordinates()[e],o=t.getCoordinates()[e+1],a=n.getCoordinates()[r],s=n.getCoordinates()[r+1];this.li.computeIntersection(i,o,a,s),this.li.hasIntersection()&&(this.numIntersections++,this.li.isInteriorIntersection()&&(this.numInteriorIntersections++,this.hasInterior=!0),this.isTrivialIntersection(t,e,n,r)||(this._hasIntersection=!0,t.addIntersections(this.li,e,0),n.addIntersections(this.li,r,1),this.li.isProper()&&(this.numProperIntersections++,this.hasProper=!0,this.hasProperInterior=!0)))},hasIntersection:function(){return this._hasIntersection},isDone:function(){return!1},hasInteriorIntersection:function(){return this.hasInterior},interfaces_:function(){return[He]},getClass:function(){return Hr}}),Hr.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)},e(Yr.prototype,{setWorkingPrecisionModel:function(t){this.workingPrecisionModel=t},insertUniqueEdge:function(t){var e=this.edgeList.findEqualEdge(t);if(null!==e){var n=e.getLabel(),r=t.getLabel();e.isPointwiseEqual(t)||(r=new tn(t.getLabel())).flip(),n.merge(r);var i=Yr.depthDelta(r),o=e.getDepthDelta()+i;e.setDepthDelta(o)}else this.edgeList.add(t),t.setDepthDelta(Yr.depthDelta(t.getLabel()))},buildSubgraphs:function(t,e){for(var n=new x,r=t.iterator();r.hasNext();){var i=r.next(),o=i.getRightmostCoordinate(),a=new Wr(n).getDepth(o);i.computeDepth(a),i.findResultEdges(),n.add(i),e.add(i.getDirectedEdges(),i.getNodes())}},createSubgraphs:function(t){for(var e=new x,n=t.getNodes().iterator();n.hasNext();){var r=n.next();if(!r.isVisited()){var i=new Br;i.create(r),e.add(i)}}return Jo.sort(e,Jo.reverseOrder()),e},createEmptyResultGeometry:function(){return this.geomFact.createPolygon()},getNoder:function(t){if(null!==this.workingNoder)return this.workingNoder;var e=new We,n=new Kt;return n.setPrecisionModel(t),e.setSegmentIntersector(new Hr(n)),e},buffer:function(t,e){var n=this.workingPrecisionModel;null===n&&(n=t.getPrecisionModel()),this.geomFact=t.getFactory();var r=new Xr(t,e,new Ur(n,this.bufParams)).getCurves();if(r.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(r,n),this.graph=new fn(new bn),this.graph.addEdges(this.edgeList.getEdges());var i=this.createSubgraphs(this.graph),o=new hn(this.geomFact);this.buildSubgraphs(i,o);var a=o.getPolygons();return a.size()<=0?this.createEmptyResultGeometry():this.geomFact.buildGeometry(a)},computeNodedEdges:function(t,e){var n=this.getNoder(e);n.computeNodes(t);for(var r=n.getNodedSubstrings().iterator();r.hasNext();){var i=r.next(),o=i.getCoordinates();if(2!==o.length||!o[0].equals2D(o[1])){var a=i.getData(),s=new zn(i.getCoordinates(),new tn(a));this.insertUniqueEdge(s)}}},setNoder:function(t){this.workingNoder=t},interfaces_:function(){return[]},getClass:function(){return Yr}}),Yr.depthDelta=function(t){var e=t.getLocation(0,Qe.LEFT),n=t.getLocation(0,Qe.RIGHT);return e===P.INTERIOR&&n===P.EXTERIOR?1:e===P.EXTERIOR&&n===P.INTERIOR?-1:0},Yr.convertSegStrings=function(t){for(var e=new Xt,n=new x;t.hasNext();){var r=t.next(),i=e.createLineString(r.getCoordinates());n.add(i)}return e.buildGeometry(n)},e(Zr.prototype,{checkEndPtVertexIntersections:function(){if(0===arguments.length)for(var t=this.segStrings.iterator();t.hasNext();){var e=t.next().getCoordinates();this.checkEndPtVertexIntersections(e[0],this.segStrings),this.checkEndPtVertexIntersections(e[e.length-1],this.segStrings)}else if(2===arguments.length){var n=arguments[0],r=arguments[1];for(t=r.iterator();t.hasNext();){e=t.next().getCoordinates();for(var i=1;i<e.length-1;i++)if(e[i].equals(n))throw new c("found endpt/interior pt intersection at index "+i+" :pt "+n)}}},checkInteriorIntersections:function(){if(0===arguments.length)for(var t=this.segStrings.iterator();t.hasNext();)for(var e=t.next(),n=this.segStrings.iterator();n.hasNext();){var r=n.next();this.checkInteriorIntersections(e,r)}else if(2===arguments.length)for(var i=arguments[0],o=arguments[1],a=i.getCoordinates(),s=o.getCoordinates(),u=0;u<a.length-1;u++)for(var l=0;l<s.length-1;l++)this.checkInteriorIntersections(i,u,o,l);else if(4===arguments.length){var f=arguments[0],h=arguments[1],d=arguments[2],p=arguments[3];if(f===d&&h===p)return null;var g=f.getCoordinates()[h],v=f.getCoordinates()[h+1],y=d.getCoordinates()[p],m=d.getCoordinates()[p+1];if(this.li.computeIntersection(g,v,y,m),this.li.hasIntersection()&&(this.li.isProper()||this.hasInteriorIntersection(this.li,g,v)||this.hasInteriorIntersection(this.li,y,m)))throw new c("found non-noded intersection at "+g+"-"+v+" and "+y+"-"+m)}},checkValid:function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()},checkCollapses:function(){if(0===arguments.length)for(var t=this.segStrings.iterator();t.hasNext();){var e=t.next();this.checkCollapses(e)}else if(1===arguments.length){var n=arguments[0],r=n.getCoordinates();for(t=0;t<r.length-2;t++)this.checkCollapse(r[t],r[t+1],r[t+2])}},hasInteriorIntersection:function(t,e,n){for(var r=0;r<t.getIntersectionNum();r++){var i=t.getIntersection(r);if(!i.equals(e)&&!i.equals(n))return!0}return!1},checkCollapse:function(t,e,n){if(t.equals(n))throw new c("found non-noded collapse at "+Zr.fact.createLineString([t,e,n]))},interfaces_:function(){return[]},getClass:function(){return Zr}}),Zr.fact=new Xt,e(Kr.prototype,{intersectsScaled:function(t,e){var n=Math.min(t.x,e.x),r=Math.max(t.x,e.x),i=Math.min(t.y,e.y),o=Math.max(t.y,e.y),a=this.maxx<n||this.minx>r||this.maxy<i||this.miny>o;if(a)return!1;var s=this.intersectsToleranceSquare(t,e);return h.isTrue(!(a&&s),"Found bad envelope test"),s},initCorners:function(t){var e=.5;this.minx=t.x-e,this.maxx=t.x+e,this.miny=t.y-e,this.maxy=t.y+e,this.corner[0]=new d(this.maxx,this.maxy),this.corner[1]=new d(this.minx,this.maxy),this.corner[2]=new d(this.minx,this.miny),this.corner[3]=new d(this.maxx,this.miny)},intersects:function(t,e){return 1===this.scaleFactor?this.intersectsScaled(t,e):(this.copyScaled(t,this.p0Scaled),this.copyScaled(e,this.p1Scaled),this.intersectsScaled(this.p0Scaled,this.p1Scaled))},scale:function(t){return Math.round(t*this.scaleFactor)},getCoordinate:function(){return this.originalPt},copyScaled:function(t,e){e.x=this.scale(t.x),e.y=this.scale(t.y)},getSafeEnvelope:function(){if(null===this.safeEnv){var t=Kr.SAFE_ENV_EXPANSION_FACTOR/this.scaleFactor;this.safeEnv=new E(this.originalPt.x-t,this.originalPt.x+t,this.originalPt.y-t,this.originalPt.y+t)}return this.safeEnv},intersectsPixelClosure:function(t,e){return this.li.computeIntersection(t,e,this.corner[0],this.corner[1]),!!(this.li.hasIntersection()||(this.li.computeIntersection(t,e,this.corner[1],this.corner[2]),this.li.hasIntersection()||(this.li.computeIntersection(t,e,this.corner[2],this.corner[3]),this.li.hasIntersection()||(this.li.computeIntersection(t,e,this.corner[3],this.corner[0]),this.li.hasIntersection()))))},intersectsToleranceSquare:function(t,e){var n=!1,r=!1;return this.li.computeIntersection(t,e,this.corner[0],this.corner[1]),!!(this.li.isProper()||(this.li.computeIntersection(t,e,this.corner[1],this.corner[2]),this.li.isProper()||(this.li.hasIntersection()&&(n=!0),this.li.computeIntersection(t,e,this.corner[2],this.corner[3]),this.li.isProper()||(this.li.hasIntersection()&&(r=!0),this.li.computeIntersection(t,e,this.corner[3],this.corner[0]),this.li.isProper()||n&&r||t.equals(this.pt)||e.equals(this.pt)))))},addSnappedNode:function(t,e){var n=t.getCoordinate(e),r=t.getCoordinate(e+1);return!!this.intersects(n,r)&&(t.addIntersection(this.getCoordinate(),e),!0)},interfaces_:function(){return[]},getClass:function(){return Kr}}),Kr.SAFE_ENV_EXPANSION_FACTOR=.75,e(Jr.prototype,{snap:function(){if(1===arguments.length){var t=arguments[0];return this.snap(t,null,-1)}if(3===arguments.length){var e=arguments[0],n=arguments[1],r=arguments[2],i=e.getSafeEnvelope(),o=new Qr(e,n,r);return this.index.query(i,{interfaces_:function(){return[Se]},visitItem:function(t){t.select(i,o)}}),o.isNodeAdded()}},interfaces_:function(){return[]},getClass:function(){return Jr}}),l(Qr,Qn),e(Qr.prototype,{isNodeAdded:function(){return this._isNodeAdded},select:function(){if(2!==arguments.length)return Qn.prototype.select.apply(this,arguments);var t=arguments[0],e=arguments[1],n=t.getContext();return null!==this.parentEdge&&n===this.parentEdge&&e===this.hotPixelVertexIndex?null:void(this._isNodeAdded=this.hotPixel.addSnappedNode(n,e))},interfaces_:function(){return[]},getClass:function(){return Qr}}),Jr.HotPixelSnapAction=Qr,e($r.prototype,{processIntersections:function(t,e,n,r){if(t===n&&e===r)return null;var i=t.getCoordinates()[e],o=t.getCoordinates()[e+1],a=n.getCoordinates()[r],s=n.getCoordinates()[r+1];if(this.li.computeIntersection(i,o,a,s),this.li.hasIntersection()&&this.li.isInteriorIntersection()){for(var u=0;u<this.li.getIntersectionNum();u++)this.interiorIntersections.add(this.li.getIntersection(u));t.addIntersections(this.li,e,0),n.addIntersections(this.li,r,1)}},isDone:function(){return!1},getInteriorIntersections:function(){return this.interiorIntersections},interfaces_:function(){return[He]},getClass:function(){return $r}}),e(ti.prototype,{checkCorrectness:function(t){var e=new Zr(Fe.getNodedSubstrings(t));try{e.checkValid()}catch(t){if(!(t instanceof S))throw t;t.printStackTrace()}},getNodedSubstrings:function(){return Fe.getNodedSubstrings(this.nodedSegStrings)},snapRound:function(t,e){var n=this.findInteriorIntersections(t,e);this.computeIntersectionSnaps(n),this.computeVertexSnaps(t)},findInteriorIntersections:function(t,e){var n=new $r(e);return this.noder.setSegmentIntersector(n),this.noder.computeNodes(t),n.getInteriorIntersections()},computeVertexSnaps:function(){if(C(arguments[0],v))for(var t=arguments[0],e=t.iterator();e.hasNext();){var n=e.next();this.computeVertexSnaps(n)}else if(arguments[0]instanceof Fe)for(var r=arguments[0],i=r.getCoordinates(),o=0;o<i.length;o++){var a=new Kr(i[o],this.scaleFactor,this.li),s=this.pointSnapper.snap(a,r,o);s&&r.addIntersection(i[o],o)}},computeNodes:function(t){this.nodedSegStrings=t,this.noder=new We,this.pointSnapper=new Jr(this.noder.getIndex()),this.snapRound(t,this.li)},computeIntersectionSnaps:function(t){for(var e=t.iterator();e.hasNext();){var n=new Kr(e.next(),this.scaleFactor,this.li);this.pointSnapper.snap(n)}},interfaces_:function(){return[Ge]},getClass:function(){return ti}}),e(ei.prototype,{bufferFixedPrecision:function(t){var e=new Lr(new ti(new Wt(1)),t.getScale()),n=new Yr(this.bufParams);n.setWorkingPrecisionModel(t),n.setNoder(e),this.resultGeometry=n.buffer(this.argGeom,this.distance)},bufferReducedPrecision:function(){if(0===arguments.length){for(var t=ei.MAX_PRECISION_DIGITS;t>=0;t--){try{this.bufferReducedPrecision(t)}catch(t){if(!(t instanceof Xe))throw t;this.saveException=t}if(null!==this.resultGeometry)return null}throw this.saveException}if(1===arguments.length){var e=arguments[0],n=ei.precisionScaleFactor(this.argGeom,this.distance,e),r=new Wt(n);this.bufferFixedPrecision(r)}},computeGeometry:function(){if(this.bufferOriginalPrecision(),null!==this.resultGeometry)return null;var t=this.argGeom.getFactory().getPrecisionModel();t.getType()===Wt.FIXED?this.bufferFixedPrecision(t):this.bufferReducedPrecision()},setQuadrantSegments:function(t){this.bufParams.setQuadrantSegments(t)},bufferOriginalPrecision:function(){try{var t=new Yr(this.bufParams);this.resultGeometry=t.buffer(this.argGeom,this.distance)}catch(t){if(!(t instanceof c))throw t;this.saveException=t}},getResultGeometry:function(t){return this.distance=t,this.computeGeometry(),this.resultGeometry},setEndCapStyle:function(t){this.bufParams.setEndCapStyle(t)},interfaces_:function(){return[]},getClass:function(){return ei}}),ei.bufferOp=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=new ei(t);return n.getResultGeometry(e)}if(3===arguments.length){if(Number.isInteger(arguments[2])&&arguments[0]instanceof B&&"number"==typeof arguments[1]){var r=arguments[0],i=arguments[1],o=arguments[2];return(c=new ei(r)).setQuadrantSegments(o),c.getResultGeometry(i)}if(arguments[2]instanceof jr&&arguments[0]instanceof B&&"number"==typeof arguments[1]){var a=arguments[0],s=arguments[1],u=arguments[2];return(c=new ei(a,u)).getResultGeometry(s)}}else if(4===arguments.length){var c,l=arguments[0],f=arguments[1],h=arguments[2],d=arguments[3];return(c=new ei(l)).setQuadrantSegments(h),c.setEndCapStyle(d),c.getResultGeometry(f)}},ei.precisionScaleFactor=function(t,e,n){var r=t.getEnvelopeInternal(),i=M.max(Math.abs(r.getMaxX()),Math.abs(r.getMaxY()),Math.abs(r.getMinX()),Math.abs(r.getMinY()))+2*(e>0?e:0),o=n-Math.trunc(Math.log(i)/Math.log(10)+1);return Math.pow(10,o)},ei.CAP_ROUND=jr.CAP_ROUND,ei.CAP_BUTT=jr.CAP_FLAT,ei.CAP_FLAT=jr.CAP_FLAT,ei.CAP_SQUARE=jr.CAP_SQUARE,ei.MAX_PRECISION_DIGITS=12;var la=Object.freeze({BufferOp:ei,BufferParameters:jr});e(ni.prototype,{filter:function(t){t instanceof Ct&&this.comps.add(t)},interfaces_:function(){return[lt]},getClass:function(){return ni}}),ni.getPolygons=function(){if(1===arguments.length){var t=arguments[0];return ni.getPolygons(t,new x)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e instanceof Ct?n.add(e):e instanceof ht&&e.apply(new ni(n)),n}},e(ri.prototype,{isInsideArea:function(){return this.segIndex===ri.INSIDE_AREA},getCoordinate:function(){return this.pt},getGeometryComponent:function(){return this.component},getSegmentIndex:function(){return this.segIndex},interfaces_:function(){return[]},getClass:function(){return ri}}),ri.INSIDE_AREA=-1,e(ii.prototype,{filter:function(t){t instanceof Ot&&this.pts.add(t)},interfaces_:function(){return[lt]},getClass:function(){return ii}}),ii.getPoints=function(){if(1===arguments.length){var t=arguments[0];return t instanceof Ot?Jo.singletonList(t):ii.getPoints(t,new x)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e instanceof Ot?n.add(e):e instanceof ht&&e.apply(new ii(n)),n}},e(oi.prototype,{filter:function(t){(t instanceof Ot||t instanceof Et||t instanceof Ct)&&this.locations.add(new ri(t,0,t.getCoordinate()))},interfaces_:function(){return[lt]},getClass:function(){return oi}}),oi.getLocations=function(t){var e=new x;return t.apply(new oi(e)),e},e(ai.prototype,{computeContainmentDistance:function(){if(0===arguments.length){var t=new Array(2).fill(null);if(this.computeContainmentDistance(0,t),this.minDistance<=this.terminateDistance)return null;this.computeContainmentDistance(1,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1],r=1-e,i=ni.getPolygons(this.geom[e]);if(i.size()>0){var o=oi.getLocations(this.geom[r]);if(this.computeContainmentDistance(o,i,n),this.minDistance<=this.terminateDistance)return this.minDistanceLocation[r]=n[0],this.minDistanceLocation[e]=n[1],null}}else if(3===arguments.length)if(arguments[2]instanceof Array&&C(arguments[0],m)&&C(arguments[1],m)){for(var a=arguments[0],s=arguments[1],u=arguments[2],c=0;c<a.size();c++)for(var l=a.get(c),f=0;f<s.size();f++)if(this.computeContainmentDistance(l,s.get(f),u),this.minDistance<=this.terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof ri&&arguments[1]instanceof Ct){var h=arguments[0],d=arguments[1],p=arguments[2],g=h.getCoordinate();if(P.EXTERIOR!==this.ptLocator.locate(g,d))return this.minDistance=0,p[0]=h,p[1]=new ri(d,g),null}},computeMinDistanceLinesPoints:function(t,e,n){for(var r=0;r<t.size();r++)for(var i=t.get(r),o=0;o<e.size();o++){var a=e.get(o);if(this.computeMinDistance(i,a,n),this.minDistance<=this.terminateDistance)return null}},computeFacetDistance:function(){var t=new Array(2).fill(null),e=An.getLines(this.geom[0]),n=An.getLines(this.geom[1]),r=ii.getPoints(this.geom[0]),i=ii.getPoints(this.geom[1]);return this.computeMinDistanceLines(e,n,t),this.updateMinDistance(t,!1),this.minDistance<=this.terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(e,i,t),this.updateMinDistance(t,!1),this.minDistance<=this.terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(n,r,t),this.updateMinDistance(t,!0),this.minDistance<=this.terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistancePoints(r,i,t),void this.updateMinDistance(t,!1))))},nearestLocations:function(){return this.computeMinDistance(),this.minDistanceLocation},updateMinDistance:function(t,e){return null===t[0]?null:void(e?(this.minDistanceLocation[0]=t[1],this.minDistanceLocation[1]=t[0]):(this.minDistanceLocation[0]=t[0],this.minDistanceLocation[1]=t[1]))},nearestPoints:function(){return this.computeMinDistance(),[this.minDistanceLocation[0].getCoordinate(),this.minDistanceLocation[1].getCoordinate()]},computeMinDistance:function(){if(0===arguments.length){if(null!==this.minDistanceLocation)return null;if(this.minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this.minDistance<=this.terminateDistance)return null;this.computeFacetDistance()}else if(3===arguments.length)if(arguments[2]instanceof Array&&arguments[0]instanceof Et&&arguments[1]instanceof Ot){var t=arguments[0],e=arguments[1],n=arguments[2];if(t.getEnvelopeInternal().distance(e.getEnvelopeInternal())>this.minDistance)return null;for(var r=t.getCoordinates(),i=e.getCoordinate(),o=0;o<r.length-1;o++){if((d=$t.distancePointLine(i,r[o],r[o+1]))<this.minDistance){this.minDistance=d;var a=new te(r[o],r[o+1]),s=a.closestPoint(i);n[0]=new ri(t,o,s),n[1]=new ri(e,0,i)}if(this.minDistance<=this.terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof Et&&arguments[1]instanceof Et){var u=arguments[0],c=arguments[1],l=arguments[2];if(u.getEnvelopeInternal().distance(c.getEnvelopeInternal())>this.minDistance)return null;r=u.getCoordinates();var f=c.getCoordinates();for(o=0;o<r.length-1;o++)for(var h=0;h<f.length-1;h++){var d;if((d=$t.distanceLineLine(r[o],r[o+1],f[h],f[h+1]))<this.minDistance){this.minDistance=d;var p=new te(r[o],r[o+1]),g=new te(f[h],f[h+1]),v=p.closestPoints(g);l[0]=new ri(u,o,v[0]),l[1]=new ri(c,h,v[1])}if(this.minDistance<=this.terminateDistance)return null}}},computeMinDistancePoints:function(t,e,n){for(var r=0;r<t.size();r++)for(var i=t.get(r),o=0;o<e.size();o++){var a=e.get(o),s=i.getCoordinate().distance(a.getCoordinate());if(s<this.minDistance&&(this.minDistance=s,n[0]=new ri(i,0,i.getCoordinate()),n[1]=new ri(a,0,a.getCoordinate())),this.minDistance<=this.terminateDistance)return null}},distance:function(){if(null===this.geom[0]||null===this.geom[1])throw new r("null geometries are not supported");return this.geom[0].isEmpty()||this.geom[1].isEmpty()?0:(this.computeMinDistance(),this.minDistance)},computeMinDistanceLines:function(t,e,n){for(var r=0;r<t.size();r++)for(var i=t.get(r),o=0;o<e.size();o++){var a=e.get(o);if(this.computeMinDistance(i,a,n),this.minDistance<=this.terminateDistance)return null}},interfaces_:function(){return[]},getClass:function(){return ai}}),ai.distance=function(t,e){return new ai(t,e).distance()},ai.isWithinDistance=function(t,e,n){return new ai(t,e,n).distance()<=n},ai.nearestPoints=function(t,e){return new ai(t,e).nearestPoints()};var fa=Object.freeze({DistanceOp:ai});e(si.prototype,{getCoordinates:function(){if(null===this.coordinates){for(var t=0,e=0,n=new w,r=this.directedEdges.iterator();r.hasNext();){var i=r.next();i.getEdgeDirection()?t++:e++,n.add(i.getEdge().getLine().getCoordinates(),!1,i.getEdgeDirection())}this.coordinates=n.toCoordinateArray(),e>t&&X.reverse(this.coordinates)}return this.coordinates},toLineString:function(){return this.factory.createLineString(this.getCoordinates())},add:function(t){this.directedEdges.add(t)},interfaces_:function(){return[]},getClass:function(){return si}}),e(ui.prototype,{setVisited:function(t){this._isVisited=t},isMarked:function(){return this._isMarked},setData:function(t){this.data=t},getData:function(){return this.data},setMarked:function(t){this._isMarked=t},getContext:function(){return this.data},isVisited:function(){return this._isVisited},setContext:function(t){this.data=t},interfaces_:function(){return[]},getClass:function(){return ui}}),ui.getComponentWithVisitedState=function(t,e){for(;t.hasNext();){var n=t.next();if(n.isVisited()===e)return n}return null},ui.setVisited=function(t,e){for(;t.hasNext();)t.next().setVisited(e)},ui.setMarked=function(t,e){for(;t.hasNext();)t.next().setMarked(e)},l(ci,ui),e(ci.prototype,{isRemoved:function(){return null===this.parentEdge},compareDirection:function(t){return this.quadrant>t.quadrant?1:this.quadrant<t.quadrant?-1:$t.computeOrientation(t.p0,t.p1,this.p1)},getCoordinate:function(){return this.from.getCoordinate()},print:function(t){var e=this.getClass().getName(),n=e.lastIndexOf("."),r=e.substring(n+1);t.print("  "+r+": "+this.p0+" - "+this.p1+" "+this.quadrant+":"+this.angle)},getDirectionPt:function(){return this.p1},getAngle:function(){return this.angle},compareTo:function(t){var e=t;return this.compareDirection(e)},getFromNode:function(){return this.from},getSym:function(){return this.sym},setEdge:function(t){this.parentEdge=t},remove:function(){this.sym=null,this.parentEdge=null},getEdge:function(){return this.parentEdge},getQuadrant:function(){return this.quadrant},setSym:function(t){this.sym=t},getToNode:function(){return this.to},getEdgeDirection:function(){return this.edgeDirection},interfaces_:function(){return[o]},getClass:function(){return ci}}),ci.toEdges=function(t){for(var e=new x,n=t.iterator();n.hasNext();)e.add(n.next().parentEdge);return e},l(li,ci),e(li.prototype,{getNext:function(){return 2!==this.getToNode().getDegree()?null:this.getToNode().getOutEdges().getEdges().get(0)===this.getSym()?this.getToNode().getOutEdges().getEdges().get(1):(h.isTrue(this.getToNode().getOutEdges().getEdges().get(1)===this.getSym()),this.getToNode().getOutEdges().getEdges().get(0))},interfaces_:function(){return[]},getClass:function(){return li}}),l(fi,ui),e(fi.prototype,{isRemoved:function(){return null===this.dirEdge},setDirectedEdges:function(t,e){this.dirEdge=[t,e],t.setEdge(this),e.setEdge(this),t.setSym(e),e.setSym(t),t.getFromNode().addOutEdge(t),e.getFromNode().addOutEdge(e)},getDirEdge:function(){if(Number.isInteger(arguments[0])){var t=arguments[0];return this.dirEdge[t]}if(arguments[0]instanceof di){var e=arguments[0];return this.dirEdge[0].getFromNode()===e?this.dirEdge[0]:this.dirEdge[1].getFromNode()===e?this.dirEdge[1]:null}},remove:function(){this.dirEdge=null},getOppositeNode:function(t){return this.dirEdge[0].getFromNode()===t?this.dirEdge[0].getToNode():this.dirEdge[1].getFromNode()===t?this.dirEdge[1].getToNode():null},interfaces_:function(){return[]},getClass:function(){return fi}}),e(hi.prototype,{getNextEdge:function(t){var e=this.getIndex(t);return this.outEdges.get(this.getIndex(e+1))},getCoordinate:function(){var t=this.iterator();return t.hasNext()?t.next().getCoordinate():null},iterator:function(){return this.sortEdges(),this.outEdges.iterator()},sortEdges:function(){this.sorted||(Jo.sort(this.outEdges),this.sorted=!0)},remove:function(t){this.outEdges.remove(t)},getEdges:function(){return this.sortEdges(),this.outEdges},getNextCWEdge:function(t){var e=this.getIndex(t);return this.outEdges.get(this.getIndex(e-1))},getIndex:function(){if(arguments[0]instanceof fi){var t=arguments[0];this.sortEdges();for(var e=0;e<this.outEdges.size();e++)if(this.outEdges.get(e).getEdge()===t)return e;return-1}if(arguments[0]instanceof ci){var n=arguments[0];for(this.sortEdges(),e=0;e<this.outEdges.size();e++)if(this.outEdges.get(e)===n)return e;return-1}if(Number.isInteger(arguments[0])){var r=arguments[0],i=r%this.outEdges.size();return i<0&&(i+=this.outEdges.size()),i}},add:function(t){this.outEdges.add(t),this.sorted=!1},getDegree:function(){return this.outEdges.size()},interfaces_:function(){return[]},getClass:function(){return hi}}),l(di,ui),e(di.prototype,{isRemoved:function(){return null===this.pt},addOutEdge:function(t){this.deStar.add(t)},getCoordinate:function(){return this.pt},getOutEdges:function(){return this.deStar},remove:function(){if(0===arguments.length)this.pt=null;else if(1===arguments.length){var t=arguments[0];this.deStar.remove(t)}},getIndex:function(t){return this.deStar.getIndex(t)},getDegree:function(){return this.deStar.getDegree()},interfaces_:function(){return[]},getClass:function(){return di}}),di.getEdgesBetween=function(t,e){var n=new Q(ci.toEdges(t.getOutEdges().getEdges())),r=ci.toEdges(e.getOutEdges().getEdges());return n.retainAll(r),n},l(pi,fi),e(pi.prototype,{getLine:function(){return this.line},interfaces_:function(){return[]},getClass:function(){return pi}}),e(gi.prototype,{find:function(t){return this.nodeMap.get(t)},iterator:function(){return this.nodeMap.values().iterator()},remove:function(t){return this.nodeMap.remove(t)},values:function(){return this.nodeMap.values()},add:function(t){return this.nodeMap.put(t.getCoordinate(),t),t},interfaces_:function(){return[]},getClass:function(){return gi}}),e(vi.prototype,{findNodesOfDegree:function(t){for(var e=new x,n=this.nodeIterator();n.hasNext();){var r=n.next();r.getDegree()===t&&e.add(r)}return e},dirEdgeIterator:function(){return this.dirEdges.iterator()},edgeIterator:function(){return this.edges.iterator()},remove:function(){if(arguments[0]instanceof fi){var t=arguments[0];this.remove(t.getDirEdge(0)),this.remove(t.getDirEdge(1)),this.edges.remove(t),t.remove()}else if(arguments[0]instanceof ci){var e=arguments[0];null!==(o=e.getSym())&&o.setSym(null),e.getFromNode().remove(e),e.remove(),this.dirEdges.remove(e)}else if(arguments[0]instanceof di){for(var n=arguments[0],r=n.getOutEdges().getEdges(),i=r.iterator();i.hasNext();){var o,a=i.next();null!==(o=a.getSym())&&this.remove(o),this.dirEdges.remove(a);var s=a.getEdge();null!==s&&this.edges.remove(s)}this.nodeMap.remove(n.getCoordinate()),n.remove()}},findNode:function(t){return this.nodeMap.find(t)},getEdges:function(){return this.edges},nodeIterator:function(){return this.nodeMap.iterator()},contains:function(){if(arguments[0]instanceof fi){var t=arguments[0];return this.edges.contains(t)}if(arguments[0]instanceof ci){var e=arguments[0];return this.dirEdges.contains(e)}},add:function(){if(arguments[0]instanceof di){var t=arguments[0];this.nodeMap.add(t)}else if(arguments[0]instanceof fi){var e=arguments[0];this.edges.add(e),this.add(e.getDirEdge(0)),this.add(e.getDirEdge(1))}else if(arguments[0]instanceof ci){var n=arguments[0];this.dirEdges.add(n)}},getNodes:function(){return this.nodeMap.values()},interfaces_:function(){return[]},getClass:function(){return vi}}),l(yi,vi),e(yi.prototype,{addEdge:function(t){if(t.isEmpty())return null;var e=X.removeRepeatedPoints(t.getCoordinates());if(e.length<=1)return null;var n=e[0],r=e[e.length-1],i=this.getNode(n),o=this.getNode(r),a=new li(i,o,e[1],!0),s=new li(o,i,e[e.length-2],!1),u=new pi(t);u.setDirectedEdges(a,s),this.add(u)},getNode:function(t){var e=this.findNode(t);return null===e&&(e=new di(t),this.add(e)),e},interfaces_:function(){return[]},getClass:function(){return yi}}),e(mi.prototype,{buildEdgeStringsForUnprocessedNodes:function(){for(var t=this.graph.getNodes().iterator();t.hasNext();){var e=t.next();e.isMarked()||(h.isTrue(2===e.getDegree()),this.buildEdgeStringsStartingAt(e),e.setMarked(!0))}},buildEdgeStringsForNonDegree2Nodes:function(){for(var t=this.graph.getNodes().iterator();t.hasNext();){var e=t.next();2!==e.getDegree()&&(this.buildEdgeStringsStartingAt(e),e.setMarked(!0))}},buildEdgeStringsForObviousStartNodes:function(){this.buildEdgeStringsForNonDegree2Nodes()},getMergedLineStrings:function(){return this.merge(),this.mergedLineStrings},buildEdgeStringsStartingAt:function(t){for(var e=t.getOutEdges().iterator();e.hasNext();){var n=e.next();n.getEdge().isMarked()||this.edgeStrings.add(this.buildEdgeStringStartingWith(n))}},merge:function(){if(null!==this.mergedLineStrings)return null;ui.setMarked(this.graph.nodeIterator(),!1),ui.setMarked(this.graph.edgeIterator(),!1),this.edgeStrings=new x,this.buildEdgeStringsForObviousStartNodes(),this.buildEdgeStringsForIsolatedLoops(),this.mergedLineStrings=new x;for(var t=this.edgeStrings.iterator();t.hasNext();){var e=t.next();this.mergedLineStrings.add(e.toLineString())}},buildEdgeStringStartingWith:function(t){var e=new si(this.factory),n=t;do{e.add(n),n.getEdge().setMarked(!0),n=n.getNext()}while(null!==n&&n!==t);return e},add:function(){if(arguments[0]instanceof B){var t=arguments[0];t.apply({interfaces_:function(){return[D]},filter:function(t){t instanceof Et&&this.add(t)}})}else if(C(arguments[0],v)){var e=arguments[0];this.mergedLineStrings=null;for(var n=e.iterator();n.hasNext();){var r=n.next();this.add(r)}}else if(arguments[0]instanceof Et){var i=arguments[0];null===this.factory&&(this.factory=i.getFactory()),this.graph.addEdge(i)}},buildEdgeStringsForIsolatedLoops:function(){this.buildEdgeStringsForUnprocessedNodes()},interfaces_:function(){return[]},getClass:function(){return mi}});var ha=Object.freeze({LineMerger:mi}),da=Object.freeze({OverlayOp:qn});l(bi,ci),e(bi.prototype,{getNext:function(){return this.next},isInRing:function(){return null!==this.edgeRing},setRing:function(t){this.edgeRing=t},setLabel:function(t){this.label=t},getLabel:function(){return this.label},setNext:function(t){this.next=t},getRing:function(){return this.edgeRing},interfaces_:function(){return[]},getClass:function(){return bi}}),l(_i,fi),e(_i.prototype,{getLine:function(){return this.line},interfaces_:function(){return[]},getClass:function(){return _i}}),e(xi.prototype,{visitInteriorRing:function(t,e){var n=t.getCoordinates(),r=n[0],i=xi.findDifferentPoint(n,r),o=e.findEdgeInSameDirection(r,i),a=e.findEdgeEnd(o),s=null;a.getLabel().getLocation(0,Qe.RIGHT)===P.INTERIOR?s=a:a.getSym().getLabel().getLocation(0,Qe.RIGHT)===P.INTERIOR&&(s=a.getSym()),h.isTrue(null!==s,"unable to find dirEdge with Interior on RHS"),this.visitLinkedDirectedEdges(s)},visitShellInteriors:function(t,e){if(t instanceof Ct){var n=t;this.visitInteriorRing(n.getExteriorRing(),e)}if(t instanceof At)for(var r=t,i=0;i<r.getNumGeometries();i++)n=r.getGeometryN(i),this.visitInteriorRing(n.getExteriorRing(),e)},getCoordinate:function(){return this.disconnectedRingcoord},setInteriorEdgesInResult:function(t){for(var e=t.getEdgeEnds().iterator();e.hasNext();){var n=e.next();n.getLabel().getLocation(0,Qe.RIGHT)===P.INTERIOR&&n.setInResult(!0)}},visitLinkedDirectedEdges:function(t){var e=t,n=t;do{h.isTrue(null!==n,"found null Directed Edge"),n.setVisited(!0),n=n.getNext()}while(n!==e)},buildEdgeRings:function(t){for(var e=new x,n=t.iterator();n.hasNext();){var r=n.next();if(r.isInResult()&&null===r.getEdgeRing()){var i=new rn(r,this.geometryFactory);i.linkDirectedEdgesForMinimalEdgeRings();var o=i.buildMinimalRings();e.addAll(o)}}return e},hasUnvisitedShellEdge:function(t){for(var e=0;e<t.size();e++){var n=t.get(e);if(!n.isHole()){var r=n.getEdges(),i=r.get(0);if(i.getLabel().getLocation(0,Qe.RIGHT)===P.INTERIOR)for(var o=0;o<r.size();o++)if(!(i=r.get(o)).isVisited())return this.disconnectedRingcoord=i.getCoordinate(),!0}}return!1},isInteriorsConnected:function(){var t=new x;this.geomGraph.computeSplitEdges(t);var e=new fn(new bn);e.addEdges(t),this.setInteriorEdgesInResult(e),e.linkResultDirectedEdges();var n=this.buildEdgeRings(e.getEdgeEnds());return this.visitShellInteriors(this.geomGraph.getGeometry(),e),!this.hasUnvisitedShellEdge(n)},interfaces_:function(){return[]},getClass:function(){return xi}}),xi.findDifferentPoint=function(t,e){for(var n=0;n<t.length;n++)if(!t[n].equals(e))return t[n];return null},e(wi.prototype,{createEdgeEndForNext:function(t,e,n,r){var i=n.segmentIndex+1;if(i>=t.getNumPoints()&&null===r)return null;var o=t.getCoordinate(i);null!==r&&r.segmentIndex===n.segmentIndex&&(o=r.coord);var a=new un(t,n.coord,o,new tn(t.getLabel()));e.add(a)},createEdgeEndForPrev:function(t,e,n,r){var i=n.segmentIndex;if(0===n.dist){if(0===i)return null;i--}var o=t.getCoordinate(i);null!==r&&r.segmentIndex>=i&&(o=r.coord);var a=new tn(t.getLabel());a.flip();var s=new un(t,n.coord,o,a);e.add(s)},computeEdgeEnds:function(){if(1===arguments.length){for(var t=arguments[0],e=new x,n=t;n.hasNext();){var r=n.next();this.computeEdgeEnds(r,e)}return e}if(2===arguments.length){var i=arguments[0],o=arguments[1],a=i.getEdgeIntersectionList();a.addEndpoints();var s=a.iterator(),u=null,c=null;if(!s.hasNext())return null;var l=s.next();do{u=c,c=l,l=null,s.hasNext()&&(l=s.next()),null!==c&&(this.createEdgeEndForPrev(i,o,c,u),this.createEdgeEndForNext(i,o,c,l))}while(null!==c)}},interfaces_:function(){return[]},getClass:function(){return wi}}),l(Ei,un),e(Ei.prototype,{insert:function(t){this.edgeEnds.add(t)},print:function(t){t.println("EdgeEndBundle--\x3e Label: "+this.label);for(var e=this.iterator();e.hasNext();)e.next().print(t),t.println()},iterator:function(){return this.edgeEnds.iterator()},getEdgeEnds:function(){return this.edgeEnds},computeLabelOn:function(t,e){for(var n=0,r=!1,i=this.iterator();i.hasNext();)(o=i.next().getLabel().getLocation(t))===P.BOUNDARY&&n++,o===P.INTERIOR&&(r=!0);var o=P.NONE;r&&(o=P.INTERIOR),n>0&&(o=Vn.determineBoundary(e,n)),this.label.setLocation(t,o)},computeLabelSide:function(t,e){for(var n=this.iterator();n.hasNext();){var r=n.next();if(r.getLabel().isArea()){var i=r.getLabel().getLocation(t,e);if(i===P.INTERIOR)return this.label.setLocation(t,e,P.INTERIOR),null;i===P.EXTERIOR&&this.label.setLocation(t,e,P.EXTERIOR)}}},getLabel:function(){return this.label},computeLabelSides:function(t){this.computeLabelSide(t,Qe.LEFT),this.computeLabelSide(t,Qe.RIGHT)},updateIM:function(t){zn.updateIM(this.label,t)},computeLabel:function(t){for(var e=!1,n=this.iterator();n.hasNext();)n.next().getLabel().isArea()&&(e=!0);this.label=e?new tn(P.NONE,P.NONE,P.NONE):new tn(P.NONE);for(var r=0;r<2;r++)this.computeLabelOn(r,t),e&&this.computeLabelSides(r)},interfaces_:function(){return[]},getClass:function(){return Ei}}),l(Si,yn),e(Si.prototype,{updateIM:function(t){for(var e=this.iterator();e.hasNext();)e.next().updateIM(t)},insert:function(t){var e=this.edgeMap.get(t);null===e?(e=new Ei(t),this.insertEdgeEnd(t,e)):e.insert(t)},interfaces_:function(){return[]},getClass:function(){return Si}}),l(Oi,an),e(Oi.prototype,{updateIMFromEdges:function(t){this.edges.updateIM(t)},computeIM:function(t){t.setAtLeastIfValid(this.label.getLocation(0),this.label.getLocation(1),0)},interfaces_:function(){return[]},getClass:function(){return Oi}}),l(Pi,ln),e(Pi.prototype,{createNode:function(t){return new Oi(t,new Si)},interfaces_:function(){return[]},getClass:function(){return Pi}}),e(Ci.prototype,{insertEdgeEnds:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.nodes.add(n)}},getNodeIterator:function(){return this.nodes.iterator()},copyNodesAndLabels:function(t,e){for(var n=t.getNodeIterator();n.hasNext();){var r=n.next();this.nodes.addNode(r.getCoordinate()).setLabel(e,r.getLabel().getLocation(e))}},build:function(t){this.computeIntersectionNodes(t,0),this.copyNodesAndLabels(t,0);var e=(new wi).computeEdgeEnds(t.getEdgeIterator());this.insertEdgeEnds(e)},computeIntersectionNodes:function(t,e){for(var n=t.getEdgeIterator();n.hasNext();)for(var r=n.next(),i=r.getLabel().getLocation(e),o=r.getEdgeIntersectionList().iterator();o.hasNext();){var a=o.next(),s=this.nodes.addNode(a.coord);i===P.BOUNDARY?s.setLabelBoundary(e):s.getLabel().isNull(e)&&s.setLabel(e,P.INTERIOR)}},interfaces_:function(){return[]},getClass:function(){return Ci}}),e(Mi.prototype,{isNodeEdgeAreaLabelsConsistent:function(){for(var t=this.nodeGraph.getNodeIterator();t.hasNext();){var e=t.next();if(!e.getEdges().isAreaLabelsConsistent(this.geomGraph))return this.invalidPoint=e.getCoordinate().copy(),!1}return!0},getInvalidPoint:function(){return this.invalidPoint},hasDuplicateRings:function(){for(var t=this.nodeGraph.getNodeIterator();t.hasNext();)for(var e=t.next().getEdges().iterator();e.hasNext();){var n=e.next();if(n.getEdgeEnds().size()>1)return this.invalidPoint=n.getEdge().getCoordinate(0),!0}return!1},isNodeConsistentArea:function(){var t=this.geomGraph.computeSelfNodes(this.li,!0,!0);return t.hasProperIntersection()?(this.invalidPoint=t.getProperIntersectionPoint(),!1):(this.nodeGraph.build(this.geomGraph),this.isNodeEdgeAreaLabelsConsistent())},interfaces_:function(){return[]},getClass:function(){return Mi}}),e(Ii.prototype,{buildIndex:function(){this.index=new Ae;for(var t=0;t<this.rings.size();t++){var e=this.rings.get(t),n=e.getEnvelopeInternal();this.index.insert(n,e)}},getNestedPoint:function(){return this.nestedPt},isNonNested:function(){this.buildIndex();for(var t=0;t<this.rings.size();t++)for(var e=this.rings.get(t),n=e.getCoordinates(),r=this.index.query(e.getEnvelopeInternal()),i=0;i<r.size();i++){var o=r.get(i),a=o.getCoordinates();if(e!==o&&e.getEnvelopeInternal().intersects(o.getEnvelopeInternal())){var s=Ti.findPtNotNode(n,o,this.graph);if(null!==s&&$t.isPointInRing(s,a))return this.nestedPt=s,!1}}return!0},add:function(t){this.rings.add(t),this.totalEnv.expandToInclude(t.getEnvelopeInternal())},interfaces_:function(){return[]},getClass:function(){return Ii}}),e(Ai.prototype,{getErrorType:function(){return this.errorType},getMessage:function(){return Ai.errMsg[this.errorType]},getCoordinate:function(){return this.pt},toString:function(){var t="";return null!==this.pt&&(t=" at or near point "+this.pt),this.getMessage()+t},interfaces_:function(){return[]},getClass:function(){return Ai}}),Ai.ERROR=0,Ai.REPEATED_POINT=1,Ai.HOLE_OUTSIDE_SHELL=2,Ai.NESTED_HOLES=3,Ai.DISCONNECTED_INTERIOR=4,Ai.SELF_INTERSECTION=5,Ai.RING_SELF_INTERSECTION=6,Ai.NESTED_SHELLS=7,Ai.DUPLICATE_RINGS=8,Ai.TOO_FEW_POINTS=9,Ai.INVALID_COORDINATE=10,Ai.RING_NOT_CLOSED=11,Ai.errMsg=["Topology Validation Error","Repeated Point","Hole lies outside shell","Holes are nested","Interior is disconnected","Self-intersection","Ring Self-intersection","Nested shells","Duplicate Rings","Too few distinct points in geometry component","Invalid Coordinate","Ring is not closed"],e(Ti.prototype,{checkInvalidCoordinates:function(){if(arguments[0]instanceof Array){for(var t=arguments[0],e=0;e<t.length;e++)if(!Ti.isValid(t[e]))return this.validErr=new Ai(Ai.INVALID_COORDINATE,t[e]),null}else if(arguments[0]instanceof Ct){var n=arguments[0];if(this.checkInvalidCoordinates(n.getExteriorRing().getCoordinates()),null!==this.validErr)return null;for(e=0;e<n.getNumInteriorRing();e++)if(this.checkInvalidCoordinates(n.getInteriorRingN(e).getCoordinates()),null!==this.validErr)return null}},checkHolesNotNested:function(t,e){for(var n=new Ii(e),r=0;r<t.getNumInteriorRing();r++){var i=t.getInteriorRingN(r);n.add(i)}n.isNonNested()||(this.validErr=new Ai(Ai.NESTED_HOLES,n.getNestedPoint()))},checkConsistentArea:function(t){var e=new Mi(t);return e.isNodeConsistentArea()?void(e.hasDuplicateRings()&&(this.validErr=new Ai(Ai.DUPLICATE_RINGS,e.getInvalidPoint()))):(this.validErr=new Ai(Ai.SELF_INTERSECTION,e.getInvalidPoint()),null)},isValid:function(){return this.checkValid(this.parentGeometry),null===this.validErr},checkShellInsideHole:function(t,e,n){var r=t.getCoordinates(),i=e.getCoordinates(),o=Ti.findPtNotNode(r,e,n);if(null!==o&&!$t.isPointInRing(o,i))return o;var a=Ti.findPtNotNode(i,t,n);return null!==a?$t.isPointInRing(a,r)?a:null:(h.shouldNeverReachHere("points in shell and hole appear to be equal"),null)},checkNoSelfIntersectingRings:function(t){for(var e=t.getEdgeIterator();e.hasNext();){var n=e.next();if(this.checkNoSelfIntersectingRing(n.getEdgeIntersectionList()),null!==this.validErr)return null}},checkConnectedInteriors:function(t){var e=new xi(t);e.isInteriorsConnected()||(this.validErr=new Ai(Ai.DISCONNECTED_INTERIOR,e.getCoordinate()))},checkNoSelfIntersectingRing:function(t){for(var e=new st,n=!0,r=t.iterator();r.hasNext();){var i=r.next();if(n)n=!1;else{if(e.contains(i.coord))return this.validErr=new Ai(Ai.RING_SELF_INTERSECTION,i.coord),null;e.add(i.coord)}}},checkHolesInShell:function(t,e){for(var n=t.getExteriorRing(),r=new ur(n),i=0;i<t.getNumInteriorRing();i++){var o=t.getInteriorRingN(i),a=Ti.findPtNotNode(o.getCoordinates(),n,e);if(null===a)return null;if(!r.isInside(a))return this.validErr=new Ai(Ai.HOLE_OUTSIDE_SHELL,a),null}},checkTooFewPoints:function(t){if(t.hasTooFewPoints())return this.validErr=new Ai(Ai.TOO_FEW_POINTS,t.getInvalidPoint()),null},getValidationError:function(){return this.checkValid(this.parentGeometry),this.validErr},checkValid:function(){if(arguments[0]instanceof Ot){var t=arguments[0];this.checkInvalidCoordinates(t.getCoordinates())}else if(arguments[0]instanceof Mt){var e=arguments[0];this.checkInvalidCoordinates(e.getCoordinates())}else if(arguments[0]instanceof It){var n=arguments[0];if(this.checkInvalidCoordinates(n.getCoordinates()),null!==this.validErr)return null;if(this.checkClosedRing(n),null!==this.validErr)return null;var r=new Vn(0,n);if(this.checkTooFewPoints(r),null!==this.validErr)return null;var i=new Kt;r.computeSelfNodes(i,!0,!0),this.checkNoSelfIntersectingRings(r)}else if(arguments[0]instanceof Et){var o=arguments[0];if(this.checkInvalidCoordinates(o.getCoordinates()),null!==this.validErr)return null;r=new Vn(0,o),this.checkTooFewPoints(r)}else if(arguments[0]instanceof Ct){var a=arguments[0];if(this.checkInvalidCoordinates(a),null!==this.validErr)return null;if(this.checkClosedRings(a),null!==this.validErr)return null;if(r=new Vn(0,a),this.checkTooFewPoints(r),null!==this.validErr)return null;if(this.checkConsistentArea(r),null!==this.validErr)return null;if(!this.isSelfTouchingRingFormingHoleValid&&(this.checkNoSelfIntersectingRings(r),null!==this.validErr))return null;if(this.checkHolesInShell(a,r),null!==this.validErr)return null;if(this.checkHolesNotNested(a,r),null!==this.validErr)return null;this.checkConnectedInteriors(r)}else if(arguments[0]instanceof At){for(var s=arguments[0],u=0;u<s.getNumGeometries();u++){var c=s.getGeometryN(u);if(this.checkInvalidCoordinates(c),null!==this.validErr)return null;if(this.checkClosedRings(c),null!==this.validErr)return null}if(r=new Vn(0,s),this.checkTooFewPoints(r),null!==this.validErr)return null;if(this.checkConsistentArea(r),null!==this.validErr)return null;if(!this.isSelfTouchingRingFormingHoleValid&&(this.checkNoSelfIntersectingRings(r),null!==this.validErr))return null;for(u=0;u<s.getNumGeometries();u++)if(c=s.getGeometryN(u),this.checkHolesInShell(c,r),null!==this.validErr)return null;for(u=0;u<s.getNumGeometries();u++)if(c=s.getGeometryN(u),this.checkHolesNotNested(c,r),null!==this.validErr)return null;if(this.checkShellsNotNested(s,r),null!==this.validErr)return null;this.checkConnectedInteriors(r)}else if(arguments[0]instanceof ht){var l=arguments[0];for(u=0;u<l.getNumGeometries();u++){var f=l.getGeometryN(u);if(this.checkValid(f),null!==this.validErr)return null}}else if(arguments[0]instanceof B){var h=arguments[0];if(this.validErr=null,h.isEmpty())return null;if(h instanceof Ot)this.checkValid(h);else if(h instanceof Mt)this.checkValid(h);else if(h instanceof It)this.checkValid(h);else if(h instanceof Et)this.checkValid(h);else if(h instanceof Ct)this.checkValid(h);else if(h instanceof At)this.checkValid(h);else{if(!(h instanceof ht))throw new UnsupportedOperationException(h.getClass().getName());this.checkValid(h)}}},setSelfTouchingRingFormingHoleValid:function(t){this.isSelfTouchingRingFormingHoleValid=t},checkShellNotNested:function(t,e,n){var r=t.getCoordinates(),i=e.getExteriorRing(),o=i.getCoordinates(),a=Ti.findPtNotNode(r,i,n);if(null===a)return null;if(!$t.isPointInRing(a,o))return null;if(e.getNumInteriorRing()<=0)return this.validErr=new Ai(Ai.NESTED_SHELLS,a),null;for(var s=null,u=0;u<e.getNumInteriorRing();u++){var c=e.getInteriorRingN(u);if(null===(s=this.checkShellInsideHole(t,c,n)))return null}this.validErr=new Ai(Ai.NESTED_SHELLS,s)},checkClosedRings:function(t){if(this.checkClosedRing(t.getExteriorRing()),null!==this.validErr)return null;for(var e=0;e<t.getNumInteriorRing();e++)if(this.checkClosedRing(t.getInteriorRingN(e)),null!==this.validErr)return null},checkClosedRing:function(t){if(!t.isClosed()){var e=null;t.getNumPoints()>=1&&(e=t.getCoordinateN(0)),this.validErr=new Ai(Ai.RING_NOT_CLOSED,e)}},checkShellsNotNested:function(t,e){for(var n=0;n<t.getNumGeometries();n++)for(var r=t.getGeometryN(n).getExteriorRing(),i=0;i<t.getNumGeometries();i++)if(n!==i){var o=t.getGeometryN(i);if(this.checkShellNotNested(r,o,e),null!==this.validErr)return null}},interfaces_:function(){return[]},getClass:function(){return Ti}}),Ti.findPtNotNode=function(t,e,n){for(var r=n.findEdge(e).getEdgeIntersectionList(),i=0;i<t.length;i++){var o=t[i];if(!r.isIntersection(o))return o}return null},Ti.isValid=function(){if(arguments[0]instanceof B){var t=arguments[0],e=new Ti(t);return e.isValid()}if(arguments[0]instanceof d){var n=arguments[0];return!(i.isNaN(n.x)||i.isInfinite(n.x)||i.isNaN(n.y)||i.isInfinite(n.y))}},e(Ni.prototype,{isIncluded:function(){return this._isIncluded},getCoordinates:function(){if(null===this.ringPts){for(var t=new w,e=this.deList.iterator();e.hasNext();){var n=e.next(),r=n.getEdge();Ni.addEdge(r.getLine().getCoordinates(),n.getEdgeDirection(),t)}this.ringPts=t.toCoordinateArray()}return this.ringPts},isIncludedSet:function(){return this._isIncludedSet},isValid:function(){return this.getCoordinates(),!(this.ringPts.length<=3)&&(this.getRing(),Ti.isValid(this.ring))},build:function(t){var e=t;do{this.add(e),e.setRing(this),e=e.getNext(),h.isTrue(null!==e,"found null DE in ring"),h.isTrue(e===t||!e.isInRing(),"found DE already in ring")}while(e!==t)},isOuterHole:function(){return!!this._isHole&&!this.hasShell()},getPolygon:function(){var t=null;if(null!==this.holes){t=new Array(this.holes.size()).fill(null);for(var e=0;e<this.holes.size();e++)t[e]=this.holes.get(e)}return this.factory.createPolygon(this.ring,t)},isHole:function(){return this._isHole},isProcessed:function(){return this._isProcessed},addHole:function(){if(arguments[0]instanceof It){var t=arguments[0];null===this.holes&&(this.holes=new x),this.holes.add(t)}else if(arguments[0]instanceof Ni){var e=arguments[0];e.setShell(this);var n=e.getRing();null===this.holes&&(this.holes=new x),this.holes.add(n)}},setIncluded:function(t){this._isIncluded=t,this._isIncludedSet=!0},getOuterHole:function(){if(this.isHole())return null;for(var t=0;t<this.deList.size();t++){var e=this.deList.get(t).getSym().getRing();if(e.isOuterHole())return e}return null},computeHole:function(){var t=this.getRing();this._isHole=$t.isCCW(t.getCoordinates())},hasShell:function(){return null!==this.shell},isOuterShell:function(){return null!==this.getOuterHole()},getLineString:function(){return this.getCoordinates(),this.factory.createLineString(this.ringPts)},toString:function(){return Yt.toLineString(new jt(this.getCoordinates()))},getShell:function(){return this.isHole()?this.shell:this},add:function(t){this.deList.add(t)},getRing:function(){if(null!==this.ring)return this.ring;this.getCoordinates(),this.ringPts.length<3&&k.out.println(this.ringPts);try{this.ring=this.factory.createLinearRing(this.ringPts)}catch(t){if(!(t instanceof S))throw t;k.out.println(this.ringPts)}return this.ring},updateIncluded:function(){if(this.isHole())return null;for(var t=0;t<this.deList.size();t++){var e=this.deList.get(t).getSym().getRing().getShell();if(null!==e&&e.isIncludedSet())return this.setIncluded(!e.isIncluded()),null}},setShell:function(t){this.shell=t},setProcessed:function(t){this._isProcessed=t},interfaces_:function(){return[]},getClass:function(){return Ni}}),Ni.findDirEdgesInRing=function(t){var e=t,n=new x;do{n.add(e),e=e.getNext(),h.isTrue(null!==e,"found null DE in ring"),h.isTrue(e===t||!e.isInRing(),"found DE already in ring")}while(e!==t);return n},Ni.addEdge=function(t,e,n){if(e)for(var r=0;r<t.length;r++)n.add(t[r],!1);else for(r=t.length-1;r>=0;r--)n.add(t[r],!1)},Ni.findEdgeRingContaining=function(t,e){for(var n=t.getRing(),r=n.getEnvelopeInternal(),i=n.getCoordinateN(0),o=null,a=null,s=e.iterator();s.hasNext();){var u=s.next(),c=u.getRing(),l=c.getEnvelopeInternal();if(!l.equals(r)&&l.contains(r)){i=X.ptNotInList(n.getCoordinates(),c.getCoordinates());var f=!1;$t.isPointInRing(i,c.getCoordinates())&&(f=!0),f&&(null===o||a.contains(l))&&(a=(o=u).getRing().getEnvelopeInternal())}}return o},e(Li.prototype,{compare:function(t,e){var n=e;return t.getRing().getEnvelope().compareTo(n.getRing().getEnvelope())},interfaces_:function(){return[s]},getClass:function(){return Li}}),Ni.EnvelopeComparator=Li,l(Ri,vi),e(Ri.prototype,{findEdgeRing:function(t){var e=new Ni(this.factory);return e.build(t),e},computeDepthParity:function(){if(0===arguments.length)for(;;){var t=null;if(null===t)return null;this.computeDepthParity(t)}else 1===arguments.length&&arguments[0]},computeNextCWEdges:function(){for(var t=this.nodeIterator();t.hasNext();){var e=t.next();Ri.computeNextCWEdges(e)}},addEdge:function(t){if(t.isEmpty())return null;var e=X.removeRepeatedPoints(t.getCoordinates());if(e.length<2)return null;var n=e[0],r=e[e.length-1],i=this.getNode(n),o=this.getNode(r),a=new bi(i,o,e[1],!0),s=new bi(o,i,e[e.length-2],!1),u=new _i(t);u.setDirectedEdges(a,s),this.add(u)},deleteCutEdges:function(){this.computeNextCWEdges(),Ri.findLabeledEdgeRings(this.dirEdges);for(var t=new x,e=this.dirEdges.iterator();e.hasNext();){var n=e.next();if(!n.isMarked()){var r=n.getSym();if(n.getLabel()===r.getLabel()){n.setMarked(!0),r.setMarked(!0);var i=n.getEdge();t.add(i.getLine())}}}return t},getEdgeRings:function(){this.computeNextCWEdges(),Ri.label(this.dirEdges,-1);var t=Ri.findLabeledEdgeRings(this.dirEdges);this.convertMaximalToMinimalEdgeRings(t);for(var e=new x,n=this.dirEdges.iterator();n.hasNext();){var r=n.next();if(!r.isMarked()&&!r.isInRing()){var i=this.findEdgeRing(r);e.add(i)}}return e},getNode:function(t){var e=this.findNode(t);return null===e&&(e=new di(t),this.add(e)),e},convertMaximalToMinimalEdgeRings:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),r=n.getLabel(),i=Ri.findIntersectionNodes(n,r);if(null!==i)for(var o=i.iterator();o.hasNext();){var a=o.next();Ri.computeNextCCWEdges(a,r)}}},deleteDangles:function(){for(var t=this.findNodesOfDegree(1),e=new Q,n=new ie,r=t.iterator();r.hasNext();)n.push(r.next());for(;!n.isEmpty();){var i=n.pop();for(Ri.deleteAllEdges(i),r=i.getOutEdges().getEdges().iterator();r.hasNext();){var o=r.next();o.setMarked(!0);var a=o.getSym();null!==a&&a.setMarked(!0);var s=o.getEdge();e.add(s.getLine());var u=o.getToNode();1===Ri.getDegreeNonDeleted(u)&&n.push(u)}}return e},interfaces_:function(){return[]},getClass:function(){return Ri}}),Ri.findLabeledEdgeRings=function(t){for(var e=new x,n=1,r=t.iterator();r.hasNext();){var i=r.next();if(!(i.isMarked()||i.getLabel()>=0)){e.add(i);var o=Ni.findDirEdgesInRing(i);Ri.label(o,n),n++}}return e},Ri.getDegreeNonDeleted=function(t){for(var e=0,n=t.getOutEdges().getEdges().iterator();n.hasNext();)n.next().isMarked()||e++;return e},Ri.deleteAllEdges=function(t){for(var e=t.getOutEdges().getEdges().iterator();e.hasNext();){var n=e.next();n.setMarked(!0);var r=n.getSym();null!==r&&r.setMarked(!0)}},Ri.label=function(t,e){for(var n=t.iterator();n.hasNext();)n.next().setLabel(e)},Ri.computeNextCWEdges=function(t){for(var e=null,n=null,r=t.getOutEdges().getEdges().iterator();r.hasNext();){var i=r.next();i.isMarked()||(null===e&&(e=i),null!==n&&n.getSym().setNext(i),n=i)}null!==n&&n.getSym().setNext(e)},Ri.computeNextCCWEdges=function(t,e){for(var n=null,r=null,i=t.getOutEdges().getEdges(),o=i.size()-1;o>=0;o--){var a=i.get(o),s=a.getSym(),u=null;a.getLabel()===e&&(u=a);var c=null;s.getLabel()===e&&(c=s),null===u&&null===c||(null!==c&&(r=c),null!==u&&(null!==r&&(r.setNext(u),r=null),null===n&&(n=u)))}null!==r&&(h.isTrue(null!==n),r.setNext(n))},Ri.getDegree=function(t,e){for(var n=0,r=t.getOutEdges().getEdges().iterator();r.hasNext();)r.next().getLabel()===e&&n++;return n},Ri.findIntersectionNodes=function(t,e){var n=t,r=null;do{var i=n.getFromNode();Ri.getDegree(i,e)>1&&(null===r&&(r=new x),r.add(i)),n=n.getNext(),h.isTrue(null!==n,"found null DE in ring"),h.isTrue(n===t||!n.isInRing(),"found DE already in ring")}while(n!==t);return r},e(ki.prototype,{getGeometry:function(){return null===this.geomFactory&&(this.geomFactory=new Xt),this.polygonize(),this.extractOnlyPolygonal?this.geomFactory.buildGeometry(this.polyList):this.geomFactory.createGeometryCollection(Xt.toGeometryArray(this.polyList))},getInvalidRingLines:function(){return this.polygonize(),this.invalidRingLines},findValidRings:function(t,e,n){for(var r=t.iterator();r.hasNext();){var i=r.next();i.isValid()?e.add(i):n.add(i.getLineString())}},polygonize:function(){if(null!==this.polyList)return null;if(this.polyList=new x,null===this.graph)return null;this.dangles=this.graph.deleteDangles(),this.cutEdges=this.graph.deleteCutEdges();var t=this.graph.getEdgeRings(),e=new x;this.invalidRingLines=new x,this.isCheckingRingsValid?this.findValidRings(t,e,this.invalidRingLines):e=t,this.findShellsAndHoles(e),ki.assignHolesToShells(this.holeList,this.shellList),Jo.sort(this.shellList,new Ni.EnvelopeComparator);var n=!0;this.extractOnlyPolygonal&&(ki.findDisjointShells(this.shellList),n=!1),this.polyList=ki.extractPolygons(this.shellList,n)},getDangles:function(){return this.polygonize(),this.dangles},getCutEdges:function(){return this.polygonize(),this.cutEdges},getPolygons:function(){return this.polygonize(),this.polyList},add:function(){if(C(arguments[0],v))for(var t=arguments[0],e=t.iterator();e.hasNext();){var n=e.next();this.add(n)}else if(arguments[0]instanceof Et){var r=arguments[0];this.geomFactory=r.getFactory(),null===this.graph&&(this.graph=new Ri(this.geomFactory)),this.graph.addEdge(r)}else if(arguments[0]instanceof B){var i=arguments[0];i.apply(this.lineStringAdder)}},setCheckRingsValid:function(t){this.isCheckingRingsValid=t},findShellsAndHoles:function(t){this.holeList=new x,this.shellList=new x;for(var e=t.iterator();e.hasNext();){var n=e.next();n.computeHole(),n.isHole()?this.holeList.add(n):this.shellList.add(n)}},interfaces_:function(){return[]},getClass:function(){return ki}}),ki.findOuterShells=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),r=n.getOuterHole();null===r||r.isProcessed()||(n.setIncluded(!0),r.setProcessed(!0))}},ki.extractPolygons=function(t,e){for(var n=new x,r=t.iterator();r.hasNext();){var i=r.next();(e||i.isIncluded())&&n.add(i.getPolygon())}return n},ki.assignHolesToShells=function(t,e){for(var n=t.iterator();n.hasNext();){var r=n.next();ki.assignHoleToShell(r,e)}},ki.assignHoleToShell=function(t,e){var n=Ni.findEdgeRingContaining(t,e);null!==n&&n.addHole(t)},ki.findDisjointShells=function(t){ki.findOuterShells(t);var e=null;do{e=!1;for(var n=t.iterator();n.hasNext();){var r=n.next();r.isIncludedSet()||(r.updateIncluded(),r.isIncludedSet()||(e=!0))}}while(e)},e(ji.prototype,{filter:function(t){t instanceof Et&&this.p.add(t)},interfaces_:function(){return[D]},getClass:function(){return ji}}),ki.LineStringAdder=ji;var pa=Object.freeze({Polygonizer:ki});e(Fi.prototype,{insertEdgeEnds:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.nodes.add(n)}},computeProperIntersectionIM:function(t,e){var n=this.arg[0].getGeometry().getDimension(),r=this.arg[1].getGeometry().getDimension(),i=t.hasProperIntersection(),o=t.hasProperInteriorIntersection();2===n&&2===r?i&&e.setAtLeast("212101212"):2===n&&1===r?(i&&e.setAtLeast("FFF0FFFF2"),o&&e.setAtLeast("1FFFFF1FF")):1===n&&2===r?(i&&e.setAtLeast("F0FFFFFF2"),o&&e.setAtLeast("1F1FFFFFF")):1===n&&1===r&&o&&e.setAtLeast("0FFFFFFFF")},labelIsolatedEdges:function(t,e){for(var n=this.arg[t].getEdgeIterator();n.hasNext();){var r=n.next();r.isIsolated()&&(this.labelIsolatedEdge(r,e,this.arg[e].getGeometry()),this.isolatedEdges.add(r))}},labelIsolatedEdge:function(t,e,n){if(n.getDimension()>0){var r=this.ptLocator.locate(t.getCoordinate(),n);t.getLabel().setAllLocations(e,r)}else t.getLabel().setAllLocations(e,P.EXTERIOR)},computeIM:function(){var t=new ee;if(t.set(P.EXTERIOR,P.EXTERIOR,2),!this.arg[0].getGeometry().getEnvelopeInternal().intersects(this.arg[1].getGeometry().getEnvelopeInternal()))return this.computeDisjointIM(t),t;this.arg[0].computeSelfNodes(this.li,!1),this.arg[1].computeSelfNodes(this.li,!1);var e=this.arg[0].computeEdgeIntersections(this.arg[1],this.li,!1);this.computeIntersectionNodes(0),this.computeIntersectionNodes(1),this.copyNodesAndLabels(0),this.copyNodesAndLabels(1),this.labelIsolatedNodes(),this.computeProperIntersectionIM(e,t);var n=new wi,r=n.computeEdgeEnds(this.arg[0].getEdgeIterator());this.insertEdgeEnds(r);var i=n.computeEdgeEnds(this.arg[1].getEdgeIterator());return this.insertEdgeEnds(i),this.labelNodeEdges(),this.labelIsolatedEdges(0,1),this.labelIsolatedEdges(1,0),this.updateIM(t),t},labelNodeEdges:function(){for(var t=this.nodes.iterator();t.hasNext();)t.next().getEdges().computeLabelling(this.arg)},copyNodesAndLabels:function(t){for(var e=this.arg[t].getNodeIterator();e.hasNext();){var n=e.next();this.nodes.addNode(n.getCoordinate()).setLabel(t,n.getLabel().getLocation(t))}},labelIntersectionNodes:function(t){for(var e=this.arg[t].getEdgeIterator();e.hasNext();)for(var n=e.next(),r=n.getLabel().getLocation(t),i=n.getEdgeIntersectionList().iterator();i.hasNext();){var o=i.next(),a=this.nodes.find(o.coord);a.getLabel().isNull(t)&&(r===P.BOUNDARY?a.setLabelBoundary(t):a.setLabel(t,P.INTERIOR))}},labelIsolatedNode:function(t,e){var n=this.ptLocator.locate(t.getCoordinate(),this.arg[e].getGeometry());t.getLabel().setAllLocations(e,n)},computeIntersectionNodes:function(t){for(var e=this.arg[t].getEdgeIterator();e.hasNext();)for(var n=e.next(),r=n.getLabel().getLocation(t),i=n.getEdgeIntersectionList().iterator();i.hasNext();){var o=i.next(),a=this.nodes.addNode(o.coord);r===P.BOUNDARY?a.setLabelBoundary(t):a.getLabel().isNull(t)&&a.setLabel(t,P.INTERIOR)}},labelIsolatedNodes:function(){for(var t=this.nodes.iterator();t.hasNext();){var e=t.next(),n=e.getLabel();h.isTrue(n.getGeometryCount()>0,"node with empty label found"),e.isIsolated()&&(n.isNull(0)?this.labelIsolatedNode(e,0):this.labelIsolatedNode(e,1))}},updateIM:function(t){for(var e=this.isolatedEdges.iterator();e.hasNext();)e.next().updateIM(t);for(var n=this.nodes.iterator();n.hasNext();){var r=n.next();r.updateIM(t),r.updateIMFromEdges(t)}},computeDisjointIM:function(t){var e=this.arg[0].getGeometry();e.isEmpty()||(t.set(P.INTERIOR,P.EXTERIOR,e.getDimension()),t.set(P.BOUNDARY,P.EXTERIOR,e.getBoundaryDimension()));var n=this.arg[1].getGeometry();n.isEmpty()||(t.set(P.EXTERIOR,P.INTERIOR,n.getDimension()),t.set(P.EXTERIOR,P.BOUNDARY,n.getBoundaryDimension()))},interfaces_:function(){return[]},getClass:function(){return Fi}}),e(Di.prototype,{isContainedInBoundary:function(t){if(t instanceof Ct)return!1;if(t instanceof Ot)return this.isPointContainedInBoundary(t);if(t instanceof Et)return this.isLineStringContainedInBoundary(t);for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);if(!this.isContainedInBoundary(n))return!1}return!0},isLineSegmentContainedInBoundary:function(t,e){if(t.equals(e))return this.isPointContainedInBoundary(t);if(t.x===e.x){if(t.x===this.rectEnv.getMinX()||t.x===this.rectEnv.getMaxX())return!0}else if(t.y===e.y&&(t.y===this.rectEnv.getMinY()||t.y===this.rectEnv.getMaxY()))return!0;return!1},isLineStringContainedInBoundary:function(t){for(var e=t.getCoordinateSequence(),n=new d,r=new d,i=0;i<e.size()-1;i++)if(e.getCoordinate(i,n),e.getCoordinate(i+1,r),!this.isLineSegmentContainedInBoundary(n,r))return!1;return!0},isPointContainedInBoundary:function(){if(arguments[0]instanceof Ot){var t=arguments[0];return this.isPointContainedInBoundary(t.getCoordinate())}if(arguments[0]instanceof d){var e=arguments[0];return e.x===this.rectEnv.getMinX()||e.x===this.rectEnv.getMaxX()||e.y===this.rectEnv.getMinY()||e.y===this.rectEnv.getMaxY()}},contains:function(t){return!!this.rectEnv.contains(t.getEnvelopeInternal())&&!this.isContainedInBoundary(t)},interfaces_:function(){return[]},getClass:function(){return Di}}),Di.contains=function(t,e){return new Di(t).contains(e)},e(Bi.prototype,{intersects:function(t,e){var n=new E(t,e);if(!this.rectEnv.intersects(n))return!1;if(this.rectEnv.intersects(t))return!0;if(this.rectEnv.intersects(e))return!0;if(t.compareTo(e)>0){var r=t;t=e,e=r}var i=!1;return e.y>t.y&&(i=!0),i?this.li.computeIntersection(t,e,this.diagDown0,this.diagDown1):this.li.computeIntersection(t,e,this.diagUp0,this.diagUp1),!!this.li.hasIntersection()},interfaces_:function(){return[]},getClass:function(){return Bi}}),e(zi.prototype,{applyTo:function(t){for(var e=0;e<t.getNumGeometries()&&!this._isDone;e++){var n=t.getGeometryN(e);if(n instanceof ht)this.applyTo(n);else if(this.visit(n),this.isDone())return this._isDone=!0,null}},interfaces_:function(){return[]},getClass:function(){return zi}}),e(Vi.prototype,{intersects:function(t){if(!this.rectEnv.intersects(t.getEnvelopeInternal()))return!1;var e=new Gi(this.rectEnv);if(e.applyTo(t),e.intersects())return!0;var n=new Ui(this.rectangle);if(n.applyTo(t),n.containsPoint())return!0;var r=new Wi(this.rectangle);return r.applyTo(t),!!r.intersects()},interfaces_:function(){return[]},getClass:function(){return Vi}}),Vi.intersects=function(t,e){return new Vi(t).intersects(e)},l(Gi,zi),e(Gi.prototype,{isDone:function(){return!0===this._intersects},visit:function(t){var e=t.getEnvelopeInternal();return this.rectEnv.intersects(e)?this.rectEnv.contains(e)||e.getMinX()>=this.rectEnv.getMinX()&&e.getMaxX()<=this.rectEnv.getMaxX()||e.getMinY()>=this.rectEnv.getMinY()&&e.getMaxY()<=this.rectEnv.getMaxY()?(this._intersects=!0,null):void 0:null},intersects:function(){return this._intersects},interfaces_:function(){return[]},getClass:function(){return Gi}}),l(Ui,zi),e(Ui.prototype,{isDone:function(){return!0===this._containsPoint},visit:function(t){if(!(t instanceof Ct))return null;var e=t.getEnvelopeInternal();if(!this.rectEnv.intersects(e))return null;for(var n=new d,r=0;r<4;r++)if(this.rectSeq.getCoordinate(r,n),e.contains(n)&&vn.containsPointInPolygon(n,t))return this._containsPoint=!0,null},containsPoint:function(){return this._containsPoint},interfaces_:function(){return[]},getClass:function(){return Ui}}),l(Wi,zi),e(Wi.prototype,{intersects:function(){return this.hasIntersection},isDone:function(){return!0===this.hasIntersection},visit:function(t){var e=t.getEnvelopeInternal();if(!this.rectEnv.intersects(e))return null;var n=An.getLines(t);this.checkIntersectionWithLineStrings(n)},checkIntersectionWithLineStrings:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();if(this.checkIntersectionWithSegments(n),this.hasIntersection)return null}},checkIntersectionWithSegments:function(t){for(var e=t.getCoordinateSequence(),n=1;n<e.size();n++)if(e.getCoordinate(n-1,this.p0),e.getCoordinate(n,this.p1),this.rectIntersector.intersects(this.p0,this.p1))return this.hasIntersection=!0,null},interfaces_:function(){return[]},getClass:function(){return Wi}}),l(qi,Gn),e(qi.prototype,{getIntersectionMatrix:function(){return this._relate.computeIM()},interfaces_:function(){return[]},getClass:function(){return qi}}),qi.covers=function(t,e){return!!t.getEnvelopeInternal().covers(e.getEnvelopeInternal())&&(!!t.isRectangle()||qi.relate(t,e).isCovers())},qi.intersects=function(t,e){return!!t.getEnvelopeInternal().intersects(e.getEnvelopeInternal())&&(t.isRectangle()?Vi.intersects(t,e):e.isRectangle()?Vi.intersects(e,t):qi.relate(t,e).isIntersects())},qi.touches=function(t,e){return!!t.getEnvelopeInternal().intersects(e.getEnvelopeInternal())&&qi.relate(t,e).isTouches(t.getDimension(),e.getDimension())},qi.within=function(t,e){return e.contains(t)},qi.coveredBy=function(t,e){return qi.covers(e,t)},qi.relate=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return new qi(t,e).getIntersectionMatrix()}if(3===arguments.length){if("string"==typeof arguments[2]&&arguments[0]instanceof B&&arguments[1]instanceof B){var n=arguments[0],r=arguments[1],i=arguments[2];return qi.relateWithCheck(n,r).matches(i)}if(C(arguments[2],V)&&arguments[0]instanceof B&&arguments[1]instanceof B){var o=arguments[0],a=arguments[1],s=arguments[2];return new qi(o,a,s).getIntersectionMatrix()}}},qi.overlaps=function(t,e){return!!t.getEnvelopeInternal().intersects(e.getEnvelopeInternal())&&qi.relate(t,e).isOverlaps(t.getDimension(),e.getDimension())},qi.disjoint=function(t,e){return!t.intersects(e)},qi.relateWithCheck=function(t,e){return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),qi.relate(t,e)},qi.crosses=function(t,e){return!!t.getEnvelopeInternal().intersects(e.getEnvelopeInternal())&&qi.relate(t,e).isCrosses(t.getDimension(),e.getDimension())},qi.contains=function(t,e){return!!t.getEnvelopeInternal().contains(e.getEnvelopeInternal())&&(t.isRectangle()?Di.contains(t,e):qi.relate(t,e).isContains())};var ga=Object.freeze({RelateOp:qi});e(Xi.prototype,{extractElements:function(t,e){if(null===t)return null;for(var n=0;n<t.getNumGeometries();n++){var r=t.getGeometryN(n);this.skipEmpty&&r.isEmpty()||e.add(r)}},combine:function(){for(var t=new x,e=this.inputGeoms.iterator();e.hasNext();){var n=e.next();this.extractElements(n,t)}return 0===t.size()?null!==this.geomFactory?this.geomFactory.createGeometryCollection(null):null:this.geomFactory.buildGeometry(t)},interfaces_:function(){return[]},getClass:function(){return Xi}}),Xi.combine=function(){if(1===arguments.length){var t=arguments[0];return new Xi(t).combine()}if(2===arguments.length){var e=arguments[0],n=arguments[1];return new Xi(Xi.createList(e,n)).combine()}if(3===arguments.length){var r=arguments[0],i=arguments[1],o=arguments[2];return new Xi(Xi.createList(r,i,o)).combine()}},Xi.extractFactory=function(t){return t.isEmpty()?null:t.iterator().next().getFactory()},Xi.createList=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return(n=new x).add(t),n.add(e),n}if(3===arguments.length){var n,r=arguments[0],i=arguments[1],o=arguments[2];return(n=new x).add(r),n.add(i),n.add(o),n}},e(Hi.prototype,{union:function(){for(var t=new ye,e=new st,n=0;n<this.pointGeom.getNumGeometries();n++){var r=this.pointGeom.getGeometryN(n).getCoordinate();t.locate(r,this.otherGeom)===P.EXTERIOR&&e.add(r)}if(0===e.size())return this.otherGeom;var i,o=X.toCoordinateArray(e);return i=1===o.length?this.geomFact.createPoint(o[0]):this.geomFact.createMultiPointFromCoords(o),Xi.combine(i,this.otherGeom)},interfaces_:function(){return[]},getClass:function(){return Hi}}),Hi.union=function(t,e){return new Hi(t,e).union()},e(Yi.prototype,{filter:function(t){-1!==this.sortIndex&&t.getSortIndex()!==this.sortIndex||this.comps.add(t)},interfaces_:function(){return[lt]},getClass:function(){return Yi}}),Yi.extract=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return Yi.extract(t,e,new x)}if(3===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2];return n.getSortIndex()===r?i.add(n):n instanceof ht&&n.apply(new Yi(r,i)),i}},e(Zi.prototype,{reduceToGeometries:function(t){for(var e=new x,n=t.iterator();n.hasNext();){var r=n.next(),i=null;C(r,m)?i=this.unionTree(r):r instanceof B&&(i=r),e.add(i)}return e},extractByEnvelope:function(t,e,n){for(var r=new x,i=0;i<e.getNumGeometries();i++){var o=e.getGeometryN(i);o.getEnvelopeInternal().intersects(t)?r.add(o):n.add(o)}return this.geomFactory.buildGeometry(r)},unionOptimized:function(t,e){var n=t.getEnvelopeInternal(),r=e.getEnvelopeInternal();if(!n.intersects(r))return Xi.combine(t,e);if(t.getNumGeometries()<=1&&e.getNumGeometries()<=1)return this.unionActual(t,e);var i=n.intersection(r);return this.unionUsingEnvelopeIntersection(t,e,i)},union:function(){if(null===this.inputPolys)throw new IllegalStateException("union() method cannot be called twice");if(this.inputPolys.isEmpty())return null;this.geomFactory=this.inputPolys.iterator().next().getFactory();for(var t=new Ae(Zi.STRTREE_NODE_CAPACITY),e=this.inputPolys.iterator();e.hasNext();){var n=e.next();t.insert(n.getEnvelopeInternal(),n)}this.inputPolys=null;var r=t.itemsTree();return this.unionTree(r)},binaryUnion:function(){if(1===arguments.length){var t=arguments[0];return this.binaryUnion(t,0,t.size())}if(3===arguments.length){var e=arguments[0],n=arguments[1],r=arguments[2];if(r-n<=1){var i=Zi.getGeometry(e,n);return this.unionSafe(i,null)}if(r-n==2)return this.unionSafe(Zi.getGeometry(e,n),Zi.getGeometry(e,n+1));var o=Math.trunc((r+n)/2),a=(i=this.binaryUnion(e,n,o),this.binaryUnion(e,o,r));return this.unionSafe(i,a)}},repeatedUnion:function(t){for(var e=null,n=t.iterator();n.hasNext();){var r=n.next();e=null===e?r.copy():e.union(r)}return e},unionSafe:function(t,e){return null===t&&null===e?null:null===t?e.copy():null===e?t.copy():this.unionOptimized(t,e)},unionActual:function(t,e){return Zi.restrictToPolygons(t.union(e))},unionTree:function(t){var e=this.reduceToGeometries(t);return this.binaryUnion(e)},unionUsingEnvelopeIntersection:function(t,e,n){var r=new x,i=this.extractByEnvelope(n,t,r),o=this.extractByEnvelope(n,e,r),a=this.unionActual(i,o);return r.add(a),Xi.combine(r)},bufferUnion:function(){if(1===arguments.length){var t=arguments[0];return t.get(0).getFactory().buildGeometry(t).buffer(0)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e.getFactory().createGeometryCollection([e,n]).buffer(0)}},interfaces_:function(){return[]},getClass:function(){return Zi}}),Zi.restrictToPolygons=function(t){if(C(t,Pt))return t;var e=ni.getPolygons(t);return 1===e.size()?e.get(0):t.getFactory().createMultiPolygon(Xt.toPolygonArray(e))},Zi.getGeometry=function(t,e){return e>=t.size()?null:t.get(e)},Zi.union=function(t){return new Zi(t).union()},Zi.STRTREE_NODE_CAPACITY=4,e(Ki.prototype,{unionNoOpt:function(t){var e=this.geomFact.createPoint();return Hn.overlayOp(t,e,qn.UNION)},unionWithNull:function(t,e){return null===t&&null===e?null:null===e?t:null===t?e:t.union(e)},extract:function(){if(C(arguments[0],v))for(var t=arguments[0],e=t.iterator();e.hasNext();){var n=e.next();this.extract(n)}else if(arguments[0]instanceof B){var r=arguments[0];null===this.geomFact&&(this.geomFact=r.getFactory()),Yi.extract(r,B.SORTINDEX_POLYGON,this.polygons),Yi.extract(r,B.SORTINDEX_LINESTRING,this.lines),Yi.extract(r,B.SORTINDEX_POINT,this.points)}},union:function(){if(null===this.geomFact)return null;var t=null;if(this.points.size()>0){var e=this.geomFact.buildGeometry(this.points);t=this.unionNoOpt(e)}var n=null;if(this.lines.size()>0){var r=this.geomFact.buildGeometry(this.lines);n=this.unionNoOpt(r)}var i=null;this.polygons.size()>0&&(i=Zi.union(this.polygons));var o=this.unionWithNull(n,i),a=null;return a=null===t?o:null===o?t:Hi.union(t,o),null===a?this.geomFact.createGeometryCollection():a},interfaces_:function(){return[]},getClass:function(){return Ki}}),Ki.union=function(){if(1===arguments.length){if(C(arguments[0],v)){var t=arguments[0];return new Ki(t).union()}if(arguments[0]instanceof B){var e=arguments[0];return new Ki(e).union()}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];return new Ki(n,r).union()}};var va=Object.freeze({UnaryUnionOp:Ki}),ya=Object.freeze({IsValidOp:Ti,ConsistentAreaTester:Mi}),ma=Object.freeze({BoundaryOp:pt,IsSimpleOp:Rr,buffer:la,distance:fa,linemerge:ha,overlay:da,polygonize:pa,relate:ga,union:va,valid:ya});l(Ji,Tt.CoordinateOperation),e(Ji.prototype,{editCoordinates:function(t,e){if(0===t.length)return null;for(var n=new Array(t.length).fill(null),r=0;r<t.length;r++){var i=new d(t[r]);this.targetPM.makePrecise(i),n[r]=i}var o=new w(n,!1).toCoordinateArray(),a=0;e instanceof Et&&(a=2),e instanceof It&&(a=4);var s=n;return this.removeCollapsed&&(s=null),o.length<a?s:o},interfaces_:function(){return[]},getClass:function(){return Ji}}),e(Qi.prototype,{fixPolygonalTopology:function(t){var e=t;this.changePrecisionModel||(e=this.changePM(t,this.targetPM));var n=e.buffer(0),r=n;return this.changePrecisionModel||(r=this.changePM(n,t.getPrecisionModel())),r},reducePointwise:function(t){var e=null;e=this.changePrecisionModel?new Tt(this.createFactory(t.getFactory(),this.targetPM)):new Tt;var n=this.removeCollapsed;return t.getDimension()>=2&&(n=!0),e.edit(t,new Ji(this.targetPM,n))},changePM:function(t,e){return this.createEditor(t.getFactory(),e).edit(t,new Tt.NoOpGeometryOperation)},setRemoveCollapsedComponents:function(t){this.removeCollapsed=t},createFactory:function(t,e){return new Xt(e,t.getSRID(),t.getCoordinateSequenceFactory())},setChangePrecisionModel:function(t){this.changePrecisionModel=t},reduce:function(t){var e=this.reducePointwise(t);return this.isPointwise?e:C(e,Pt)?e.isValid()?e:this.fixPolygonalTopology(e):e},setPointwise:function(t){this.isPointwise=t},createEditor:function(t,e){return t.getPrecisionModel()===e?new Tt:new Tt(this.createFactory(t,e))},interfaces_:function(){return[]},getClass:function(){return Qi}}),Qi.reduce=function(t,e){return new Qi(e).reduce(t)},Qi.reducePointwise=function(t,e){var n=new Qi(e);return n.setPointwise(!0),n.reduce(t)};var ba=Object.freeze({GeometryPrecisionReducer:Qi});e($i.prototype,{simplifySection:function(t,e){if(t+1===e)return null;this.seg.p0=this.pts[t],this.seg.p1=this.pts[e];for(var n=-1,r=t,i=t+1;i<e;i++){var o=this.seg.distance(this.pts[i]);o>n&&(n=o,r=i)}if(n<=this.distanceTolerance)for(i=t+1;i<e;i++)this.usePt[i]=!1;else this.simplifySection(t,r),this.simplifySection(r,e)},setDistanceTolerance:function(t){this.distanceTolerance=t},simplify:function(){this.usePt=new Array(this.pts.length).fill(null);for(var t=0;t<this.pts.length;t++)this.usePt[t]=!0;this.simplifySection(0,this.pts.length-1);var e=new w;for(t=0;t<this.pts.length;t++)this.usePt[t]&&e.add(new d(this.pts[t]));return e.toCoordinateArray()},interfaces_:function(){return[]},getClass:function(){return $i}}),$i.simplify=function(t,e){var n=new $i(t);return n.setDistanceTolerance(e),n.simplify()},e(to.prototype,{setEnsureValid:function(t){this.isEnsureValidTopology=t},getResultGeometry:function(){return this.inputGeom.isEmpty()?this.inputGeom.copy():new eo(this.isEnsureValidTopology,this.distanceTolerance).transform(this.inputGeom)},setDistanceTolerance:function(t){if(t<0)throw new r("Tolerance must be non-negative");this.distanceTolerance=t},interfaces_:function(){return[]},getClass:function(){return to}}),to.simplify=function(t,e){var n=new to(t);return n.setDistanceTolerance(e),n.getResultGeometry()},l(eo,ue),e(eo.prototype,{transformPolygon:function(t,e){if(t.isEmpty())return null;var n=ue.prototype.transformPolygon.call(this,t,e);return e instanceof At?n:this.createValidArea(n)},createValidArea:function(t){return this.isEnsureValidTopology?t.buffer(0):t},transformCoordinates:function(t,e){var n,r=t.toCoordinateArray();return n=0===r.length?new Array(0).fill(null):$i.simplify(r,this.distanceTolerance),this.factory.getCoordinateSequenceFactory().create(n)},transformMultiPolygon:function(t,e){var n=ue.prototype.transformMultiPolygon.call(this,t,e);return this.createValidArea(n)},transformLinearRing:function(t,e){var n=e instanceof Ct,r=ue.prototype.transformLinearRing.call(this,t,e);return!n||r instanceof It?r:null},interfaces_:function(){return[]},getClass:function(){return eo}}),to.DPTransformer=eo,l(no,te),e(no.prototype,{getIndex:function(){return this.index},getParent:function(){return this.parent},interfaces_:function(){return[]},getClass:function(){return no}}),e(ro.prototype,{addToResult:function(t){this.resultSegs.add(t)},asLineString:function(){return this.parentLine.getFactory().createLineString(ro.extractCoordinates(this.resultSegs))},getResultSize:function(){var t=this.resultSegs.size();return 0===t?0:t+1},getParent:function(){return this.parentLine},getSegment:function(t){return this.segs[t]},getParentCoordinates:function(){return this.parentLine.getCoordinates()},getMinimumSize:function(){return this.minimumSize},asLinearRing:function(){return this.parentLine.getFactory().createLinearRing(ro.extractCoordinates(this.resultSegs))},getSegments:function(){return this.segs},init:function(){var t=this.parentLine.getCoordinates();this.segs=new Array(t.length-1).fill(null);for(var e=0;e<t.length-1;e++){var n=new no(t[e],t[e+1],this.parentLine,e);this.segs[e]=n}},getResultCoordinates:function(){return ro.extractCoordinates(this.resultSegs)},interfaces_:function(){return[]},getClass:function(){return ro}}),ro.extractCoordinates=function(t){for(var e=new Array(t.size()+1).fill(null),n=null,r=0;r<t.size();r++)n=t.get(r),e[r]=n.p0;return e[e.length-1]=n.p1,e},e(io.prototype,{remove:function(t){this.index.remove(new E(t.p0,t.p1),t)},add:function(){if(arguments[0]instanceof ro)for(var t=arguments[0],e=t.getSegments(),n=0;n<e.length;n++){var r=e[n];this.add(r)}else if(arguments[0]instanceof te){var i=arguments[0];this.index.insert(new E(i.p0,i.p1),i)}},query:function(t){var e=new E(t.p0,t.p1),n=new oo(t);return this.index.query(e,n),n.getItems()},interfaces_:function(){return[]},getClass:function(){return io}}),e(oo.prototype,{visitItem:function(t){var e=t;E.intersects(e.p0,e.p1,this.querySeg.p0,this.querySeg.p1)&&this.items.add(t)},getItems:function(){return this.items},interfaces_:function(){return[Se]},getClass:function(){return oo}}),e(ao.prototype,{flatten:function(t,e){var n=new te(this.linePts[t],this.linePts[e]);return this.remove(this.line,t,e),this.outputIndex.add(n),n},hasBadIntersection:function(t,e,n){return!!this.hasBadOutputIntersection(n)||!!this.hasBadInputIntersection(t,e,n)},setDistanceTolerance:function(t){this.distanceTolerance=t},simplifySection:function(t,e,n){n+=1;var r=new Array(2).fill(null);if(t+1===e){var i=this.line.getSegment(t);return this.line.addToResult(i),null}var o=!0;this.line.getResultSize()<this.line.getMinimumSize()&&n+1<this.line.getMinimumSize()&&(o=!1);var a=new Array(1).fill(null),s=this.findFurthestPoint(this.linePts,t,e,a);a[0]>this.distanceTolerance&&(o=!1);var u=new te;if(u.p0=this.linePts[t],u.p1=this.linePts[e],r[0]=t,r[1]=e,this.hasBadIntersection(this.line,r,u)&&(o=!1),o)return i=this.flatten(t,e),this.line.addToResult(i),null;this.simplifySection(t,s,n),this.simplifySection(s,e,n)},hasBadOutputIntersection:function(t){for(var e=this.outputIndex.query(t).iterator();e.hasNext();){var n=e.next();if(this.hasInteriorIntersection(n,t))return!0}return!1},findFurthestPoint:function(t,e,n,r){var i=new te;i.p0=t[e],i.p1=t[n];for(var o=-1,a=e,s=e+1;s<n;s++){var u=t[s],c=i.distance(u);c>o&&(o=c,a=s)}return r[0]=o,a},simplify:function(t){this.line=t,this.linePts=t.getParentCoordinates(),this.simplifySection(0,this.linePts.length-1,0)},remove:function(t,e,n){for(var r=e;r<n;r++){var i=t.getSegment(r);this.inputIndex.remove(i)}},hasInteriorIntersection:function(t,e){return this.li.computeIntersection(t.p0,t.p1,e.p0,e.p1),this.li.isInteriorIntersection()},hasBadInputIntersection:function(t,e,n){for(var r=this.inputIndex.query(n).iterator();r.hasNext();){var i=r.next();if(this.hasInteriorIntersection(i,n)){if(ao.isInLineSection(t,e,i))continue;return!0}}return!1},interfaces_:function(){return[]},getClass:function(){return ao}}),ao.isInLineSection=function(t,e,n){if(n.getParent()!==t.getParent())return!1;var r=n.getIndex();return r>=e[0]&&r<e[1]},e(so.prototype,{setDistanceTolerance:function(t){this.distanceTolerance=t},simplify:function(t){for(var e=t.iterator();e.hasNext();)this.inputIndex.add(e.next());for(e=t.iterator();e.hasNext();){var n=new ao(this.inputIndex,this.outputIndex);n.setDistanceTolerance(this.distanceTolerance),n.simplify(e.next())}},interfaces_:function(){return[]},getClass:function(){return so}}),e(uo.prototype,{getResultGeometry:function(){return this.inputGeom.isEmpty()?this.inputGeom.copy():(this.linestringMap=new Ut,this.inputGeom.apply(new lo(this)),this.lineSimplifier.simplify(this.linestringMap.values()),new co(this.linestringMap).transform(this.inputGeom))},setDistanceTolerance:function(t){if(t<0)throw new r("Tolerance must be non-negative");this.lineSimplifier.setDistanceTolerance(t)},interfaces_:function(){return[]},getClass:function(){return uo}}),uo.simplify=function(t,e){var n=new uo(t);return n.setDistanceTolerance(e),n.getResultGeometry()},l(co,ue),e(co.prototype,{transformCoordinates:function(t,e){if(0===t.size())return null;if(e instanceof Et){var n=this.linestringMap.get(e);return this.createCoordinateSequence(n.getResultCoordinates())}return ue.prototype.transformCoordinates.call(this,t,e)},interfaces_:function(){return[]},getClass:function(){return co}}),e(lo.prototype,{filter:function(t){if(t instanceof Et){var e=t;if(e.isEmpty())return null;var n=e.isClosed()?4:2,r=new ro(e,n);this.tps.linestringMap.put(e,r)}},interfaces_:function(){return[D]},getClass:function(){return lo}}),uo.LineStringTransformer=co,uo.LineStringMapBuilderFilter=lo;var _a=Object.freeze({DouglasPeuckerSimplifier:to,TopologyPreservingSimplifier:uo});e(fo.prototype,{splitAt:function(){if(1===arguments.length){var t=arguments[0],e=this.minimumLen/this.segLen;if(t.distance(this.seg.p0)<this.minimumLen)return this.splitPt=this.seg.pointAlong(e),null;if(t.distance(this.seg.p1)<this.minimumLen)return this.splitPt=fo.pointAlongReverse(this.seg,e),null;this.splitPt=t}else if(2===arguments.length){var n=arguments[0],r=arguments[1],i=this.getConstrainedLength(n),o=i/this.segLen;r.equals2D(this.seg.p0)?this.splitPt=this.seg.pointAlong(o):this.splitPt=fo.pointAlongReverse(this.seg,o)}},setMinimumLength:function(t){this.minimumLen=t},getConstrainedLength:function(t){return t<this.minimumLen?this.minimumLen:t},getSplitPoint:function(){return this.splitPt},interfaces_:function(){return[]},getClass:function(){return fo}}),fo.pointAlongReverse=function(t,e){var n=new d;return n.x=t.p1.x-e*(t.p1.x-t.p0.x),n.y=t.p1.y-e*(t.p1.y-t.p0.y),n},e(ho.prototype,{findSplitPoint:function(t,e){},interfaces_:function(){return[]},getClass:function(){return ho}}),e(po.prototype,{findSplitPoint:function(t,e){var n=t.getLineSegment(),r=n.getLength()/2,i=new fo(n),o=po.projectedSplitPoint(t,e),a=2*o.distance(e)*.8;return a>r&&(a=r),i.setMinimumLength(a),i.splitAt(o),i.getSplitPoint()},interfaces_:function(){return[ho]},getClass:function(){return po}}),po.projectedSplitPoint=function(t,e){return t.getLineSegment().project(e)},e(go.prototype,{interfaces_:function(){return[]},getClass:function(){return go}}),go.triArea=function(t,e,n){return(e.x-t.x)*(n.y-t.y)-(e.y-t.y)*(n.x-t.x)},go.isInCircleDDNormalized=function(t,e,n,r){var i=N.valueOf(t.x).selfSubtract(r.x),o=N.valueOf(t.y).selfSubtract(r.y),a=N.valueOf(e.x).selfSubtract(r.x),s=N.valueOf(e.y).selfSubtract(r.y),u=N.valueOf(n.x).selfSubtract(r.x),c=N.valueOf(n.y).selfSubtract(r.y),l=i.multiply(s).selfSubtract(a.multiply(o)),f=a.multiply(c).selfSubtract(u.multiply(s)),h=u.multiply(o).selfSubtract(i.multiply(c)),d=i.multiply(i).selfAdd(o.multiply(o)),p=a.multiply(a).selfAdd(s.multiply(s)),g=u.multiply(u).selfAdd(c.multiply(c));return d.selfMultiply(f).selfAdd(p.selfMultiply(h)).selfAdd(g.selfMultiply(l)).doubleValue()>0},go.checkRobustInCircle=function(t,e,n,r){var i=go.isInCircleNonRobust(t,e,n,r),o=go.isInCircleDDSlow(t,e,n,r),a=go.isInCircleCC(t,e,n,r),s=fr.circumcentre(t,e,n);k.out.println("p radius diff a = "+Math.abs(r.distance(s)-t.distance(s))/t.distance(s)),i===o&&i===a||(k.out.println("inCircle robustness failure (double result = "+i+", DD result = "+o+", CC result = "+a+")"),k.out.println(Yt.toLineString(new jt([t,e,n,r]))),k.out.println("Circumcentre = "+Yt.toPoint(s)+" radius = "+t.distance(s)),k.out.println("p radius diff a = "+Math.abs(r.distance(s)/t.distance(s)-1)),k.out.println("p radius diff b = "+Math.abs(r.distance(s)/e.distance(s)-1)),k.out.println("p radius diff c = "+Math.abs(r.distance(s)/n.distance(s)-1)),k.out.println())},go.isInCircleDDFast=function(t,e,n,r){var i=N.sqr(t.x).selfAdd(N.sqr(t.y)).selfMultiply(go.triAreaDDFast(e,n,r)),o=N.sqr(e.x).selfAdd(N.sqr(e.y)).selfMultiply(go.triAreaDDFast(t,n,r)),a=N.sqr(n.x).selfAdd(N.sqr(n.y)).selfMultiply(go.triAreaDDFast(t,e,r)),s=N.sqr(r.x).selfAdd(N.sqr(r.y)).selfMultiply(go.triAreaDDFast(t,e,n));return i.selfSubtract(o).selfAdd(a).selfSubtract(s).doubleValue()>0},go.isInCircleCC=function(t,e,n,r){var i=fr.circumcentre(t,e,n),o=t.distance(i);return r.distance(i)-o<=0},go.isInCircleNormalized=function(t,e,n,r){var i=t.x-r.x,o=t.y-r.y,a=e.x-r.x,s=e.y-r.y,u=n.x-r.x,c=n.y-r.y;return(i*i+o*o)*(a*c-u*s)+(a*a+s*s)*(u*o-i*c)+(u*u+c*c)*(i*s-a*o)>0},go.isInCircleDDSlow=function(t,e,n,r){var i=N.valueOf(r.x),o=N.valueOf(r.y),a=N.valueOf(t.x),s=N.valueOf(t.y),u=N.valueOf(e.x),c=N.valueOf(e.y),l=N.valueOf(n.x),f=N.valueOf(n.y),h=a.multiply(a).add(s.multiply(s)).multiply(go.triAreaDDSlow(u,c,l,f,i,o)),d=u.multiply(u).add(c.multiply(c)).multiply(go.triAreaDDSlow(a,s,l,f,i,o)),p=l.multiply(l).add(f.multiply(f)).multiply(go.triAreaDDSlow(a,s,u,c,i,o)),g=i.multiply(i).add(o.multiply(o)).multiply(go.triAreaDDSlow(a,s,u,c,l,f));return h.subtract(d).add(p).subtract(g).doubleValue()>0},go.isInCircleNonRobust=function(t,e,n,r){return(t.x*t.x+t.y*t.y)*go.triArea(e,n,r)-(e.x*e.x+e.y*e.y)*go.triArea(t,n,r)+(n.x*n.x+n.y*n.y)*go.triArea(t,e,r)-(r.x*r.x+r.y*r.y)*go.triArea(t,e,n)>0},go.isInCircleRobust=function(t,e,n,r){return go.isInCircleNormalized(t,e,n,r)},go.triAreaDDSlow=function(t,e,n,r,i,o){return n.subtract(t).multiply(o.subtract(e)).subtract(r.subtract(e).multiply(i.subtract(t)))},go.triAreaDDFast=function(t,e,n){var r=N.valueOf(e.x).selfSubtract(t.x).selfMultiply(N.valueOf(n.y).selfSubtract(t.y)),i=N.valueOf(e.y).selfSubtract(t.y).selfMultiply(N.valueOf(n.x).selfSubtract(t.x));return r.selfSubtract(i)},e(vo.prototype,{circleCenter:function(t,e){var n,r=new vo(this.getX(),this.getY()),i=new j(this.bisector(r,t),this.bisector(t,e)),o=null;try{o=new vo(i.getX(),i.getY())}catch(n){if(!(n instanceof O))throw n;k.err.println("a: "+r+"  b: "+t+"  c: "+e),k.err.println(n)}return o},dot:function(t){return this.p.x*t.getX()+this.p.y*t.getY()},magn:function(){return Math.sqrt(this.p.x*this.p.x+this.p.y*this.p.y)},getZ:function(){return this.p.z},bisector:function(t,e){var n=e.getX()-t.getX(),r=e.getY()-t.getY(),i=new j(t.getX()+n/2,t.getY()+r/2,1),o=new j(t.getX()-r+n/2,t.getY()+n+r/2,1);return new j(i,o)},equals:function(){if(1===arguments.length){var t=arguments[0];return this.p.x===t.getX()&&this.p.y===t.getY()}if(2===arguments.length){var e=arguments[0],n=arguments[1];return this.p.distance(e.getCoordinate())<n}},getCoordinate:function(){return this.p},isInCircle:function(t,e,n){return go.isInCircleRobust(t.p,e.p,n.p,this.p)},interpolateZValue:function(t,e,n){var r=t.getX(),i=t.getY(),o=e.getX()-r,a=n.getX()-r,s=e.getY()-i,u=n.getY()-i,c=o*u-a*s,l=this.getX()-r,f=this.getY()-i,h=(u*l-a*f)/c,d=(-s*l+o*f)/c;return t.getZ()+h*(e.getZ()-t.getZ())+d*(n.getZ()-t.getZ())},midPoint:function(t){return new vo((this.p.x+t.getX())/2,(this.p.y+t.getY())/2,(this.p.z+t.getZ())/2)},rightOf:function(t){return this.isCCW(t.dest(),t.orig())},isCCW:function(t,e){return(t.p.x-this.p.x)*(e.p.y-this.p.y)-(t.p.y-this.p.y)*(e.p.x-this.p.x)>0},getX:function(){return this.p.x},crossProduct:function(t){return this.p.x*t.getY()-this.p.y*t.getX()},setZ:function(t){this.p.z=t},times:function(t){return new vo(t*this.p.x,t*this.p.y)},cross:function(){return new vo(this.p.y,-this.p.x)},leftOf:function(t){return this.isCCW(t.orig(),t.dest())},toString:function(){return"POINT ("+this.p.x+" "+this.p.y+")"},sub:function(t){return new vo(this.p.x-t.getX(),this.p.y-t.getY())},getY:function(){return this.p.y},classify:function(t,e){var n=this,r=e.sub(t),i=n.sub(t),o=r.crossProduct(i);return o>0?vo.LEFT:o<0?vo.RIGHT:r.getX()*i.getX()<0||r.getY()*i.getY()<0?vo.BEHIND:r.magn()<i.magn()?vo.BEYOND:t.equals(n)?vo.ORIGIN:e.equals(n)?vo.DESTINATION:vo.BETWEEN},sum:function(t){return new vo(this.p.x+t.getX(),this.p.y+t.getY())},distance:function(t,e){return Math.sqrt(Math.pow(e.getX()-t.getX(),2)+Math.pow(e.getY()-t.getY(),2))},circumRadiusRatio:function(t,e){var n=this.circleCenter(t,e),r=this.distance(n,t),i=this.distance(this,t),o=this.distance(t,e);return o<i&&(i=o),(o=this.distance(e,this))<i&&(i=o),r/i},interfaces_:function(){return[]},getClass:function(){return vo}}),vo.interpolateZ=function(){if(3===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2],r=e.distance(n),i=t.distance(e),o=n.z-e.z,a=e.z+o*(i/r);return a}if(4===arguments.length){var s=arguments[0],u=arguments[1],c=arguments[2],l=arguments[3],f=u.x,h=u.y,d=c.x-f,p=l.x-f,g=c.y-h,v=l.y-h,y=d*v-p*g,m=s.x-f,b=s.y-h,_=(v*m-p*b)/y,x=(-g*m+d*b)/y,w=u.z+_*(c.z-u.z)+x*(l.z-u.z);return w}},vo.LEFT=0,vo.RIGHT=1,vo.BEYOND=2,vo.BEHIND=3,vo.BETWEEN=4,vo.ORIGIN=5,vo.DESTINATION=6,l(yo,vo),e(yo.prototype,{getConstraint:function(){return this.constraint},setOnConstraint:function(t){this._isOnConstraint=t},merge:function(t){t._isOnConstraint&&(this._isOnConstraint=!0,this.constraint=t.constraint)},isOnConstraint:function(){return this._isOnConstraint},setConstraint:function(t){this._isOnConstraint=!0,this.constraint=t},interfaces_:function(){return[]},getClass:function(){return yo}}),e(mo.prototype,{equalsNonOriented:function(t){return!!this.equalsOriented(t)||!!this.equalsOriented(t.sym())},toLineSegment:function(){return new te(this.vertex.getCoordinate(),this.dest().getCoordinate())},dest:function(){return this.sym().orig()},oNext:function(){return this.next},equalsOriented:function(t){return!(!this.orig().getCoordinate().equals2D(t.orig().getCoordinate())||!this.dest().getCoordinate().equals2D(t.dest().getCoordinate()))},dNext:function(){return this.sym().oNext().sym()},lPrev:function(){return this.next.sym()},rPrev:function(){return this.sym().oNext()},rot:function(){return this._rot},oPrev:function(){return this._rot.next._rot},sym:function(){return this._rot._rot},setOrig:function(t){this.vertex=t},lNext:function(){return this.invRot().oNext().rot()},getLength:function(){return this.orig().getCoordinate().distance(this.dest().getCoordinate())},invRot:function(){return this._rot.sym()},setDest:function(t){this.sym().setOrig(t)},setData:function(t){this.data=t},getData:function(){return this.data},delete:function(){this._rot=null},orig:function(){return this.vertex},rNext:function(){return this._rot.next.invRot()},toString:function(){var t=this.vertex.getCoordinate(),e=this.dest().getCoordinate();return Yt.toLineString(t,e)},isLive:function(){return null!==this._rot},getPrimary:function(){return this.orig().getCoordinate().compareTo(this.dest().getCoordinate())<=0?this:this.sym()},dPrev:function(){return this.invRot().oNext().invRot()},setNext:function(t){this.next=t},interfaces_:function(){return[]},getClass:function(){return mo}}),mo.makeEdge=function(t,e){var n=new mo,r=new mo,i=new mo,o=new mo;n._rot=r,r._rot=i,i._rot=o,o._rot=n,n.setNext(n),r.setNext(o),i.setNext(i),o.setNext(r);var a=n;return a.setOrig(t),a.setDest(e),a},mo.swap=function(t){var e=t.oPrev(),n=t.sym().oPrev();mo.splice(t,e),mo.splice(t.sym(),n),mo.splice(t,e.lNext()),mo.splice(t.sym(),n.lNext()),t.setOrig(e.dest()),t.setDest(n.dest())},mo.splice=function(t,e){var n=t.oNext().rot(),r=e.oNext().rot(),i=e.oNext(),o=t.oNext(),a=r.oNext(),s=n.oNext();t.setNext(i),e.setNext(o),n.setNext(a),r.setNext(s)},mo.connect=function(t,e){var n=mo.makeEdge(t.dest(),e.orig());return mo.splice(n,t.lNext()),mo.splice(n.sym(),e),n},e(bo.prototype,{insertSite:function(t){var e=this.subdiv.locate(t);if(this.subdiv.isVertexOfEdge(e,t))return e;this.subdiv.isOnEdge(e,t.getCoordinate())&&(e=e.oPrev(),this.subdiv.delete(e.oNext()));var n=this.subdiv.makeEdge(e.orig(),t);mo.splice(n,e);var r=n;do{e=(n=this.subdiv.connect(e,n.sym())).oPrev()}while(e.lNext()!==r);for(;;){var i=e.oPrev();if(i.dest().rightOf(e)&&t.isInCircle(e.orig(),i.dest(),e.dest()))mo.swap(e),e=e.oPrev();else{if(e.oNext()===r)return n;e=e.oNext().lPrev()}}},insertSites:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.insertSite(n)}},interfaces_:function(){return[]},getClass:function(){return bo}}),e(_o.prototype,{locate:function(t){},interfaces_:function(){return[]},getClass:function(){return _o}}),e(xo.prototype,{init:function(){this.lastEdge=this.findEdge()},locate:function(t){this.lastEdge.isLive()||this.init();var e=this.subdiv.locateFromEdge(t,this.lastEdge);return this.lastEdge=e,e},findEdge:function(){return this.subdiv.getEdges().iterator().next()},interfaces_:function(){return[_o]},getClass:function(){return xo}}),l(wo,c),e(wo.prototype,{getSegment:function(){return this.seg},interfaces_:function(){return[]},getClass:function(){return wo}}),wo.msgWithSpatial=function(t,e){return null!==e?t+" [ "+e+" ]":t},e(Eo.prototype,{visit:function(t){},interfaces_:function(){return[]},getClass:function(){return Eo}}),e(So.prototype,{getTriangleVertices:function(t){var e=new Co;return this.visitTriangles(e,t),e.getTriangleVertices()},isFrameVertex:function(t){return!!t.equals(this.frameVertex[0])||!!t.equals(this.frameVertex[1])||!!t.equals(this.frameVertex[2])},isVertexOfEdge:function(t,e){return!(!e.equals(t.orig(),this.tolerance)&&!e.equals(t.dest(),this.tolerance))},connect:function(t,e){var n=mo.connect(t,e);return this.quadEdges.add(n),n},getVoronoiCellPolygon:function(t,e){var n=new x,r=t;do{var i=t.rot().orig().getCoordinate();n.add(i),t=t.oPrev()}while(t!==r);var o=new w;o.addAll(n,!1),o.closeRing(),o.size()<4&&(k.out.println(o),o.add(o.get(o.size()-1),!0));var a=o.toCoordinateArray(),s=e.createPolygon(e.createLinearRing(a),null),u=r.orig();return s.setUserData(u.getCoordinate()),s},setLocator:function(t){this.locator=t},initSubdiv:function(){var t=this.makeEdge(this.frameVertex[0],this.frameVertex[1]),e=this.makeEdge(this.frameVertex[1],this.frameVertex[2]);mo.splice(t.sym(),e);var n=this.makeEdge(this.frameVertex[2],this.frameVertex[0]);return mo.splice(e.sym(),n),mo.splice(n.sym(),t),t},isFrameBorderEdge:function(t){var e=new Array(3).fill(null);So.getTriangleEdges(t,e);var n=new Array(3).fill(null);So.getTriangleEdges(t.sym(),n);var r=t.lNext().dest();if(this.isFrameVertex(r))return!0;var i=t.sym().lNext().dest();return!!this.isFrameVertex(i)},makeEdge:function(t,e){var n=mo.makeEdge(t,e);return this.quadEdges.add(n),n},visitTriangles:function(t,e){this.visitedKey++;var n=new ie;n.push(this.startingEdge);for(var r=new Q;!n.empty();){var i=n.pop();if(!r.contains(i)){var o=this.fetchTriangleToVisit(i,n,e,r);null!==o&&t.visit(o)}}},isFrameEdge:function(t){return!(!this.isFrameVertex(t.orig())&&!this.isFrameVertex(t.dest()))},isOnEdge:function(t,e){return this.seg.setCoordinates(t.orig().getCoordinate(),t.dest().getCoordinate()),this.seg.distance(e)<this.edgeCoincidenceTolerance},getEnvelope:function(){return new E(this.frameEnv)},createFrame:function(t){var e,n=t.getWidth(),r=t.getHeight();e=n>r?10*n:10*r,this.frameVertex[0]=new vo((t.getMaxX()+t.getMinX())/2,t.getMaxY()+e),this.frameVertex[1]=new vo(t.getMinX()-e,t.getMinY()-e),this.frameVertex[2]=new vo(t.getMaxX()+e,t.getMinY()-e),this.frameEnv=new E(this.frameVertex[0].getCoordinate(),this.frameVertex[1].getCoordinate()),this.frameEnv.expandToInclude(this.frameVertex[2].getCoordinate())},getTriangleCoordinates:function(t){var e=new Mo;return this.visitTriangles(e,t),e.getTriangles()},getVertices:function(t){for(var e=new Q,n=this.quadEdges.iterator();n.hasNext();){var r=n.next(),i=r.orig();!t&&this.isFrameVertex(i)||e.add(i);var o=r.dest();!t&&this.isFrameVertex(o)||e.add(o)}return e},fetchTriangleToVisit:function(t,e,n,r){var i=t,o=0,a=!1;do{this.triEdges[o]=i,this.isFrameEdge(i)&&(a=!0);var s=i.sym();r.contains(s)||e.push(s),r.add(i),o++,i=i.lNext()}while(i!==t);return a&&!n?null:this.triEdges},getEdges:function(){if(0===arguments.length)return this.quadEdges;if(1===arguments.length){for(var t=arguments[0],e=this.getPrimaryEdges(!1),n=new Array(e.size()).fill(null),r=0,i=e.iterator();i.hasNext();){var o=i.next();n[r++]=t.createLineString([o.orig().getCoordinate(),o.dest().getCoordinate()])}return t.createMultiLineString(n)}},getVertexUniqueEdges:function(t){for(var e=new x,n=new Q,r=this.quadEdges.iterator();r.hasNext();){var i=r.next(),o=i.orig();n.contains(o)||(n.add(o),!t&&this.isFrameVertex(o)||e.add(i));var a=i.sym(),s=a.orig();n.contains(s)||(n.add(s),!t&&this.isFrameVertex(s)||e.add(a))}return e},getTriangleEdges:function(t){var e=new Po;return this.visitTriangles(e,t),e.getTriangleEdges()},getPrimaryEdges:function(t){this.visitedKey++;var e=new x,n=new ie;n.push(this.startingEdge);for(var r=new Q;!n.empty();){var i=n.pop();if(!r.contains(i)){var o=i.getPrimary();!t&&this.isFrameEdge(o)||e.add(o),n.push(i.oNext()),n.push(i.sym().oNext()),r.add(i),r.add(i.sym())}}return e},delete:function(t){mo.splice(t,t.oPrev()),mo.splice(t.sym(),t.sym().oPrev());var e=t.sym(),n=t.rot(),r=t.rot().sym();this.quadEdges.remove(t),this.quadEdges.remove(e),this.quadEdges.remove(n),this.quadEdges.remove(r),t.delete(),e.delete(),n.delete(),r.delete()},locateFromEdge:function(t,e){for(var n=0,r=this.quadEdges.size(),i=e;;){if(++n>r)throw new wo(i.toLineSegment());if(t.equals(i.orig())||t.equals(i.dest()))break;if(t.rightOf(i))i=i.sym();else if(t.rightOf(i.oNext())){if(t.rightOf(i.dPrev()))break;i=i.dPrev()}else i=i.oNext()}return i},getTolerance:function(){return this.tolerance},getVoronoiCellPolygons:function(t){this.visitTriangles(new Oo,!0);for(var e=new x,n=this.getVertexUniqueEdges(!1).iterator();n.hasNext();){var r=n.next();e.add(this.getVoronoiCellPolygon(r,t))}return e},getVoronoiDiagram:function(t){var e=this.getVoronoiCellPolygons(t);return t.createGeometryCollection(Xt.toGeometryArray(e))},getTriangles:function(t){for(var e=this.getTriangleCoordinates(!1),n=new Array(e.size()).fill(null),r=0,i=e.iterator();i.hasNext();){var o=i.next();n[r++]=t.createPolygon(t.createLinearRing(o),null)}return t.createGeometryCollection(n)},insertSite:function(t){var e=this.locate(t);if(t.equals(e.orig(),this.tolerance)||t.equals(e.dest(),this.tolerance))return e;var n=this.makeEdge(e.orig(),t);mo.splice(n,e);var r=n;do{e=(n=this.connect(e,n.sym())).oPrev()}while(e.lNext()!==r);return r},locate:function(){if(1===arguments.length){if(arguments[0]instanceof vo){var t=arguments[0];return this.locator.locate(t)}if(arguments[0]instanceof d){var e=arguments[0];return this.locator.locate(new vo(e))}}else if(2===arguments.length){var n=arguments[0],r=arguments[1],i=this.locator.locate(new vo(n));if(null===i)return null;var o=i;i.dest().getCoordinate().equals2D(n)&&(o=i.sym());var a=o;do{if(a.dest().getCoordinate().equals2D(r))return a;a=a.oNext()}while(a!==o);return null}},interfaces_:function(){return[]},getClass:function(){return So}}),So.getTriangleEdges=function(t,e){if(e[0]=t,e[1]=e[0].lNext(),e[2]=e[1].lNext(),e[2].lNext()!==e[0])throw new r("Edges do not form a triangle")},e(Oo.prototype,{visit:function(t){for(var e=t[0].orig().getCoordinate(),n=t[1].orig().getCoordinate(),r=t[2].orig().getCoordinate(),i=new vo(fr.circumcentre(e,n,r)),o=0;o<3;o++)t[o].rot().setOrig(i)},interfaces_:function(){return[Eo]},getClass:function(){return Oo}}),e(Po.prototype,{getTriangleEdges:function(){return this.triList},visit:function(t){this.triList.add(t.clone())},interfaces_:function(){return[Eo]},getClass:function(){return Po}}),e(Co.prototype,{visit:function(t){this.triList.add([t[0].orig(),t[1].orig(),t[2].orig()])},getTriangleVertices:function(){return this.triList},interfaces_:function(){return[Eo]},getClass:function(){return Co}}),e(Mo.prototype,{checkTriangleSize:function(t){t.length>=2?Yt.toLineString(t[0],t[1]):t.length>=1&&Yt.toPoint(t[0])},visit:function(t){this.coordList.clear();for(var e=0;e<3;e++){var n=t[e].orig();this.coordList.add(n.getCoordinate())}if(this.coordList.size()>0){this.coordList.closeRing();var r=this.coordList.toCoordinateArray();if(4!==r.length)return null;this.triCoords.add(r)}},getTriangles:function(){return this.triCoords},interfaces_:function(){return[Eo]},getClass:function(){return Mo}}),So.TriangleCircumcentreVisitor=Oo,So.TriangleEdgesListVisitor=Po,So.TriangleVertexListVisitor=Co,So.TriangleCoordinatesVisitor=Mo,So.EDGE_COINCIDENCE_TOL_FACTOR=1e3,e(Io.prototype,{getLineSegment:function(){return this.ls},getEndZ:function(){return this.ls.getCoordinate(1).z},getStartZ:function(){return this.ls.getCoordinate(0).z},intersection:function(t){return this.ls.intersection(t.getLineSegment())},getStart:function(){return this.ls.getCoordinate(0)},getEnd:function(){return this.ls.getCoordinate(1)},getEndY:function(){return this.ls.getCoordinate(1).y},getStartX:function(){return this.ls.getCoordinate(0).x},equalsTopo:function(t){return this.ls.equalsTopo(t.getLineSegment())},getStartY:function(){return this.ls.getCoordinate(0).y},setData:function(t){this.data=t},getData:function(){return this.data},getEndX:function(){return this.ls.getCoordinate(1).x},toString:function(){return this.ls.toString()},interfaces_:function(){return[]},getClass:function(){return Io}}),e(Ao.prototype,{visit:function(t){},interfaces_:function(){return[]},getClass:function(){return Ao}}),e(To.prototype,{isRepeated:function(){return this.count>1},getRight:function(){return this.right},getCoordinate:function(){return this.p},setLeft:function(t){this.left=t},getX:function(){return this.p.x},getData:function(){return this.data},getCount:function(){return this.count},getLeft:function(){return this.left},getY:function(){return this.p.y},increment:function(){this.count=this.count+1},setRight:function(t){this.right=t},interfaces_:function(){return[]},getClass:function(){return To}}),e(No.prototype,{insert:function(){if(1===arguments.length){var t=arguments[0];return this.insert(t,null)}if(2===arguments.length){var e=arguments[0],n=arguments[1];if(null===this.root)return this.root=new To(e,n),this.root;if(this.tolerance>0){var r=this.findBestMatchNode(e);if(null!==r)return r.increment(),r}return this.insertExact(e,n)}},query:function(){var t=arguments,e=this;if(1===arguments.length){var n=arguments[0],r=new x;return this.query(n,r),r}if(2===arguments.length)if(arguments[0]instanceof E&&C(arguments[1],m))!function(){var n=t[0],r=t[1];e.queryNode(e.root,n,!0,{interfaces_:function(){return[Ao]},visit:function(t){r.add(t)}})}();else if(arguments[0]instanceof E&&C(arguments[1],Ao)){var i=arguments[0],o=arguments[1];this.queryNode(this.root,i,!0,o)}},queryNode:function(t,e,n,r){if(null===t)return null;var i=null,o=null,a=null;n?(i=e.getMinX(),o=e.getMaxX(),a=t.getX()):(i=e.getMinY(),o=e.getMaxY(),a=t.getY());var s=a<=o;i<a&&this.queryNode(t.getLeft(),e,!n,r),e.contains(t.getCoordinate())&&r.visit(t),s&&this.queryNode(t.getRight(),e,!n,r)},findBestMatchNode:function(t){var e=new Lo(t,this.tolerance);return this.query(e.queryEnvelope(),e),e.getNode()},isEmpty:function(){return null===this.root},insertExact:function(t,e){for(var n=this.root,r=this.root,i=!0,o=!0;null!==n;){if(null!==n&&t.distance(n.getCoordinate())<=this.tolerance)return n.increment(),n;o=i?t.x<n.getX():t.y<n.getY(),r=n,n=o?n.getLeft():n.getRight(),i=!i}this.numberOfNodes=this.numberOfNodes+1;var a=new To(t,e);return o?r.setLeft(a):r.setRight(a),a},interfaces_:function(){return[]},getClass:function(){return No}}),No.toCoordinates=function(){if(1===arguments.length){var t=arguments[0];return No.toCoordinates(t,!1)}if(2===arguments.length){for(var e=arguments[0],n=arguments[1],r=new w,i=e.iterator();i.hasNext();)for(var o=i.next(),a=n?o.getCount():1,s=0;s<a;s++)r.add(o.getCoordinate(),!0);return r.toCoordinateArray()}},e(Lo.prototype,{visit:function(t){var e=this.p.distance(t.getCoordinate());if(!(e<=this.tolerance))return null;var n=!1;(null===this.matchNode||e<this.matchDist||null!==this.matchNode&&e===this.matchDist&&t.getCoordinate().compareTo(this.matchNode.getCoordinate())<1)&&(n=!0),n&&(this.matchNode=t,this.matchDist=e)},queryEnvelope:function(){var t=new E(this.p);return t.expandBy(this.tolerance),t},getNode:function(){return this.matchNode},interfaces_:function(){return[Ao]},getClass:function(){return Lo}}),No.BestMatchVisitor=Lo,e(Ro.prototype,{getInitialVertices:function(){return this.initialVertices},getKDT:function(){return this.kdt},enforceConstraints:function(){this.addConstraintVertices();var t=0,e=0;do{e=this.enforceGabriel(this.segments),t++}while(e>0&&t<Ro.MAX_SPLIT_ITER)},insertSites:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.insertSite(n)}},getVertexFactory:function(){return this.vertexFactory},getPointArray:function(){for(var t=new Array(this.initialVertices.size()+this.segVertices.size()).fill(null),e=0,n=this.initialVertices.iterator();n.hasNext();){var r=n.next();t[e++]=r.getCoordinate()}for(var i=this.segVertices.iterator();i.hasNext();)r=i.next(),t[e++]=r.getCoordinate();return t},setConstraints:function(t,e){this.segments=t,this.segVertices=e},computeConvexHull:function(){var t=new Xt,e=new ae(this.getPointArray(),t);this.convexHull=e.getConvexHull()},addConstraintVertices:function(){this.computeConvexHull(),this.insertSites(this.segVertices)},findNonGabrielPoint:function(t){var e=t.getStart(),n=t.getEnd(),r=new d((e.x+n.x)/2,(e.y+n.y)/2),o=e.distance(r),a=new E(r);a.expandBy(o);for(var s=this.kdt.query(a),u=null,c=i.MAX_VALUE,l=s.iterator();l.hasNext();){var f=l.next().getCoordinate();if(!f.equals2D(e)&&!f.equals2D(n)){var h=r.distance(f);h<o&&(null===u||h<c)&&(u=f,c=h)}}return u},getConstraintSegments:function(){return this.segments},setSplitPointFinder:function(t){this.splitFinder=t},getConvexHull:function(){return this.convexHull},getTolerance:function(){return this.tolerance},enforceGabriel:function(t){for(var e=new x,n=0,r=new x,i=t.iterator();i.hasNext();){var o=i.next(),a=this.findNonGabrielPoint(o);if(null!==a){this.splitPt=this.splitFinder.findSplitPoint(o,a);var s=this.createVertex(this.splitPt,o),u=(this.insertSite(s),new Io(o.getStartX(),o.getStartY(),o.getStartZ(),s.getX(),s.getY(),s.getZ(),o.getData())),c=new Io(s.getX(),s.getY(),s.getZ(),o.getEndX(),o.getEndY(),o.getEndZ(),o.getData());e.add(u),e.add(c),r.add(o),n+=1}}return t.removeAll(r),t.addAll(e),n},createVertex:function(){if(1===arguments.length){var t=arguments[0],e=null;return null!==this.vertexFactory?this.vertexFactory.createVertex(t,null):new yo(t)}if(2===arguments.length){var n=arguments[0],r=arguments[1];return e=null,(e=null!==this.vertexFactory?this.vertexFactory.createVertex(n,r):new yo(n)).setOnConstraint(!0),e}},getSubdivision:function(){return this.subdiv},computeBoundingBox:function(){var t=Ro.computeVertexEnvelope(this.initialVertices),e=Ro.computeVertexEnvelope(this.segVertices),n=new E(t);n.expandToInclude(e);var r=.2*n.getWidth(),i=.2*n.getHeight(),o=Math.max(r,i);this.computeAreaEnv=new E(n),this.computeAreaEnv.expandBy(o)},setVertexFactory:function(t){this.vertexFactory=t},formInitialDelaunay:function(){this.computeBoundingBox(),this.subdiv=new So(this.computeAreaEnv,this.tolerance),this.subdiv.setLocator(new xo(this.subdiv)),this.incDel=new bo(this.subdiv),this.insertSites(this.initialVertices)},insertSite:function(){if(arguments[0]instanceof yo){var t=arguments[0],e=this.kdt.insert(t.getCoordinate(),t);if(e.isRepeated()){var n=e.getData();return n.merge(t),n}return this.incDel.insertSite(t),t}if(arguments[0]instanceof d){var r=arguments[0];this.insertSite(this.createVertex(r))}},interfaces_:function(){return[]},getClass:function(){return Ro}}),Ro.computeVertexEnvelope=function(t){for(var e=new E,n=t.iterator();n.hasNext();){var r=n.next();e.expandToInclude(r.getCoordinate())}return e},Ro.MAX_SPLIT_ITER=99,e(ko.prototype,{create:function(){if(null!==this.subdiv)return null;var t=ko.envelope(this.siteCoords),e=ko.toVertices(this.siteCoords);this.subdiv=new So(t,this.tolerance),new bo(this.subdiv).insertSites(e)},setTolerance:function(t){this.tolerance=t},setSites:function(){if(arguments[0]instanceof B){var t=arguments[0];this.siteCoords=ko.extractUniqueCoordinates(t)}else if(C(arguments[0],v)){var e=arguments[0];this.siteCoords=ko.unique(X.toCoordinateArray(e))}},getEdges:function(t){return this.create(),this.subdiv.getEdges(t)},getSubdivision:function(){return this.create(),this.subdiv},getTriangles:function(t){return this.create(),this.subdiv.getTriangles(t)},interfaces_:function(){return[]},getClass:function(){return ko}}),ko.extractUniqueCoordinates=function(t){if(null===t)return new w;var e=t.getCoordinates();return ko.unique(e)},ko.envelope=function(t){for(var e=new E,n=t.iterator();n.hasNext();){var r=n.next();e.expandToInclude(r)}return e},ko.unique=function(t){var e=X.copyDeep(t);return ut.sort(e),new w(e,!1)},ko.toVertices=function(t){for(var e=new x,n=t.iterator();n.hasNext();){var r=n.next();e.add(new vo(r))}return e},e(jo.prototype,{createSiteVertices:function(t){for(var e=new x,n=t.iterator();n.hasNext();){var r=n.next();this.constraintVertexMap.containsKey(r)||e.add(new yo(r))}return e},create:function(){if(null!==this.subdiv)return null;var t=ko.envelope(this.siteCoords),e=new x;null!==this.constraintLines&&(t.expandToInclude(this.constraintLines.getEnvelopeInternal()),this.createVertices(this.constraintLines),e=jo.createConstraintSegments(this.constraintLines));var n=new Ro(this.createSiteVertices(this.siteCoords),this.tolerance);n.setConstraints(e,new x(this.constraintVertexMap.values())),n.formInitialDelaunay(),n.enforceConstraints(),this.subdiv=n.getSubdivision()},setTolerance:function(t){this.tolerance=t},setConstraints:function(t){this.constraintLines=t},setSites:function(t){this.siteCoords=ko.extractUniqueCoordinates(t)},getEdges:function(t){return this.create(),this.subdiv.getEdges(t)},getSubdivision:function(){return this.create(),this.subdiv},getTriangles:function(t){return this.create(),this.subdiv.getTriangles(t)},createVertices:function(t){for(var e=t.getCoordinates(),n=0;n<e.length;n++){var r=new yo(e[n]);this.constraintVertexMap.put(e[n],r)}},interfaces_:function(){return[]},getClass:function(){return jo}}),jo.createConstraintSegments=function(){if(1===arguments.length){for(var t=arguments[0],e=An.getLines(t),n=new x,r=e.iterator();r.hasNext();){var i=r.next();jo.createConstraintSegments(i,n)}return n}if(2===arguments.length){var o=arguments[0],a=arguments[1],s=o.getCoordinates();for(r=1;r<s.length;r++)a.add(new Io(s[r-1],s[r]))}},e(Fo.prototype,{create:function(){if(null!==this.subdiv)return null;var t=ko.envelope(this.siteCoords);this.diagramEnv=t;var e=Math.max(this.diagramEnv.getWidth(),this.diagramEnv.getHeight());this.diagramEnv.expandBy(e),null!==this.clipEnv&&this.diagramEnv.expandToInclude(this.clipEnv);var n=ko.toVertices(this.siteCoords);this.subdiv=new So(t,this.tolerance),new bo(this.subdiv).insertSites(n)},getDiagram:function(t){this.create();var e=this.subdiv.getVoronoiDiagram(t);return Fo.clipGeometryCollection(e,this.diagramEnv)},setTolerance:function(t){this.tolerance=t},setSites:function(){if(arguments[0]instanceof B){var t=arguments[0];this.siteCoords=ko.extractUniqueCoordinates(t)}else if(C(arguments[0],v)){var e=arguments[0];this.siteCoords=ko.unique(X.toCoordinateArray(e))}},setClipEnvelope:function(t){this.clipEnv=t},getSubdivision:function(){return this.create(),this.subdiv},interfaces_:function(){return[]},getClass:function(){return Fo}}),Fo.clipGeometryCollection=function(t,e){for(var n=t.getFactory().toGeometry(e),r=new x,i=0;i<t.getNumGeometries();i++){var o=t.getGeometryN(i),a=null;e.contains(o.getEnvelopeInternal())?a=o:e.intersects(o.getEnvelopeInternal())&&(a=n.intersection(o)).setUserData(o.getUserData()),null===a||a.isEmpty()||r.add(a)}return t.getFactory().createGeometryCollection(Xt.toGeometryArray(r))};var xa=Object.freeze({Vertex:vo}),wa=Object.freeze({ConformingDelaunayTriangulationBuilder:jo,DelaunayTriangulationBuilder:ko,VoronoiDiagramBuilder:Fo,quadedge:xa});e(Do.prototype,{interfaces_:function(){return[]},getClass:function(){return Do}}),Do.union=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return qn.createEmptyResult(qn.UNION,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),Hn.overlayOp(t,e,qn.UNION)},e(B.prototype,{equalsTopo:function(t){return!!this.getEnvelopeInternal().equals(t.getEnvelopeInternal())&&qi.relate(this,t).isEquals(this.getDimension(),t.getDimension())},union:function(){if(0===arguments.length)return Ki.union(this);if(1===arguments.length){var t=arguments[0];return Do.union(this,t)}},isValid:function(){return Ti.isValid(this)},intersection:function(t){if(this.isEmpty()||t.isEmpty())return qn.createEmptyResult(qn.INTERSECTION,this,t,this.factory);if(this.isGeometryCollection()){var e=t;return Je.map(this,{interfaces_:function(){return[MapOp]},map:function(t){return t.intersection(e)}})}return this.checkNotGeometryCollection(this),this.checkNotGeometryCollection(t),Hn.overlayOp(this,t,qn.INTERSECTION)},covers:function(t){return qi.covers(this,t)},coveredBy:function(t){return qi.coveredBy(this,t)},touches:function(t){return qi.touches(this,t)},intersects:function(t){return qi.intersects(this,t)},within:function(t){return qi.within(this,t)},overlaps:function(t){return qi.overlaps(this,t)},disjoint:function(t){return qi.disjoint(this,t)},crosses:function(t){return qi.crosses(this,t)},buffer:function(){if(1===arguments.length){var t=arguments[0];return ei.bufferOp(this,t)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return ei.bufferOp(this,e,n)}if(3===arguments.length){var r=arguments[0],i=arguments[1],o=arguments[2];return ei.bufferOp(this,r,i,o)}},convexHull:function(){return new ae(this).getConvexHull()},relate:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return qi.relate.apply(qi,[this].concat(e))},getCentroid:function(){if(this.isEmpty())return this.factory.createPoint();var t=ne.getCentroid(this);return this.createPointFromInternalCoord(t,this)},getInteriorPoint:function(){if(this.isEmpty())return this.factory.createPoint();var t=null,e=this.getDimension();return t=0===e?new Jn(this).getInteriorPoint():1===e?new Kn(this).getInteriorPoint():new Yn(this).getInteriorPoint(),this.createPointFromInternalCoord(t,this)},symDifference:function(t){if(this.isEmpty()||t.isEmpty()){if(this.isEmpty()&&t.isEmpty())return qn.createEmptyResult(qn.SYMDIFFERENCE,this,t,this.factory);if(this.isEmpty())return t.copy();if(t.isEmpty())return this.copy()}return this.checkNotGeometryCollection(this),this.checkNotGeometryCollection(t),Hn.overlayOp(this,t,qn.SYMDIFFERENCE)},createPointFromInternalCoord:function(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)},toText:function(){return(new Yt).write(this)},toString:function(){this.toText()},contains:function(t){return qi.contains(this,t)},difference:function(t){return this.isEmpty()?qn.createEmptyResult(qn.DIFFERENCE,this,t,this.factory):t.isEmpty()?this.copy():(this.checkNotGeometryCollection(this),this.checkNotGeometryCollection(t),Hn.overlayOp(this,t,qn.DIFFERENCE))},isSimple:function(){return new Rr(this).isSimple()},isWithinDistance:function(t,e){return!(this.getEnvelopeInternal().distance(t.getEnvelopeInternal())>e)&&ai.isWithinDistance(this,t,e)},distance:function(t){return ai.distance(this,t)},isEquivalentClass:function(t){return this.getClass()===t.getClass()}}),t.version="1.3.0 (6e65adb)",t.algorithm=Qo,t.densify=$o,t.dissolve=ta,t.geom=Ko,t.geomgraph=ea,t.index=ia,t.io=ua,t.noding=ca,t.operation=ma,t.precision=ba,t.simplify=_a,t.triangulate=wa,Object.defineProperty(t,"__esModule",{value:!0})}(e)},function(t,e,n){var r=n(117);t.exports=function(){for(var t=new r.io.GeoJSONReader,e=t.read(JSON.stringify(arguments[0].geometry)),n=1;n<arguments.length;n++)e=e.union(t.read(JSON.stringify(arguments[n].geometry)));var i=new r.io.GeoJSONWriter;return{type:"Feature",geometry:e=i.write(e),properties:arguments[0].properties}}},function(t,e,n){var r=n(11),i=n(16),o=i.getCoords,a=i.getGeomType;function s(t,e,n){var r={type:e,coordinates:n};return t.bbox&&(r.bbox=t.bbox),r}function u(t){var e,n,r,i,a,s=o(t);if(2===s.length&&(e=s[0],n=s[1],e[0]!==n[0]||e[1]!==n[1]))return s;var u=[],l=s.length-1;u.push(s[0]);for(var f=1;f<l;f++)r=s[f-1],i=s[f],c(r,a=s[f+1],i)||u.push(i);return u.push(a),u}function c(t,e,n){var r=n[0],i=n[1],o=t[0],a=t[1],s=e[0],u=e[1],c=s-o,l=u-a;return 0===(r-o)*l-(i-a)*c&&(Math.abs(c)>=Math.abs(l)?c>0?o<=r&&r<=s:s<=r&&r<=o:l>0?a<=i&&i<=u:u<=i&&i<=a)}t.exports=function(t,e){if(!t)throw new Error("geojson is required");var n=a(t),i=[];switch(n){case"LineString":i=u(t);break;case"MultiLineString":case"Polygon":o(t).forEach((function(t){i.push(u(t))}));break;case"MultiPolygon":o(t).forEach((function(t){var e=[];t.forEach((function(t){e.push(u(t))})),i.push(e)}));break;case"Point":return t;case"MultiPoint":var c={};o(t).forEach((function(t){var e=t.join("-");c.hasOwnProperty(e)||(i.push(t),c[e]=!0)}));break;default:throw new Error(n+" geometry not supported")}return t.coordinates?!0===e?(t.coordinates=i,t):s(t,n,i):!0===e?(t.geometry.coordinates=i,t):function(t,e,n){var i=r.feature(s(t.geometry,e,n),t.properties);t.id&&(i.id=t.id);t.bbox&&(i.bbox=t.bbox);return i}(t,n,i)}},function(t,e,n){var r=n(66),i=n(11).polygon;t.exports=function(t,e,n,o,a){if(!t)throw new Error("center is required");if(!e)throw new Error("radius is required");n=n||64,a=a||t.properties||{};for(var s=[],u=0;u<n;u++)s.push(r(t,e,360*u/n,o).geometry.coordinates);return s.push(s[0]),i([s],a)}},function(t,e,n){var r=n(39),i=n(11).point;t.exports=function(t,e){var n=r(t),o=(n[0]+n[2])/2,a=(n[1]+n[3])/2;return i([o,a],e)}},function(t,e,n){var r=n(15),i=n(11),o=i.point,a=r.coordEach,s=r.featureEach,u=i.featureCollection;t.exports=function(t){var e=[];return"FeatureCollection"===t.type?s(t,(function(t){a(t,(function(n){e.push(o(n,t.properties))}))})):a(t,(function(n){e.push(o(n,t.properties))})),u(e)}},function(t,e,n){var r=n(15).coordEach;t.exports=function(t,e,n,i){if(e=null==e||isNaN(e)?6:e,n=null==n||isNaN(n)?3:n,!t)throw new Error("<geojson> is required");if("number"!=typeof e)throw new Error("<precision> must be a number");if("number"!=typeof n)throw new Error("<coordinates> must be a number");!1!==i&&void 0!==i||(t=JSON.parse(JSON.stringify(t)));var o=Math.pow(10,e);return r(t,(function(t){!function(t,e,n){t.length>n&&t.splice(n,t.length);for(var r=0;r<t.length;r++)t[r]=Math.round(t[r]*e)/e}(t,o,n)})),t}},function(t,e){function n(t,e){if(!t)throw new Error("No geometry passed");return{type:"Feature",properties:e||{},geometry:t}}t.exports.feature=n,t.exports.point=function(t,e){if(!t)throw new Error("No coordinates passed");if(void 0===t.length)throw new Error("Coordinates must be an array");if(t.length<2)throw new Error("Coordinates must be at least 2 numbers long");if("number"!=typeof t[0]||"number"!=typeof t[1])throw new Error("Coordinates must numbers");return n({type:"Point",coordinates:t},e)},t.exports.polygon=function(t,e){if(!t)throw new Error("No coordinates passed");for(var r=0;r<t.length;r++){var i=t[r];if(i.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var o=0;o<i[i.length-1].length;o++)if(i[i.length-1][o]!==i[0][o])throw new Error("First and last Position are not equivalent.")}return n({type:"Polygon",coordinates:t},e)},t.exports.lineString=function(t,e){if(!t)throw new Error("No coordinates passed");return n({type:"LineString",coordinates:t},e)},t.exports.featureCollection=function(t){if(!t)throw new Error("No features passed");return{type:"FeatureCollection",features:t}},t.exports.multiLineString=function(t,e){if(!t)throw new Error("No coordinates passed");return n({type:"MultiLineString",coordinates:t},e)},t.exports.multiPoint=function(t,e){if(!t)throw new Error("No coordinates passed");return n({type:"MultiPoint",coordinates:t},e)},t.exports.multiPolygon=function(t,e){if(!t)throw new Error("No coordinates passed");return n({type:"MultiPolygon",coordinates:t},e)},t.exports.geometryCollection=function(t,e){if(!t)throw new Error("No geometries passed");return n({type:"GeometryCollection",geometries:t},e)};var r={miles:3960,nauticalmiles:3441.145,degrees:57.2957795,radians:1,inches:250905600,yards:6969600,meters:6373e3,metres:6373e3,kilometers:6373,kilometres:6373,feet:20908792.65};t.exports.radiansToDistance=function(t,e){var n=r[e||"kilometers"];if(void 0===n)throw new Error("Invalid unit");return t*n},t.exports.distanceToRadians=function(t,e){var n=r[e||"kilometers"];if(void 0===n)throw new Error("Invalid unit");return t/n},t.exports.distanceToDegrees=function(t,e){var n=r[e||"kilometers"];if(void 0===n)throw new Error("Invalid unit");return t/n*57.2958}},function(t,e,n){var r=n(16).getCoords,i=n(11),o=i.lineString,a=i.multiLineString,s=i.featureCollection;function u(t,e){return t.length>1?a(t,e):o(t[0],e)}t.exports=function(t,e){var n,i=(n=t).geometry?n.geometry.type:n.type,o=r(t);if(e=e||t.properties||{},!o.length)throw new Error("polygon must contain coordinates");switch(i){case"Polygon":return u(o,e);case"MultiPolygon":var a=[];return o.forEach((function(t){a.push(u(t,e))})),s(a);default:throw new Error("geom "+i+" not supported")}}},function(t,e,n){"use strict";var r={parseDMS:function(t){if("number"==typeof t&&isFinite(t))return Number(t);var e,n=String(t).trim().replace(/^-/,"").replace(/[NSEW]$/i,"").split(/[^0-9.,]+/);if(""==n[n.length-1]&&n.splice(n.length-1),""==n)return NaN;switch(n.length){case 3:e=n[0]/1+n[1]/60+n[2]/3600;break;case 2:e=n[0]/1+n[1]/60;break;case 1:e=n[0];break;default:return NaN}return/^-|[WS]$/i.test(t.trim())&&(e=-e),Number(e)},separator:"",toDMS:function(t,e,n){if(isNaN(t))return null;if(void 0===e&&(e="dms"),void 0===n)switch(e){case"d":case"deg":n=4;break;case"dm":case"deg+min":n=2;break;case"dms":case"deg+min+sec":n=0;break;default:e="dms",n=0}var i,o,a,s;switch(t=Math.abs(t),e){default:case"d":case"deg":(o=t.toFixed(n))<100&&(o="0"+o),o<10&&(o="0"+o),i=o+"";break;case"dm":case"deg+min":o=Math.floor(t),60==(a=(60*t%60).toFixed(n))&&(a=0,o++),a<10&&(a="0"+a),i=(o=("000"+o).slice(-3))+""+r.separator+a+"";break;case"dms":case"deg+min+sec":o=Math.floor(t),a=Math.floor(3600*t/60)%60,60==(s=(3600*t%60).toFixed(n))&&(s=(0).toFixed(n),a++),60==a&&(a=0,o++),o=("000"+o).slice(-3),a=("00"+a).slice(-2),s<10&&(s="0"+s),i=o+""+r.separator+a+""+r.separator+s+""}return i},toLat:function(t,e,n){var i=r.toDMS(t,e,n);return null===i?"":i.slice(1)+r.separator+(t<0?"S":"N")},toLon:function(t,e,n){var i=r.toDMS(t,e,n);return null===i?"":i+r.separator+(t<0?"W":"E")},toBrng:function(t,e,n){t=(Number(t)+360)%360;var i=r.toDMS(t,e,n);return null===i?"":i.replace("360","0")},compassPoint:function(t,e){void 0===e&&(e=3),t=(t%360+360)%360;var n=4*Math.pow(2,e-1);return["N","NNE","NE","ENE","E","ESE","SE","SSE","S","SSW","SW","WSW","W","WNW","NW","NNW"][Math.round(t*n/360)%n*16/n]}};t.exports&&(t.exports=r)},function(t,e,n){var r=n(479),i=n(480),o=n(481),a=n(482),s=n(483);function u(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=i,u.prototype.get=o,u.prototype.has=a,u.prototype.set=s,t.exports=u},function(t,e,n){var r=n(276);t.exports=function(t,e){for(var n=t.length;n--;)if(r(t[n][0],e))return n;return-1}},function(t,e,n){var r=n(179),i=n(490),o=n(491),a=r?r.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":a&&a in Object(t)?i(t):o(t)}},function(t,e,n){var r=n(74)(Object,"create");t.exports=r},function(t,e,n){var r=n(504);t.exports=function(t,e){var n=t.__data__;return r(e)?n["string"==typeof e?"string":"hash"]:n.map}},function(t,e,n){var r=n(280),i=n(281);t.exports=function(t,e,n,o){var a=!n;n||(n={});for(var s=-1,u=e.length;++s<u;){var c=e[s],l=o?o(n[c],t[c],c,n,t):void 0;void 0===l&&(l=t[c]),a?i(n,c,l):r(n,c,l)}return n}},function(t,e,n){"use strict";n.d(e,"a",(function(){return d}));var r=n(1),i=n(9),o=n(8),a=n(2),s=n(10),u=n(17),c=n(6),l=n(24),f=n(47),h=n(19),d=function(t){function e(t){var n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(r.a)(this,e),Object(c.d)(t),(n=Object(i.a)(this,Object(o.a)(e).call(this,t,Object.assign({},a,{target:a.target||32879})))).width=null,n.height=null,n.depth=null,Object.seal(Object(u.a)(Object(u.a)(n))),n.setImageData(a),a.generateMipmap&&n.generateMipmap(),n}return Object(s.a)(e,t),Object(a.a)(e,null,[{key:"isSupported",value:function(t){return Object(c.n)(t)}}]),Object(a.a)(e,[{key:"initialize",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.opts=Object.assign({},this.opts,e);var n=this.opts,r=n.pixels,i=n.settings;i&&(Object(l.g)(i,(function(){r&&t.setImage3D(t.opts)})),this.setParameters(e))}},{key:"setImage3D",value:function(t){var e=t.level,n=void 0===e?0:e,r=t.internalformat,i=void 0===r?6408:r,o=t.width,a=t.height,s=t.depth,u=void 0===s?1:s,c=t.border,l=void 0===c?0:c,f=t.format,d=t.type,p=void 0===d?5121:d,g=t.offset,v=void 0===g?0:g,y=t.pixels;ArrayBuffer.isView(y)?this.gl.texImage3D(this.target,n,i,o,a,u,l,f,p,y):y instanceof h.a&&(this.gl.bindBuffer(35052,y.handle),this.gl.texImage3D(this.target,n,i,o,a,u,l,f,p,v),this.gl.bindBuffer(35052,y.handle))}}]),e}(f.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(102);function i(t,e){if(t){if("string"==typeof t)return Object(r.a)(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Object(r.a)(t,e):void 0}}},function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return o}));var r=n(22),i=n(136);function o(){return!("object"===(void 0===t?"undefined":Object(r.a)(t))&&"[object process]"===String(t)&&!t.browser)||Object(i.a)()}}).call(this,n(61))},function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return i}));var r=n(22);function i(e){if("undefined"!=typeof window&&"object"===Object(r.a)(window.process)&&"renderer"===window.process.type)return!0;if(void 0!==t&&"object"===Object(r.a)(t.versions)&&Boolean(t.versions.electron))return!0;var n="object"===("undefined"==typeof navigator?"undefined":Object(r.a)(navigator))&&"string"==typeof navigator.userAgent&&navigator.userAgent,i=e||n;return!!(i&&i.indexOf("Electron")>=0)}}).call(this,n(61))},function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));var r=n(1),i=n(2),o=n(9),a=n(8),s=n(10),u=n(87);var c=n(138);function l(t){var e="function"==typeof Map?new Map:void 0;return(l=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return Object(c.a)(t,arguments,Object(a.a)(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Object(u.a)(r,t)})(t)}var f=n(18),h=function(t){function e(){return Object(r.a)(this,e),Object(o.a)(this,Object(a.a)(e).apply(this,arguments))}return Object(s.a)(e,t),Object(i.a)(e,[{key:"clone",value:function(){return(new this.constructor).copy(this).check()}},{key:"copy",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=t[e];return this.check()}},{key:"set",value:function(){for(var t=0;t<this.ELEMENTS;++t)this[t]=(t<0||arguments.length<=t?void 0:arguments[t])||0;return this.check()}},{key:"fromArray",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<this.ELEMENTS;++n)this[n]=t[n+e];return this.check()}},{key:"toString",value:function(){return this.formatString(f.c)}},{key:"formatString",value:function(t){for(var e="",n=0;n<this.ELEMENTS;++n)e+=(n>0?", ":"")+Object(f.f)(this[n],t);return"".concat(t.printTypes?this.constructor.name:"","[").concat(e,"]")}},{key:"toArray",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<this.ELEMENTS;++n)t[e+n]=this[n];return t}},{key:"toFloat32Array",value:function(){return new Float32Array(this)}},{key:"equals",value:function(t){if(!t||this.length!==t.length)return!1;for(var e=0;e<this.ELEMENTS;++e)if(!Object(f.e)(this[e],t[e]))return!1;return!0}},{key:"exactEquals",value:function(t){if(!t||this.length!==t.length)return!1;for(var e=0;e<this.ELEMENTS;++e)if(this[e]!==t[e])return!1;return!0}},{key:"negate",value:function(){for(var t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}},{key:"inverse",value:function(){for(var t=0;t<this.ELEMENTS;++t)this[t]=1/this[t];return this.check()}},{key:"lerp",value:function(t,e,n){void 0===n&&(n=e,e=t,t=this);for(var r=0;r<this.ELEMENTS;++r){var i=t[r];this[r]=i+n*(e[r]-i)}return this.check()}},{key:"min",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=Math.min(t[e],this[e]);return this.check()}},{key:"max",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=Math.max(t[e],this[e]);return this.check()}},{key:"clamp",value:function(t,e){for(var n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t[n]),e[n]);return this.check()}},{key:"validate",value:function(){for(var t=this.length===this.ELEMENTS,e=0;e<this.ELEMENTS;++e)t=t&&Number.isFinite(this[e]);return t}},{key:"check",value:function(){if(f.c.debug&&!this.validate(this))throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}},{key:"sub",value:function(t){return this.subtract(t)}},{key:"setScalar",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=t;return this.check()}},{key:"addScalar",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]+=t;return this.check()}},{key:"subScalar",value:function(t){return this.addScalar(-t)}},{key:"multiplyScalar",value:function(t){return this.scale(t)}},{key:"divideScalar",value:function(t){return this.scale(1/t)}},{key:"clampScalar",value:function(t,e){for(var n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t),e);return this.check()}}]),e}(l(Array))},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(87);function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function o(t,e,n){return(o=i()?Reflect.construct:function(t,e,n){var i=[null];i.push.apply(i,e);var o=new(Function.bind.apply(t,i));return n&&Object(r.a)(o,n.prototype),o}).apply(null,arguments)}},function(t,e,n){"use strict";n.r(e),n.d(e,"global",(function(){return i.b}));var r=n(67),i=n(21),o=n(36);n(202);if(i.b.luma&&"6.4.3"!==i.b.luma.VERSION)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(i.b.luma.VERSION," vs ").concat("6.4.3"));i.b.luma||(r.a&&o.a.log(0,"luma.gl ".concat("6.4.3"," - ").concat("set luma.log.priority=1 (or higher) to trace rendering"))(),i.b.luma=i.b.luma||{VERSION:"6.4.3",version:"6.4.3",log:o.a,stats:{},globals:{modules:{},nodeIO:{}}});e.default=i.b.luma},function(t,e){t.exports=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=e[9],d=e[10],p=e[11],g=e[12],v=e[13],y=e[14],m=e[15],b=n[0],_=n[1],x=n[2],w=n[3];return t[0]=b*r+_*s+x*f+w*g,t[1]=b*i+_*u+x*h+w*v,t[2]=b*o+_*c+x*d+w*y,t[3]=b*a+_*l+x*p+w*m,b=n[4],_=n[5],x=n[6],w=n[7],t[4]=b*r+_*s+x*f+w*g,t[5]=b*i+_*u+x*h+w*v,t[6]=b*o+_*c+x*d+w*y,t[7]=b*a+_*l+x*p+w*m,b=n[8],_=n[9],x=n[10],w=n[11],t[8]=b*r+_*s+x*f+w*g,t[9]=b*i+_*u+x*h+w*v,t[10]=b*o+_*c+x*d+w*y,t[11]=b*a+_*l+x*p+w*m,b=n[12],_=n[13],x=n[14],w=n[15],t[12]=b*r+_*s+x*f+w*g,t[13]=b*i+_*u+x*h+w*v,t[14]=b*o+_*c+x*d+w*y,t[15]=b*a+_*l+x*p+w*m,t}},function(t,e,n){var r=n(308);t.exports=function(t,e,n){if(r(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}}},function(t,e,n){var r=n(79);t.exports=function(t,e){if(!r(t))return t;var n,i;if(e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;if("function"==typeof(n=t.valueOf)&&!r(i=n.call(t)))return i;if(!e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e,n){var r=n(145)("keys"),i=n(110);t.exports=function(t){return r[t]||(r[t]=i(t))}},function(t,e,n){var r=n(38),i=n(62),o=i["__core-js_shared__"]||(i["__core-js_shared__"]={});(t.exports=function(t,e){return o[t]||(o[t]=void 0!==e?e:{})})("versions",[]).push({version:r.version,mode:n(109)?"pure":"global",copyright:" 2019 Denis Pushkarev (zloirock.ru)"})},function(t,e,n){"use strict";e.__esModule=!0;var r=a(n(314)),i=a(n(325)),o="function"==typeof i.default&&"symbol"==typeof r.default?function(t){return typeof t}:function(t){return t&&"function"==typeof i.default&&t.constructor===i.default&&t!==i.default.prototype?"symbol":typeof t};function a(t){return t&&t.__esModule?t:{default:t}}e.default="function"==typeof i.default&&"symbol"===o(r.default)?function(t){return void 0===t?"undefined":o(t)}:function(t){return t&&"function"==typeof i.default&&t.constructor===i.default&&t!==i.default.prototype?"symbol":void 0===t?"undefined":o(t)}},function(t,e){var n=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:n)(t)}},function(t,e,n){var r=n(69),i=n(318),o=n(150),a=n(144)("IE_PROTO"),s=function(){},u=function(){var t,e=n(192)("iframe"),r=o.length;for(e.style.display="none",n(321).appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),u=t.F;r--;)delete u.prototype[o[r]];return u()};t.exports=Object.create||function(t,e){var n;return null!==t?(s.prototype=r(t),n=new s,s.prototype=null,n[a]=t):n=u(),void 0===e?n:i(n,e)}},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e,n){var r=n(63).f,i=n(70),o=n(52)("toStringTag");t.exports=function(t,e,n){t&&!i(t=n?t:t.prototype,o)&&r(t,o,{configurable:!0,value:e})}},function(t,e,n){n(322);for(var r=n(62),i=n(78),o=n(82),a=n(52)("toStringTag"),s="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),u=0;u<s.length;u++){var c=s[u],l=r[c],f=l&&l.prototype;f&&!f[a]&&i(f,a,c),o[c]=o.Array}},function(t,e,n){e.f=n(52)},function(t,e,n){var r=n(62),i=n(38),o=n(109),a=n(153),s=n(63).f;t.exports=function(t){var e=i.Symbol||(i.Symbol=o?{}:r.Symbol||{});"_"==t.charAt(0)||t in e||s(e,t,{value:a.f(t)})}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,n){t.exports={default:n(367),__esModule:!0}},function(t,e,n){(function(t,r){var i;
/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(){var o="Expected a function",a="__lodash_placeholder__",s=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],u="[object Arguments]",c="[object Array]",l="[object Boolean]",f="[object Date]",h="[object Error]",d="[object Function]",p="[object GeneratorFunction]",g="[object Map]",v="[object Number]",y="[object Object]",m="[object RegExp]",b="[object Set]",_="[object String]",x="[object Symbol]",w="[object WeakMap]",E="[object ArrayBuffer]",S="[object DataView]",O="[object Float32Array]",P="[object Float64Array]",C="[object Int8Array]",M="[object Int16Array]",I="[object Int32Array]",A="[object Uint8Array]",T="[object Uint16Array]",N="[object Uint32Array]",L=/\b__p \+= '';/g,R=/\b(__p \+=) '' \+/g,k=/(__e\(.*?\)|\b__t\)) \+\n'';/g,j=/&(?:amp|lt|gt|quot|#39);/g,F=/[&<>"']/g,D=RegExp(j.source),B=RegExp(F.source),z=/<%-([\s\S]+?)%>/g,V=/<%([\s\S]+?)%>/g,G=/<%=([\s\S]+?)%>/g,U=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,W=/^\w*$/,q=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,X=/[\\^$.*+?()[\]{}|]/g,H=RegExp(X.source),Y=/^\s+|\s+$/g,Z=/^\s+/,K=/\s+$/,J=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Q=/\{\n\/\* \[wrapped with (.+)\] \*/,$=/,? & /,tt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,et=/\\(\\)?/g,nt=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,rt=/\w*$/,it=/^[-+]0x[0-9a-f]+$/i,ot=/^0b[01]+$/i,at=/^\[object .+?Constructor\]$/,st=/^0o[0-7]+$/i,ut=/^(?:0|[1-9]\d*)$/,ct=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,lt=/($^)/,ft=/['\n\r\u2028\u2029\\]/g,ht="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",dt="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",pt="[\\ud800-\\udfff]",gt="["+dt+"]",vt="["+ht+"]",yt="\\d+",mt="[\\u2700-\\u27bf]",bt="[a-z\\xdf-\\xf6\\xf8-\\xff]",_t="[^\\ud800-\\udfff"+dt+yt+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",xt="\\ud83c[\\udffb-\\udfff]",wt="[^\\ud800-\\udfff]",Et="(?:\\ud83c[\\udde6-\\uddff]){2}",St="[\\ud800-\\udbff][\\udc00-\\udfff]",Ot="[A-Z\\xc0-\\xd6\\xd8-\\xde]",Pt="(?:"+bt+"|"+_t+")",Ct="(?:"+Ot+"|"+_t+")",Mt="(?:"+vt+"|"+xt+")"+"?",It="[\\ufe0e\\ufe0f]?"+Mt+("(?:\\u200d(?:"+[wt,Et,St].join("|")+")[\\ufe0e\\ufe0f]?"+Mt+")*"),At="(?:"+[mt,Et,St].join("|")+")"+It,Tt="(?:"+[wt+vt+"?",vt,Et,St,pt].join("|")+")",Nt=RegExp("[']","g"),Lt=RegExp(vt,"g"),Rt=RegExp(xt+"(?="+xt+")|"+Tt+It,"g"),kt=RegExp([Ot+"?"+bt+"+(?:['](?:d|ll|m|re|s|t|ve))?(?="+[gt,Ot,"$"].join("|")+")",Ct+"+(?:['](?:D|LL|M|RE|S|T|VE))?(?="+[gt,Ot+Pt,"$"].join("|")+")",Ot+"?"+Pt+"+(?:['](?:d|ll|m|re|s|t|ve))?",Ot+"+(?:['](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",yt,At].join("|"),"g"),jt=RegExp("[\\u200d\\ud800-\\udfff"+ht+"\\ufe0e\\ufe0f]"),Ft=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Dt=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Bt=-1,zt={};zt[O]=zt[P]=zt[C]=zt[M]=zt[I]=zt[A]=zt["[object Uint8ClampedArray]"]=zt[T]=zt[N]=!0,zt[u]=zt[c]=zt[E]=zt[l]=zt[S]=zt[f]=zt[h]=zt[d]=zt[g]=zt[v]=zt[y]=zt[m]=zt[b]=zt[_]=zt[w]=!1;var Vt={};Vt[u]=Vt[c]=Vt[E]=Vt[S]=Vt[l]=Vt[f]=Vt[O]=Vt[P]=Vt[C]=Vt[M]=Vt[I]=Vt[g]=Vt[v]=Vt[y]=Vt[m]=Vt[b]=Vt[_]=Vt[x]=Vt[A]=Vt["[object Uint8ClampedArray]"]=Vt[T]=Vt[N]=!0,Vt[h]=Vt[d]=Vt[w]=!1;var Gt={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ut=parseFloat,Wt=parseInt,qt="object"==typeof t&&t&&t.Object===Object&&t,Xt="object"==typeof self&&self&&self.Object===Object&&self,Ht=qt||Xt||Function("return this")(),Yt=e&&!e.nodeType&&e,Zt=Yt&&"object"==typeof r&&r&&!r.nodeType&&r,Kt=Zt&&Zt.exports===Yt,Jt=Kt&&qt.process,Qt=function(){try{var t=Zt&&Zt.require&&Zt.require("util").types;return t||Jt&&Jt.binding&&Jt.binding("util")}catch(t){}}(),$t=Qt&&Qt.isArrayBuffer,te=Qt&&Qt.isDate,ee=Qt&&Qt.isMap,ne=Qt&&Qt.isRegExp,re=Qt&&Qt.isSet,ie=Qt&&Qt.isTypedArray;function oe(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function ae(t,e,n,r){for(var i=-1,o=null==t?0:t.length;++i<o;){var a=t[i];e(r,a,n(a),t)}return r}function se(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););return t}function ue(t,e){for(var n=null==t?0:t.length;n--&&!1!==e(t[n],n,t););return t}function ce(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(!e(t[n],n,t))return!1;return!0}function le(t,e){for(var n=-1,r=null==t?0:t.length,i=0,o=[];++n<r;){var a=t[n];e(a,n,t)&&(o[i++]=a)}return o}function fe(t,e){return!!(null==t?0:t.length)&&xe(t,e,0)>-1}function he(t,e,n){for(var r=-1,i=null==t?0:t.length;++r<i;)if(n(e,t[r]))return!0;return!1}function de(t,e){for(var n=-1,r=null==t?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}function pe(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}function ge(t,e,n,r){var i=-1,o=null==t?0:t.length;for(r&&o&&(n=t[++i]);++i<o;)n=e(n,t[i],i,t);return n}function ve(t,e,n,r){var i=null==t?0:t.length;for(r&&i&&(n=t[--i]);i--;)n=e(n,t[i],i,t);return n}function ye(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}var me=Oe("length");function be(t,e,n){var r;return n(t,(function(t,n,i){if(e(t,n,i))return r=n,!1})),r}function _e(t,e,n,r){for(var i=t.length,o=n+(r?1:-1);r?o--:++o<i;)if(e(t[o],o,t))return o;return-1}function xe(t,e,n){return e==e?function(t,e,n){var r=n-1,i=t.length;for(;++r<i;)if(t[r]===e)return r;return-1}(t,e,n):_e(t,Ee,n)}function we(t,e,n,r){for(var i=n-1,o=t.length;++i<o;)if(r(t[i],e))return i;return-1}function Ee(t){return t!=t}function Se(t,e){var n=null==t?0:t.length;return n?Me(t,e)/n:NaN}function Oe(t){return function(e){return null==e?void 0:e[t]}}function Pe(t){return function(e){return null==t?void 0:t[e]}}function Ce(t,e,n,r,i){return i(t,(function(t,i,o){n=r?(r=!1,t):e(n,t,i,o)})),n}function Me(t,e){for(var n,r=-1,i=t.length;++r<i;){var o=e(t[r]);void 0!==o&&(n=void 0===n?o:n+o)}return n}function Ie(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}function Ae(t){return function(e){return t(e)}}function Te(t,e){return de(e,(function(e){return t[e]}))}function Ne(t,e){return t.has(e)}function Le(t,e){for(var n=-1,r=t.length;++n<r&&xe(e,t[n],0)>-1;);return n}function Re(t,e){for(var n=t.length;n--&&xe(e,t[n],0)>-1;);return n}function ke(t,e){for(var n=t.length,r=0;n--;)t[n]===e&&++r;return r}var je=Pe({"":"A","":"A","":"A","":"A","":"A","":"A","":"a","":"a","":"a","":"a","":"a","":"a","":"C","":"c","":"D","":"d","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"N","":"n","":"O","":"O","":"O","":"O","":"O","":"O","":"o","":"o","":"o","":"o","":"o","":"o","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"Y","":"y","":"y","":"Ae","":"ae","":"Th","":"th","":"ss","":"A","":"A","":"A","":"a","":"a","":"a","":"C","":"C","":"C","":"C","":"c","":"c","":"c","":"c","":"D","":"D","":"d","":"d","":"E","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"e","":"G","":"G","":"G","":"G","":"g","":"g","":"g","":"g","":"H","":"H","":"h","":"h","":"I","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"i","":"J","":"j","":"K","":"k","":"k","":"L","":"L","":"L","":"L","":"L","":"l","":"l","":"l","":"l","":"l","":"N","":"N","":"N","":"N","":"n","":"n","":"n","":"n","":"O","":"O","":"O","":"o","":"o","":"o","":"R","":"R","":"R","":"r","":"r","":"r","":"S","":"S","":"S","":"S","":"s","":"s","":"s","":"s","":"T","":"T","":"T","":"t","":"t","":"t","":"U","":"U","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"u","":"u","":"W","":"w","":"Y","":"y","":"Y","":"Z","":"Z","":"Z","":"z","":"z","":"z","":"IJ","":"ij","":"Oe","":"oe","":"'n","":"s"}),Fe=Pe({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function De(t){return"\\"+Gt[t]}function Be(t){return jt.test(t)}function ze(t){var e=-1,n=Array(t.size);return t.forEach((function(t,r){n[++e]=[r,t]})),n}function Ve(t,e){return function(n){return t(e(n))}}function Ge(t,e){for(var n=-1,r=t.length,i=0,o=[];++n<r;){var s=t[n];s!==e&&s!==a||(t[n]=a,o[i++]=n)}return o}function Ue(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}function We(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=[t,t]})),n}function qe(t){return Be(t)?function(t){var e=Rt.lastIndex=0;for(;Rt.test(t);)++e;return e}(t):me(t)}function Xe(t){return Be(t)?function(t){return t.match(Rt)||[]}(t):function(t){return t.split("")}(t)}var He=Pe({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var Ye=function t(e){var n,r=(e=null==e?Ht:Ye.defaults(Ht.Object(),e,Ye.pick(Ht,Dt))).Array,i=e.Date,ht=e.Error,dt=e.Function,pt=e.Math,gt=e.Object,vt=e.RegExp,yt=e.String,mt=e.TypeError,bt=r.prototype,_t=dt.prototype,xt=gt.prototype,wt=e["__core-js_shared__"],Et=_t.toString,St=xt.hasOwnProperty,Ot=0,Pt=(n=/[^.]+$/.exec(wt&&wt.keys&&wt.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",Ct=xt.toString,Mt=Et.call(gt),It=Ht._,At=vt("^"+Et.call(St).replace(X,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Tt=Kt?e.Buffer:void 0,Rt=e.Symbol,jt=e.Uint8Array,Gt=Tt?Tt.allocUnsafe:void 0,qt=Ve(gt.getPrototypeOf,gt),Xt=gt.create,Yt=xt.propertyIsEnumerable,Zt=bt.splice,Jt=Rt?Rt.isConcatSpreadable:void 0,Qt=Rt?Rt.iterator:void 0,me=Rt?Rt.toStringTag:void 0,Pe=function(){try{var t=$i(gt,"defineProperty");return t({},"",{}),t}catch(t){}}(),Ze=e.clearTimeout!==Ht.clearTimeout&&e.clearTimeout,Ke=i&&i.now!==Ht.Date.now&&i.now,Je=e.setTimeout!==Ht.setTimeout&&e.setTimeout,Qe=pt.ceil,$e=pt.floor,tn=gt.getOwnPropertySymbols,en=Tt?Tt.isBuffer:void 0,nn=e.isFinite,rn=bt.join,on=Ve(gt.keys,gt),an=pt.max,sn=pt.min,un=i.now,cn=e.parseInt,ln=pt.random,fn=bt.reverse,hn=$i(e,"DataView"),dn=$i(e,"Map"),pn=$i(e,"Promise"),gn=$i(e,"Set"),vn=$i(e,"WeakMap"),yn=$i(gt,"create"),mn=vn&&new vn,bn={},_n=Co(hn),xn=Co(dn),wn=Co(pn),En=Co(gn),Sn=Co(vn),On=Rt?Rt.prototype:void 0,Pn=On?On.valueOf:void 0,Cn=On?On.toString:void 0;function Mn(t){if(Wa(t)&&!La(t)&&!(t instanceof Nn)){if(t instanceof Tn)return t;if(St.call(t,"__wrapped__"))return Mo(t)}return new Tn(t)}var In=function(){function t(){}return function(e){if(!Ua(e))return{};if(Xt)return Xt(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();function An(){}function Tn(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=void 0}function Nn(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}function Ln(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Rn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function kn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function jn(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new kn;++e<n;)this.add(t[e])}function Fn(t){var e=this.__data__=new Rn(t);this.size=e.size}function Dn(t,e){var n=La(t),r=!n&&Na(t),i=!n&&!r&&Fa(t),o=!n&&!r&&!i&&Qa(t),a=n||r||i||o,s=a?Ie(t.length,yt):[],u=s.length;for(var c in t)!e&&!St.call(t,c)||a&&("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||ao(c,u))||s.push(c);return s}function Bn(t){var e=t.length;return e?t[jr(0,e-1)]:void 0}function zn(t,e){return So(yi(t),Zn(e,0,t.length))}function Vn(t){return So(yi(t))}function Gn(t,e,n){(void 0!==n&&!Ia(t[e],n)||void 0===n&&!(e in t))&&Hn(t,e,n)}function Un(t,e,n){var r=t[e];St.call(t,e)&&Ia(r,n)&&(void 0!==n||e in t)||Hn(t,e,n)}function Wn(t,e){for(var n=t.length;n--;)if(Ia(t[n][0],e))return n;return-1}function qn(t,e,n,r){return tr(t,(function(t,i,o){e(r,t,n(t),o)})),r}function Xn(t,e){return t&&mi(e,_s(e),t)}function Hn(t,e,n){"__proto__"==e&&Pe?Pe(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function Yn(t,e){for(var n=-1,i=e.length,o=r(i),a=null==t;++n<i;)o[n]=a?void 0:gs(t,e[n]);return o}function Zn(t,e,n){return t==t&&(void 0!==n&&(t=t<=n?t:n),void 0!==e&&(t=t>=e?t:e)),t}function Kn(t,e,n,r,i,o){var a,s=1&e,c=2&e,h=4&e;if(n&&(a=i?n(t,r,i,o):n(t)),void 0!==a)return a;if(!Ua(t))return t;var w=La(t);if(w){if(a=function(t){var e=t.length,n=new t.constructor(e);e&&"string"==typeof t[0]&&St.call(t,"index")&&(n.index=t.index,n.input=t.input);return n}(t),!s)return yi(t,a)}else{var L=no(t),R=L==d||L==p;if(Fa(t))return fi(t,s);if(L==y||L==u||R&&!i){if(a=c||R?{}:io(t),!s)return c?function(t,e){return mi(t,eo(t),e)}(t,function(t,e){return t&&mi(e,xs(e),t)}(a,t)):function(t,e){return mi(t,to(t),e)}(t,Xn(a,t))}else{if(!Vt[L])return i?t:{};a=function(t,e,n){var r=t.constructor;switch(e){case E:return hi(t);case l:case f:return new r(+t);case S:return function(t,e){var n=e?hi(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}(t,n);case O:case P:case C:case M:case I:case A:case"[object Uint8ClampedArray]":case T:case N:return di(t,n);case g:return new r;case v:case _:return new r(t);case m:return function(t){var e=new t.constructor(t.source,rt.exec(t));return e.lastIndex=t.lastIndex,e}(t);case b:return new r;case x:return i=t,Pn?gt(Pn.call(i)):{}}var i}(t,L,s)}}o||(o=new Fn);var k=o.get(t);if(k)return k;o.set(t,a),Za(t)?t.forEach((function(r){a.add(Kn(r,e,n,r,t,o))})):qa(t)&&t.forEach((function(r,i){a.set(i,Kn(r,e,n,i,t,o))}));var j=w?void 0:(h?c?Xi:qi:c?xs:_s)(t);return se(j||t,(function(r,i){j&&(r=t[i=r]),Un(a,i,Kn(r,e,n,i,t,o))})),a}function Jn(t,e,n){var r=n.length;if(null==t)return!r;for(t=gt(t);r--;){var i=n[r],o=e[i],a=t[i];if(void 0===a&&!(i in t)||!o(a))return!1}return!0}function Qn(t,e,n){if("function"!=typeof t)throw new mt(o);return _o((function(){t.apply(void 0,n)}),e)}function $n(t,e,n,r){var i=-1,o=fe,a=!0,s=t.length,u=[],c=e.length;if(!s)return u;n&&(e=de(e,Ae(n))),r?(o=he,a=!1):e.length>=200&&(o=Ne,a=!1,e=new jn(e));t:for(;++i<s;){var l=t[i],f=null==n?l:n(l);if(l=r||0!==l?l:0,a&&f==f){for(var h=c;h--;)if(e[h]===f)continue t;u.push(l)}else o(e,f,r)||u.push(l)}return u}Mn.templateSettings={escape:z,evaluate:V,interpolate:G,variable:"",imports:{_:Mn}},Mn.prototype=An.prototype,Mn.prototype.constructor=Mn,Tn.prototype=In(An.prototype),Tn.prototype.constructor=Tn,Nn.prototype=In(An.prototype),Nn.prototype.constructor=Nn,Ln.prototype.clear=function(){this.__data__=yn?yn(null):{},this.size=0},Ln.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},Ln.prototype.get=function(t){var e=this.__data__;if(yn){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return St.call(e,t)?e[t]:void 0},Ln.prototype.has=function(t){var e=this.__data__;return yn?void 0!==e[t]:St.call(e,t)},Ln.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=yn&&void 0===e?"__lodash_hash_undefined__":e,this},Rn.prototype.clear=function(){this.__data__=[],this.size=0},Rn.prototype.delete=function(t){var e=this.__data__,n=Wn(e,t);return!(n<0)&&(n==e.length-1?e.pop():Zt.call(e,n,1),--this.size,!0)},Rn.prototype.get=function(t){var e=this.__data__,n=Wn(e,t);return n<0?void 0:e[n][1]},Rn.prototype.has=function(t){return Wn(this.__data__,t)>-1},Rn.prototype.set=function(t,e){var n=this.__data__,r=Wn(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this},kn.prototype.clear=function(){this.size=0,this.__data__={hash:new Ln,map:new(dn||Rn),string:new Ln}},kn.prototype.delete=function(t){var e=Ji(this,t).delete(t);return this.size-=e?1:0,e},kn.prototype.get=function(t){return Ji(this,t).get(t)},kn.prototype.has=function(t){return Ji(this,t).has(t)},kn.prototype.set=function(t,e){var n=Ji(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this},jn.prototype.add=jn.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},jn.prototype.has=function(t){return this.__data__.has(t)},Fn.prototype.clear=function(){this.__data__=new Rn,this.size=0},Fn.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},Fn.prototype.get=function(t){return this.__data__.get(t)},Fn.prototype.has=function(t){return this.__data__.has(t)},Fn.prototype.set=function(t,e){var n=this.__data__;if(n instanceof Rn){var r=n.__data__;if(!dn||r.length<199)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new kn(r)}return n.set(t,e),this.size=n.size,this};var tr=xi(ur),er=xi(cr,!0);function nr(t,e){var n=!0;return tr(t,(function(t,r,i){return n=!!e(t,r,i)})),n}function rr(t,e,n){for(var r=-1,i=t.length;++r<i;){var o=t[r],a=e(o);if(null!=a&&(void 0===s?a==a&&!Ja(a):n(a,s)))var s=a,u=o}return u}function ir(t,e){var n=[];return tr(t,(function(t,r,i){e(t,r,i)&&n.push(t)})),n}function or(t,e,n,r,i){var o=-1,a=t.length;for(n||(n=oo),i||(i=[]);++o<a;){var s=t[o];e>0&&n(s)?e>1?or(s,e-1,n,r,i):pe(i,s):r||(i[i.length]=s)}return i}var ar=wi(),sr=wi(!0);function ur(t,e){return t&&ar(t,e,_s)}function cr(t,e){return t&&sr(t,e,_s)}function lr(t,e){return le(e,(function(e){return za(t[e])}))}function fr(t,e){for(var n=0,r=(e=si(e,t)).length;null!=t&&n<r;)t=t[Po(e[n++])];return n&&n==r?t:void 0}function hr(t,e,n){var r=e(t);return La(t)?r:pe(r,n(t))}function dr(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":me&&me in gt(t)?function(t){var e=St.call(t,me),n=t[me];try{t[me]=void 0;var r=!0}catch(t){}var i=Ct.call(t);r&&(e?t[me]=n:delete t[me]);return i}(t):function(t){return Ct.call(t)}(t)}function pr(t,e){return t>e}function gr(t,e){return null!=t&&St.call(t,e)}function vr(t,e){return null!=t&&e in gt(t)}function yr(t,e,n){for(var i=n?he:fe,o=t[0].length,a=t.length,s=a,u=r(a),c=1/0,l=[];s--;){var f=t[s];s&&e&&(f=de(f,Ae(e))),c=sn(f.length,c),u[s]=!n&&(e||o>=120&&f.length>=120)?new jn(s&&f):void 0}f=t[0];var h=-1,d=u[0];t:for(;++h<o&&l.length<c;){var p=f[h],g=e?e(p):p;if(p=n||0!==p?p:0,!(d?Ne(d,g):i(l,g,n))){for(s=a;--s;){var v=u[s];if(!(v?Ne(v,g):i(t[s],g,n)))continue t}d&&d.push(g),l.push(p)}}return l}function mr(t,e,n){var r=null==(t=vo(t,e=si(e,t)))?t:t[Po(Bo(e))];return null==r?void 0:oe(r,t,n)}function br(t){return Wa(t)&&dr(t)==u}function _r(t,e,n,r,i){return t===e||(null==t||null==e||!Wa(t)&&!Wa(e)?t!=t&&e!=e:function(t,e,n,r,i,o){var a=La(t),s=La(e),d=a?c:no(t),p=s?c:no(e),w=(d=d==u?y:d)==y,O=(p=p==u?y:p)==y,P=d==p;if(P&&Fa(t)){if(!Fa(e))return!1;a=!0,w=!1}if(P&&!w)return o||(o=new Fn),a||Qa(t)?Ui(t,e,n,r,i,o):function(t,e,n,r,i,o,a){switch(n){case S:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case E:return!(t.byteLength!=e.byteLength||!o(new jt(t),new jt(e)));case l:case f:case v:return Ia(+t,+e);case h:return t.name==e.name&&t.message==e.message;case m:case _:return t==e+"";case g:var s=ze;case b:var u=1&r;if(s||(s=Ue),t.size!=e.size&&!u)return!1;var c=a.get(t);if(c)return c==e;r|=2,a.set(t,e);var d=Ui(s(t),s(e),r,i,o,a);return a.delete(t),d;case x:if(Pn)return Pn.call(t)==Pn.call(e)}return!1}(t,e,d,n,r,i,o);if(!(1&n)){var C=w&&St.call(t,"__wrapped__"),M=O&&St.call(e,"__wrapped__");if(C||M){var I=C?t.value():t,A=M?e.value():e;return o||(o=new Fn),i(I,A,n,r,o)}}if(!P)return!1;return o||(o=new Fn),function(t,e,n,r,i,o){var a=1&n,s=qi(t),u=s.length,c=qi(e).length;if(u!=c&&!a)return!1;var l=u;for(;l--;){var f=s[l];if(!(a?f in e:St.call(e,f)))return!1}var h=o.get(t);if(h&&o.get(e))return h==e;var d=!0;o.set(t,e),o.set(e,t);var p=a;for(;++l<u;){f=s[l];var g=t[f],v=e[f];if(r)var y=a?r(v,g,f,e,t,o):r(g,v,f,t,e,o);if(!(void 0===y?g===v||i(g,v,n,r,o):y)){d=!1;break}p||(p="constructor"==f)}if(d&&!p){var m=t.constructor,b=e.constructor;m==b||!("constructor"in t)||!("constructor"in e)||"function"==typeof m&&m instanceof m&&"function"==typeof b&&b instanceof b||(d=!1)}return o.delete(t),o.delete(e),d}(t,e,n,r,i,o)}(t,e,n,r,_r,i))}function xr(t,e,n,r){var i=n.length,o=i,a=!r;if(null==t)return!o;for(t=gt(t);i--;){var s=n[i];if(a&&s[2]?s[1]!==t[s[0]]:!(s[0]in t))return!1}for(;++i<o;){var u=(s=n[i])[0],c=t[u],l=s[1];if(a&&s[2]){if(void 0===c&&!(u in t))return!1}else{var f=new Fn;if(r)var h=r(c,l,u,t,e,f);if(!(void 0===h?_r(l,c,3,r,f):h))return!1}}return!0}function wr(t){return!(!Ua(t)||(e=t,Pt&&Pt in e))&&(za(t)?At:at).test(Co(t));var e}function Er(t){return"function"==typeof t?t:null==t?Xs:"object"==typeof t?La(t)?Ir(t[0],t[1]):Mr(t):eu(t)}function Sr(t){if(!fo(t))return on(t);var e=[];for(var n in gt(t))St.call(t,n)&&"constructor"!=n&&e.push(n);return e}function Or(t){if(!Ua(t))return function(t){var e=[];if(null!=t)for(var n in gt(t))e.push(n);return e}(t);var e=fo(t),n=[];for(var r in t)("constructor"!=r||!e&&St.call(t,r))&&n.push(r);return n}function Pr(t,e){return t<e}function Cr(t,e){var n=-1,i=ka(t)?r(t.length):[];return tr(t,(function(t,r,o){i[++n]=e(t,r,o)})),i}function Mr(t){var e=Qi(t);return 1==e.length&&e[0][2]?po(e[0][0],e[0][1]):function(n){return n===t||xr(n,t,e)}}function Ir(t,e){return uo(t)&&ho(e)?po(Po(t),e):function(n){var r=gs(n,t);return void 0===r&&r===e?vs(n,t):_r(e,r,3)}}function Ar(t,e,n,r,i){t!==e&&ar(e,(function(o,a){if(i||(i=new Fn),Ua(o))!function(t,e,n,r,i,o,a){var s=mo(t,n),u=mo(e,n),c=a.get(u);if(c)return void Gn(t,n,c);var l=o?o(s,u,n+"",t,e,a):void 0,f=void 0===l;if(f){var h=La(u),d=!h&&Fa(u),p=!h&&!d&&Qa(u);l=u,h||d||p?La(s)?l=s:ja(s)?l=yi(s):d?(f=!1,l=fi(u,!0)):p?(f=!1,l=di(u,!0)):l=[]:Ha(u)||Na(u)?(l=s,Na(s)?l=as(s):Ua(s)&&!za(s)||(l=io(u))):f=!1}f&&(a.set(u,l),i(l,u,r,o,a),a.delete(u));Gn(t,n,l)}(t,e,a,n,Ar,r,i);else{var s=r?r(mo(t,a),o,a+"",t,e,i):void 0;void 0===s&&(s=o),Gn(t,a,s)}}),xs)}function Tr(t,e){var n=t.length;if(n)return ao(e+=e<0?n:0,n)?t[e]:void 0}function Nr(t,e,n){var r=-1;return e=de(e.length?e:[Xs],Ae(Ki())),function(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}(Cr(t,(function(t,n,i){return{criteria:de(e,(function(e){return e(t)})),index:++r,value:t}})),(function(t,e){return function(t,e,n){var r=-1,i=t.criteria,o=e.criteria,a=i.length,s=n.length;for(;++r<a;){var u=pi(i[r],o[r]);if(u){if(r>=s)return u;var c=n[r];return u*("desc"==c?-1:1)}}return t.index-e.index}(t,e,n)}))}function Lr(t,e,n){for(var r=-1,i=e.length,o={};++r<i;){var a=e[r],s=fr(t,a);n(s,a)&&Vr(o,si(a,t),s)}return o}function Rr(t,e,n,r){var i=r?we:xe,o=-1,a=e.length,s=t;for(t===e&&(e=yi(e)),n&&(s=de(t,Ae(n)));++o<a;)for(var u=0,c=e[o],l=n?n(c):c;(u=i(s,l,u,r))>-1;)s!==t&&Zt.call(s,u,1),Zt.call(t,u,1);return t}function kr(t,e){for(var n=t?e.length:0,r=n-1;n--;){var i=e[n];if(n==r||i!==o){var o=i;ao(i)?Zt.call(t,i,1):$r(t,i)}}return t}function jr(t,e){return t+$e(ln()*(e-t+1))}function Fr(t,e){var n="";if(!t||e<1||e>9007199254740991)return n;do{e%2&&(n+=t),(e=$e(e/2))&&(t+=t)}while(e);return n}function Dr(t,e){return xo(go(t,e,Xs),t+"")}function Br(t){return Bn(Is(t))}function zr(t,e){var n=Is(t);return So(n,Zn(e,0,n.length))}function Vr(t,e,n,r){if(!Ua(t))return t;for(var i=-1,o=(e=si(e,t)).length,a=o-1,s=t;null!=s&&++i<o;){var u=Po(e[i]),c=n;if(i!=a){var l=s[u];void 0===(c=r?r(l,u,s):void 0)&&(c=Ua(l)?l:ao(e[i+1])?[]:{})}Un(s,u,c),s=s[u]}return t}var Gr=mn?function(t,e){return mn.set(t,e),t}:Xs,Ur=Pe?function(t,e){return Pe(t,"toString",{configurable:!0,enumerable:!1,value:Us(e),writable:!0})}:Xs;function Wr(t){return So(Is(t))}function qr(t,e,n){var i=-1,o=t.length;e<0&&(e=-e>o?0:o+e),(n=n>o?o:n)<0&&(n+=o),o=e>n?0:n-e>>>0,e>>>=0;for(var a=r(o);++i<o;)a[i]=t[i+e];return a}function Xr(t,e){var n;return tr(t,(function(t,r,i){return!(n=e(t,r,i))})),!!n}function Hr(t,e,n){var r=0,i=null==t?r:t.length;if("number"==typeof e&&e==e&&i<=2147483647){for(;r<i;){var o=r+i>>>1,a=t[o];null!==a&&!Ja(a)&&(n?a<=e:a<e)?r=o+1:i=o}return i}return Yr(t,e,Xs,n)}function Yr(t,e,n,r){e=n(e);for(var i=0,o=null==t?0:t.length,a=e!=e,s=null===e,u=Ja(e),c=void 0===e;i<o;){var l=$e((i+o)/2),f=n(t[l]),h=void 0!==f,d=null===f,p=f==f,g=Ja(f);if(a)var v=r||p;else v=c?p&&(r||h):s?p&&h&&(r||!d):u?p&&h&&!d&&(r||!g):!d&&!g&&(r?f<=e:f<e);v?i=l+1:o=l}return sn(o,4294967294)}function Zr(t,e){for(var n=-1,r=t.length,i=0,o=[];++n<r;){var a=t[n],s=e?e(a):a;if(!n||!Ia(s,u)){var u=s;o[i++]=0===a?0:a}}return o}function Kr(t){return"number"==typeof t?t:Ja(t)?NaN:+t}function Jr(t){if("string"==typeof t)return t;if(La(t))return de(t,Jr)+"";if(Ja(t))return Cn?Cn.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function Qr(t,e,n){var r=-1,i=fe,o=t.length,a=!0,s=[],u=s;if(n)a=!1,i=he;else if(o>=200){var c=e?null:Fi(t);if(c)return Ue(c);a=!1,i=Ne,u=new jn}else u=e?[]:s;t:for(;++r<o;){var l=t[r],f=e?e(l):l;if(l=n||0!==l?l:0,a&&f==f){for(var h=u.length;h--;)if(u[h]===f)continue t;e&&u.push(f),s.push(l)}else i(u,f,n)||(u!==s&&u.push(f),s.push(l))}return s}function $r(t,e){return null==(t=vo(t,e=si(e,t)))||delete t[Po(Bo(e))]}function ti(t,e,n,r){return Vr(t,e,n(fr(t,e)),r)}function ei(t,e,n,r){for(var i=t.length,o=r?i:-1;(r?o--:++o<i)&&e(t[o],o,t););return n?qr(t,r?0:o,r?o+1:i):qr(t,r?o+1:0,r?i:o)}function ni(t,e){var n=t;return n instanceof Nn&&(n=n.value()),ge(e,(function(t,e){return e.func.apply(e.thisArg,pe([t],e.args))}),n)}function ri(t,e,n){var i=t.length;if(i<2)return i?Qr(t[0]):[];for(var o=-1,a=r(i);++o<i;)for(var s=t[o],u=-1;++u<i;)u!=o&&(a[o]=$n(a[o]||s,t[u],e,n));return Qr(or(a,1),e,n)}function ii(t,e,n){for(var r=-1,i=t.length,o=e.length,a={};++r<i;){var s=r<o?e[r]:void 0;n(a,t[r],s)}return a}function oi(t){return ja(t)?t:[]}function ai(t){return"function"==typeof t?t:Xs}function si(t,e){return La(t)?t:uo(t,e)?[t]:Oo(ss(t))}var ui=Dr;function ci(t,e,n){var r=t.length;return n=void 0===n?r:n,!e&&n>=r?t:qr(t,e,n)}var li=Ze||function(t){return Ht.clearTimeout(t)};function fi(t,e){if(e)return t.slice();var n=t.length,r=Gt?Gt(n):new t.constructor(n);return t.copy(r),r}function hi(t){var e=new t.constructor(t.byteLength);return new jt(e).set(new jt(t)),e}function di(t,e){var n=e?hi(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}function pi(t,e){if(t!==e){var n=void 0!==t,r=null===t,i=t==t,o=Ja(t),a=void 0!==e,s=null===e,u=e==e,c=Ja(e);if(!s&&!c&&!o&&t>e||o&&a&&u&&!s&&!c||r&&a&&u||!n&&u||!i)return 1;if(!r&&!o&&!c&&t<e||c&&n&&i&&!r&&!o||s&&n&&i||!a&&i||!u)return-1}return 0}function gi(t,e,n,i){for(var o=-1,a=t.length,s=n.length,u=-1,c=e.length,l=an(a-s,0),f=r(c+l),h=!i;++u<c;)f[u]=e[u];for(;++o<s;)(h||o<a)&&(f[n[o]]=t[o]);for(;l--;)f[u++]=t[o++];return f}function vi(t,e,n,i){for(var o=-1,a=t.length,s=-1,u=n.length,c=-1,l=e.length,f=an(a-u,0),h=r(f+l),d=!i;++o<f;)h[o]=t[o];for(var p=o;++c<l;)h[p+c]=e[c];for(;++s<u;)(d||o<a)&&(h[p+n[s]]=t[o++]);return h}function yi(t,e){var n=-1,i=t.length;for(e||(e=r(i));++n<i;)e[n]=t[n];return e}function mi(t,e,n,r){var i=!n;n||(n={});for(var o=-1,a=e.length;++o<a;){var s=e[o],u=r?r(n[s],t[s],s,n,t):void 0;void 0===u&&(u=t[s]),i?Hn(n,s,u):Un(n,s,u)}return n}function bi(t,e){return function(n,r){var i=La(n)?ae:qn,o=e?e():{};return i(n,t,Ki(r,2),o)}}function _i(t){return Dr((function(e,n){var r=-1,i=n.length,o=i>1?n[i-1]:void 0,a=i>2?n[2]:void 0;for(o=t.length>3&&"function"==typeof o?(i--,o):void 0,a&&so(n[0],n[1],a)&&(o=i<3?void 0:o,i=1),e=gt(e);++r<i;){var s=n[r];s&&t(e,s,r,o)}return e}))}function xi(t,e){return function(n,r){if(null==n)return n;if(!ka(n))return t(n,r);for(var i=n.length,o=e?i:-1,a=gt(n);(e?o--:++o<i)&&!1!==r(a[o],o,a););return n}}function wi(t){return function(e,n,r){for(var i=-1,o=gt(e),a=r(e),s=a.length;s--;){var u=a[t?s:++i];if(!1===n(o[u],u,o))break}return e}}function Ei(t){return function(e){var n=Be(e=ss(e))?Xe(e):void 0,r=n?n[0]:e.charAt(0),i=n?ci(n,1).join(""):e.slice(1);return r[t]()+i}}function Si(t){return function(e){return ge(zs(Ns(e).replace(Nt,"")),t,"")}}function Oi(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var n=In(t.prototype),r=t.apply(n,e);return Ua(r)?r:n}}function Pi(t){return function(e,n,r){var i=gt(e);if(!ka(e)){var o=Ki(n,3);e=_s(e),n=function(t){return o(i[t],t,i)}}var a=t(e,n,r);return a>-1?i[o?e[a]:a]:void 0}}function Ci(t){return Wi((function(e){var n=e.length,r=n,i=Tn.prototype.thru;for(t&&e.reverse();r--;){var a=e[r];if("function"!=typeof a)throw new mt(o);if(i&&!s&&"wrapper"==Yi(a))var s=new Tn([],!0)}for(r=s?r:n;++r<n;){var u=Yi(a=e[r]),c="wrapper"==u?Hi(a):void 0;s=c&&co(c[0])&&424==c[1]&&!c[4].length&&1==c[9]?s[Yi(c[0])].apply(s,c[3]):1==a.length&&co(a)?s[u]():s.thru(a)}return function(){var t=arguments,r=t[0];if(s&&1==t.length&&La(r))return s.plant(r).value();for(var i=0,o=n?e[i].apply(this,t):r;++i<n;)o=e[i].call(this,o);return o}}))}function Mi(t,e,n,i,o,a,s,u,c,l){var f=128&e,h=1&e,d=2&e,p=24&e,g=512&e,v=d?void 0:Oi(t);return function y(){for(var m=arguments.length,b=r(m),_=m;_--;)b[_]=arguments[_];if(p)var x=Zi(y),w=ke(b,x);if(i&&(b=gi(b,i,o,p)),a&&(b=vi(b,a,s,p)),m-=w,p&&m<l){var E=Ge(b,x);return ki(t,e,Mi,y.placeholder,n,b,E,u,c,l-m)}var S=h?n:this,O=d?S[t]:t;return m=b.length,u?b=yo(b,u):g&&m>1&&b.reverse(),f&&c<m&&(b.length=c),this&&this!==Ht&&this instanceof y&&(O=v||Oi(O)),O.apply(S,b)}}function Ii(t,e){return function(n,r){return function(t,e,n,r){return ur(t,(function(t,i,o){e(r,n(t),i,o)})),r}(n,t,e(r),{})}}function Ai(t,e){return function(n,r){var i;if(void 0===n&&void 0===r)return e;if(void 0!==n&&(i=n),void 0!==r){if(void 0===i)return r;"string"==typeof n||"string"==typeof r?(n=Jr(n),r=Jr(r)):(n=Kr(n),r=Kr(r)),i=t(n,r)}return i}}function Ti(t){return Wi((function(e){return e=de(e,Ae(Ki())),Dr((function(n){var r=this;return t(e,(function(t){return oe(t,r,n)}))}))}))}function Ni(t,e){var n=(e=void 0===e?" ":Jr(e)).length;if(n<2)return n?Fr(e,t):e;var r=Fr(e,Qe(t/qe(e)));return Be(e)?ci(Xe(r),0,t).join(""):r.slice(0,t)}function Li(t){return function(e,n,i){return i&&"number"!=typeof i&&so(e,n,i)&&(n=i=void 0),e=ns(e),void 0===n?(n=e,e=0):n=ns(n),function(t,e,n,i){for(var o=-1,a=an(Qe((e-t)/(n||1)),0),s=r(a);a--;)s[i?a:++o]=t,t+=n;return s}(e,n,i=void 0===i?e<n?1:-1:ns(i),t)}}function Ri(t){return function(e,n){return"string"==typeof e&&"string"==typeof n||(e=os(e),n=os(n)),t(e,n)}}function ki(t,e,n,r,i,o,a,s,u,c){var l=8&e;e|=l?32:64,4&(e&=~(l?64:32))||(e&=-4);var f=[t,e,i,l?o:void 0,l?a:void 0,l?void 0:o,l?void 0:a,s,u,c],h=n.apply(void 0,f);return co(t)&&bo(h,f),h.placeholder=r,wo(h,t,e)}function ji(t){var e=pt[t];return function(t,n){if(t=os(t),(n=null==n?0:sn(rs(n),292))&&nn(t)){var r=(ss(t)+"e").split("e");return+((r=(ss(e(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return e(t)}}var Fi=gn&&1/Ue(new gn([,-0]))[1]==1/0?function(t){return new gn(t)}:Js;function Di(t){return function(e){var n=no(e);return n==g?ze(e):n==b?We(e):function(t,e){return de(e,(function(e){return[e,t[e]]}))}(e,t(e))}}function Bi(t,e,n,i,s,u,c,l){var f=2&e;if(!f&&"function"!=typeof t)throw new mt(o);var h=i?i.length:0;if(h||(e&=-97,i=s=void 0),c=void 0===c?c:an(rs(c),0),l=void 0===l?l:rs(l),h-=s?s.length:0,64&e){var d=i,p=s;i=s=void 0}var g=f?void 0:Hi(t),v=[t,e,n,i,s,d,p,u,c,l];if(g&&function(t,e){var n=t[1],r=e[1],i=n|r,o=i<131,s=128==r&&8==n||128==r&&256==n&&t[7].length<=e[8]||384==r&&e[7].length<=e[8]&&8==n;if(!o&&!s)return t;1&r&&(t[2]=e[2],i|=1&n?0:4);var u=e[3];if(u){var c=t[3];t[3]=c?gi(c,u,e[4]):u,t[4]=c?Ge(t[3],a):e[4]}(u=e[5])&&(c=t[5],t[5]=c?vi(c,u,e[6]):u,t[6]=c?Ge(t[5],a):e[6]);(u=e[7])&&(t[7]=u);128&r&&(t[8]=null==t[8]?e[8]:sn(t[8],e[8]));null==t[9]&&(t[9]=e[9]);t[0]=e[0],t[1]=i}(v,g),t=v[0],e=v[1],n=v[2],i=v[3],s=v[4],!(l=v[9]=void 0===v[9]?f?0:t.length:an(v[9]-h,0))&&24&e&&(e&=-25),e&&1!=e)y=8==e||16==e?function(t,e,n){var i=Oi(t);return function o(){for(var a=arguments.length,s=r(a),u=a,c=Zi(o);u--;)s[u]=arguments[u];var l=a<3&&s[0]!==c&&s[a-1]!==c?[]:Ge(s,c);if((a-=l.length)<n)return ki(t,e,Mi,o.placeholder,void 0,s,l,void 0,void 0,n-a);var f=this&&this!==Ht&&this instanceof o?i:t;return oe(f,this,s)}}(t,e,l):32!=e&&33!=e||s.length?Mi.apply(void 0,v):function(t,e,n,i){var o=1&e,a=Oi(t);return function e(){for(var s=-1,u=arguments.length,c=-1,l=i.length,f=r(l+u),h=this&&this!==Ht&&this instanceof e?a:t;++c<l;)f[c]=i[c];for(;u--;)f[c++]=arguments[++s];return oe(h,o?n:this,f)}}(t,e,n,i);else var y=function(t,e,n){var r=1&e,i=Oi(t);return function e(){var o=this&&this!==Ht&&this instanceof e?i:t;return o.apply(r?n:this,arguments)}}(t,e,n);return wo((g?Gr:bo)(y,v),t,e)}function zi(t,e,n,r){return void 0===t||Ia(t,xt[n])&&!St.call(r,n)?e:t}function Vi(t,e,n,r,i,o){return Ua(t)&&Ua(e)&&(o.set(e,t),Ar(t,e,void 0,Vi,o),o.delete(e)),t}function Gi(t){return Ha(t)?void 0:t}function Ui(t,e,n,r,i,o){var a=1&n,s=t.length,u=e.length;if(s!=u&&!(a&&u>s))return!1;var c=o.get(t);if(c&&o.get(e))return c==e;var l=-1,f=!0,h=2&n?new jn:void 0;for(o.set(t,e),o.set(e,t);++l<s;){var d=t[l],p=e[l];if(r)var g=a?r(p,d,l,e,t,o):r(d,p,l,t,e,o);if(void 0!==g){if(g)continue;f=!1;break}if(h){if(!ye(e,(function(t,e){if(!Ne(h,e)&&(d===t||i(d,t,n,r,o)))return h.push(e)}))){f=!1;break}}else if(d!==p&&!i(d,p,n,r,o)){f=!1;break}}return o.delete(t),o.delete(e),f}function Wi(t){return xo(go(t,void 0,Ro),t+"")}function qi(t){return hr(t,_s,to)}function Xi(t){return hr(t,xs,eo)}var Hi=mn?function(t){return mn.get(t)}:Js;function Yi(t){for(var e=t.name+"",n=bn[e],r=St.call(bn,e)?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==t)return i.name}return e}function Zi(t){return(St.call(Mn,"placeholder")?Mn:t).placeholder}function Ki(){var t=Mn.iteratee||Hs;return t=t===Hs?Er:t,arguments.length?t(arguments[0],arguments[1]):t}function Ji(t,e){var n,r,i=t.__data__;return("string"==(r=typeof(n=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof e?"string":"hash"]:i.map}function Qi(t){for(var e=_s(t),n=e.length;n--;){var r=e[n],i=t[r];e[n]=[r,i,ho(i)]}return e}function $i(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return wr(n)?n:void 0}var to=tn?function(t){return null==t?[]:(t=gt(t),le(tn(t),(function(e){return Yt.call(t,e)})))}:iu,eo=tn?function(t){for(var e=[];t;)pe(e,to(t)),t=qt(t);return e}:iu,no=dr;function ro(t,e,n){for(var r=-1,i=(e=si(e,t)).length,o=!1;++r<i;){var a=Po(e[r]);if(!(o=null!=t&&n(t,a)))break;t=t[a]}return o||++r!=i?o:!!(i=null==t?0:t.length)&&Ga(i)&&ao(a,i)&&(La(t)||Na(t))}function io(t){return"function"!=typeof t.constructor||fo(t)?{}:In(qt(t))}function oo(t){return La(t)||Na(t)||!!(Jt&&t&&t[Jt])}function ao(t,e){var n=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==n||"symbol"!=n&&ut.test(t))&&t>-1&&t%1==0&&t<e}function so(t,e,n){if(!Ua(n))return!1;var r=typeof e;return!!("number"==r?ka(n)&&ao(e,n.length):"string"==r&&e in n)&&Ia(n[e],t)}function uo(t,e){if(La(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!Ja(t))||(W.test(t)||!U.test(t)||null!=e&&t in gt(e))}function co(t){var e=Yi(t),n=Mn[e];if("function"!=typeof n||!(e in Nn.prototype))return!1;if(t===n)return!0;var r=Hi(n);return!!r&&t===r[0]}(hn&&no(new hn(new ArrayBuffer(1)))!=S||dn&&no(new dn)!=g||pn&&"[object Promise]"!=no(pn.resolve())||gn&&no(new gn)!=b||vn&&no(new vn)!=w)&&(no=function(t){var e=dr(t),n=e==y?t.constructor:void 0,r=n?Co(n):"";if(r)switch(r){case _n:return S;case xn:return g;case wn:return"[object Promise]";case En:return b;case Sn:return w}return e});var lo=wt?za:ou;function fo(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||xt)}function ho(t){return t==t&&!Ua(t)}function po(t,e){return function(n){return null!=n&&(n[t]===e&&(void 0!==e||t in gt(n)))}}function go(t,e,n){return e=an(void 0===e?t.length-1:e,0),function(){for(var i=arguments,o=-1,a=an(i.length-e,0),s=r(a);++o<a;)s[o]=i[e+o];o=-1;for(var u=r(e+1);++o<e;)u[o]=i[o];return u[e]=n(s),oe(t,this,u)}}function vo(t,e){return e.length<2?t:fr(t,qr(e,0,-1))}function yo(t,e){for(var n=t.length,r=sn(e.length,n),i=yi(t);r--;){var o=e[r];t[r]=ao(o,n)?i[o]:void 0}return t}function mo(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}var bo=Eo(Gr),_o=Je||function(t,e){return Ht.setTimeout(t,e)},xo=Eo(Ur);function wo(t,e,n){var r=e+"";return xo(t,function(t,e){var n=e.length;if(!n)return t;var r=n-1;return e[r]=(n>1?"& ":"")+e[r],e=e.join(n>2?", ":" "),t.replace(J,"{\n/* [wrapped with "+e+"] */\n")}(r,function(t,e){return se(s,(function(n){var r="_."+n[0];e&n[1]&&!fe(t,r)&&t.push(r)})),t.sort()}(function(t){var e=t.match(Q);return e?e[1].split($):[]}(r),n)))}function Eo(t){var e=0,n=0;return function(){var r=un(),i=16-(r-n);if(n=r,i>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}function So(t,e){var n=-1,r=t.length,i=r-1;for(e=void 0===e?r:e;++n<e;){var o=jr(n,i),a=t[o];t[o]=t[n],t[n]=a}return t.length=e,t}var Oo=function(t){var e=Ea(t,(function(t){return 500===n.size&&n.clear(),t})),n=e.cache;return e}((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(q,(function(t,n,r,i){e.push(r?i.replace(et,"$1"):n||t)})),e}));function Po(t){if("string"==typeof t||Ja(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function Co(t){if(null!=t){try{return Et.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function Mo(t){if(t instanceof Nn)return t.clone();var e=new Tn(t.__wrapped__,t.__chain__);return e.__actions__=yi(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}var Io=Dr((function(t,e){return ja(t)?$n(t,or(e,1,ja,!0)):[]})),Ao=Dr((function(t,e){var n=Bo(e);return ja(n)&&(n=void 0),ja(t)?$n(t,or(e,1,ja,!0),Ki(n,2)):[]})),To=Dr((function(t,e){var n=Bo(e);return ja(n)&&(n=void 0),ja(t)?$n(t,or(e,1,ja,!0),void 0,n):[]}));function No(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=null==n?0:rs(n);return i<0&&(i=an(r+i,0)),_e(t,Ki(e,3),i)}function Lo(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=r-1;return void 0!==n&&(i=rs(n),i=n<0?an(r+i,0):sn(i,r-1)),_e(t,Ki(e,3),i,!0)}function Ro(t){return(null==t?0:t.length)?or(t,1):[]}function ko(t){return t&&t.length?t[0]:void 0}var jo=Dr((function(t){var e=de(t,oi);return e.length&&e[0]===t[0]?yr(e):[]})),Fo=Dr((function(t){var e=Bo(t),n=de(t,oi);return e===Bo(n)?e=void 0:n.pop(),n.length&&n[0]===t[0]?yr(n,Ki(e,2)):[]})),Do=Dr((function(t){var e=Bo(t),n=de(t,oi);return(e="function"==typeof e?e:void 0)&&n.pop(),n.length&&n[0]===t[0]?yr(n,void 0,e):[]}));function Bo(t){var e=null==t?0:t.length;return e?t[e-1]:void 0}var zo=Dr(Vo);function Vo(t,e){return t&&t.length&&e&&e.length?Rr(t,e):t}var Go=Wi((function(t,e){var n=null==t?0:t.length,r=Yn(t,e);return kr(t,de(e,(function(t){return ao(t,n)?+t:t})).sort(pi)),r}));function Uo(t){return null==t?t:fn.call(t)}var Wo=Dr((function(t){return Qr(or(t,1,ja,!0))})),qo=Dr((function(t){var e=Bo(t);return ja(e)&&(e=void 0),Qr(or(t,1,ja,!0),Ki(e,2))})),Xo=Dr((function(t){var e=Bo(t);return e="function"==typeof e?e:void 0,Qr(or(t,1,ja,!0),void 0,e)}));function Ho(t){if(!t||!t.length)return[];var e=0;return t=le(t,(function(t){if(ja(t))return e=an(t.length,e),!0})),Ie(e,(function(e){return de(t,Oe(e))}))}function Yo(t,e){if(!t||!t.length)return[];var n=Ho(t);return null==e?n:de(n,(function(t){return oe(e,void 0,t)}))}var Zo=Dr((function(t,e){return ja(t)?$n(t,e):[]})),Ko=Dr((function(t){return ri(le(t,ja))})),Jo=Dr((function(t){var e=Bo(t);return ja(e)&&(e=void 0),ri(le(t,ja),Ki(e,2))})),Qo=Dr((function(t){var e=Bo(t);return e="function"==typeof e?e:void 0,ri(le(t,ja),void 0,e)})),$o=Dr(Ho);var ta=Dr((function(t){var e=t.length,n=e>1?t[e-1]:void 0;return n="function"==typeof n?(t.pop(),n):void 0,Yo(t,n)}));function ea(t){var e=Mn(t);return e.__chain__=!0,e}function na(t,e){return e(t)}var ra=Wi((function(t){var e=t.length,n=e?t[0]:0,r=this.__wrapped__,i=function(e){return Yn(e,t)};return!(e>1||this.__actions__.length)&&r instanceof Nn&&ao(n)?((r=r.slice(n,+n+(e?1:0))).__actions__.push({func:na,args:[i],thisArg:void 0}),new Tn(r,this.__chain__).thru((function(t){return e&&!t.length&&t.push(void 0),t}))):this.thru(i)}));var ia=bi((function(t,e,n){St.call(t,n)?++t[n]:Hn(t,n,1)}));var oa=Pi(No),aa=Pi(Lo);function sa(t,e){return(La(t)?se:tr)(t,Ki(e,3))}function ua(t,e){return(La(t)?ue:er)(t,Ki(e,3))}var ca=bi((function(t,e,n){St.call(t,n)?t[n].push(e):Hn(t,n,[e])}));var la=Dr((function(t,e,n){var i=-1,o="function"==typeof e,a=ka(t)?r(t.length):[];return tr(t,(function(t){a[++i]=o?oe(e,t,n):mr(t,e,n)})),a})),fa=bi((function(t,e,n){Hn(t,n,e)}));function ha(t,e){return(La(t)?de:Cr)(t,Ki(e,3))}var da=bi((function(t,e,n){t[n?0:1].push(e)}),(function(){return[[],[]]}));var pa=Dr((function(t,e){if(null==t)return[];var n=e.length;return n>1&&so(t,e[0],e[1])?e=[]:n>2&&so(e[0],e[1],e[2])&&(e=[e[0]]),Nr(t,or(e,1),[])})),ga=Ke||function(){return Ht.Date.now()};function va(t,e,n){return e=n?void 0:e,Bi(t,128,void 0,void 0,void 0,void 0,e=t&&null==e?t.length:e)}function ya(t,e){var n;if("function"!=typeof e)throw new mt(o);return t=rs(t),function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=void 0),n}}var ma=Dr((function(t,e,n){var r=1;if(n.length){var i=Ge(n,Zi(ma));r|=32}return Bi(t,r,e,n,i)})),ba=Dr((function(t,e,n){var r=3;if(n.length){var i=Ge(n,Zi(ba));r|=32}return Bi(e,r,t,n,i)}));function _a(t,e,n){var r,i,a,s,u,c,l=0,f=!1,h=!1,d=!0;if("function"!=typeof t)throw new mt(o);function p(e){var n=r,o=i;return r=i=void 0,l=e,s=t.apply(o,n)}function g(t){return l=t,u=_o(y,e),f?p(t):s}function v(t){var n=t-c;return void 0===c||n>=e||n<0||h&&t-l>=a}function y(){var t=ga();if(v(t))return m(t);u=_o(y,function(t){var n=e-(t-c);return h?sn(n,a-(t-l)):n}(t))}function m(t){return u=void 0,d&&r?p(t):(r=i=void 0,s)}function b(){var t=ga(),n=v(t);if(r=arguments,i=this,c=t,n){if(void 0===u)return g(c);if(h)return li(u),u=_o(y,e),p(c)}return void 0===u&&(u=_o(y,e)),s}return e=os(e)||0,Ua(n)&&(f=!!n.leading,a=(h="maxWait"in n)?an(os(n.maxWait)||0,e):a,d="trailing"in n?!!n.trailing:d),b.cancel=function(){void 0!==u&&li(u),l=0,r=c=i=u=void 0},b.flush=function(){return void 0===u?s:m(ga())},b}var xa=Dr((function(t,e){return Qn(t,1,e)})),wa=Dr((function(t,e,n){return Qn(t,os(e)||0,n)}));function Ea(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new mt(o);var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=t.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(Ea.Cache||kn),n}function Sa(t){if("function"!=typeof t)throw new mt(o);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}Ea.Cache=kn;var Oa=ui((function(t,e){var n=(e=1==e.length&&La(e[0])?de(e[0],Ae(Ki())):de(or(e,1),Ae(Ki()))).length;return Dr((function(r){for(var i=-1,o=sn(r.length,n);++i<o;)r[i]=e[i].call(this,r[i]);return oe(t,this,r)}))})),Pa=Dr((function(t,e){return Bi(t,32,void 0,e,Ge(e,Zi(Pa)))})),Ca=Dr((function(t,e){return Bi(t,64,void 0,e,Ge(e,Zi(Ca)))})),Ma=Wi((function(t,e){return Bi(t,256,void 0,void 0,void 0,e)}));function Ia(t,e){return t===e||t!=t&&e!=e}var Aa=Ri(pr),Ta=Ri((function(t,e){return t>=e})),Na=br(function(){return arguments}())?br:function(t){return Wa(t)&&St.call(t,"callee")&&!Yt.call(t,"callee")},La=r.isArray,Ra=$t?Ae($t):function(t){return Wa(t)&&dr(t)==E};function ka(t){return null!=t&&Ga(t.length)&&!za(t)}function ja(t){return Wa(t)&&ka(t)}var Fa=en||ou,Da=te?Ae(te):function(t){return Wa(t)&&dr(t)==f};function Ba(t){if(!Wa(t))return!1;var e=dr(t);return e==h||"[object DOMException]"==e||"string"==typeof t.message&&"string"==typeof t.name&&!Ha(t)}function za(t){if(!Ua(t))return!1;var e=dr(t);return e==d||e==p||"[object AsyncFunction]"==e||"[object Proxy]"==e}function Va(t){return"number"==typeof t&&t==rs(t)}function Ga(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}function Ua(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function Wa(t){return null!=t&&"object"==typeof t}var qa=ee?Ae(ee):function(t){return Wa(t)&&no(t)==g};function Xa(t){return"number"==typeof t||Wa(t)&&dr(t)==v}function Ha(t){if(!Wa(t)||dr(t)!=y)return!1;var e=qt(t);if(null===e)return!0;var n=St.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&Et.call(n)==Mt}var Ya=ne?Ae(ne):function(t){return Wa(t)&&dr(t)==m};var Za=re?Ae(re):function(t){return Wa(t)&&no(t)==b};function Ka(t){return"string"==typeof t||!La(t)&&Wa(t)&&dr(t)==_}function Ja(t){return"symbol"==typeof t||Wa(t)&&dr(t)==x}var Qa=ie?Ae(ie):function(t){return Wa(t)&&Ga(t.length)&&!!zt[dr(t)]};var $a=Ri(Pr),ts=Ri((function(t,e){return t<=e}));function es(t){if(!t)return[];if(ka(t))return Ka(t)?Xe(t):yi(t);if(Qt&&t[Qt])return function(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}(t[Qt]());var e=no(t);return(e==g?ze:e==b?Ue:Is)(t)}function ns(t){return t?(t=os(t))===1/0||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0}function rs(t){var e=ns(t),n=e%1;return e==e?n?e-n:e:0}function is(t){return t?Zn(rs(t),0,4294967295):0}function os(t){if("number"==typeof t)return t;if(Ja(t))return NaN;if(Ua(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=Ua(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(Y,"");var n=ot.test(t);return n||st.test(t)?Wt(t.slice(2),n?2:8):it.test(t)?NaN:+t}function as(t){return mi(t,xs(t))}function ss(t){return null==t?"":Jr(t)}var us=_i((function(t,e){if(fo(e)||ka(e))mi(e,_s(e),t);else for(var n in e)St.call(e,n)&&Un(t,n,e[n])})),cs=_i((function(t,e){mi(e,xs(e),t)})),ls=_i((function(t,e,n,r){mi(e,xs(e),t,r)})),fs=_i((function(t,e,n,r){mi(e,_s(e),t,r)})),hs=Wi(Yn);var ds=Dr((function(t,e){t=gt(t);var n=-1,r=e.length,i=r>2?e[2]:void 0;for(i&&so(e[0],e[1],i)&&(r=1);++n<r;)for(var o=e[n],a=xs(o),s=-1,u=a.length;++s<u;){var c=a[s],l=t[c];(void 0===l||Ia(l,xt[c])&&!St.call(t,c))&&(t[c]=o[c])}return t})),ps=Dr((function(t){return t.push(void 0,Vi),oe(Es,void 0,t)}));function gs(t,e,n){var r=null==t?void 0:fr(t,e);return void 0===r?n:r}function vs(t,e){return null!=t&&ro(t,e,vr)}var ys=Ii((function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=Ct.call(e)),t[e]=n}),Us(Xs)),ms=Ii((function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=Ct.call(e)),St.call(t,e)?t[e].push(n):t[e]=[n]}),Ki),bs=Dr(mr);function _s(t){return ka(t)?Dn(t):Sr(t)}function xs(t){return ka(t)?Dn(t,!0):Or(t)}var ws=_i((function(t,e,n){Ar(t,e,n)})),Es=_i((function(t,e,n,r){Ar(t,e,n,r)})),Ss=Wi((function(t,e){var n={};if(null==t)return n;var r=!1;e=de(e,(function(e){return e=si(e,t),r||(r=e.length>1),e})),mi(t,Xi(t),n),r&&(n=Kn(n,7,Gi));for(var i=e.length;i--;)$r(n,e[i]);return n}));var Os=Wi((function(t,e){return null==t?{}:function(t,e){return Lr(t,e,(function(e,n){return vs(t,n)}))}(t,e)}));function Ps(t,e){if(null==t)return{};var n=de(Xi(t),(function(t){return[t]}));return e=Ki(e),Lr(t,n,(function(t,n){return e(t,n[0])}))}var Cs=Di(_s),Ms=Di(xs);function Is(t){return null==t?[]:Te(t,_s(t))}var As=Si((function(t,e,n){return e=e.toLowerCase(),t+(n?Ts(e):e)}));function Ts(t){return Bs(ss(t).toLowerCase())}function Ns(t){return(t=ss(t))&&t.replace(ct,je).replace(Lt,"")}var Ls=Si((function(t,e,n){return t+(n?"-":"")+e.toLowerCase()})),Rs=Si((function(t,e,n){return t+(n?" ":"")+e.toLowerCase()})),ks=Ei("toLowerCase");var js=Si((function(t,e,n){return t+(n?"_":"")+e.toLowerCase()}));var Fs=Si((function(t,e,n){return t+(n?" ":"")+Bs(e)}));var Ds=Si((function(t,e,n){return t+(n?" ":"")+e.toUpperCase()})),Bs=Ei("toUpperCase");function zs(t,e,n){return t=ss(t),void 0===(e=n?void 0:e)?function(t){return Ft.test(t)}(t)?function(t){return t.match(kt)||[]}(t):function(t){return t.match(tt)||[]}(t):t.match(e)||[]}var Vs=Dr((function(t,e){try{return oe(t,void 0,e)}catch(t){return Ba(t)?t:new ht(t)}})),Gs=Wi((function(t,e){return se(e,(function(e){e=Po(e),Hn(t,e,ma(t[e],t))})),t}));function Us(t){return function(){return t}}var Ws=Ci(),qs=Ci(!0);function Xs(t){return t}function Hs(t){return Er("function"==typeof t?t:Kn(t,1))}var Ys=Dr((function(t,e){return function(n){return mr(n,t,e)}})),Zs=Dr((function(t,e){return function(n){return mr(t,n,e)}}));function Ks(t,e,n){var r=_s(e),i=lr(e,r);null!=n||Ua(e)&&(i.length||!r.length)||(n=e,e=t,t=this,i=lr(e,_s(e)));var o=!(Ua(n)&&"chain"in n&&!n.chain),a=za(t);return se(i,(function(n){var r=e[n];t[n]=r,a&&(t.prototype[n]=function(){var e=this.__chain__;if(o||e){var n=t(this.__wrapped__),i=n.__actions__=yi(this.__actions__);return i.push({func:r,args:arguments,thisArg:t}),n.__chain__=e,n}return r.apply(t,pe([this.value()],arguments))})})),t}function Js(){}var Qs=Ti(de),$s=Ti(ce),tu=Ti(ye);function eu(t){return uo(t)?Oe(Po(t)):function(t){return function(e){return fr(e,t)}}(t)}var nu=Li(),ru=Li(!0);function iu(){return[]}function ou(){return!1}var au=Ai((function(t,e){return t+e}),0),su=ji("ceil"),uu=Ai((function(t,e){return t/e}),1),cu=ji("floor");var lu,fu=Ai((function(t,e){return t*e}),1),hu=ji("round"),du=Ai((function(t,e){return t-e}),0);return Mn.after=function(t,e){if("function"!=typeof e)throw new mt(o);return t=rs(t),function(){if(--t<1)return e.apply(this,arguments)}},Mn.ary=va,Mn.assign=us,Mn.assignIn=cs,Mn.assignInWith=ls,Mn.assignWith=fs,Mn.at=hs,Mn.before=ya,Mn.bind=ma,Mn.bindAll=Gs,Mn.bindKey=ba,Mn.castArray=function(){if(!arguments.length)return[];var t=arguments[0];return La(t)?t:[t]},Mn.chain=ea,Mn.chunk=function(t,e,n){e=(n?so(t,e,n):void 0===e)?1:an(rs(e),0);var i=null==t?0:t.length;if(!i||e<1)return[];for(var o=0,a=0,s=r(Qe(i/e));o<i;)s[a++]=qr(t,o,o+=e);return s},Mn.compact=function(t){for(var e=-1,n=null==t?0:t.length,r=0,i=[];++e<n;){var o=t[e];o&&(i[r++]=o)}return i},Mn.concat=function(){var t=arguments.length;if(!t)return[];for(var e=r(t-1),n=arguments[0],i=t;i--;)e[i-1]=arguments[i];return pe(La(n)?yi(n):[n],or(e,1))},Mn.cond=function(t){var e=null==t?0:t.length,n=Ki();return t=e?de(t,(function(t){if("function"!=typeof t[1])throw new mt(o);return[n(t[0]),t[1]]})):[],Dr((function(n){for(var r=-1;++r<e;){var i=t[r];if(oe(i[0],this,n))return oe(i[1],this,n)}}))},Mn.conforms=function(t){return function(t){var e=_s(t);return function(n){return Jn(n,t,e)}}(Kn(t,1))},Mn.constant=Us,Mn.countBy=ia,Mn.create=function(t,e){var n=In(t);return null==e?n:Xn(n,e)},Mn.curry=function t(e,n,r){var i=Bi(e,8,void 0,void 0,void 0,void 0,void 0,n=r?void 0:n);return i.placeholder=t.placeholder,i},Mn.curryRight=function t(e,n,r){var i=Bi(e,16,void 0,void 0,void 0,void 0,void 0,n=r?void 0:n);return i.placeholder=t.placeholder,i},Mn.debounce=_a,Mn.defaults=ds,Mn.defaultsDeep=ps,Mn.defer=xa,Mn.delay=wa,Mn.difference=Io,Mn.differenceBy=Ao,Mn.differenceWith=To,Mn.drop=function(t,e,n){var r=null==t?0:t.length;return r?qr(t,(e=n||void 0===e?1:rs(e))<0?0:e,r):[]},Mn.dropRight=function(t,e,n){var r=null==t?0:t.length;return r?qr(t,0,(e=r-(e=n||void 0===e?1:rs(e)))<0?0:e):[]},Mn.dropRightWhile=function(t,e){return t&&t.length?ei(t,Ki(e,3),!0,!0):[]},Mn.dropWhile=function(t,e){return t&&t.length?ei(t,Ki(e,3),!0):[]},Mn.fill=function(t,e,n,r){var i=null==t?0:t.length;return i?(n&&"number"!=typeof n&&so(t,e,n)&&(n=0,r=i),function(t,e,n,r){var i=t.length;for((n=rs(n))<0&&(n=-n>i?0:i+n),(r=void 0===r||r>i?i:rs(r))<0&&(r+=i),r=n>r?0:is(r);n<r;)t[n++]=e;return t}(t,e,n,r)):[]},Mn.filter=function(t,e){return(La(t)?le:ir)(t,Ki(e,3))},Mn.flatMap=function(t,e){return or(ha(t,e),1)},Mn.flatMapDeep=function(t,e){return or(ha(t,e),1/0)},Mn.flatMapDepth=function(t,e,n){return n=void 0===n?1:rs(n),or(ha(t,e),n)},Mn.flatten=Ro,Mn.flattenDeep=function(t){return(null==t?0:t.length)?or(t,1/0):[]},Mn.flattenDepth=function(t,e){return(null==t?0:t.length)?or(t,e=void 0===e?1:rs(e)):[]},Mn.flip=function(t){return Bi(t,512)},Mn.flow=Ws,Mn.flowRight=qs,Mn.fromPairs=function(t){for(var e=-1,n=null==t?0:t.length,r={};++e<n;){var i=t[e];r[i[0]]=i[1]}return r},Mn.functions=function(t){return null==t?[]:lr(t,_s(t))},Mn.functionsIn=function(t){return null==t?[]:lr(t,xs(t))},Mn.groupBy=ca,Mn.initial=function(t){return(null==t?0:t.length)?qr(t,0,-1):[]},Mn.intersection=jo,Mn.intersectionBy=Fo,Mn.intersectionWith=Do,Mn.invert=ys,Mn.invertBy=ms,Mn.invokeMap=la,Mn.iteratee=Hs,Mn.keyBy=fa,Mn.keys=_s,Mn.keysIn=xs,Mn.map=ha,Mn.mapKeys=function(t,e){var n={};return e=Ki(e,3),ur(t,(function(t,r,i){Hn(n,e(t,r,i),t)})),n},Mn.mapValues=function(t,e){var n={};return e=Ki(e,3),ur(t,(function(t,r,i){Hn(n,r,e(t,r,i))})),n},Mn.matches=function(t){return Mr(Kn(t,1))},Mn.matchesProperty=function(t,e){return Ir(t,Kn(e,1))},Mn.memoize=Ea,Mn.merge=ws,Mn.mergeWith=Es,Mn.method=Ys,Mn.methodOf=Zs,Mn.mixin=Ks,Mn.negate=Sa,Mn.nthArg=function(t){return t=rs(t),Dr((function(e){return Tr(e,t)}))},Mn.omit=Ss,Mn.omitBy=function(t,e){return Ps(t,Sa(Ki(e)))},Mn.once=function(t){return ya(2,t)},Mn.orderBy=function(t,e,n,r){return null==t?[]:(La(e)||(e=null==e?[]:[e]),La(n=r?void 0:n)||(n=null==n?[]:[n]),Nr(t,e,n))},Mn.over=Qs,Mn.overArgs=Oa,Mn.overEvery=$s,Mn.overSome=tu,Mn.partial=Pa,Mn.partialRight=Ca,Mn.partition=da,Mn.pick=Os,Mn.pickBy=Ps,Mn.property=eu,Mn.propertyOf=function(t){return function(e){return null==t?void 0:fr(t,e)}},Mn.pull=zo,Mn.pullAll=Vo,Mn.pullAllBy=function(t,e,n){return t&&t.length&&e&&e.length?Rr(t,e,Ki(n,2)):t},Mn.pullAllWith=function(t,e,n){return t&&t.length&&e&&e.length?Rr(t,e,void 0,n):t},Mn.pullAt=Go,Mn.range=nu,Mn.rangeRight=ru,Mn.rearg=Ma,Mn.reject=function(t,e){return(La(t)?le:ir)(t,Sa(Ki(e,3)))},Mn.remove=function(t,e){var n=[];if(!t||!t.length)return n;var r=-1,i=[],o=t.length;for(e=Ki(e,3);++r<o;){var a=t[r];e(a,r,t)&&(n.push(a),i.push(r))}return kr(t,i),n},Mn.rest=function(t,e){if("function"!=typeof t)throw new mt(o);return Dr(t,e=void 0===e?e:rs(e))},Mn.reverse=Uo,Mn.sampleSize=function(t,e,n){return e=(n?so(t,e,n):void 0===e)?1:rs(e),(La(t)?zn:zr)(t,e)},Mn.set=function(t,e,n){return null==t?t:Vr(t,e,n)},Mn.setWith=function(t,e,n,r){return r="function"==typeof r?r:void 0,null==t?t:Vr(t,e,n,r)},Mn.shuffle=function(t){return(La(t)?Vn:Wr)(t)},Mn.slice=function(t,e,n){var r=null==t?0:t.length;return r?(n&&"number"!=typeof n&&so(t,e,n)?(e=0,n=r):(e=null==e?0:rs(e),n=void 0===n?r:rs(n)),qr(t,e,n)):[]},Mn.sortBy=pa,Mn.sortedUniq=function(t){return t&&t.length?Zr(t):[]},Mn.sortedUniqBy=function(t,e){return t&&t.length?Zr(t,Ki(e,2)):[]},Mn.split=function(t,e,n){return n&&"number"!=typeof n&&so(t,e,n)&&(e=n=void 0),(n=void 0===n?4294967295:n>>>0)?(t=ss(t))&&("string"==typeof e||null!=e&&!Ya(e))&&!(e=Jr(e))&&Be(t)?ci(Xe(t),0,n):t.split(e,n):[]},Mn.spread=function(t,e){if("function"!=typeof t)throw new mt(o);return e=null==e?0:an(rs(e),0),Dr((function(n){var r=n[e],i=ci(n,0,e);return r&&pe(i,r),oe(t,this,i)}))},Mn.tail=function(t){var e=null==t?0:t.length;return e?qr(t,1,e):[]},Mn.take=function(t,e,n){return t&&t.length?qr(t,0,(e=n||void 0===e?1:rs(e))<0?0:e):[]},Mn.takeRight=function(t,e,n){var r=null==t?0:t.length;return r?qr(t,(e=r-(e=n||void 0===e?1:rs(e)))<0?0:e,r):[]},Mn.takeRightWhile=function(t,e){return t&&t.length?ei(t,Ki(e,3),!1,!0):[]},Mn.takeWhile=function(t,e){return t&&t.length?ei(t,Ki(e,3)):[]},Mn.tap=function(t,e){return e(t),t},Mn.throttle=function(t,e,n){var r=!0,i=!0;if("function"!=typeof t)throw new mt(o);return Ua(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),_a(t,e,{leading:r,maxWait:e,trailing:i})},Mn.thru=na,Mn.toArray=es,Mn.toPairs=Cs,Mn.toPairsIn=Ms,Mn.toPath=function(t){return La(t)?de(t,Po):Ja(t)?[t]:yi(Oo(ss(t)))},Mn.toPlainObject=as,Mn.transform=function(t,e,n){var r=La(t),i=r||Fa(t)||Qa(t);if(e=Ki(e,4),null==n){var o=t&&t.constructor;n=i?r?new o:[]:Ua(t)&&za(o)?In(qt(t)):{}}return(i?se:ur)(t,(function(t,r,i){return e(n,t,r,i)})),n},Mn.unary=function(t){return va(t,1)},Mn.union=Wo,Mn.unionBy=qo,Mn.unionWith=Xo,Mn.uniq=function(t){return t&&t.length?Qr(t):[]},Mn.uniqBy=function(t,e){return t&&t.length?Qr(t,Ki(e,2)):[]},Mn.uniqWith=function(t,e){return e="function"==typeof e?e:void 0,t&&t.length?Qr(t,void 0,e):[]},Mn.unset=function(t,e){return null==t||$r(t,e)},Mn.unzip=Ho,Mn.unzipWith=Yo,Mn.update=function(t,e,n){return null==t?t:ti(t,e,ai(n))},Mn.updateWith=function(t,e,n,r){return r="function"==typeof r?r:void 0,null==t?t:ti(t,e,ai(n),r)},Mn.values=Is,Mn.valuesIn=function(t){return null==t?[]:Te(t,xs(t))},Mn.without=Zo,Mn.words=zs,Mn.wrap=function(t,e){return Pa(ai(e),t)},Mn.xor=Ko,Mn.xorBy=Jo,Mn.xorWith=Qo,Mn.zip=$o,Mn.zipObject=function(t,e){return ii(t||[],e||[],Un)},Mn.zipObjectDeep=function(t,e){return ii(t||[],e||[],Vr)},Mn.zipWith=ta,Mn.entries=Cs,Mn.entriesIn=Ms,Mn.extend=cs,Mn.extendWith=ls,Ks(Mn,Mn),Mn.add=au,Mn.attempt=Vs,Mn.camelCase=As,Mn.capitalize=Ts,Mn.ceil=su,Mn.clamp=function(t,e,n){return void 0===n&&(n=e,e=void 0),void 0!==n&&(n=(n=os(n))==n?n:0),void 0!==e&&(e=(e=os(e))==e?e:0),Zn(os(t),e,n)},Mn.clone=function(t){return Kn(t,4)},Mn.cloneDeep=function(t){return Kn(t,5)},Mn.cloneDeepWith=function(t,e){return Kn(t,5,e="function"==typeof e?e:void 0)},Mn.cloneWith=function(t,e){return Kn(t,4,e="function"==typeof e?e:void 0)},Mn.conformsTo=function(t,e){return null==e||Jn(t,e,_s(e))},Mn.deburr=Ns,Mn.defaultTo=function(t,e){return null==t||t!=t?e:t},Mn.divide=uu,Mn.endsWith=function(t,e,n){t=ss(t),e=Jr(e);var r=t.length,i=n=void 0===n?r:Zn(rs(n),0,r);return(n-=e.length)>=0&&t.slice(n,i)==e},Mn.eq=Ia,Mn.escape=function(t){return(t=ss(t))&&B.test(t)?t.replace(F,Fe):t},Mn.escapeRegExp=function(t){return(t=ss(t))&&H.test(t)?t.replace(X,"\\$&"):t},Mn.every=function(t,e,n){var r=La(t)?ce:nr;return n&&so(t,e,n)&&(e=void 0),r(t,Ki(e,3))},Mn.find=oa,Mn.findIndex=No,Mn.findKey=function(t,e){return be(t,Ki(e,3),ur)},Mn.findLast=aa,Mn.findLastIndex=Lo,Mn.findLastKey=function(t,e){return be(t,Ki(e,3),cr)},Mn.floor=cu,Mn.forEach=sa,Mn.forEachRight=ua,Mn.forIn=function(t,e){return null==t?t:ar(t,Ki(e,3),xs)},Mn.forInRight=function(t,e){return null==t?t:sr(t,Ki(e,3),xs)},Mn.forOwn=function(t,e){return t&&ur(t,Ki(e,3))},Mn.forOwnRight=function(t,e){return t&&cr(t,Ki(e,3))},Mn.get=gs,Mn.gt=Aa,Mn.gte=Ta,Mn.has=function(t,e){return null!=t&&ro(t,e,gr)},Mn.hasIn=vs,Mn.head=ko,Mn.identity=Xs,Mn.includes=function(t,e,n,r){t=ka(t)?t:Is(t),n=n&&!r?rs(n):0;var i=t.length;return n<0&&(n=an(i+n,0)),Ka(t)?n<=i&&t.indexOf(e,n)>-1:!!i&&xe(t,e,n)>-1},Mn.indexOf=function(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=null==n?0:rs(n);return i<0&&(i=an(r+i,0)),xe(t,e,i)},Mn.inRange=function(t,e,n){return e=ns(e),void 0===n?(n=e,e=0):n=ns(n),function(t,e,n){return t>=sn(e,n)&&t<an(e,n)}(t=os(t),e,n)},Mn.invoke=bs,Mn.isArguments=Na,Mn.isArray=La,Mn.isArrayBuffer=Ra,Mn.isArrayLike=ka,Mn.isArrayLikeObject=ja,Mn.isBoolean=function(t){return!0===t||!1===t||Wa(t)&&dr(t)==l},Mn.isBuffer=Fa,Mn.isDate=Da,Mn.isElement=function(t){return Wa(t)&&1===t.nodeType&&!Ha(t)},Mn.isEmpty=function(t){if(null==t)return!0;if(ka(t)&&(La(t)||"string"==typeof t||"function"==typeof t.splice||Fa(t)||Qa(t)||Na(t)))return!t.length;var e=no(t);if(e==g||e==b)return!t.size;if(fo(t))return!Sr(t).length;for(var n in t)if(St.call(t,n))return!1;return!0},Mn.isEqual=function(t,e){return _r(t,e)},Mn.isEqualWith=function(t,e,n){var r=(n="function"==typeof n?n:void 0)?n(t,e):void 0;return void 0===r?_r(t,e,void 0,n):!!r},Mn.isError=Ba,Mn.isFinite=function(t){return"number"==typeof t&&nn(t)},Mn.isFunction=za,Mn.isInteger=Va,Mn.isLength=Ga,Mn.isMap=qa,Mn.isMatch=function(t,e){return t===e||xr(t,e,Qi(e))},Mn.isMatchWith=function(t,e,n){return n="function"==typeof n?n:void 0,xr(t,e,Qi(e),n)},Mn.isNaN=function(t){return Xa(t)&&t!=+t},Mn.isNative=function(t){if(lo(t))throw new ht("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return wr(t)},Mn.isNil=function(t){return null==t},Mn.isNull=function(t){return null===t},Mn.isNumber=Xa,Mn.isObject=Ua,Mn.isObjectLike=Wa,Mn.isPlainObject=Ha,Mn.isRegExp=Ya,Mn.isSafeInteger=function(t){return Va(t)&&t>=-9007199254740991&&t<=9007199254740991},Mn.isSet=Za,Mn.isString=Ka,Mn.isSymbol=Ja,Mn.isTypedArray=Qa,Mn.isUndefined=function(t){return void 0===t},Mn.isWeakMap=function(t){return Wa(t)&&no(t)==w},Mn.isWeakSet=function(t){return Wa(t)&&"[object WeakSet]"==dr(t)},Mn.join=function(t,e){return null==t?"":rn.call(t,e)},Mn.kebabCase=Ls,Mn.last=Bo,Mn.lastIndexOf=function(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=r;return void 0!==n&&(i=(i=rs(n))<0?an(r+i,0):sn(i,r-1)),e==e?function(t,e,n){for(var r=n+1;r--;)if(t[r]===e)return r;return r}(t,e,i):_e(t,Ee,i,!0)},Mn.lowerCase=Rs,Mn.lowerFirst=ks,Mn.lt=$a,Mn.lte=ts,Mn.max=function(t){return t&&t.length?rr(t,Xs,pr):void 0},Mn.maxBy=function(t,e){return t&&t.length?rr(t,Ki(e,2),pr):void 0},Mn.mean=function(t){return Se(t,Xs)},Mn.meanBy=function(t,e){return Se(t,Ki(e,2))},Mn.min=function(t){return t&&t.length?rr(t,Xs,Pr):void 0},Mn.minBy=function(t,e){return t&&t.length?rr(t,Ki(e,2),Pr):void 0},Mn.stubArray=iu,Mn.stubFalse=ou,Mn.stubObject=function(){return{}},Mn.stubString=function(){return""},Mn.stubTrue=function(){return!0},Mn.multiply=fu,Mn.nth=function(t,e){return t&&t.length?Tr(t,rs(e)):void 0},Mn.noConflict=function(){return Ht._===this&&(Ht._=It),this},Mn.noop=Js,Mn.now=ga,Mn.pad=function(t,e,n){t=ss(t);var r=(e=rs(e))?qe(t):0;if(!e||r>=e)return t;var i=(e-r)/2;return Ni($e(i),n)+t+Ni(Qe(i),n)},Mn.padEnd=function(t,e,n){t=ss(t);var r=(e=rs(e))?qe(t):0;return e&&r<e?t+Ni(e-r,n):t},Mn.padStart=function(t,e,n){t=ss(t);var r=(e=rs(e))?qe(t):0;return e&&r<e?Ni(e-r,n)+t:t},Mn.parseInt=function(t,e,n){return n||null==e?e=0:e&&(e=+e),cn(ss(t).replace(Z,""),e||0)},Mn.random=function(t,e,n){if(n&&"boolean"!=typeof n&&so(t,e,n)&&(e=n=void 0),void 0===n&&("boolean"==typeof e?(n=e,e=void 0):"boolean"==typeof t&&(n=t,t=void 0)),void 0===t&&void 0===e?(t=0,e=1):(t=ns(t),void 0===e?(e=t,t=0):e=ns(e)),t>e){var r=t;t=e,e=r}if(n||t%1||e%1){var i=ln();return sn(t+i*(e-t+Ut("1e-"+((i+"").length-1))),e)}return jr(t,e)},Mn.reduce=function(t,e,n){var r=La(t)?ge:Ce,i=arguments.length<3;return r(t,Ki(e,4),n,i,tr)},Mn.reduceRight=function(t,e,n){var r=La(t)?ve:Ce,i=arguments.length<3;return r(t,Ki(e,4),n,i,er)},Mn.repeat=function(t,e,n){return e=(n?so(t,e,n):void 0===e)?1:rs(e),Fr(ss(t),e)},Mn.replace=function(){var t=arguments,e=ss(t[0]);return t.length<3?e:e.replace(t[1],t[2])},Mn.result=function(t,e,n){var r=-1,i=(e=si(e,t)).length;for(i||(i=1,t=void 0);++r<i;){var o=null==t?void 0:t[Po(e[r])];void 0===o&&(r=i,o=n),t=za(o)?o.call(t):o}return t},Mn.round=hu,Mn.runInContext=t,Mn.sample=function(t){return(La(t)?Bn:Br)(t)},Mn.size=function(t){if(null==t)return 0;if(ka(t))return Ka(t)?qe(t):t.length;var e=no(t);return e==g||e==b?t.size:Sr(t).length},Mn.snakeCase=js,Mn.some=function(t,e,n){var r=La(t)?ye:Xr;return n&&so(t,e,n)&&(e=void 0),r(t,Ki(e,3))},Mn.sortedIndex=function(t,e){return Hr(t,e)},Mn.sortedIndexBy=function(t,e,n){return Yr(t,e,Ki(n,2))},Mn.sortedIndexOf=function(t,e){var n=null==t?0:t.length;if(n){var r=Hr(t,e);if(r<n&&Ia(t[r],e))return r}return-1},Mn.sortedLastIndex=function(t,e){return Hr(t,e,!0)},Mn.sortedLastIndexBy=function(t,e,n){return Yr(t,e,Ki(n,2),!0)},Mn.sortedLastIndexOf=function(t,e){if(null==t?0:t.length){var n=Hr(t,e,!0)-1;if(Ia(t[n],e))return n}return-1},Mn.startCase=Fs,Mn.startsWith=function(t,e,n){return t=ss(t),n=null==n?0:Zn(rs(n),0,t.length),e=Jr(e),t.slice(n,n+e.length)==e},Mn.subtract=du,Mn.sum=function(t){return t&&t.length?Me(t,Xs):0},Mn.sumBy=function(t,e){return t&&t.length?Me(t,Ki(e,2)):0},Mn.template=function(t,e,n){var r=Mn.templateSettings;n&&so(t,e,n)&&(e=void 0),t=ss(t),e=ls({},e,r,zi);var i,o,a=ls({},e.imports,r.imports,zi),s=_s(a),u=Te(a,s),c=0,l=e.interpolate||lt,f="__p += '",h=vt((e.escape||lt).source+"|"+l.source+"|"+(l===G?nt:lt).source+"|"+(e.evaluate||lt).source+"|$","g"),d="//# sourceURL="+(St.call(e,"sourceURL")?(e.sourceURL+"").replace(/[\r\n]/g," "):"lodash.templateSources["+ ++Bt+"]")+"\n";t.replace(h,(function(e,n,r,a,s,u){return r||(r=a),f+=t.slice(c,u).replace(ft,De),n&&(i=!0,f+="' +\n__e("+n+") +\n'"),s&&(o=!0,f+="';\n"+s+";\n__p += '"),r&&(f+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),c=u+e.length,e})),f+="';\n";var p=St.call(e,"variable")&&e.variable;p||(f="with (obj) {\n"+f+"\n}\n"),f=(o?f.replace(L,""):f).replace(R,"$1").replace(k,"$1;"),f="function("+(p||"obj")+") {\n"+(p?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(i?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+f+"return __p\n}";var g=Vs((function(){return dt(s,d+"return "+f).apply(void 0,u)}));if(g.source=f,Ba(g))throw g;return g},Mn.times=function(t,e){if((t=rs(t))<1||t>9007199254740991)return[];var n=4294967295,r=sn(t,4294967295);t-=4294967295;for(var i=Ie(r,e=Ki(e));++n<t;)e(n);return i},Mn.toFinite=ns,Mn.toInteger=rs,Mn.toLength=is,Mn.toLower=function(t){return ss(t).toLowerCase()},Mn.toNumber=os,Mn.toSafeInteger=function(t){return t?Zn(rs(t),-9007199254740991,9007199254740991):0===t?t:0},Mn.toString=ss,Mn.toUpper=function(t){return ss(t).toUpperCase()},Mn.trim=function(t,e,n){if((t=ss(t))&&(n||void 0===e))return t.replace(Y,"");if(!t||!(e=Jr(e)))return t;var r=Xe(t),i=Xe(e);return ci(r,Le(r,i),Re(r,i)+1).join("")},Mn.trimEnd=function(t,e,n){if((t=ss(t))&&(n||void 0===e))return t.replace(K,"");if(!t||!(e=Jr(e)))return t;var r=Xe(t);return ci(r,0,Re(r,Xe(e))+1).join("")},Mn.trimStart=function(t,e,n){if((t=ss(t))&&(n||void 0===e))return t.replace(Z,"");if(!t||!(e=Jr(e)))return t;var r=Xe(t);return ci(r,Le(r,Xe(e))).join("")},Mn.truncate=function(t,e){var n=30,r="...";if(Ua(e)){var i="separator"in e?e.separator:i;n="length"in e?rs(e.length):n,r="omission"in e?Jr(e.omission):r}var o=(t=ss(t)).length;if(Be(t)){var a=Xe(t);o=a.length}if(n>=o)return t;var s=n-qe(r);if(s<1)return r;var u=a?ci(a,0,s).join(""):t.slice(0,s);if(void 0===i)return u+r;if(a&&(s+=u.length-s),Ya(i)){if(t.slice(s).search(i)){var c,l=u;for(i.global||(i=vt(i.source,ss(rt.exec(i))+"g")),i.lastIndex=0;c=i.exec(l);)var f=c.index;u=u.slice(0,void 0===f?s:f)}}else if(t.indexOf(Jr(i),s)!=s){var h=u.lastIndexOf(i);h>-1&&(u=u.slice(0,h))}return u+r},Mn.unescape=function(t){return(t=ss(t))&&D.test(t)?t.replace(j,He):t},Mn.uniqueId=function(t){var e=++Ot;return ss(t)+e},Mn.upperCase=Ds,Mn.upperFirst=Bs,Mn.each=sa,Mn.eachRight=ua,Mn.first=ko,Ks(Mn,(lu={},ur(Mn,(function(t,e){St.call(Mn.prototype,e)||(lu[e]=t)})),lu),{chain:!1}),Mn.VERSION="4.17.15",se(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(t){Mn[t].placeholder=Mn})),se(["drop","take"],(function(t,e){Nn.prototype[t]=function(n){n=void 0===n?1:an(rs(n),0);var r=this.__filtered__&&!e?new Nn(this):this.clone();return r.__filtered__?r.__takeCount__=sn(n,r.__takeCount__):r.__views__.push({size:sn(n,4294967295),type:t+(r.__dir__<0?"Right":"")}),r},Nn.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}})),se(["filter","map","takeWhile"],(function(t,e){var n=e+1,r=1==n||3==n;Nn.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:Ki(t,3),type:n}),e.__filtered__=e.__filtered__||r,e}})),se(["head","last"],(function(t,e){var n="take"+(e?"Right":"");Nn.prototype[t]=function(){return this[n](1).value()[0]}})),se(["initial","tail"],(function(t,e){var n="drop"+(e?"":"Right");Nn.prototype[t]=function(){return this.__filtered__?new Nn(this):this[n](1)}})),Nn.prototype.compact=function(){return this.filter(Xs)},Nn.prototype.find=function(t){return this.filter(t).head()},Nn.prototype.findLast=function(t){return this.reverse().find(t)},Nn.prototype.invokeMap=Dr((function(t,e){return"function"==typeof t?new Nn(this):this.map((function(n){return mr(n,t,e)}))})),Nn.prototype.reject=function(t){return this.filter(Sa(Ki(t)))},Nn.prototype.slice=function(t,e){t=rs(t);var n=this;return n.__filtered__&&(t>0||e<0)?new Nn(n):(t<0?n=n.takeRight(-t):t&&(n=n.drop(t)),void 0!==e&&(n=(e=rs(e))<0?n.dropRight(-e):n.take(e-t)),n)},Nn.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},Nn.prototype.toArray=function(){return this.take(4294967295)},ur(Nn.prototype,(function(t,e){var n=/^(?:filter|find|map|reject)|While$/.test(e),r=/^(?:head|last)$/.test(e),i=Mn[r?"take"+("last"==e?"Right":""):e],o=r||/^find/.test(e);i&&(Mn.prototype[e]=function(){var e=this.__wrapped__,a=r?[1]:arguments,s=e instanceof Nn,u=a[0],c=s||La(e),l=function(t){var e=i.apply(Mn,pe([t],a));return r&&f?e[0]:e};c&&n&&"function"==typeof u&&1!=u.length&&(s=c=!1);var f=this.__chain__,h=!!this.__actions__.length,d=o&&!f,p=s&&!h;if(!o&&c){e=p?e:new Nn(this);var g=t.apply(e,a);return g.__actions__.push({func:na,args:[l],thisArg:void 0}),new Tn(g,f)}return d&&p?t.apply(this,a):(g=this.thru(l),d?r?g.value()[0]:g.value():g)})})),se(["pop","push","shift","sort","splice","unshift"],(function(t){var e=bt[t],n=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",r=/^(?:pop|shift)$/.test(t);Mn.prototype[t]=function(){var t=arguments;if(r&&!this.__chain__){var i=this.value();return e.apply(La(i)?i:[],t)}return this[n]((function(n){return e.apply(La(n)?n:[],t)}))}})),ur(Nn.prototype,(function(t,e){var n=Mn[e];if(n){var r=n.name+"";St.call(bn,r)||(bn[r]=[]),bn[r].push({name:e,func:n})}})),bn[Mi(void 0,2).name]=[{name:"wrapper",func:void 0}],Nn.prototype.clone=function(){var t=new Nn(this.__wrapped__);return t.__actions__=yi(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=yi(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=yi(this.__views__),t},Nn.prototype.reverse=function(){if(this.__filtered__){var t=new Nn(this);t.__dir__=-1,t.__filtered__=!0}else(t=this.clone()).__dir__*=-1;return t},Nn.prototype.value=function(){var t=this.__wrapped__.value(),e=this.__dir__,n=La(t),r=e<0,i=n?t.length:0,o=function(t,e,n){var r=-1,i=n.length;for(;++r<i;){var o=n[r],a=o.size;switch(o.type){case"drop":t+=a;break;case"dropRight":e-=a;break;case"take":e=sn(e,t+a);break;case"takeRight":t=an(t,e-a)}}return{start:t,end:e}}(0,i,this.__views__),a=o.start,s=o.end,u=s-a,c=r?s:a-1,l=this.__iteratees__,f=l.length,h=0,d=sn(u,this.__takeCount__);if(!n||!r&&i==u&&d==u)return ni(t,this.__actions__);var p=[];t:for(;u--&&h<d;){for(var g=-1,v=t[c+=e];++g<f;){var y=l[g],m=y.iteratee,b=y.type,_=m(v);if(2==b)v=_;else if(!_){if(1==b)continue t;break t}}p[h++]=v}return p},Mn.prototype.at=ra,Mn.prototype.chain=function(){return ea(this)},Mn.prototype.commit=function(){return new Tn(this.value(),this.__chain__)},Mn.prototype.next=function(){void 0===this.__values__&&(this.__values__=es(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?void 0:this.__values__[this.__index__++]}},Mn.prototype.plant=function(t){for(var e,n=this;n instanceof An;){var r=Mo(n);r.__index__=0,r.__values__=void 0,e?i.__wrapped__=r:e=r;var i=r;n=n.__wrapped__}return i.__wrapped__=t,e},Mn.prototype.reverse=function(){var t=this.__wrapped__;if(t instanceof Nn){var e=t;return this.__actions__.length&&(e=new Nn(this)),(e=e.reverse()).__actions__.push({func:na,args:[Uo],thisArg:void 0}),new Tn(e,this.__chain__)}return this.thru(Uo)},Mn.prototype.toJSON=Mn.prototype.valueOf=Mn.prototype.value=function(){return ni(this.__wrapped__,this.__actions__)},Mn.prototype.first=Mn.prototype.head,Qt&&(Mn.prototype[Qt]=function(){return this}),Mn}();Ht._=Ye,void 0===(i=function(){return Ye}.call(e,n,e,r))||(r.exports=i)}).call(this)}).call(this,n(50),n(116)(t))},function(t,n){t.exports=e},function(t,e,n){var r=n(15).coordEach,i=n(415),o=n(11).polygon;t.exports=function(t){var e=[];r(t,(function(t){e.push([t[0],t[1]])}));var n=i(e);if(n.length>=3){for(var a=[],s=0;s<n.length;s++)a.push(e[n[s][0]]);return a.push(e[n[n.length-1][1]]),o([a])}}},function(t,e,n){"use strict";var r=n(208),i=n(419),o=n(420),a=n(422);function s(t,e){for(var n=new Array(t.length-1),r=1;r<t.length;++r)for(var i=n[r-1]=new Array(t.length-1),o=0,a=0;o<t.length;++o)o!==e&&(i[a++]=t[r][o]);return n}function u(t){if(1===t.length)return t[0];if(2===t.length)return["sum(",t[0],",",t[1],")"].join("");var e=t.length>>1;return["sum(",u(t.slice(0,e)),",",u(t.slice(e)),")"].join("")}function c(t){if(2===t.length)return[["sum(prod(",t[0][0],",",t[1][1],"),prod(-",t[0][1],",",t[1][0],"))"].join("")];for(var e=[],n=0;n<t.length;++n)e.push(["scale(",u(c(s(t,n))),",",(r=n,1&r?"-":""),t[0][n],")"].join(""));return e;var r}function l(t){for(var e=[],n=[],l=function(t){for(var e=new Array(t),n=0;n<t;++n){e[n]=new Array(t);for(var r=0;r<t;++r)e[n][r]=["m",r,"[",t-n-1,"]"].join("")}return e}(t),f=[],h=0;h<t;++h)0==(1&h)?e.push.apply(e,c(s(l,h))):n.push.apply(n,c(s(l,h))),f.push("m"+h);var d=u(e),p=u(n),g="orientation"+t+"Exact",v=["function ",g,"(",f.join(),"){var p=",d,",n=",p,",d=sub(p,n);return d[d.length-1];};return ",g].join("");return new Function("sum","prod","scale","sub",v)(i,r,o,a)}var f=l(3),h=l(4),d=[function(){return 0},function(){return 0},function(t,e){return e[0]-t[0]},function(t,e,n){var r,i=(t[1]-n[1])*(e[0]-n[0]),o=(t[0]-n[0])*(e[1]-n[1]),a=i-o;if(i>0){if(o<=0)return a;r=i+o}else{if(!(i<0))return a;if(o>=0)return a;r=-(i+o)}var s=33306690738754716e-32*r;return a>=s||a<=-s?a:f(t,e,n)},function(t,e,n,r){var i=t[0]-r[0],o=e[0]-r[0],a=n[0]-r[0],s=t[1]-r[1],u=e[1]-r[1],c=n[1]-r[1],l=t[2]-r[2],f=e[2]-r[2],d=n[2]-r[2],p=o*c,g=a*u,v=a*s,y=i*c,m=i*u,b=o*s,_=l*(p-g)+f*(v-y)+d*(m-b),x=7771561172376103e-31*((Math.abs(p)+Math.abs(g))*Math.abs(l)+(Math.abs(v)+Math.abs(y))*Math.abs(f)+(Math.abs(m)+Math.abs(b))*Math.abs(d));return _>x||-_>x?_:h(t,e,n,r)}];function p(t){var e=d[t.length];return e||(e=d[t.length]=l(t.length)),e.apply(void 0,t)}!function(){for(;d.length<=5;)d.push(l(d.length));for(var e=[],n=["slow"],r=0;r<=5;++r)e.push("a"+r),n.push("o"+r);var i=["function getOrientation(",e.join(),"){switch(arguments.length){case 0:case 1:return 0;"];for(r=2;r<=5;++r)i.push("case ",r,":return o",r,"(",e.slice(0,r).join(),");");i.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return getOrientation"),n.push(i.join(""));var o=Function.apply(void 0,n);for(t.exports=o.apply(void 0,[p].concat(d)),r=0;r<=5;++r)t.exports[r]=d[r]}()},function(t,e,n){var r=n(11),i=r.polygon,o=r.featureCollection;function a(t,e,n){this.a=t,this.b=e,this.c=n;var r,i,o=e.x-t.x,a=e.y-t.y,s=n.x-t.x,u=n.y-t.y,c=o*(t.x+e.x)+a*(t.y+e.y),l=s*(t.x+n.x)+u*(t.y+n.y),f=2*(o*(n.y-e.y)-a*(n.x-e.x));this.x=(u*c-a*l)/f,this.y=(o*l-s*c)/f,r=this.x-t.x,i=this.y-t.y,this.r=r*r+i*i}function s(t,e){return e.x-t.x}function u(t){var e,n,r,i,o,a=t.length;t:for(;a;)for(n=t[--a],e=t[--a],r=a;r;)if(o=t[--r],e===(i=t[--r])&&n===o||e===o&&n===i){t.splice(a,2),t.splice(r,2),a-=2;continue t}}t.exports=function(t,e){if("FeatureCollection"!==t.type)throw new Error("points must be a FeatureCollection");var n=!1;return o(function(t){if(t.length<3)return[];t.sort(s);var e,n,r,i,o,c,l=t.length-1,f=t[l].x,h=t[0].x,d=t[l].y,p=d;for(;l--;)t[l].y<d&&(d=t[l].y),t[l].y>p&&(p=t[l].y);var g,v=h-f,y=p-d,m=v>y?v:y,b=.5*(h+f),_=.5*(p+d),x=[new a({x:b-20*m,y:_-m,__sentinel:!0},{x:b,y:_+20*m,__sentinel:!0},{x:b+20*m,y:_-m,__sentinel:!0})],w=[],E=[];l=t.length;for(;l--;){for(E.length=0,g=x.length;g--;)(v=t[l].x-x[g].x)>0&&v*v>x[g].r?(w.push(x[g]),x.splice(g,1)):(y=t[l].y-x[g].y,v*v+y*y>x[g].r||(E.push(x[g].a,x[g].b,x[g].b,x[g].c,x[g].c,x[g].a),x.splice(g,1)));for(u(E),g=E.length;g;)n=E[--g],e=E[--g],r=t[l],i=n.x-e.x,o=n.y-e.y,c=2*(i*(r.y-n.y)-o*(r.x-n.x)),Math.abs(c)>1e-12&&x.push(new a(e,n,r))}Array.prototype.push.apply(w,x),l=w.length;for(;l--;)(w[l].a.__sentinel||w[l].b.__sentinel||w[l].c.__sentinel)&&w.splice(l,1);return w}(t.features.map((function(t){var r={x:t.geometry.coordinates[0],y:t.geometry.coordinates[1]};return e?r.z=t.properties[e]:3===t.geometry.coordinates.length&&(n=!0,r.z=t.geometry.coordinates[2]),r}))).map((function(t){var e=[t.a.x,t.a.y],r=[t.b.x,t.b.y],o=[t.c.x,t.c.y],a={};return n?(e.push(t.a.z),r.push(t.b.z),o.push(t.c.z)):a={a:t.a.z,b:t.b.z,c:t.c.z},i([[e,r,o,e]],a)})))}},function(t,e,n){var r=n(212).geometry,i=n(15).geomReduce;t.exports=function(t){return i(t,(function(t,e){return t+r(e)}),0)}},function(t,e,n){var r=n(15),i=n(214),o=n(165),a=n(16),s=n(93),u=n(94),c=n(166),l=n(11).featureCollection,f=a.getCoords,h=r.featureEach,d=r.segmentEach;function p(t,e){var n=f(e),r=f(t),o=r[0],a=r[r.length-1],s=t.geometry.coordinates;return i(n[0],o)?s.unshift(n[1]):i(n[0],a)?s.push(n[1]):i(n[1],o)?s.unshift(n[0]):i(n[1],a)&&s.push(n[0]),t}t.exports=function(t,e,n){var r=[];n=n||0;var a,g=o();return g.load(s(t)),d(e,(function(t){var e=!1;h(g.search(t),(function(r){if(!1===e){var o=f(t).sort(),s=f(r).sort();i(o,s)||(0===n?c(o[0],r)&&c(o[1],r):u(r,o[0]).properties.dist<=n&&u(r,o[1]).properties.dist<=n)?(e=!0,a=a?p(a,t):t):(0===n?c(s[0],t)&&c(s[1],t):u(t,s[0]).properties.dist<=n&&u(t,s[1]).properties.dist<=n)&&(a=a?p(a,r):r)}})),!1===e&&a&&(r.push(a),a=void 0)})),a&&r.push(a),l(r)}},function(t,e,n){"use strict";var r=n(437);t.exports=Function.prototype.bind||r},function(t,e,n){var r=n(71),i=n(15),o=i.featureEach,a=i.coordEach;function s(t){var e=[t[0],t[1]],n=[t[0],t[3]],r=[t[2],t[3]];return{type:"Feature",bbox:t,properties:{},geometry:{type:"Polygon",coordinates:[[e,[t[2],t[1]],r,n,e]]}}}function u(t){var e=[1/0,1/0,-1/0,-1/0];return a(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}t.exports=function(t){var e=r(t);return e.insert=function(t){if(Array.isArray(t)){var e=t;(t=s(e)).bbox=e}else t.bbox=t.bbox?t.bbox:u(t);return r.prototype.insert.call(this,t)},e.load=function(t){var e=[];return Array.isArray(t)?t.forEach((function(t){var n=s(t);n.bbox=t,e.push(n)})):o(t,(function(t){t.bbox=t.bbox?t.bbox:u(t),e.push(t)})),r.prototype.load.call(this,e)},e.remove=function(t){if(Array.isArray(t)){var e=t;(t=s(e)).bbox=e}return r.prototype.remove.call(this,t)},e.clear=function(){return r.prototype.clear.call(this)},e.search=function(t){return{type:"FeatureCollection",features:r.prototype.search.call(this,this.toBBox(t))}},e.collides=function(t){return r.prototype.collides.call(this,this.toBBox(t))},e.all=function(){return{type:"FeatureCollection",features:r.prototype.all.call(this)}},e.toJSON=function(){return r.prototype.toJSON.call(this)},e.fromJSON=function(t){return r.prototype.fromJSON.call(this,t)},e.toBBox=function(t){var e;return{minX:(e=t.bbox?t.bbox:Array.isArray(t)&&4===t.length?t:u(t))[0],minY:e[1],maxX:e[2],maxY:e[3]}},e}},function(t,e,n){var r=n(16).getCoords;function i(t,e,n,r){var i=n[0]-t[0],o=n[1]-t[1],a=e[0]-t[0],s=e[1]-t[1];return 0==i*s-o*a&&(r?"start"===r?Math.abs(a)>=Math.abs(s)?a>0?t[0]<n[0]&&n[0]<=e[0]:e[0]<=n[0]&&n[0]<t[0]:s>0?t[1]<n[1]&&n[1]<=e[1]:e[1]<=n[1]&&n[1]<t[1]:"end"===r?Math.abs(a)>=Math.abs(s)?a>0?t[0]<=n[0]&&n[0]<e[0]:e[0]<n[0]&&n[0]<=t[0]:s>0?t[1]<=n[1]&&n[1]<e[1]:e[1]<n[1]&&n[1]<=t[1]:"both"===r?Math.abs(a)>=Math.abs(s)?a>0?t[0]<n[0]&&n[0]<e[0]:e[0]<n[0]&&n[0]<t[0]:s>0?t[1]<n[1]&&n[1]<e[1]:e[1]<n[1]&&n[1]<t[1]:void 0:Math.abs(a)>=Math.abs(s)?a>0?t[0]<=n[0]&&n[0]<=e[0]:e[0]<=n[0]&&n[0]<=t[0]:s>0?t[1]<=n[1]&&n[1]<=e[1]:e[1]<=n[1]&&n[1]<=t[1])}t.exports=function(t,e,n){for(var o=r(t),a=r(e),s=0;s<a.length-1;s++){var u=!1;if(n&&(0===s&&(u="start"),s===a.length-2&&(u="end"),0===s&&s+1===a.length-1&&(u="both")),i(a[s],a[s+1],o,u))return!0}return!1}},function(t,e,n){var r=n(39),i=n(168);t.exports=function(t){return i(r(t))}},function(t,e,n){var r=n(11).polygon;t.exports=function(t){var e=[t[0],t[1]],n=[t[0],t[3]],i=[t[2],t[3]],o=[t[2],t[1]];return r([[e,o,i,n,e]])}},function(t,e,n){var r=n(37),i=n(15).segmentReduce;t.exports=function(t,e){if(!t)throw new Error("geojson is required");return i(t,(function(t,n){var i=n.geometry.coordinates;return t+r(i[0],i[1],e)}),0)}},function(t,e,n){var r=n(72),i=n(37),o=n(66),a=n(11).lineString;t.exports=function(t,e,n,s){var u,c=[];if("Feature"===t.type)u=t.geometry.coordinates;else{if("LineString"!==t.type)throw new Error("input must be a LineString Feature or Geometry");u=t.coordinates}for(var l,f,h,d=0,p=0;p<u.length&&!(e>=d&&p===u.length-1);p++){if(d>e&&0===c.length){if(!(l=e-d))return c.push(u[p]),a(c);f=r(u[p],u[p-1])-180,h=o(u[p],l,f,s),c.push(h.geometry.coordinates)}if(d>=n)return(l=n-d)?(f=r(u[p],u[p-1])-180,h=o(u[p],l,f,s),c.push(h.geometry.coordinates),a(c)):(c.push(u[p]),a(c));if(d>=e&&c.push(u[p]),p===u.length-1)return a(c);d+=i(u[p],u[p+1],s)}return a(u[u.length-1])}},function(t,e,n){var r=n(37),i=n(39),o=n(11),a=o.point,s=o.polygon,u=o.featureCollection;t.exports=function(t,e,n,o){var c=[];if(!t)throw new Error("bbox is required");if(Array.isArray(t)||(t=i(t)),4!==t.length)throw new Error("bbox must contain 4 numbers");var l=t[0],f=t[1],h=t[2],d=t[3],p=r(a([l,f]),a([h,f]),n),g=r(a([l,f]),a([l,d]),n),v=Math.ceil(p/e),y=Math.ceil(g/e),m=e/p*(h-l);!0===o&&(m*=p/e/v);var b=e/g*(d-f);!0===o&&(b*=g/e/y);for(var _=l,x=0;x<v;x++){for(var w=f,E=0;E<y;E++){var S=s([[[_,w],[_,w+b],[_+m,w+b],[_+m,w],[_,w]]]);c.push(S),w+=b}_+=m}return u(c)}},function(t,e,n){var r=n(15).flattenEach,i=n(11).featureCollection;t.exports=function(t){if(!t)throw new Error("geojson is required");var e=[];return r(t,(function(t){e.push(t)})),i(e)}},function(t,e,n){var r=n(66),i=n(120),o=n(11).lineString;function a(t){var e=t%360;return e<0&&(e+=360),e}t.exports=function(t,e,n,s,u,c){if(!t)throw new Error("center is required");if(null==n)throw new Error("bearing1 is required");if(null==s)throw new Error("bearing2 is required");if(!e)throw new Error("radius is required");u=u||64;var l=a(n),f=a(s),h=t.properties;if(l===f)return o(i(t,e,u,c).geometry.coordinates[0],h);for(var d=l,p=l<f?f:f+360,g=d,v=[],y=0;g<p;)v.push(r(t,e,g,c).geometry.coordinates),g=d+360*++y/u;return g>p&&v.push(r(t,e,p,c).geometry.coordinates),o(v,h)}},function(t,e,n){"use strict";e.LatLonSpherical=n(461),e.LatLonEllipsoidal=n(97);var r=n(462);for(var i in r)e.LatLonEllipsoidal[i]=r[i];e.LatLonVectors=n(463),e.Vector3d=n(175),e.Utm=n(259),e.Mgrs=n(464),e.OsGridRef=n(465),e.Dms=n(126)},function(t,e,n){"use strict";function r(t,e,n){if(!(this instanceof r))return new r(t,e,n);this.x=Number(t),this.y=Number(e),this.z=Number(n)}r.prototype.plus=function(t){if(!(t instanceof r))throw new TypeError("v is not Vector3d object");return new r(this.x+t.x,this.y+t.y,this.z+t.z)},r.prototype.minus=function(t){if(!(t instanceof r))throw new TypeError("v is not Vector3d object");return new r(this.x-t.x,this.y-t.y,this.z-t.z)},r.prototype.times=function(t){return t=Number(t),new r(this.x*t,this.y*t,this.z*t)},r.prototype.dividedBy=function(t){return t=Number(t),new r(this.x/t,this.y/t,this.z/t)},r.prototype.dot=function(t){if(!(t instanceof r))throw new TypeError("v is not Vector3d object");return this.x*t.x+this.y*t.y+this.z*t.z},r.prototype.cross=function(t){if(!(t instanceof r))throw new TypeError("v is not Vector3d object");return new r(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)},r.prototype.negate=function(){return new r(-this.x,-this.y,-this.z)},r.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},r.prototype.unit=function(){var t=this.length();return 1==t||0==t?this:new r(this.x/t,this.y/t,this.z/t)},r.prototype.angleTo=function(t,e){if(!(t instanceof r))throw new TypeError("v is not Vector3d object");if(!(e instanceof r||null==e))throw new TypeError("n is not Vector3d object");var n=null==e?1:Math.sign(this.cross(t).dot(e)),i=this.cross(t).length()*n,o=this.dot(t);return Math.atan2(i,o)},r.prototype.rotateAround=function(t,e){if(!(t instanceof r))throw new TypeError("axis is not Vector3d object");for(var n=this.unit(),i=[n.x,n.y,n.z],o=t.unit(),a=Math.sin(e),s=Math.cos(e),u=[[o.x*o.x*(1-s)+s,o.x*o.y*(1-s)-o.z*a,o.x*o.z*(1-s)+o.y*a],[o.y*o.x*(1-s)+o.z*a,o.y*o.y*(1-s)+s,o.y*o.z*(1-s)-o.x*a],[o.z*o.x*(1-s)-o.y*a,o.z*o.y*(1-s)+o.x*a,o.z*o.z*(1-s)+s]],c=[0,0,0],l=0;l<3;l++)for(var f=0;f<3;f++)c[l]+=u[l][f]*i[f];return new r(c[0],c[1],c[2])},r.prototype.toString=function(t){var e=void 0===t?3:Number(t);return"["+this.x.toFixed(e)+","+this.y.toFixed(e)+","+this.z.toFixed(e)+"]"},void 0===Math.sign&&(Math.sign=function(t){return 0===(t=+t)||isNaN(t)?t:t>0?1:-1}),t.exports&&(t.exports=r)},function(t,e,n){var r=n(16).getCoords;t.exports=function(t){if(!t)throw new Error("line is required");var e=t.geometry?t.geometry.type:t.type;if(!Array.isArray(t)&&"LineString"!==e)throw new Error("geometry must be a LineString");for(var n,i,o=r(t),a=0,s=1;s<o.length;)n=i||o[0],a+=((i=o[s])[0]-n[0])*(i[1]+n[1]),s++;return a>0}},function(t,e,n){"use strict";var r=n(46),i=n(11).point;t.exports={orientationIndex:function(t,e,n){var r=e[0]-t[0],i=e[1]-t[1],o=n[0]-e[0],a=n[1]-e[1];return Math.sign(r*a-o*i)},envelopeIsEqual:function(t,e){var n=t.geometry.coordinates.map((function(t){return t[0]})),r=t.geometry.coordinates.map((function(t){return t[1]})),i=e.geometry.coordinates.map((function(t){return t[0]})),o=e.geometry.coordinates.map((function(t){return t[1]}));return Math.max(null,n)===Math.max(null,i)&&Math.max(null,r)===Math.max(null,o)&&Math.min(null,n)===Math.min(null,i)&&Math.min(null,r)===Math.min(null,o)},envelopeContains:function(t,e){return e.geometry.coordinates[0].every((function(e){return r(i(e),t)}))},coordinatesEqual:function(t,e){return t[0]===e[0]&&t[1]===e[1]}}},function(t,e,n){var r=n(74)(n(56),"Map");t.exports=r},function(t,e,n){var r=n(56).Symbol;t.exports=r},function(t,e,n){var r=n(282),i=n(518),o=n(286);t.exports=function(t){return o(t)?r(t):i(t)}},function(t,e){var n=Array.isArray;t.exports=n},function(t,e){t.exports=function(t){return function(e){return t(e)}}},function(t,e,n){(function(t){var r=n(278),i=e&&!e.nodeType&&e,o=i&&"object"==typeof t&&t&&!t.nodeType&&t,a=o&&o.exports===i&&r.process,s=function(){try{var t=o&&o.require&&o.require("util").types;return t||a&&a.binding&&a.binding("util")}catch(t){}}();t.exports=s}).call(this,n(116)(t))},function(t,e){var n=Object.prototype;t.exports=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||n)}},function(t,e,n){var r=n(526),i=n(288),o=Object.prototype.propertyIsEnumerable,a=Object.getOwnPropertySymbols,s=a?function(t){return null==t?[]:(t=Object(t),r(a(t),(function(e){return o.call(t,e)})))}:i;t.exports=s},function(t,e,n){var r=n(530),i=n(178),o=n(531),a=n(532),s=n(533),u=n(129),c=n(279),l=c(r),f=c(i),h=c(o),d=c(a),p=c(s),g=u;(r&&"[object DataView]"!=g(new r(new ArrayBuffer(1)))||i&&"[object Map]"!=g(new i)||o&&"[object Promise]"!=g(o.resolve())||a&&"[object Set]"!=g(new a)||s&&"[object WeakMap]"!=g(new s))&&(g=function(t){var e=u(t),n="[object Object]"==e?t.constructor:void 0,r=n?c(n):"";if(r)switch(r){case l:return"[object DataView]";case f:return"[object Map]";case h:return"[object Promise]";case d:return"[object Set]";case p:return"[object WeakMap]"}return e}),t.exports=g},function(t,e,n){var r=n(536);t.exports=function(t){var e=new t.constructor(t.byteLength);return new r(e).set(new r(t)),e}},function(t,e,n){"use strict";function r(t,e,n){n=n||2;var r,s,u,c,l,d,p,v=e&&e.length,y=v?e[0]*n:t.length,m=i(t,0,y,n,!0),b=[];if(!m||m.next===m.prev)return b;if(v&&(m=function(t,e,n,r){var a,s,u,c,l,d=[];for(a=0,s=e.length;a<s;a++)u=e[a]*r,c=a<s-1?e[a+1]*r:t.length,(l=i(t,u,c,r,!1))===l.next&&(l.steiner=!0),d.push(g(l));for(d.sort(f),a=0;a<d.length;a++)h(d[a],n),n=o(n,n.next);return n}(t,e,m,n)),t.length>80*n){r=u=t[0],s=c=t[1];for(var _=n;_<y;_+=n)(l=t[_])<r&&(r=l),(d=t[_+1])<s&&(s=d),l>u&&(u=l),d>c&&(c=d);p=0!==(p=Math.max(u-r,c-s))?1/p:0}return a(m,b,n,r,s,p),b}function i(t,e,n,r,i){var o,a;if(i===M(t,e,n,r)>0)for(o=e;o<n;o+=r)a=O(o,t[o],t[o+1],a);else for(o=n-r;o>=e;o-=r)a=O(o,t[o],t[o+1],a);return a&&b(a,a.next)&&(P(a),a=a.next),a}function o(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!b(r,r.next)&&0!==m(r.prev,r,r.next))r=r.next;else{if(P(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function a(t,e,n,r,i,f,h){if(t){!h&&f&&function(t,e,n,r){var i=t;do{null===i.z&&(i.z=p(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,n,r,i,o,a,s,u,c=1;do{for(n=t,t=null,o=null,a=0;n;){for(a++,r=n,s=0,e=0;e<c&&(s++,r=r.nextZ);e++);for(u=c;s>0||u>0&&r;)0!==s&&(0===u||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,u--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,c*=2}while(a>1)}(i)}(t,r,i,f);for(var d,g,v=t;t.prev!==t.next;)if(d=t.prev,g=t.next,f?u(t,r,i,f):s(t))e.push(d.i/n),e.push(t.i/n),e.push(g.i/n),P(t),t=g.next,v=g.next;else if((t=g)===v){h?1===h?a(t=c(o(t),e,n),e,n,r,i,f,2):2===h&&l(t,e,n,r,i,f):a(o(t),e,n,r,i,f,1);break}}}function s(t){var e=t.prev,n=t,r=t.next;if(m(e,n,r)>=0)return!1;for(var i=t.next.next;i!==t.prev;){if(v(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&m(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function u(t,e,n,r){var i=t.prev,o=t,a=t.next;if(m(i,o,a)>=0)return!1;for(var s=i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,u=i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,c=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,l=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,f=p(s,u,e,n,r),h=p(c,l,e,n,r),d=t.prevZ,g=t.nextZ;d&&d.z>=f&&g&&g.z<=h;){if(d!==t.prev&&d!==t.next&&v(i.x,i.y,o.x,o.y,a.x,a.y,d.x,d.y)&&m(d.prev,d,d.next)>=0)return!1;if(d=d.prevZ,g!==t.prev&&g!==t.next&&v(i.x,i.y,o.x,o.y,a.x,a.y,g.x,g.y)&&m(g.prev,g,g.next)>=0)return!1;g=g.nextZ}for(;d&&d.z>=f;){if(d!==t.prev&&d!==t.next&&v(i.x,i.y,o.x,o.y,a.x,a.y,d.x,d.y)&&m(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;g&&g.z<=h;){if(g!==t.prev&&g!==t.next&&v(i.x,i.y,o.x,o.y,a.x,a.y,g.x,g.y)&&m(g.prev,g,g.next)>=0)return!1;g=g.nextZ}return!0}function c(t,e,n){var r=t;do{var i=r.prev,a=r.next.next;!b(i,a)&&_(i,r,r.next,a)&&E(i,a)&&E(a,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(a.i/n),P(r),P(r.next),r=t=a),r=r.next}while(r!==t);return o(r)}function l(t,e,n,r,i,s){var u=t;do{for(var c=u.next.next;c!==u.prev;){if(u.i!==c.i&&y(u,c)){var l=S(u,c);return u=o(u,u.next),l=o(l,l.next),a(u,e,n,r,i,s),void a(l,e,n,r,i,s)}c=c.next}u=u.next}while(u!==t)}function f(t,e){return t.x-e.x}function h(t,e){if(e=function(t,e){var n,r=e,i=t.x,o=t.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>a){if(a=s,s===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!n)return null;if(i===a)return n;var u,c=n,l=n.x,f=n.y,h=1/0;r=n;do{i>=r.x&&r.x>=l&&i!==r.x&&v(o<f?i:a,o,l,f,o<f?a:i,o,r.x,r.y)&&(u=Math.abs(o-r.y)/(i-r.x),E(r,t)&&(u<h||u===h&&(r.x>n.x||r.x===n.x&&d(n,r)))&&(n=r,h=u)),r=r.next}while(r!==c);return n}(t,e)){var n=S(e,t);o(e,e.next),o(n,n.next)}}function d(t,e){return m(t.prev,t,e.prev)<0&&m(e.next,t,t.next)<0}function p(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function g(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function v(t,e,n,r,i,o,a,s){return(i-a)*(e-s)-(t-a)*(o-s)>=0&&(t-a)*(r-s)-(n-a)*(e-s)>=0&&(n-a)*(o-s)-(i-a)*(r-s)>=0}function y(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&_(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(E(t,e)&&E(e,t)&&function(t,e){var n=t,r=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(m(t.prev,t,e.prev)||m(t,e.prev,e))||b(t,e)&&m(t.prev,t,t.next)>0&&m(e.prev,e,e.next)>0)}function m(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function b(t,e){return t.x===e.x&&t.y===e.y}function _(t,e,n,r){var i=w(m(t,e,n)),o=w(m(t,e,r)),a=w(m(n,r,t)),s=w(m(n,r,e));return i!==o&&a!==s||(!(0!==i||!x(t,n,e))||(!(0!==o||!x(t,r,e))||(!(0!==a||!x(n,t,r))||!(0!==s||!x(n,e,r)))))}function x(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function w(t){return t>0?1:t<0?-1:0}function E(t,e){return m(t.prev,t,t.next)<0?m(t,e,t.next)>=0&&m(t,t.prev,e)>=0:m(t,e,t.prev)<0||m(t,t.next,e)<0}function S(t,e){var n=new C(t.i,t.x,t.y),r=new C(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function O(t,e,n,r){var i=new C(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function P(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function C(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function M(t,e,n,r){for(var i=0,o=e,a=n-r;o<n;o+=r)i+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return i}t.exports=r,t.exports.default=r,r.deviation=function(t,e,n,r){var i=e&&e.length,o=i?e[0]*n:t.length,a=Math.abs(M(t,0,o,n));if(i)for(var s=0,u=e.length;s<u;s++){var c=e[s]*n,l=s<u-1?e[s+1]*n:t.length;a-=Math.abs(M(t,c,l,n))}var f=0;for(s=0;s<r.length;s+=3){var h=r[s]*n,d=r[s+1]*n,p=r[s+2]*n;f+=Math.abs((t[h]-t[p])*(t[d+1]-t[h+1])-(t[h]-t[d])*(t[p+1]-t[h+1]))}return 0===a&&0===f?0:Math.abs((f-a)/a)},r.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var a=0;a<e;a++)n.vertices.push(t[i][o][a]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n}},function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n(1),i=n(2),o=n(9),a=n(8),s=n(10),u=n(88),c=n(30),l=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Object(r.a)(this,e),t=Object(o.a)(this,Object(a.a)(e).call(this,2)),Array.isArray(n)&&1===arguments.length?t.copy(n):t.set(n,i),t}return Object(s.a)(e,t),Object(i.a)(e,[{key:"cross",value:function(t){return c.b(this,this,t),this.check()}},{key:"horizontalAngle",value:function(){return Math.atan2(this.y,this.x)}},{key:"verticalAngle",value:function(){return Math.atan2(this.x,this.y)}},{key:"operation",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return t.apply(void 0,[this,this].concat(n)),this.check()}},{key:"ELEMENTS",get:function(){return 2}}]),e}(u.a)},function(t,e){t.exports=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}},function(t,e,n){t.exports=!n(64)&&!n(80)((function(){return 7!=Object.defineProperty(n(192)("div"),"a",{get:function(){return 7}}).a}))},function(t,e,n){var r=n(79),i=n(62).document,o=r(i)&&r(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},function(t,e,n){var r=n(70),i=n(81),o=n(144)("IE_PROTO"),a=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),r(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?a:null}},function(t,e,n){var r=n(60),i=n(38),o=n(80);t.exports=function(t,e){var n=(i.Object||{})[t]||Object[t],a={};a[t]=e(n),r(r.S+r.F*o((function(){n(1)})),"Object",a)}},function(t,e,n){"use strict";var r=n(109),i=n(60),o=n(196),a=n(78),s=n(82),u=n(317),c=n(151),l=n(193),f=n(52)("iterator"),h=!([].keys&&"next"in[].keys()),d=function(){return this};t.exports=function(t,e,n,p,g,v,y){u(n,e,p);var m,b,_,x=function(t){if(!h&&t in O)return O[t];switch(t){case"keys":case"values":return function(){return new n(this,t)}}return function(){return new n(this,t)}},w=e+" Iterator",E="values"==g,S=!1,O=t.prototype,P=O[f]||O["@@iterator"]||g&&O[g],C=P||x(g),M=g?E?x("entries"):C:void 0,I="Array"==e&&O.entries||P;if(I&&(_=l(I.call(new t)))!==Object.prototype&&_.next&&(c(_,w,!0),r||"function"==typeof _[f]||a(_,f,d)),E&&P&&"values"!==P.name&&(S=!0,C=function(){return P.call(this)}),r&&!y||!h&&!S&&O[f]||a(O,f,C),s[e]=C,s[w]=d,g)if(m={values:E?C:x("values"),keys:v?C:x("keys"),entries:M},y)for(b in m)b in O||o(O,b,m[b]);else i(i.P+i.F*(h||S),e,m);return m}},function(t,e,n){t.exports=n(78)},function(t,e,n){var r=n(70),i=n(83),o=n(319)(!1),a=n(144)("IE_PROTO");t.exports=function(t,e){var n,s=i(t),u=0,c=[];for(n in s)n!=a&&r(s,n)&&c.push(n);for(;e.length>u;)r(s,n=e[u++])&&(~o(c,n)||c.push(n));return c}},function(t,e,n){var r=n(149);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==r(t)?t.split(""):Object(t)}},function(t,e,n){var r=n(147),i=Math.min;t.exports=function(t){return t>0?i(r(t),9007199254740991):0}},function(t,e,n){var r=n(197),i=n(150).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,i)}},function(t,e,n){var r=n(112),i=n(89),o=n(83),a=n(142),s=n(70),u=n(191),c=Object.getOwnPropertyDescriptor;e.f=n(64)?c:function(t,e){if(t=o(t),e=a(e,!0),u)try{return c(t,e)}catch(t){}if(s(t,e))return i(!r.f.call(t,e),t[e])}},function(t,e,n){"use strict";(function(t){var e,r=n(0),i=n(294);function o(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}function a(t){return t&&!0}var s=(e={},Object(r.a)(e,"OES_vertex_array_object",{meta:{suffix:"OES"},createVertexArray:function(){o(!1,"VertexArray requires WebGL2 or OES_vertex_array_object extension")},deleteVertexArray:function(){},bindVertexArray:function(){},isVertexArray:function(){return!1}}),Object(r.a)(e,"ANGLE_instanced_arrays",{meta:{suffix:"ANGLE"},vertexAttribDivisor:function(t,e){o(0===e,"WebGL instanced rendering not supported")},drawElementsInstanced:function(){},drawArraysInstanced:function(){}}),Object(r.a)(e,"WEBGL_draw_buffers",{meta:{suffix:"WEBGL"},drawBuffers:function(){o(!1)}}),Object(r.a)(e,"EXT_disjoint_timer_query",{meta:{suffix:"EXT"},createQuery:function(){o(!1)},deleteQuery:function(){o(!1)},beginQuery:function(){o(!1)},endQuery:function(){},getQuery:function(t,e){return this.getQueryObject(t,e)},getQueryParameter:function(t,e){return this.getQueryObject(t,e)},queryCounter:function(){},getQueryObject:function(){}}),Object(r.a)(e,"EXT_disjoint_timer_query_webgl2",{meta:{suffix:"EXT"},queryCounter:null}),Object(r.a)(e,"OVERRIDES",{readBuffer:function(t,e,n){a(t)&&e(n)},getVertexAttrib:function(t,e,n,r){var i,o=function(t,e){return{webgl2:a(t),ext:t.getExtension(e)}}(t,"ANGLE_instanced_arrays"),s=o.webgl2,u=o.ext;switch(r){case 35069:i=!!s&&void 0;break;case 35070:i=s||u?void 0:0}return void 0!==i?i:e(n,r)},getProgramParameter:function(t,e,n,r){if(!a(t))switch(r){case 35967:return 35981;case 35971:case 35382:return 0}return e(n,r)},getInternalformatParameter:function(t,e,n,r,i){if(!a(t))switch(i){case 32937:return new Int32Array([0])}return t.getInternalformatParameter(n,r,i)},getTexParameter:function(t,e,n,r){switch(r){case 34046:var i=t.luma.extensions.EXT_texture_filter_anisotropic;r=i&&i.TEXTURE_MAX_ANISOTROPY_EXT||34046}return e(n,r)},getParameter:i.a,hint:function(t,e,n,r){return e(n,r)}}),e);function u(t,e){var n=e.extension,r=e.target,i=e.target2,a=s[n];o(a);var u=a.meta,c=(void 0===u?{}:u).suffix,l=void 0===c?"":c,f=t.getExtension(n);Object.keys(a).forEach((function(e){var n="".concat(e).concat(l),o=null;"meta"===e||"function"==typeof t[e]||(f&&"function"==typeof f[n]?o=function(){return f[n].apply(f,arguments)}:"function"==typeof a[e]&&(o=a[e].bind(r))),o&&(r[e]=o,i[e]=o)}))}(void 0!==t?t:window).polyfillContext=function(t){if(t.luma=t.luma||{},function(t){t.luma.extensions={};var e=t.getSupportedExtensions()||[],n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;t.luma[s]=t.getExtension(s)}}catch(t){r=!0,i=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}}(t),!t.luma.polyfilled){for(var e in s)"overrides"!==e&&u(t,{extension:e,target:t.luma,target2:t});!function(t,e){var n=e.target,r=e.target2,i=s.OVERRIDES;Object.keys(i).forEach((function(e){if("function"==typeof i[e]){var o=t[e]?t[e].bind(t):function(){},a=i[e].bind(null,t,o);n[e]=a,r[e]=a}}))}(t,{target:t.luma,target2:t}),t.luma.polyfilled=!0}return t}}).call(this,n(50))},function(t,e,n){t.exports={default:n(358),__esModule:!0}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=c(n(84)),i=c(n(31)),o=c(n(32)),a=c(n(33)),s=c(n(34)),u=c(n(35));function c(t){return t&&t.__esModule?t:{default:t}}var l=function(t){function e(){(0,o.default)(this,e);var t=(0,s.default)(this,(e.__proto__||(0,i.default)(e)).call(this));return window.registerList=[],t}return(0,u.default)(e,t),(0,a.default)(e,[{key:"register",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"glLayer";if(null==e._map)throw new Error("layer must be register after add to map");e._map===this._map&&this.isInited||this.initEventsOnMap(e._map),window.registerList.push({name:t,layer:e,layerType:n})}},{key:"unregister",value:function(t){for(var e=0,n=window.registerList.length;e<n;e++)if(window.registerList[e].name===t)return window.registerList.splice(e,1)}},{key:"initEventsOnMap",value:function(t){var e=this;this._map=t,t.on("click",this.onMapClick,this),t.on("mousemove",this.onMapMouseMove,this),t.on("resize",(function(t){e.emit("mapresize",t)}),this),t.on("movestart",(function(t){e.emit("mapmovestart",t)}),this),t.on("move",(function(t){e.emit("mapmove",t)}),this),t.on("moveend",(function(t){e.emit("mapmoveend",t)}),this),t.on("zoomstart",(function(t){e.emit("mapzoomstart",t)}),this),t.on("zoomend",(function(t){e.emit("mapzoomend",t)}),this),t.on("zoomanim",(function(t){e.emit("mapzoomanim",t)}),this),this.isInited=!0}},{key:"onMapClick",value:function(t){var e=this,n=t.containerPoint;clearTimeout(this.clickTimer),this.clickTimer=setTimeout((function(){var r=e.getByXy(n);e.emit("clickobject",r&&r.object,t.latlng)}),100)}},{key:"onMapMouseMove",value:function(t){var e=this,n=t.containerPoint;this.hoverTimer&&clearTimeout(this.hoverTimer),this.hoverTimer=setTimeout((function(){var r=e.getByXy(n);e.emit("hoverobject",r&&r.object,t.latlng),e.hoverTimer=null}),100)}},{key:"getByXy",value:function(t){var e=t.x,n=t.y,i=[];window.registerList.map((function(t){document.getElementById(t.name)&&i.push(t)}));for(var o=(i=i.sort((function(t,e){return window.getComputedStyle(document.getElementById(t.name),null)["z-index"]-window.getComputedStyle(document.getElementById(e.name),null)["z-index"]}))).length-1;o>-1;o--){var a=i[o],s=a.layer;if(("glLayer"!==a.layerType||s.props.visible)&&0!==window.getComputedStyle(document.getElementById(a.name),null).opacity&&null!=s.findObjectByXy){var u=void 0;try{u=s.findObjectByXy(e,n)}catch(t){}if(u)return{layer:s,object:(0,r.default)({},u,{layerName:a.name})}}}}},{key:"destroy",value:function(){this._map.off("click",this.onMapClick,this),this.removeAllListeners()}}]),e}(c(n(361)).default);e.default=new l},function(t,e,n){var r=n(149),i=n(52)("toStringTag"),o="Arguments"==r(function(){return arguments}());t.exports=function(t){var e,n,a;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),i))?n:o?r(e):"Object"==(a=r(e))&&"function"==typeof e.callee?"Arguments":a}},function(t,e,n){var r=n(205),i=n(52)("iterator"),o=n(82);t.exports=n(38).getIteratorMethod=function(t){if(null!=t)return t[i]||t["@@iterator"]||o[r(t)]}},function(t,e,n){var r=n(39),i=n(15),o=n(11),a=n(16),s=n(411),u=n(412),c=o.multiLineString,l=i.coordEach,f=a.collectionOf,h=o.featureCollection;t.exports=function(t,e,n,i,o){if(n=n||"elevation",i=i||{},o=o||[],f(t,"Point","Input must contain Points"),!e)throw new Error("breaks is required");if(!Array.isArray(e))throw new Error("breaks must be an Array");if(!(a=i)||a.constructor!==Object)throw new Error("propertiesToAllIsolines must be an Object");var a;if(!Array.isArray(o))throw new Error("propertiesPerIsoline must be an Array");if("string"!=typeof n)throw new Error("zProperty must be a string");var d=s(t,n,!0),p=function(t,e,n){var i=r(n),o=i[2]-i[0],a=i[3]-i[1],s=i[0],u=i[1],c=e[0].length-1,f=e.length-1,h=o/c,d=a/f,p=function(t){t[0]=t[0]*h+s,t[1]=t[1]*d+u};return t.forEach((function(t){l(t,p)})),t}(function(t,e,n,r,i){for(var o=[],a=1;a<e.length;a++){var s=+e[a],l=Object.assign({},r,i[a]);l[n]=s;var f=c(u.isoContours(t,s),l);o.push(f)}return o}(d,e,n,i,o),d,t);return h(p)}},function(t,e,n){"use strict";t.exports=function(t,e,n){var i=t*e,o=r*t,a=o-(o-t),s=t-a,u=r*e,c=u-(u-e),l=e-c,f=s*l-(i-a*c-s*c-a*l);if(n)return n[0]=f,n[1]=i,n;return[f,i]};var r=+(Math.pow(2,27)+1)},function(t,e,n){var r=n(46),i=n(11).featureCollection;t.exports=function(t,e){for(var n=i([]),o=0;o<e.features.length;o++)for(var a=0;a<t.features.length;a++){r(t.features[a],e.features[o])&&n.features.push(t.features[a])}return n}},function(t,e,n){var r=n(161),i=n(11),o=n(37),a=n(429),s=n(15).featureEach,u=i.feature,c=i.featureCollection;t.exports=function(t,e,n){if(!t)throw new Error("points is required");if(null==e)throw new Error("maxEdge is required");if("number"!=typeof e)throw new Error("invalid maxEdge");var i=function(t){var e=[],n={};return s(t,(function(t){if(t.geometry){var r=t.geometry.coordinates.join("-");n.hasOwnProperty(r)||(e.push(t),n[r]=!0)}})),c(e)}(t),l=r(i);if(l.features=l.features.filter((function(t){var r=t.geometry.coordinates[0][0],i=t.geometry.coordinates[0][1],a=t.geometry.coordinates[0][2],s=o(r,i,n),u=o(i,a,n),c=o(r,a,n);return s<=e&&u<=e&&c<=e})),l.features.length<1)throw new Error("too few polygons found to compute concave hull");var f=a(l.features);return 1===f.coordinates.length&&(f.coordinates=f.coordinates[0],f.type="Polygon"),u(f)}},function(t,e,n){var r=n(117),i=n(162),o=n(11).feature,a=n(16).getGeom,s=n(15).flattenEach;function u(t){switch(t.type){case"Polygon":return i(t)>1?t:null;case"MultiPolygon":var e=[];if(s(t,(function(t){i(t)>1&&e.push(t.geometry.coordinates)})),e.length)return{type:"MultiPolygon",coordinates:e}}}t.exports=function(t,e){var n=a(t),i=a(e),s=t.properties||{};if(n=u(n),i=u(i),!n)return null;if(!i)return o(n,s);var c=new r.io.GeoJSONReader,l=c.read(n),f=c.read(i),h=l.difference(f);if(h.isEmpty())return null;var d=(new r.io.GeoJSONWriter).write(h);return o(d,s)}},function(t,e,n){var r=n(432);function i(t){var e=0;if(t&&t.length>0){e+=Math.abs(o(t[0]));for(var n=1;n<t.length;n++)e-=Math.abs(o(t[n]))}return e}function o(t){var e,n,i,o,s,u,c=0,l=t.length;if(l>2){for(u=0;u<l;u++)u===l-2?(i=l-2,o=l-1,s=0):u===l-1?(i=l-1,o=0,s=1):(i=u,o=u+1,s=u+2),e=t[i],n=t[o],c+=(a(t[s][0])-a(e[0]))*Math.sin(a(n[1]));c=c*r.RADIUS*r.RADIUS/2}return c}function a(t){return t*Math.PI/180}t.exports.geometry=function t(e){var n,r=0;switch(e.type){case"Polygon":return i(e.coordinates);case"MultiPolygon":for(n=0;n<e.coordinates.length;n++)r+=i(e.coordinates[n]);return r;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(n=0;n<e.geometries.length;n++)r+=t(e.geometries[n]);return r}},t.exports.ring=o},function(t,e,n){var r=n(118),i=n(433),o=n(39),a=n(71),s=n(447),u=n(448);function c(t){if(null==t)throw new Error("No polygon was passed");t.geometry.type="LineString";var e=[].concat.apply([],t.geometry.coordinates);return t.geometry.coordinates=e,t}t.exports=function(t,e){for(var n=[],l=[],f=new a,h=0;h<t.features.length;h++){var d=o(t.features[h]),p={minX:d[0],minY:d[1],maxX:d[2],maxY:d[3],origIndexPosition:h};l.push(p)}f.load(l);for(var g=0;g<t.features.length;g++){for(var v=t.features[g],y=o(v),m={minX:y[0],minY:y[1],maxX:y[2],maxY:y[3]},b=f.search(m),_=!1,x=0;x<b.length;x++){v=t.features[g];var w=b[x].origIndexPosition;if(n.length>0&&0!==w)if(w>n[n.length-1])w-=n.length;else{var E=u.greaterNumber(w,n);0!==E&&(w-=E)}if(w!==g){var S=t.features[w];if(void 0===typeof e||S.properties[e]===v.properties[e]){var O=i(v,S);if(!O){var P=JSON.stringify(v),C=JSON.stringify(S),M=c(JSON.parse(P)),I=c(JSON.parse(C));O=s.lineStringsIntersect(M.geometry,I.geometry)}O&&(t.features[g]=r(v,S),n.push(b[x].origIndexPosition),n.sort((function(t,e){return t-e})),f.remove(b[x]),t.features.splice(w,1),m.origIndexPosition=g,f.remove(m,(function(t,e){return t.origIndexPosition===e.origIndexPosition})),_=!0)}}}if(_){var A=o(v);f.insert({minX:A[0],minY:A[1],maxX:A[2],maxY:A[3],origIndexPosition:g}),g--}}return t}},function(t,e,n){var r=n(215),i=n(435),o=n(436),a=n(442),s=n(444),u=n(446),c=Date.prototype.getTime;function l(t,e,n){var d=n||{};return!!(d.strict?o(t,e):t===e)||(!t||!e||"object"!=typeof t&&"object"!=typeof e?d.strict?o(t,e):t==e:function(t,e,n){var o,d;if(typeof t!=typeof e)return!1;if(f(t)||f(e))return!1;if(t.prototype!==e.prototype)return!1;if(i(t)!==i(e))return!1;var p=a(t),g=a(e);if(p!==g)return!1;if(p||g)return t.source===e.source&&s(t)===s(e);if(u(t)&&u(e))return c.call(t)===c.call(e);var v=h(t),y=h(e);if(v!==y)return!1;if(v||y){if(t.length!==e.length)return!1;for(o=0;o<t.length;o++)if(t[o]!==e[o])return!1;return!0}if(typeof t!=typeof e)return!1;try{var m=r(t),b=r(e)}catch(t){return!1}if(m.length!==b.length)return!1;for(m.sort(),b.sort(),o=m.length-1;o>=0;o--)if(m[o]!=b[o])return!1;for(o=m.length-1;o>=0;o--)if(d=m[o],!l(t[d],e[d],n))return!1;return!0}(t,e,d))}function f(t){return null==t}function h(t){return!(!t||"object"!=typeof t||"number"!=typeof t.length)&&("function"==typeof t.copy&&"function"==typeof t.slice&&!(t.length>0&&"number"!=typeof t[0]))}t.exports=l},function(t,e,n){"use strict";var r=Array.prototype.slice,i=n(216),o=Object.keys,a=o?function(t){return o(t)}:n(434),s=Object.keys;a.shim=function(){Object.keys?function(){var t=Object.keys(arguments);return t&&t.length===arguments.length}(1,2)||(Object.keys=function(t){return i(t)?s(r.call(t)):s(t)}):Object.keys=a;return Object.keys||a},t.exports=a},function(t,e,n){"use strict";var r=Object.prototype.toString;t.exports=function(t){var e=r.call(t),n="[object Arguments]"===e;return n||(n="[object Array]"!==e&&null!==t&&"object"==typeof t&&"number"==typeof t.length&&t.length>=0&&"[object Function]"===r.call(t.callee)),n}},function(t,e,n){"use strict";var r=n(164),i=n(438)("%Function%"),o=i.apply,a=i.call;t.exports=function(){return r.apply(a,arguments)},t.exports.apply=function(){return r.apply(o,arguments)}},function(t,e,n){"use strict";var r=function(t){return t!=t};t.exports=function(t,e){return 0===t&&0===e?1/t==1/e:t===e||!(!r(t)||!r(e))}},function(t,e,n){"use strict";var r=n(218);t.exports=function(){return"function"==typeof Object.is?Object.is:r}},function(t,e,n){"use strict";var r=Object,i=TypeError;t.exports=function(){if(null!=this&&this!==r(this))throw new i("RegExp.prototype.flags getter called on non-object");var t="";return this.global&&(t+="g"),this.ignoreCase&&(t+="i"),this.multiline&&(t+="m"),this.dotAll&&(t+="s"),this.unicode&&(t+="u"),this.sticky&&(t+="y"),t}},function(t,e,n){"use strict";var r=n(220),i=n(92).supportsDescriptors,o=Object.getOwnPropertyDescriptor,a=TypeError;t.exports=function(){if(!i)throw new a("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");if("gim"===/a/gim.flags){var t=o(RegExp.prototype,"flags");if(t&&"function"==typeof t.get&&"boolean"==typeof/a/.dotAll)return t.get}return r}},function(t,e,n){var r=n(214),i=function(t){this.precision=t&&t.precision?t.precision:17,this.direction=!(!t||!t.direction)&&t.direction,this.pseudoNode=!(!t||!t.pseudoNode)&&t.pseudoNode,this.objectComparator=t&&t.objectComparator?t.objectComparator:s};function o(t){return t.coordinates.map((function(e){return{type:t.type.replace("Multi",""),coordinates:e}}))}function a(t,e){return t.hasOwnProperty("coordinates")?t.coordinates.length===e.coordinates.length:t.length===e.length}function s(t,e){return r(t,e,{strict:!0})}i.prototype.compare=function(t,e){if(t.type!==e.type||!a(t,e))return!1;switch(t.type){case"Point":return this.compareCoord(t.coordinates,e.coordinates);case"LineString":return this.compareLine(t.coordinates,e.coordinates,0,!1);case"Polygon":return this.comparePolygon(t,e);case"Feature":return this.compareFeature(t,e);default:if(0===t.type.indexOf("Multi")){var n=this,r=o(t),i=o(e);return r.every((function(t){return this.some((function(e){return n.compare(t,e)}))}),i)}}return!1},i.prototype.compareCoord=function(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n].toFixed(this.precision)!==e[n].toFixed(this.precision))return!1;return!0},i.prototype.compareLine=function(t,e,n,r){if(!a(t,e))return!1;var i=this.pseudoNode?t:this.removePseudo(t),o=this.pseudoNode?e:this.removePseudo(e);if(!r||this.compareCoord(i[0],o[0])||(o=this.fixStartIndex(o,i))){var s=this.compareCoord(i[n],o[n]);return this.direction||s?this.comparePath(i,o):!!this.compareCoord(i[n],o[o.length-(1+n)])&&this.comparePath(i.slice().reverse(),o)}},i.prototype.fixStartIndex=function(t,e){for(var n,r=-1,i=0;i<t.length;i++)if(this.compareCoord(t[i],e[0])){r=i;break}return r>=0&&(n=[].concat(t.slice(r,t.length),t.slice(1,r+1))),n},i.prototype.comparePath=function(t,e){var n=this;return t.every((function(t,e){return n.compareCoord(t,this[e])}),e)},i.prototype.comparePolygon=function(t,e){if(this.compareLine(t.coordinates[0],e.coordinates[0],1,!0)){var n=t.coordinates.slice(1,t.coordinates.length),r=e.coordinates.slice(1,e.coordinates.length),i=this;return n.every((function(t){return this.some((function(e){return i.compareLine(t,e,1,!0)}))}),r)}return!1},i.prototype.compareFeature=function(t,e){return!(t.id!==e.id||!this.objectComparator(t.properties,e.properties)||!this.compareBBox(t,e))&&this.compare(t.geometry,e.geometry)},i.prototype.compareBBox=function(t,e){return!!(!t.bbox&&!e.bbox||t.bbox&&e.bbox&&this.compareCoord(t.bbox,e.bbox))},i.prototype.removePseudo=function(t){return t},t.exports=i},function(t,e,n){var r=n(39),i=n(46),o=n(71);t.exports=function(t,e,n,a){var s=o(6),u=e.features.map((function(t){return{minX:t.geometry.coordinates[0],minY:t.geometry.coordinates[1],maxX:t.geometry.coordinates[0],maxY:t.geometry.coordinates[1],property:t.properties[n]}}));return s.load(u),t.features.forEach((function(t){t.properties||(t.properties={});var e=r(t),n=s.search({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}),o=[];n.forEach((function(e){i({type:"Point",coordinates:[e.minX,e.minY]},t)&&o.push(e.property)})),t.properties[a]=o})),t}},function(t,e,n){var r=n(15).coordEach;t.exports=function(t,e){if(!t)throw new Error("geojson is required");return!1!==e&&void 0!==e||(t=JSON.parse(JSON.stringify(t))),r(t,(function(t){var e=t[0],n=t[1];t[0]=n,t[1]=e})),t}},function(t,e,n){var r=n(449),i=n(119),o=n(15).geomEach,a=n(95);function s(t,e,n){return r(t.map((function(t){return{x:t[0],y:t[1],z:t[2]}})),e,n).map((function(t){return t.z?[t.x,t.y,t.z]:[t.x,t.y]}))}function u(t,e,n){return t.map((function(t){var i=t.map((function(t){return{x:t[0],y:t[1]}}));if(i.length<4)throw new Error("invalid polygon");for(var o=r(i,e,n).map((function(t){return[t.x,t.y]}));!c(o);)o=r(i,e-=.01*e,n).map((function(t){return[t.x,t.y]}));return o[o.length-1][0]===o[0][0]&&o[o.length-1][1]===o[0][1]||o.push(o[0]),o}))}function c(t){return!(t.length<3)&&!(3===t.length&&t[2][0]===t[0][0]&&t[2][1]===t[0][1])}t.exports=function(t,e,n,r){if(!t)throw new Error("geojson is required");if(e&&e<0)throw new Error("invalid tolerance");return!0!==r&&(t=a(t)),o(t,(function(t){!function(t,e,n){var r=t.type;if("Point"===r||"MultiPoint"===r)return t;i(t,!0);var o=t.coordinates;switch(r){case"LineString":t.coordinates=s(o,e,n);break;case"MultiLineString":t.coordinates=o.map((function(t){return s(t,e,n)}));break;case"Polygon":t.coordinates=u(o,e,n);break;case"MultiPolygon":t.coordinates=o.map((function(t){return u(t,e,n)}))}}(t,e,n)})),t}},function(t,e,n){var r=n(11).lineString,i=n(450);t.exports=function(t,e,n){for(var o=[],a=new i({points:t.geometry.coordinates.map((function(t){return{x:t[0],y:t[1]}})),duration:e,sharpness:n}),s=0;s<a.duration;s+=10){var u=a.pos(s);Math.floor(s/100)%2==0&&o.push([u.x,u.y])}return r(o,t.properties)}},function(t,e,n){var r=n(46);t.exports=function(t,e,n,i){return t=JSON.parse(JSON.stringify(t)),e=JSON.parse(JSON.stringify(e)),t.features.forEach((function(t){t.properties||(t.properties={}),e.features.forEach((function(e){void 0===t.properties[i]&&(r(t,e)&&(t.properties[i]=e.properties[n]))}))})),t}},function(t,e,n){var r=n(11).featureCollection;t.exports=function(t,e){return r(function(t,e){var n,r,i=t.slice(0),o=t.length,a=o-e;for(;o-- >a;)r=Math.floor((o+1)*Math.random()),n=i[r],i[r]=i[o],i[o]=n;return i.slice(a)}(t.features,e))}},function(t,e,n){var r=n(37);t.exports=function(t){var e=t[0],n=t[1],i=t[2],o=t[3];if(r(t.slice(0,2),[i,n])>=r(t.slice(0,2),[e,o])){var a=(n+o)/2;return[e,a-(i-e)/2,i,a+(i-e)/2]}var s=(e+i)/2;return[s-(o-n)/2,n,s+(o-n)/2,o]}},function(t,e,n){var r=n(72),i=n(66),o=n(37);t.exports=function(t,e){var n=o(t,e,"miles"),a=r(t,e);return i(t,n/2,a,"miles")}},function(t,e,n){var r=n(547),i=n(117),o=n(232),a=n(451),s=n(233),u=n(39),c=n(453),l=c.toWgs84,f=s.feature,h=o.geomEach,d=c.toMercator,p=o.featureEach,g=s.featureCollection,v=s.radiansToDistance,y=s.distanceToRadians;function m(t,e,n,o){var s,c=t.properties||{},p="Feature"===t.type?t.geometry:t;if("GeometryCollection"===p.type){var x=[];return h(t,(function(t){var r=m(t,e,n,o);r&&x.push(r)})),g(x)}var w=u(t),E=w[1]>50&&w[3]>50;if(E){var S=function(t){var e=a(t).geometry.coordinates.reverse(),n=e.map((function(t){return-t}));return r.geoTransverseMercator().center(e).rotate(n).scale(6373e3)}(p);s={type:p.type,coordinates:b(p.coordinates,S)}}else s=d(p);var O,P=(new i.io.GeoJSONReader).read(s),C=v(y(e,n),"meters"),M=P.buffer(C);if(!function t(e){return Array.isArray(e[0])?t(e[0]):isNaN(e[0])}((M=(new i.io.GeoJSONWriter).write(M)).coordinates))return(O=E?{type:M.type,coordinates:_(M.coordinates,S)}:l(M)).geometry?O:f(O,c)}function b(t,e){return"object"!=typeof t[0]?e(t):t.map((function(t){return b(t,e)}))}function _(t,e){return"object"!=typeof t[0]?e.invert(t):t.map((function(t){return _(t,e)}))}t.exports=function(t,e,n,r){if(!t)throw new Error("geojson is required");if(void 0===e)throw new Error("radius is required");if(r<=0)throw new Error("steps must be greater than 0");r=r||64,n=n||"kilometers";var i=[];switch(t.type){case"GeometryCollection":return h(t,(function(t){var o=m(t,e,n,r);o&&i.push(o)})),g(i);case"FeatureCollection":return p(t,(function(t){var o=m(t,e,n,r);o&&p(o,(function(t){t&&i.push(t)}))})),g(i)}return m(t,e,n,r)}},function(t,e){function n(t,e,r){if(null!==t){var i,o,a,s,u,c,l,f,h,d,p=0,g=0,v=t.type,y="FeatureCollection"===v,m="Feature"===v,b=y?t.features.length:1;for(i=0;i<b;i++){var _=0;for(l=(d=!!(h=y?t.features[i].geometry:m?t.geometry:t)&&"GeometryCollection"===h.type)?h.geometries.length:1,o=0;o<l;o++)if(null!==(c=d?h.geometries[o]:h)){f=c.coordinates;var x=c.type;switch(p=!r||"Polygon"!==x&&"MultiPolygon"!==x?0:1,x){case null:break;case"Point":e(f,g,i,_),g++,_++;break;case"LineString":case"MultiPoint":for(a=0;a<f.length;a++)e(f[a],g,i,_),g++,_++;break;case"Polygon":case"MultiLineString":for(a=0;a<f.length;a++)for(s=0;s<f[a].length-p;s++)e(f[a][s],g,i,_),g++,_++;break;case"MultiPolygon":for(a=0;a<f.length;a++)for(s=0;s<f[a].length;s++)for(u=0;u<f[a][s].length-p;u++)e(f[a][s][u],g,i,_),g++,_++;break;case"GeometryCollection":for(a=0;a<c.geometries.length;a++)n(c.geometries[a],e,r);break;default:throw new Error("Unknown Geometry Type")}}}}}function r(t,e,r,i){var o=r;return n(t,(function(t,n,i,a){o=0===n&&void 0===r?t:e(o,t,n,i,a)}),i),o}function i(t,e){var n;switch(t.type){case"FeatureCollection":for(n=0;n<t.features.length;n++)e(t.features[n].properties,n);break;case"Feature":e(t.properties,0)}}function o(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var n=0;n<t.features.length;n++)e(t.features[n],n)}function a(t,e){var n,r,i,o,a,s,u,c,l=0,f="FeatureCollection"===t.type,h="Feature"===t.type,d=f?t.features.length:1;for(n=0;n<d;n++)for(s=f?t.features[n].geometry:h?t.geometry:t,c=f?t.features[n].properties:h?t.properties:{},a=(u=!!s&&"GeometryCollection"===s.type)?s.geometries.length:1,i=0;i<a;i++)if(null!==(o=u?s.geometries[i]:s))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":e(o,l,c),l++;break;case"GeometryCollection":for(r=0;r<o.geometries.length;r++)e(o.geometries[r],l,c),l++;break;default:throw new Error("Unknown Geometry Type")}else e(null,l,c),l++}function s(t,e){a(t,(function(t,n,r){var i,o=null===t?null:t.type;switch(o){case null:case"Point":case"LineString":case"Polygon":return void e(c(t,r),n,0)}switch(o){case"MultiPoint":i="Point";break;case"MultiLineString":i="LineString";break;case"MultiPolygon":i="Polygon"}t.coordinates.forEach((function(t,o){e(c({type:i,coordinates:t},r),n,o)}))}))}function u(t,e){s(t,(function(t,n){var i=0;if(t.geometry){var o=t.geometry.type;"Point"!==o&&"MultiPoint"!==o&&r(t,(function(r,o){var a=function(t,e){if(!t)throw new Error("No coordinates passed");if(t.length<2)throw new Error("Coordinates must be an array of two or more positions");return{type:"Feature",properties:e||{},geometry:{type:"LineString",coordinates:t}}}([r,o],t.properties);return e(a,n,i),i++,o}))}}))}function c(t,e){if(void 0===t)throw new Error("No geometry passed");return{type:"Feature",properties:e||{},geometry:t}}function l(t,e){if(!t)throw new Error("geojson is required");var n=t.geometry?t.geometry.type:t.type;if(!n)throw new Error("invalid geojson");if("FeatureCollection"===n)throw new Error("FeatureCollection is not supported");if("GeometryCollection"===n)throw new Error("GeometryCollection is not supported");var r=t.geometry?t.geometry.coordinates:t.coordinates;if(!r)throw new Error("geojson must contain coordinates");switch(n){case"LineString":return void e(r,0,0);case"Polygon":case"MultiLineString":for(var i=0,o=0;o<r.length;o++)"MultiLineString"===n&&(i=o),e(r[o],o,i);return;case"MultiPolygon":for(var a=0;a<r.length;a++)for(var s=0;s<r[a].length;s++)e(r[a][s],s,a);return;default:throw new Error(n+" geometry not supported")}}t.exports={coordEach:n,coordReduce:r,propEach:i,propReduce:function(t,e,n){var r=n;return i(t,(function(t,i){r=0===i&&void 0===n?t:e(r,t,i)})),r},featureEach:o,featureReduce:function(t,e,n){var r=n;return o(t,(function(t,i){r=0===i&&void 0===n?t:e(r,t,i)})),r},coordAll:function(t){var e=[];return n(t,(function(t){e.push(t)})),e},geomEach:a,geomReduce:function(t,e,n){var r=n;return a(t,(function(t,i,o){r=0===i&&void 0===n?t:e(r,t,i,o)})),r},flattenEach:s,flattenReduce:function(t,e,n){var r=n;return s(t,(function(t,i,o){r=0===i&&0===o&&void 0===n?t:e(r,t,i,o)})),r},segmentEach:u,segmentReduce:function(t,e,n){var r=n;return u(t,(function(t,i,o){r=0===i&&void 0===n?t:e(r,t,i,o)})),r},lineEach:l,lineReduce:function(t,e,n){var r=n;return l(t,(function(t,i,o){r=0===i&&void 0===n?t:e(r,t,i,o)})),r}}},function(t,e){function n(t,e,n,r){if(void 0===t)throw new Error("geometry is required");if(e&&e.constructor!==Object)throw new Error("properties must be an Object");if(n&&4!==n.length)throw new Error("bbox must be an Array of 4 numbers");if(r&&-1===["string","number"].indexOf(typeof r))throw new Error("id must be a number or a string");var i={type:"Feature"};return r&&(i.id=r),n&&(i.bbox=n),i.properties=e||{},i.geometry=t,i}function r(t,e,r,i){if(!t)throw new Error("No coordinates passed");if(void 0===t.length)throw new Error("Coordinates must be an array");if(t.length<2)throw new Error("Coordinates must be at least 2 numbers long");if(!p(t[0])||!p(t[1]))throw new Error("Coordinates must contain numbers");return n({type:"Point",coordinates:t},e,r,i)}function i(t,e,r,i){if(!t)throw new Error("No coordinates passed");for(var o=0;o<t.length;o++){var a=t[o];if(a.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<a[a.length-1].length;s++){if(0===o&&0===s&&!p(a[0][0])||!p(a[0][1]))throw new Error("Coordinates must contain numbers");if(a[a.length-1][s]!==a[0][s])throw new Error("First and last Position are not equivalent.")}}return n({type:"Polygon",coordinates:t},e,r,i)}function o(t,e,r,i){if(!t)throw new Error("No coordinates passed");if(t.length<2)throw new Error("Coordinates must be an array of two or more positions");if(!p(t[0][1])||!p(t[0][1]))throw new Error("Coordinates must contain numbers");return n({type:"LineString",coordinates:t},e,r,i)}function a(t,e,r,i){if(!t)throw new Error("No coordinates passed");return n({type:"MultiLineString",coordinates:t},e,r,i)}function s(t,e,r,i){if(!t)throw new Error("No coordinates passed");return n({type:"MultiPoint",coordinates:t},e,r,i)}function u(t,e,r,i){if(!t)throw new Error("No coordinates passed");return n({type:"MultiPolygon",coordinates:t},e,r,i)}var c={miles:3960,nauticalmiles:3441.145,degrees:57.2957795,radians:1,inches:250905600,yards:6969600,meters:6373e3,metres:6373e3,centimeters:6373e5,centimetres:6373e5,kilometers:6373,kilometres:6373,feet:20908792.65},l={kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,centimetres:1e4,millimeter:1e6,acres:247105e-9,miles:386e-9,yards:1.195990046,feet:10.763910417,inches:1550.003100006};function f(t,e){if(null==t)throw new Error("radians is required");var n=c[e||"kilometers"];if(!n)throw new Error("units is invalid");return t*n}function h(t,e){if(null==t)throw new Error("distance is required");var n=c[e||"kilometers"];if(!n)throw new Error("units is invalid");return t/n}function d(t){if(null==t)throw new Error("radians is required");return 180*(t%(2*Math.PI))/Math.PI}function p(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}t.exports={feature:n,geometry:function(t,e,n){if(!t)throw new Error("type is required");if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(n&&4!==n.length)throw new Error("bbox must be an Array of 4 numbers");var c;switch(t){case"Point":c=r(e).geometry;break;case"LineString":c=o(e).geometry;break;case"Polygon":c=i(e).geometry;break;case"MultiPoint":c=s(e).geometry;break;case"MultiLineString":c=a(e).geometry;break;case"MultiPolygon":c=u(e).geometry;break;default:throw new Error(t+" is invalid")}return n&&(c.bbox=n),c},featureCollection:function(t,e,n){if(!t)throw new Error("No features passed");if(!Array.isArray(t))throw new Error("features must be an Array");if(e&&4!==e.length)throw new Error("bbox must be an Array of 4 numbers");if(n&&-1===["string","number"].indexOf(typeof n))throw new Error("id must be a number or a string");var r={type:"FeatureCollection"};return n&&(r.id=n),e&&(r.bbox=e),r.features=t,r},geometryCollection:function(t,e,r,i){if(!t)throw new Error("geometries is required");if(!Array.isArray(t))throw new Error("geometries must be an Array");return n({type:"GeometryCollection",geometries:t},e,r,i)},point:r,multiPoint:s,lineString:o,multiLineString:a,polygon:i,multiPolygon:u,radiansToDistance:f,distanceToRadians:h,distanceToDegrees:function(t,e){return d(h(t,e))},radians2degrees:d,degrees2radians:function(t){if(null==t)throw new Error("degrees is required");return t%360*Math.PI/180},bearingToAngle:function(t){if(null==t)throw new Error("bearing is required");var e=t%360;return e<0&&(e+=360),e},convertDistance:function(t,e,n){if(null==t)throw new Error("distance is required");if(!(t>=0))throw new Error("distance must be a positive number");return f(h(t,e),n||"kilometers")},convertArea:function(t,e,n){if(null==t)throw new Error("area is required");if(!(t>=0))throw new Error("area must be a positive number");var r=l[e||"meters"];if(!r)throw new Error("invalid original units");var i=l[n||"kilometers"];if(!i)throw new Error("invalid final units");return t/r*i},round:function(t,e){if(null==t||isNaN(t))throw new Error("num is required");if(e&&!(e>=0))throw new Error("precision must be a positive number");var n=Math.pow(10,e||0);return Math.round(t*n)/n},isNumber:p}},function(t,e,n){var r=n(11).point,i=n(159),o=n(122),a=n(85),s=n(16).getCoord,u=n(15).coordEach;t.exports=function t(e,n){switch(e.geometry?e.geometry.type:e.type){case"Point":return r(s(e),n);case"Polygon":var c=[];u(e,(function(t){c.push(t)}));var l,f,h,d,p,g,v,y,m=a(e,n),b=m.geometry.coordinates,_=0,x=0,w=0,E=c.map((function(t){return[t[0]-b[0],t[1]-b[1]]}));for(l=0;l<c.length-1;l++)d=(f=E[l])[0],g=f[1],p=(h=E[l+1])[0],w+=y=d*(v=h[1])-p*g,_+=(d+p)*y,x+=(g+v)*y;if(0===w)return m;var S=1/(6*(.5*w));return r([b[0]+S*_,b[1]+S*x],n);default:var O=i(o(e));return O?t(O,n):a(e,n)}}},function(t,e,n){var r=n(15);t.exports=function(t){var e={MultiPoint:{coordinates:[],properties:[]},MultiLineString:{coordinates:[],properties:[]},MultiPolygon:{coordinates:[],properties:[]}},n=Object.keys(e).reduce((function(t,e){return t[e.replace("Multi","")]=e,t}),{});function i(t,n,r){r?e[n].coordinates=e[n].coordinates.concat(t.geometry.coordinates):e[n].coordinates.push(t.geometry.coordinates),e[n].properties.push(t.properties)}return r.featureEach(t,(function(t){t.geometry&&(e[t.geometry.type]?i(t,t.geometry.type,!0):n[t.geometry.type]&&i(t,n[t.geometry.type],!1))})),{type:"FeatureCollection",features:Object.keys(e).filter((function(t){return e[t].coordinates.length})).sort().map((function(t){return{type:"Feature",properties:{collectedProperties:e[t].properties},geometry:{type:t,coordinates:e[t].coordinates}}}))}}},function(t,e,n){var r=n(11).polygon,i=n(188);function o(t){var e=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var a=0;a<e;a++)n.vertices.push(t[i][o][a]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n}(t),n=i(e.vertices,e.holes,2),o=[],a=[];n.forEach((function(t,r){var i=n[r];a.push([e.vertices[2*i],e.vertices[2*i+1]])}));for(var s=0;s<a.length;s+=3){var u=a.slice(s,s+3);u.push(a[s]),o.push(r([u]))}return o}t.exports=function(t){if(!t.geometry||"Polygon"!==t.geometry.type&&"MultiPolygon"!==t.geometry.type)throw new Error("input must be a Polygon or MultiPolygon");var e={type:"FeatureCollection",features:[]};return"Polygon"===t.geometry.type?e.features=o(t.geometry.coordinates):t.geometry.coordinates.forEach((function(t){e.features=e.features.concat(o(t))})),e}},function(t,e,n){var r=n(117),i=n(123),o=n(11).feature;t.exports=function(t,e){var n="Feature"===t.type?t.geometry:t,a="Feature"===e.type?e.geometry:e,s=new r.io.GeoJSONReader,u=s.read(i(n)),c=s.read(i(a)),l=u.intersection(c);if(l.isEmpty())return null;var f=(new r.io.GeoJSONWriter).write(l);return o(f)}},function(t,e,n){var r=n(37);t.exports=function(t,e){for(var n,i=1/0,o=0;o<e.features.length;o++){var a=r(t,e.features[o],"miles");a<i&&(n=e.features[o],i=a)}return n}},function(t,e,n){var r=n(16),i=r.getCoord,o=r.getGeom;t.exports=function(t,e){var n=i(t),r=o(e).coordinates[0];if(r.length<4)throw new Error("OuterRing of a Polygon must have 4 or more Positions.");var a=e.properties||{},s=a.a,u=a.b,c=a.c,l=n[0],f=n[1],h=r[0][0],d=r[0][1],p=void 0!==s?s:r[0][2],g=r[1][0],v=r[1][1],y=void 0!==u?u:r[1][2],m=r[2][0],b=r[2][1],_=void 0!==c?c:r[2][2];return(_*(l-h)*(f-v)+p*(l-g)*(f-b)+y*(l-m)*(f-d)-y*(l-h)*(f-b)-_*(l-g)*(f-d)-p*(l-m)*(f-v))/((l-h)*(f-v)+(l-g)*(f-b)+(l-m)*(f-d)-(l-h)*(f-b)-(l-g)*(f-d)-(l-m)*(f-v))}},function(t,e,n){var r=n(454);t.exports=function(t,e,n){switch(n=n||{},e=e||1,t){case"point":case"points":case void 0:return r.point(e,n.bbox);case"polygon":case"polygons":return r.polygon(e,n.num_vertices,n.max_radial_length,n.bbox);default:throw new Error("Unknown type given: valid options are points and polygons")}}},function(t,e,n){var r=n(11).point;function i(t,e,n,r,i,o,a,s){var u,c,l,f,h={x:null,y:null,onLine1:!1,onLine2:!1};return 0===(u=(s-o)*(n-t)-(a-i)*(r-e))?null!==h.x&&null!==h.y&&h:(f=(n-t)*(c=e-o)-(r-e)*(l=t-i),c=((a-i)*c-(s-o)*l)/u,l=f/u,h.x=t+c*(n-t),h.y=e+c*(r-e),c>=0&&c<=1&&(h.onLine1=!0),l>=0&&l<=1&&(h.onLine2=!0),!(!h.onLine1||!h.onLine2)&&[h.x,h.y])}t.exports=function(t){var e,n,o={type:"FeatureCollection",features:[]};if("LineString"===(n="Feature"===t.type?t.geometry:t).type)e=[n.coordinates];else if("MultiLineString"===n.type)e=n.coordinates;else if("MultiPolygon"===n.type)e=[].concat.apply([],n.coordinates);else{if("Polygon"!==n.type)throw new Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");e=n.coordinates}return e.forEach((function(t){e.forEach((function(e){for(var n=0;n<t.length-1;n++)for(var a=n;a<e.length-1;a++){if(t===e){if(1===Math.abs(n-a))continue;if(0===n&&a===t.length-2&&t[n][0]===t[t.length-1][0]&&t[n][1]===t[t.length-1][1])continue}var s=i(t[n][0],t[n][1],t[n+1][0],t[n+1][1],e[a][0],e[a][1],e[a+1][0],e[a+1][1]);s&&o.features.push(r([s[0],s[1]]))}}))})),o}},function(t,e,n){var r=n(11).featureCollection,i=n(121),o=n(37),a=n(46),s=n(122);function u(t,e,n,r,i,o){if(Math.sqrt((i-n)*(i-n)+(o-r)*(o-r))===Math.sqrt((t-n)*(t-n)+(e-r)*(e-r))+Math.sqrt((i-t)*(i-t)+(o-e)*(o-e)))return!0}t.exports=function(t){"FeatureCollection"!==t.type&&("Feature"!==t.type&&(t={type:"Feature",geometry:t,properties:{}}),t=r([t]));for(var e=i(t),n=!1,c=0;!n&&c<t.features.length;){var l,f=t.features[c].geometry,h=!1;if("Point"===f.type)e.geometry.coordinates[0]===f.coordinates[0]&&e.geometry.coordinates[1]===f.coordinates[1]&&(n=!0);else if("MultiPoint"===f.type){var d=!1;for(l=0;!d&&l<f.coordinates.length;)e.geometry.coordinates[0]===f.coordinates[l][0]&&e.geometry.coordinates[1]===f.coordinates[l][1]&&(n=!0,d=!0),l++}else if("LineString"===f.type)for(l=0;!h&&l<f.coordinates.length-1;)u(e.geometry.coordinates[0],e.geometry.coordinates[1],f.coordinates[l][0],f.coordinates[l][1],f.coordinates[l+1][0],f.coordinates[l+1][1])&&(h=!0,n=!0),l++;else if("MultiLineString"===f.type)for(var p=0;p<f.coordinates.length;){h=!1,l=0;for(var g=f.coordinates[p];!h&&l<g.length-1;)u(e.geometry.coordinates[0],e.geometry.coordinates[1],g[l][0],g[l][1],g[l+1][0],g[l+1][1])&&(h=!0,n=!0),l++;p++}else if("Polygon"===f.type||"MultiPolygon"===f.type){a(e,{type:"Feature",geometry:f,properties:{}})&&(n=!0)}c++}if(n)return e;var v,y=r([]);for(c=0;c<t.features.length;c++)y.features=y.features.concat(s(t.features[c]).features);var m=1/0;for(c=0;c<y.features.length;c++){var b=o(e,y.features[c],"miles");b<m&&(m=b,v=y.features[c])}return v}},function(t,e,n){var r=n(37),i=n(11).point,o=n(72),a=n(66);t.exports=function(t,e,n){var s;if("Feature"===t.type)s=t.geometry.coordinates;else{if("LineString"!==t.type)throw new Error("input must be a LineString Feature or Geometry");s=t.coordinates}for(var u=0,c=0;c<s.length&&!(e>=u&&c===s.length-1);c++){if(u>=e){var l=e-u;if(l){var f=o(s[c],s[c-1])-180;return a(s[c],l,f,n)}return i(s[c])}u+=r(s[c],s[c+1],n)}return i(s[s.length-1])}},function(t,e,n){var r=n(11).lineString,i=n(94);t.exports=function(t,e,n){var o;if("Feature"===n.type)o=n.geometry.coordinates;else{if("LineString"!==n.type)throw new Error("input must be a LineString Feature or Geometry");o=n.coordinates}for(var a,s=i(n,t),u=i(n,e),c=[(a=s.properties.index<=u.properties.index?[s,u]:[u,s])[0].geometry.coordinates],l=a[0].properties.index+1;l<a[1].properties.index+1;l++)c.push(o[l]);return c.push(a[1].geometry.coordinates),r(c,n.properties)}},function(t,e,n){var r=n(37),i=n(39),o=n(11),a=n(46),s=n(16).getGeomType,u=o.point,c=o.featureCollection;t.exports=function(t,e,n,o,l){var f=[],h=t;if(!t)throw new Error("bbox is required");if(Array.isArray(t)||(t=i(t)),4!==t.length)throw new Error("bbox must contain 4 numbers");var d=t[0],p=t[1],g=t[2],v=t[3],y=e/r(u([d,p]),u([g,p]),n)*(g-d),m=e/r(u([d,p]),u([d,v]),n)*(v-p);if(!1!==o)var b=g-d,_=v-p,x=(b-Math.floor(b/y)*y)/2,w=(_-Math.floor(_/m)*m)/2;var E=!Array.isArray(h)&&("Polygon"===s(h)||"MultiPolygon"===s(h)),S=d;for(!1!==o&&(S+=x);S<=g;){var O=p;for(!1!==o&&(O+=w);O<=v;){var P=u([S,O]);!0===l&&E?a(P,h)&&f.push(P):f.push(P),O+=m}S+=y}return c(f)}},function(t,e,n){var r=n(37),i=n(11),o=i.polygon,a=i.featureCollection;t.exports=function(t,e,n){for(var i=a([]),s=e/r([t[0],t[1]],[t[2],t[1]],n)*(t[2]-t[0]),u=e/r([t[0],t[1]],[t[0],t[3]],n)*(t[3]-t[1]),c=0,l=t[0];l<=t[2];){for(var f=0,h=t[1];h<=t[3];)c%2==0&&f%2==0?i.features.push(o([[[l,h],[l,h+u],[l+s,h],[l,h]]]),o([[[l,h+u],[l+s,h+u],[l+s,h],[l,h+u]]])):c%2==0&&f%2==1?i.features.push(o([[[l,h],[l+s,h+u],[l+s,h],[l,h]]]),o([[[l,h],[l,h+u],[l+s,h+u],[l,h]]])):f%2==0&&c%2==1?i.features.push(o([[[l,h],[l,h+u],[l+s,h+u],[l,h]]]),o([[[l,h],[l+s,h+u],[l+s,h],[l,h]]])):f%2==1&&c%2==1&&i.features.push(o([[[l,h],[l,h+u],[l+s,h],[l,h]]]),o([[[l,h+u],[l+s,h+u],[l+s,h],[l,h+u]]])),h+=u,f++;c++,l+=s}return i}},function(t,e,n){for(var r=n(37),i=n(11),o=i.point,a=i.polygon,s=i.featureCollection,u=[],c=[],l=0;l<6;l++){var f=2*Math.PI/6*l;u.push(Math.cos(f)),c.push(Math.sin(f))}function h(t,e,n){for(var r=[],i=0;i<6;i++){var o=t[0]+e*u[i],s=t[1]+n*c[i];r.push([o,s])}return r.push(r[0].slice()),a([r])}function d(t,e,n){for(var r=[],i=0;i<6;i++){var o=[];o.push(t),o.push([t[0]+e*u[i],t[1]+n*c[i]]),o.push([t[0]+e*u[(i+1)%6],t[1]+n*c[(i+1)%6]]),o.push(t),r.push(a([o]))}return r}t.exports=function(t,e,n,i){var a=t[0],u=t[1],c=t[2],l=t[3],f=(u+l)/2,p=(a+c)/2,g=e/r(o([a,f]),o([c,f]),n)*(c-a),v=e/r(o([p,u]),o([p,l]),n)*(l-u),y=g/2,m=2*y,b=Math.sqrt(3)/2*v,_=c-a,x=l-u,w=3/4*m,E=b,S=_/(m-y/2),O=Math.ceil(S);Math.round(S)===O&&O++;var P=(O*w-y/2-_)/2-y/2,C=Math.ceil(x/b),M=(x-C*b)/2,I=C*b-x>b/2;I&&(M-=b/4);for(var A=s([]),T=0;T<O;T++)for(var N=0;N<=C;N++){var L=T%2==1;if((0!==N||!L)&&(0!==N||!I)){var R=T*w+a-P,k=N*E+u+M;L&&(k-=b/2),i?A.features.push.apply(A.features,d([R,k],g/2,v/2)):A.features.push(h([R,k],g/2,v/2))}}return A}},function(t,e,n){var r=n(39),i=n(37),o=n(85),a=n(171);t.exports=function(t,e,n,s,u){if(!e)throw new Error("valueField is required");if(null==n)throw new Error("weight is required");if(null==s)throw new Error("cellWidth is required");if(0===t.features.filter((function(t){return t.properties&&t.properties.hasOwnProperty(e)})).length)throw new Error("Specified Data Field is Missing");for(var c=a(r(t),s,u),l=c.features.length,f=0;f<l;f++){for(var h=0,d=0,p=0;p<t.features.length;p++){var g=i(o(c.features[f]),t.features[p],u);0===g&&(h=t.features[p].properties[e]);var v=1/Math.pow(g,n);d+=v,h+=v*t.features[p].properties[e]}c.features[f].properties[e]=h/d}return c}},function(t,e,n){var r=n(71),i=n(118),o=n(11),a=n(39),s=n(15).flattenEach;function u(t){if(t.features.length<=1)return t;var e=function(t){var e=r(),n=[];return s(t,(function(t,e){var r=a(t);n.push({minX:r[0],minY:r[1],maxX:r[2],maxY:r[3],geojson:t,index:e})})),e.load(n),e}(t),n=[],u={};return s(t,(function(t,r){if(u[r])return!0;for(e.remove({index:r},c),u[r]=!0;;){var o=a(t),s=e.search({minX:o[0],minY:o[1],maxX:o[2],maxY:o[3]});if(s.length>0){var l=s.map((function(t){return u[t.index]=!0,e.remove({index:t.index},c),t.geojson}));l.push(t),t=i.apply(this,l)}if(0===s.length)break}n.push(t)})),o.featureCollection(n)}function c(t,e){return t.index===e.index}t.exports=function(t,e){var n=function(t){var e=t&&t.geometry.coordinates||[[[180,90],[-180,90],[-180,-90],[180,-90],[180,90]]];return o.polygon(e)}(e),r=function(t){var e=[],n=[];return s(t,(function(t){var r=t.geometry.coordinates,i=r[0],a=r.slice(1);e.push(o.polygon([i])),a.forEach((function(t){n.push(o.polygon([t]))}))})),[o.featureCollection(e),o.featureCollection(n)]}(t),i=r[0],a=r[1];return function(t,e,n){var r=[];return r.push(t.geometry.coordinates[0]),s(e,(function(t){r.push(t.geometry.coordinates[0])})),s(n,(function(t){r.push(t.geometry.coordinates[0])})),o.polygon(r)}(n,i=u(i),a=u(a))}},function(t,e,n){var r=n(170),i=n(169),o=n(11).featureCollection,a=n(15).flattenEach;t.exports=function(t,e,n,s){if(!t)throw new Error("geojson is required");if(e<=0)throw new Error("segmentLength must be greater than 0");var u=[];return a(t,(function(t){s&&(t.geometry.coordinates=t.geometry.coordinates.reverse()),function(t,e,n,o){var a=i(t,n);if(a<=e)return o(t);for(var s=Math.floor(a/e)+1,u=0;u<s;u++){var c=r(t,e*u,e*(u+1),n);o(c,u)}}(t,e,n,(function(t){u.push(t)}))})),o(u)}},function(t,e,n){var r=n(15),i=n(11),o=n(455),a=r.flattenEach,s=r.featureEach,u=i.polygon,c=i.featureCollection;t.exports=function(t){var e=[];return a(t,(function(t){"Polygon"===t.geometry.type&&s(o(t),(function(n){e.push(u(n.geometry.coordinates,t.properties))}))})),c(e)}},function(t,e,n){var r=n(212).geometry,i=n(91).geomReduce;t.exports=function(t){return i(t,(function(t,e){return t+r(e)}),0)}},function(t,e,n){(function(r){function i(){var t;try{t=e.storage.debug}catch(t){}return!t&&void 0!==r&&"env"in r&&(t=Object({NODE_ENV:"production"}).DEBUG),t}(e=t.exports=n(457)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},e.formatArgs=function(t){var n=this.useColors;if(t[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+t[0]+(n?"%c ":" ")+"+"+e.humanize(this.diff),!n)return;var r="color: "+this.color;t.splice(1,0,r,"color: inherit");var i=0,o=0;t[0].replace(/%[a-zA-Z%]/g,(function(t){"%%"!==t&&(i++,"%c"===t&&(o=i))})),t.splice(o,0,r)},e.save=function(t){try{null==t?e.storage.removeItem("debug"):e.storage.debug=t}catch(t){}},e.load=i,e.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},e.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(t){}}(),e.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],e.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},e.enable(i())}).call(this,n(61))},function(t,e,n){var r=n(459),i=n(16).getCoord;t.exports=function(t,e,n,o,a){return t=i(t),e=i(e),n=n||{},o=o||100,a=a||10,new r.GreatCircle({x:t[0],y:t[1]},{x:e[0],y:e[1]},n).Arc(o,{offset:a}).json()}},function(t,e,n){var r=n(15),i=n(165),o=n(11),a=n(172),s=n(123),u=n(16),c=n(93),l=n(94),f=n(73),h=u.getCoords,d=o.lineString,p=u.getGeomType,g=r.featureEach,v=r.featureReduce,y=o.featureCollection;function m(t,e){var n=[],r=i();return g(e,(function(e){if(n.forEach((function(t,e){t.id=e})),n.length){var i=_(e,r.search(e));n=n.filter((function(t){return t.id!==i.id})),r.remove(i),g(b(i,e),(function(t){n.push(t),r.insert(t)}))}else n=b(t,e).features,r.load(y(n))})),y(n)}function b(t,e){var n=[],r=h(t)[0],o=h(t)[t.geometry.coordinates.length-1];if(x(r,h(e))||x(o,h(e)))return y([t]);var a=i(),s=c(t);a.load(s);var u=a.search(e);if(!u.features.length)return y([t]);var l=_(e,u),f=v(s,(function(t,r,i){var o=h(r)[1],a=h(e);return i===l.id?(t.push(a),n.push(d(t)),x(a,o)?[a]:[a,o]):(t.push(o),t)}),[r]);return f.length>1&&n.push(d(f)),y(n)}function _(t,e){if(!e.features)throw new Error("<lines> must contain features");if(1===e.features.length)return e.features[0];var n,r=1/0;return g(e,(function(e){var i=l(e,t).properties.dist;i<r&&(n=e,r=i)})),n}function x(t,e){return t[0]===e[0]&&t[1]===e[1]}t.exports=function(t,e){if(!t)throw new Error("line is required");if(!e)throw new Error("splitter is required");var n=p(t),r=p(e);if("LineString"!==n)throw new Error("line must be LineString");if("FeatureCollection"===r)throw new Error("splitter cannot be a FeatureCollection");if("GeometryCollection"===r)throw new Error("splitter cannot be a GeometryCollection");var i=s(e,7);switch(r){case"Point":return b(t,i);case"MultiPoint":return m(t,a(i));case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":return m(t,f(t,i))}}},function(t,e,n){var r=n(39),i=n(16).getCoords,o=n(11),a=o.polygon,s=o.multiPolygon,u=o.lineString;function c(t,e,n,o){e=e||t.properties||{};var s=i(t),c=l(t);if(!s.length)throw new Error("line must contain coordinates");switch(c){case"LineString":return n&&(s=f(s)),a([s],e);case"MultiLineString":var h=[],d=0;return s.forEach((function(t){if(n&&(t=f(t)),o){var e=function(t){var e=t[0],n=t[1],r=t[2],i=t[3];return Math.abs(e-r)*Math.abs(n-i)}(r(u(t)));e>d?(h.unshift(t),d=e):h.push(t)}else h.push(t)})),a(h,e);default:throw new Error("geometry type "+c+" is not supported")}}function l(t){return t.geometry?t.geometry.type:t.type}function f(t){var e=t[0],n=e[0],r=e[1],i=t[t.length-1],o=i[0],a=i[1];return n===o&&r===a||t.push(e),t}t.exports=function(t,e,n,r){if(!t)throw new Error("lines is required");switch(n=void 0===n||n,r=void 0===r||r,l(t)){case"FeatureCollection":case"GeometryCollection":var o=[];return(t.features?t.features:t.geometries).forEach((function(t){o.push(i(c(t,{},n,r)))})),s(o,e)}return c(t,e,n,r)}},function(t,e,n){var r=n(11),i=n(460),o=n(16).getCoords,a=r.lineString,s=r.multiLineString,u=r.polygon,c=r.multiPolygon;function l(t,e){for(var n=[],r=0;r<t.length;r++){var o=i.polygon(t[r],e);o.length>0&&(o[0][0]===o[o.length-1][0]&&o[0][1]===o[o.length-1][1]||o.push(o[0]),o.length>=4&&n.push(o))}return n}t.exports=function(t,e){var n=function(t){return t.geometry?t.geometry.type:t.type}(t),r=o(t),f=t.properties;switch(n){case"LineString":case"MultiLineString":var h=[];return"LineString"===n&&(r=[r]),r.forEach((function(t){i(t,e,h)})),1===h.length?a(h[0],f):s(h,f);case"Polygon":return u(l(r,e),f);case"MultiPolygon":return c(r.map((function(t){return l(t,e)})),f);default:throw new Error("geometry "+n+" not supported")}}},function(t,e,n){var r=n(120),i=n(15).coordEach,o=n(11),a=n(16).getCoords,s=o.polygon,u=n(173);function c(t){var e=t%360;return e<0&&(e+=360),e}t.exports=function(t,e,n,o,l,f){if(!t)throw new Error("center is required");if(null==n)throw new Error("bearing1 is required");if(null==o)throw new Error("bearing2 is required");if(!e)throw new Error("radius is required");if(l=l||64,c(n)===c(o))return r(t,e,l,f);var h=a(t),d=u(t,e,n,o,l,f),p=[[h]];return i(d,(function(t){p[0].push(t)})),p[0].push(h),s(p)}},function(t,e,n){"use strict";if(t.exports)var r=n(97);function i(t,e,n,o,a,s,u){if(!(this instanceof i))return new i(t,e,n,o,a,s,u);if(void 0===a&&(a=r.datum.WGS84),void 0===s&&(s=null),void 0===u&&(u=null),!(1<=t&&t<=60))throw new Error("Invalid UTM zone "+t);if(!e.match(/[NS]/i))throw new Error("Invalid UTM hemisphere "+e);this.zone=Number(t),this.hemisphere=e.toUpperCase(),this.easting=Number(n),this.northing=Number(o),this.datum=a,this.convergence=null===s?null:Number(s),this.scale=null===u?null:Number(u)}r.prototype.toUtm=function(){if(isNaN(this.lat)||isNaN(this.lon))throw new Error("Invalid point");if(!(-80<=this.lat&&this.lat<=84))throw new Error("Outside UTM limits");var t=Math.floor((this.lon+180)/6)+1,e=(6*(t-1)-180+3).toRadians(),n="CDEFGHJKLMNPQRSTUVWXX".charAt(Math.floor(this.lat/8+10));31==t&&"V"==n&&this.lon>=3&&(t++,e+=6..toRadians()),32==t&&"X"==n&&this.lon<9&&(t--,e-=6..toRadians()),32==t&&"X"==n&&this.lon>=9&&(t++,e+=6..toRadians()),34==t&&"X"==n&&this.lon<21&&(t--,e-=6..toRadians()),34==t&&"X"==n&&this.lon>=21&&(t++,e+=6..toRadians()),36==t&&"X"==n&&this.lon<33&&(t--,e-=6..toRadians()),36==t&&"X"==n&&this.lon>=33&&(t++,e+=6..toRadians());for(var r=this.lat.toRadians(),o=this.lon.toRadians()-e,a=this.datum.ellipsoid.a,s=this.datum.ellipsoid.f,u=.9996,c=Math.sqrt(s*(2-s)),l=s/(2-s),f=l*l,h=l*f,d=l*h,p=l*d,g=l*p,v=Math.cos(o),y=Math.sin(o),m=Math.tan(o),b=Math.tan(r),_=Math.sinh(c*Math.atanh(c*b/Math.sqrt(1+b*b))),x=b*Math.sqrt(1+_*_)-_*Math.sqrt(1+b*b),w=Math.atan2(x,v),E=Math.asinh(y/Math.sqrt(x*x+v*v)),S=a/(1+l)*(1+1/4*f+1/64*d+1/256*g),O=[null,.5*l-2/3*f+5/16*h+41/180*d-127/288*p+7891/37800*g,13/48*f-.6*h+557/1440*d+281/630*p-1983433/1935360*g,61/240*h-103/140*d+15061/26880*p+167603/181440*g,49561/161280*d-179/168*p+6601661/7257600*g,34729/80640*p-3418889/1995840*g,.6650675310896665*g],P=w,C=1;C<=6;C++)P+=O[C]*Math.sin(2*C*w)*Math.cosh(2*C*E);var M=E;for(C=1;C<=6;C++)M+=O[C]*Math.cos(2*C*w)*Math.sinh(2*C*E);var I=u*S*M,A=u*S*P,T=1;for(C=1;C<=6;C++)T+=2*C*O[C]*Math.cos(2*C*w)*Math.cosh(2*C*E);var N=0;for(C=1;C<=6;C++)N+=2*C*O[C]*Math.sin(2*C*w)*Math.sinh(2*C*E);var L=Math.atan(x/Math.sqrt(1+x*x)*m)+Math.atan2(N,T),R=Math.sin(r),k=u*(Math.sqrt(1-c*c*R*R)*Math.sqrt(1+b*b)/Math.sqrt(x*x+v*v))*(S/a*Math.sqrt(T*T+N*N));I+=5e5,A<0&&(A+=1e7),I=Number(I.toFixed(6)),A=Number(A.toFixed(6));var j=Number(L.toDegrees().toFixed(9)),F=Number(k.toFixed(12));return new i(t,this.lat>=0?"N":"S",I,A,this.datum,j,F)},i.prototype.toLatLonE=function(){var t=this.zone,e=this.hemisphere,n=this.easting,i=this.northing;if(isNaN(t)||isNaN(n)||isNaN(i))throw new Error("Invalid coordinate");var o=this.datum.ellipsoid.a,a=this.datum.ellipsoid.f,s=.9996;n-=5e5,i="S"==e?i-1e7:i;for(var u=Math.sqrt(a*(2-a)),c=a/(2-a),l=c*c,f=c*l,h=c*f,d=c*h,p=c*d,g=o/(1+c)*(1+1/4*l+1/64*h+1/256*p),v=n/(s*g),y=i/(s*g),m=[null,.5*c-2/3*l+37/96*f-1/360*h-81/512*d+96199/604800*p,1/48*l+1/15*f-437/1440*h+46/105*d-1118711/3870720*p,17/480*f-37/840*h-209/4480*d+5569/90720*p,4397/161280*h-11/504*d-830251/7257600*p,4583/161280*d-108847/3991680*p,20648693/638668800*p],b=y,_=1;_<=6;_++)b-=m[_]*Math.sin(2*_*y)*Math.cosh(2*_*v);var x=v;for(_=1;_<=6;_++)x-=m[_]*Math.cos(2*_*y)*Math.sinh(2*_*v);var w=Math.sinh(x),E=Math.sin(b),S=Math.cos(b),O=E/Math.sqrt(w*w+S*S),P=O;do{var C=Math.sinh(u*Math.atanh(u*P/Math.sqrt(1+P*P))),M=P*Math.sqrt(1+C*C)-C*Math.sqrt(1+P*P),I=(O-M)/Math.sqrt(1+M*M)*(1+(1-u*u)*P*P)/((1-u*u)*Math.sqrt(1+P*P));P+=I}while(Math.abs(I)>1e-12);var A=P,T=Math.atan(A),N=Math.atan2(w,S),L=1;for(_=1;_<=6;_++)L-=2*_*m[_]*Math.cos(2*_*y)*Math.cosh(2*_*v);var R=0;for(_=1;_<=6;_++)R+=2*_*m[_]*Math.sin(2*_*y)*Math.sinh(2*_*v);var k=Math.atan(Math.tan(b)*Math.tanh(x))+Math.atan2(R,L),j=Math.sin(T),F=s*(Math.sqrt(1-u*u*j*j)*Math.sqrt(1+A*A)*Math.sqrt(w*w+S*S))*(g/o/Math.sqrt(L*L+R*R));N+=(6*(t-1)-180+3).toRadians();var D=Number(T.toDegrees().toFixed(11)),B=Number(N.toDegrees().toFixed(11)),z=Number(k.toDegrees().toFixed(9)),V=Number(F.toFixed(12)),G=new r(D,B,this.datum);return G.convergence=z,G.scale=V,G},i.parse=function(t,e){if(void 0===e&&(e=r.datum.WGS84),null==(t=t.trim().match(/\S+/g))||4!=t.length)throw new Error("Invalid UTM coordinate "+t+"");return new i(t[0],t[1],t[2],t[3],e)},i.prototype.toString=function(t){t=Number(t||0);var e=this.zone<10?"0"+this.zone:this.zone,n=this.hemisphere,r=this.easting,i=this.northing;return isNaN(e)||!n.match(/[NS]/)||isNaN(r)||isNaN(i)?"":e+" "+n+" "+r.toFixed(t)+" "+i.toFixed(t)},void 0===Math.sinh&&(Math.sinh=function(t){return(Math.exp(t)-Math.exp(-t))/2}),void 0===Math.cosh&&(Math.cosh=function(t){return(Math.exp(t)+Math.exp(-t))/2}),void 0===Math.tanh&&(Math.tanh=function(t){return(Math.exp(t)-Math.exp(-t))/(Math.exp(t)+Math.exp(-t))}),void 0===Math.asinh&&(Math.asinh=function(t){return Math.log(t+Math.sqrt(1+t*t))}),void 0===Math.atanh&&(Math.atanh=function(t){return Math.log((1+t)/(1-t))/2}),t.exports&&(t.exports=i)},function(t,e,n){var r=n(16).getCoords,i=n(11),o=i.featureCollection;function a(t,e,n,r,i,o){for(var a=0;a<t.length;a++){var c=t[a],l=t[a+1];a===t.length-1&&(l=t[0]),r=u(c,l,e),n<=0&&r>0&&(u(e,c,i)<=0||(i=c)),n>0&&r<=0&&(s(e,c,o)||(o=c)),n=r}return[i,o]}function s(t,e,n){return u(t,e,n)>=0}function u(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(n[0]-t[0])*(e[1]-t[1])}t.exports=function(t,e){var n,s,c,l,f=r(t),h=r(e);switch((l=e).geometry?l.geometry.type:l.type){case"Polygon":s=0,c=0,n=u(h[0][0],h[0][1],f);var d=a(h[0],f,n,void 0,s,c);s=d[0],c=d[1];break;case"MultiPolygon":s=0,c=0,n=u(h[0][0][0],h[0][0][1],f),h.forEach((function(t){var e=a(t[0],f,n,void 0,s,c);s=e[0],c=e[1]}))}return o([i.point(s),i.point(c)])}},function(t,e,n){var r=n(15),i=n(16).getCoords,o=n(176),a=n(11).featureCollection,s=r.geomEach,u=r.featureEach;function c(t,e){switch("Feature"===t.type?t.geometry.type:t.type){case"GeometryCollection":return s(t,(function(t){c(t,e)})),t;case"LineString":return l(i(t),e),t;case"Polygon":return f(i(t),e),t;case"MultiLineString":return i(t).forEach((function(t){l(t,e)})),t;case"MultiPolygon":return i(t).forEach((function(t){f(t,e)})),t;case"Point":case"MultiPoint":return t}}function l(t,e){o(t)===e&&t.reverse()}function f(t,e){o(t[0])!==e&&t[0].reverse();for(var n=1;n<t.length;n++)o(t[n])===e&&t[n].reverse()}t.exports=function(t,e,n){if(e=void 0!==e&&e,n=void 0!==n&&n,!t)throw new Error("<geojson> is required");if("boolean"!=typeof e)throw new Error("<reverse> must be a boolean");if("boolean"!=typeof n)throw new Error("<mutate> must be a boolean");!1!==n&&void 0!==n||(t=JSON.parse(JSON.stringify(t)));var r=[];switch(t.type){case"GeometryCollection":return s(t,(function(t){c(t,e)})),t;case"FeatureCollection":return u(t,(function(t){u(c(t,e),(function(t){r.push(t)}))})),a(r)}return c(t,e)}},function(t,e,n){var r=n(466),i=n(252),o=n(467),a=n(124),s=n(468),u=n(263),c=n(551),l=n(469),f=a.polygon,h=a.multiPolygon,d=u.collectionOf,p=a.featureCollection;function g(t){var e=[],n=[];t.forEach((function(t){var r=i(f([t]));n.push(r),e.push({ring:t,area:r})})),n.sort((function(t,e){return e-t}));var r=[];return n.forEach((function(t){for(var n=0;n<e.length;n++)if(e[n].area===t){r.push(e[n].ring),e.splice(n,1);break}})),r}function v(t){for(var e=t.map((function(t){return{lrCoordinates:t,grouped:!1}})),n=[];!m(e);)for(var r=0;r<e.length;r++)if(!e[r].grouped){var i=[];i.push(e[r].lrCoordinates),e[r].grouped=!0;for(var o=f([e[r].lrCoordinates]),a=r+1;a<e.length;a++){if(!e[a].grouped)y(f([e[a].lrCoordinates]),o)&&(i.push(e[a].lrCoordinates),e[a].grouped=!0)}n.push(i)}return n}function y(t,e){for(var n=s(t),r=0;r<n.features.length;r++)if(!o(n.features[r],e))return!1;return!0}function m(t){for(var e=0;e<t.length;e++)if(!1===t[e].grouped)return!1;return!0}t.exports=function(t,e,n,i){var o=function(t){return!!t&&t.constructor===Object};if(d(t,"Point","Input must contain Points"),!e||!Array.isArray(e))throw new Error("breaks is required");if((i=i||{}).commonProperties&&!o(i.commonProperties))throw new Error("commonProperties is not an Object");if(i.isobandProperties&&!Array.isArray(i.isobandProperties))throw new Error("isobandProperties is not an Array");if(n&&"string"!=typeof n)throw new Error("zProperty is not a string");n=n||"elevation";var a=i.commonProperties||{},s=i.isobandProperties||[],u=c(t,n,!0),f=function(t,e,n){for(var r=[],i=1;i<e.length;i++){var o=+e[i-1],a=+e[i],s=v(g(l.isoBands(t,o,a-o))),u={};u.groupedRings=s,u[n]=o+"-"+a,r.push(u)}return r}(u,e,n),y=(f=function(t,e,n){var i=r(n),o=i[2]-i[0],a=i[3]-i[1],s=i[0],u=i[1],c=e[0].length-1,l=e.length-1,f=o/c,h=a/l,d=function(t){t[0]=t[0]*f+s,t[1]=t[1]*h+u};return t.forEach((function(t){t.groupedRings.forEach((function(t){t.forEach((function(t){t.forEach(d)}))}))})),t}(f,u,t)).map((function(t,e){if(s[e]&&!o(s[e]))throw new Error("Each mappedProperty is required to be an Object");var r=Object.assign({},a,s[e]);return r[n]=t[n],h(t.groupedRings,r)}));return p(y)}},function(t,e){function n(t){if(!t)throw new Error("No obj passed");var e;if(t.length?e=t:t.coordinates?e=t.coordinates:t.geometry&&t.geometry.coordinates&&(e=t.geometry.coordinates),e)return function t(e){if(e.length>1&&"number"==typeof e[0]&&"number"==typeof e[1])return!0;if(e[0].length)return t(e[0]);throw new Error("coordinates must only contain numbers")}(e),e;throw new Error("No valid coordinates")}t.exports.geojsonType=function(t,e,n){if(!e||!n)throw new Error("type and name required");if(!t||t.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.type)},t.exports.collectionOf=function(t,e,n){if(!t)throw new Error("No featureCollection passed");if(!n)throw new Error(".collectionOf() requires a name");if(!t||"FeatureCollection"!==t.type)throw new Error("Invalid input to "+n+", FeatureCollection required");for(var r=0;r<t.features.length;r++){var i=t.features[r];if(!i||"Feature"!==i.type||!i.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!i.geometry||i.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+i.geometry.type)}},t.exports.featureOf=function(t,e,n){if(!t)throw new Error("No feature passed");if(!n)throw new Error(".featureOf() requires a name");if(!t||"Feature"!==t.type||!t.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!t.geometry||t.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.geometry.type)},t.exports.getCoord=function(t){if(!t)throw new Error("No obj passed");var e=n(t);if(e.length>1&&"number"==typeof e[0]&&"number"==typeof e[1])return e;throw new Error("Coordinate is not a valid Point")},t.exports.getCoords=n},function(t,e,n){var r=n(15),i=n(85),o=n(16),a=n(96),s=n(98),u=n(99),c=r.coordEach,l=o.getCoords;t.exports=function(t,e,n,r){if(!t)throw new Error("geojson is required");if(null==e||isNaN(e))throw new Error("angle is required");return 0===e||(n||(n=i(t)),!1!==r&&void 0!==r||(t=JSON.parse(JSON.stringify(t))),c(t,(function(t){var r=a(n,t)+e,i=s(n,t),o=l(u(n,i,r));t[0]=o[0],t[1]=o[1]}))),t}},function(t,e,n){var r=n(15),i=n(95),o=n(121),a=n(11),s=n(85),u=n(39),c=n(16),l=n(96),f=n(98),h=n(99),d=a.point,p=r.coordEach,g=r.featureEach,v=c.getCoord,y=c.getCoords,m=c.getGeomType;function b(t,e,n){var r="Point"===m(t);return n=function(t,e){null==e&&(e="centroid");if(Array.isArray(e)||"object"==typeof e)return v(e);var n=t.bbox?t.bbox:u(t),r=n[0],i=n[1],a=n[2],c=n[3];switch(e){case"sw":case"southwest":case"westsouth":case"bottomleft":return d([r,i]);case"se":case"southeast":case"eastsouth":case"bottomright":return d([a,i]);case"nw":case"northwest":case"westnorth":case"topleft":return d([r,c]);case"ne":case"northeast":case"eastnorth":case"topright":return d([a,c]);case"center":return o(t);case void 0:case null:case"centroid":return s(t);default:throw new Error("invalid origin")}}(t,n),1===e||r||p(t,(function(t){var r=f(n,t),i=l(n,t),o=y(h(n,r*e,i));t[0]=o[0],t[1]=o[1],3===t.length&&(t[2]*=e)})),t}t.exports=function(t,e,n,r){if(!t)throw new Error("geojson required");if("number"!=typeof e||0===e)throw new Error("invalid factor");var o=Array.isArray(n)||"object"==typeof n;return!0!==r&&(t=i(t)),"FeatureCollection"!==t.type||o?b(t,e,n):(g(t,(function(r,i){t.features[i]=b(r,e,n)})),t)}},function(t,e,n){var r=n(15),i=n(16),o=n(99),a=r.coordEach,s=i.getCoords;t.exports=function(t,e,n,r,i,u){if(!t)throw new Error("geojson is required");if(null==e||isNaN(e))throw new Error("distance is required");if(i&&"number"!=typeof i&&isNaN(i))throw new Error("zTranslation is not a number");if(i=void 0!==i?i:0,0===e&&0===i)return t;if(null==n||isNaN(n))throw new Error("direction is required");return e<0&&(e=-e,n=-n),!1!==u&&void 0!==u||(t=JSON.parse(JSON.stringify(t))),a(t,(function(t){var a=s(o(t,e,n,r));t[0]=a[0],t[1]=a[1],i&&3===t.length&&(t[2]+=i)})),t}},function(t,e,n){var r=n(15),i=n(11),o=n(16).getCoords,a=n(470),s=r.flattenEach,u=i.lineString,c=i.multiLineString,l=i.distanceToDegrees;function f(t,e,n){var r=[],i=l(e,n),s=o(t),c=[];return s.forEach((function(t,e){if(e!==s.length-1){var n=function(t,e,n){var r=Math.sqrt((t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])),i=t[0]+n*(e[1]-t[1])/r,o=e[0]+n*(e[1]-t[1])/r,a=t[1]+n*(t[0]-e[0])/r,s=e[1]+n*(t[0]-e[0])/r;return[[i,a],[o,s]]}(t,s[e+1],i);if(r.push(n),e>0){var o=r[e-1],u=a(n,o);!1!==u&&(o[1]=u,n[0]=u),c.push(o[0]),e===s.length-2&&(c.push(n[0]),c.push(n[1]))}2===s.length&&(c.push(n[0]),c.push(n[1]))}})),u(c,t.properties)}t.exports=function(t,e,n){if(!t)throw new Error("geojson is required");if(null==e||isNaN(e))throw new Error("distance is required");var r="Feature"===t.type?t.geometry.type:t.type,i=t.properties;switch(r){case"LineString":return f(t,e,n);case"MultiLineString":var o=[];return s(t,(function(t){o.push(f(t,e,n).geometry.coordinates)})),c(o,i);default:throw new Error("geometry "+r+" is not supported")}}},function(t,e,n){var r=n(471);t.exports=function(t){return r(t)}},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=n(177),o=i.orientationIndex,a=i.envelopeIsEqual,s=i.envelopeContains,u=i.coordinatesEqual,c=n(11),l=c.multiPoint,f=c.polygon,h=c.point,d=n(167),p=n(46),g=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.edges=[],this.polygon=void 0,this.envelope=void 0}return r(t,[{key:"push",value:function(t){this[this.edges.length]=t,this.edges.push(t),this.polygon=this.envelope=void 0}},{key:"get",value:function(t){return this.edges[t]}},{key:"forEach",value:function(t){this.edges.forEach(t)}},{key:"map",value:function(t){return this.edges.map(t)}},{key:"some",value:function(t){return this.edges.some(t)}},{key:"isValid",value:function(){return!0}},{key:"isHole",value:function(){var t=this,e=this.edges.reduce((function(e,n,r){return n.from.coordinates[1]>t.edges[e].from.coordinates[1]&&(e=r),e}),0),n=(0===e?this.length:e)-1,r=(e+1)%this.length,i=o(this.edges[n].from.coordinates,this.edges[e].from.coordinates,this.edges[r].from.coordinates);return 0===i?this.edges[n].from.coordinates[0]>this.edges[r].from.coordinates[0]:i>0}},{key:"toMultiPoint",value:function(){return l(this.edges.map((function(t){return t.from.coordinates})))}},{key:"toPolygon",value:function(){if(this.polygon)return this.polygon;var t=this.edges.map((function(t){return t.from.coordinates}));return t.push(this.edges[0].from.coordinates),this.polygon=f([t])}},{key:"getEnvelope",value:function(){return this.envelope?this.envelope:this.envelope=d(this.toPolygon())}},{key:"inside",value:function(t){return p(t,this.toPolygon())}},{key:"length",get:function(){return this.edges.length}}],[{key:"findEdgeRingContaining",value:function(t,e){var n=t.getEnvelope(),r=void 0,i=void 0;return e.forEach((function(e){var o=e.getEnvelope();if(i&&(r=i.getEnvelope()),!a(o,n)&&s(o,n)){var c=t.map((function(t){return t.from.coordinates})).find((function(t){return!e.some((function(e){return u(t,e.from.coordinates)}))}));c&&e.inside(h(c))&&(i&&!s(r,o)||(i=e))}})),i}}]),t}();t.exports=g},function(t,e,n){var r=n(46),i=n(15).flattenEach,o=n(73),a=n(125);function s(t,e){for(var n=0;n<t.coordinates.length-1;n++)if(c(t.coordinates[n],t.coordinates[n+1],e.coordinates))return!0;return!1}function u(t,e){return o(e,a(t)).features.length>0}function c(t,e,n){var r=n[0]-t[0],i=n[1]-t[1],o=e[0]-t[0],a=e[1]-t[1];return 0==r*a-i*o&&(Math.abs(o)>=Math.abs(a)?o>0?t[0]<=n[0]&&n[0]<=e[0]:e[0]<=n[0]&&n[0]<=t[0]:a>0?t[1]<=n[1]&&n[1]<=e[1]:e[1]<=n[1]&&n[1]<=t[1])}t.exports=function(t,e){var n;return i(t,(function(t){i(e,(function(e){if(!1===n)return!1;n=function(t,e){switch(t.type){case"Point":switch(e.type){case"Point":return n=t.coordinates,i=e.coordinates,!(n[0]===i[0]&&n[1]===i[1]);case"LineString":return!s(e,t);case"Polygon":return!r(t,e)}break;case"LineString":switch(e.type){case"Point":return!s(t,e);case"LineString":return!function(t,e){if(o(t,e).features.length>0)return!0;return!1}(t,e);case"Polygon":return!u(e,t)}break;case"Polygon":switch(e.type){case"Point":return!r(e,t);case"LineString":return!u(t,e);case"Polygon":return!function(t,e){for(var n=0;n<t.coordinates[0].length;n++)if(r(t.coordinates[0][n],e))return!0;for(var i=0;i<e.coordinates[0].length;i++)if(r(e.coordinates[0][i],t))return!0;return!1}(e,t)}}var n,i}(t.geometry,e.geometry)}))})),n}},function(t,e,n){var r=n(46),i=n(39),o=n(166),a=n(16),s=a.getGeom,u=a.getCoords,c=a.getGeomType;function l(t,e){return!(t[0]>e[0])&&(!(t[2]<e[2])&&(!(t[1]>e[1])&&!(t[3]<e[3])))}function f(t,e){return t[0]===e[0]&&t[1]===e[1]}t.exports=function(t,e){var n=c(t),a=c(e),h=s(t),d=s(e),p=u(t),g=u(e);switch(n){case"Point":switch(a){case"Point":return f(p,g);default:throw new Error("feature2 "+a+" geometry not supported")}case"MultiPoint":switch(a){case"Point":return function(t,e){var n,r=!1;for(n=0;n<t.coordinates.length;n++)if(f(t.coordinates[n],e.coordinates)){r=!0;break}return r}(h,d);case"MultiPoint":return function(t,e){for(var n=0;n<e.coordinates.length;n++){for(var r=!1,i=0;i<t.coordinates.length;i++)if(f(e.coordinates[n],t.coordinates[i])){r=!0;break}if(!r)return!1}return!0}(h,d);default:throw new Error("feature2 "+a+" geometry not supported")}case"LineString":switch(a){case"Point":return o(d,h,!0);case"LineString":return function(t,e){for(var n=!1,r=0;r<e.coordinates.length;r++)if(o({type:"Point",coordinates:e.coordinates[r]},t,!0)&&(n=!0),!o({type:"Point",coordinates:e.coordinates[r]},t,!1))return!1;return n}(h,d);case"MultiPoint":return function(t,e){for(var n=!1,r=0;r<e.coordinates.length;r++)if(o(e.coordinates[r],t,!0)&&(n=!0),!o(e.coordinates[r],t))return!1;if(n)return!0;return!1}(h,d);default:throw new Error("feature2 "+a+" geometry not supported")}case"Polygon":switch(a){case"Point":return r(d,h,!0);case"LineString":return function(t,e){var n=!1,o=0,a=i(t),s=i(e);if(!l(a,s))return!1;for(;o<e.coordinates.length-1;o++){var u=(c=e.coordinates[o],f=e.coordinates[o+1],[(c[0]+f[0])/2,(c[1]+f[1])/2]);if(r({type:"Point",coordinates:u},t,!0)){n=!0;break}}var c,f;return n}(h,d);case"Polygon":return function(t,e){var n=i(t),o=i(e);if(!l(n,o))return!1;for(var a=0;a<e.coordinates[0].length;a++)if(!r(e.coordinates[0][a],t))return!1;return!0}(h,d);case"MultiPoint":return function(t,e){for(var n=0;n<e.coordinates.length;n++)if(!r(e.coordinates[n],t,!0))return!1;return!0}(h,d);default:throw new Error("feature2 "+a+" geometry not supported")}default:throw new Error("feature1 "+n+" geometry not supported")}}},function(t,e,n){var r=n(11),i=n(46),o=n(73),a=n(125),s=n(16),u=s.getGeom,c=s.getGeomType;function l(t,e){for(var n=!1,r=!1,i=t.coordinates.length,o=0;o<i&&!n&&!r;){for(var a=0;a<e.coordinates.length-1;a++){var s=!0;0!==a&&a!==e.coordinates.length-2||(s=!1),p(e.coordinates[a],e.coordinates[a+1],t.coordinates[o],s)?n=!0:r=!0}o++}return n&&r}function f(t,e){return o(t,a(e)).features.length>0}function h(t,e){return i(e,t)}function d(t,e){for(var n=!1,i=!1,o=t.coordinates[0].length,a=0;a<o&&n&&i;)h(e,r.point(t.coordinates[0][a]))?n=!0:i=!0,a++;return i&&i}function p(t,e,n,r){var i=n[0]-t[0],o=n[1]-t[1],a=e[0]-t[0],s=e[1]-t[1];return 0==i*s-o*a&&(r?Math.abs(a)>=Math.abs(s)?a>0?t[0]<=n[0]&&n[0]<=e[0]:e[0]<=n[0]&&n[0]<=t[0]:s>0?t[1]<=n[1]&&n[1]<=e[1]:e[1]<=n[1]&&n[1]<=t[1]:Math.abs(a)>=Math.abs(s)?a>0?t[0]<n[0]&&n[0]<e[0]:e[0]<n[0]&&n[0]<t[0]:s>0?t[1]<n[1]&&n[1]<e[1]:e[1]<n[1]&&n[1]<t[1])}t.exports=function(t,e){var n=c(t),r=c(e),i=u(t),a=u(e);switch(n){case"MultiPoint":switch(r){case"LineString":return l(i,a);case"Polygon":return d(i,a);default:throw new Error("feature2 "+r+" geometry not supported")}case"LineString":switch(r){case"MultiPoint":return l(a,i);case"LineString":return function(t,e){if(o(t,e).features.length>0)for(var n=0;n<t.coordinates.length-1;n++)for(var r=0;r<e.coordinates.length-1;r++){var i=!0;if(0!==r&&r!==e.coordinates.length-2||(i=!1),p(t.coordinates[n],t.coordinates[n+1],e.coordinates[r],i))return!0}return!1}(i,a);case"Polygon":return f(i,a);default:throw new Error("feature2 "+r+" geometry not supported")}case"Polygon":switch(r){case"MultiPoint":return d(a,i);case"LineString":return f(a,i);default:throw new Error("feature2 "+r+" geometry not supported")}default:throw new Error("feature1 "+n+" geometry not supported")}}},function(t,e,n){var r=n(222),i=n(119),o=n(16).getGeomType;t.exports=function(t,e){if(!t)throw new Error("feature1 is required");if(!e)throw new Error("feature2 is required");return o(t)===o(e)&&new r({precision:6}).compare(i(t),i(e))}},function(t,e,n){var r=n(46),i=n(39),o=n(16),a=n(166),s=o.getGeom,u=o.getGeomType;function c(t,e){return!(t[0]>e[0])&&(!(t[2]<e[2])&&(!(t[1]>e[1])&&!(t[3]<e[3])))}function l(t,e){return t[0]===e[0]&&t[1]===e[1]}t.exports=function(t,e){var n=u(t),o=u(e),f=s(t),h=s(e);switch(n){case"Point":switch(o){case"MultiPoint":return function(t,e){var n,r=!1;for(n=0;n<e.coordinates.length;n++)if(l(e.coordinates[n],t.coordinates)){r=!0;break}return r}(f,h);case"LineString":return a(f,h,!0);case"Polygon":return r(f,h,!0);default:throw new Error("feature2 "+o+" geometry not supported")}case"MultiPoint":switch(o){case"MultiPoint":return function(t,e){for(var n=0;n<t.coordinates.length;n++){for(var r=!1,i=0;i<e.coordinates.length;i++)l(t.coordinates[n],e.coordinates[i])&&(r=!0);if(!r)return!1}return!0}(f,h);case"LineString":return function(t,e){for(var n=!1,r=0;r<t.coordinates.length;r++){if(!a(t.coordinates[r],e))return!1;n||(n=a(t.coordinates[r],e,!0))}return n}(f,h);case"Polygon":return function(t,e){for(var n=!0,i=0;i<t.coordinates.length;i++){var o=r(t.coordinates[1],e);if(!o){n=!1;break}o=r(t.coordinates[1],e,!0)}return n&&o}(f,h);default:throw new Error("feature2 "+o+" geometry not supported")}case"LineString":switch(o){case"LineString":return function(t,e){for(var n=0;n<t.coordinates.length;n++)if(!a(t.coordinates[n],e))return!1;return!0}(f,h);case"Polygon":return function(t,e){var n=i(e),o=i(t);if(!c(n,o))return!1;for(var a=!1,s=0;s<t.coordinates.length-1;s++){if(!r(t.coordinates[s],e))return!1;if(a||(a=r(t.coordinates[s],e,!0)),!a){var u=(l=t.coordinates[s],f=t.coordinates[s+1],[(l[0]+f[0])/2,(l[1]+f[1])/2]);a=r(u,e,!0)}}var l,f;return a}(f,h);default:throw new Error("feature2 "+o+" geometry not supported")}case"Polygon":switch(o){case"Polygon":return function(t,e){var n=i(t);if(!c(i(e),n))return!1;for(var o=0;o<t.coordinates[0].length;o++)if(!r(t.coordinates[0][o],e))return!1;return!0}(f,h);default:throw new Error("feature2 "+o+" geometry not supported")}default:throw new Error("feature1 "+n+" geometry not supported")}}},function(t,e,n){var r=n(15),i=n(72),o=n(11),a=n(37),s=n(16),u=n(96),c=n(98),l=o.lineString,f=s.featureOf,h=o.point,d=r.segmentEach,p=o.bearingToAngle,g=o.convertDistance,v=o.degrees2radians;function y(t,e,n,r,o){var s=!0!==o?a(e,t,r):m(e,t,r),l=p(!0!==o?i(e,t):u(e,t)),f=p(!0!==o?i(e,n):u(e,n)),d=Math.abs(l-f);if(d>90)return s;var g=(f+180)%360,y=p(!0!==o?i(n,t):u(n,t)),_=Math.abs(y-g);return _>180&&(_=Math.abs(_-360)),_>90?!0!==o?a(t,n,r):m(t,n,r):!0!==o?s*Math.sin(v(d)):function(t,e,n,r){var i=0;(Math.abs(t[0])>=180||Math.abs(e[0])>=180||Math.abs(n[0])>=180)&&(i=t[0]>0||e[0]>0||n[0]>0?-180:180);var o=h(n),a=b([t[0]+i,t[1]]),s=b([e[0]+i,e[1]]),u=b([n[0]+i,n[1]]),l=function(t){var e=180/Math.PI,n=6378137;return[t[0]*e/n,(.5*Math.PI-2*Math.atan(Math.exp(-t[1]/n)))*e]}(function(t,e,n){var r=t[0],i=t[1],o=e[0],a=e[1],s=n[0],u=n[1],c=o-r,l=a-i,f=((s-r)*c+(u-i)*l)/(c*c+l*l);return[r+f*c,i+f*l]}(a,s,u));0!==i&&(l[0]-=i);return c(o,l,r)}(e,n,t,r)}function m(t,e,n){var r=0;Math.abs(t[0])>=180&&(r=t[0]>0?-180:180),Math.abs(e[0])>=180&&(r=e[0]>0?-180:180);var i=b([t[0]+r,t[1]]),o=b([e[0]+r,e[1]]),a=function(t){return t*t},s=a(i[0]-o[0])+a(i[1]-o[1]),u=Math.sqrt(s);return g(u,"meters",n)}function b(t){var e=Math.PI/180,n=6378137,r=20037508.342789244,i=[n*t[0]*e,n*Math.log(Math.tan(.25*Math.PI+.5*t[1]*e))];return i[0]>r&&(i[0]=r),i[0]<-r&&(i[0]=-r),i[1]>r&&(i[1]=r),i[1]<-r&&(i[1]=-r),i}t.exports=function(t,e,n,r){if(!t)throw new Error("point is required");if(Array.isArray(t)?t=h(t):f(t,"Point","point"),!e)throw new Error("line is required");Array.isArray(e)?e=l(e):f(e,"LineString","line");var i=1/0,o=t.geometry.coordinates;return d(e,(function(t){var e=t.geometry.coordinates[0],a=t.geometry.coordinates[1],s=y(o,e,a,n,r);i>s&&(i=s)})),i}},function(t,e){t.exports=function(t,e){return t===e||t!=t&&e!=e}},function(t,e,n){var r=n(129),i=n(100);t.exports=function(t){if(!i(t))return!1;var e=r(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}},function(t,e,n){(function(e){var n="object"==typeof e&&e&&e.Object===Object&&e;t.exports=n}).call(this,n(50))},function(t,e){var n=Function.prototype.toString;t.exports=function(t){if(null!=t){try{return n.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},function(t,e,n){var r=n(281),i=n(276),o=Object.prototype.hasOwnProperty;t.exports=function(t,e,n){var a=t[e];o.call(t,e)&&i(a,n)&&(void 0!==n||e in t)||r(t,e,n)}},function(t,e,n){var r=n(509);t.exports=function(t,e,n){"__proto__"==e&&r?r(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}},function(t,e,n){var r=n(511),i=n(512),o=n(181),a=n(283),s=n(515),u=n(516),c=Object.prototype.hasOwnProperty;t.exports=function(t,e){var n=o(t),l=!n&&i(t),f=!n&&!l&&a(t),h=!n&&!l&&!f&&u(t),d=n||l||f||h,p=d?r(t.length,String):[],g=p.length;for(var v in t)!e&&!c.call(t,v)||d&&("length"==v||f&&("offset"==v||"parent"==v)||h&&("buffer"==v||"byteLength"==v||"byteOffset"==v)||s(v,g))||p.push(v);return p}},function(t,e,n){(function(t){var r=n(56),i=n(514),o=e&&!e.nodeType&&e,a=o&&"object"==typeof t&&t&&!t.nodeType&&t,s=a&&a.exports===o?r.Buffer:void 0,u=(s?s.isBuffer:void 0)||i;t.exports=u}).call(this,n(116)(t))},function(t,e){t.exports=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}},function(t,e){t.exports=function(t,e){return function(n){return t(e(n))}}},function(t,e,n){var r=n(277),i=n(284);t.exports=function(t){return null!=t&&i(t.length)&&!r(t)}},function(t,e,n){var r=n(282),i=n(521),o=n(286);t.exports=function(t){return o(t)?r(t,!0):i(t)}},function(t,e){t.exports=function(){return[]}},function(t,e,n){var r=n(290),i=n(291),o=n(185),a=n(288),s=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)r(e,o(t)),t=i(t);return e}:a;t.exports=s},function(t,e){t.exports=function(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}},function(t,e,n){var r=n(285)(Object.getPrototypeOf,Object);t.exports=r},function(t,e,n){var r=n(290),i=n(181);t.exports=function(t,e,n){var o=e(t);return i(t)?o:r(o,n(t))}},function(t,e,n){"use strict";(function(t){var r=n(22);e.a="undefined"!=typeof window&&"object"===Object(r.a)(window.process)&&"renderer"===window.process.type||!(void 0===t||"object"!==Object(r.a)(t.versions)||!Boolean(t.versions.electron))||"object"===("undefined"==typeof navigator?"undefined":Object(r.a)(navigator))&&"string"==typeof navigator.userAgent&&navigator.userAgent.indexOf("Electron")>=0}).call(this,n(61))},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r,i=n(0),o=function(t){return s(t)?void 0:0},a=(r={},Object(i.a)(r,3074,(function(t){return s(t)?void 0:36064})),Object(i.a)(r,35723,(function(t){return s(t)?void 0:4352})),Object(i.a)(r,35977,o),Object(i.a)(r,32937,o),Object(i.a)(r,36795,(function(t,e){var n=s(t)?t.getExtension("EXT_disjoint_timer_query_webgl2"):t.getExtension("EXT_disjoint_timer_query");return n&&n.GPU_DISJOINT_EXT?e(n.GPU_DISJOINT_EXT):0})),Object(i.a)(r,37445,(function(t,e){var n=t.getExtension("WEBGL_debug_renderer_info");return e(n&&n.UNMASKED_VENDOR_WEBGL||7936)})),Object(i.a)(r,37446,(function(t,e){var n=t.getExtension("WEBGL_debug_renderer_info");return e(n&&n.UNMASKED_RENDERER_WEBGL||7937)})),Object(i.a)(r,34047,(function(t,e){var n=t.luma.extensions.EXT_texture_filter_anisotropic;return n?e(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1})),Object(i.a)(r,32883,o),Object(i.a)(r,35071,o),Object(i.a)(r,37447,o),Object(i.a)(r,36063,(function(t,e){if(!s(t)){var n=t.getExtension("WEBGL_draw_buffers");return n?e(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}})),Object(i.a)(r,35379,o),Object(i.a)(r,35374,o),Object(i.a)(r,35377,o),Object(i.a)(r,34852,(function(t){if(!s(t)){var e=t.getExtension("WEBGL_draw_buffers");return e?e.MAX_DRAW_BUFFERS_WEBGL:0}})),Object(i.a)(r,36203,(function(t){return t.getExtension("OES_element_index")?2147483647:65535})),Object(i.a)(r,33001,(function(t){return t.getExtension("OES_element_index")?16777216:65535})),Object(i.a)(r,33e3,(function(t){return 16777216})),Object(i.a)(r,37157,o),Object(i.a)(r,35373,o),Object(i.a)(r,35657,o),Object(i.a)(r,36183,o),Object(i.a)(r,37137,o),Object(i.a)(r,34045,o),Object(i.a)(r,35978,o),Object(i.a)(r,35979,o),Object(i.a)(r,35968,o),Object(i.a)(r,35376,o),Object(i.a)(r,35375,o),Object(i.a)(r,35659,o),Object(i.a)(r,37154,o),Object(i.a)(r,35371,o),Object(i.a)(r,35658,o),Object(i.a)(r,35076,o),Object(i.a)(r,35077,o),Object(i.a)(r,35380,o),r);function s(t){return t&&!0}function u(t,e,n){var r=a[n],i="function"==typeof r?r(t,e,n):r;return void 0!==i?i:e(n)}},function(t,e,n){"use strict";t.exports=i,t.exports.default=i;var r=1e20;function i(t,e,n,r,i,o){this.fontSize=t||24,this.buffer=void 0===e?3:e,this.cutoff=r||.25,this.fontFamily=i||"sans-serif",this.fontWeight=o||"normal",this.radius=n||8;var a=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=a,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.d=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Int16Array(a),this.middle=Math.round(a/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function o(t,e,n,r,i,o,s){for(var u=0;u<e;u++){for(var c=0;c<n;c++)r[c]=t[c*e+u];for(a(r,i,o,s,n),c=0;c<n;c++)t[c*e+u]=i[c]}for(c=0;c<n;c++){for(u=0;u<e;u++)r[u]=t[c*e+u];for(a(r,i,o,s,e),u=0;u<e;u++)t[c*e+u]=Math.sqrt(i[u])}}function a(t,e,n,i,o){n[0]=0,i[0]=-r,i[1]=+r;for(var a=1,s=0;a<o;a++){for(var u=(t[a]+a*a-(t[n[s]]+n[s]*n[s]))/(2*a-2*n[s]);u<=i[s];)s--,u=(t[a]+a*a-(t[n[s]]+n[s]*n[s]))/(2*a-2*n[s]);n[++s]=a,i[s]=u,i[s+1]=+r}for(a=0,s=0;a<o;a++){for(;i[s+1]<a;)s++;e[a]=(a-n[s])*(a-n[s])+t[n[s]]}}i.prototype.draw=function(t){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(t,this.buffer,this.middle);for(var e=this.ctx.getImageData(0,0,this.size,this.size),n=new Uint8ClampedArray(this.size*this.size),i=0;i<this.size*this.size;i++){var a=e.data[4*i+3]/255;this.gridOuter[i]=1===a?0:0===a?r:Math.pow(Math.max(0,.5-a),2),this.gridInner[i]=1===a?r:0===a?0:Math.pow(Math.max(0,a-.5),2)}for(o(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),o(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),i=0;i<this.size*this.size;i++){var s=this.gridOuter[i]-this.gridInner[i];n[i]=Math.max(0,Math.min(255,Math.round(255-255*(s/this.radius+this.cutoff))))}return n}},function(t,e){t.exports=function(t,e){return t[0]=-e[0],t[1]=-e[1],t}},function(t,e){t.exports=function(t,e,n,r,i){var o=1/Math.tan(e/2),a=1/(r-i);return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(i+r)*a,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*i*r*a,t[15]=0,t}},function(t,e){t.exports=function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[4],a=e[5],s=e[6],u=e[7],c=e[8],l=e[9],f=e[10],h=e[11];e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t[4]=o*i+c*r,t[5]=a*i+l*r,t[6]=s*i+f*r,t[7]=u*i+h*r,t[8]=c*i-o*r,t[9]=l*i-a*r,t[10]=f*i-s*r,t[11]=h*i-u*r,t}},function(t,e){t.exports=function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],c=e[4],l=e[5],f=e[6],h=e[7];e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t[0]=o*i+c*r,t[1]=a*i+l*r,t[2]=s*i+f*r,t[3]=u*i+h*r,t[4]=c*i-o*r,t[5]=l*i-a*r,t[6]=f*i-s*r,t[7]=h*i-u*r,t}},function(t,e){t.exports=function(t,e,n,r){var i=e[0],o=e[1];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t}},function(t,e){t.exports=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}},function(t,e){t.exports=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*a,t[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*a,t[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*a,t[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*a,t}},function(t,e){t.exports=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8],f=e[9],h=e[10],d=e[11],p=e[12],g=e[13],v=e[14],y=e[15],m=n*s-r*a,b=n*u-i*a,_=n*c-o*a,x=r*u-i*s,w=r*c-o*s,E=i*c-o*u,S=l*g-f*p,O=l*v-h*p,P=l*y-d*p,C=f*v-h*g,M=f*y-d*g,I=h*y-d*v,A=m*I-b*M+_*C+x*P-w*O+E*S;if(!A)return null;return A=1/A,t[0]=(s*I-u*M+c*C)*A,t[1]=(i*M-r*I-o*C)*A,t[2]=(g*E-v*w+y*x)*A,t[3]=(h*w-f*E-d*x)*A,t[4]=(u*P-a*I-c*O)*A,t[5]=(n*I-i*P+o*O)*A,t[6]=(v*_-p*E-y*b)*A,t[7]=(l*E-h*_+d*b)*A,t[8]=(a*M-s*P+c*S)*A,t[9]=(r*P-n*M-o*S)*A,t[10]=(p*w-g*_+y*m)*A,t[11]=(f*_-l*w-d*m)*A,t[12]=(s*O-a*C-u*S)*A,t[13]=(n*C-r*O+i*S)*A,t[14]=(g*b-p*x-v*m)*A,t[15]=(l*x-f*b+h*m)*A,t}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(305);Object.defineProperty(e,"PolylineLayerGL",{enumerable:!0,get:function(){return b(r).default}});var i=n(373);Object.defineProperty(e,"ScatterLayerGL",{enumerable:!0,get:function(){return b(i).default}});var o=n(374);Object.defineProperty(e,"IconLayerGL",{enumerable:!0,get:function(){return b(o).default}});var a=n(375);Object.defineProperty(e,"LightMapGL",{enumerable:!0,get:function(){return b(a).default}});var s=n(377);Object.defineProperty(e,"PolygonLayerGL",{enumerable:!0,get:function(){return b(s).default}});var u=n(378);Object.defineProperty(e,"GridHeatLayerGL",{enumerable:!0,get:function(){return b(u).default}});var c=n(379);Object.defineProperty(e,"HoneyCombLayerGL",{enumerable:!0,get:function(){return b(c).default}});var l=n(380);Object.defineProperty(e,"TripLayerGL",{enumerable:!0,get:function(){return b(l).default}});var f=n(393);Object.defineProperty(e,"TextLayerGL",{enumerable:!0,get:function(){return b(f).default}});var h=n(394);Object.defineProperty(e,"MarkerClusterGL",{enumerable:!0,get:function(){return b(h).default}});var d=n(397);Object.defineProperty(e,"MarkerCluster",{enumerable:!0,get:function(){return b(d).default}});var p=n(406);Object.defineProperty(e,"ArcLayerGL",{enumerable:!0,get:function(){return b(p).default}});var g=n(407);Object.defineProperty(e,"PointDomLayer",{enumerable:!0,get:function(){return b(g).default}});var v=n(408);Object.defineProperty(e,"Direction",{enumerable:!0,get:function(){return b(v).default}});var y=n(409);Object.defineProperty(e,"LineWithIcon",{enumerable:!0,get:function(){return b(y).default}});var m=n(475);function b(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"utils",{enumerable:!0,get:function(){return b(m).default}}),window.react_geoengine_gl=e},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=p(n(108)),i=p(n(31)),o=p(n(32)),a=p(n(33)),s=p(n(34)),u=p(n(35)),c=(p(n(23)),p(n(40))),l=n(42),f=p(n(51)),h=n(55),d=p(n(157));function p(t){return t&&t.__esModule?t:{default:t}}var g=function(t){function e(){var t,n,r,a;(0,o.default)(this,e);for(var u=arguments.length,c=Array(u),l=0;l<u;l++)c[l]=arguments[l];return n=r=(0,s.default)(this,(t=e.__proto__||(0,i.default)(e)).call.apply(t,[this].concat(c))),r.curIndex=1,a=n,(0,s.default)(r,a)}return(0,u.default)(e,t),(0,a.default)(e,[{key:"_animate",value:function(){this.props.animate&&(this.animateTimeoutId=setTimeout(this._animate.bind(this),this.props.timeInterval),this.curIndex++,this.setState((function(t,e){return{redraw:!0}})))}},{key:"getCurData",value:function(){var t=this,e=!1,n=this.props.data.features.map((function(n){var r=d.default.cloneDeep(n),i=r.geometry.coordinates;if(t.props.loop){var o=t.curIndex%i.length;i=i.slice(0,0===o?i.length:o),r.geometry.coordinates=i}else t.curIndex<i.length&&(e=!0,i=i.slice(0,t.curIndex),r.geometry.coordinates=i);return r}));return!this.props.loop&&!e&&clearTimeout(this.animateTimeoutId),n}},{key:"getLayerGL",value:function(t,e){return new l.PathLayer({id:this.layerId,data:t.data&&t.data.features?t.animate?this.getCurData():t.data.features:[],redraw:t.redraw,extruded:!0,fp64:t.fp64,miterLimit:t.miterLimit,coordinateSystem:t.coordinateSystem,coordinateOrigin:t.coordinateOrigin,widthScale:t.widthScale,widthMinPixels:t.widthMinPixels,widthMaxPixels:t.widthMaxPixels,pickable:t.pickable,opacity:t.opacity,visible:t.visible,lineWidthMaxPixels:t.lineWidthMaxPixels,lineWidthMinPixels:t.lineWidthMinPixels,rounded:t.rounded,autoHighlight:t.autoHighlight,highlightColor:t.highlightColor,getDashArray:t.getDashArray,dashJustified:t.dashJustified,getColor:function(e){var n=t.setLineColor;if(n&&"function"==typeof n)return n(e);var r=null==t.getValue?e.properties[t.valueName||"value"]:t.getValue(e);return(0,h.getScale)(r||void 0,t.stroke)},getWidth:function(e){var n=t.setLineWidth;return n&&"function"==typeof n?n(e):t.strokeWidth},getPath:function(t){return t.geometry.coordinates},updateTriggers:{getColor:[t.setLineColor,t.stroke,t.valueName,t.stroke.range,t.stroke.domain],getWidth:t.strokeWidth,widthScale:t.widthScale,getDashArray:t.getDashArray,dashJustified:t.dashJustified}})}}]),e}(f.default);g.propTypes={strokeWidth:c.default.number.isRequired,setLineColor:c.default.func,lineWidthMinPixels:c.default.number,lineWidthMaxPixels:c.default.number,valueName:c.default.string,stroke:c.default.oneOfType([c.default.array,c.default.object]),getValue:c.default.func,rounded:c.default.bool,fp64:c.default.bool,widthScale:c.default.number,widthMinPixels:c.default.number,widthMaxPixels:c.default.number,miterLimit:c.default.number},g.defaultProps={lineWidthMinPixels:10,lineWidthMaxPixels:10,rounded:!1,visible:!0,opacity:1,pickable:!0,fp64:!1,widthScale:1,widthMinPixels:0,widthMaxPixels:r.default,miterLimit:4,autoHighlight:!1,highlightColor:[255,255,255,255],strokeWidth:10,dashJustified:!1,getDashArray:null,timeInterval:800,loop:!1,animate:!1,stroke:[255,255,255,255]},e.default=g},function(t,e,n){n(307),t.exports=9007199254740991},function(t,e,n){var r=n(60);r(r.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,n){n(310),t.exports=n(38).Object.getPrototypeOf},function(t,e,n){var r=n(81),i=n(193);n(194)("getPrototypeOf",(function(){return function(t){return i(r(t))}}))},function(t,e,n){t.exports={default:n(312),__esModule:!0}},function(t,e,n){n(313);var r=n(38).Object;t.exports=function(t,e,n){return r.defineProperty(t,e,n)}},function(t,e,n){var r=n(60);r(r.S+r.F*!n(64),"Object",{defineProperty:n(63).f})},function(t,e,n){t.exports={default:n(315),__esModule:!0}},function(t,e,n){n(111),n(152),t.exports=n(153).f("iterator")},function(t,e,n){var r=n(147),i=n(143);t.exports=function(t){return function(e,n){var o,a,s=String(i(e)),u=r(n),c=s.length;return u<0||u>=c?t?"":void 0:(o=s.charCodeAt(u))<55296||o>56319||u+1===c||(a=s.charCodeAt(u+1))<56320||a>57343?t?s.charAt(u):o:t?s.slice(u,u+2):a-56320+(o-55296<<10)+65536}}},function(t,e,n){"use strict";var r=n(148),i=n(89),o=n(151),a={};n(78)(a,n(52)("iterator"),(function(){return this})),t.exports=function(t,e,n){t.prototype=r(a,{next:i(1,n)}),o(t,e+" Iterator")}},function(t,e,n){var r=n(63),i=n(69),o=n(90);t.exports=n(64)?Object.defineProperties:function(t,e){i(t);for(var n,a=o(e),s=a.length,u=0;s>u;)r.f(t,n=a[u++],e[n]);return t}},function(t,e,n){var r=n(83),i=n(199),o=n(320);t.exports=function(t){return function(e,n,a){var s,u=r(e),c=i(u.length),l=o(a,c);if(t&&n!=n){for(;c>l;)if((s=u[l++])!=s)return!0}else for(;c>l;l++)if((t||l in u)&&u[l]===n)return t||l||0;return!t&&-1}}},function(t,e,n){var r=n(147),i=Math.max,o=Math.min;t.exports=function(t,e){return(t=r(t))<0?i(t+e,0):o(t,e)}},function(t,e,n){var r=n(62).document;t.exports=r&&r.documentElement},function(t,e,n){"use strict";var r=n(323),i=n(324),o=n(82),a=n(83);t.exports=n(195)(Array,"Array",(function(t,e){this._t=a(t),this._i=0,this._k=e}),(function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,i(1)):i(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])}),"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},function(t,e){t.exports=function(){}},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,n){t.exports={default:n(326),__esModule:!0}},function(t,e,n){n(327),n(332),n(333),n(334),t.exports=n(38).Symbol},function(t,e,n){"use strict";var r=n(62),i=n(70),o=n(64),a=n(60),s=n(196),u=n(328).KEY,c=n(80),l=n(145),f=n(151),h=n(110),d=n(52),p=n(153),g=n(154),v=n(329),y=n(330),m=n(69),b=n(79),_=n(81),x=n(83),w=n(142),E=n(89),S=n(148),O=n(331),P=n(201),C=n(155),M=n(63),I=n(90),A=P.f,T=M.f,N=O.f,L=r.Symbol,R=r.JSON,k=R&&R.stringify,j=d("_hidden"),F=d("toPrimitive"),D={}.propertyIsEnumerable,B=l("symbol-registry"),z=l("symbols"),V=l("op-symbols"),G=Object.prototype,U="function"==typeof L&&!!C.f,W=r.QObject,q=!W||!W.prototype||!W.prototype.findChild,X=o&&c((function(){return 7!=S(T({},"a",{get:function(){return T(this,"a",{value:7}).a}})).a}))?function(t,e,n){var r=A(G,e);r&&delete G[e],T(t,e,n),r&&t!==G&&T(G,e,r)}:T,H=function(t){var e=z[t]=S(L.prototype);return e._k=t,e},Y=U&&"symbol"==typeof L.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof L},Z=function(t,e,n){return t===G&&Z(V,e,n),m(t),e=w(e,!0),m(n),i(z,e)?(n.enumerable?(i(t,j)&&t[j][e]&&(t[j][e]=!1),n=S(n,{enumerable:E(0,!1)})):(i(t,j)||T(t,j,E(1,{})),t[j][e]=!0),X(t,e,n)):T(t,e,n)},K=function(t,e){m(t);for(var n,r=v(e=x(e)),i=0,o=r.length;o>i;)Z(t,n=r[i++],e[n]);return t},J=function(t){var e=D.call(this,t=w(t,!0));return!(this===G&&i(z,t)&&!i(V,t))&&(!(e||!i(this,t)||!i(z,t)||i(this,j)&&this[j][t])||e)},Q=function(t,e){if(t=x(t),e=w(e,!0),t!==G||!i(z,e)||i(V,e)){var n=A(t,e);return!n||!i(z,e)||i(t,j)&&t[j][e]||(n.enumerable=!0),n}},$=function(t){for(var e,n=N(x(t)),r=[],o=0;n.length>o;)i(z,e=n[o++])||e==j||e==u||r.push(e);return r},tt=function(t){for(var e,n=t===G,r=N(n?V:x(t)),o=[],a=0;r.length>a;)!i(z,e=r[a++])||n&&!i(G,e)||o.push(z[e]);return o};U||(s((L=function(){if(this instanceof L)throw TypeError("Symbol is not a constructor!");var t=h(arguments.length>0?arguments[0]:void 0),e=function(n){this===G&&e.call(V,n),i(this,j)&&i(this[j],t)&&(this[j][t]=!1),X(this,t,E(1,n))};return o&&q&&X(G,t,{configurable:!0,set:e}),H(t)}).prototype,"toString",(function(){return this._k})),P.f=Q,M.f=Z,n(200).f=O.f=$,n(112).f=J,C.f=tt,o&&!n(109)&&s(G,"propertyIsEnumerable",J,!0),p.f=function(t){return H(d(t))}),a(a.G+a.W+a.F*!U,{Symbol:L});for(var et="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),nt=0;et.length>nt;)d(et[nt++]);for(var rt=I(d.store),it=0;rt.length>it;)g(rt[it++]);a(a.S+a.F*!U,"Symbol",{for:function(t){return i(B,t+="")?B[t]:B[t]=L(t)},keyFor:function(t){if(!Y(t))throw TypeError(t+" is not a symbol!");for(var e in B)if(B[e]===t)return e},useSetter:function(){q=!0},useSimple:function(){q=!1}}),a(a.S+a.F*!U,"Object",{create:function(t,e){return void 0===e?S(t):K(S(t),e)},defineProperty:Z,defineProperties:K,getOwnPropertyDescriptor:Q,getOwnPropertyNames:$,getOwnPropertySymbols:tt});var ot=c((function(){C.f(1)}));a(a.S+a.F*ot,"Object",{getOwnPropertySymbols:function(t){return C.f(_(t))}}),R&&a(a.S+a.F*(!U||c((function(){var t=L();return"[null]"!=k([t])||"{}"!=k({a:t})||"{}"!=k(Object(t))}))),"JSON",{stringify:function(t){for(var e,n,r=[t],i=1;arguments.length>i;)r.push(arguments[i++]);if(n=e=r[1],(b(e)||void 0!==t)&&!Y(t))return y(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!Y(e))return e}),r[1]=e,k.apply(R,r)}}),L.prototype[F]||n(78)(L.prototype,F,L.prototype.valueOf),f(L,"Symbol"),f(Math,"Math",!0),f(r.JSON,"JSON",!0)},function(t,e,n){var r=n(110)("meta"),i=n(79),o=n(70),a=n(63).f,s=0,u=Object.isExtensible||function(){return!0},c=!n(80)((function(){return u(Object.preventExtensions({}))})),l=function(t){a(t,r,{value:{i:"O"+ ++s,w:{}}})},f=t.exports={KEY:r,NEED:!1,fastKey:function(t,e){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,r)){if(!u(t))return"F";if(!e)return"E";l(t)}return t[r].i},getWeak:function(t,e){if(!o(t,r)){if(!u(t))return!0;if(!e)return!1;l(t)}return t[r].w},onFreeze:function(t){return c&&f.NEED&&u(t)&&!o(t,r)&&l(t),t}}},function(t,e,n){var r=n(90),i=n(155),o=n(112);t.exports=function(t){var e=r(t),n=i.f;if(n)for(var a,s=n(t),u=o.f,c=0;s.length>c;)u.call(t,a=s[c++])&&e.push(a);return e}},function(t,e,n){var r=n(149);t.exports=Array.isArray||function(t){return"Array"==r(t)}},function(t,e,n){var r=n(83),i=n(200).f,o={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return a&&"[object Window]"==o.call(t)?function(t){try{return i(t)}catch(t){return a.slice()}}(t):i(r(t))}},function(t,e){},function(t,e,n){n(154)("asyncIterator")},function(t,e,n){n(154)("observable")},function(t,e,n){t.exports={default:n(336),__esModule:!0}},function(t,e,n){n(337),t.exports=n(38).Object.setPrototypeOf},function(t,e,n){var r=n(60);r(r.S,"Object",{setPrototypeOf:n(338).set})},function(t,e,n){var r=n(79),i=n(69),o=function(t,e){if(i(t),!r(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,r){try{(r=n(141)(Function.call,n(201).f(Object.prototype,"__proto__").set,2))(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,n){return o(t,n),e?t.__proto__=n:r(t,n),t}}({},!1):void 0),check:o}},function(t,e,n){t.exports={default:n(340),__esModule:!0}},function(t,e,n){n(341);var r=n(38).Object;t.exports=function(t,e){return r.create(t,e)}},function(t,e,n){var r=n(60);r(r.S,"Object",{create:n(148)})},function(t,e,n){"use strict";var r=n(343);function i(){}function o(){}o.resetWarningCache=i,t.exports=function(){function t(t,e,n,i,o,a){if(a!==r){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function e(){return t}t.isRequired=t;var n={array:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:o,resetWarningCache:i};return n.PropTypes=n,n}},function(t,e,n){"use strict";t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(t,e){},function(t,e){},function(t,e){},function(t,e,n){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;function a(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(t){r[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var n,s,u=a(t),c=1;c<arguments.length;c++){for(var l in n=Object(arguments[c]))i.call(n,l)&&(u[l]=n[l]);if(r){s=r(n);for(var f=0;f<s.length;f++)o.call(n,s[f])&&(u[s[f]]=n[s[f]])}}return u}},function(t,e,n){(function(t){var r=Object.getOwnPropertyDescriptors||function(t){for(var e=Object.keys(t),n={},r=0;r<e.length;r++)n[e[r]]=Object.getOwnPropertyDescriptor(t,e[r]);return n},i=/%[sdj%]/g;e.format=function(t){if(!y(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(s(arguments[n]));return e.join(" ")}n=1;for(var r=arguments,o=r.length,a=String(t).replace(i,(function(t){if("%%"===t)return"%";if(n>=o)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return t}})),u=r[n];n<o;u=r[++n])g(u)||!_(u)?a+=" "+u:a+=" "+s(u);return a},e.deprecate=function(n,r){if(void 0!==t&&!0===t.noDeprecation)return n;if(void 0===t)return function(){return e.deprecate(n,r).apply(this,arguments)};var i=!1;return function(){if(!i){if(t.throwDeprecation)throw new Error(r);t.traceDeprecation?console.trace(r):console.error(r),i=!0}return n.apply(this,arguments)}};var o,a={};function s(t,n){var r={seen:[],stylize:c};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),p(n)?r.showHidden=n:n&&e._extend(r,n),m(r.showHidden)&&(r.showHidden=!1),m(r.depth)&&(r.depth=2),m(r.colors)&&(r.colors=!1),m(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=u),l(r,t,r.depth)}function u(t,e){var n=s.styles[e];return n?"["+s.colors[n][0]+"m"+t+"["+s.colors[n][1]+"m":t}function c(t,e){return t}function l(t,n,r){if(t.customInspect&&n&&E(n.inspect)&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,t);return y(i)||(i=l(t,i,r)),i}var o=function(t,e){if(m(e))return t.stylize("undefined","undefined");if(y(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}if(v(e))return t.stylize(""+e,"number");if(p(e))return t.stylize(""+e,"boolean");if(g(e))return t.stylize("null","null")}(t,n);if(o)return o;var a=Object.keys(n),s=function(t){var e={};return t.forEach((function(t,n){e[t]=!0})),e}(a);if(t.showHidden&&(a=Object.getOwnPropertyNames(n)),w(n)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return f(n);if(0===a.length){if(E(n)){var u=n.name?": "+n.name:"";return t.stylize("[Function"+u+"]","special")}if(b(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(x(n))return t.stylize(Date.prototype.toString.call(n),"date");if(w(n))return f(n)}var c,_="",S=!1,O=["{","}"];(d(n)&&(S=!0,O=["[","]"]),E(n))&&(_=" [Function"+(n.name?": "+n.name:"")+"]");return b(n)&&(_=" "+RegExp.prototype.toString.call(n)),x(n)&&(_=" "+Date.prototype.toUTCString.call(n)),w(n)&&(_=" "+f(n)),0!==a.length||S&&0!=n.length?r<0?b(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special"):(t.seen.push(n),c=S?function(t,e,n,r,i){for(var o=[],a=0,s=e.length;a<s;++a)M(e,String(a))?o.push(h(t,e,n,r,String(a),!0)):o.push("");return i.forEach((function(i){i.match(/^\d+$/)||o.push(h(t,e,n,r,i,!0))})),o}(t,n,r,s,a):a.map((function(e){return h(t,n,r,s,e,S)})),t.seen.pop(),function(t,e,n){if(t.reduce((function(t,e){return e.indexOf("\n")>=0&&0,t+e.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1];return n[0]+e+" "+t.join(", ")+" "+n[1]}(c,_,O)):O[0]+_+O[1]}function f(t){return"["+Error.prototype.toString.call(t)+"]"}function h(t,e,n,r,i,o){var a,s,u;if((u=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]}).get?s=u.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):u.set&&(s=t.stylize("[Setter]","special")),M(r,i)||(a="["+i+"]"),s||(t.seen.indexOf(u.value)<0?(s=g(n)?l(t,u.value,null):l(t,u.value,n-1)).indexOf("\n")>-1&&(s=o?s.split("\n").map((function(t){return"  "+t})).join("\n").substr(2):"\n"+s.split("\n").map((function(t){return"   "+t})).join("\n")):s=t.stylize("[Circular]","special")),m(a)){if(o&&i.match(/^\d+$/))return s;(a=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=t.stylize(a,"string"))}return a+": "+s}function d(t){return Array.isArray(t)}function p(t){return"boolean"==typeof t}function g(t){return null===t}function v(t){return"number"==typeof t}function y(t){return"string"==typeof t}function m(t){return void 0===t}function b(t){return _(t)&&"[object RegExp]"===S(t)}function _(t){return"object"==typeof t&&null!==t}function x(t){return _(t)&&"[object Date]"===S(t)}function w(t){return _(t)&&("[object Error]"===S(t)||t instanceof Error)}function E(t){return"function"==typeof t}function S(t){return Object.prototype.toString.call(t)}function O(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(n){if(m(o)&&(o=Object({NODE_ENV:"production"}).NODE_DEBUG||""),n=n.toUpperCase(),!a[n])if(new RegExp("\\b"+n+"\\b","i").test(o)){var r=t.pid;a[n]=function(){var t=e.format.apply(e,arguments);console.error("%s %d: %s",n,r,t)}}else a[n]=function(){};return a[n]},e.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=d,e.isBoolean=p,e.isNull=g,e.isNullOrUndefined=function(t){return null==t},e.isNumber=v,e.isString=y,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=m,e.isRegExp=b,e.isObject=_,e.isDate=x,e.isError=w,e.isFunction=E,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=n(349);var P=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function C(){var t=new Date,e=[O(t.getHours()),O(t.getMinutes()),O(t.getSeconds())].join(":");return[t.getDate(),P[t.getMonth()],e].join(" ")}function M(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){console.log("%s - %s",C(),e.format.apply(e,arguments))},e.inherits=n(350),e._extend=function(t,e){if(!e||!_(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t};var I="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function A(t,e){if(!t){var n=new Error("Promise was rejected with a falsy value");n.reason=t,t=n}return e(t)}e.promisify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');if(I&&t[I]){var e;if("function"!=typeof(e=t[I]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(e,I,{value:e,enumerable:!1,writable:!1,configurable:!0}),e}function e(){for(var e,n,r=new Promise((function(t,r){e=t,n=r})),i=[],o=0;o<arguments.length;o++)i.push(arguments[o]);i.push((function(t,r){t?n(t):e(r)}));try{t.apply(this,i)}catch(t){n(t)}return r}return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),I&&Object.defineProperty(e,I,{value:e,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(e,r(t))},e.promisify.custom=I,e.callbackify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');function n(){for(var n=[],r=0;r<arguments.length;r++)n.push(arguments[r]);var i=n.pop();if("function"!=typeof i)throw new TypeError("The last argument must be of type Function");var o=this,a=function(){return i.apply(o,arguments)};e.apply(this,n).then((function(e){t.nextTick(a,null,e)}),(function(e){t.nextTick(A,e,a)}))}return Object.setPrototypeOf(n,Object.getPrototypeOf(e)),Object.defineProperties(n,r(e)),n}}).call(this,n(61))},function(t,e){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},function(t,e,n){t.exports=n(352)},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){(0,r.installParameterDefinitions)(),console.log("luma.gl: WebGL debug support installed")};var r=n(353),i=n(356);(void 0!==t?t:window).WebGLDebug=i,console.log("luma.gl: WebGL debug support imported")}).call(this,n(50))},function(t,e,n){"use strict";var r=n(354);Object.defineProperty(e,"__esModule",{value:!0}),e.installParameterDefinitions=function(){},e.TEXTURE_PARAMETERS=e.SAMPLER_PARAMETERS=e.RENDERBUFFER_PARAMETERS=e.PROGRAM_PARAMETERS=e.FRAMEBUFFER_STATUS=e.FRAMEBUFFER_ATTACHMENT_PARAMETERS=e.FENCE_SYNC_PARAMETERS=e.BUFFER_PARAMETERS=e.GLboolean=e.GLuint=e.GLint=e.GLfloat=e.GLenum=void 0;var i,o,a,s,u,c,l=r(n(355));e.GLenum="GLenum";e.GLfloat="GLfloat";e.GLint="GLint";e.GLuint="GLint";e.GLboolean="GLboolean";var f=(i={},(0,l.default)(i,34660,{webgl1:0}),(0,l.default)(i,34661,{webgl1:0}),i);e.BUFFER_PARAMETERS=f;e.FENCE_SYNC_PARAMETERS=[37138,37140,37139,37141];e.FRAMEBUFFER_ATTACHMENT_PARAMETERS=[36049,36048,36051,36050,33296,36052,33298,33299,33300,33301,33302,33303,33297];var h=(o={},(0,l.default)(o,36053,"Success. Framebuffer is correctly set up"),(0,l.default)(o,36054,"Framebuffer attachment types mismatched or some attachment point not attachment complete"),(0,l.default)(o,36055,"Framebuffer has no attachment"),(0,l.default)(o,36057,"Framebuffer attachments do not have the same size"),(0,l.default)(o,36061,"Framebuffer attachment format not supported or depth and stencil attachments are not same"),(0,l.default)(o,36182,"Framebuffer attachement SAMPLES differs among renderbuffers, or are mixed with textures"),o);e.FRAMEBUFFER_STATUS=h;var d=(a={},(0,l.default)(a,35712,{webgl1:0}),(0,l.default)(a,35714,{webgl1:0}),(0,l.default)(a,35715,{webgl1:0}),(0,l.default)(a,35717,{webgl1:0}),(0,l.default)(a,35721,{webgl1:0}),(0,l.default)(a,35718,{webgl1:0}),(0,l.default)(a,35967,{webgl2:0}),(0,l.default)(a,35971,{webgl2:0}),(0,l.default)(a,35382,{webgl2:0}),a);e.PROGRAM_PARAMETERS=d;var p=(s={},(0,l.default)(s,36162,{webgl1:0}),(0,l.default)(s,36163,{webgl1:0}),(0,l.default)(s,36164,{type:"GLenum",webgl1:32854}),(0,l.default)(s,36177,{webgl1:0}),(0,l.default)(s,36178,{webgl1:0}),(0,l.default)(s,36176,{webgl1:0}),(0,l.default)(s,36179,{webgl1:0}),(0,l.default)(s,36180,{webgl1:0}),(0,l.default)(s,36181,{webgl1:0}),(0,l.default)(s,36011,{webgl2:1}),s);e.RENDERBUFFER_PARAMETERS=p;var g=(u={},(0,l.default)(u,10240,{webgl2:!0}),(0,l.default)(u,10241,{webgl2:!0}),(0,l.default)(u,10242,{webgl2:!0}),(0,l.default)(u,10243,{webgl2:!0}),(0,l.default)(u,32882,{webgl2:!0}),(0,l.default)(u,33084,{webgl2:!0}),(0,l.default)(u,33085,{webgl2:!0}),(0,l.default)(u,34893,{webgl2:!0}),(0,l.default)(u,34892,{webgl2:!0}),(0,l.default)(u,33082,{webgl2:!0}),(0,l.default)(u,33083,{webgl2:!0}),u);e.SAMPLER_PARAMETERS=g;var v=(c={},(0,l.default)(c,10240,{type:"GLenum",webgl1:9729}),(0,l.default)(c,10241,{type:"GLenum",webgl1:9986}),(0,l.default)(c,10242,{type:"GLenum",webgl1:10497}),(0,l.default)(c,10243,{type:"GLenum",webgl1:10497}),(0,l.default)(c,32882,{type:"GLenum",webgl2:10497}),(0,l.default)(c,33084,{webgl2:0}),(0,l.default)(c,33085,{webgl2:1e3}),(0,l.default)(c,34893,{type:"GLenum",webgl2:515}),(0,l.default)(c,34892,{type:"GLenum",webgl2:0}),(0,l.default)(c,33082,{webgl2:-1e3}),(0,l.default)(c,33083,{webgl2:1e3}),(0,l.default)(c,4096,{webgl1:0}),(0,l.default)(c,4097,{webgl1:0}),c);e.TEXTURE_PARAMETERS=v},function(t,e){t.exports=function(t){return t&&t.__esModule?t:{default:t}}},function(t,e){t.exports=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}},function(t,e,n){(function(e){WebGLDebugUtils=function(){var t;void 0===t&&(t=e);var n=function(e){t.console&&t.console.error?t.console.error(e):function(e){t.console&&t.console.log&&t.console.log(e)}(e)},r={enable:{1:{0:!0}},disable:{1:{0:!0}},getParameter:{1:{0:!0}},drawArrays:{3:{0:!0}},drawElements:{4:{0:!0,2:!0}},createShader:{1:{0:!0}},getShaderParameter:{2:{1:!0}},getProgramParameter:{2:{1:!0}},getShaderPrecisionFormat:{2:{0:!0,1:!0}},getVertexAttrib:{2:{1:!0}},vertexAttribPointer:{6:{2:!0}},bindTexture:{2:{0:!0}},activeTexture:{1:{0:!0}},getTexParameter:{2:{0:!0,1:!0}},texParameterf:{3:{0:!0,1:!0}},texParameteri:{3:{0:!0,1:!0,2:!0}},copyTexImage2D:{8:{0:!0,2:!0}},copyTexSubImage2D:{8:{0:!0}},generateMipmap:{1:{0:!0}},bindBuffer:{2:{0:!0}},getBufferParameter:{2:{0:!0,1:!0}},pixelStorei:{2:{0:!0,1:!0}},bindRenderbuffer:{2:{0:!0}},bindFramebuffer:{2:{0:!0}},checkFramebufferStatus:{1:{0:!0}},framebufferRenderbuffer:{4:{0:!0,1:!0,2:!0}},framebufferTexture2D:{5:{0:!0,1:!0,2:!0}},getFramebufferAttachmentParameter:{3:{0:!0,1:!0,2:!0}},getRenderbufferParameter:{2:{0:!0,1:!0}},renderbufferStorage:{4:{0:!0,1:!0}},clear:{1:{0:{enumBitwiseOr:["COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT"]}}},depthFunc:{1:{0:!0}},blendFunc:{2:{0:!0,1:!0}},blendFuncSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},blendEquation:{1:{0:!0}},blendEquationSeparate:{2:{0:!0,1:!0}},stencilFunc:{3:{0:!0}},stencilFuncSeparate:{4:{0:!0,1:!0}},stencilMaskSeparate:{2:{0:!0}},stencilOp:{3:{0:!0,1:!0,2:!0}},stencilOpSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},cullFace:{1:{0:!0}},frontFace:{1:{0:!0}},drawArraysInstancedANGLE:{4:{0:!0}},drawElementsInstancedANGLE:{5:{0:!0,2:!0}},blendEquationEXT:{1:{0:!0}},bufferData:{3:{0:!0,2:!0},4:{0:!0,2:!0},5:{0:!0,2:!0}},bufferSubData:{3:{0:!0},4:{0:!0},5:{0:!0}},copyBufferSubData:{5:{0:!0,1:!0}},getBufferSubData:{3:{0:!0},4:{0:!0},5:{0:!0}},blitFramebuffer:{10:{8:{enumBitwiseOr:["COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT"]},9:!0}},framebufferTextureLayer:{5:{0:!0,1:!0}},invalidateFramebuffer:{2:{0:!0}},invalidateSubFramebuffer:{6:{0:!0}},readBuffer:{1:{0:!0}},getInternalformatParameter:{3:{0:!0,1:!0,2:!0}},renderbufferStorageMultisample:{5:{0:!0,2:!0}},texStorage2D:{5:{0:!0,2:!0}},texStorage3D:{6:{0:!0,2:!0}},texImage2D:{9:{0:!0,2:!0,6:!0,7:!0},6:{0:!0,2:!0,3:!0,4:!0},10:{0:!0,2:!0,6:!0,7:!0}},texImage3D:{10:{0:!0,2:!0,7:!0,8:!0},11:{0:!0,2:!0,7:!0,8:!0}},texSubImage2D:{9:{0:!0,6:!0,7:!0},7:{0:!0,4:!0,5:!0},10:{0:!0,6:!0,7:!0}},texSubImage3D:{11:{0:!0,8:!0,9:!0},12:{0:!0,8:!0,9:!0}},copyTexSubImage3D:{9:{0:!0}},compressedTexImage2D:{7:{0:!0,2:!0},8:{0:!0,2:!0},9:{0:!0,2:!0}},compressedTexImage3D:{8:{0:!0,2:!0},9:{0:!0,2:!0},10:{0:!0,2:!0}},compressedTexSubImage2D:{8:{0:!0,6:!0},9:{0:!0,6:!0},10:{0:!0,6:!0}},compressedTexSubImage3D:{10:{0:!0,8:!0},11:{0:!0,8:!0},12:{0:!0,8:!0}},vertexAttribIPointer:{5:{2:!0}},drawArraysInstanced:{4:{0:!0}},drawElementsInstanced:{5:{0:!0,2:!0}},drawRangeElements:{6:{0:!0,4:!0}},readPixels:{7:{4:!0,5:!0},8:{4:!0,5:!0}},clearBufferfv:{3:{0:!0},4:{0:!0}},clearBufferiv:{3:{0:!0},4:{0:!0}},clearBufferuiv:{3:{0:!0},4:{0:!0}},clearBufferfi:{4:{0:!0}},beginQuery:{2:{0:!0}},endQuery:{1:{0:!0}},getQuery:{2:{0:!0,1:!0}},getQueryParameter:{2:{1:!0}},samplerParameteri:{3:{1:!0,2:!0}},samplerParameterf:{3:{1:!0}},getSamplerParameter:{2:{1:!0}},fenceSync:{2:{0:!0,1:{enumBitwiseOr:[]}}},clientWaitSync:{3:{1:{enumBitwiseOr:["SYNC_FLUSH_COMMANDS_BIT"]}}},waitSync:{3:{1:{enumBitwiseOr:[]}}},getSyncParameter:{2:{1:!0}},bindTransformFeedback:{2:{0:!0}},beginTransformFeedback:{1:{0:!0}},transformFeedbackVaryings:{3:{2:!0}},bindBufferBase:{3:{0:!0}},bindBufferRange:{5:{0:!0}},getIndexedParameter:{2:{0:!0}},getActiveUniforms:{3:{2:!0}},getActiveUniformBlockParameter:{3:{2:!0}}},i=null,o=null;function a(t){if(null==i)for(var e in i={},o={},t)"number"==typeof t[e]&&(i[t[e]]=e,o[e]=t[e])}function s(){if(null==i)throw"WebGLDebugUtils.init(ctx) not called"}function u(t){s();var e=i[t];return void 0!==e?"gl."+e:"/*UNKNOWN WebGL ENUM*/ 0x"+t.toString(16)}function c(t,e,n,i){var a;if(void 0!==(a=r[t])&&(void 0!==(a=a[e])&&a[n])){if("object"==typeof a[n]&&void 0!==a[n].enumBitwiseOr){for(var s=a[n].enumBitwiseOr,c=0,l=[],f=0;f<s.length;++f){var h=o[s[f]];0!=(i&h)&&(c|=h,l.push(u(h)))}return c===i?l.join(" | "):u(i)}return u(i)}return null===i?"null":void 0===i?"undefined":i.toString()}function l(t,e,n){t.__defineGetter__(n,(function(){return e[n]})),t.__defineSetter__(n,(function(t){e[n]=t}))}function f(t){var e=!!t.createTransformFeedback;e&&t.bindVertexArray(null);var n=t.getParameter(t.MAX_VERTEX_ATTRIBS),r=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,r);for(var i=0;i<n;++i)t.disableVertexAttribArray(i),t.vertexAttribPointer(i,4,t.FLOAT,!1,0,0),t.vertexAttrib1f(i,0),e&&t.vertexAttribDivisor(i,0);t.deleteBuffer(r);var o=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);for(i=0;i<o;++i)t.activeTexture(t.TEXTURE0+i),t.bindTexture(t.TEXTURE_CUBE_MAP,null),t.bindTexture(t.TEXTURE_2D,null),e&&(t.bindTexture(t.TEXTURE_2D_ARRAY,null),t.bindTexture(t.TEXTURE_3D,null),t.bindSampler(i,null));if(t.activeTexture(t.TEXTURE0),t.useProgram(null),t.bindBuffer(t.ARRAY_BUFFER,null),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindRenderbuffer(t.RENDERBUFFER,null),t.disable(t.BLEND),t.disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),t.disable(t.DITHER),t.disable(t.SCISSOR_TEST),t.blendColor(0,0,0,0),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ZERO),t.clearColor(0,0,0,0),t.clearDepth(1),t.clearStencil(-1),t.colorMask(!0,!0,!0,!0),t.cullFace(t.BACK),t.depthFunc(t.LESS),t.depthMask(!0),t.depthRange(0,1),t.frontFace(t.CCW),t.hint(t.GENERATE_MIPMAP_HINT,t.DONT_CARE),t.lineWidth(1),t.pixelStorei(t.PACK_ALIGNMENT,4),t.pixelStorei(t.UNPACK_ALIGNMENT,4),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!1),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),t.UNPACK_COLORSPACE_CONVERSION_WEBGL&&t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.BROWSER_DEFAULT_WEBGL),t.polygonOffset(0,0),t.sampleCoverage(1,!1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.stencilFunc(t.ALWAYS,0,4294967295),t.stencilMask(4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.viewport(0,0,t.canvas.width,t.canvas.height),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT|t.STENCIL_BUFFER_BIT),e){t.drawBuffers([t.BACK]),t.readBuffer(t.BACK),t.bindBuffer(t.COPY_READ_BUFFER,null),t.bindBuffer(t.COPY_WRITE_BUFFER,null),t.bindBuffer(t.PIXEL_PACK_BUFFER,null),t.bindBuffer(t.PIXEL_UNPACK_BUFFER,null);var a=t.getParameter(t.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS);for(i=0;i<a;++i)t.bindBufferBase(t.TRANSFORM_FEEDBACK_BUFFER,i,null);var s=t.getParameter(t.MAX_UNIFORM_BUFFER_BINDINGS);for(i=0;i<s;++i)t.bindBufferBase(t.UNIFORM_BUFFER,i,null);t.disable(t.RASTERIZER_DISCARD),t.pixelStorei(t.UNPACK_IMAGE_HEIGHT,0),t.pixelStorei(t.UNPACK_SKIP_IMAGES,0),t.pixelStorei(t.UNPACK_ROW_LENGTH,0),t.pixelStorei(t.UNPACK_SKIP_ROWS,0),t.pixelStorei(t.UNPACK_SKIP_PIXELS,0),t.pixelStorei(t.PACK_ROW_LENGTH,0),t.pixelStorei(t.PACK_SKIP_ROWS,0),t.pixelStorei(t.PACK_SKIP_PIXELS,0),t.hint(t.FRAGMENT_SHADER_DERIVATIVE_HINT,t.DONT_CARE)}for(;t.getError(););}return{init:a,mightBeEnum:function(t){return s(),void 0!==i[t]},glEnumToString:u,glFunctionArgToString:c,glFunctionArgsToString:function(t,e){for(var n="",r=e.length,i=0;i<r;++i)n+=(0==i?"":", ")+c(t,r,i,e[i]);return n},makeDebugContext:function t(e,r,i,o){o=o||e,a(e),r=r||function(t,e,r){for(var i="",o=r.length,a=0;a<o;++a)i+=(0==a?"":", ")+c(e,o,a,r[a]);n("WebGL error "+u(t)+" in "+e+"("+i+")")};var s={};function f(t,e){return function(){i&&i(e,arguments);var n=t[e].apply(t,arguments),a=o.getError();return 0!=a&&(s[a]=!0,r(a,e,arguments)),n}}var h={};for(var d in e)if("function"==typeof e[d])if("getExtension"!=d)h[d]=f(e,d);else{var p=f(e,d);h[d]=function(){var n=p.apply(e,arguments);return n?t(n,r,i,o):null}}else l(h,e,d);return h.getError=function(){for(var t in s)if(s.hasOwnProperty(t)&&s[t])return s[t]=!1,t;return e.NO_ERROR},h},makeLostContextSimulatingCanvas:function(e){var n,r,i,o=[],a=[],s={},u=1,c=!1,h=[],d=0,p=0,g=!1,v=0,y={};function m(t){return"function"==typeof t?t:function(e){t.handleEvent(e)}}e.getContext=(i=e.getContext,function(){var o=i.apply(e,arguments);if(o instanceof WebGLRenderingContext||t.WebGL2RenderingContext&&o instanceof WebGL2RenderingContext){if(o!=n){if(n)throw"got different context";r=t.WebGL2RenderingContext&&o instanceof WebGL2RenderingContext,s=S(n=o)}return s}return o});var b=function(t){o.push(m(t))},_=function(t){a.push(m(t))};function x(){++p,c||d==p&&e.loseContext()}function w(t,e){var n=t[e];return function(){if(x(),!c){var e=n.apply(t,arguments);return e}}}function E(t){return{statusMessage:t,preventDefault:function(){g=!0}}}return function(t){var e=t.addEventListener;t.addEventListener=function(n,r,i){switch(n){case"webglcontextlost":b(r);break;case"webglcontextrestored":_(r);break;default:e.apply(t,arguments)}}}(e),e.loseContext=function(){if(!c){for(c=!0,d=0,++u;n.getError(););!function(){for(var t=Object.keys(y),e=0;e<t.length;++e)delete y[t[e]]}(),y[n.CONTEXT_LOST_WEBGL]=!0;var t=E("context lost"),r=o.slice();setTimeout((function(){for(var n=0;n<r.length;++n)r[n](t);v>=0&&setTimeout((function(){e.restoreContext()}),v)}),0)}},e.restoreContext=function(){c&&a.length&&setTimeout((function(){if(!g)throw"can not restore. webglcontestlost listener did not call event.preventDefault";!function(){for(var t=0;t<h.length;++t){var e=h[t];e instanceof WebGLBuffer?n.deleteBuffer(e):e instanceof WebGLFramebuffer?n.deleteFramebuffer(e):e instanceof WebGLProgram?n.deleteProgram(e):e instanceof WebGLRenderbuffer?n.deleteRenderbuffer(e):e instanceof WebGLShader?n.deleteShader(e):e instanceof WebGLTexture?n.deleteTexture(e):r&&(e instanceof WebGLQuery?n.deleteQuery(e):e instanceof WebGLSampler?n.deleteSampler(e):e instanceof WebGLSync?n.deleteSync(e):e instanceof WebGLTransformFeedback?n.deleteTransformFeedback(e):e instanceof WebGLVertexArrayObject&&n.deleteVertexArray(e))}}(),f(n),c=!1,p=0,g=!1;for(var t=a.slice(),e=E("context restored"),i=0;i<t.length;++i)t[i](e)}),0)},e.loseContextInNCalls=function(t){if(c)throw"You can not ask a lost contet to be lost";d=p+t},e.getNumCalls=function(){return p},e.setRestoreTimeout=function(t){v=t},e;function S(t){for(var e in t)"function"==typeof t[e]?s[e]=w(t,e):l(s,t,e);s.getError=function(){if(x(),!c)for(;t=n.getError();)y[t]=!0;for(var t in y)if(y[t])return delete y[t],t;return s.NO_ERROR};var i=["createBuffer","createFramebuffer","createProgram","createRenderbuffer","createShader","createTexture"];r&&i.push("createQuery","createSampler","fenceSync","createTransformFeedback","createVertexArray");for(var o=0;o<i.length;++o){var a=i[o];s[a]=function(e){return function(){if(x(),c)return null;var n=e.apply(t,arguments);return n.__webglDebugContextLostId__=u,h.push(n),n}}(t[a])}var f=["getActiveAttrib","getActiveUniform","getBufferParameter","getContextAttributes","getAttachedShaders","getFramebufferAttachmentParameter","getParameter","getProgramParameter","getProgramInfoLog","getRenderbufferParameter","getShaderParameter","getShaderInfoLog","getShaderSource","getTexParameter","getUniform","getUniformLocation","getVertexAttrib"];r&&f.push("getInternalformatParameter","getQuery","getQueryParameter","getSamplerParameter","getSyncParameter","getTransformFeedbackVarying","getIndexedParameter","getUniformIndices","getActiveUniforms","getActiveUniformBlockParameter","getActiveUniformBlockName");for(o=0;o<f.length;++o){a=f[o];s[a]=function(e){return function(){return x(),c?null:e.apply(t,arguments)}}(s[a])}var d=["isBuffer","isEnabled","isFramebuffer","isProgram","isRenderbuffer","isShader","isTexture"];r&&d.push("isQuery","isSampler","isSync","isTransformFeedback","isVertexArray");for(o=0;o<d.length;++o){a=d[o];s[a]=function(e){return function(){return x(),!c&&e.apply(t,arguments)}}(s[a])}return s.checkFramebufferStatus=function(e){return function(){return x(),c?s.FRAMEBUFFER_UNSUPPORTED:e.apply(t,arguments)}}(s.checkFramebufferStatus),s.getAttribLocation=function(e){return function(){return x(),c?-1:e.apply(t,arguments)}}(s.getAttribLocation),s.getVertexAttribOffset=function(e){return function(){return x(),c?0:e.apply(t,arguments)}}(s.getVertexAttribOffset),s.isContextLost=function(){return c},r&&(s.getFragDataLocation=function(e){return function(){return x(),c?-1:e.apply(t,arguments)}}(s.getFragDataLocation),s.clientWaitSync=function(e){return function(){return x(),c?s.WAIT_FAILED:e.apply(t,arguments)}}(s.clientWaitSync),s.getUniformBlockIndex=function(e){return function(){return x(),c?s.INVALID_INDEX:e.apply(t,arguments)}}(s.getUniformBlockIndex)),s}},resetToInitialState:f}}(),t.exports=WebGLDebugUtils}).call(this,n(50))},function(t,e,n){"use strict";t.exports={DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,FUNC_ADD:32774,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,BLEND_COLOR:32773,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,VENDOR:7936,RENDERER:7937,VERSION:7938,IMPLEMENTATION_COLOR_READ_TYPE:35738,IMPLEMENTATION_COLOR_READ_FORMAT:35739,BROWSER_DEFAULT_WEBGL:37444,STATIC_DRAW:35044,STREAM_DRAW:35040,DYNAMIC_DRAW:35048,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,CULL_FACE:2884,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,BLEND:3042,DEPTH_TEST:2929,DITHER:3024,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,SCISSOR_TEST:3089,STENCIL_TEST:2960,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CONTEXT_LOST_WEBGL:37442,CW:2304,CCW:2305,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,COMPILE_STATUS:35713,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_ATTRIBUTES:35721,ACTIVE_UNIFORMS:35718,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,ALWAYS:519,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,GEQUAL:518,NOTEQUAL:517,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,TEXTURE_WIDTH:4096,TEXTURE_HEIGHT:4097,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,READ_FRAMEBUFFER:36008,DRAW_FRAMEBUFFER:36009,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,READ_BUFFER:3074,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_ROWS:3315,UNPACK_SKIP_PIXELS:3316,PACK_ROW_LENGTH:3330,PACK_SKIP_ROWS:3331,PACK_SKIP_PIXELS:3332,TEXTURE_BINDING_3D:32874,UNPACK_SKIP_IMAGES:32877,UNPACK_IMAGE_HEIGHT:32878,MAX_3D_TEXTURE_SIZE:32883,MAX_ELEMENTS_VERTICES:33e3,MAX_ELEMENTS_INDICES:33001,MAX_TEXTURE_LOD_BIAS:34045,MAX_FRAGMENT_UNIFORM_COMPONENTS:35657,MAX_VERTEX_UNIFORM_COMPONENTS:35658,MAX_ARRAY_TEXTURE_LAYERS:35071,MIN_PROGRAM_TEXEL_OFFSET:35076,MAX_PROGRAM_TEXEL_OFFSET:35077,MAX_VARYING_COMPONENTS:35659,FRAGMENT_SHADER_DERIVATIVE_HINT:35723,RASTERIZER_DISCARD:35977,VERTEX_ARRAY_BINDING:34229,MAX_VERTEX_OUTPUT_COMPONENTS:37154,MAX_FRAGMENT_INPUT_COMPONENTS:37157,MAX_SERVER_WAIT_TIMEOUT:37137,MAX_ELEMENT_INDEX:36203,RED:6403,RGB8:32849,RGBA8:32856,RGB10_A2:32857,TEXTURE_3D:32879,TEXTURE_WRAP_R:32882,TEXTURE_MIN_LOD:33082,TEXTURE_MAX_LOD:33083,TEXTURE_BASE_LEVEL:33084,TEXTURE_MAX_LEVEL:33085,TEXTURE_COMPARE_MODE:34892,TEXTURE_COMPARE_FUNC:34893,SRGB:35904,SRGB8:35905,SRGB8_ALPHA8:35907,COMPARE_REF_TO_TEXTURE:34894,RGBA32F:34836,RGB32F:34837,RGBA16F:34842,RGB16F:34843,TEXTURE_2D_ARRAY:35866,TEXTURE_BINDING_2D_ARRAY:35869,R11F_G11F_B10F:35898,RGB9_E5:35901,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,RED_INTEGER:36244,RGB_INTEGER:36248,RGBA_INTEGER:36249,R8:33321,RG8:33323,R16F:33325,R32F:33326,RG16F:33327,RG32F:33328,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,RGB10_A2UI:36975,TEXTURE_IMMUTABLE_FORMAT:37167,TEXTURE_IMMUTABLE_LEVELS:33503,UNSIGNED_INT_2_10_10_10_REV:33640,UNSIGNED_INT_10F_11F_11F_REV:35899,UNSIGNED_INT_5_9_9_9_REV:35902,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,UNSIGNED_INT_24_8:34042,HALF_FLOAT:5131,RG:33319,RG_INTEGER:33320,INT_2_10_10_10_REV:36255,CURRENT_QUERY:34917,QUERY_RESULT:34918,QUERY_RESULT_AVAILABLE:34919,ANY_SAMPLES_PASSED:35887,ANY_SAMPLES_PASSED_CONSERVATIVE:36202,MAX_DRAW_BUFFERS:34852,DRAW_BUFFER0:34853,DRAW_BUFFER1:34854,DRAW_BUFFER2:34855,DRAW_BUFFER3:34856,DRAW_BUFFER4:34857,DRAW_BUFFER5:34858,DRAW_BUFFER6:34859,DRAW_BUFFER7:34860,DRAW_BUFFER8:34861,DRAW_BUFFER9:34862,DRAW_BUFFER10:34863,DRAW_BUFFER11:34864,DRAW_BUFFER12:34865,DRAW_BUFFER13:34866,DRAW_BUFFER14:34867,DRAW_BUFFER15:34868,MAX_COLOR_ATTACHMENTS:36063,COLOR_ATTACHMENT1:36065,COLOR_ATTACHMENT2:36066,COLOR_ATTACHMENT3:36067,COLOR_ATTACHMENT4:36068,COLOR_ATTACHMENT5:36069,COLOR_ATTACHMENT6:36070,COLOR_ATTACHMENT7:36071,COLOR_ATTACHMENT8:36072,COLOR_ATTACHMENT9:36073,COLOR_ATTACHMENT10:36074,COLOR_ATTACHMENT11:36075,COLOR_ATTACHMENT12:36076,COLOR_ATTACHMENT13:36077,COLOR_ATTACHMENT14:36078,COLOR_ATTACHMENT15:36079,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,MAX_SAMPLES:36183,SAMPLER_BINDING:35097,PIXEL_PACK_BUFFER:35051,PIXEL_UNPACK_BUFFER:35052,PIXEL_PACK_BUFFER_BINDING:35053,PIXEL_UNPACK_BUFFER_BINDING:35055,COPY_READ_BUFFER:36662,COPY_WRITE_BUFFER:36663,COPY_READ_BUFFER_BINDING:36662,COPY_WRITE_BUFFER_BINDING:36663,FLOAT_MAT2x3:35685,FLOAT_MAT2x4:35686,FLOAT_MAT3x2:35687,FLOAT_MAT3x4:35688,FLOAT_MAT4x2:35689,FLOAT_MAT4x3:35690,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,UNSIGNED_NORMALIZED:35863,SIGNED_NORMALIZED:36764,VERTEX_ATTRIB_ARRAY_INTEGER:35069,VERTEX_ATTRIB_ARRAY_DIVISOR:35070,TRANSFORM_FEEDBACK_BUFFER_MODE:35967,MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS:35968,TRANSFORM_FEEDBACK_VARYINGS:35971,TRANSFORM_FEEDBACK_BUFFER_START:35972,TRANSFORM_FEEDBACK_BUFFER_SIZE:35973,TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN:35976,MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS:35978,MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS:35979,INTERLEAVED_ATTRIBS:35980,SEPARATE_ATTRIBS:35981,TRANSFORM_FEEDBACK_BUFFER:35982,TRANSFORM_FEEDBACK_BUFFER_BINDING:35983,TRANSFORM_FEEDBACK:36386,TRANSFORM_FEEDBACK_PAUSED:36387,TRANSFORM_FEEDBACK_ACTIVE:36388,TRANSFORM_FEEDBACK_BINDING:36389,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE:33297,FRAMEBUFFER_ATTACHMENT_RED_SIZE:33298,FRAMEBUFFER_ATTACHMENT_GREEN_SIZE:33299,FRAMEBUFFER_ATTACHMENT_BLUE_SIZE:33300,FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE:33301,FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE:33302,FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE:33303,FRAMEBUFFER_DEFAULT:33304,DEPTH24_STENCIL8:35056,DRAW_FRAMEBUFFER_BINDING:36006,READ_FRAMEBUFFER_BINDING:36010,RENDERBUFFER_SAMPLES:36011,FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER:36052,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:36182,UNIFORM_BUFFER:35345,UNIFORM_BUFFER_BINDING:35368,UNIFORM_BUFFER_START:35369,UNIFORM_BUFFER_SIZE:35370,MAX_VERTEX_UNIFORM_BLOCKS:35371,MAX_FRAGMENT_UNIFORM_BLOCKS:35373,MAX_COMBINED_UNIFORM_BLOCKS:35374,MAX_UNIFORM_BUFFER_BINDINGS:35375,MAX_UNIFORM_BLOCK_SIZE:35376,MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS:35377,MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS:35379,UNIFORM_BUFFER_OFFSET_ALIGNMENT:35380,ACTIVE_UNIFORM_BLOCKS:35382,UNIFORM_TYPE:35383,UNIFORM_SIZE:35384,UNIFORM_BLOCK_INDEX:35386,UNIFORM_OFFSET:35387,UNIFORM_ARRAY_STRIDE:35388,UNIFORM_MATRIX_STRIDE:35389,UNIFORM_IS_ROW_MAJOR:35390,UNIFORM_BLOCK_BINDING:35391,UNIFORM_BLOCK_DATA_SIZE:35392,UNIFORM_BLOCK_ACTIVE_UNIFORMS:35394,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES:35395,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER:35396,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER:35398,OBJECT_TYPE:37138,SYNC_CONDITION:37139,SYNC_STATUS:37140,SYNC_FLAGS:37141,SYNC_FENCE:37142,SYNC_GPU_COMMANDS_COMPLETE:37143,UNSIGNALED:37144,SIGNALED:37145,ALREADY_SIGNALED:37146,TIMEOUT_EXPIRED:37147,CONDITION_SATISFIED:37148,WAIT_FAILED:37149,SYNC_FLUSH_COMMANDS_BIT:1,COLOR:6144,DEPTH:6145,STENCIL:6146,MIN:32775,MAX:32776,DEPTH_COMPONENT24:33190,STREAM_READ:35041,STREAM_COPY:35042,STATIC_READ:35045,STATIC_COPY:35046,DYNAMIC_READ:35049,DYNAMIC_COPY:35050,DEPTH_COMPONENT32F:36012,DEPTH32F_STENCIL8:36013,INVALID_INDEX:4294967295,TIMEOUT_IGNORED:-1,MAX_CLIENT_WAIT_TIMEOUT_WEBGL:37447,VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE:35070,UNMASKED_VENDOR_WEBGL:37445,UNMASKED_RENDERER_WEBGL:37446,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047,TEXTURE_MAX_ANISOTROPY_EXT:34046,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_RGBA8_ETC2_EAC:37493,COMPRESSED_SRGB8_ETC2:37494,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37495,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37496,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37497,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,COMPRESSED_RGB_ATC_WEBGL:35986,COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL:35986,COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL:34798,UNSIGNED_INT_24_8_WEBGL:34042,HALF_FLOAT_OES:36193,RGBA32F_EXT:34836,RGB32F_EXT:34837,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT:33297,UNSIGNED_NORMALIZED_EXT:35863,MIN_EXT:32775,MAX_EXT:32776,SRGB_EXT:35904,SRGB_ALPHA_EXT:35906,SRGB8_ALPHA8_EXT:35907,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT:33296,FRAGMENT_SHADER_DERIVATIVE_HINT_OES:35723,COLOR_ATTACHMENT0_WEBGL:36064,COLOR_ATTACHMENT1_WEBGL:36065,COLOR_ATTACHMENT2_WEBGL:36066,COLOR_ATTACHMENT3_WEBGL:36067,COLOR_ATTACHMENT4_WEBGL:36068,COLOR_ATTACHMENT5_WEBGL:36069,COLOR_ATTACHMENT6_WEBGL:36070,COLOR_ATTACHMENT7_WEBGL:36071,COLOR_ATTACHMENT8_WEBGL:36072,COLOR_ATTACHMENT9_WEBGL:36073,COLOR_ATTACHMENT10_WEBGL:36074,COLOR_ATTACHMENT11_WEBGL:36075,COLOR_ATTACHMENT12_WEBGL:36076,COLOR_ATTACHMENT13_WEBGL:36077,COLOR_ATTACHMENT14_WEBGL:36078,COLOR_ATTACHMENT15_WEBGL:36079,DRAW_BUFFER0_WEBGL:34853,DRAW_BUFFER1_WEBGL:34854,DRAW_BUFFER2_WEBGL:34855,DRAW_BUFFER3_WEBGL:34856,DRAW_BUFFER4_WEBGL:34857,DRAW_BUFFER5_WEBGL:34858,DRAW_BUFFER6_WEBGL:34859,DRAW_BUFFER7_WEBGL:34860,DRAW_BUFFER8_WEBGL:34861,DRAW_BUFFER9_WEBGL:34862,DRAW_BUFFER10_WEBGL:34863,DRAW_BUFFER11_WEBGL:34864,DRAW_BUFFER12_WEBGL:34865,DRAW_BUFFER13_WEBGL:34866,DRAW_BUFFER14_WEBGL:34867,DRAW_BUFFER15_WEBGL:34868,MAX_COLOR_ATTACHMENTS_WEBGL:36063,MAX_DRAW_BUFFERS_WEBGL:34852,VERTEX_ARRAY_BINDING_OES:34229,QUERY_COUNTER_BITS_EXT:34916,CURRENT_QUERY_EXT:34917,QUERY_RESULT_EXT:34918,QUERY_RESULT_AVAILABLE_EXT:34919,TIME_ELAPSED_EXT:35007,TIMESTAMP_EXT:36392,GPU_DISJOINT_EXT:36795}},function(t,e,n){n(359),t.exports=n(38).Object.assign},function(t,e,n){var r=n(60);r(r.S+r.F,"Object",{assign:n(360)})},function(t,e,n){"use strict";var r=n(64),i=n(90),o=n(155),a=n(112),s=n(81),u=n(198),c=Object.assign;t.exports=!c||n(80)((function(){var t={},e={},n=Symbol(),r="abcdefghijklmnopqrst";return t[n]=7,r.split("").forEach((function(t){e[t]=t})),7!=c({},t)[n]||Object.keys(c({},e)).join("")!=r}))?function(t,e){for(var n=s(t),c=arguments.length,l=1,f=o.f,h=a.f;c>l;)for(var d,p=u(arguments[l++]),g=f?i(p).concat(f(p)):i(p),v=g.length,y=0;v>y;)d=g[y++],r&&!h.call(p,d)||(n[d]=p[d]);return n}:c},function(t,e,n){"use strict";var r=Object.prototype.hasOwnProperty,i="~";function o(){}function a(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function s(t,e,n,r,o){if("function"!=typeof n)throw new TypeError("The listener must be a function");var s=new a(n,r||t,o),u=i?i+e:e;return t._events[u]?t._events[u].fn?t._events[u]=[t._events[u],s]:t._events[u].push(s):(t._events[u]=s,t._eventsCount++),t}function u(t,e){0==--t._eventsCount?t._events=new o:delete t._events[e]}function c(){this._events=new o,this._eventsCount=0}Object.create&&(o.prototype=Object.create(null),(new o).__proto__||(i=!1)),c.prototype.eventNames=function(){var t,e,n=[];if(0===this._eventsCount)return n;for(e in t=this._events)r.call(t,e)&&n.push(i?e.slice(1):e);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(t)):n},c.prototype.listeners=function(t){var e=i?i+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var r=0,o=n.length,a=new Array(o);r<o;r++)a[r]=n[r].fn;return a},c.prototype.listenerCount=function(t){var e=i?i+t:t,n=this._events[e];return n?n.fn?1:n.length:0},c.prototype.emit=function(t,e,n,r,o,a){var s=i?i+t:t;if(!this._events[s])return!1;var u,c,l=this._events[s],f=arguments.length;if(l.fn){switch(l.once&&this.removeListener(t,l.fn,void 0,!0),f){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,e),!0;case 3:return l.fn.call(l.context,e,n),!0;case 4:return l.fn.call(l.context,e,n,r),!0;case 5:return l.fn.call(l.context,e,n,r,o),!0;case 6:return l.fn.call(l.context,e,n,r,o,a),!0}for(c=1,u=new Array(f-1);c<f;c++)u[c-1]=arguments[c];l.fn.apply(l.context,u)}else{var h,d=l.length;for(c=0;c<d;c++)switch(l[c].once&&this.removeListener(t,l[c].fn,void 0,!0),f){case 1:l[c].fn.call(l[c].context);break;case 2:l[c].fn.call(l[c].context,e);break;case 3:l[c].fn.call(l[c].context,e,n);break;case 4:l[c].fn.call(l[c].context,e,n,r);break;default:if(!u)for(h=1,u=new Array(f-1);h<f;h++)u[h-1]=arguments[h];l[c].fn.apply(l[c].context,u)}}return!0},c.prototype.on=function(t,e,n){return s(this,t,e,n,!1)},c.prototype.once=function(t,e,n){return s(this,t,e,n,!0)},c.prototype.removeListener=function(t,e,n,r){var o=i?i+t:t;if(!this._events[o])return this;if(!e)return u(this,o),this;var a=this._events[o];if(a.fn)a.fn!==e||r&&!a.once||n&&a.context!==n||u(this,o);else{for(var s=0,c=[],l=a.length;s<l;s++)(a[s].fn!==e||r&&!a[s].once||n&&a[s].context!==n)&&c.push(a[s]);c.length?this._events[o]=1===c.length?c[0]:c:u(this,o)}return this},c.prototype.removeAllListeners=function(t){var e;return t?(e=i?i+t:t,this._events[e]&&u(this,e)):(this._events=new o,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=i,c.EventEmitter=c,t.exports=c},function(t,e,n){},function(t,e,n){"use strict";e.__esModule=!0;var r=o(n(364)),i=o(n(156));function o(t){return t&&t.__esModule?t:{default:t}}e.default=function(t,e){if(Array.isArray(t))return t;if((0,r.default)(Object(t)))return function(t,e){var n=[],r=!0,o=!1,a=void 0;try{for(var s,u=(0,i.default)(t);!(r=(s=u.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){o=!0,a=t}finally{try{!r&&u.return&&u.return()}finally{if(o)throw a}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}},function(t,e,n){t.exports={default:n(365),__esModule:!0}},function(t,e,n){n(152),n(111),t.exports=n(366)},function(t,e,n){var r=n(205),i=n(52)("iterator"),o=n(82);t.exports=n(38).isIterable=function(t){var e=Object(t);return void 0!==e[i]||"@@iterator"in e||o.hasOwnProperty(r(e))}},function(t,e,n){n(152),n(111),t.exports=n(368)},function(t,e,n){var r=n(69),i=n(206);t.exports=n(38).getIterator=function(t){var e=i(t);if("function"!=typeof e)throw TypeError(t+" is not iterable!");return r(e.call(t))}},function(t,e,n){t.exports={default:n(370),__esModule:!0}},function(t,e,n){n(371),t.exports=n(38).Object.keys},function(t,e,n){var r=n(81),i=n(90);n(194)("keys",(function(){return function(t){return i(r(t))}}))},function(t,e,n){var r;!function(i){"use strict";function o(t,e){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}function a(t,e,n,r,i,a){return o((s=o(o(e,t),o(r,a)))<<(u=i)|s>>>32-u,n);var s,u}function s(t,e,n,r,i,o,s){return a(e&n|~e&r,t,e,i,o,s)}function u(t,e,n,r,i,o,s){return a(e&r|n&~r,t,e,i,o,s)}function c(t,e,n,r,i,o,s){return a(e^n^r,t,e,i,o,s)}function l(t,e,n,r,i,o,s){return a(n^(e|~r),t,e,i,o,s)}function f(t,e){var n,r,i,a,f;t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;var h=1732584193,d=-271733879,p=-1732584194,g=271733878;for(n=0;n<t.length;n+=16)r=h,i=d,a=p,f=g,h=s(h,d,p,g,t[n],7,-680876936),g=s(g,h,d,p,t[n+1],12,-389564586),p=s(p,g,h,d,t[n+2],17,606105819),d=s(d,p,g,h,t[n+3],22,-1044525330),h=s(h,d,p,g,t[n+4],7,-176418897),g=s(g,h,d,p,t[n+5],12,1200080426),p=s(p,g,h,d,t[n+6],17,-1473231341),d=s(d,p,g,h,t[n+7],22,-45705983),h=s(h,d,p,g,t[n+8],7,1770035416),g=s(g,h,d,p,t[n+9],12,-1958414417),p=s(p,g,h,d,t[n+10],17,-42063),d=s(d,p,g,h,t[n+11],22,-1990404162),h=s(h,d,p,g,t[n+12],7,1804603682),g=s(g,h,d,p,t[n+13],12,-40341101),p=s(p,g,h,d,t[n+14],17,-1502002290),h=u(h,d=s(d,p,g,h,t[n+15],22,1236535329),p,g,t[n+1],5,-165796510),g=u(g,h,d,p,t[n+6],9,-1069501632),p=u(p,g,h,d,t[n+11],14,643717713),d=u(d,p,g,h,t[n],20,-373897302),h=u(h,d,p,g,t[n+5],5,-701558691),g=u(g,h,d,p,t[n+10],9,38016083),p=u(p,g,h,d,t[n+15],14,-660478335),d=u(d,p,g,h,t[n+4],20,-405537848),h=u(h,d,p,g,t[n+9],5,568446438),g=u(g,h,d,p,t[n+14],9,-1019803690),p=u(p,g,h,d,t[n+3],14,-187363961),d=u(d,p,g,h,t[n+8],20,1163531501),h=u(h,d,p,g,t[n+13],5,-1444681467),g=u(g,h,d,p,t[n+2],9,-51403784),p=u(p,g,h,d,t[n+7],14,1735328473),h=c(h,d=u(d,p,g,h,t[n+12],20,-1926607734),p,g,t[n+5],4,-378558),g=c(g,h,d,p,t[n+8],11,-2022574463),p=c(p,g,h,d,t[n+11],16,1839030562),d=c(d,p,g,h,t[n+14],23,-35309556),h=c(h,d,p,g,t[n+1],4,-1530992060),g=c(g,h,d,p,t[n+4],11,1272893353),p=c(p,g,h,d,t[n+7],16,-155497632),d=c(d,p,g,h,t[n+10],23,-1094730640),h=c(h,d,p,g,t[n+13],4,681279174),g=c(g,h,d,p,t[n],11,-358537222),p=c(p,g,h,d,t[n+3],16,-722521979),d=c(d,p,g,h,t[n+6],23,76029189),h=c(h,d,p,g,t[n+9],4,-640364487),g=c(g,h,d,p,t[n+12],11,-421815835),p=c(p,g,h,d,t[n+15],16,530742520),h=l(h,d=c(d,p,g,h,t[n+2],23,-995338651),p,g,t[n],6,-198630844),g=l(g,h,d,p,t[n+7],10,1126891415),p=l(p,g,h,d,t[n+14],15,-1416354905),d=l(d,p,g,h,t[n+5],21,-57434055),h=l(h,d,p,g,t[n+12],6,1700485571),g=l(g,h,d,p,t[n+3],10,-1894986606),p=l(p,g,h,d,t[n+10],15,-1051523),d=l(d,p,g,h,t[n+1],21,-2054922799),h=l(h,d,p,g,t[n+8],6,1873313359),g=l(g,h,d,p,t[n+15],10,-30611744),p=l(p,g,h,d,t[n+6],15,-1560198380),d=l(d,p,g,h,t[n+13],21,1309151649),h=l(h,d,p,g,t[n+4],6,-145523070),g=l(g,h,d,p,t[n+11],10,-1120210379),p=l(p,g,h,d,t[n+2],15,718787259),d=l(d,p,g,h,t[n+9],21,-343485551),h=o(h,r),d=o(d,i),p=o(p,a),g=o(g,f);return[h,d,p,g]}function h(t){var e,n="",r=32*t.length;for(e=0;e<r;e+=8)n+=String.fromCharCode(t[e>>5]>>>e%32&255);return n}function d(t){var e,n=[];for(n[(t.length>>2)-1]=void 0,e=0;e<n.length;e+=1)n[e]=0;var r=8*t.length;for(e=0;e<r;e+=8)n[e>>5]|=(255&t.charCodeAt(e/8))<<e%32;return n}function p(t){var e,n,r="";for(n=0;n<t.length;n+=1)e=t.charCodeAt(n),r+="0123456789abcdef".charAt(e>>>4&15)+"0123456789abcdef".charAt(15&e);return r}function g(t){return unescape(encodeURIComponent(t))}function v(t){return function(t){return h(f(d(t),8*t.length))}(g(t))}function y(t,e){return function(t,e){var n,r,i=d(t),o=[],a=[];for(o[15]=a[15]=void 0,i.length>16&&(i=f(i,8*t.length)),n=0;n<16;n+=1)o[n]=909522486^i[n],a[n]=1549556828^i[n];return r=f(o.concat(d(e)),512+8*e.length),h(f(a.concat(r),640))}(g(t),g(e))}function m(t,e,n){return e?n?y(e,t):p(y(e,t)):n?v(t):p(v(t))}void 0===(r=function(){return m}.call(e,n,e,t))||(t.exports=r)}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=d(n(108)),i=d(n(31)),o=d(n(32)),a=d(n(33)),s=d(n(34)),u=d(n(35)),c=(d(n(23)),d(n(40))),l=n(42),f=d(n(51)),h=n(55);function d(t){return t&&t.__esModule?t:{default:t}}var p=function(t){function e(){return(0,o.default)(this,e),(0,s.default)(this,(e.__proto__||(0,i.default)(e)).apply(this,arguments))}return(0,u.default)(e,t),(0,a.default)(e,[{key:"getLayerGL",value:function(t){return new l.ScatterplotLayer({id:this.layerId,data:t.data&&t.data.features||[],pickable:t.pickable,visible:t.visible,opacity:t.opacity,filled:t.filled,stroked:t.stroked,radiusMinPixels:t.radiusMinPixels,radiusMaxPixels:t.radiusMaxPixels,radiusScale:t.radiusScale,autoHighlight:t.autoHighlight,highlightColor:t.highlightColor,getLineWidth:t.getLineWidth,getRadius:function(e){var n=t.setRadius;return n&&"function"==typeof n?n(e):t.radius},getFillColor:function(e){var n=t.setScatterColor;if(n&&"function"==typeof n)return n(e);var r=null==t.getValue?e.properties[t.valueName||"value"]:t.getValue(e);return(0,h.getScale)(r||void 0,t.fill)},getLineColor:function(e){var n=t.setLineColor;if(n&&"function"==typeof n)return n(e);var r=null==t.getValue?e.properties[t.valueName||"value"]:t.getValue(e);return(0,h.getScale)(r||void 0,t.stroke)},getPosition:function(t){return t.geometry.coordinates},updateTriggers:{getLineWidth:t.getLineWidth,getRadius:[t.setRadius,t.radius],getFillColor:[t.setScatterColor,t.fill,t.valueName,t.fill.range,t.fill.domain],getLineColor:[t.getLineColor,t.stroke,t.valueName,t.stroke.range,t.stroke.domain]}})}}]),e}(f.default);p.propTypes={stroked:c.default.bool,filled:c.default.bool,strokeWidth:c.default.number,setScatterColor:c.default.func,radiusMinPixels:c.default.number,radiusMaxPixels:c.default.number,valueName:c.default.string,fill:c.default.oneOfType([c.default.array,c.default.object]),getValue:c.default.func,setRadius:c.default.func,radius:c.default.number,radiusScale:c.default.number},p.defaultProps={radiusMinPixels:1,radiusMaxPixels:r.default,radius:5,radiusScale:10,visible:!0,opacity:1,pickable:!0,getLineWidth:5,autoHighlight:!1,highlightColor:[255,255,255,255],stroked:!1,filled:!0,fill:[255,255,255,255],stroke:[255,255,255,255],valueName:"value"},e.default=p},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=h(n(31)),i=h(n(32)),o=h(n(33)),a=h(n(34)),s=h(n(35)),u=(h(n(23)),h(n(40))),c=n(42),l=h(n(51)),f=n(55);function h(t){return t&&t.__esModule?t:{default:t}}var d=function(t){function e(){return(0,i.default)(this,e),(0,a.default)(this,(e.__proto__||(0,r.default)(e)).apply(this,arguments))}return(0,s.default)(e,t),(0,o.default)(e,[{key:"getLayerGL",value:function(t){return new c.IconLayer({id:this.layerId,data:t.data&&t.data.features||[],pickable:t.pickable,iconAtlas:t.iconAtlas,iconMapping:t.iconMapping,sizeScale:t.sizeScale,visible:t.visible,getAngle:t.getAngle,opacity:t.opacity,getPosition:function(t){return t.geometry.coordinates},getColor:function(e){var n=t.setColor;if(n&&"function"==typeof n)return n(e);var r=null==t.getValue?e.properties[t.valueName||"value"]:t.getValue(e);return(0,f.getScale)(r||void 0,t.maskColor)},getIcon:function(e){var n=t.getIcon;return n&&"function"==typeof n?n(e):n},getSize:function(e){var n=t.setSize;return n&&"function"==typeof n?n(e):t.size},updateTriggers:{getSize:[t.size,t.setSize],getColor:[t.setColor,t.maskColor,t.valueName,t.maskColor.range,t.maskColor.domain]}})}}]),e}(l.default);d.propTypes={iconAtlas:u.default.any,iconMapping:u.default.object,sizeScale:u.default.number,fp64:u.default.bool,getPosition:u.default.func,getIcon:u.default.func,getColor:u.default.array,getSize:u.default.number,getAngle:u.default.number},d.defaultProps={iconAtlas:null,opacity:1,pickable:!0,iconMapping:null,sizeScale:10,size:5,fp64:!1,getSize:1,getAngle:0,visible:!0,maskColor:[0,0,0,255]},e.default=d},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=f(n(84)),i=f(n(31)),o=f(n(32)),a=f(n(33)),s=f(n(34)),u=f(n(35)),c=n(55),l=n(23);f(l);function f(t){return t&&t.__esModule?t:{default:t}}n(158),n(376);var h=function(t){function e(t){(0,o.default)(this,e);var n=(0,s.default)(this,(e.__proto__||(0,i.default)(e)).call(this,t));return n._map=n.props.map||n.context&&n.context.map,n.areaPois=n.combinePolygon(n.props.data),n.state={data:n.formatData()},n._initMapEvent(),n}return(0,u.default)(e,t),(0,a.default)(e,[{key:"combinePolygon",value:function(t){var e=[],n=[];return t.features.map((function(t){var r=t.geometry.coordinates[0];n.push([r[0][1],r[0][0]]),r.map((function(t){e.push([t[1],t[0]])})),e.push([r[0][1],r[0][0]])})),n.length>1&&n.map((function(t){e.push(t)})),e}},{key:"formatData",value:function(){var t=this._map.getSize(),e=t.x,n=t.y,r=(0,c.pixelToPoint)(0,0,this._map),i=(0,c.pixelToPoint)(e,0,this._map),o=(0,c.pixelToPoint)(0,n,this._map),a=(0,c.pixelToPoint)(e,n,this._map);r=[r.lat,r.lng],i=[i.lat,i.lng],o=[o.lat,o.lng];var s=[[r,i,a=[a.lat,a.lng],o],this.areaPois];return s}},{key:"_initMapEvent",value:function(){var t=this._map;t.on("moveend",this._onMapMoveend,this),t.on("zoomend",this._onMapZoomend,this)}},{key:"_onMapMoveend",value:function(){this.setState({data:this.formatData()})}},{key:"_onMapZoomend",value:function(){this.setState({data:this.formatData()})}},{key:"componentWillUnmount",value:function(){this._map&&this.lightpolygon&&this._map.removeLayer(this.lightpolygon)}},{key:"render",value:function(){return this._map&&this.lightpolygon&&this._map.removeLayer(this.lightpolygon),this.lightpolygon=L.polygon(this.state.data,(0,r.default)({},this.props.style)).addTo(this._map),null}}]),e}(l.Component);e.default=h},function(t,e,n){"use strict";!function(t,e,n){L.Browser.svg&&L.SVG.include({_updateStyle:function(t){var e=t._path,n=t.options;e&&(n.stroke?(e.setAttribute("stroke",n.color),e.setAttribute("stroke-opacity",n.opacity),e.setAttribute("stroke-width",n.weight),e.setAttribute("stroke-linecap",n.lineCap),e.setAttribute("stroke-linejoin",n.lineJoin),n.dashArray?e.setAttribute("stroke-dasharray",n.dashArray):e.removeAttribute("stroke-dasharray"),n.dashOffset?e.setAttribute("stroke-dashoffset",n.dashOffset):e.removeAttribute("stroke-dashoffset")):e.setAttribute("stroke","none"),n.fill?("string"==typeof n.fill&&n.fill.match(/^url\(/)?this.__fillPattern(t):e.setAttribute("fill",n.fillColor||n.color),e.setAttribute("fill-opacity",n.fillOpacity),e.setAttribute("fill-rule",n.fillRule||"evenodd")):e.setAttribute("fill","none"))},__fillPattern:function(t){var n=t._path,r=t.options;this._defs||(this._defs=L.SVG.create("defs"),this._container.appendChild(this._defs));var i=r.fill.substring(4,r.fill.length-1),o=i+(Math.random()*Math.pow(10,17)+Math.random()*Math.pow(10,17));o+=(new Date).getUTCMilliseconds();var a=e.getElementById(o);if(!a){var s=new Image;s.src=i,(a=L.SVG.create("pattern")).setAttribute("id",o),a.setAttribute("x","0"),a.setAttribute("y","0"),a.setAttribute("patternUnits","userSpaceOnUse"),a.setAttribute("width","24"),a.setAttribute("height","24");var u=L.SVG.create("rect");u.setAttribute("width",24),u.setAttribute("height",24),u.setAttribute("x",0),u.setAttribute("x",0),u.setAttribute("fill",r.fillColor||r.color),a.appendChild(u),this._defs.appendChild(a);var c=L.SVG.create("image");c.setAttribute("x","0"),c.setAttribute("y","0"),c.setAttributeNS("http://www.w3.org/1999/xlink","href",i),c.setAttribute("width","24"),c.setAttribute("height","24"),a.appendChild(c),s.onload=function(){a.setAttribute("width",s.width),a.setAttribute("height",s.height),c.setAttribute("width",s.width),c.setAttribute("height",s.height)}}n.setAttribute("fill","url(#"+o+")")}})}(0,document)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=d(n(108)),i=d(n(31)),o=d(n(32)),a=d(n(33)),s=d(n(34)),u=d(n(35)),c=(d(n(23)),d(n(40))),l=n(42),f=d(n(51)),h=n(55);function d(t){return t&&t.__esModule?t:{default:t}}var p=function(t){function e(){return(0,o.default)(this,e),(0,s.default)(this,(e.__proto__||(0,i.default)(e)).apply(this,arguments))}return(0,u.default)(e,t),(0,a.default)(e,[{key:"getLayerGL",value:function(t){return new l.GeoJsonLayer({id:this.layerId,data:t.data,redraw:t.redraw,getWidth:function(e){return t.strokeWidth},extruded:!1,pickable:t.pickable,opacity:t.opacity,visible:t.visible,lineDashJustified:!0,lineWidthMaxPixels:t.lineWidthMaxPixels,lineWidthMinPixels:t.lineWidthMinPixels,lineWidthScale:t.lineWidthScale,rounded:t.rounded,lineJointRounded:t.rounded||t.lineJointRounded,lineMiterLimit:t.lineMiterLimit,fp64:t.fp64,filled:t.filled,stroked:t.stroked,wireframe:t.wireframe,autoHighlight:t.autoHighlight,highlightColor:t.highlightColor,getLineDashArray:t.getLineDashArray,getLineColor:function(e){if(t.stroked){var n=t.setLineColor;if(n&&"function"==typeof n)return n(e);var r=null==t.getValue?e.properties[t.valueName||"value"]:t.getValue(e);return(0,h.getScale)(r||void 0,t.stroke)}},getFillColor:function(e){if(t.filled){var n=t.setFillColor;if(n&&"function"==typeof n)return n(e);var r=null==t.getValue?e.properties[t.valueName||"value"]:t.getValue(e);return(0,h.getScale)(r||void 0,t.fill)}return[0,0,0,255]},getLineWidth:function(e){var n=t.setLineWidth;return n&&"function"==typeof n?n(e):t.strokeWidth},getElevation:function(e){var n=t.setElevation;return n&&"function"==typeof n?n(e):1e3},updateTriggers:{getLineColor:[t.setLineColor,t.stroke],getFillColor:[t.setFillColor,t.fill,t.valueName,t.fill.range,t.fill.domain],getLineWidth:[t.setLineWidth,t.strokeWidth,t.lineWidthScale]}})}}]),e}(f.default);p.propTypes={filled:c.default.bool,stroked:c.default.bool,extruded:c.default.bool,wireframe:c.default.bool,lineWidthScale:c.default.number,lineWidthMinPixels:c.default.number,lineWidthMaxPixels:c.default.number,lightSettings:c.default.object,rounded:c.default.bool,setFillColor:c.default.func,setLineColor:c.default.func,setElevation:c.default.func,setLineWidth:c.default.func,valueName:c.default.string,stroke:c.default.oneOfType([c.default.array,c.default.object]),strokeWidth:c.default.number,getValue:c.default.func,fill:c.default.oneOfType([c.default.array,c.default.object]),lineJointRounded:c.default.bool,fp64:c.default.bool,lineMiterLimit:c.default.number},p.defaultProps={lineWidthMinPixels:1,lineWidthMaxPixels:r.default,lineWidthScale:1,rounded:!1,filled:!0,stroked:!0,visible:!0,opacity:1,pickable:!0,strokeWidth:1,fp64:!1,lineMiterLimit:4,lineJointRounded:!1,autoHighlight:!1,highlightColor:[255,255,255,255],getLineDashArray:null,fill:[255,255,255,255]},e.default=p},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=f(n(31)),i=f(n(32)),o=f(n(33)),a=f(n(34)),s=f(n(35)),u=(f(n(23)),f(n(40))),c=n(42),l=f(n(51));n(55);function f(t){return t&&t.__esModule?t:{default:t}}var h=function(t){function e(){return(0,i.default)(this,e),(0,a.default)(this,(e.__proto__||(0,r.default)(e)).apply(this,arguments))}return(0,s.default)(e,t),(0,o.default)(e,[{key:"getLayerGL",value:function(t){return"screen"===t.type?new c.ScreenGridLayer({id:this.layerId,data:t.data&&t.data.features||[],pickable:t.pickable,opacity:t.opacity,visible:t.visible,cellSizePixels:t.cellSizePixels,minColor:t.minColor,maxColor:t.maxColor,getPosition:function(t){return t.geometry.coordinates},getWeight:function(e){var n=t.setGridWeight;return n&&"function"==typeof n?n(e):1},updateTriggers:{getWeight:t.setGridWeight}}):new c.GridLayer({id:this.layerId,data:t.data&&t.data.features||[],extruded:!1,pickable:t.pickable,opacity:t.opacity,visible:t.visible,colorDomain:t.colorDomain,colorRange:t.colorRange,cellSize:t.cellSize,coverage:t.coverage,autoHighlight:t.autoHighlight,highlightColor:t.highlightColor,getColorValue:function(e){var n=t.setGridColor;return n&&"function"==typeof n?n(e):e.length},getPosition:function(t){return t.geometry.coordinates},updateTriggers:{getColorValue:t.setGridColor}})}}]),e}(l.default);h.propTypes={cellSize:u.default.number,colorDomain:u.default.array,colorRange:u.default.array,setGridColor:u.default.func,coverage:u.default.number,elevationDomain:u.default.array,elevationRange:u.default.array,elevationScale:u.default.number,extruded:u.default.bool,upperPercentile:u.default.number,lowerPercentile:u.default.number,lightSettings:u.default.object,setPosition:u.default.func,minColor:u.default.arrayOf(u.default.number),maxColor:u.default.arrayOf(u.default.number),cellSizePixels:u.default.number},h.defaultProps={cellSize:500,visible:!0,opacity:1,pickable:!0,coverage:1,cellSizePixels:100,minColor:[0,0,0,255],maxColor:[0,255,0,255],autoHighlight:!1,highlightColor:[255,255,255,255]},e.default=h},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=f(n(31)),i=f(n(32)),o=f(n(33)),a=f(n(34)),s=f(n(35)),u=(f(n(23)),f(n(40))),c=n(42),l=f(n(51));n(55);function f(t){return t&&t.__esModule?t:{default:t}}var h=function(t){function e(){return(0,i.default)(this,e),(0,a.default)(this,(e.__proto__||(0,r.default)(e)).apply(this,arguments))}return(0,s.default)(e,t),(0,o.default)(e,[{key:"getLayerGL",value:function(t){return new c.HexagonLayer({id:this.layerId,data:t.data&&t.data.features||[],extruded:!1,pickable:t.pickable,opacity:t.opacity,visible:t.visible,colorDomain:t.colorDomain,colorRange:t.colorRange,radius:t.radius,coverage:t.coverage,autoHighlight:t.autoHighlight,highlightColor:t.highlightColor,getColorValue:function(e){var n=t.setHoneyCombColor;return n&&"function"==typeof n?n(e):e.length},getPosition:function(t){return t.geometry.coordinates},updateTriggers:{getColorValue:t.setHoneyCombColor}})}}]),e}(l.default);h.propTypes={radius:u.default.number,colorDomain:u.default.array,colorRange:u.default.array,setHoneyCombColor:u.default.func,coverage:u.default.number,elevationDomain:u.default.array,elevationRange:u.default.array,elevationScale:u.default.number,extruded:u.default.bool,upperPercentile:u.default.number,lowerPercentile:u.default.number,lightSettings:u.default.object},h.defaultProps={radius:100,visible:!0,opacity:1,pickable:!0,coverage:1,autoHighlight:!1,highlightColor:[255,255,255,255]},e.default=h},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=h(n(31)),i=h(n(32)),o=h(n(33)),a=h(n(34)),s=h(n(35)),u=(h(n(23)),h(n(40))),c=n(42),l=h(n(381)),f=h(n(51));n(55);function h(t){return t&&t.__esModule?t:{default:t}}var d=[0,167,157],p=function(t){function e(){return(0,i.default)(this,e),(0,a.default)(this,(e.__proto__||(0,r.default)(e)).apply(this,arguments))}return(0,s.default)(e,t),(0,o.default)(e,[{key:"_calculateTime",value:function(){var t=Date.now(),e=this.props,n=e.loopLength,r=e.loopTime;return t%r/r*n}},{key:"_animate",value:function(){var t=this;this.setState((function(e,n){return{tripTime:t.state.tripTime+1,redraw:!0}})),this.animateTimeoutId=setTimeout(this._animate.bind(this),200)}},{key:"getLayerGL",value:function(t,e){return new l.default({id:this.layerId,data:t.data&&t.data.features||[],extruded:!1,pickable:t.pickable,opacity:t.opacity,visible:t.visible,currentTime:e.tripTime,trailLength:t.trailLength,strokeWidth:t.strokeWidth,getColor:function(e){var n=t.setColor;return n&&"function"==typeof n?n(e):c.experimental.get(e,"properties.color")||d},getPath:function(e){var n=t.setPath;return n&&"function"==typeof n?n(e):c.experimental.get(e,"geometry.coordinates")},updateTriggers:{getColor:t.setColor,getPath:t.setPath}})}}]),e}(f.default);p.propTypes={setPath:u.default.func,setColor:u.default.func,currentTime:u.default.number,trailLength:u.default.number,strokeWidth:u.default.number,loopLength:u.default.number,loopTime:u.default.number,type:u.default.string},p.defaultProps={visible:!0,opacity:1,pickable:!0,currentTime:0,trailLength:120,strokeWidth:5,loopLength:1800,loopTime:6e4,type:"trip"},e.default=p},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(382);Object.defineProperty(e,"default",{enumerable:!0,get:function(){return(t=r,t&&t.__esModule?t:{default:t}).default;var t}})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=p(n(203)),i=p(n(383)),o=p(n(31)),a=p(n(32)),s=p(n(33)),u=p(n(34)),c=p(n(35)),l=n(42),f=n(5),h=p(n(391)),d=p(n(392));function p(t){return t&&t.__esModule?t:{default:t}}var g=function(t){function e(){return(0,a.default)(this,e),(0,u.default)(this,(e.__proto__||(0,o.default)(e)).apply(this,arguments))}return(0,c.default)(e,t),(0,s.default)(e,[{key:"initializeState",value:function(){var t=this.context.gl,e=this.state.attributeManager,n=this.getModel(t);e.add({indices:{size:1,update:this.calculateIndices,isIndexed:!0},positions:{size:3,update:this.calculatePositions},colors:{size:3,update:this.calculateColors}}),t.getExtension("OES_element_index_uint"),this.setState({model:n})}},{key:"updateState",value:function(t){var e=t.props;t.changeFlags.dataChanged&&(this.countVertices(e.data),this.state.attributeManager.invalidateAll())}},{key:"getModel",value:function(t){return new f.Model(t,{id:this.props.id,vs:h.default,fs:d.default,geometry:new f.Geometry({id:this.props.id,drawMode:"LINES"}),vertexCount:0,isIndexed:!0,onBeforeRender:function(){t.enable(t.BLEND),t.enable(t.POLYGON_OFFSET_FILL),t.polygonOffset(2,1),t.blendFunc(t.SRC_ALPHA,t.ONE),t.blendEquation(t.FUNC_ADD)},onAfterRender:function(){t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),t.disable(t.POLYGON_OFFSET_FILL)}})}},{key:"countVertices",value:function(t){if(t){var e=this.props.getPath,n=0,r=t.reduce((function(t,r){var o=e(r).length;return n+=o,[].concat((0,i.default)(t),[o])}),[]);this.setState({pathLengths:r,vertexCount:n})}}},{key:"draw",value:function(t){var e=t.uniforms,n=this.props,i=n.trailLength,o=n.currentTime;this.state.model.render((0,r.default)({},e,{trailLength:i,currentTime:o}))}},{key:"calculateIndices",value:function(t){for(var e=this.state,n=e.pathLengths,r=2*(e.vertexCount-n.length),i=new Uint32Array(r),o=0,a=0,s=0;s<n.length;++s){var u=n[s];i[a++]=o;for(var c=1;c<u-1;++c)i[a++]=c+o,i[a++]=c+o;i[a++]=o+u-1,o+=u}t.value=i,this.state.model.setVertexCount(r)}},{key:"calculatePositions",value:function(t){for(var e=this.props,n=e.data,r=e.getPath,i=this.state.vertexCount,o=new Float32Array(3*i),a=0,s=0;s<n.length;++s)for(var u=r(n[s]),c=0;c<u.length;++c){var l=u[c];o[a++]=l[0],o[a++]=l[1],o[a++]=l[2]}t.value=o}},{key:"calculateColors",value:function(t){for(var e=this.props,n=e.data,r=e.getColor,i=this.state,o=i.pathLengths,a=i.vertexCount,s=new Float32Array(3*a),u=0,c=0;c<n.length;++c)for(var l=r(n[c]),f=o[c],h=0;h<f;++h)s[u++]=l[0],s[u++]=l[1],s[u++]=l[2];t.value=s}}]),e}(l.Layer);e.default=g,g.layerName="TripsLayer",g.defaultProps={trailLength:120,currentTime:0,getPath:function(t){return t.path},getColor:function(t){return t.color}}},function(t,e,n){"use strict";e.__esModule=!0;var r,i=n(384),o=(r=i)&&r.__esModule?r:{default:r};e.default=function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return(0,o.default)(t)}},function(t,e,n){t.exports={default:n(385),__esModule:!0}},function(t,e,n){n(111),n(386),t.exports=n(38).Array.from},function(t,e,n){"use strict";var r=n(141),i=n(60),o=n(81),a=n(387),s=n(388),u=n(199),c=n(389),l=n(206);i(i.S+i.F*!n(390)((function(t){Array.from(t)})),"Array",{from:function(t){var e,n,i,f,h=o(t),d="function"==typeof this?this:Array,p=arguments.length,g=p>1?arguments[1]:void 0,v=void 0!==g,y=0,m=l(h);if(v&&(g=r(g,p>2?arguments[2]:void 0,2)),null==m||d==Array&&s(m))for(n=new d(e=u(h.length));e>y;y++)c(n,y,v?g(h[y],y):h[y]);else for(f=m.call(h),n=new d;!(i=f.next()).done;y++)c(n,y,v?a(f,g,[i.value,y],!0):i.value);return n.length=y,n}})},function(t,e,n){var r=n(69);t.exports=function(t,e,n,i){try{return i?e(r(n)[0],n[1]):e(n)}catch(e){var o=t.return;throw void 0!==o&&r(o.call(t)),e}}},function(t,e,n){var r=n(82),i=n(52)("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(r.Array===t||o[i]===t)}},function(t,e,n){"use strict";var r=n(63),i=n(89);t.exports=function(t,e,n){e in t?r.f(t,e,i(0,n)):t[e]=n}},function(t,e,n){var r=n(52)("iterator"),i=!1;try{var o=[7][r]();o.return=function(){i=!0},Array.from(o,(function(){throw 2}))}catch(t){}t.exports=function(t,e){if(!e&&!i)return!1;var n=!1;try{var o=[7],a=o[r]();a.next=function(){return{done:n=!0}},o[r]=function(){return a},t(o)}catch(t){}return n}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default="#define SHADER_NAME trips-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 colors;\n\nuniform float opacity;\nuniform float currentTime;\nuniform float trailLength;\n\nvarying float vTime;\nvarying vec4 vColor;\n\nvoid main(void) {\n  vec2 p = project_position(positions.xy);\n  // the magic de-flickering factor\n  vec4 shift = vec4(0., 0., mod(positions.z, trailLength) * 1e-4, 0.);\n\n  gl_Position = project_to_clipspace(vec4(p, 1., 1.)) + shift;\n\n  vColor = vec4(colors / 255.0, opacity);\n  vTime = 1.0 - (currentTime - positions.z) / trailLength;\n}\n"},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default="#define SHADER_NAME trips-layer-fragment-shader\n\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nvarying float vTime;\nvarying vec4 vColor;\n\nvoid main(void) {\n  if (vTime > 1.0 || vTime < 0.0) {\n    discard;\n  }\n  gl_FragColor = vec4(vColor.rgb, vColor.a * vTime);\n}\n"},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=h(n(31)),i=h(n(32)),o=h(n(33)),a=h(n(34)),s=h(n(35)),u=(h(n(23)),h(n(40))),c=n(42),l=h(n(51)),f=h(n(157));function h(t){return t&&t.__esModule?t:{default:t}}var d=function(t){function e(){return(0,i.default)(this,e),(0,a.default)(this,(e.__proto__||(0,r.default)(e)).apply(this,arguments))}return(0,s.default)(e,t),(0,o.default)(e,[{key:"getLayerGL",value:function(t){var e=[];return t.data&&t.data.features&&t.data.features.map((function(n){e=f.default.union(e.concat(n.properties[t.labelKey].split("")))})),new c.TextLayer({id:this.layerId,pickable:t.pickable,data:t.data&&t.data.features||[],visible:t.visible,getPosition:function(t){return t.geometry.coordinates},getText:function(e){return e.properties[t.labelKey]},getSize:t.getSize,getAngle:t.getAngle,getTextAnchor:t.getTextAnchor,getAlignmentBaseline:t.getAlignmentBaseline,getColor:t.getColor,characterSet:e,opacity:t.opacity,getPixelOffset:t.getPixelOffset})}}]),e}(l.default);d.propTypes={labelKey:u.default.string},d.defaultProps={getColor:[255,255,255,255],getSize:14,getAngle:0,getTextAnchor:"middle",getAlignmentBaseline:"center",opacity:1,pickable:!0,getPixelOffset:[0,0],visible:!0},e.default=d},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=c(n(31)),i=c(n(32)),o=c(n(33)),a=c(n(34)),s=c(n(35)),u=(c(n(23)),c(n(40)),c(n(395)));function c(t){return t&&t.__esModule?t:{default:t}}var l=function(t){function e(){return(0,i.default)(this,e),(0,a.default)(this,(e.__proto__||(0,r.default)(e)).apply(this,arguments))}return(0,s.default)(e,t),(0,o.default)(e,[{key:"getLayerGL",value:function(t){return new u.default({id:this.layerId,data:t.data&&t.data.features||[],iconAtlas:t.iconAtlas,iconMapping:t.iconMapping,sizeScale:t.sizeScale,pickable:t.pickable})}}]),e}(c(n(51)).default);l.defaultProps={sizeScale:10,pickable:!0},e.default=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=f(n(84)),i=f(n(31)),o=f(n(32)),a=f(n(33)),s=f(n(34)),u=f(n(35)),c=n(42),l=f(n(71));function f(t){return t&&t.__esModule?t:{default:t}}function h(t){return Math.min(100,t)/100+1}var d=function(t){function e(){return(0,o.default)(this,e),(0,s.default)(this,(e.__proto__||(0,i.default)(e)).apply(this,arguments))}return(0,u.default)(e,t),(0,a.default)(e,[{key:"initializeState",value:function(){this.setState({tree:(0,l.default)(9,[".x",".y",".x",".y"]),version:-1,z:-1,width:0,height:0})}},{key:"shouldUpdateState",value:function(t){return t.changeFlags.somethingChanged}},{key:"updateState",value:function(t){var e=t.props,n=t.oldProps,r=t.changeFlags,i=this.context.viewport,o=i.width,a=i.height;if(r.dataChanged||e.sizeScale!==n.sizeScale||this.state.width!==o||this.state.height!==a){var s=this._updateCluster(e,i);this.setState({version:s,width:o,height:a})}this.setState({z:Math.floor(i.zoom)})}},{key:"renderLayers",value:function(){var t=this.state,e=t.z,n=t.version,r=this.props,i=r.data,o=r.iconAtlas,a=r.iconMapping,s=r.sizeScale,u=r.onHoverObject,l=r.onClickObject;return new c.IconLayer(this.getSubLayerProps({id:"icon",data:i,iconAtlas:o,iconMapping:a,sizeScale:s,getPosition:function(t){return t.geometry.coordinates},getIcon:function(t){return t.zoomLevels[e]&&t.zoomLevels[e].icon},getSize:function(t){return t.zoomLevels[e]&&t.zoomLevels[e].size},onHover:u,onClick:l,updateTriggers:{getIcon:{version:n,z:e},getSize:{version:n,z:e}}}))}},{key:"_updateCluster",value:function(t,e){var n=t.data,i=t.sizeScale,o=this.state,a=o.tree,s=o.version;if(!n)return s;var u=new c.WebMercatorViewport((0,r.default)({},e,{zoom:0}));n.forEach((function(t){var e=u.project(t.geometry.coordinates);t.x=e[0],t.y=e[1],t.zoomLevels=[]})),a.clear(),a.load(n);for(var l=function(t){var e=i/Math.sqrt(2)/Math.pow(2,t);n.forEach((function(n){if(void 0===n.zoomLevels[t]){var r=n.x,i=n.y,o=a.search({minX:r-e,minY:i-e,maxX:r+e,maxY:i+e}).filter((function(e){return void 0===e.zoomLevels[t]}));o.forEach((function(e){var r;e===n?n.zoomLevels[t]={icon:(r=o.length,0===r?"":r<10?"marker-"+r:r<100?"marker-"+Math.floor(r/10)+"0":"marker-100"),size:h(o.length),points:o}:e.zoomLevels[t]=null}))}}))},f=0;f<=20;f++)l(f);return s+1}}]),e}(c.CompositeLayer);e.default=d},function(t,e,n){t.exports=function(){"use strict";function t(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function e(t,e){return t<e?-1:t>e?1:0}return function(n,r,i,o,a){!function e(n,r,i,o,a){for(;o>i;){if(o-i>600){var s=o-i+1,u=r-i+1,c=Math.log(s),l=.5*Math.exp(2*c/3),f=.5*Math.sqrt(c*l*(s-l)/s)*(u-s/2<0?-1:1),h=Math.max(i,Math.floor(r-u*l/s+f)),d=Math.min(o,Math.floor(r+(s-u)*l/s+f));e(n,r,h,d,a)}var p=n[r],g=i,v=o;for(t(n,i,r),a(n[o],p)>0&&t(n,i,o);g<v;){for(t(n,g,v),g++,v--;a(n[g],p)<0;)g++;for(;a(n[v],p)>0;)v--}0===a(n[i],p)?t(n,i,v):(v++,t(n,v,o)),v<=r&&(i=v+1),r<=v&&(o=v-1)}}(n,r,i||0,o||n.length-1,a||e)}}()},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var r=d(n(398)),i=d(n(156)),o=d(n(31)),a=d(n(32)),s=d(n(33)),u=d(n(34)),c=d(n(35)),l=n(23),f=(d(l),d(n(40))),h=d(n(400));function d(t){return t&&t.__esModule?t:{default:t}}n(158),n(405);var p=function(e){function n(t){(0,a.default)(this,n);var e=(0,u.default)(this,(n.__proto__||(0,o.default)(n)).call(this,t));if(e.createClusterIcon=function(t,n){var r=e.props,i=r.customMarker,o=r.customClusterMarker;return t.properties&&t.properties.cluster?o(t,n):i(t,n)},e._map=e.props.map||e.context&&e.context.map,!e._map)throw new Error("Map instance is required");var r=e.props.data;if(!r||!r.features||0===r.features.length)throw new Error("Data or Features are empty");return e.reIndexKeys=["radius","extent","nodeSize","data","maxZoom","minZoom"],e.needReset=!1,e._initMapEvent(),e._optimizeIndex(),e}return(0,c.default)(n,e),(0,s.default)(n,[{key:"_initMapEvent",value:function(){this._map.on("moveend",this._onMapMoveend,this)}},{key:"_removeMapEvent",value:function(){this._map.off("moveend",this._onMapMoveend,this)}},{key:"_getClusterData",value:function(){var t=this._map,e=t.getBounds(),n=t.getZoom();return this._index.getClusters([e.getWest(),e.getSouth(),e.getEast(),e.getNorth()],n)}},{key:"_onMapMoveend",value:function(t){var e=this._getClusterData();this._markers.clearLayers(),this._markers.addData(e)}},{key:"componentWillUnmount",value:function(){this._removeMapEvent()}},{key:"componentWillUpdate",value:function(t,e){var n=!0,r=!1,o=void 0;try{for(var a,s=(0,i.default)(this.reIndexKeys);!(n=(a=s.next()).done);n=!0){var u=a.value;if(t[u]!==this.props[u])return this._optimizeIndex(t)}}catch(t){r=!0,o=t}finally{try{!n&&s.return&&s.return()}finally{if(r)throw o}}}},{key:"_optimizeIndex",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props,e=t.radius,n=t.extent,r=t.data,i=t.nodeSize,o=t.initialCluster,a=t.mapCluster,s=t.reduceCluster,u=this._map.getZoom();this._index=(0,h.default)({log:!1,radius:e,extent:n,maxZoom:u,minZoom:u,nodeSize:i,initial:o,map:a,reduce:s}).load(r.features),this.needReset=!0}},{key:"_resetIndex",value:function(){var t=this.props,e=t.radius,n=t.extent,r=t.maxZoom,i=t.minZoom,o=t.data,a=t.nodeSize,s=t.initialCluster,u=t.mapCluster,c=t.reduceCluster;this._index=(0,h.default)({log:!1,radius:e,extent:n,maxZoom:r,minZoom:i,nodeSize:a,initial:s,map:u,reduce:c}).load(o.features),this.needReset=!1}},{key:"componentDidMount",value:function(){var e=this;t.nextTick((function(){return e._resetIndex()}))}},{key:"componentDidUpdate",value:function(e){var n=this;!0===this.needReset&&t.nextTick((function(){return n._resetIndex()}))}},{key:"render",value:function(){return this.props.visible?(this._markers&&this._markers.remove(),this._markers=L.geoJson(this._getClusterData(),{pointToLayer:this.createClusterIcon}).addTo(this._map),null):null}}]),n}(l.Component);p.propTypes={radius:f.default.number,visible:f.default.bool,extent:f.default.number,nodeSize:f.default.number,minZoom:f.default.number,maxZoom:f.default.number,data:f.default.object.isRequired,customMarker:f.default.func,customClusterMarker:f.default.func,map:f.default.any,initialCluster:f.default.func,reduceCluster:f.default.func,mapCluster:f.default.func},p.defaultProps={radius:80,visible:!0,extent:256,maxZoom:16,minZoom:0,nodeSize:64,customMarker:function(t,e){return L.marker(e)},customClusterMarker:function(t,e){var n=t.properties.point_count,i=n<100?"small":n<1e3?"medium":"large",o=L.divIcon({html:"<div><span>"+t.properties.point_count_abbreviated+"</span></div>",className:"marker-cluster marker-cluster-"+i,iconSize:L.point(40,40)}),a=L.marker(e,{icon:o});return a.bindPopup((0,r.default)(t.properties)),a},hasDataReleatedChange:!1},e.default=p}).call(this,n(61))},function(t,e,n){t.exports={default:n(399),__esModule:!0}},function(t,e,n){var r=n(38),i=r.JSON||(r.JSON={stringify:JSON.stringify});t.exports=function(t){return i.stringify.apply(i,arguments)}},function(t,e,n){"use strict";var r=n(401);function i(t){return new o(t)}function o(t){this.options=f(Object.create(this.options),t),this.trees=new Array(this.options.maxZoom+1)}function a(t,e,n,r,i){return{x:t,y:e,zoom:1/0,id:n,parentId:-1,numPoints:r,properties:i}}function s(t){return{type:"Feature",properties:u(t),geometry:{type:"Point",coordinates:[(r=t.x,360*(r-.5)),(e=t.y,n=(180-360*e)*Math.PI/180,360*Math.atan(Math.exp(n))/Math.PI-90)]}};var e,n,r}function u(t){var e=t.numPoints,n=e>=1e4?Math.round(e/1e3)+"k":e>=1e3?Math.round(e/100)/10+"k":e;return f(f({},t.properties),{cluster:!0,cluster_id:t.id,point_count:e,point_count_abbreviated:n})}function c(t){return t/360+.5}function l(t){var e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function f(t,e){for(var n in e)t[n]=e[n];return t}function h(t){return t.x}function d(t){return t.y}t.exports=i,t.exports.default=i,o.prototype={options:{minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,reduce:null,initial:function(){return{}},map:function(t){return t}},load:function(t){var e=this.options.log;e&&console.time("total time");var n="prepare "+t.length+" points";e&&console.time(n),this.points=t;for(var i,o,a,s=[],u=0;u<t.length;u++)t[u].geometry&&s.push((i=t[u],o=u,a=void 0,{x:c((a=i.geometry.coordinates)[0]),y:l(a[1]),zoom:1/0,id:o,parentId:-1}));this.trees[this.options.maxZoom+1]=r(s,h,d,this.options.nodeSize,Float32Array),e&&console.timeEnd(n);for(var f=this.options.maxZoom;f>=this.options.minZoom;f--){var p=+Date.now();s=this._cluster(s,f),this.trees[f]=r(s,h,d,this.options.nodeSize,Float32Array),e&&console.log("z%d: %d clusters in %dms",f,s.length,+Date.now()-p)}return e&&console.timeEnd("total time"),this},getClusters:function(t,e){var n=((t[0]+180)%360+360)%360-180,r=Math.max(-90,Math.min(90,t[1])),i=((t[2]+180)%360+360)%360-180,o=Math.max(-90,Math.min(90,t[3]));if(t[0]>t[2]){var a=this.getClusters([n,r,180,o],e),u=this.getClusters([-180,r,i,o],e);return a.concat(u)}for(var f=this.trees[this._limitZoom(e)],h=f.range(c(n),l(o),c(i),l(r)),d=[],p=0;p<h.length;p++){var g=f.points[h[p]];d.push(g.numPoints?s(g):this.points[g.id])}return d},getChildren:function(t){var e=t>>5,n=t%32,r="No cluster with the specified id.",i=this.trees[n];if(!i)throw new Error(r);var o=i.points[e];if(!o)throw new Error(r);for(var a=this.options.radius/(this.options.extent*Math.pow(2,n-1)),u=i.within(o.x,o.y,a),c=[],l=0;l<u.length;l++){var f=i.points[u[l]];f.parentId===t&&c.push(f.numPoints?s(f):this.points[f.id])}if(0===c.length)throw new Error(r);return c},getLeaves:function(t,e,n){e=e||10,n=n||0;var r=[];return this._appendLeaves(r,t,e,n,0),r},getTile:function(t,e,n){var r=this.trees[this._limitZoom(t)],i=Math.pow(2,t),o=this.options.extent,a=this.options.radius/o,s=(n-a)/i,u=(n+1+a)/i,c={features:[]};return this._addTileFeatures(r.range((e-a)/i,s,(e+1+a)/i,u),r.points,e,n,i,c),0===e&&this._addTileFeatures(r.range(1-a/i,s,1,u),r.points,i,n,i,c),e===i-1&&this._addTileFeatures(r.range(0,s,a/i,u),r.points,-1,n,i,c),c.features.length?c:null},getClusterExpansionZoom:function(t){for(var e=t%32-1;e<this.options.maxZoom;){var n=this.getChildren(t);if(e++,1!==n.length)break;t=n[0].properties.cluster_id}return e},_appendLeaves:function(t,e,n,r,i){for(var o=this.getChildren(e),a=0;a<o.length;a++){var s=o[a].properties;if(s&&s.cluster?i+s.point_count<=r?i+=s.point_count:i=this._appendLeaves(t,s.cluster_id,n,r,i):i<r?i++:t.push(o[a]),t.length===n)break}return i},_addTileFeatures:function(t,e,n,r,i,o){for(var a=0;a<t.length;a++){var s=e[t[a]];o.features.push({type:1,geometry:[[Math.round(this.options.extent*(s.x*i-n)),Math.round(this.options.extent*(s.y*i-r))]],tags:s.numPoints?u(s):this.points[s.id].properties})}},_limitZoom:function(t){return Math.max(this.options.minZoom,Math.min(t,this.options.maxZoom+1))},_cluster:function(t,e){for(var n=[],r=this.options.radius/(this.options.extent*Math.pow(2,e)),i=0;i<t.length;i++){var o=t[i];if(!(o.zoom<=e)){o.zoom=e;var s=this.trees[e+1],u=s.within(o.x,o.y,r),c=o.numPoints||1,l=o.x*c,f=o.y*c,h=null;this.options.reduce&&(h=this.options.initial(),this._accumulate(h,o));for(var d=(i<<5)+(e+1),p=0;p<u.length;p++){var g=s.points[u[p]];if(!(g.zoom<=e)){g.zoom=e;var v=g.numPoints||1;l+=g.x*v,f+=g.y*v,c+=v,g.parentId=d,this.options.reduce&&this._accumulate(h,g)}}1===c?n.push(o):(o.parentId=d,n.push(a(l/c,f/c,d,c,h)))}}return n},_accumulate:function(t,e){var n=e.numPoints?e.properties:this.options.map(this.points[e.id].properties);this.options.reduce(t,n)}}},function(t,e,n){"use strict";var r=n(402),i=n(403),o=n(404);function a(t,e,n,i,o){e=e||s,n=n||u,o=o||Array,this.nodeSize=i||64,this.points=t,this.ids=new o(t.length),this.coords=new o(2*t.length);for(var a=0;a<t.length;a++)this.ids[a]=a,this.coords[2*a]=e(t[a]),this.coords[2*a+1]=n(t[a]);r(this.ids,this.coords,this.nodeSize,0,this.ids.length-1,0)}function s(t){return t[0]}function u(t){return t[1]}t.exports=function(t,e,n,r,i){return new a(t,e,n,r,i)},a.prototype={range:function(t,e,n,r){return i(this.ids,this.coords,t,e,n,r,this.nodeSize)},within:function(t,e,n){return o(this.ids,this.coords,t,e,n,this.nodeSize)}}},function(t,e,n){"use strict";function r(t,e,n,r){i(t,n,r),i(e,2*n,2*r),i(e,2*n+1,2*r+1)}function i(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}t.exports=function t(e,n,i,o,a,s){if(a-o<=i)return;var u=Math.floor((o+a)/2);(function t(e,n,i,o,a,s){for(;a>o;){if(a-o>600){var u=a-o+1,c=i-o+1,l=Math.log(u),f=.5*Math.exp(2*l/3),h=.5*Math.sqrt(l*f*(u-f)/u)*(c-u/2<0?-1:1),d=Math.max(o,Math.floor(i-c*f/u+h)),p=Math.min(a,Math.floor(i+(u-c)*f/u+h));t(e,n,i,d,p,s)}var g=n[2*i+s],v=o,y=a;for(r(e,n,o,i),n[2*a+s]>g&&r(e,n,o,a);v<y;){for(r(e,n,v,y),v++,y--;n[2*v+s]<g;)v++;for(;n[2*y+s]>g;)y--}n[2*o+s]===g?r(e,n,o,y):(y++,r(e,n,y,a)),y<=i&&(o=y+1),i<=y&&(a=y-1)}})(e,n,u,o,a,s%2),t(e,n,i,o,u-1,s+1),t(e,n,i,u+1,a,s+1)}},function(t,e,n){"use strict";t.exports=function(t,e,n,r,i,o,a){var s,u,c=[0,t.length-1,0],l=[];for(;c.length;){var f=c.pop(),h=c.pop(),d=c.pop();if(h-d<=a)for(var p=d;p<=h;p++)s=e[2*p],u=e[2*p+1],s>=n&&s<=i&&u>=r&&u<=o&&l.push(t[p]);else{var g=Math.floor((d+h)/2);s=e[2*g],u=e[2*g+1],s>=n&&s<=i&&u>=r&&u<=o&&l.push(t[g]);var v=(f+1)%2;(0===f?n<=s:r<=u)&&(c.push(d),c.push(g-1),c.push(v)),(0===f?i>=s:o>=u)&&(c.push(g+1),c.push(h),c.push(v))}}return l}},function(t,e,n){"use strict";function r(t,e,n,r){var i=t-n,o=e-r;return i*i+o*o}t.exports=function(t,e,n,i,o,a){var s=[0,t.length-1,0],u=[],c=o*o;for(;s.length;){var l=s.pop(),f=s.pop(),h=s.pop();if(f-h<=a)for(var d=h;d<=f;d++)r(e[2*d],e[2*d+1],n,i)<=c&&u.push(t[d]);else{var p=Math.floor((h+f)/2),g=e[2*p],v=e[2*p+1];r(g,v,n,i)<=c&&u.push(t[p]);var y=(l+1)%2;(0===l?n-o<=g:i-o<=v)&&(s.push(h),s.push(p-1),s.push(y)),(0===l?n+o>=g:i+o>=v)&&(s.push(p+1),s.push(f),s.push(y))}}return u}},function(t,e,n){},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=c(n(31)),i=c(n(32)),o=c(n(33)),a=c(n(34)),s=c(n(35)),u=(c(n(23)),c(n(40)),n(42));function c(t){return t&&t.__esModule?t:{default:t}}var l=function(t){function e(){return(0,i.default)(this,e),(0,a.default)(this,(e.__proto__||(0,r.default)(e)).apply(this,arguments))}return(0,s.default)(e,t),(0,o.default)(e,[{key:"getLayerGL",value:function(t){return new u.ArcLayer({id:this.layerId,data:t.data&&t.data.features||[],pickable:t.pickable,getSourcePosition:function(t){return t.geometry.coordinates[0]},getTargetPosition:function(t){return t.geometry.coordinates[1]},getSourceColor:function(e){var n=t.getSourceColor;return n&&"function"==typeof n?n(e):t.getSourceColor},getTargetColor:function(e){var n=t.getTargetColor;return n&&"function"==typeof n?n(e):t.getTargetColor},strokeWidth:t.strokeWidth})}}]),e}(c(n(51)).default);l.defaultProps={strokeWidth:1,getSourceColor:[255,255,204],getTargetColor:[255,255,178],pickable:!0},e.default=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=f(n(31)),i=f(n(32)),o=f(n(33)),a=f(n(34)),s=f(n(35)),u=n(23),c=f(u),l=f(n(204));function f(t){return t&&t.__esModule?t:{default:t}}var h=0,d=function(t){function e(t){(0,i.default)(this,e);var n=(0,a.default)(this,(e.__proto__||(0,r.default)(e)).call(this,t));return n.layerId=n.props.id||"gas-layer-gl-"+h++,n._map=n.props.map,n}return(0,s.default)(e,t),(0,o.default)(e,[{key:"componentWillUnmount",value:function(){l.default.unregister(this.layerId),this._removeMapEvent()}},{key:"componentDidMount",value:function(){this.props.lnglat&&this.props.width&&this.props.height&&(this.registerToLayerDB(),this._initMapEvent())}},{key:"registerToLayerDB",value:function(){l.default.register(this.layerId,this)}},{key:"debounceFunc",value:function(t,e){this.timeoutId&&clearTimeout(this.timeoutId),this.timeoutId=setTimeout(t,e)}},{key:"_initMapEvent",value:function(){l.default.on("mapresize",this._onMapResize,this),l.default.on("mapmovestart",this._onMapMovestart,this),l.default.on("mapmove",this._onMapMove,this),l.default.on("mapmoveend",this._onMapMoveend,this),l.default.on("mapzoomstart",this._onZoomstart,this),l.default.on("mapzoomend",this._onZoomend,this),l.default.on("mapzoomanim",this._onZoomAnim,this)}},{key:"_removeMapEvent",value:function(){l.default.removeListener("mapresize",this._onMapResize,this),l.default.removeListener("mapmovestart",this._onMapMovestart,this),l.default.removeListener("mapmove",this._onMapMove,this),l.default.removeListener("mapmoveend",this._onMapMoveend,this),l.default.removeListener("mapzoomstart",this._onZoomstart,this),l.default.removeListener("mapzoomend",this._onZoomend,this),l.default.removeListener("mapzoomanim",this._onZoomAnim,this)}},{key:"_onMapMovestart",value:function(){0}},{key:"_onMapMove",value:function(t){this.forceUpdate()}},{key:"_onMapMoveend",value:function(t){0}},{key:"__onMapZoomAnimateAction",value:function(t){this.forceUpdate()}},{key:"_onZoomAnim",value:function(t){return this.hasZoom=!0,this.__onMapZoomAnimateAction(t)}},{key:"_onZoomstart",value:function(t){}},{key:"_onZoomend",value:function(t){}},{key:"__onMapResizeAction",value:function(t){this.forceUpdate()}},{key:"_onMapResize",value:function(t){var e=this.props.debounceTime,n=void 0===e?100:e;return n?this.debounceFunc(this.__onMapResizeAction.bind(this,t),n):this.__onMapResizeAction(t)}},{key:"render",value:function(){var t=this.props,e=(t.id,t.lnglat),n=t.width,r=t.height,i=t.map.latLngToContainerPoint([e[1],e[0]]),o=i.x,a=i.y;return c.default.createElement("div",{id:this.layerId,style:{position:"absolute",zIndex:999,left:o-n/2,top:a-r/2}},this.props.children)}}]),e}(u.Component);e.default=d},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=v(n(108)),i=v(n(84)),o=v(n(31)),a=v(n(32)),s=v(n(33)),u=v(n(34)),c=v(n(35)),l=(v(n(23)),v(n(40))),f=n(42),h=v(n(51)),d=n(55),p=v(n(552)),g=n(11);function v(t){return t&&t.__esModule?t:{default:t}}var y=function(t){function e(){var t,n,r,i;(0,a.default)(this,e);for(var s=arguments.length,c=Array(s),l=0;l<s;l++)c[l]=arguments[l];return n=r=(0,u.default)(this,(t=e.__proto__||(0,o.default)(e)).call.apply(t,[this].concat(c))),r.arrowDatas={type:"FeatureCollection",features:[]},i=n,(0,u.default)(r,i)}return(0,c.default)(e,t),(0,s.default)(e,[{key:"computeLineAngle",value:function(t,e){var n=(0,g.point)(t),r=(0,g.point)(e),i=(0,p.default)(n,r);return i>0?360-i:-i}},{key:"getArrowDatas",value:function(t,e){var n=this,r={type:"FeatureCollection",features:[]};return t.features.map((function(t){var o=t.geometry.coordinates[t.geometry.coordinates.length-2],a=t.geometry.coordinates[t.geometry.coordinates.length-1],s=n.computeLineAngle(o,a);if(r.features.push({type:"Feature",geometry:{type:"Point",coordinates:a},properties:(0,i.default)({},t.properties,{angle:s})}),e.setStartArrow&&"function"==typeof e.setStartArrow&&e.setStartArrow(t)){var u=t.geometry.coordinates[1],c=t.geometry.coordinates[0],l=n.computeLineAngle(u,c);r.features.push({type:"Feature",geometry:{type:"Point",coordinates:c},properties:(0,i.default)({},t.properties,{angle:l})})}})),r}},{key:"getLayerGL",value:function(t){var e=this.getArrowDatas(t.data,t);return[new f.PathLayer({id:this.layerId+"-path",data:t.data&&t.data.features?t.data.features:[],redraw:t.redraw,extruded:!0,fp64:t.fp64,miterLimit:t.miterLimit,coordinateSystem:t.coordinateSystem,coordinateOrigin:t.coordinateOrigin,widthScale:t.widthScale,widthMinPixels:t.widthMinPixels,widthMaxPixels:t.widthMaxPixels,pickable:t.pickable,opacity:t.opacity,visible:t.visible,lineWidthMaxPixels:t.lineWidthMaxPixels,lineWidthMinPixels:t.lineWidthMinPixels,rounded:t.rounded,autoHighlight:t.autoHighlight,highlightColor:t.highlightColor,getDashArray:t.getDashArray,dashJustified:t.dashJustified,getColor:function(e){var n=t.setLineColor;if(n&&"function"==typeof n)return n(e);var r=null==t.getValue?e.properties[t.valueName||"value"]:t.getValue(e);return(0,d.getScale)(r||void 0,t.stroke)},getWidth:function(e){var n=t.setLineWidth;return n&&"function"==typeof n?n(e):t.strokeWidth},getPath:function(t){return t.geometry.coordinates},updateTriggers:{getColor:[t.setLineColor,t.stroke,t.valueName,t.stroke.range,t.stroke.domain],getWidth:t.strokeWidth,widthScale:t.widthScale,getDashArray:t.getDashArray,dashJustified:t.dashJustified}}),new f.IconLayer({id:this.layerId+"-arrow",data:e.features||[],pickable:t.pickable,iconAtlas:t.iconAtlas,iconMapping:t.iconMapping||{marker:{x:0,y:0,width:128,height:128,mask:!1}},sizeScale:t.sizeScale||5,visible:t.visible,getAngle:function(t){return t.properties.angle||0},opacity:t.opacity,getPosition:function(t){return t.geometry.coordinates},getIcon:function(t){return"marker"},getColor:function(e){var n=t.setLineColor;if(n&&"function"==typeof n)return n(e);var r=null==t.getValue?e.properties[t.valueName||"value"]:t.getValue(e);return(0,d.getScale)(r||void 0,t.stroke)},getSize:t.size||5})]}}]),e}(h.default);y.propTypes={strokeWidth:l.default.number.isRequired,setLineColor:l.default.func,lineWidthMinPixels:l.default.number,lineWidthMaxPixels:l.default.number,valueName:l.default.string,stroke:l.default.oneOfType([l.default.array,l.default.object]),getValue:l.default.func,rounded:l.default.bool,fp64:l.default.bool,widthScale:l.default.number,widthMinPixels:l.default.number,widthMaxPixels:l.default.number,miterLimit:l.default.number},y.defaultProps={lineWidthMinPixels:10,lineWidthMaxPixels:10,rounded:!1,redraw:!0,visible:!0,opacity:1,pickable:!0,fp64:!1,widthScale:1,widthMinPixels:0,widthMaxPixels:r.default,miterLimit:4,autoHighlight:!1,highlightColor:[255,255,255,255],strokeWidth:10,dashJustified:!1,getDashArray:null,timeInterval:800,loop:!1,animate:!1,stroke:[255,255,255,255]},e.default=y},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=h(n(31)),i=h(n(32)),o=h(n(33)),a=h(n(34)),s=h(n(35)),u=(h(n(23)),h(n(40))),c=n(42),l=h(n(51)),f=n(55);function h(t){return t&&t.__esModule?t:{default:t}}var d=n(410),p=function(t){function e(){var t,n,o,s;(0,i.default)(this,e);for(var u=arguments.length,c=Array(u),l=0;l<u;l++)c[l]=arguments[l];return n=o=(0,a.default)(this,(t=e.__proto__||(0,r.default)(e)).call.apply(t,[this].concat(c))),o.curIndex=1,o.meshPois=null,s=n,(0,a.default)(o,s)}return(0,s.default)(e,t),(0,o.default)(e,[{key:"computeMeshData",value:function(t){var e=this;return this.meshPois={type:"FeatureCollection",features:[]},t.features.map((function(t){for(var n=t.geometry.coordinates,r=function(t){var r=n[t],i=n[t+1],o=d.lineString([r,i]),a=d.lineChunk(o,e.props.iconGap,"kilometers"),s=d.bearing(d.point(r),d.point(i));a.features.map((function(t,n){n!==a.features.length-1&&e.meshPois.features.push({type:"Feature",geometry:{type:"Point",coordinates:t.geometry.coordinates[1]},properties:{angle:s}})}))},i=0;i<n.length-1;i++)r(i)})),this.meshPois}},{key:"getLayerGL",value:function(t,e){var n=this.meshPois?this.meshPois.features:this.computeMeshData(t.data).features;return[new c.PathLayer({id:this.layerId,data:t.data&&t.data.features||[],redraw:t.redraw,extruded:!0,fp64:t.fp64,miterLimit:t.miterLimit,coordinateSystem:t.coordinateSystem,coordinateOrigin:t.coordinateOrigin,widthScale:t.widthScale,pickable:t.pickable,opacity:t.opacity,visible:t.visible,rounded:t.rounded,widthUnits:t.widthUnits,autoHighlight:t.autoHighlight,highlightColor:t.highlightColor,getDashArray:t.getDashArray,dashJustified:t.dashJustified,getColor:function(e){var n=t.setLineColor;if(n&&"function"==typeof n)return n(e);var r=null==t.getValue?e.properties&&e.properties[t.valueName]||void 0:t.getValue(e);return(0,f.getScale)(r||void 0,t.stroke)},getWidth:function(e){var n=t.setLineWidth;return n&&"function"==typeof n?n(e):t.strokeWidth},getPath:function(t){return t.geometry.coordinates},updateTriggers:{getColor:[t.setLineColor,t.stroke,t.valueName,t.stroke.range,t.stroke.domain],getWidth:t.strokeWidth,widthScale:t.widthScale,getDashArray:t.getDashArray,dashJustified:t.dashJustified}}),new c.IconLayer({id:this.layerId,data:n,sizeUnits:t.sizeUnits,pickable:t.pickable,iconAtlas:t.iconAtlas,iconMapping:t.iconMapping,sizeScale:t.sizeScale,redraw:t.redraw,visible:t.visible,sizeMinPixels:t.sizeMinPixels,getAngle:function(t){return t.properties.angle},opacity:t.opacity,getPosition:function(t){return t.geometry.coordinates},getColor:function(e){var n=t.setColor;if(n&&"function"==typeof n)return n(e);var r=null==t.getValue?e.properties[t.valueName||"value"]:t.getValue(e);return(0,f.getScale)(r||void 0,t.maskColor)},getIcon:function(e){var n=t.getIcon;return n&&"function"==typeof n?n(e):n},getSize:function(e){var n=t.setSize;return n&&"function"==typeof n?n(e):t.size},updateTriggers:{getColor:[t.setColor,t.maskColor,t.valueName,t.maskColor.range,t.maskColor.domain]}})]}}]),e}(l.default);p.propTypes={strokeWidth:u.default.number.isRequired,setLineColor:u.default.func,valueName:u.default.string,stroke:u.default.oneOfType([u.default.array,u.default.object]),getValue:u.default.func,rounded:u.default.bool,fp64:u.default.bool,widthMaxPixels:u.default.number,miterLimit:u.default.number},p.defaultProps={rounded:!0,visible:!0,opacity:1,pickable:!0,fp64:!1,widthScale:1,sizeMinPixels:0,miterLimit:4,autoHighlight:!1,highlightColor:[255,255,255,255],strokeWidth:5,dashJustified:!1,getDashArray:null,timeInterval:800,loop:!1,animate:!1,stroke:[255,255,255,255],valueName:"value",maskColor:[0,0,0,255],iconAtlas:null,iconMapping:null,sizeScale:1,size:5,iconLayerVisibleMinZoom:13,widthUnits:"meters",iconGap:.025},e.default=p},function(t,e,n){"use strict";n.r(e);var r=n(11);n.d(e,"helpers",(function(){return r})),n.d(e,"point",(function(){return r.point})),n.d(e,"polygon",(function(){return r.polygon})),n.d(e,"lineString",(function(){return r.lineString})),n.d(e,"multiPoint",(function(){return r.multiPoint})),n.d(e,"multiPolygon",(function(){return r.multiPolygon})),n.d(e,"multiLineString",(function(){return r.multiLineString})),n.d(e,"feature",(function(){return r.feature})),n.d(e,"geometry",(function(){return r.geometry})),n.d(e,"featureCollection",(function(){return r.featureCollection})),n.d(e,"geometryCollection",(function(){return r.geometryCollection})),n.d(e,"radiansToDistance",(function(){return r.radiansToDistance})),n.d(e,"distanceToRadians",(function(){return r.distanceToRadians})),n.d(e,"distanceToDegrees",(function(){return r.distanceToDegrees})),n.d(e,"radians2degrees",(function(){return r.radians2degrees})),n.d(e,"degrees2radians",(function(){return r.degrees2radians})),n.d(e,"round",(function(){return r.round})),n.d(e,"convertDistance",(function(){return r.convertDistance})),n.d(e,"convertArea",(function(){return r.convertArea})),n.d(e,"bearingToAngle",(function(){return r.bearingToAngle})),n.d(e,"isNumber",(function(){return r.isNumber}));var i=n(16);n.d(e,"invariant",(function(){return i})),n.d(e,"getCoord",(function(){return i.getCoord})),n.d(e,"getCoords",(function(){return i.getCoords})),n.d(e,"getGeom",(function(){return i.getGeom})),n.d(e,"getGeomType",(function(){return i.getGeomType})),n.d(e,"geojsonType",(function(){return i.geojsonType})),n.d(e,"featureOf",(function(){return i.featureOf})),n.d(e,"collectionOf",(function(){return i.collectionOf})),n.d(e,"containsNumber",(function(){return i.containsNumber}));var o=n(15);n.d(e,"meta",(function(){return o})),n.d(e,"coordEach",(function(){return o.coordEach})),n.d(e,"coordReduce",(function(){return o.coordReduce})),n.d(e,"propEach",(function(){return o.propEach})),n.d(e,"propReduce",(function(){return o.propReduce})),n.d(e,"featureEach",(function(){return o.featureEach})),n.d(e,"coordAll",(function(){return o.coordAll})),n.d(e,"geomEach",(function(){return o.geomEach})),n.d(e,"flattenEach",(function(){return o.flattenEach})),n.d(e,"flattenReduce",(function(){return o.flattenReduce})),n.d(e,"featureReduce",(function(){return o.featureReduce})),n.d(e,"geomReduce",(function(){return o.geomReduce})),n.d(e,"segmentEach",(function(){return o.segmentEach})),n.d(e,"segmentReduce",(function(){return o.segmentReduce})),n.d(e,"lineEach",(function(){return o.lineEach})),n.d(e,"lineReduce",(function(){return o.lineReduce}));var a=n(207);n.d(e,"isolines",(function(){return a}));var s=n(159);n.d(e,"convex",(function(){return s}));var u=n(209);n.d(e,"within",(function(){return u}));var c=n(210);n.d(e,"concave",(function(){return c}));var l=n(211);n.d(e,"difference",(function(){return l}));var f=n(213);n.d(e,"dissolve",(function(){return f}));var h=n(223);n.d(e,"collect",(function(){return h}));var d=n(224);n.d(e,"flip",(function(){return d}));var p=n(225);n.d(e,"simplify",(function(){return p}));var g=n(226);n.d(e,"bezier",(function(){return g}));var v=n(227);n.d(e,"tag",(function(){return v}));var y=n(228);n.d(e,"sample",(function(){return y}));var m=n(167);n.d(e,"envelope",(function(){return m}));var b=n(229);n.d(e,"square",(function(){return b}));var _=n(120);n.d(e,"circle",(function(){return _}));var x=n(230);n.d(e,"midpoint",(function(){return x}));var w=n(231);n.d(e,"buffer",(function(){return w}));var E=n(121);n.d(e,"center",(function(){return E}));var S=n(234);n.d(e,"centerOfMass",(function(){return S}));var O=n(85);n.d(e,"centroid",(function(){return O}));var P=n(235);n.d(e,"combine",(function(){return P}));var C=n(37);n.d(e,"distance",(function(){return C}));var M=n(122);n.d(e,"explode",(function(){return M}));var I=n(39);n.d(e,"bbox",(function(){return I}));var A=n(236);n.d(e,"tesselate",(function(){return A}));var T=n(168);n.d(e,"bboxPolygon",(function(){return T}));var N=n(46);n.d(e,"inside",(function(){return N}));var L=n(237);n.d(e,"intersect",(function(){return L}));var R=n(238);n.d(e,"nearest",(function(){return R}));var k=n(239);n.d(e,"planepoint",(function(){return k}));var j=n(240);n.d(e,"random",(function(){return j}));var F=n(161);n.d(e,"tin",(function(){return F}));var D=n(118);n.d(e,"union",(function(){return D}));var B=n(72);n.d(e,"bearing",(function(){return B}));var z=n(66);n.d(e,"destination",(function(){return z}));var V=n(241);n.d(e,"kinks",(function(){return V}));var G=n(242);n.d(e,"pointOnSurface",(function(){return G}));var U=n(162);n.d(e,"area",(function(){return U}));var W=n(243);n.d(e,"along",(function(){return W}));var q=n(169);n.d(e,"lineDistance",(function(){return q}));var X=n(244);n.d(e,"lineSlice",(function(){return X}));var H=n(170);n.d(e,"lineSliceAlong",(function(){return H}));var Y=n(94);n.d(e,"pointOnLine",(function(){return Y}));var Z=n(245);n.d(e,"pointGrid",(function(){return Z}));var K=n(171);n.d(e,"squareGrid",(function(){return K}));var J=n(246);n.d(e,"triangleGrid",(function(){return J}));var Q=n(247);n.d(e,"hexGrid",(function(){return Q}));var $=n(248);n.d(e,"idw",(function(){return $}));var tt=n(123);n.d(e,"truncate",(function(){return tt}));var et=n(172);n.d(e,"flatten",(function(){return et}));var nt=n(73);n.d(e,"lineIntersect",(function(){return nt}));var rt=n(249);n.d(e,"mask",(function(){return rt}));var it=n(250);n.d(e,"lineChunk",(function(){return it}));var ot=n(251);n.d(e,"unkinkPolygon",(function(){return ot}));var at=n(254);n.d(e,"greatCircle",(function(){return at}));var st=n(93);n.d(e,"lineSegment",(function(){return st}));var ut=n(255);n.d(e,"lineSplit",(function(){return ut}));var ct=n(173);n.d(e,"lineArc",(function(){return ct}));var lt=n(125);n.d(e,"polygonToLineString",(function(){return lt}));var ft=n(256);n.d(e,"lineStringToPolygon",(function(){return ft}));var ht=n(257);n.d(e,"bboxClip",(function(){return ht}));var dt=n(163);n.d(e,"lineOverlap",(function(){return dt}));var pt=n(258);n.d(e,"sector",(function(){return pt}));var gt=n(96);n.d(e,"rhumbBearing",(function(){return gt}));var vt=n(98);n.d(e,"rhumbDistance",(function(){return vt}));var yt=n(99);n.d(e,"rhumbDestination",(function(){return yt}));var mt=n(260);n.d(e,"polygonTangents",(function(){return mt}));var bt=n(261);n.d(e,"rewind",(function(){return bt}));var _t=n(262);n.d(e,"isobands",(function(){return _t}));var xt=n(264);n.d(e,"transformRotate",(function(){return xt}));var wt=n(265);n.d(e,"transformScale",(function(){return wt}));var Et=n(266);n.d(e,"transformTranslate",(function(){return Et}));var St=n(267);n.d(e,"lineOffset",(function(){return St}));var Ot=n(268);n.d(e,"polygonize",(function(){return Ot}));var Pt=n(270);n.d(e,"booleanDisjoint",(function(){return Pt}));var Ct=n(271);n.d(e,"booleanContains",(function(){return Ct}));var Mt=n(272);n.d(e,"booleanCrosses",(function(){return Mt}));var It=n(176);n.d(e,"booleanClockwise",(function(){return It}));var At=n(273);n.d(e,"booleanEqual",(function(){return At}));var Tt=n(274);n.d(e,"booleanWithin",(function(){return Tt}));var Nt=n(95);n.d(e,"clone",(function(){return Nt}));var Lt=n(119);n.d(e,"cleanCoords",(function(){return Lt}));var Rt=n(275);n.d(e,"pointToLineDistance",(function(){return Rt}))},function(t,e,n){var r=n(16),i=r.getCoords,o=n(15).featureEach;t.exports=function(t,e,n){r.collectionOf(t,"Point","input must contain Points"),e=e||"elevation";for(var a=function(t,e){var n={};return o(t,(function(t){var e=i(t)[1];n[e]||(n[e]=[]),n[e].push(t)})),Object.keys(n).map((function(t){return n[t].sort((function(t,e){return i(t)[0]-i(e)[0]}))})).sort((function(t,n){return e?i(t[0])[1]-i(n[0])[1]:i(n[0])[1]-i(t[0])[1]}))}(t,n),s=[],u=0;u<a.length;u++){for(var c=a[u],l=[],f=0;f<c.length;f++){var h=c[f];h.properties[e]?l.push(h.properties[e]):l.push(0)}s.push(l)}return s}},function(t,e,n){var r,i,o;
/*!
* @license GNU Affero General Public License.
* Copyright (c) 2015, 2015 Ronny Lorenz <ronny@tbi.univie.ac.at>
* v. 1.2.0
* https://github.com/RaumZeit/MarchingSquares.js
*/i=[n(413),n(414)],void 0===(o="function"==typeof(r=function(t,e){return{isoBands:"function"==typeof t?t:"object"==typeof t&&"function"==typeof t.isoBands?t.isoBands:null,isoContours:"function"==typeof e?e:"object"==typeof e&&"function"==typeof e.isoContours?e.isoContours:null}})?r.apply(e,i):r)||(t.exports=o)},function(t,e,n){var r,i;
/*!
* @license GNU Affero General Public License.
* Copyright (c) 2015, 2015 Ronny Lorenz <ronny@tbi.univie.ac.at>
* v. 1.2.0
* https://github.com/RaumZeit/MarchingSquares.js
*/i=function(){var t={successCallback:null,verbose:!1,polygons:!1},e={},n=[],r=[],i=[],o=[],a=[],s=[],u=[],c=[],l=[],f=[],h=[],d=[],p=[],g=[],v=[],y=[],m=[],b=[],_=[],x=[],w=[],E=[],S=[],O=[];u[85]=f[85]=-1,c[85]=h[85]=0,l[85]=d[85]=1,_[85]=E[85]=1,x[85]=S[85]=0,w[85]=O[85]=1,n[85]=o[85]=0,r[85]=a[85]=-1,i[85]=v[85]=0,y[85]=p[85]=0,m[85]=g[85]=1,s[85]=b[85]=1,E[1]=E[169]=0,S[1]=S[169]=-1,O[1]=O[169]=0,p[1]=p[169]=-1,g[1]=g[169]=0,v[1]=v[169]=0,f[4]=f[166]=0,h[4]=h[166]=-1,d[4]=d[166]=1,y[4]=y[166]=1,m[4]=m[166]=0,b[4]=b[166]=0,u[16]=u[154]=0,c[16]=c[154]=1,l[16]=l[154]=1,o[16]=o[154]=1,a[16]=a[154]=0,s[16]=s[154]=1,_[64]=_[106]=0,x[64]=x[106]=1,w[64]=w[106]=0,n[64]=n[106]=-1,r[64]=r[106]=0,i[64]=i[106]=1,_[2]=_[168]=0,x[2]=x[168]=-1,w[2]=w[168]=1,E[2]=E[168]=0,S[2]=S[168]=-1,O[2]=O[168]=0,p[2]=p[168]=-1,g[2]=g[168]=0,v[2]=v[168]=0,y[2]=y[168]=-1,m[2]=m[168]=0,b[2]=b[168]=1,u[8]=u[162]=0,c[8]=c[162]=-1,l[8]=l[162]=0,f[8]=f[162]=0,h[8]=h[162]=-1,d[8]=d[162]=1,p[8]=p[162]=1,g[8]=g[162]=0,v[8]=v[162]=1,y[8]=y[162]=1,m[8]=m[162]=0,b[8]=b[162]=0,u[32]=u[138]=0,c[32]=c[138]=1,l[32]=l[138]=1,f[32]=f[138]=0,h[32]=h[138]=1,d[32]=d[138]=0,n[32]=n[138]=1,r[32]=r[138]=0,i[32]=i[138]=0,o[32]=o[138]=1,a[32]=a[138]=0,s[32]=s[138]=1,E[128]=E[42]=0,S[128]=S[42]=1,O[128]=O[42]=1,_[128]=_[42]=0,x[128]=x[42]=1,w[128]=w[42]=0,n[128]=n[42]=-1,r[128]=r[42]=0,i[128]=i[42]=1,o[128]=o[42]=-1,a[128]=a[42]=0,s[128]=s[42]=0,f[5]=f[165]=-1,h[5]=h[165]=0,d[5]=d[165]=0,E[5]=E[165]=1,S[5]=S[165]=0,O[5]=O[165]=0,y[20]=y[150]=0,m[20]=m[150]=1,b[20]=b[150]=1,o[20]=o[150]=0,a[20]=a[150]=-1,s[20]=s[150]=1,u[80]=u[90]=-1,c[80]=c[90]=0,l[80]=l[90]=1,_[80]=_[90]=1,x[80]=x[90]=0,w[80]=w[90]=1,p[65]=p[105]=0,g[65]=g[105]=1,v[65]=v[105]=0,n[65]=n[105]=0,r[65]=r[105]=-1,i[65]=i[105]=0,u[160]=u[10]=-1,c[160]=c[10]=0,l[160]=l[10]=1,f[160]=f[10]=-1,h[160]=h[10]=0,d[160]=d[10]=0,E[160]=E[10]=1,S[160]=S[10]=0,O[160]=O[10]=0,_[160]=_[10]=1,x[160]=x[10]=0,w[160]=w[10]=1,y[130]=y[40]=0,m[130]=m[40]=1,b[130]=b[40]=1,p[130]=p[40]=0,g[130]=g[40]=1,v[130]=v[40]=0,n[130]=n[40]=0,r[130]=r[40]=-1,i[130]=i[40]=0,o[130]=o[40]=0,a[130]=a[40]=-1,s[130]=s[40]=1,f[37]=f[133]=0,h[37]=h[133]=1,d[37]=d[133]=1,E[37]=E[133]=0,S[37]=S[133]=1,O[37]=O[133]=0,n[37]=n[133]=-1,r[37]=r[133]=0,i[37]=i[133]=0,o[37]=o[133]=1,a[37]=a[133]=0,s[37]=s[133]=0,y[148]=y[22]=-1,m[148]=m[22]=0,b[148]=b[22]=0,E[148]=E[22]=0,S[148]=S[22]=-1,O[148]=O[22]=1,_[148]=_[22]=0,x[148]=x[22]=1,w[148]=w[22]=1,o[148]=o[22]=-1,a[148]=a[22]=0,s[148]=s[22]=1,u[82]=u[88]=0,c[82]=c[88]=-1,l[82]=l[88]=1,y[82]=y[88]=1,m[82]=m[88]=0,b[82]=b[88]=1,p[82]=p[88]=-1,g[82]=g[88]=0,v[82]=v[88]=1,_[82]=_[88]=0,x[82]=x[88]=-1,w[82]=w[88]=0,u[73]=u[97]=0,c[73]=c[97]=1,l[73]=l[97]=0,f[73]=f[97]=0,h[73]=h[97]=-1,d[73]=d[97]=0,p[73]=p[97]=1,g[73]=g[97]=0,v[73]=v[97]=0,n[73]=n[97]=1,r[73]=r[97]=0,i[73]=i[97]=1,u[145]=u[25]=0,c[145]=c[25]=-1,l[145]=l[25]=0,p[145]=p[25]=1,g[145]=g[25]=0,v[145]=v[25]=1,E[145]=E[25]=0,S[145]=S[25]=1,O[145]=O[25]=1,o[145]=o[25]=-1,a[145]=a[25]=0,s[145]=s[25]=0,f[70]=f[100]=0,h[70]=h[100]=1,d[70]=d[100]=0,y[70]=y[100]=-1,m[70]=m[100]=0,b[70]=b[100]=1,_[70]=_[100]=0,x[70]=x[100]=-1,w[70]=w[100]=1,n[70]=n[100]=1,r[70]=r[100]=0,i[70]=i[100]=0,f[101]=f[69]=0,h[101]=h[69]=1,d[101]=d[69]=0,n[101]=n[69]=1,r[101]=r[69]=0,i[101]=i[69]=0,E[149]=E[21]=0,S[149]=S[21]=1,O[149]=O[21]=1,o[149]=o[21]=-1,a[149]=a[21]=0,s[149]=s[21]=0,y[86]=y[84]=-1,m[86]=m[84]=0,b[86]=b[84]=1,_[86]=_[84]=0,x[86]=x[84]=-1,w[86]=w[84]=1,u[89]=u[81]=0,c[89]=c[81]=-1,l[89]=l[81]=0,p[89]=p[81]=1,g[89]=g[81]=0,v[89]=v[81]=1,u[96]=u[74]=0,c[96]=c[74]=1,l[96]=l[74]=0,f[96]=f[74]=-1,h[96]=h[74]=0,d[96]=d[74]=1,_[96]=_[74]=1,x[96]=x[74]=0,w[96]=w[74]=0,n[96]=n[74]=1,r[96]=r[74]=0,i[96]=i[74]=1,u[24]=u[146]=0,c[24]=c[146]=-1,l[24]=l[146]=1,y[24]=y[146]=1,m[24]=m[146]=0,b[24]=b[146]=1,p[24]=p[146]=0,g[24]=g[146]=1,v[24]=v[146]=1,o[24]=o[146]=0,a[24]=a[146]=-1,s[24]=s[146]=0,f[6]=f[164]=-1,h[6]=h[164]=0,d[6]=d[164]=1,y[6]=y[164]=-1,m[6]=m[164]=0,b[6]=b[164]=0,E[6]=E[164]=0,S[6]=S[164]=-1,O[6]=O[164]=1,_[6]=_[164]=1,x[6]=x[164]=0,w[6]=w[164]=0,p[129]=p[41]=0,g[129]=g[41]=1,v[129]=v[41]=1,E[129]=E[41]=0,S[129]=S[41]=1,O[129]=O[41]=0,n[129]=n[41]=-1,r[129]=r[41]=0,i[129]=i[41]=0,o[129]=o[41]=0,a[129]=a[41]=-1,s[129]=s[41]=0,y[66]=y[104]=0,m[66]=m[104]=1,b[66]=b[104]=0,p[66]=p[104]=-1,g[66]=g[104]=0,v[66]=v[104]=1,_[66]=_[104]=0,x[66]=x[104]=-1,w[66]=w[104]=0,n[66]=n[104]=0,r[66]=r[104]=-1,i[66]=i[104]=1,u[144]=u[26]=-1,c[144]=c[26]=0,l[144]=l[26]=0,E[144]=E[26]=1,S[144]=S[26]=0,O[144]=O[26]=1,_[144]=_[26]=0,x[144]=x[26]=1,w[144]=w[26]=1,o[144]=o[26]=-1,a[144]=a[26]=0,s[144]=s[26]=1,f[36]=f[134]=0,h[36]=h[134]=1,d[36]=d[134]=1,y[36]=y[134]=0,m[36]=m[134]=1,b[36]=b[134]=0,n[36]=n[134]=0,r[36]=r[134]=-1,i[36]=i[134]=1,o[36]=o[134]=1,a[36]=a[134]=0,s[36]=s[134]=0,u[9]=u[161]=-1,c[9]=c[161]=0,l[9]=l[161]=0,f[9]=f[161]=0,h[9]=h[161]=-1,d[9]=d[161]=0,p[9]=p[161]=1,g[9]=g[161]=0,v[9]=v[161]=0,E[9]=E[161]=1,S[9]=S[161]=0,O[9]=O[161]=1,u[136]=0,c[136]=1,l[136]=1,f[136]=0,h[136]=1,d[136]=0,y[136]=-1,m[136]=0,b[136]=1,p[136]=-1,g[136]=0,v[136]=0,E[136]=0,S[136]=-1,O[136]=0,_[136]=0,x[136]=-1,w[136]=1,n[136]=1,r[136]=0,i[136]=0,o[136]=1,a[136]=0,s[136]=1,u[34]=0,c[34]=-1,l[34]=0,f[34]=0,h[34]=-1,d[34]=1,y[34]=1,m[34]=0,b[34]=0,p[34]=1,g[34]=0,v[34]=1,E[34]=0,S[34]=1,O[34]=1,_[34]=0,x[34]=1,w[34]=0,n[34]=-1,r[34]=0,i[34]=1,o[34]=-1,a[34]=0,s[34]=0,u[35]=0,c[35]=1,l[35]=1,f[35]=0,h[35]=-1,d[35]=1,y[35]=1,m[35]=0,b[35]=0,p[35]=-1,g[35]=0,v[35]=0,E[35]=0,S[35]=-1,O[35]=0,_[35]=0,x[35]=1,w[35]=0,n[35]=-1,r[35]=0,i[35]=1,o[35]=1,a[35]=0,s[35]=1,u[153]=0,c[153]=1,l[153]=1,p[153]=-1,g[153]=0,v[153]=0,E[153]=0,S[153]=-1,O[153]=0,o[153]=1,a[153]=0,s[153]=1,f[102]=0,h[102]=-1,d[102]=1,y[102]=1,m[102]=0,b[102]=0,_[102]=0,x[102]=1,w[102]=0,n[102]=-1,r[102]=0,i[102]=1,u[155]=0,c[155]=-1,l[155]=0,p[155]=1,g[155]=0,v[155]=1,E[155]=0,S[155]=1,O[155]=1,o[155]=-1,a[155]=0,s[155]=0,f[103]=0,h[103]=1,d[103]=0,y[103]=-1,m[103]=0,b[103]=1,_[103]=0,x[103]=-1,w[103]=1,n[103]=1,r[103]=0,i[103]=0,u[152]=0,c[152]=1,l[152]=1,y[152]=-1,m[152]=0,b[152]=1,p[152]=-1,g[152]=0,v[152]=0,E[152]=0,S[152]=-1,O[152]=0,_[152]=0,x[152]=-1,w[152]=1,o[152]=1,a[152]=0,s[152]=1,u[156]=0,c[156]=-1,l[156]=1,y[156]=1,m[156]=0,b[156]=1,p[156]=-1,g[156]=0,v[156]=0,E[156]=0,S[156]=-1,O[156]=0,_[156]=0,x[156]=1,w[156]=1,o[156]=-1,a[156]=0,s[156]=1,u[137]=0,c[137]=1,l[137]=1,f[137]=0,h[137]=1,d[137]=0,p[137]=-1,g[137]=0,v[137]=0,E[137]=0,S[137]=-1,O[137]=0,n[137]=1,r[137]=0,i[137]=0,o[137]=1,a[137]=0,s[137]=1,u[139]=0,c[139]=1,l[139]=1,f[139]=0,h[139]=-1,d[139]=0,p[139]=1,g[139]=0,v[139]=0,E[139]=0,S[139]=1,O[139]=0,n[139]=-1,r[139]=0,i[139]=0,o[139]=1,a[139]=0,s[139]=1,u[98]=0,c[98]=-1,l[98]=0,f[98]=0,h[98]=-1,d[98]=1,y[98]=1,m[98]=0,b[98]=0,p[98]=1,g[98]=0,v[98]=1,_[98]=0,x[98]=1,w[98]=0,n[98]=-1,r[98]=0,i[98]=1,u[99]=0,c[99]=1,l[99]=0,f[99]=0,h[99]=-1,d[99]=1,y[99]=1,m[99]=0,b[99]=0,p[99]=-1,g[99]=0,v[99]=1,_[99]=0,x[99]=-1,w[99]=0,n[99]=1,r[99]=0,i[99]=1,f[38]=0,h[38]=-1,d[38]=1,y[38]=1,m[38]=0,b[38]=0,E[38]=0,S[38]=1,O[38]=1,_[38]=0,x[38]=1,w[38]=0,n[38]=-1,r[38]=0,i[38]=1,o[38]=-1,a[38]=0,s[38]=0,f[39]=0,h[39]=1,d[39]=1,y[39]=-1,m[39]=0,b[39]=0,E[39]=0,S[39]=-1,O[39]=1,_[39]=0,x[39]=1,w[39]=0,n[39]=-1,r[39]=0,i[39]=1,o[39]=1,a[39]=0,s[39]=0;var P=function(t){return[[t.bottomleft,0],[0,0],[0,t.leftbottom]]},C=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0]]},M=function(t){return[[t.topright,1],[1,1],[1,t.righttop]]},I=function(t){return[[0,t.lefttop],[0,1],[t.topleft,1]]},A=function(t){return[[t.bottomright,0],[t.bottomleft,0],[0,t.leftbottom],[0,t.lefttop]]},T=function(t){return[[t.bottomright,0],[t.bottomleft,0],[1,t.righttop],[1,t.rightbottom]]},N=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.topleft,1],[t.topright,1]]},L=function(t){return[[0,t.leftbottom],[0,t.lefttop],[t.topleft,1],[t.topright,1]]},R=[],k=[],j=[],F=[],D=[],B=[],z=[],V=[];F[1]=D[1]=18,F[169]=D[169]=18,j[4]=k[4]=12,j[166]=k[166]=12,R[16]=V[16]=4,R[154]=V[154]=4,B[64]=z[64]=22,B[106]=z[106]=22,j[2]=B[2]=17,F[2]=D[2]=18,j[168]=B[168]=17,F[168]=D[168]=18,R[8]=F[8]=9,k[8]=j[8]=12,R[162]=F[162]=9,k[162]=j[162]=12,R[32]=V[32]=4,k[32]=z[32]=1,R[138]=V[138]=4,k[138]=z[138]=1,D[128]=V[128]=21,B[128]=z[128]=22,D[42]=V[42]=21,B[42]=z[42]=22,k[5]=D[5]=14,k[165]=D[165]=14,j[20]=V[20]=6,j[150]=V[150]=6,R[80]=B[80]=11,R[90]=B[90]=11,F[65]=z[65]=3,F[105]=z[105]=3,R[160]=B[160]=11,k[160]=D[160]=14,R[10]=B[10]=11,k[10]=D[10]=14,j[130]=V[130]=6,F[130]=z[130]=3,j[40]=V[40]=6,F[40]=z[40]=3,k[101]=z[101]=1,k[69]=z[69]=1,D[149]=V[149]=21,D[21]=V[21]=21,j[86]=B[86]=17,j[84]=B[84]=17,R[89]=F[89]=9,R[81]=F[81]=9,R[96]=z[96]=0,k[96]=B[96]=15,R[74]=z[74]=0,k[74]=B[74]=15,R[24]=j[24]=8,F[24]=V[24]=7,R[146]=j[146]=8,F[146]=V[146]=7,k[6]=B[6]=15,j[6]=D[6]=16,k[164]=B[164]=15,j[164]=D[164]=16,F[129]=V[129]=7,D[129]=z[129]=20,F[41]=V[41]=7,D[41]=z[41]=20,j[66]=z[66]=2,F[66]=B[66]=19,j[104]=z[104]=2,F[104]=B[104]=19,R[144]=D[144]=10,B[144]=V[144]=23,R[26]=D[26]=10,B[26]=V[26]=23,k[36]=V[36]=5,j[36]=z[36]=2,k[134]=V[134]=5,j[134]=z[134]=2,R[9]=D[9]=10,k[9]=F[9]=13,R[161]=D[161]=10,k[161]=F[161]=13,k[37]=V[37]=5,D[37]=z[37]=20,k[133]=V[133]=5,D[133]=z[133]=20,j[148]=D[148]=16,B[148]=V[148]=23,j[22]=D[22]=16,B[22]=V[22]=23,R[82]=j[82]=8,F[82]=B[82]=19,R[88]=j[88]=8,F[88]=B[88]=19,R[73]=z[73]=0,k[73]=F[73]=13,R[97]=z[97]=0,k[97]=F[97]=13,R[145]=F[145]=9,D[145]=V[145]=21,R[25]=F[25]=9,D[25]=V[25]=21,k[70]=z[70]=1,j[70]=B[70]=17,k[100]=z[100]=1,j[100]=B[100]=17,R[34]=F[34]=9,k[34]=j[34]=12,D[34]=V[34]=21,B[34]=z[34]=22,R[136]=V[136]=4,k[136]=z[136]=1,j[136]=B[136]=17,F[136]=D[136]=18,R[35]=V[35]=4,k[35]=j[35]=12,F[35]=D[35]=18,B[35]=z[35]=22,R[153]=V[153]=4,F[153]=D[153]=18,k[102]=j[102]=12,B[102]=z[102]=22,R[155]=F[155]=9,D[155]=V[155]=23,k[103]=z[103]=1,j[103]=B[103]=17,R[152]=V[152]=4,j[152]=B[152]=17,F[152]=D[152]=18,R[156]=j[156]=8,F[156]=D[156]=18,B[156]=V[156]=23,R[137]=V[137]=4,k[137]=z[137]=1,F[137]=D[137]=18,R[139]=V[139]=4,k[139]=F[139]=13,D[139]=z[139]=20,R[98]=F[98]=9,k[98]=j[98]=12,B[98]=z[98]=22,R[99]=z[99]=0,k[99]=j[99]=12,F[99]=B[99]=19,k[38]=j[38]=12,D[38]=V[38]=21,B[38]=z[38]=22,k[39]=V[39]=5,j[39]=D[39]=16,B[39]=z[39]=22;var G=[];function U(t,e,n){return(t-e)/(n-e)}function W(t){return t.constructor.toString().indexOf("Array")>-1}function q(t,e,n,r,i,o){for(var a=t.cells[n][e],s=a.cval_real,u=e+r,c=n+i,l=[],f=!1;!f;){if(void 0===t.cells[c]||void 0===t.cells[c][u])if(c-=i,u-=r,s=(a=t.cells[c][u]).cval_real,-1===i)if(0===o)if(1&s)l.push([u,c]),r=-1,i=0,o=0;else{if(!(4&s)){l.push([u+a.bottomright,c]),r=0,i=1,o=1,f=!0;break}l.push([u+1,c]),r=1,i=0,o=0}else{if(!(1&s)){if(4&s){l.push([u+a.bottomright,c]),r=0,i=1,o=1,f=!0;break}l.push([u+a.bottomleft,c]),r=0,i=1,o=0,f=!0;break}l.push([u,c]),r=-1,i=0,o=0}else if(1===i)if(0===o){if(!(16&s)){if(64&s){l.push([u+a.topleft,c+1]),r=0,i=-1,o=0,f=!0;break}l.push([u+a.topright,c+1]),r=0,i=-1,o=1,f=!0;break}l.push([u+1,c+1]),r=1,i=0,o=1}else l.push([u+1,c+1]),r=1,i=0,o=1;else if(-1===r)if(0===o){if(!(64&s)){if(1&s){l.push([u,c+a.leftbottom]),r=1,i=0,o=0,f=!0;break}l.push([u,c+a.lefttop]),r=1,i=0,o=1,f=!0;break}l.push([u,c+1]),r=0,i=1,o=0}else{if(!(64&s)){console.log("MarchingSquaresJS-isoBands: wtf");break}l.push([u,c+1]),r=0,i=1,o=0}else{if(1!==r){console.log("MarchingSquaresJS-isoBands: we came from nowhere!");break}if(0===o){if(!(4&s)){l.push([u+1,c+a.rightbottom]),r=-1,i=0,o=0,f=!0;break}l.push([u+1,c]),r=0,i=-1,o=1}else{if(!(4&s)){if(16&s){l.push([u+1,c+a.righttop]),r=-1,i=0,o=1;break}l.push([u+1,c+a.rightbottom]),r=-1,i=0,o=0,f=!0;break}l.push([u+1,c]),r=0,i=-1,o=1}}else if(s=(a=t.cells[c][u]).cval_real,-1===r)if(0===o)if(void 0!==t.cells[c-1]&&void 0!==t.cells[c-1][u])r=0,i=-1,o=1;else{if(!(1&s)){l.push([u+a.bottomright,c]),r=0,i=1,o=1,f=!0;break}l.push([u,c])}else{if(!(64&s)){console.log("MarchingSquaresJS-isoBands: found entry from top at "+u+","+c);break}console.log("MarchingSquaresJS-isoBands: proceeding in x-direction!")}else if(1===r){if(0===o){console.log("MarchingSquaresJS-isoBands: wtf");break}if(void 0!==t.cells[c+1]&&void 0!==t.cells[c+1][u])r=0,i=1,o=0;else{if(!(16&s)){l.push([u+a.topleft,c+1]),r=0,i=-1,o=0,f=!0;break}l.push([u+1,c+1]),r=1,i=0,o=1}}else if(-1===i){if(1!==o){console.log("MarchingSquaresJS-isoBands: wtf");break}if(void 0!==t.cells[c][u+1])r=1,i=0,o=1;else{if(!(4&s)){l.push([u+1,c+a.righttop]),r=-1,i=0,o=1,f=!0;break}l.push([u+1,c]),r=0,i=-1,o=1}}else{if(1!==i){console.log("MarchingSquaresJS-isoBands: where did we came from???");break}if(0!==o){console.log("MarchingSquaresJS-isoBands: wtf");break}if(void 0!==t.cells[c][u-1])r=-1,i=0,o=0;else{if(!(64&s)){l.push([u,c+a.leftbottom]),r=1,i=0,o=0,f=!0;break}l.push([u,c+1]),r=0,i=1,o=0}}if(c+=i,(u+=r)===e&&c===n)break}return{path:l,i:u,j:c,x:r,y:i,o:o}}function X(t){if(t.edges.length>0){var e=t.edges[t.edges.length-1],n=t.cval_real;switch(e){case 0:return 16&n?{p:[1,t.righttop],x:-1,y:0,o:1}:{p:[t.topleft,1],x:0,y:-1,o:0};case 1:return 4&n?{p:[t.topleft,1],x:0,y:-1,o:0}:{p:[1,t.rightbottom],x:-1,y:0,o:0};case 2:return 4&n?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[t.topleft,1],x:0,y:-1,o:0};case 3:return 1&n?{p:[t.topleft,1],x:0,y:-1,o:0}:{p:[t.bottomleft,0],x:0,y:1,o:0};case 4:return 16&n?{p:[1,t.righttop],x:-1,y:0,o:1}:{p:[t.topright,1],x:0,y:-1,o:1};case 5:return 4&n?{p:[t.topright,1],x:0,y:-1,o:1}:{p:[1,t.rightbottom],x:-1,y:0,o:0};case 6:return 4&n?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[t.topright,1],x:0,y:-1,o:1};case 7:return 1&n?{p:[t.topright,1],x:0,y:-1,o:1}:{p:[t.bottomleft,0],x:0,y:1,o:0};case 8:return 4&n?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[1,t.righttop],x:-1,y:0,o:1};case 9:return 1&n?{p:[1,t.righttop],x:-1,y:0,o:1}:{p:[t.bottomleft,0],x:0,y:1,o:0};case 10:return 1&n?{p:[0,t.leftbottom],x:1,y:0,o:0}:{p:[1,t.righttop],x:-1,y:0,o:1};case 11:return 64&n?{p:[1,t.righttop],x:-1,y:0,o:1}:{p:[0,t.lefttop],x:1,y:0,o:1};case 12:return 4&n?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[1,t.rightbottom],x:-1,y:0,o:0};case 13:return 1&n?{p:[1,t.rightbottom],x:-1,y:0,o:0}:{p:[t.bottomleft,0],x:0,y:1,o:0};case 14:return 1&n?{p:[0,t.leftbottom],x:1,y:0,o:0}:{p:[1,t.rightbottom],x:-1,y:0,o:0};case 15:return 64&n?{p:[1,t.rightbottom],x:-1,y:0,o:0}:{p:[0,t.lefttop],x:1,y:0,o:1};case 16:return 4&n?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[0,t.leftbottom],x:1,y:0,o:0};case 17:return 64&n?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[0,t.lefttop],x:1,y:0,o:1};case 18:return 1&n?{p:[0,t.leftbottom],x:1,y:0,o:0}:{p:[t.bottomleft,0],x:0,y:1,o:0};case 19:return 64&n?{p:[t.bottomleft,0],x:0,y:1,o:0}:{p:[0,t.lefttop],x:1,y:0,o:1};case 20:return 64&n?{p:[t.topleft,1],x:0,y:-1,o:0}:{p:[0,t.leftbottom],x:1,y:0,o:0};case 21:return 16&n?{p:[0,t.leftbottom],x:1,y:0,o:0}:{p:[t.topright,1],x:0,y:-1,o:1};case 22:return 64&n?{p:[t.topleft,1],x:0,y:-1,o:0}:{p:[0,t.lefttop],x:1,y:0,o:1};case 23:return 16&n?{p:[0,t.lefttop],x:1,y:0,o:1}:{p:[t.topright,1],x:0,y:-1,o:1};default:console.log("MarchingSquaresJS-isoBands: edge index out of range!"),console.log(t)}}return null}function H(t,e,P,C){var M,I,A,T,N,L=t.cval;switch(e){case-1:switch(C){case 0:M=k[L],A=f[L],T=h[L],N=d[L];break;default:M=R[L],A=u[L],T=c[L],N=l[L]}break;case 1:switch(C){case 0:M=D[L],A=E[L],T=S[L],N=O[L];break;default:M=B[L],A=_[L],T=x[L],N=w[L]}break;default:switch(P){case-1:switch(C){case 0:M=z[L],A=n[L],T=r[L],N=i[L];break;default:M=V[L],A=o[L],T=a[L],N=s[L]}break;case 1:switch(C){case 0:M=F[L],A=p[L],T=g[L],N=v[L];break;default:M=j[L],A=y[L],T=m[L],N=b[L]}}}if(I=t.edges.indexOf(M),void 0===t.edges[I])return null;switch(function(t,e){delete t.edges[e];for(var n=e+1;n<t.edges.length;n++)t.edges[n-1]=t.edges[n];t.edges.pop()}(t,I),L=t.cval_real,M){case 0:16&L?(e=t.topleft,P=1):(e=1,P=t.righttop);break;case 1:4&L?(e=1,P=t.rightbottom):(e=t.topleft,P=1);break;case 2:4&L?(e=t.topleft,P=1):(e=t.bottomright,P=0);break;case 3:1&L?(e=t.bottomleft,P=0):(e=t.topleft,P=1);break;case 4:16&L?(e=t.topright,P=1):(e=1,P=t.righttop);break;case 5:4&L?(e=1,P=t.rightbottom):(e=t.topright,P=1);break;case 6:4&L?(e=t.topright,P=1):(e=t.bottomright,P=0);break;case 7:1&L?(e=t.bottomleft,P=0):(e=t.topright,P=1);break;case 8:4&L?(e=1,P=t.righttop):(e=t.bottomright,P=0);break;case 9:1&L?(e=t.bottomleft,P=0):(e=1,P=t.righttop);break;case 10:1&L?(e=1,P=t.righttop):(e=0,P=t.leftbottom);break;case 11:64&L?(e=0,P=t.lefttop):(e=1,P=t.righttop);break;case 12:4&L?(e=1,P=t.rightbottom):(e=t.bottomright,P=0);break;case 13:1&L?(e=t.bottomleft,P=0):(e=1,P=t.rightbottom);break;case 14:1&L?(e=1,P=t.rightbottom):(e=0,P=t.leftbottom);break;case 15:64&L?(e=0,P=t.lefttop):(e=1,P=t.rightbottom);break;case 16:4&L?(e=0,P=t.leftbottom):(e=t.bottomright,P=0);break;case 17:64&L?(e=0,P=t.lefttop):(e=t.bottomright,P=0);break;case 18:1&L?(e=t.bottomleft,P=0):(e=0,P=t.leftbottom);break;case 19:64&L?(e=0,P=t.lefttop):(e=t.bottomleft,P=0);break;case 20:64&L?(e=0,P=t.leftbottom):(e=t.topleft,P=1);break;case 21:16&L?(e=t.topright,P=1):(e=0,P=t.leftbottom);break;case 22:64&L?(e=0,P=t.lefttop):(e=t.topleft,P=1);break;case 23:16&L?(e=t.topright,P=1):(e=0,P=t.lefttop);break;default:return console.log("MarchingSquaresJS-isoBands: edge index out of range!"),console.log(t),null}return void 0!==e&&void 0!==P&&void 0!==A&&void 0!==T&&void 0!==N||(console.log("MarchingSquaresJS-isoBands: undefined value!"),console.log(t),console.log(e+" "+P+" "+A+" "+T+" "+N)),{p:[e,P],x:A,y:T,o:N}}return G[1]=G[169]=P,G[4]=G[166]=C,G[16]=G[154]=M,G[64]=G[106]=I,G[168]=G[2]=A,G[162]=G[8]=T,G[138]=G[32]=N,G[42]=G[128]=L,G[5]=G[165]=function(t){return[[0,0],[0,t.leftbottom],[1,t.rightbottom],[1,0]]},G[20]=G[150]=function(t){return[[1,0],[t.bottomright,0],[t.topright,1],[1,1]]},G[80]=G[90]=function(t){return[[1,1],[1,t.righttop],[0,t.lefttop],[0,1]]},G[65]=G[105]=function(t){return[[t.bottomleft,0],[0,0],[0,1],[t.topleft,1]]},G[160]=G[10]=function(t){return[[1,t.righttop],[1,t.rightbottom],[0,t.leftbottom],[0,t.lefttop]]},G[130]=G[40]=function(t){return[[t.topleft,1],[t.topright,1],[t.bottomright,0],[t.bottomleft,0]]},G[85]=function(){return[[0,0],[0,1],[1,1],[1,0]]},G[101]=G[69]=function(t){return[[1,t.rightbottom],[1,0],[0,0],[0,1],[t.topleft,1]]},G[149]=G[21]=function(t){return[[t.topright,1],[1,1],[1,0],[0,0],[0,t.leftbottom]]},G[86]=G[84]=function(t){return[[1,0],[t.bottomright,0],[0,t.lefttop],[0,1],[1,1]]},G[89]=G[81]=function(t){return[[1,1],[1,t.righttop],[t.bottomleft,0],[0,0],[0,1]]},G[96]=G[74]=function(t){return[[1,t.righttop],[1,t.rightbottom],[0,t.lefttop],[0,1],[t.topleft,1]]},G[24]=G[146]=function(t){return[[1,1],[1,t.righttop],[t.bottomright,0],[t.bottomleft,0],[t.topright,1]]},G[6]=G[164]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.leftbottom],[0,t.lefttop]]},G[129]=G[41]=function(t){return[[t.topright,1],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topleft,1]]},G[66]=G[104]=function(t){return[[t.bottomright,0],[t.bottomleft,0],[0,t.lefttop],[0,1],[t.topleft,1]]},G[144]=G[26]=function(t){return[[1,1],[1,t.righttop],[0,t.leftbottom],[0,t.lefttop],[t.topright,1]]},G[36]=G[134]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[t.topleft,1],[t.topright,1]]},G[9]=G[161]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomleft,0],[0,0],[0,t.leftbottom]]},G[37]=G[133]=function(t){return[[1,t.rightbottom],[1,0],[0,0],[0,t.leftbottom],[t.topleft,1],[t.topright,1]]},G[148]=G[22]=function(t){return[[1,1],[1,0],[t.bottomright,0],[0,t.leftbottom],[0,t.lefttop],[t.topright,1]]},G[82]=G[88]=function(t){return[[1,1],[1,t.righttop],[t.bottomright,0],[t.bottomleft,0],[0,t.lefttop],[0,1]]},G[73]=G[97]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomleft,0],[0,0],[0,1],[t.topleft,1]]},G[145]=G[25]=function(t){return[[1,1],[1,t.righttop],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topright,1]]},G[70]=G[100]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.lefttop],[0,1],[t.topleft,1]]},G[34]=function(t){return[L(t),T(t)]},G[35]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomright,0],[t.bottomleft,0],[0,t.leftbottom],[0,t.lefttop],[t.topleft,1],[t.topright,1]]},G[136]=function(t){return[N(t),A(t)]},G[153]=function(t){return[M(t),P(t)]},G[102]=function(t){return[C(t),I(t)]},G[155]=function(t){return[[1,1],[1,t.righttop],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topright,1]]},G[103]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.lefttop],[0,1],[t.topleft,1]]},G[152]=function(t){return[M(t),A(t)]},G[156]=function(t){return[[1,1],[1,t.righttop],[t.bottomright,0],[t.bottomleft,0],[0,t.leftbottom],[0,t.lefttop],[t.topright,1]]},G[137]=function(t){return[N(t),P(t)]},G[139]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topleft,1],[t.topright,1]]},G[98]=function(t){return[T(t),I(t)]},G[99]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomright,0],[t.bottomleft,0],[0,t.lefttop],[0,1],[t.topleft,1]]},G[38]=function(t){return[C(t),L(t)]},G[39]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.leftbottom],[0,t.lefttop],[t.topleft,1],[t.topright,1]]},function(n,r,i,o){o=o||{};for(var a=Object.keys(t),s=0;s<a.length;s++){var u=a[s],c=o[u];c=null!=c?c:t[u],e[u]=c}e.verbose&&console.log("MarchingSquaresJS-isoBands: computing isobands for ["+r+":"+(r+i)+"]");var l,f=function(t,e,n){for(var r=t.length-1,i=t[0].length-1,o={rows:r,cols:i,cells:[]},a=e+Math.abs(n),s=0;s<r;++s){o.cells[s]=[];for(var u=0;u<i;++u){var c=0,l=t[s+1][u],f=t[s+1][u+1],h=t[s][u+1],d=t[s][u];if(!(isNaN(l)||isNaN(f)||isNaN(h)||isNaN(d))){c|=l<e?0:l>a?128:64,c|=f<e?0:f>a?32:16,c|=h<e?0:h>a?8:4;var p=+(c|=d<e?0:d>a?2:1),g=0;if(17===c||18===c||33===c||34===c||38===c||68===c||72===c||98===c||102===c||132===c||136===c||137===c||152===c||153===c){var v=(l+f+h+d)/4;g=v>a?2:v<e?0:1,34===c?1===g?c=35:0===g&&(c=136):136===c?1===g?(c=35,g=4):0===g&&(c=34):17===c?1===g?(c=155,g=4):0===g&&(c=153):68===c?1===g?(c=103,g=4):0===g&&(c=102):153===c?1===g&&(c=155):102===c?1===g&&(c=103):152===c?g<2&&(c=156,g=1):137===c?g<2&&(c=139,g=1):98===c?g<2&&(c=99,g=1):38===c?g<2&&(c=39,g=1):18===c?g>0?(c=156,g=4):c=152:33===c?g>0?(c=139,g=4):c=137:72===c?g>0?(c=99,g=4):c=98:132===c&&(g>0?(c=39,g=4):c=38)}if(0!=c&&170!=c){var y,m,b,_,x,w,E,S;y=m=b=_=x=w=E=S=.5;var O=[];1===c?(b=1-U(e,h,d),S=1-U(e,l,d),O.push(F[c])):169===c?(b=U(a,d,h),S=U(a,d,l),O.push(F[c])):4===c?(w=1-U(e,f,h),_=U(e,d,h),O.push(k[c])):166===c?(w=U(a,h,f),_=1-U(a,h,d),O.push(k[c])):16===c?(x=U(e,h,f),m=U(e,l,f),O.push(R[c])):154===c?(x=1-U(a,f,h),m=1-U(a,f,l),O.push(R[c])):64===c?(E=U(e,d,l),y=1-U(e,f,l),O.push(B[c])):106===c?(E=1-U(a,l,d),y=U(a,l,f),O.push(B[c])):168===c?(_=U(a,d,h),b=U(e,d,h),S=U(e,d,l),E=U(a,d,l),O.push(j[c]),O.push(F[c])):2===c?(_=1-U(e,h,d),b=1-U(a,h,d),S=1-U(a,l,d),E=1-U(e,l,d),O.push(j[c]),O.push(F[c])):162===c?(x=U(a,h,f),w=U(e,h,f),_=1-U(e,h,d),b=1-U(a,h,d),O.push(j[c]),O.push(F[c])):8===c?(x=1-U(e,f,h),w=1-U(a,f,h),_=U(a,d,h),b=U(e,d,h),O.push(R[c]),O.push(k[c])):138===c?(x=1-U(e,f,h),w=1-U(a,f,h),y=1-U(a,f,l),m=1-U(e,f,l),O.push(R[c]),O.push(k[c])):32===c?(x=U(a,h,f),w=U(e,h,f),y=U(e,l,f),m=U(a,l,f),O.push(R[c]),O.push(k[c])):42===c?(S=1-U(a,l,d),E=1-U(e,l,d),y=U(e,l,f),m=U(a,l,f),O.push(D[c]),O.push(B[c])):128===c&&(S=U(e,d,l),E=U(a,d,l),y=1-U(a,f,l),m=1-U(e,f,l),O.push(D[c]),O.push(B[c])),5===c?(w=1-U(e,f,h),S=1-U(e,l,d),O.push(k[c])):165===c?(w=U(a,h,f),S=U(a,d,l),O.push(k[c])):20===c?(_=U(e,d,h),m=U(e,l,f),O.push(j[c])):150===c?(_=1-U(a,h,d),m=1-U(a,f,l),O.push(j[c])):80===c?(x=U(e,h,f),E=U(e,d,l),O.push(R[c])):90===c?(x=1-U(a,f,h),E=1-U(a,l,d),O.push(R[c])):65===c?(b=1-U(e,h,d),y=1-U(e,f,l),O.push(F[c])):105===c?(b=U(a,d,h),y=U(a,l,f),O.push(F[c])):160===c?(x=U(a,h,f),w=U(e,h,f),S=U(e,d,l),E=U(a,d,l),O.push(R[c]),O.push(k[c])):10===c?(x=1-U(e,f,h),w=1-U(a,f,h),S=1-U(a,l,d),E=1-U(e,l,d),O.push(R[c]),O.push(k[c])):130===c?(_=1-U(e,h,d),b=1-U(a,h,d),y=1-U(a,f,l),m=1-U(e,f,l),O.push(j[c]),O.push(F[c])):40===c?(_=U(a,d,h),b=U(e,d,h),y=U(e,l,f),m=U(a,l,f),O.push(j[c]),O.push(F[c])):101===c?(w=U(a,h,f),y=U(a,l,f),O.push(k[c])):69===c?(w=1-U(e,f,h),y=1-U(e,f,l),O.push(k[c])):149===c?(S=U(a,d,l),m=1-U(a,f,l),O.push(D[c])):21===c?(S=1-U(e,l,d),m=U(e,l,f),O.push(D[c])):86===c?(_=1-U(a,h,d),E=1-U(a,l,d),O.push(j[c])):84===c?(_=U(e,d,h),E=U(e,d,l),O.push(j[c])):89===c?(x=1-U(a,f,h),b=U(a,d,h),O.push(F[c])):81===c?(x=U(e,h,f),b=1-U(e,h,d),O.push(F[c])):96===c?(x=U(a,h,f),w=U(e,h,f),E=U(e,d,l),y=U(a,l,f),O.push(R[c]),O.push(k[c])):74===c?(x=1-U(e,f,h),w=1-U(a,f,h),E=1-U(a,l,d),y=1-U(e,f,l),O.push(R[c]),O.push(k[c])):24===c?(x=1-U(a,f,h),_=U(a,d,h),b=U(e,d,h),m=U(e,l,f),O.push(R[c]),O.push(F[c])):146===c?(x=U(e,h,f),_=1-U(e,h,d),b=1-U(a,h,d),m=1-U(a,f,l),O.push(R[c]),O.push(F[c])):6===c?(w=1-U(e,f,h),_=1-U(a,h,d),S=1-U(a,l,d),E=1-U(e,l,d),O.push(k[c]),O.push(j[c])):164===c?(w=U(a,h,f),_=U(e,d,h),S=U(e,d,l),E=U(a,d,l),O.push(k[c]),O.push(j[c])):129===c?(b=1-U(e,h,d),S=U(a,d,l),y=1-U(a,f,l),m=1-U(e,f,l),O.push(F[c]),O.push(D[c])):41===c?(b=U(a,d,h),S=1-U(e,l,d),y=U(e,l,f),m=U(a,l,f),O.push(F[c]),O.push(D[c])):66===c?(_=1-U(e,h,d),b=1-U(a,h,d),E=1-U(a,l,d),y=1-U(e,f,l),O.push(j[c]),O.push(F[c])):104===c?(_=U(a,d,h),b=U(e,d,h),E=U(e,d,l),y=U(a,l,f),O.push(F[c]),O.push(z[c])):144===c?(x=U(e,h,f),S=U(e,d,l),E=U(a,d,l),m=1-U(a,f,l),O.push(R[c]),O.push(B[c])):26===c?(x=1-U(a,f,h),S=1-U(a,l,d),E=1-U(e,l,d),m=U(e,l,f),O.push(R[c]),O.push(B[c])):36===c?(w=U(a,h,f),_=U(e,d,h),y=U(e,l,f),m=U(a,l,f),O.push(k[c]),O.push(j[c])):134===c?(w=1-U(e,f,h),_=1-U(a,h,d),y=1-U(a,f,l),m=1-U(e,f,l),O.push(k[c]),O.push(j[c])):9===c?(x=1-U(e,f,h),w=1-U(a,f,h),b=U(a,d,h),S=1-U(e,l,d),O.push(R[c]),O.push(k[c])):161===c?(x=U(a,h,f),w=U(e,h,f),b=1-U(e,h,d),S=U(a,d,l),O.push(R[c]),O.push(k[c])):37===c?(w=U(a,h,f),S=1-U(e,l,d),y=U(e,l,f),m=U(a,l,f),O.push(k[c]),O.push(D[c])):133===c?(w=1-U(e,f,h),S=U(a,d,l),y=1-U(a,f,l),m=1-U(e,f,l),O.push(k[c]),O.push(D[c])):148===c?(_=U(e,d,h),S=U(e,d,l),E=U(a,d,l),m=1-U(a,f,l),O.push(j[c]),O.push(B[c])):22===c?(_=1-U(a,h,d),S=1-U(a,l,d),E=1-U(e,l,d),m=U(e,l,f),O.push(j[c]),O.push(B[c])):82===c?(x=U(e,h,f),_=1-U(e,h,d),b=1-U(a,h,d),E=1-U(a,l,d),O.push(R[c]),O.push(F[c])):88===c?(x=1-U(a,f,h),_=U(a,d,h),b=U(e,d,h),E=U(e,d,l),O.push(R[c]),O.push(F[c])):73===c?(x=1-U(e,f,h),w=1-U(a,f,h),b=U(a,d,h),y=1-U(e,f,l),O.push(R[c]),O.push(k[c])):97===c?(x=U(a,h,f),w=U(e,h,f),b=1-U(e,h,d),y=U(a,l,f),O.push(R[c]),O.push(k[c])):145===c?(x=U(e,h,f),b=1-U(e,h,d),S=U(a,d,l),m=1-U(a,f,l),O.push(R[c]),O.push(D[c])):25===c?(x=1-U(a,f,h),b=U(a,d,h),S=1-U(e,l,d),m=U(e,l,f),O.push(R[c]),O.push(D[c])):70===c?(w=1-U(e,f,h),_=1-U(a,h,d),E=1-U(a,l,d),y=1-U(e,f,l),O.push(k[c]),O.push(j[c])):100===c?(w=U(a,h,f),_=U(e,d,h),E=U(e,d,l),y=U(a,l,f),O.push(k[c]),O.push(j[c])):34===c?(0===g?(x=1-U(e,f,h),w=1-U(a,f,h),_=U(a,d,h),b=U(e,d,h),S=U(e,d,l),E=U(a,d,l),y=1-U(a,f,l),m=1-U(e,f,l)):(x=U(a,h,f),w=U(e,h,f),_=1-U(e,h,d),b=1-U(a,h,d),S=1-U(a,l,d),E=1-U(e,l,d),y=U(e,l,f),m=U(a,l,f)),O.push(R[c]),O.push(k[c]),O.push(D[c]),O.push(B[c])):35===c?(4===g?(x=1-U(e,f,h),w=1-U(a,f,h),_=U(a,d,h),b=U(e,d,h),S=U(e,d,l),E=U(a,d,l),y=1-U(a,f,l),m=1-U(e,f,l)):(x=U(a,h,f),w=U(e,h,f),_=1-U(e,h,d),b=1-U(a,h,d),S=1-U(a,l,d),E=1-U(e,l,d),y=U(e,l,f),m=U(a,l,f)),O.push(R[c]),O.push(k[c]),O.push(F[c]),O.push(B[c])):136===c?(0===g?(x=U(a,h,f),w=U(e,h,f),_=1-U(e,h,d),b=1-U(a,h,d),S=1-U(a,l,d),E=1-U(e,l,d),y=U(e,l,f),m=U(a,l,f)):(x=1-U(e,f,h),w=1-U(a,f,h),_=U(a,d,h),b=U(e,d,h),S=U(e,d,l),E=U(a,d,l),y=1-U(a,f,l),m=1-U(e,f,l)),O.push(R[c]),O.push(k[c]),O.push(D[c]),O.push(B[c])):153===c?(0===g?(x=U(e,h,f),b=1-U(e,h,d),S=1-U(e,l,d),m=U(e,l,f)):(x=1-U(a,f,h),b=U(a,d,h),S=U(a,d,l),m=1-U(a,f,l)),O.push(R[c]),O.push(F[c])):102===c?(0===g?(w=1-U(e,f,h),_=U(e,d,h),E=U(e,d,l),y=1-U(e,f,l)):(w=U(a,h,f),_=1-U(a,h,d),E=1-U(a,l,d),y=U(a,l,f)),O.push(k[c]),O.push(B[c])):155===c?(4===g?(x=U(e,h,f),b=1-U(e,h,d),S=1-U(e,l,d),m=U(e,l,f)):(x=1-U(a,f,h),b=U(a,d,h),S=U(a,d,l),m=1-U(a,f,l)),O.push(R[c]),O.push(D[c])):103===c?(4===g?(w=1-U(e,f,h),_=U(e,d,h),E=U(e,d,l),y=1-U(e,f,l)):(w=U(a,h,f),_=1-U(a,h,d),E=1-U(a,l,d),y=U(a,l,f)),O.push(k[c]),O.push(j[c])):152===c?(0===g?(x=U(e,h,f),_=1-U(e,h,d),b=1-U(a,h,d),S=1-U(a,l,d),E=1-U(e,l,d),m=U(e,l,f)):(x=1-U(a,f,h),_=U(a,d,h),b=U(e,d,h),S=U(e,d,l),E=U(a,d,l),m=1-U(a,f,l)),O.push(R[c]),O.push(j[c]),O.push(F[c])):156===c?(4===g?(x=U(e,h,f),_=1-U(e,h,d),b=1-U(a,h,d),S=1-U(a,l,d),E=1-U(e,l,d),m=U(e,l,f)):(x=1-U(a,f,h),_=U(a,d,h),b=U(e,d,h),S=U(e,d,l),E=U(a,d,l),m=1-U(a,f,l)),O.push(R[c]),O.push(F[c]),O.push(B[c])):137===c?(0===g?(x=U(a,h,f),w=U(e,h,f),b=1-U(e,h,d),S=1-U(e,l,d),y=U(e,l,f),m=U(a,l,f)):(x=1-U(e,f,h),w=1-U(a,f,h),b=U(a,d,h),S=U(a,d,l),y=1-U(a,f,l),m=1-U(e,f,l)),O.push(R[c]),O.push(k[c]),O.push(F[c])):139===c?(4===g?(x=U(a,h,f),w=U(e,h,f),b=1-U(e,h,d),S=1-U(e,l,d),y=U(e,l,f),m=U(a,l,f)):(x=1-U(e,f,h),w=1-U(a,f,h),b=U(a,d,h),S=U(a,d,l),y=1-U(a,f,l),m=1-U(e,f,l)),O.push(R[c]),O.push(k[c]),O.push(D[c])):98===c?(0===g?(x=1-U(e,f,h),w=1-U(a,f,h),_=U(a,d,h),b=U(e,d,h),E=U(e,d,l),y=1-U(e,f,l)):(x=U(a,h,f),w=U(e,h,f),_=1-U(e,h,d),b=1-U(a,h,d),E=1-U(a,l,d),y=U(a,l,f)),O.push(R[c]),O.push(k[c]),O.push(B[c])):99===c?(4===g?(x=1-U(e,f,h),w=1-U(a,f,h),_=U(a,d,h),b=U(e,d,h),E=U(e,d,l),y=1-U(e,f,l)):(x=U(a,h,f),w=U(e,h,f),_=1-U(e,h,d),b=1-U(a,h,d),E=1-U(a,l,d),y=U(a,l,f)),O.push(R[c]),O.push(k[c]),O.push(F[c])):38===c?(0===g?(w=1-U(e,f,h),_=U(e,d,h),S=U(e,d,l),E=U(a,d,l),y=1-U(a,f,l),m=1-U(e,f,l)):(w=U(a,h,f),_=1-U(a,h,d),S=1-U(a,l,d),E=1-U(e,l,d),y=U(e,l,f),m=U(a,l,f)),O.push(k[c]),O.push(D[c]),O.push(B[c])):39===c?(4===g?(w=1-U(e,f,h),_=U(e,d,h),S=U(e,d,l),E=U(a,d,l),y=1-U(a,f,l),m=1-U(e,f,l)):(w=U(a,h,f),_=1-U(a,h,d),S=1-U(a,l,d),E=1-U(e,l,d),y=U(e,l,f),m=U(a,l,f)),O.push(k[c]),O.push(j[c]),O.push(B[c])):85===c&&(x=1,w=0,_=1,b=0,S=0,E=1,y=0,m=1),(y<0||y>1||m<0||m>1||x<0||x>1||_<0||_>1||S<0||S>1||E<0||E>1)&&console.log("MarchingSquaresJS-isoBands: "+c+" "+p+" "+l+","+f+","+h+","+d+" "+g+" "+y+" "+m+" "+x+" "+w+" "+_+" "+b+" "+S+" "+E),o.cells[s][u]={cval:c,cval_real:p,flipped:g,topleft:y,topright:m,righttop:x,rightbottom:w,bottomright:_,bottomleft:b,leftbottom:S,lefttop:E,edges:O}}}}}return o}(n,r,i);return e.polygons?(e.verbose&&console.log("MarchingSquaresJS-isoBands: returning single polygons for each grid cell"),l=function(t){var e=[],n=0;return t.cells.forEach((function(t,r){t.forEach((function(t,i){if(void 0!==t){var o=G[t.cval](t);"object"==typeof o&&W(o)?"object"==typeof o[0]&&W(o[0])?"object"==typeof o[0][0]&&W(o[0][0])?o.forEach((function(t){t.forEach((function(t){t[0]+=i,t[1]+=r})),e[n++]=t})):(o.forEach((function(t){t[0]+=i,t[1]+=r})),e[n++]=o):console.log("MarchingSquaresJS-isoBands: bandcell polygon with malformed coordinates"):console.log("MarchingSquaresJS-isoBands: bandcell polygon with null coordinates")}}))})),e}(f)):(e.verbose&&console.log("MarchingSquaresJS-isoBands: returning polygon paths for entire data grid"),l=function(t){for(var e=[],n=t.rows,r=t.cols,i=[],o=0;o<n;o++)for(var a=0;a<r;a++)if(void 0!==t.cells[o][a]&&t.cells[o][a].edges.length>0){var s=X(t.cells[o][a]),u=null,c=a,l=o;null!==s&&i.push([s.p[0]+c,s.p[1]+l]);do{if(null===(u=H(t.cells[l][c],s.x,s.y,s.o)))break;if(i.push([u.p[0]+c,u.p[1]+l]),c+=u.x,l+=u.y,s=u,l<0||l>=n||c<0||c>=r||void 0===t.cells[l][c]){c-=u.x,l-=u.y;var f=q(t,c,l,u.x,u.y,u.o);if(null===f)break;f.path.forEach((function(t){i.push(t)})),c=f.i,l=f.j,s=f}}while(void 0!==t.cells[l][c]&&t.cells[l][c].edges.length>0);e.push(i),i=[],t.cells[o][a].edges.length>0&&a--}return e}(f)),"function"==typeof e.successCallback&&e.successCallback(l),l}},void 0===(r=function(){return{isoBands:i()}}.apply(e,[]))||(t.exports=r)},function(t,e,n){var r,i;
/*!
* @license GNU Affero General Public License.
* Copyright (c) 2015, 2015 Ronny Lorenz <ronny@tbi.univie.ac.at>
* v. 1.2.0
* https://github.com/RaumZeit/MarchingSquares.js
*/i=function(){var t={successCallback:null,verbose:!1},e={};function n(t,e,n){return(t-e)/(n-e)}function r(t){return 0===t.cval||15===t.cval}function i(t){r(t)||5===t.cval||10===t.cval||(t.cval=15)}function o(t,e){return"top"===e?[t.top,1]:"bottom"===e?[t.bottom,0]:"right"===e?[1,t.right]:"left"===e?[0,t.left]:void 0}return function(a,s,u){u=u||{};for(var c=Object.keys(t),l=0;l<c.length;l++){var f=c[l],h=u[f];h=null!=h?h:t[f],e[f]=h}e.verbose&&console.log("MarchingSquaresJS-isoContours: computing isocontour for "+s);var d,p,g,v=(d=function(t,e){for(var r=t.length-1,i=t[0].length-1,o={rows:r,cols:i,cells:[]},a=0;a<r;++a){o.cells[a]=[];for(var s=0;s<i;++s){var u=0,c=t[a+1][s],l=t[a+1][s+1],f=t[a][s+1],h=t[a][s];if(!(isNaN(c)||isNaN(l)||isNaN(f)||isNaN(h))){u|=c>=e?8:0,u|=l>=e?4:0,u|=f>=e?2:0;var d,p,g,v,y=!1;if(5==(u|=h>=e?1:0)||10===u){var m=(c+l+f+h)/4;5===u&&m<e?(u=10,y=!0):10===u&&m<e&&(u=5,y=!0)}0!=u&&15!=u&&(d=p=g=v=.5,1===u?(g=1-n(e,c,h),p=1-n(e,f,h)):2===u?(p=n(e,h,f),v=1-n(e,l,f)):3===u?(g=1-n(e,c,h),v=1-n(e,l,f)):4===u?(d=n(e,c,l),v=n(e,f,l)):5===u?(d=n(e,c,l),v=n(e,f,l),p=1-n(e,f,h),g=1-n(e,c,h)):6===u?(p=n(e,h,f),d=n(e,c,l)):7===u?(g=1-n(e,c,h),d=n(e,c,l)):8===u?(g=n(e,h,c),d=1-n(e,l,c)):9===u?(p=1-n(e,f,h),d=1-n(e,l,c)):10===u?(d=1-n(e,l,c),v=1-n(e,l,f),p=n(e,h,f),g=n(e,h,c)):11===u?(d=1-n(e,l,c),v=1-n(e,l,f)):12===u?(g=n(e,h,c),v=n(e,f,l)):13===u?(p=1-n(e,f,h),v=n(e,f,l)):14===u?(g=n(e,h,c),p=n(e,h,f)):console.log("MarchingSquaresJS-isoContours: Illegal cval detected: "+u),o.cells[a][s]={cval:u,flipped:y,top:d,right:v,bottom:p,left:g})}}}return o}(a,s),p=[],g=0,d.rows,d.cols,d.cells.forEach((function(t,e){t.forEach((function(t,n){if(void 0!==t&&5!==(h=t).cval&&10!==h.cval&&!r(t)){var a=function(t,e,n){var r,a,s,u=t.length,c=[],l=[0,0,1,1,0,0,0,0,-1,0,1,1,-1,0,-1,0],f=[0,-1,0,0,1,1,1,1,0,-1,0,0,0,-1,0,0],h=["none","bottom","right","right","top","top","top","top","left","bottom","right","right","left","bottom","left","none"],d=(t[e][n],t[e][n]),p=d.cval,g=o(d,s=["none","left","bottom","left","right","none","bottom","left","top","top","none","top","right","right","bottom","none"][p]);c.push([n+g[0],e+g[1]]),g=o(d,s=h[p]),c.push([n+g[0],e+g[1]]),i(d);for(var v=n+l[p],y=e+f[p],m=p;v>=0&&y>=0&&y<u&&(v!=n||y!=e)&&void 0!==(d=t[y][v]);){if(0===(p=d.cval)||15===p)return{path:c,info:"mergeable"};s=h[p],r=l[p],a=f[p],5!==p&&10!==p||(5===p?d.flipped?-1===f[m]?(s="left",r=-1,a=0):(s="right",r=1,a=0):-1===l[m]&&(s="bottom",r=0,a=-1):10===p&&(d.flipped?-1===l[m]?(s="top",r=0,a=1):(s="bottom",r=0,a=-1):1===f[m]&&(s="left",r=-1,a=0))),g=o(d,s),c.push([v+g[0],y+g[1]]),i(d),v+=r,y+=a,m=p}return{path:c,info:"closed"}}(d.cells,e,n),s=!1;if("mergeable"===a.info)for(var u=a.path[a.path.length-1][0],c=a.path[a.path.length-1][1],l=g-1;l>=0;l--)if(Math.abs(p[l][0][0]-u)<=1e-7&&Math.abs(p[l][0][1]-c)<=1e-7){for(var f=a.path.length-2;f>=0;--f)p[l].unshift(a.path[f]);s=!0;break}s||(p[g++]=a.path)}var h}))})),p);return"function"==typeof e.successCallback&&e.successCallback(v),v}},void 0===(r=function(){return{isoContours:i()}}.apply(e,[]))||(t.exports=r)},function(t,e,n){"use strict";var r=n(416),i=n(417),o=n(423);t.exports=function(t){var e=t.length;if(0===e)return[];if(1===e)return[[0]];var n=t[0].length;if(0===n)return[];if(1===n)return r(t);if(2===n)return i(t);return o(t,n)}},function(t,e,n){"use strict";t.exports=function(t){for(var e=0,n=0,r=1;r<t.length;++r)t[r][0]<t[e][0]&&(e=r),t[r][0]>t[n][0]&&(n=r);return e<n?[[e],[n]]:e>n?[[n],[e]]:[[e]]}},function(t,e,n){"use strict";t.exports=function(t){var e=r(t),n=e.length;if(n<=2)return[];for(var i=new Array(n),o=e[n-1],a=0;a<n;++a){var s=e[a];i[a]=[o,s],o=s}return i};var r=n(418)},function(t,e,n){"use strict";t.exports=function(t){var e=t.length;if(e<3){for(var n=new Array(e),i=0;i<e;++i)n[i]=i;return 2===e&&t[0][0]===t[1][0]&&t[0][1]===t[1][1]?[0]:n}var o=new Array(e);for(i=0;i<e;++i)o[i]=i;o.sort((function(e,n){var r=t[e][0]-t[n][0];return r||t[e][1]-t[n][1]}));var a=[o[0],o[1]],s=[o[0],o[1]];for(i=2;i<e;++i){for(var u=o[i],c=t[u],l=a.length;l>1&&r(t[a[l-2]],t[a[l-1]],c)<=0;)l-=1,a.pop();for(a.push(u),l=s.length;l>1&&r(t[s[l-2]],t[s[l-1]],c)>=0;)l-=1,s.pop();s.push(u)}n=new Array(s.length+a.length-2);for(var f=0,h=(i=0,a.length);i<h;++i)n[f++]=a[i];for(var d=s.length-2;d>0;--d)n[f++]=s[d];return n};var r=n(160)[3]},function(t,e,n){"use strict";t.exports=function(t,e){var n=0|t.length,r=0|e.length;if(1===n&&1===r)return function(t,e){var n=t+e,r=n-t,i=t-(n-r)+(e-r);if(i)return[i,n];return[n]}(t[0],e[0]);var i,o,a=new Array(n+r),s=0,u=0,c=0,l=Math.abs,f=t[u],h=l(f),d=e[c],p=l(d);h<p?(o=f,(u+=1)<n&&(f=t[u],h=l(f))):(o=d,(c+=1)<r&&(d=e[c],p=l(d)));u<n&&h<p||c>=r?(i=f,(u+=1)<n&&(f=t[u],h=l(f))):(i=d,(c+=1)<r&&(d=e[c],p=l(d)));var g,v,y=i+o,m=y-i,b=o-m,_=b,x=y;for(;u<n&&c<r;)h<p?(i=f,(u+=1)<n&&(f=t[u],h=l(f))):(i=d,(c+=1)<r&&(d=e[c],p=l(d))),(b=(o=_)-(m=(y=i+o)-i))&&(a[s++]=b),_=x-((g=x+y)-(v=g-x))+(y-v),x=g;for(;u<n;)(b=(o=_)-(m=(y=(i=f)+o)-i))&&(a[s++]=b),_=x-((g=x+y)-(v=g-x))+(y-v),x=g,(u+=1)<n&&(f=t[u]);for(;c<r;)(b=(o=_)-(m=(y=(i=d)+o)-i))&&(a[s++]=b),_=x-((g=x+y)-(v=g-x))+(y-v),x=g,(c+=1)<r&&(d=e[c]);_&&(a[s++]=_);x&&(a[s++]=x);s||(a[s++]=0);return a.length=s,a}},function(t,e,n){"use strict";var r=n(208),i=n(421);t.exports=function(t,e){var n=t.length;if(1===n){var o=r(t[0],e);return o[0]?o:[o[1]]}var a=new Array(2*n),s=[.1,.1],u=[.1,.1],c=0;r(t[0],e,s),s[0]&&(a[c++]=s[0]);for(var l=1;l<n;++l){r(t[l],e,u);var f=s[1];i(f,u[0],s),s[0]&&(a[c++]=s[0]);var h=u[1],d=s[1],p=h+d,g=d-(p-h);s[1]=p,g&&(a[c++]=g)}s[1]&&(a[c++]=s[1]);0===c&&(a[c++]=0);return a.length=c,a}},function(t,e,n){"use strict";t.exports=function(t,e,n){var r=t+e,i=r-t,o=e-i,a=t-(r-i);if(n)return n[0]=a+o,n[1]=r,n;return[a+o,r]}},function(t,e,n){"use strict";t.exports=function(t,e){var n=0|t.length,r=0|e.length;if(1===n&&1===r)return function(t,e){var n=t+e,r=n-t,i=t-(n-r)+(e-r);if(i)return[i,n];return[n]}(t[0],-e[0]);var i,o,a=new Array(n+r),s=0,u=0,c=0,l=Math.abs,f=t[u],h=l(f),d=-e[c],p=l(d);h<p?(o=f,(u+=1)<n&&(f=t[u],h=l(f))):(o=d,(c+=1)<r&&(d=-e[c],p=l(d)));u<n&&h<p||c>=r?(i=f,(u+=1)<n&&(f=t[u],h=l(f))):(i=d,(c+=1)<r&&(d=-e[c],p=l(d)));var g,v,y=i+o,m=y-i,b=o-m,_=b,x=y;for(;u<n&&c<r;)h<p?(i=f,(u+=1)<n&&(f=t[u],h=l(f))):(i=d,(c+=1)<r&&(d=-e[c],p=l(d))),(b=(o=_)-(m=(y=i+o)-i))&&(a[s++]=b),_=x-((g=x+y)-(v=g-x))+(y-v),x=g;for(;u<n;)(b=(o=_)-(m=(y=(i=f)+o)-i))&&(a[s++]=b),_=x-((g=x+y)-(v=g-x))+(y-v),x=g,(u+=1)<n&&(f=t[u]);for(;c<r;)(b=(o=_)-(m=(y=(i=d)+o)-i))&&(a[s++]=b),_=x-((g=x+y)-(v=g-x))+(y-v),x=g,(c+=1)<r&&(d=-e[c]);_&&(a[s++]=_);x&&(a[s++]=x);s||(a[s++]=0);return a.length=s,a}},function(t,e,n){"use strict";t.exports=function(t,e){try{return r(t,!0)}catch(a){var n=i(t);if(n.length<=e)return[];var o=function(t,e){for(var n=t.length,r=new Array(n),i=0;i<e.length;++i)r[i]=t[e[i]];var o=e.length;for(i=0;i<n;++i)e.indexOf(i)<0&&(r[o++]=t[i]);return r}(t,n);return function(t,e){for(var n=t.length,r=e.length,i=0;i<n;++i)for(var o=t[i],a=0;a<o.length;++a){var s=o[a];if(s<r)o[a]=e[s];else{s-=r;for(var u=0;u<r;++u)s>=e[u]&&(s+=1);o[a]=s}}return t}(r(o,!0),n)}};var r=n(424),i=n(428)},function(t,e,n){"use strict";t.exports=function(t,e){var n=t.length;if(0===n)throw new Error("Must have at least d+1 points");var i=t[0].length;if(n<=i)throw new Error("Must input at least d+1 points");var a=t.slice(0,i+1),s=r.apply(void 0,a);if(0===s)throw new Error("Input not in general position");for(var u=new Array(i+1),l=0;l<=i;++l)u[l]=l;s<0&&(u[0]=1,u[1]=0);var f=new o(u,new Array(i+1),!1),h=f.adjacent,d=new Array(i+2);for(l=0;l<=i;++l){for(var p=u.slice(),g=0;g<=i;++g)g===l&&(p[g]=-1);var v=p[0];p[0]=p[1],p[1]=v;var y=new o(p,new Array(i+1),!0);h[l]=y,d[l]=y}d[i+1]=f;for(l=0;l<=i;++l){p=h[l].vertices;var m=h[l].adjacent;for(g=0;g<=i;++g){var b=p[g];if(b<0)m[g]=f;else for(var _=0;_<=i;++_)h[_].vertices.indexOf(b)<0&&(m[g]=h[_])}}var x=new c(i,a,d),w=!!e;for(l=i+1;l<n;++l)x.insert(t[l],w);return x.boundary()};var r=n(160),i=n(425).compareCells;function o(t,e,n){this.vertices=t,this.adjacent=e,this.boundary=n,this.lastVisited=-1}function a(t,e,n){this.vertices=t,this.cell=e,this.index=n}function s(t,e){return i(t.vertices,e.vertices)}o.prototype.flip=function(){var t=this.vertices[0];this.vertices[0]=this.vertices[1],this.vertices[1]=t;var e=this.adjacent[0];this.adjacent[0]=this.adjacent[1],this.adjacent[1]=e};var u=[];function c(t,e,n){this.dimension=t,this.vertices=e,this.simplices=n,this.interior=n.filter((function(t){return!t.boundary})),this.tuple=new Array(t+1);for(var i=0;i<=t;++i)this.tuple[i]=this.vertices[i];var o=u[t];o||(o=u[t]=function(t){for(var e=["function orient(){var tuple=this.tuple;return test("],n=0;n<=t;++n)n>0&&e.push(","),e.push("tuple[",n,"]");e.push(")}return orient");var i=new Function("test",e.join("")),o=r[t+1];return o||(o=r),i(o)}(t)),this.orient=o}var l=c.prototype;l.handleBoundaryDegeneracy=function(t,e){var n=this.dimension,r=this.vertices.length-1,i=this.tuple,o=this.vertices,a=[t];for(t.lastVisited=-r;a.length>0;){(t=a.pop()).vertices;for(var s=t.adjacent,u=0;u<=n;++u){var c=s[u];if(c.boundary&&!(c.lastVisited<=-r)){for(var l=c.vertices,f=0;f<=n;++f){var h=l[f];i[f]=h<0?e:o[h]}var d=this.orient();if(d>0)return c;c.lastVisited=-r,0===d&&a.push(c)}}}return null},l.walk=function(t,e){var n=this.vertices.length-1,r=this.dimension,i=this.vertices,o=this.tuple,a=e?this.interior.length*Math.random()|0:this.interior.length-1,s=this.interior[a];t:for(;!s.boundary;){for(var u=s.vertices,c=s.adjacent,l=0;l<=r;++l)o[l]=i[u[l]];s.lastVisited=n;for(l=0;l<=r;++l){var f=c[l];if(!(f.lastVisited>=n)){var h=o[l];o[l]=t;var d=this.orient();if(o[l]=h,d<0){s=f;continue t}f.boundary?f.lastVisited=-n:f.lastVisited=n}}return}return s},l.addPeaks=function(t,e){var n=this.vertices.length-1,r=this.dimension,i=this.vertices,u=this.tuple,c=this.interior,l=this.simplices,f=[e];e.lastVisited=n,e.vertices[e.vertices.indexOf(-1)]=n,e.boundary=!1,c.push(e);for(var h=[];f.length>0;){var d=(e=f.pop()).vertices,p=e.adjacent,g=d.indexOf(n);if(!(g<0))for(var v=0;v<=r;++v)if(v!==g){var y=p[v];if(y.boundary&&!(y.lastVisited>=n)){var m=y.vertices;if(y.lastVisited!==-n){for(var b=0,_=0;_<=r;++_)m[_]<0?(b=_,u[_]=t):u[_]=i[m[_]];if(this.orient()>0){m[b]=n,y.boundary=!1,c.push(y),f.push(y),y.lastVisited=n;continue}y.lastVisited=-n}var x=y.adjacent,w=d.slice(),E=p.slice(),S=new o(w,E,!0);l.push(S);var O=x.indexOf(e);if(!(O<0)){x[O]=S,E[g]=y,w[v]=-1,E[v]=e,p[v]=S,S.flip();for(_=0;_<=r;++_){var P=w[_];if(!(P<0||P===n)){for(var C=new Array(r-1),M=0,I=0;I<=r;++I){var A=w[I];A<0||I===_||(C[M++]=A)}h.push(new a(C,S,_))}}}}}}h.sort(s);for(v=0;v+1<h.length;v+=2){var T=h[v],N=h[v+1],L=T.index,R=N.index;L<0||R<0||(T.cell.adjacent[T.index]=N.cell,N.cell.adjacent[N.index]=T.cell)}},l.insert=function(t,e){var n=this.vertices;n.push(t);var r=this.walk(t,e);if(r){for(var i=this.dimension,o=this.tuple,a=0;a<=i;++a){var s=r.vertices[a];o[a]=s<0?t:n[s]}var u=this.orient(o);u<0||(0!==u||(r=this.handleBoundaryDegeneracy(r,t)))&&this.addPeaks(t,r)}},l.boundary=function(){for(var t=this.dimension,e=[],n=this.simplices,r=n.length,i=0;i<r;++i){var o=n[i];if(o.boundary){for(var a=new Array(t),s=o.vertices,u=0,c=0,l=0;l<=t;++l)s[l]>=0?a[u++]=s[l]:c=1&l;if(c===(1&t)){var f=a[0];a[0]=a[1],a[1]=f}e.push(a)}}return e}},function(t,e,n){"use strict";var r=n(426),i=n(427);function o(t,e){var n=t.length,r=t.length-e.length,i=Math.min;if(r)return r;switch(n){case 0:return 0;case 1:return t[0]-e[0];case 2:return(s=t[0]+t[1]-e[0]-e[1])||i(t[0],t[1])-i(e[0],e[1]);case 3:var o=t[0]+t[1],a=e[0]+e[1];if(s=o+t[2]-(a+e[2]))return s;var s,u=i(t[0],t[1]),c=i(e[0],e[1]);return(s=i(u,t[2])-i(c,e[2]))||i(u+t[2],o)-i(c+e[2],a);default:var l=t.slice(0);l.sort();var f=e.slice(0);f.sort();for(var h=0;h<n;++h)if(r=l[h]-f[h])return r;return 0}}function a(t,e){return o(t[0],e[0])}function s(t,e){if(e){for(var n=t.length,r=new Array(n),i=0;i<n;++i)r[i]=[t[i],e[i]];r.sort(a);for(i=0;i<n;++i)t[i]=r[i][0],e[i]=r[i][1];return t}return t.sort(o),t}function u(t){if(0===t.length)return[];for(var e=1,n=t.length,r=1;r<n;++r){var i=t[r];if(o(i,t[r-1])){if(r===e){e++;continue}t[e++]=i}}return t.length=e,t}function c(t,e){for(var n=0,r=t.length-1,i=-1;n<=r;){var a=n+r>>1,s=o(t[a],e);s<=0?(0===s&&(i=a),n=a+1):s>0&&(r=a-1)}return i}function l(t,e){for(var n=new Array(t.length),i=0,a=n.length;i<a;++i)n[i]=[];for(var s=[],u=(i=0,e.length);i<u;++i)for(var l=e[i],f=l.length,h=1,d=1<<f;h<d;++h){s.length=r.popCount(h);for(var p=0,g=0;g<f;++g)h&1<<g&&(s[p++]=l[g]);var v=c(t,s);if(!(v<0))for(;n[v++].push(i),!(v>=t.length||0!==o(t[v],s)););}return n}function f(t,e){if(e<0)return[];for(var n=[],i=(1<<e+1)-1,o=0;o<t.length;++o)for(var a=t[o],u=i;u<1<<a.length;u=r.nextCombination(u)){for(var c=new Array(e+1),l=0,f=0;f<a.length;++f)u&1<<f&&(c[l++]=a[f]);n.push(c)}return s(n)}e.dimension=function(t){for(var e=0,n=Math.max,r=0,i=t.length;r<i;++r)e=n(e,t[r].length);return e-1},e.countVertices=function(t){for(var e=-1,n=Math.max,r=0,i=t.length;r<i;++r)for(var o=t[r],a=0,s=o.length;a<s;++a)e=n(e,o[a]);return e+1},e.cloneCells=function(t){for(var e=new Array(t.length),n=0,r=t.length;n<r;++n)e[n]=t[n].slice(0);return e},e.compareCells=o,e.normalize=s,e.unique=u,e.findCell=c,e.incidence=l,e.dual=function(t,e){if(!e)return l(u(f(t,0)),t);for(var n=new Array(e),r=0;r<e;++r)n[r]=[];r=0;for(var i=t.length;r<i;++r)for(var o=t[r],a=0,s=o.length;a<s;++a)n[o[a]].push(r);return n},e.explode=function(t){for(var e=[],n=0,r=t.length;n<r;++n)for(var i=t[n],o=0|i.length,a=1,u=1<<o;a<u;++a){for(var c=[],l=0;l<o;++l)a>>>l&1&&c.push(i[l]);e.push(c)}return s(e)},e.skeleton=f,e.boundary=function(t){for(var e=[],n=0,r=t.length;n<r;++n)for(var i=t[n],o=0,a=i.length;o<a;++o){for(var u=new Array(i.length-1),c=0,l=0;c<a;++c)c!==o&&(u[l++]=i[c]);e.push(u)}return s(e)},e.connectedComponents=function(t,e){return e?function(t,e){for(var n=new i(e),r=0;r<t.length;++r)for(var o=t[r],a=0;a<o.length;++a)for(var s=a+1;s<o.length;++s)n.link(o[a],o[s]);var u=[],c=n.ranks;for(r=0;r<c.length;++r)c[r]=-1;for(r=0;r<t.length;++r){var l=n.find(t[r][0]);c[l]<0?(c[l]=u.length,u.push([t[r].slice(0)])):u[c[l]].push(t[r].slice(0))}return u}(t,e):function(t){for(var e=u(s(f(t,0))),n=new i(e.length),r=0;r<t.length;++r)for(var o=t[r],a=0;a<o.length;++a)for(var l=c(e,[o[a]]),h=a+1;h<o.length;++h)n.link(l,c(e,[o[h]]));var d=[],p=n.ranks;for(r=0;r<p.length;++r)p[r]=-1;for(r=0;r<t.length;++r){var g=n.find(c(e,[t[r][0]]));p[g]<0?(p[g]=d.length,d.push([t[r].slice(0)])):d[p[g]].push(t[r].slice(0))}return d}(t)}},function(t,e,n){"use strict";function r(t){var e=32;return(t&=-t)&&e--,65535&t&&(e-=16),16711935&t&&(e-=8),252645135&t&&(e-=4),858993459&t&&(e-=2),1431655765&t&&(e-=1),e}e.INT_BITS=32,e.INT_MAX=2147483647,e.INT_MIN=-1<<31,e.sign=function(t){return(t>0)-(t<0)},e.abs=function(t){var e=t>>31;return(t^e)-e},e.min=function(t,e){return e^(t^e)&-(t<e)},e.max=function(t,e){return t^(t^e)&-(t<e)},e.isPow2=function(t){return!(t&t-1||!t)},e.log2=function(t){var e,n;return e=(t>65535)<<4,e|=n=((t>>>=e)>255)<<3,e|=n=((t>>>=n)>15)<<2,(e|=n=((t>>>=n)>3)<<1)|(t>>>=n)>>1},e.log10=function(t){return t>=1e9?9:t>=1e8?8:t>=1e7?7:t>=1e6?6:t>=1e5?5:t>=1e4?4:t>=1e3?3:t>=100?2:t>=10?1:0},e.popCount=function(t){return 16843009*((t=(858993459&(t-=t>>>1&1431655765))+(t>>>2&858993459))+(t>>>4)&252645135)>>>24},e.countTrailingZeros=r,e.nextPow2=function(t){return t+=0===t,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1},e.prevPow2=function(t){return t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)-(t>>>1)},e.parity=function(t){return t^=t>>>16,t^=t>>>8,t^=t>>>4,27030>>>(t&=15)&1};var i=new Array(256);!function(t){for(var e=0;e<256;++e){var n=e,r=e,i=7;for(n>>>=1;n;n>>>=1)r<<=1,r|=1&n,--i;t[e]=r<<i&255}}(i),e.reverse=function(t){return i[255&t]<<24|i[t>>>8&255]<<16|i[t>>>16&255]<<8|i[t>>>24&255]},e.interleave2=function(t,e){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t&=65535)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e&=65535)|e<<8))|e<<4))|e<<2))|e<<1))<<1},e.deinterleave2=function(t,e){return(t=65535&((t=16711935&((t=252645135&((t=858993459&((t=t>>>e&1431655765)|t>>>1))|t>>>2))|t>>>4))|t>>>16))<<16>>16},e.interleave3=function(t,e,n){return t=1227133513&((t=3272356035&((t=251719695&((t=4278190335&((t&=1023)|t<<16))|t<<8))|t<<4))|t<<2),(t|=(e=1227133513&((e=3272356035&((e=251719695&((e=4278190335&((e&=1023)|e<<16))|e<<8))|e<<4))|e<<2))<<1)|(n=1227133513&((n=3272356035&((n=251719695&((n=4278190335&((n&=1023)|n<<16))|n<<8))|n<<4))|n<<2))<<2},e.deinterleave3=function(t,e){return(t=1023&((t=4278190335&((t=251719695&((t=3272356035&((t=t>>>e&1227133513)|t>>>2))|t>>>4))|t>>>8))|t>>>16))<<22>>22},e.nextCombination=function(t){var e=t|t-1;return e+1|(~e&-~e)-1>>>r(t)+1}},function(t,e,n){"use strict";function r(t){this.roots=new Array(t),this.ranks=new Array(t);for(var e=0;e<t;++e)this.roots[e]=e,this.ranks[e]=0}t.exports=r;var i=r.prototype;Object.defineProperty(i,"length",{get:function(){return this.roots.length}}),i.makeSet=function(){var t=this.roots.length;return this.roots.push(t),this.ranks.push(0),t},i.find=function(t){for(var e=t,n=this.roots;n[t]!==t;)t=n[t];for(;n[e]!==t;){var r=n[e];n[e]=t,e=r}return t},i.link=function(t,e){var n=this.find(t),r=this.find(e);if(n!==r){var i=this.ranks,o=this.roots,a=i[n],s=i[r];a<s?o[n]=r:s<a?o[r]=n:(o[r]=n,++i[n])}}},function(t,e,n){"use strict";t.exports=function(t){var e=t.length;if(0===e)return[];if(1===e)return[0];for(var n=t[0].length,r=[t[0]],o=[0],a=1;a<e;++a)if(r.push(t[a]),i(r,n)){if(o.push(a),o.length===n+1)return o}else r.pop();return o};var r=n(160);function i(t,e){for(var n=new Array(e+1),i=0;i<t.length;++i)n[i]=t[i];for(i=0;i<=t.length;++i){for(var o=t.length;o<=e;++o){for(var a=new Array(e),s=0;s<e;++s)a[s]=Math.pow(o+1-i,s);n[o]=a}if(r.apply(void 0,n))return!0}return!1}},function(t,e,n){var r=n(548).topology,i=n(549).merge,o=n(430),a=n(91).geomEach,s=n(431);function u(t){return t.length?Array.isArray(t[0])?t[0]:Array.prototype.slice.call(t):[]}function c(t){var e={geoms:{type:"GeometryCollection",geometries:JSON.parse(JSON.stringify(t))}},n=r(e);return i(n,n.objects.geoms.geometries)}function l(t){for(var e=null,n=0;n<t.length;n++)if(e){if(e!==t[n].type)return null}else e=t[n].type;return e}t.exports=function(){var t=u(arguments),e=t.reduce((function(t,e){var n=s(e);Array.isArray(n)||(n=[n]);for(var r=0;r<n.length;r++)a(n[r],(function(e){t.push(e)}));return t}),[]),n=l(e);if(!n)throw new Error("List does not contain only homoegenous GeoJSON");switch(n){case"LineString":return o(e);case"Polygon":return c(e);default:return e}}},function(t,e){function n(t){return t[0].toString()+","+t[1].toString()}function r(t,e){var r,i=n(t.coordinates[0]),o=n(t.coordinates[t.coordinates.length-1]),a=n(e.coordinates[0]),s=n(e.coordinates[e.coordinates.length-1]);if(i===s)r=e.coordinates.concat(t.coordinates.slice(1));else if(a===o)r=t.coordinates.concat(e.coordinates.slice(1));else if(i===a)r=t.coordinates.slice(1).reverse().concat(e.coordinates);else{if(o!==s)return null;r=t.coordinates.concat(e.coordinates.reverse().slice(1))}return{type:"LineString",coordinates:r}}t.exports=function(t){var e=t.slice(),n=[];for(;e.length>0;){var i=e.shift();e=e.reduce((function(t,e){var n=r(i,e);return n?i=n:t.push(e),t}),[]),n.push(i)}n=1===n.length?n[0]:{type:"MultiLineString",coordinates:n.map((function(t){return t.coordinates}))};return n}},function(t,e){t.exports=function t(e){switch(e&&e.type||null){case"FeatureCollection":return e.features=e.features.reduce((function(e,n){return e.concat(t(n))}),[]),e;case"Feature":return e.geometry?t(e.geometry).map((function(t){var n={type:"Feature",properties:JSON.parse(JSON.stringify(e.properties)),geometry:t};return void 0!==e.id&&(n.id=e.id),n})):e;case"MultiPoint":return e.coordinates.map((function(t){return{type:"Point",coordinates:t}}));case"MultiPolygon":return e.coordinates.map((function(t){return{type:"Polygon",coordinates:t}}));case"MultiLineString":return e.coordinates.map((function(t){return{type:"LineString",coordinates:t}}));case"GeometryCollection":return e.geometries.map(t).reduce((function(t,e){return t.concat(e)}),[]);case"Point":case"Polygon":case"LineString":return[e]}}},function(t,e){t.exports.RADIUS=6378137,t.exports.FLATTENING=1/298.257223563,t.exports.POLAR_RADIUS=6356752.3142},function(t,e,n){var r=n(15),i=n(16),o=n(163),a=n(73),s=n(222),u=r.coordAll,c=r.segmentEach,l=i.getGeomType;t.exports=function(t,e){if(!t)throw new Error("feature1 is required");if(!e)throw new Error("feature2 is required");var n=l(t);if(n!==l(e))throw new Error("features must be of the same type");if("Point"===n)throw new Error("Point geometry not supported");if(new s({precision:6}).compare(t,e))return!1;var r=0;switch(n){case"MultiPoint":var i=u(t),f=u(e);i.forEach((function(t){f.forEach((function(e){t[0]===e[0]&&t[1]===e[1]&&r++}))}));break;case"LineString":case"MultiLineString":c(t,(function(t){c(e,(function(e){o(t,e).features.length&&r++}))}));break;case"Polygon":case"MultiPolygon":c(t,(function(t){c(e,(function(e){a(t,e).features.length&&r++}))}))}return r>0}},function(t,e,n){"use strict";var r;if(!Object.keys){var i=Object.prototype.hasOwnProperty,o=Object.prototype.toString,a=n(216),s=Object.prototype.propertyIsEnumerable,u=!s.call({toString:null},"toString"),c=s.call((function(){}),"prototype"),l=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],f=function(t){var e=t.constructor;return e&&e.prototype===t},h={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},d=function(){if("undefined"==typeof window)return!1;for(var t in window)try{if(!h["$"+t]&&i.call(window,t)&&null!==window[t]&&"object"==typeof window[t])try{f(window[t])}catch(t){return!0}}catch(t){return!0}return!1}();r=function(t){var e=null!==t&&"object"==typeof t,n="[object Function]"===o.call(t),r=a(t),s=e&&"[object String]"===o.call(t),h=[];if(!e&&!n&&!r)throw new TypeError("Object.keys called on a non-object");var p=c&&n;if(s&&t.length>0&&!i.call(t,0))for(var g=0;g<t.length;++g)h.push(String(g));if(r&&t.length>0)for(var v=0;v<t.length;++v)h.push(String(v));else for(var y in t)p&&"prototype"===y||!i.call(t,y)||h.push(String(y));if(u)for(var m=function(t){if("undefined"==typeof window||!d)return f(t);try{return f(t)}catch(t){return!1}}(t),b=0;b<l.length;++b)m&&"constructor"===l[b]||!i.call(t,l[b])||h.push(l[b]);return h}}t.exports=r},function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,i=Object.prototype.toString,o=function(t){return!(r&&t&&"object"==typeof t&&Symbol.toStringTag in t)&&"[object Arguments]"===i.call(t)},a=function(t){return!!o(t)||null!==t&&"object"==typeof t&&"number"==typeof t.length&&t.length>=0&&"[object Array]"!==i.call(t)&&"[object Function]"===i.call(t.callee)},s=function(){return o(arguments)}();o.isLegacyArguments=a,t.exports=s?o:a},function(t,e,n){"use strict";var r=n(92),i=n(217),o=n(218),a=n(219),s=n(441),u=i(a(),Object);r(u,{getPolyfill:a,implementation:o,shim:s}),t.exports=u},function(t,e,n){"use strict";var r="Function.prototype.bind called on incompatible ",i=Array.prototype.slice,o=Object.prototype.toString;t.exports=function(t){var e=this;if("function"!=typeof e||"[object Function]"!==o.call(e))throw new TypeError(r+e);for(var n,a=i.call(arguments,1),s=function(){if(this instanceof n){var r=e.apply(this,a.concat(i.call(arguments)));return Object(r)===r?r:this}return e.apply(t,a.concat(i.call(arguments)))},u=Math.max(0,e.length-a.length),c=[],l=0;l<u;l++)c.push("$"+l);if(n=Function("binder","return function ("+c.join(",")+"){ return binder.apply(this,arguments); }")(s),e.prototype){var f=function(){};f.prototype=e.prototype,n.prototype=new f,f.prototype=null}return n}},function(t,e,n){"use strict";var r=TypeError,i=Object.getOwnPropertyDescriptor;if(i)try{i({},"")}catch(t){i=null}var o=function(){throw new r},a=i?function(){try{return arguments.callee,o}catch(t){try{return i(arguments,"callee").get}catch(t){return o}}}():o,s=n(439)(),u=Object.getPrototypeOf||function(t){return t.__proto__},c=void 0,l="undefined"==typeof Uint8Array?void 0:u(Uint8Array),f={"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?void 0:ArrayBuffer,"%ArrayBufferPrototype%":"undefined"==typeof ArrayBuffer?void 0:ArrayBuffer.prototype,"%ArrayIteratorPrototype%":s?u([][Symbol.iterator]()):void 0,"%ArrayPrototype%":Array.prototype,"%ArrayProto_entries%":Array.prototype.entries,"%ArrayProto_forEach%":Array.prototype.forEach,"%ArrayProto_keys%":Array.prototype.keys,"%ArrayProto_values%":Array.prototype.values,"%AsyncFromSyncIteratorPrototype%":void 0,"%AsyncFunction%":void 0,"%AsyncFunctionPrototype%":void 0,"%AsyncGenerator%":void 0,"%AsyncGeneratorFunction%":void 0,"%AsyncGeneratorPrototype%":void 0,"%AsyncIteratorPrototype%":c&&s&&Symbol.asyncIterator?c[Symbol.asyncIterator]():void 0,"%Atomics%":"undefined"==typeof Atomics?void 0:Atomics,"%Boolean%":Boolean,"%BooleanPrototype%":Boolean.prototype,"%DataView%":"undefined"==typeof DataView?void 0:DataView,"%DataViewPrototype%":"undefined"==typeof DataView?void 0:DataView.prototype,"%Date%":Date,"%DatePrototype%":Date.prototype,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%ErrorPrototype%":Error.prototype,"%eval%":eval,"%EvalError%":EvalError,"%EvalErrorPrototype%":EvalError.prototype,"%Float32Array%":"undefined"==typeof Float32Array?void 0:Float32Array,"%Float32ArrayPrototype%":"undefined"==typeof Float32Array?void 0:Float32Array.prototype,"%Float64Array%":"undefined"==typeof Float64Array?void 0:Float64Array,"%Float64ArrayPrototype%":"undefined"==typeof Float64Array?void 0:Float64Array.prototype,"%Function%":Function,"%FunctionPrototype%":Function.prototype,"%Generator%":void 0,"%GeneratorFunction%":void 0,"%GeneratorPrototype%":void 0,"%Int8Array%":"undefined"==typeof Int8Array?void 0:Int8Array,"%Int8ArrayPrototype%":"undefined"==typeof Int8Array?void 0:Int8Array.prototype,"%Int16Array%":"undefined"==typeof Int16Array?void 0:Int16Array,"%Int16ArrayPrototype%":"undefined"==typeof Int16Array?void 0:Int8Array.prototype,"%Int32Array%":"undefined"==typeof Int32Array?void 0:Int32Array,"%Int32ArrayPrototype%":"undefined"==typeof Int32Array?void 0:Int32Array.prototype,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":s?u(u([][Symbol.iterator]())):void 0,"%JSON%":"object"==typeof JSON?JSON:void 0,"%JSONParse%":"object"==typeof JSON?JSON.parse:void 0,"%Map%":"undefined"==typeof Map?void 0:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&s?u((new Map)[Symbol.iterator]()):void 0,"%MapPrototype%":"undefined"==typeof Map?void 0:Map.prototype,"%Math%":Math,"%Number%":Number,"%NumberPrototype%":Number.prototype,"%Object%":Object,"%ObjectPrototype%":Object.prototype,"%ObjProto_toString%":Object.prototype.toString,"%ObjProto_valueOf%":Object.prototype.valueOf,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?void 0:Promise,"%PromisePrototype%":"undefined"==typeof Promise?void 0:Promise.prototype,"%PromiseProto_then%":"undefined"==typeof Promise?void 0:Promise.prototype.then,"%Promise_all%":"undefined"==typeof Promise?void 0:Promise.all,"%Promise_reject%":"undefined"==typeof Promise?void 0:Promise.reject,"%Promise_resolve%":"undefined"==typeof Promise?void 0:Promise.resolve,"%Proxy%":"undefined"==typeof Proxy?void 0:Proxy,"%RangeError%":RangeError,"%RangeErrorPrototype%":RangeError.prototype,"%ReferenceError%":ReferenceError,"%ReferenceErrorPrototype%":ReferenceError.prototype,"%Reflect%":"undefined"==typeof Reflect?void 0:Reflect,"%RegExp%":RegExp,"%RegExpPrototype%":RegExp.prototype,"%Set%":"undefined"==typeof Set?void 0:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&s?u((new Set)[Symbol.iterator]()):void 0,"%SetPrototype%":"undefined"==typeof Set?void 0:Set.prototype,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?void 0:SharedArrayBuffer,"%SharedArrayBufferPrototype%":"undefined"==typeof SharedArrayBuffer?void 0:SharedArrayBuffer.prototype,"%String%":String,"%StringIteratorPrototype%":s?u(""[Symbol.iterator]()):void 0,"%StringPrototype%":String.prototype,"%Symbol%":s?Symbol:void 0,"%SymbolPrototype%":s?Symbol.prototype:void 0,"%SyntaxError%":SyntaxError,"%SyntaxErrorPrototype%":SyntaxError.prototype,"%ThrowTypeError%":a,"%TypedArray%":l,"%TypedArrayPrototype%":l?l.prototype:void 0,"%TypeError%":r,"%TypeErrorPrototype%":r.prototype,"%Uint8Array%":"undefined"==typeof Uint8Array?void 0:Uint8Array,"%Uint8ArrayPrototype%":"undefined"==typeof Uint8Array?void 0:Uint8Array.prototype,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?void 0:Uint8ClampedArray,"%Uint8ClampedArrayPrototype%":"undefined"==typeof Uint8ClampedArray?void 0:Uint8ClampedArray.prototype,"%Uint16Array%":"undefined"==typeof Uint16Array?void 0:Uint16Array,"%Uint16ArrayPrototype%":"undefined"==typeof Uint16Array?void 0:Uint16Array.prototype,"%Uint32Array%":"undefined"==typeof Uint32Array?void 0:Uint32Array,"%Uint32ArrayPrototype%":"undefined"==typeof Uint32Array?void 0:Uint32Array.prototype,"%URIError%":URIError,"%URIErrorPrototype%":URIError.prototype,"%WeakMap%":"undefined"==typeof WeakMap?void 0:WeakMap,"%WeakMapPrototype%":"undefined"==typeof WeakMap?void 0:WeakMap.prototype,"%WeakSet%":"undefined"==typeof WeakSet?void 0:WeakSet,"%WeakSetPrototype%":"undefined"==typeof WeakSet?void 0:WeakSet.prototype},h=n(164).call(Function.call,String.prototype.replace),d=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,p=/\\(\\)?/g,g=function(t){var e=[];return h(t,d,(function(t,n,r,i){e[e.length]=r?h(i,p,"$1"):n||t})),e},v=function(t,e){if(!(t in f))throw new SyntaxError("intrinsic "+t+" does not exist!");if(void 0===f[t]&&!e)throw new r("intrinsic "+t+" exists, but is not available. Please file an issue!");return f[t]};t.exports=function(t,e){if("string"!=typeof t||0===t.length)throw new TypeError("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof e)throw new TypeError('"allowMissing" argument must be a boolean');for(var n=g(t),o=v("%"+(n.length>0?n[0]:"")+"%",e),a=1;a<n.length;a+=1)if(null!=o)if(i&&a+1>=n.length){var s=i(o,n[a]);if(!e&&!(n[a]in o))throw new r("base intrinsic for "+t+" exists, but the property is not available.");o=s?s.get||s.value:o[n[a]]}else o=o[n[a]];return o}},function(t,e,n){"use strict";(function(e){var r=e.Symbol,i=n(440);t.exports=function(){return"function"==typeof r&&("function"==typeof Symbol&&("symbol"==typeof r("foo")&&("symbol"==typeof Symbol("bar")&&i())))}}).call(this,n(50))},function(t,e,n){"use strict";t.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var t={},e=Symbol("test"),n=Object(e);if("string"==typeof e)return!1;if("[object Symbol]"!==Object.prototype.toString.call(e))return!1;if("[object Symbol]"!==Object.prototype.toString.call(n))return!1;for(e in t[e]=42,t)return!1;if("function"==typeof Object.keys&&0!==Object.keys(t).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(t).length)return!1;var r=Object.getOwnPropertySymbols(t);if(1!==r.length||r[0]!==e)return!1;if(!Object.prototype.propertyIsEnumerable.call(t,e))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var i=Object.getOwnPropertyDescriptor(t,e);if(42!==i.value||!0!==i.enumerable)return!1}return!0}},function(t,e,n){"use strict";var r=n(219),i=n(92);t.exports=function(){var t=r();return i(Object,{is:t},{is:function(){return Object.is!==t}}),t}},function(t,e,n){"use strict";var r=n(443),i=RegExp.prototype.exec,o=Object.getOwnPropertyDescriptor,a=Object.prototype.toString,s="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag;t.exports=function(t){if(!t||"object"!=typeof t)return!1;if(!s)return"[object RegExp]"===a.call(t);var e=o(t,"lastIndex");return!(!e||!r(e,"value"))&&function(t){try{var e=t.lastIndex;return t.lastIndex=0,i.call(t),!0}catch(t){return!1}finally{t.lastIndex=e}}(t)}},function(t,e,n){"use strict";var r=n(164);t.exports=r.call(Function.call,Object.prototype.hasOwnProperty)},function(t,e,n){"use strict";var r=n(92),i=n(217),o=n(220),a=n(221),s=n(445),u=i(o);r(u,{getPolyfill:a,implementation:o,shim:s}),t.exports=u},function(t,e,n){"use strict";var r=n(92).supportsDescriptors,i=n(221),o=Object.getOwnPropertyDescriptor,a=Object.defineProperty,s=TypeError,u=Object.getPrototypeOf,c=/a/;t.exports=function(){if(!r||!u)throw new s("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var t=i(),e=u(c),n=o(e,"flags");return n&&n.get===t||a(e,"flags",{configurable:!0,enumerable:!1,get:t}),t}},function(t,e,n){"use strict";var r=Date.prototype.getDay,i=Object.prototype.toString,o="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag;t.exports=function(t){return"object"==typeof t&&null!==t&&(o?function(t){try{return r.call(t),!0}catch(t){return!1}}(t):"[object Date]"===i.call(t))}},function(t,e,n){!function(){var e=this.gju={};function n(t){for(var e=[],n=[],r=0;r<t[0].length;r++)e.push(t[0][r][1]),n.push(t[0][r][0]);return e=e.sort((function(t,e){return t-e})),n=n.sort((function(t,e){return t-e})),[[e[0],n[0]],[e[e.length-1],n[n.length-1]]]}function r(t,e,n){for(var r=[[0,0]],i=0;i<n.length;i++){for(var o=0;o<n[i].length;o++)r.push(n[i][o]);r.push(n[i][0]),r.push([0,0])}var a=!1;for(i=0,o=r.length-1;i<r.length;o=i++)r[i][0]>e!=r[o][0]>e&&t<(r[o][1]-r[i][1])*(e-r[i][0])/(r[o][0]-r[i][0])+r[i][1]&&(a=!a);return a}t.exports&&(t.exports=e),e.lineStringsIntersect=function(t,e){for(var n=[],r=0;r<=t.coordinates.length-2;++r)for(var i=0;i<=e.coordinates.length-2;++i){var o={x:t.coordinates[r][1],y:t.coordinates[r][0]},a={x:t.coordinates[r+1][1],y:t.coordinates[r+1][0]},s={x:e.coordinates[i][1],y:e.coordinates[i][0]},u={x:e.coordinates[i+1][1],y:e.coordinates[i+1][0]},c=(u.y-s.y)*(a.x-o.x)-(u.x-s.x)*(a.y-o.y);if(0!=c){var l=((u.x-s.x)*(o.y-s.y)-(u.y-s.y)*(o.x-s.x))/c,f=((a.x-o.x)*(o.y-s.y)-(a.y-o.y)*(o.x-s.x))/c;0<=l&&l<=1&&0<=f&&f<=1&&n.push({type:"Point",coordinates:[o.x+l*(a.x-o.x),o.y+l*(a.y-o.y)]})}}return 0==n.length&&(n=!1),n},e.pointInBoundingBox=function(t,e){return!(t.coordinates[1]<e[0][0]||t.coordinates[1]>e[1][0]||t.coordinates[0]<e[0][1]||t.coordinates[0]>e[1][1])},e.pointInPolygon=function(t,i){for(var o="Polygon"==i.type?[i.coordinates]:i.coordinates,a=!1,s=0;s<o.length;s++)e.pointInBoundingBox(t,n(o[s]))&&(a=!0);if(!a)return!1;var u=!1;for(s=0;s<o.length;s++)r(t.coordinates[1],t.coordinates[0],o[s])&&(u=!0);return u},e.pointInMultiPolygon=function(t,i){for(var o="MultiPolygon"==i.type?[i.coordinates]:i.coordinates,a=!1,s=!1,u=0;u<o.length;u++){for(var c=o[u],l=0;l<c.length;l++)a||e.pointInBoundingBox(t,n(c[l]))&&(a=!0);if(!a)return!1;for(l=0;l<c.length;l++)s||r(t.coordinates[1],t.coordinates[0],c[l])&&(s=!0)}return s},e.numberToRadius=function(t){return t*Math.PI/180},e.numberToDegree=function(t){return 180*t/Math.PI},e.drawCircle=function(t,n,r){for(var i=[n.coordinates[1],n.coordinates[0]],o=t/1e3/6371,a=[e.numberToRadius(i[0]),e.numberToRadius(i[1])],s=(r=r||15,[[i[0],i[1]]]),u=0;u<r;u++){var c=2*Math.PI*u/r,l=Math.asin(Math.sin(a[0])*Math.cos(o)+Math.cos(a[0])*Math.sin(o)*Math.cos(c)),f=a[1]+Math.atan2(Math.sin(c)*Math.sin(o)*Math.cos(a[0]),Math.cos(o)-Math.sin(a[0])*Math.sin(l));s[u]=[],s[u][1]=e.numberToDegree(l),s[u][0]=e.numberToDegree(f)}return{type:"Polygon",coordinates:[s]}},e.rectangleCentroid=function(t){var e=t.coordinates[0],n=e[0][0],r=e[0][1];return{type:"Point",coordinates:[n+(e[2][0]-n)/2,r+(e[2][1]-r)/2]}},e.pointDistance=function(t,n){var r=t.coordinates[0],i=t.coordinates[1],o=n.coordinates[0],a=n.coordinates[1],s=e.numberToRadius(a-i),u=e.numberToRadius(o-r),c=Math.pow(Math.sin(s/2),2)+Math.cos(e.numberToRadius(i))*Math.cos(e.numberToRadius(a))*Math.pow(Math.sin(u/2),2);return 6371*(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)))*1e3},e.geometryWithinRadius=function(t,n,r){if("Point"==t.type)return e.pointDistance(t,n)<=r;if("LineString"==t.type||"Polygon"==t.type){var i,o={};for(var a in i="Polygon"==t.type?t.coordinates[0]:t.coordinates)if(o.coordinates=i[a],e.pointDistance(o,n)>r)return!1}return!0},e.area=function(t){for(var e=0,n=t.coordinates[0],r=n.length-1,i=0;i<n.length;r=i++){var o={x:n[i][1],y:n[i][0]},a={x:n[r][1],y:n[r][0]};e+=o.x*a.y,e-=o.y*a.x}return e/=2},e.centroid=function(t){for(var n,r=0,i=0,o=t.coordinates[0],a=o.length-1,s=0;s<o.length;a=s++){var u={x:o[s][1],y:o[s][0]},c={x:o[a][1],y:o[a][0]};r+=(u.x+c.x)*(n=u.x*c.y-c.x*u.y),i+=(u.y+c.y)*n}return{type:"Point",coordinates:[i/(n=6*e.area(t)),r/n]}},e.simplify=function(t,e){var n,r,i,o,a,s,u,c,l,f,h,d,p,g,v,y,m,b;e=e||20,t=t.map((function(t){return{lng:t.coordinates[0],lat:t.coordinates[1]}}));var _=Math.PI/180*.5,x=new Array,w=new Array,E=new Array;if(t.length<3)return t;for(n=t.length,l=360*e/(2*Math.PI*6378137),l*=l,i=0,w[0]=0,E[0]=n-1,r=1;r>0;)if(o=w[r-1],a=E[r-1],r--,a-o>1){for(f=t[a].lng()-t[o].lng(),h=t[a].lat()-t[o].lat(),Math.abs(f)>180&&(f=360-Math.abs(f)),d=(f*=Math.cos(_*(t[a].lat()+t[o].lat())))*f+h*h,O=o+1,s=o,c=-1;O<a;O++)p=t[O].lng()-t[o].lng(),g=t[O].lat()-t[o].lat(),Math.abs(p)>180&&(p=360-Math.abs(p)),v=(p*=Math.cos(_*(t[O].lat()+t[o].lat())))*p+g*g,y=t[O].lng()-t[a].lng(),m=t[O].lat()-t[a].lat(),Math.abs(y)>180&&(y=360-Math.abs(y)),(u=v>=d+(b=(y*=Math.cos(_*(t[O].lat()+t[a].lat())))*y+m*m)?b:b>=d+v?v:(p*h-g*f)*(p*h-g*f)/d)>c&&(s=O,c=u);c<l?(x[i]=o,i++):(w[++r-1]=s,E[r-1]=a,w[++r-1]=o,E[r-1]=s)}else x[i]=o,i++;x[i]=n-1,i++;for(var S=new Array,O=0;O<i;O++)S.push(t[x[O]]);return S.map((function(t){return{type:"Point",coordinates:[t.lng,t.lat]}}))},e.destinationPoint=function(t,n,r){r/=6371,n=e.numberToRadius(n);var i=e.numberToRadius(t.coordinates[0]),o=e.numberToRadius(t.coordinates[1]),a=Math.asin(Math.sin(o)*Math.cos(r)+Math.cos(o)*Math.sin(r)*Math.cos(n)),s=i+Math.atan2(Math.sin(n)*Math.sin(r)*Math.cos(o),Math.cos(r)-Math.sin(o)*Math.sin(a));return s=(s+3*Math.PI)%(2*Math.PI)-Math.PI,{type:"Point",coordinates:[e.numberToDegree(s),e.numberToDegree(a)]}}}()},function(t,e,n){"use strict";
/**
* @license get-closest https://github.com/cosmosio/get-closest
*
* The MIT License (MIT)
*
* Copyright (c) 2014-2017 Olivier Scherrer <pode.fr@gmail.com>
*/function r(t,e,n){var r,i;if(!Array.isArray(e))throw new Error("Get closest expects an array as second argument");return e.forEach((function(e,o){var a=n(e,t);a>=0&&(void 0===i||a<i)&&(i=a,r=o)})),r}t.exports={number:function(t,e){return r(t,e,(function(t,e){return Math.abs(t-e)}))},greaterNumber:function(t,e){return r(t,e,(function(t,e){return t-e}))},lowerNumber:function(t,e){return r(t,e,(function(t,e){return e-t}))},custom:function(t,e,n){return r(t,e,n)}}},function(t,e,n){var r;!function(){"use strict";function i(t,e,n){var r=e.x,i=e.y,o=n.x-r,a=n.y-i;if(0!==o||0!==a){var s=((t.x-r)*o+(t.y-i)*a)/(o*o+a*a);s>1?(r=n.x,i=n.y):s>0&&(r+=o*s,i+=a*s)}return(o=t.x-r)*o+(a=t.y-i)*a}function o(t,e){var n=t.length-1,r=[t[0]];return function t(e,n,r,o,a){for(var s,u=o,c=n+1;c<r;c++){var l=i(e[c],e[n],e[r]);l>u&&(s=c,u=l)}u>o&&(s-n>1&&t(e,n,s,o,a),a.push(e[s]),r-s>1&&t(e,s,r,o,a))}(t,0,n,e,r),r.push(t[n]),r}function a(t,e,n){if(t.length<=2)return t;var r=void 0!==e?e*e:1;return t=o(t=n?t:function(t,e){for(var n,r,i,o,a,s=t[0],u=[s],c=1,l=t.length;c<l;c++)n=t[c],i=s,o=void 0,a=void 0,o=(r=n).x-i.x,a=r.y-i.y,o*o+a*a>e&&(u.push(n),s=n);return s!==n&&u.push(n),u}(t,r),r)}void 0===(r=function(){return a}.call(e,n,e,t))||(t.exports=r)}()},function(t,e){var n=function(t){this.points=t.points||[],this.duration=t.duration||1e4,this.sharpness=t.sharpness||.85,this.centers=[],this.controls=[],this.stepLength=t.stepLength||60,this.length=this.points.length,this.delay=0;for(var e=0;e<this.length;e++)this.points[e].z=this.points[e].z||0;for(e=0;e<this.length-1;e++){var n=this.points[e],r=this.points[e+1];this.centers.push({x:(n.x+r.x)/2,y:(n.y+r.y)/2,z:(n.z+r.z)/2})}this.controls.push([this.points[0],this.points[0]]);for(e=0;e<this.centers.length-1;e++){n=this.centers[e],r=this.centers[e+1];var i=this.points[e+1].x-(this.centers[e].x+this.centers[e+1].x)/2,o=this.points[e+1].y-(this.centers[e].y+this.centers[e+1].y)/2,a=this.points[e+1].z-(this.centers[e].y+this.centers[e+1].z)/2;this.controls.push([{x:(1-this.sharpness)*this.points[e+1].x+this.sharpness*(this.centers[e].x+i),y:(1-this.sharpness)*this.points[e+1].y+this.sharpness*(this.centers[e].y+o),z:(1-this.sharpness)*this.points[e+1].z+this.sharpness*(this.centers[e].z+a)},{x:(1-this.sharpness)*this.points[e+1].x+this.sharpness*(this.centers[e+1].x+i),y:(1-this.sharpness)*this.points[e+1].y+this.sharpness*(this.centers[e+1].y+o),z:(1-this.sharpness)*this.points[e+1].z+this.sharpness*(this.centers[e+1].z+a)}])}return this.controls.push([this.points[this.length-1],this.points[this.length-1]]),this.steps=this.cacheSteps(this.stepLength),this};n.prototype.cacheSteps=function(t){var e=[],n=this.pos(0);e.push(0);for(var r=0;r<this.duration;r+=10){var i=this.pos(r);Math.sqrt((i.x-n.x)*(i.x-n.x)+(i.y-n.y)*(i.y-n.y)+(i.z-n.z)*(i.z-n.z))>t&&(e.push(r),n=i)}return e},n.prototype.vector=function(t){var e=this.pos(t+10),n=this.pos(t-10);return{angle:180*Math.atan2(e.y-n.y,e.x-n.x)/3.14,speed:Math.sqrt((n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y)+(n.z-e.z)*(n.z-e.z))}},n.prototype.pos=function(t){var e=t-this.delay;e<0&&(e=0),e>this.duration&&(e=this.duration-1);var n=e/this.duration;if(n>=1)return this.points[this.length-1];var r=Math.floor((this.points.length-1)*n);return function(t,e,n,r,i){var o=function(t){var e=t*t;return[e*t,3*e*(1-t),3*t*(1-t)*(1-t),(1-t)*(1-t)*(1-t)]}(t);return{x:i.x*o[0]+r.x*o[1]+n.x*o[2]+e.x*o[3],y:i.y*o[0]+r.y*o[1]+n.y*o[2]+e.y*o[3],z:i.z*o[0]+r.z*o[1]+n.z*o[2]+e.z*o[3]}}((this.length-1)*n-r,this.points[r],this.controls[r][1],this.controls[r+1][0],this.points[r+1])},t.exports=n},function(t,e,n){var r=n(452),i=n(233).point;t.exports=function(t,e){var n=r(t),o=(n[0]+n[2])/2,a=(n[1]+n[3])/2;return i([o,a],e)}},function(t,e,n){var r=n(232).coordEach;t.exports=function(t){var e=[1/0,1/0,-1/0,-1/0];return r(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}},function(t,e,n){var r=n(15).coordEach,i=n(95);function o(t,e,n){if(!t)throw new Error("geojson is required");return!0!==e&&(t=i(t)),r(t,(function(t){var e,r,i,o="mercator"===n?function(t){var e=Math.PI/180,n=6378137,r=20037508.342789244,i=Math.abs(t[0])<=180?t[0]:t[0]-360*(a=t[0],a<0?-1:a>0?1:0),o=[n*i*e,n*Math.log(Math.tan(.25*Math.PI+.5*t[1]*e))];var a;o[0]>r&&(o[0]=r);o[0]<-r&&(o[0]=-r);o[1]>r&&(o[1]=r);o[1]<-r&&(o[1]=-r);return o}(t):(e=t,r=180/Math.PI,i=6378137,[e[0]*r/i,(.5*Math.PI-2*Math.atan(Math.exp(-e[1]/i)))*r]);t[0]=o[0],t[1]=o[1]})),t}t.exports={toMercator:function(t,e){return o(t,e,"mercator")},toWgs84:function(t,e){return o(t,e,"wgs84")}}},function(t,e){function n(t){return t?function(t){return[Math.random()*(t[2]-t[0])+t[0],Math.random()*(t[3]-t[1])+t[1]]}(t):[a(),s()]}function r(t){return function(e,n){return[e[0]+t[0],e[1]+t[1]]}}function o(){return Math.random()-.5}function a(){return 360*o()}function s(){return 180*o()}function u(t){return{type:"Point",coordinates:t||[a(),s()]}}function c(t){return{type:"Feature",geometry:t,properties:{}}}function l(t){return{type:"FeatureCollection",features:t}}t.exports=function(){throw new Error("call .point() or .polygon() instead")},t.exports.position=n,t.exports.point=function(t,e){var r=[];for(i=0;i<t;i++)r.push(c(e?u(n(e)):u()));return l(r)},t.exports.polygon=function(t,e,o,a){"number"!=typeof e&&(e=10),"number"!=typeof o&&(o=10);var s=[];for(i=0;i<t;i++){var u=[],f=Array.apply(null,new Array(e+1)).map(Math.random);f.forEach(h),f.forEach(d),u[u.length-1]=u[0],u=u.map(r(n(a))),s.push(c({type:"Polygon",coordinates:[u]}))}function h(t,e,n){n[e]=e>0?t+n[e-1]:t}function d(t,e){t=2*t*Math.PI/f[f.length-1];var n=Math.random();u.push([n*o*Math.sin(t),n*o*Math.cos(t)])}return l(s)}},function(t,e,n){var r=n(456),i=n(124),o=n(46),a=n(252),s=n(71),u=n(253)("simplepolygon"),c=n(253)("simplepolygon:all");t.exports=function(t){if("Feature"!=t.type)throw new Error("The input must a geojson object of type Feature");if(void 0===t.geometry||null==t.geometry)throw new Error("The input must a geojson object with a non-empty geometry");if("Polygon"!=t.geometry.type)throw new Error("The input must be a geojson Polygon");for(var e=t.geometry.coordinates.length,n=[],g=0;g<e;g++){var v=t.geometry.coordinates[g];p(v[0],v[v.length-1])||v.push(v[0]),n.push.apply(n,v.slice(0,v.length-1))}if(!function(t){for(var e={},n=1,r=0,i=t.length;r<i;++r){if(e.hasOwnProperty(t[r])){n=0;break}e[t[r]]=1}return n}(n))throw new Error("The input polygon may not have duplicate vertices (except for the first and last vertex of each ring)");var y=n.length;u("Processing input");var m=r(t,(function(t,e,n,r,i,o,a,s,u,c,l,f){return[t,e,n,r,i,o,a,s,u,c,l,f]})),b=m.length;if(u("Computing self-intersections"),0==b){var _=[];for(g=0;g<e;g++)_.push(i.polygon([t.geometry.coordinates[g]],{parent:-1,winding:d(t.geometry.coordinates[g])}));var x=i.featureCollection(_);return H(),Y(),c("No self-intersections found. Input rings are output rings. Computed winding numbers, net winding numbers and parents"),u("Finishing without self-intersections"),x}var w=[],E=[];for(g=0;g<e;g++){w.push([]);for(var S=0;S<t.geometry.coordinates[g].length-1;S++)w[g].push([new l(t.geometry.coordinates[g][(S+1).modulo(t.geometry.coordinates[g].length-1)],1,[g,S],[g,(S+1).modulo(t.geometry.coordinates[g].length-1)],void 0)]),E.push(new f(t.geometry.coordinates[g][S],[g,(S-1).modulo(t.geometry.coordinates[g].length-1)],[g,S],void 0,void 0,!1,!0))}for(g=0;g<b;g++)w[m[g][1]][m[g][2]].push(new l(m[g][0],m[g][5],[m[g][1],m[g][2]],[m[g][6],m[g][7]],void 0)),m[g][11]&&E.push(new f(m[g][0],[m[g][1],m[g][2]],[m[g][6],m[g][7]],void 0,void 0,!0,!0));var O=E.length;for(g=0;g<w.length;g++)for(S=0;S<w[g].length;S++)w[g][S].sort((function(t,e){return t.param<e.param?-1:1}));u("Setting up pseudoVtxListByRingAndEdge and isectList"),allIsectsAsIsectRbushTreeItem=[];for(g=0;g<O;g++)allIsectsAsIsectRbushTreeItem.push({minX:E[g].coord[0],minY:E[g].coord[1],maxX:E[g].coord[0],maxY:E[g].coord[1],index:g});var P=s();P.load(allIsectsAsIsectRbushTreeItem);for(g=0;g<w.length;g++)for(S=0;S<w[g].length;S++)for(var C=0;C<w[g][S].length;C++){I=C==w[g][S].length-1?w[g][(S+1).modulo(t.geometry.coordinates[g].length-1)][0].coord:w[g][S][C+1].coord;var M=P.search({minX:I[0],minY:I[1],maxX:I[0],maxY:I[1]})[0];w[g][S][C].nxtIsectAlongEdgeIn=M.index}u("Computing nextIsect for pseudoVtxListByRingAndEdge");for(g=0;g<w.length;g++)for(S=0;S<w[g].length;S++)for(C=0;C<w[g][S].length;C++){var I=w[g][S][C].coord,A=(M=P.search({minX:I[0],minY:I[1],maxX:I[0],maxY:I[1]})[0]).index;A<y?E[A].nxtIsectAlongRingAndEdge2=w[g][S][C].nxtIsectAlongEdgeIn:p(E[A].ringAndEdge1,w[g][S][C].ringAndEdgeIn)?E[A].nxtIsectAlongRingAndEdge1=w[g][S][C].nxtIsectAlongEdgeIn:E[A].nxtIsectAlongRingAndEdge2=w[g][S][C].nxtIsectAlongEdgeIn}u("Porting nextIsect to isectList");var T=[];for(g=0,S=0;S<e;S++){var N=g;for(C=0;C<t.geometry.coordinates[S].length-1;C++)E[g].coord[0]<E[N].coord[0]&&(N=g),g++;var L=E[N].nxtIsectAlongRingAndEdge2;for(C=0;C<E.length;C++)if(E[C].nxtIsectAlongRingAndEdge1==N||E[C].nxtIsectAlongRingAndEdge2==N){var R=C;break}var k=h([E[R].coord,E[N].coord,E[L].coord],!0)?1:-1;T.push({isect:N,parent:-1,winding:k})}T.sort((function(t,e){return E[t.isect].coord>E[e.isect].coord?-1:1})),c("Initial state of the queue: "+JSON.stringify(T)),u("Setting up queue");for(_=[];T.length>0;){var j=T.pop(),F=j.isect,D=j.parent,B=j.winding,z=_.length,V=[E[F].coord];c("# Starting output ring number "+_.length+" with winding "+B+" from intersection "+F),F<y&&c("This is a ring-vertex-intersections, which means this output ring does not touch existing output rings");var G=F;if(E[F].ringAndEdge1Walkable)var U=E[F].ringAndEdge1,W=E[F].nxtIsectAlongRingAndEdge1;else U=E[F].ringAndEdge2,W=E[F].nxtIsectAlongRingAndEdge2;for(;!p(E[F].coord,E[W].coord);){c("Walking from intersection "+G+" to "+W+" over ring "+U[0]+" and edge "+U[1]),V.push(E[W].coord),c("Adding intersection "+W+" to current output ring");var q=void 0;for(g=0;g<T.length;g++)if(T[g].isect==W){q=g;break}if(null!=q&&(c("Removing intersection "+W+" from queue"),T.splice(q,1)),p(U,E[W].ringAndEdge1)){if(U=E[W].ringAndEdge2,E[W].ringAndEdge2Walkable=!1,E[W].ringAndEdge1Walkable){c("Adding intersection "+W+" to queue");var X={isect:W};h([E[G].coord,E[W].coord,E[E[W].nxtIsectAlongRingAndEdge2].coord],1==B)?(X.parent=D,X.winding=-B):(X.parent=z,X.winding=B),T.push(X)}G=W,W=E[W].nxtIsectAlongRingAndEdge2}else{if(U=E[W].ringAndEdge1,E[W].ringAndEdge1Walkable=!1,E[W].ringAndEdge2Walkable){c("Adding intersection "+W+" to queue");X={isect:W};h([E[G].coord,E[W].coord,E[E[W].nxtIsectAlongRingAndEdge1].coord],1==B)?(X.parent=D,X.winding=-B):(X.parent=z,X.winding=B),T.push(X)}G=W,W=E[W].nxtIsectAlongRingAndEdge1}c("Current state of the queue: "+JSON.stringify(T))}c("Walking from intersection "+G+" to "+W+" over ring "+U[0]+" and edge "+U[1]+" and closing ring"),V.push(E[W].coord),_.push(i.polygon([V],{index:z,parent:D,winding:B,netWinding:void 0}))}x=i.featureCollection(_);function H(){for(var t=[],e=0;e<x.features.length;e++)c("Output ring "+e+" has parent "+x.features[e].properties.parent),-1==x.features[e].properties.parent&&t.push(e);if(c("The following output ring(s) have no parent: "+t),t.length>1)for(e=0;e<t.length;e++){for(var n=-1,r=0;r<x.features.length;r++)t[e]!=r&&o(i.point(x.features[t[e]].geometry.coordinates[0][0]),x.features[r],!0)&&a(x.features[r])<1/0&&(n=r,c("Ring "+t[e]+" lies inside output ring "+r));x.features[t[e]].properties.parent=n,c("Ring "+t[e]+" is assigned parent "+n)}}function Y(){for(var t=0;t<x.features.length;t++)if(-1==x.features[t].properties.parent){var e=x.features[t].properties.winding;x.features[t].properties.netWinding=e,Z(t,e)}}function Z(t,e){for(var n=0;n<x.features.length;n++)if(x.features[n].properties.parent==t){var r=e+x.features[n].properties.winding;x.features[n].properties.netWinding=r,Z(n,r)}}return u("Walking"),H(),u("Determining parents"),Y(),u("Setting winding number"),c("# Total of "+x.features.length+" rings"),x};var l=function(t,e,n,r,i){this.coord=t,this.param=e,this.ringAndEdgeIn=n,this.ringAndEdgeOut=r,this.nxtIsectAlongEdgeIn=i},f=function(t,e,n,r,i,o,a){this.coord=t,this.ringAndEdge1=e,this.ringAndEdge2=n,this.nxtIsectAlongRingAndEdge1=r,this.nxtIsectAlongRingAndEdge2=i,this.ringAndEdge1Walkable=o,this.ringAndEdge2Walkable=a};function h(t,e){if(void 0===e&&(e=!0),3!=t.length)throw new Error("This function requires an array of three points [x,y]");return(t[1][0]-t[0][0])*(t[2][1]-t[0][1])-(t[1][1]-t[0][1])*(t[2][0]-t[0][0])>=0==e}function d(t){for(var e=0,n=0;n<t.length-1;n++)t[n][0]<t[e][0]&&(e=n);if(h([t[(e-1).modulo(t.length-1)],t[e],t[(e+1).modulo(t.length-1)]],!0))var r=1;else r=-1;return r}function p(t,e){if(!t||!e)return!1;if(t.length!=e.length)return!1;for(var n=0,r=t.length;n<r;n++)if(t[n]instanceof Array&&e[n]instanceof Array){if(!p(t[n],e[n]))return!1}else if(t[n]!=e[n])return!1;return!0}Number.prototype.modulo=function(t){return(this%t+t)%t}},function(t,e,n){var r=n(71),i=function(){var t={};return Array.prototype.slice.call(arguments).forEach((function(e){e&&Object.keys(e).forEach((function(n){t[n]=e[n]}))})),t},o={useSpatialIndex:!0,epsilon:0,reportVertexOnVertex:!1,reportVertexOnEdge:!1};function a(t,e){if(!t||!e)return!1;if(t.length!=e.length)return!1;for(var n=0,r=t.length;n<r;n++)if(t[n]instanceof Array&&e[n]instanceof Array){if(!a(t[n],e[n]))return!1}else if(t[n]!=e[n])return!1;return!0}t.exports=function(t,e,n){var s;if(s=i(o,"object"==typeof n?n:{useSpatialIndex:n}),"Polygon"!=t.geometry.type)throw new Error("The input feature must be a Polygon");var u=t.geometry.coordinates,c=[],l={};if(s.useSpatialIndex){for(var f=[],h=0;h<u.length;h++)for(var d=0;d<u[h].length-1;d++)f.push(_(h,d));var p=r();p.load(f)}for(h=0;h<u.length;h++)for(d=0;d<u[h].length-1;d++){if(s.useSpatialIndex)p.search(_(h,d)).forEach((function(t){var e=t.ring,n=t.edge;b(h,d,e,n)}));else for(var g=0;g<u.length;g++)for(var v=0;v<u[g].length-1;v++)b(h,d,g,v)}return e||(c={type:"Feature",geometry:{type:"MultiPoint",coordinates:c}}),c;function y(t){var e=s.epsilon*s.epsilon;return e>=(t-1)*(t-1)||e>=t*t}function m(t){return t<0-s.epsilon||t>1+s.epsilon}function b(t,n,r,i){var o=u[t][n],f=u[t][n+1],h=u[r][i],d=u[r][i+1],p=function(t,e,n,r){if(a(t,n)||a(t,r)||a(e,n)||a(r,n))return null;var i=t[0],o=t[1],s=e[0],u=e[1],c=n[0],l=n[1],f=r[0],h=r[1],d=(i-s)*(l-h)-(o-u)*(c-f);return 0==d?null:[((i*u-o*s)*(c-f)-(i-s)*(c*h-l*f))/d,((i*u-o*s)*(l-h)-(o-u)*(c*h-l*f))/d]}(o,f,h,d);if(null!=p){if(f[0]!=o[0])var g=(p[0]-o[0])/(f[0]-o[0]);else g=(p[1]-o[1])/(f[1]-o[1]);if(d[0]!=h[0])var v=(p[0]-h[0])/(d[0]-h[0]);else v=(p[1]-h[1])/(d[1]-h[1]);if(!m(g)&&!m(v)&&(!y(g)||!y(v)||s.reportVertexOnVertex)&&(!y(g)&&!y(v)||s.reportVertexOnEdge)){var b=p,_=!l[b];_&&(l[b]=!0),e?c.push(e(p,t,n,o,f,g,r,i,h,d,v,_)):c.push(p)}}}function _(t,e){var n=u[t][e],r=u[t][e+1];if(n[0]<r[0])var i=n[0],o=r[0];else i=r[0],o=n[0];if(n[1]<r[1])var a=n[1],s=r[1];else a=r[1],s=n[1];return{minX:i,minY:a,maxX:o,maxY:s,ring:t,edge:e}}}},function(t,e,n){var r;function i(t){function n(){if(n.enabled){var t=n,i=+new Date,o=i-(r||i);t.diff=o,t.prev=r,t.curr=i,r=i;for(var a=new Array(arguments.length),s=0;s<a.length;s++)a[s]=arguments[s];a[0]=e.coerce(a[0]),"string"!=typeof a[0]&&a.unshift("%O");var u=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,(function(n,r){if("%%"===n)return n;u++;var i=e.formatters[r];if("function"==typeof i){var o=a[u];n=i.call(t,o),a.splice(u,1),u--}return n})),e.formatArgs.call(t,a);var c=n.log||e.log||console.log.bind(console);c.apply(t,a)}}return n.namespace=t,n.enabled=e.enabled(t),n.useColors=e.useColors(),n.color=function(t){var n,r=0;for(n in t)r=(r<<5)-r+t.charCodeAt(n),r|=0;return e.colors[Math.abs(r)%e.colors.length]}(t),"function"==typeof e.init&&e.init(n),n}(e=t.exports=i.debug=i.default=i).coerce=function(t){return t instanceof Error?t.stack||t.message:t},e.disable=function(){e.enable("")},e.enable=function(t){e.save(t),e.names=[],e.skips=[];for(var n=("string"==typeof t?t:"").split(/[\s,]+/),r=n.length,i=0;i<r;i++)n[i]&&("-"===(t=n[i].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")))},e.enabled=function(t){var n,r;for(n=0,r=e.skips.length;n<r;n++)if(e.skips[n].test(t))return!1;for(n=0,r=e.names.length;n<r;n++)if(e.names[n].test(t))return!0;return!1},e.humanize=n(458),e.names=[],e.skips=[],e.formatters={}},function(t,e){var n=1e3,r=6e4,i=60*r,o=24*i;function a(t,e,n){if(!(t<e))return t<1.5*e?Math.floor(t/e)+" "+n:Math.ceil(t/e)+" "+n+"s"}t.exports=function(t,e){e=e||{};var s,u=typeof t;if("string"===u&&t.length>0)return function(t){if((t=String(t)).length>100)return;var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(!e)return;var a=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*a;case"days":case"day":case"d":return a*o;case"hours":case"hour":case"hrs":case"hr":case"h":return a*i;case"minutes":case"minute":case"mins":case"min":case"m":return a*r;case"seconds":case"second":case"secs":case"sec":case"s":return a*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}(t);if("number"===u&&!1===isNaN(t))return e.long?a(s=t,o,"day")||a(s,i,"hour")||a(s,r,"minute")||a(s,n,"second")||s+" ms":function(t){if(t>=o)return Math.round(t/o)+"d";if(t>=i)return Math.round(t/i)+"h";if(t>=r)return Math.round(t/r)+"m";if(t>=n)return Math.round(t/n)+"s";return t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},function(t,e,n){"use strict";var r=Math.PI/180,i=180/Math.PI,o=function(t,e){this.lon=t,this.lat=e,this.x=r*t,this.y=r*e};o.prototype.view=function(){return String(this.lon).slice(0,4)+","+String(this.lat).slice(0,4)},o.prototype.antipode=function(){var t=-1*this.lat,e=this.lon<0?180+this.lon:-1*(180-this.lon);return new o(e,t)};var a=function(){this.coords=[],this.length=0};a.prototype.move_to=function(t){this.length++,this.coords.push(t)};var s=function(t){this.properties=t||{},this.geometries=[]};s.prototype.json=function(){if(this.geometries.length<=0)return{geometry:{type:"LineString",coordinates:null},type:"Feature",properties:this.properties};if(1===this.geometries.length)return{geometry:{type:"LineString",coordinates:this.geometries[0].coords},type:"Feature",properties:this.properties};for(var t=[],e=0;e<this.geometries.length;e++)t.push(this.geometries[e].coords);return{geometry:{type:"MultiLineString",coordinates:t},type:"Feature",properties:this.properties}},s.prototype.wkt=function(){for(var t="",e="LINESTRING(",n=function(t){e+=t[0]+" "+t[1]+","},r=0;r<this.geometries.length;r++){if(0===this.geometries[r].coords.length)return"LINESTRING(empty)";this.geometries[r].coords.forEach(n),t+=e.substring(0,e.length-1)+")"}return t};var u=function(t,e,n){if(!t||void 0===t.x||void 0===t.y)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");if(!e||void 0===e.x||void 0===e.y)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");this.start=new o(t.x,t.y),this.end=new o(e.x,e.y),this.properties=n||{};var r=this.start.x-this.end.x,i=this.start.y-this.end.y,a=Math.pow(Math.sin(i/2),2)+Math.cos(this.start.y)*Math.cos(this.end.y)*Math.pow(Math.sin(r/2),2);if(this.g=2*Math.asin(Math.sqrt(a)),this.g===Math.PI)throw new Error("it appears "+t.view()+" and "+e.view()+" are 'antipodal', e.g diametrically opposite, thus there is no single route but rather infinite");if(isNaN(this.g))throw new Error("could not calculate great circle between "+t+" and "+e)};u.prototype.interpolate=function(t){var e=Math.sin((1-t)*this.g)/Math.sin(this.g),n=Math.sin(t*this.g)/Math.sin(this.g),r=e*Math.cos(this.start.y)*Math.cos(this.start.x)+n*Math.cos(this.end.y)*Math.cos(this.end.x),o=e*Math.cos(this.start.y)*Math.sin(this.start.x)+n*Math.cos(this.end.y)*Math.sin(this.end.x),a=e*Math.sin(this.start.y)+n*Math.sin(this.end.y),s=i*Math.atan2(a,Math.sqrt(Math.pow(r,2)+Math.pow(o,2)));return[i*Math.atan2(o,r),s]},u.prototype.Arc=function(t,e){var n=[];if(!t||t<=2)n.push([this.start.lon,this.start.lat]),n.push([this.end.lon,this.end.lat]);else for(var r=1/(t-1),i=0;i<t;++i){var o=r*i,u=this.interpolate(o);n.push(u)}for(var c=!1,l=0,f=e&&e.offset?e.offset:10,h=180-f,d=-180+f,p=360-f,g=1;g<n.length;++g){var v=n[g-1][0],y=n[g][0],m=Math.abs(y-v);m>p&&(y>h&&v<d||v>h&&y<d)?c=!0:m>l&&(l=m)}var b=[];if(c&&l<f){var _=[];b.push(_);for(var x=0;x<n.length;++x){var w=parseFloat(n[x][0]);if(x>0&&Math.abs(w-n[x-1][0])>p){var E=parseFloat(n[x-1][0]),S=parseFloat(n[x-1][1]),O=parseFloat(n[x][0]),P=parseFloat(n[x][1]);if(E>-180&&E<d&&180===O&&x+1<n.length&&n[x-1][0]>-180&&n[x-1][0]<d){_.push([-180,n[x][1]]),x++,_.push([n[x][0],n[x][1]]);continue}if(E>h&&E<180&&-180===O&&x+1<n.length&&n[x-1][0]>h&&n[x-1][0]<180){_.push([180,n[x][1]]),x++,_.push([n[x][0],n[x][1]]);continue}if(E<d&&O>h){var C=E;E=O,O=C;var M=S;S=P,P=M}if(E>h&&O<d&&(O+=360),E<=180&&O>=180&&E<O){var I=(180-E)/(O-E),A=I*P+(1-I)*S;_.push([n[x-1][0]>h?180:-180,A]),(_=[]).push([n[x-1][0]>h?-180:180,A]),b.push(_)}else _=[],b.push(_);_.push([w,n[x][1]])}else _.push([n[x][0],n[x][1]])}}else{var T=[];b.push(T);for(var N=0;N<n.length;++N)T.push([n[N][0],n[N][1]])}for(var L=new s(this.properties),R=0;R<b.length;++R){var k=new a;L.geometries.push(k);for(var j=b[R],F=0;F<j.length;++F)k.move_to(j[F])}return L},t.exports={Coord:o,Arc:s,GreatCircle:u}},function(t,e,n){"use strict";function r(t,e,n){var r,a,s,u,c,l=t.length,f=o(t[0],e),h=[];for(n||(n=[]),r=1;r<l;r++){for(a=t[r-1],u=c=o(s=t[r],e);;){if(!(f|u)){h.push(a),u!==c?(h.push(s),r<l-1&&(n.push(h),h=[])):r===l-1&&h.push(s);break}if(f&u)break;f?f=o(a=i(a,s,f,e),e):u=o(s=i(a,s,u,e),e)}f=c}return h.length&&n.push(h),n}function i(t,e,n,r){return 8&n?[t[0]+(e[0]-t[0])*(r[3]-t[1])/(e[1]-t[1]),r[3]]:4&n?[t[0]+(e[0]-t[0])*(r[1]-t[1])/(e[1]-t[1]),r[1]]:2&n?[r[2],t[1]+(e[1]-t[1])*(r[2]-t[0])/(e[0]-t[0])]:1&n?[r[0],t[1]+(e[1]-t[1])*(r[0]-t[0])/(e[0]-t[0])]:null}function o(t,e){var n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}t.exports=r,r.polyline=r,r.polygon=function(t,e){var n,r,a,s,u,c,l;for(r=1;r<=8;r*=2){for(n=[],a=t[t.length-1],s=!(o(a,e)&r),u=0;u<t.length;u++)c=t[u],(l=!(o(c,e)&r))!==s&&n.push(i(a,c,r,e)),l&&n.push(c),a=c,s=l;if(!(t=n).length)break}return n}},function(t,e,n){"use strict";if(t.exports)var r=n(126);function i(t,e){if(!(this instanceof i))return new i(t,e);this.lat=Number(t),this.lon=Number(e)}i.prototype.distanceTo=function(t,e){if(!(t instanceof i))throw new TypeError("point is not LatLon object");var n=e=void 0===e?6371e3:Number(e),r=this.lat.toRadians(),o=this.lon.toRadians(),a=t.lat.toRadians(),s=a-r,u=t.lon.toRadians()-o,c=Math.sin(s/2)*Math.sin(s/2)+Math.cos(r)*Math.cos(a)*Math.sin(u/2)*Math.sin(u/2);return n*(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)))},i.prototype.bearingTo=function(t){if(!(t instanceof i))throw new TypeError("point is not LatLon object");var e=this.lat.toRadians(),n=t.lat.toRadians(),r=(t.lon-this.lon).toRadians(),o=Math.sin(r)*Math.cos(n),a=Math.cos(e)*Math.sin(n)-Math.sin(e)*Math.cos(n)*Math.cos(r);return(Math.atan2(o,a).toDegrees()+360)%360},i.prototype.finalBearingTo=function(t){if(!(t instanceof i))throw new TypeError("point is not LatLon object");return(t.bearingTo(this)+180)%360},i.prototype.midpointTo=function(t){if(!(t instanceof i))throw new TypeError("point is not LatLon object");var e=this.lat.toRadians(),n=this.lon.toRadians(),r=t.lat.toRadians(),o=(t.lon-this.lon).toRadians(),a=Math.cos(r)*Math.cos(o),s=Math.cos(r)*Math.sin(o),u=Math.sqrt((Math.cos(e)+a)*(Math.cos(e)+a)+s*s),c=Math.sin(e)+Math.sin(r),l=Math.atan2(c,u),f=n+Math.atan2(s,Math.cos(e)+a);return new i(l.toDegrees(),(f.toDegrees()+540)%360-180)},i.prototype.intermediatePointTo=function(t,e){if(!(t instanceof i))throw new TypeError("point is not LatLon object");var n=this.lat.toRadians(),r=this.lon.toRadians(),o=t.lat.toRadians(),a=t.lon.toRadians(),s=Math.sin(n),u=Math.cos(n),c=Math.sin(r),l=Math.cos(r),f=Math.sin(o),h=Math.cos(o),d=Math.sin(a),p=Math.cos(a),g=o-n,v=a-r,y=Math.sin(g/2)*Math.sin(g/2)+Math.cos(n)*Math.cos(o)*Math.sin(v/2)*Math.sin(v/2),m=2*Math.atan2(Math.sqrt(y),Math.sqrt(1-y)),b=Math.sin((1-e)*m)/Math.sin(m),_=Math.sin(e*m)/Math.sin(m),x=b*u*l+_*h*p,w=b*u*c+_*h*d,E=b*s+_*f,S=Math.atan2(E,Math.sqrt(x*x+w*w)),O=Math.atan2(w,x);return new i(S.toDegrees(),(O.toDegrees()+540)%360-180)},i.prototype.destinationPoint=function(t,e,n){n=void 0===n?6371e3:Number(n);var r=Number(t)/n,o=Number(e).toRadians(),a=this.lat.toRadians(),s=this.lon.toRadians(),u=Math.sin(a),c=Math.cos(a),l=Math.sin(r),f=Math.cos(r),h=Math.sin(o),d=u*f+c*l*Math.cos(o),p=Math.asin(d),g=h*l*c,v=f-u*d,y=s+Math.atan2(g,v);return new i(p.toDegrees(),(y.toDegrees()+540)%360-180)},i.intersection=function(t,e,n,r){if(!(t instanceof i))throw new TypeError("p1 is not LatLon object");if(!(n instanceof i))throw new TypeError("p2 is not LatLon object");var o=t.lat.toRadians(),a=t.lon.toRadians(),s=n.lat.toRadians(),u=n.lon.toRadians(),c=Number(e).toRadians(),l=Number(r).toRadians(),f=s-o,h=u-a,d=2*Math.asin(Math.sqrt(Math.sin(f/2)*Math.sin(f/2)+Math.cos(o)*Math.cos(s)*Math.sin(h/2)*Math.sin(h/2)));if(0==d)return null;var p=Math.acos((Math.sin(s)-Math.sin(o)*Math.cos(d))/(Math.sin(d)*Math.cos(o)));isNaN(p)&&(p=0);var g=Math.acos((Math.sin(o)-Math.sin(s)*Math.cos(d))/(Math.sin(d)*Math.cos(s))),v=c-(Math.sin(u-a)>0?p:2*Math.PI-p),y=(Math.sin(u-a)>0?2*Math.PI-g:g)-l;if(0==Math.sin(v)&&0==Math.sin(y))return null;if(Math.sin(v)*Math.sin(y)<0)return null;var m=Math.acos(-Math.cos(v)*Math.cos(y)+Math.sin(v)*Math.sin(y)*Math.cos(d)),b=Math.atan2(Math.sin(d)*Math.sin(v)*Math.sin(y),Math.cos(y)+Math.cos(v)*Math.cos(m)),_=Math.asin(Math.sin(o)*Math.cos(b)+Math.cos(o)*Math.sin(b)*Math.cos(c)),x=a+Math.atan2(Math.sin(c)*Math.sin(b)*Math.cos(o),Math.cos(b)-Math.sin(o)*Math.sin(_));return new i(_.toDegrees(),(x.toDegrees()+540)%360-180)},i.prototype.crossTrackDistanceTo=function(t,e,n){if(!(t instanceof i))throw new TypeError("pathStart is not LatLon object");if(!(e instanceof i))throw new TypeError("pathEnd is not LatLon object");var r=void 0===n?6371e3:Number(n),o=t.distanceTo(this,r)/r,a=t.bearingTo(this).toRadians(),s=t.bearingTo(e).toRadians();return Math.asin(Math.sin(o)*Math.sin(a-s))*r},i.prototype.alongTrackDistanceTo=function(t,e,n){if(!(t instanceof i))throw new TypeError("pathStart is not LatLon object");if(!(e instanceof i))throw new TypeError("pathEnd is not LatLon object");var r=void 0===n?6371e3:Number(n),o=t.distanceTo(this,r)/r,a=t.bearingTo(this).toRadians(),s=t.bearingTo(e).toRadians(),u=Math.asin(Math.sin(o)*Math.sin(a-s));return Math.acos(Math.cos(o)/Math.abs(Math.cos(u)))*Math.sign(Math.cos(s-a))*r},i.prototype.maxLatitude=function(t){var e=Number(t).toRadians(),n=this.lat.toRadians();return Math.acos(Math.abs(Math.sin(e)*Math.cos(n))).toDegrees()},i.crossingParallels=function(t,e,n){var r=Number(n).toRadians(),i=t.lat.toRadians(),o=t.lon.toRadians(),a=e.lat.toRadians(),s=e.lon.toRadians()-o,u=Math.sin(i)*Math.cos(a)*Math.cos(r)*Math.sin(s),c=Math.sin(i)*Math.cos(a)*Math.cos(r)*Math.cos(s)-Math.cos(i)*Math.sin(a)*Math.cos(r),l=Math.cos(i)*Math.cos(a)*Math.sin(r)*Math.sin(s);if(l*l>u*u+c*c)return null;var f=Math.atan2(-c,u),h=Math.acos(l/Math.sqrt(u*u+c*c)),d=o+f+h;return{lon1:((o+f-h).toDegrees()+540)%360-180,lon2:(d.toDegrees()+540)%360-180}},i.prototype.rhumbDistanceTo=function(t,e){if(!(t instanceof i))throw new TypeError("point is not LatLon object");var n=e=void 0===e?6371e3:Number(e),r=this.lat.toRadians(),o=t.lat.toRadians(),a=o-r,s=Math.abs(t.lon-this.lon).toRadians();s>Math.PI&&(s-=2*Math.PI);var u=Math.log(Math.tan(o/2+Math.PI/4)/Math.tan(r/2+Math.PI/4)),c=Math.abs(u)>1e-11?a/u:Math.cos(r);return Math.sqrt(a*a+c*c*s*s)*n},i.prototype.rhumbBearingTo=function(t){if(!(t instanceof i))throw new TypeError("point is not LatLon object");var e=this.lat.toRadians(),n=t.lat.toRadians(),r=(t.lon-this.lon).toRadians();r>Math.PI&&(r-=2*Math.PI),r<-Math.PI&&(r+=2*Math.PI);var o=Math.log(Math.tan(n/2+Math.PI/4)/Math.tan(e/2+Math.PI/4));return(Math.atan2(r,o).toDegrees()+360)%360},i.prototype.rhumbDestinationPoint=function(t,e,n){n=void 0===n?6371e3:Number(n);var r=Number(t)/n,o=this.lat.toRadians(),a=this.lon.toRadians(),s=Number(e).toRadians(),u=r*Math.cos(s),c=o+u;Math.abs(c)>Math.PI/2&&(c=c>0?Math.PI-c:-Math.PI-c);var l=Math.log(Math.tan(c/2+Math.PI/4)/Math.tan(o/2+Math.PI/4)),f=Math.abs(l)>1e-11?u/l:Math.cos(o),h=a+r*Math.sin(s)/f;return new i(c.toDegrees(),(h.toDegrees()+540)%360-180)},i.prototype.rhumbMidpointTo=function(t){if(!(t instanceof i))throw new TypeError("point is not LatLon object");var e=this.lat.toRadians(),n=this.lon.toRadians(),r=t.lat.toRadians(),o=t.lon.toRadians();Math.abs(o-n)>Math.PI&&(n+=2*Math.PI);var a=(e+r)/2,s=Math.tan(Math.PI/4+e/2),u=Math.tan(Math.PI/4+r/2),c=Math.tan(Math.PI/4+a/2),l=((o-n)*Math.log(c)+n*Math.log(u)-o*Math.log(s))/Math.log(u/s);return isFinite(l)||(l=(n+o)/2),i(a.toDegrees(),(l.toDegrees()+540)%360-180)},i.areaOf=function(t,e){var n=void 0===e?6371e3:Number(e),r=t[0].equals(t[t.length-1]);r||t.push(t[0]);for(var i=t.length-1,o=0,a=0;a<i;a++){var s=t[a].lat.toRadians(),u=t[a+1].lat.toRadians(),c=(t[a+1].lon-t[a].lon).toRadians();o+=2*Math.atan2(Math.tan(c/2)*(Math.tan(s/2)+Math.tan(u/2)),1+Math.tan(s/2)*Math.tan(u/2))}(function(t){for(var e=0,n=t[0].bearingTo(t[1]),r=0;r<t.length-1;r++){var i=t[r].bearingTo(t[r+1]),o=t[r].finalBearingTo(t[r+1]);e+=(i-n+540)%360-180,e+=(o-i+540)%360-180,n=o}i=t[0].bearingTo(t[1]);return e+=(i-n+540)%360-180,Math.abs(e)<90})(t)&&(o=Math.abs(o)-2*Math.PI);var l=Math.abs(o*n*n);return r||t.pop(),l},i.prototype.equals=function(t){if(!(t instanceof i))throw new TypeError("point is not LatLon object");return this.lat==t.lat&&this.lon==t.lon},i.prototype.toString=function(t,e){return r.toLat(this.lat,t,e)+", "+r.toLon(this.lon,t,e)},void 0===Number.prototype.toRadians&&(Number.prototype.toRadians=function(){return this*Math.PI/180}),void 0===Number.prototype.toDegrees&&(Number.prototype.toDegrees=function(){return 180*this/Math.PI}),t.exports&&(t.exports=i)},function(t,e,n){"use strict";if(t.exports)var r=n(97);r.prototype.distanceTo=function(t){if(!(t instanceof r))throw new TypeError("point is not LatLon object");try{return Number(this.inverse(t).distance.toFixed(3))}catch(t){return NaN}},r.prototype.initialBearingTo=function(t){if(!(t instanceof r))throw new TypeError("point is not LatLon object");try{return Number(this.inverse(t).initialBearing.toFixed(9))}catch(t){return NaN}},r.prototype.finalBearingTo=function(t){if(!(t instanceof r))throw new TypeError("point is not LatLon object");try{return Number(this.inverse(t).finalBearing.toFixed(9))}catch(t){return NaN}},r.prototype.destinationPoint=function(t,e){return this.direct(Number(t),Number(e)).point},r.prototype.finalBearingOn=function(t,e){return Number(this.direct(Number(t),Number(e)).finalBearing.toFixed(9))},r.prototype.direct=function(t,e){var n,i,o,a,s=this.lat.toRadians(),u=this.lon.toRadians(),c=e.toRadians(),l=t,f=this.datum.ellipsoid.a,h=this.datum.ellipsoid.b,d=this.datum.ellipsoid.f,p=Math.sin(c),g=Math.cos(c),v=(1-d)*Math.tan(s),y=1/Math.sqrt(1+v*v),m=v*y,b=Math.atan2(v,g),_=y*p,x=1-_*_,w=x*(f*f-h*h)/(h*h),E=1+w/16384*(4096+w*(w*(320-175*w)-768)),S=w/1024*(256+w*(w*(74-47*w)-128)),O=l/(h*E),P=0;do{n=Math.cos(2*b+O),a=O,O=l/(h*E)+S*(i=Math.sin(O))*(n+S/4*((o=Math.cos(O))*(2*n*n-1)-S/6*n*(4*i*i-3)*(4*n*n-3)))}while(Math.abs(O-a)>1e-12&&++P<100);if(P>=100)throw new Error("Formula failed to converge");var C=m*i-y*o*g,M=Math.atan2(m*o+y*i*g,(1-d)*Math.sqrt(_*_+C*C)),I=d/16*x*(4+d*(4-3*x)),A=(u+(Math.atan2(i*p,y*o-m*i*g)-(1-I)*d*_*(O+I*i*(n+I*o*(2*n*n-1))))+3*Math.PI)%(2*Math.PI)-Math.PI,T=Math.atan2(_,-C);return T=(T+2*Math.PI)%(2*Math.PI),{point:new r(M.toDegrees(),A.toDegrees(),this.datum),finalBearing:T.toDegrees(),iterations:P}},r.prototype.inverse=function(t){var e=t;-180==this.lon&&(this.lon=180);var n,r,i,o,a,s,u=this.lat.toRadians(),c=this.lon.toRadians(),l=e.lat.toRadians(),f=e.lon.toRadians(),h=this.datum.ellipsoid.a,d=this.datum.ellipsoid.b,p=this.datum.ellipsoid.f,g=f-c,v=(1-p)*Math.tan(u),y=1/Math.sqrt(1+v*v),m=v*y,b=(1-p)*Math.tan(l),_=1/Math.sqrt(1+b*b),x=b*_,w=0,E=0,S=0,O=0,P=0,C=g,M=0;do{if(0==(i=_*(n=Math.sin(C))*(_*n)+(y*x-m*_*(r=Math.cos(C)))*(y*x-m*_*r)))break;if(E=m*x+y*_*r,s=C,C=g+(1-(a=p/16*(O=1-(o=y*_*n/(w=Math.sqrt(i)))*o)*(4+p*(4-3*O))))*p*o*((S=Math.atan2(w,E))+a*w*((P=0!=O?E-2*m*x/O:0)+a*E*(2*P*P-1))),Math.abs(C)>Math.PI)throw new Error(" > ")}while(Math.abs(C-s)>1e-12&&++M<1e3);if(M>=1e3)throw new Error("Formula failed to converge");var I=O*(h*h-d*d)/(d*d),A=I/1024*(256+I*(I*(74-47*I)-128)),T=d*(1+I/16384*(4096+I*(I*(320-175*I)-768)))*(S-A*w*(P+A/4*(E*(2*P*P-1)-A/6*P*(4*w*w-3)*(4*P*P-3)))),N=Math.atan2(_*n,y*x-m*_*r),L=Math.atan2(y*n,-m*_+y*x*r);return N=(N+2*Math.PI)%(2*Math.PI),L=(L+2*Math.PI)%(2*Math.PI),{distance:T,initialBearing:0==T?NaN:N.toDegrees(),finalBearing:0==T?NaN:L.toDegrees(),iterations:M}},void 0===Number.prototype.toRadians&&(Number.prototype.toRadians=function(){return this*Math.PI/180}),void 0===Number.prototype.toDegrees&&(Number.prototype.toDegrees=function(){return 180*this/Math.PI}),t.exports&&(t.exports=r)},function(t,e,n){"use strict";if(t.exports)var r=n(175);if(t.exports)var i=n(126);function o(t,e){if(!(this instanceof o))return new o(t,e);this.lat=Number(t),this.lon=Number(e)}o.prototype.toVector=function(){var t=this.lat.toRadians(),e=this.lon.toRadians(),n=Math.cos(t)*Math.cos(e),i=Math.cos(t)*Math.sin(e),o=Math.sin(t);return new r(n,i,o)},r.prototype.toLatLonS=function(){var t=Math.atan2(this.z,Math.sqrt(this.x*this.x+this.y*this.y)),e=Math.atan2(this.y,this.x);return new o(t.toDegrees(),e.toDegrees())},o.prototype.greatCircle=function(t){var e=this.lat.toRadians(),n=this.lon.toRadians(),i=Number(t).toRadians(),o=Math.sin(n)*Math.cos(i)-Math.sin(e)*Math.cos(n)*Math.sin(i),a=-Math.cos(n)*Math.cos(i)-Math.sin(e)*Math.sin(n)*Math.sin(i),s=Math.cos(e)*Math.sin(i);return new r(o,a,s)},r.prototype.greatCircle=function(t){var e=Number(t).toRadians(),n=new r(0,0,1).cross(this),i=this.cross(n),o=n.times(Math.cos(e)/n.length());return i.times(Math.sin(e)/i.length()).minus(o)},o.prototype.distanceTo=function(t,e){if(!(t instanceof o))throw new TypeError("point is not LatLon object");e=void 0===e?6371e3:Number(e);var n=this.toVector(),r=t.toVector();return n.angleTo(r)*e},o.prototype.bearingTo=function(t){if(!(t instanceof o))throw new TypeError("point is not LatLon object");var e=this.toVector(),n=t.toVector(),i=new r(0,0,1),a=e.cross(n),s=e.cross(i);return(a.angleTo(s,e).toDegrees()+360)%360},o.prototype.midpointTo=function(t){if(!(t instanceof o))throw new TypeError("point is not LatLon object");var e=this.toVector(),n=t.toVector();return e.plus(n).unit().toLatLonS()},o.prototype.intermediatePointTo=function(t,e){if(!(t instanceof o))throw new TypeError("point is not LatLon object");var n=this.toVector(),i=t.toVector(),a=n.cross(i).length(),s=n.dot(i),u=Math.atan2(a,s)*Number(e),c=Math.sin(u),l=Math.cos(u),f=n.cross(i).unit().cross(n),h=n.times(l).plus(f.times(c));return new r(h.x,h.y,h.z).toLatLonS()},o.prototype.intermediatePointOnChordTo=function(t,e){if(!(t instanceof o))throw new TypeError("point is not LatLon object");var n=this.toVector(),i=t.toVector(),a=n.plus(i.minus(n).times(Number(e)));return new r(a.x,a.y,a.z).toLatLonS()},o.prototype.destinationPoint=function(t,e,n){n=void 0===n?6371e3:Number(n);var i=this.toVector(),o=Number(t)/n,a=Number(e).toRadians(),s=new r(0,0,1).cross(i).unit(),u=i.cross(s),c=s.times(Math.sin(a)),l=u.times(Math.cos(a)).plus(c),f=i.times(Math.cos(o)),h=l.times(Math.sin(o));return f.plus(h).toLatLonS()},o.intersection=function(t,e,n,r){if(!(t instanceof o))throw new TypeError("path1start is not LatLon object");if(!(n instanceof o))throw new TypeError("path2start is not LatLon object");if(!(e instanceof o)&&isNaN(e))throw new TypeError("path1brngEnd is not LatLon object or bearing");if(!(r instanceof o)&&isNaN(r))throw new TypeError("path2brngEnd is not LatLon object or bearing");var i,a,s,u,c=t.toVector(),l=n.toVector();e instanceof o?(i=c.cross(e.toVector()),s="endpoint"):(i=t.greatCircle(Number(e)),s="bearing"),r instanceof o?(a=l.cross(r.toVector()),u="endpoint"):(a=n.greatCircle(Number(r)),u="bearing");var f=i.cross(a),h=a.cross(i),d=null;switch(s+"+"+u){case"bearing+bearing":switch(Math.sign(i.cross(c).dot(f))+Math.sign(a.cross(l).dot(f))){case 2:d=f;break;case-2:d=h;break;case 0:d=c.plus(l).dot(f)>0?h:f}break;case"bearing+endpoint":d=Math.sign(i.cross(c).dot(f))>0?f:h;break;case"endpoint+bearing":d=Math.sign(a.cross(l).dot(f))>0?f:h;break;case"endpoint+endpoint":d=c.plus(l).plus(e.toVector()).plus(r.toVector()).dot(f)>0?f:h}return d.toLatLonS()},o.prototype.crossTrackDistanceTo=function(t,e,n){if(!(t instanceof o))throw new TypeError("pathStart is not LatLon object");var r=void 0===n?6371e3:Number(n),i=this.toVector();return((e instanceof o?t.toVector().cross(e.toVector()):t.greatCircle(Number(e))).angleTo(i)-Math.PI/2)*r},o.prototype.alongTrackDistanceTo=function(t,e,n){if(!(t instanceof o))throw new TypeError("pathStart is not LatLon object");var r=void 0===n?6371e3:Number(n),i=this.toVector(),a=e instanceof o?t.toVector().cross(e.toVector()):t.greatCircle(Number(e)),s=a.cross(i).cross(a);return t.toVector().angleTo(s,a)*r},o.prototype.nearestPointOnSegment=function(t,e){var n=null;if(this.isBetween(t,e)){var r=this.toVector(),i=t.toVector(),o=e.toVector(),a=i.cross(o),s=r.cross(a);n=a.cross(s).toLatLonS()}else{n=this.distanceTo(t)<this.distanceTo(e)?t:e}return n},o.prototype.isBetween=function(t,e){var n=this.toVector(),r=t.toVector(),i=e.toVector(),o=n.minus(r),a=i.minus(r),s=n.minus(i),u=r.minus(i),c=o.dot(a),l=s.dot(u),f=c>=0&&l>=0,h=n.dot(r)>=0&&n.dot(i)>=0;return f&&h},o.prototype.enclosedBy=function(t){var e=t[0].equals(t[t.length-1]);e||t.push(t[0]);for(var n=t.length-1,r=this.toVector(),i=[],o=0;o<n;o++)i[o]=r.minus(t[o].toVector());i.push(i[0]);var a=0;for(o=0;o<n;o++)a+=i[o].angleTo(i[o+1],r);var s=Math.abs(a)>Math.PI;return e||t.pop(),s},o.areaOf=function(t,e){var n=null==e?6371e3:Number(e),r=t[0].equals(t[t.length-1]);r||t.push(t[0]);for(var i=t.length-1,o=[],a=0;a<i;a++){var s=t[a].toVector(),u=t[a+1].toVector();o[a]=s.cross(u)}o.push(o[0]);var c=t[0].toVector(),l=0;for(a=0;a<i;a++)l+=o[a].angleTo(o[a+1],c);var f=(i*Math.PI-Math.abs(l)-(i-2)*Math.PI)*n*n;return r||t.pop(),f},o.meanOf=function(t){for(var e=new r(0,0,0),n=0;n<t.length;n++)e=e.plus(t[n].toVector());return e.unit().toLatLonS()},o.prototype.equals=function(t){if(!(t instanceof o))throw new TypeError("point is not LatLon object");return this.lat==t.lat&&this.lon==t.lon},o.prototype.toString=function(t,e){return i.toLat(this.lat,t,e)+", "+i.toLon(this.lon,t,e)},void 0===Number.prototype.toRadians&&(Number.prototype.toRadians=function(){return this*Math.PI/180}),void 0===Number.prototype.toDegrees&&(Number.prototype.toDegrees=function(){return 180*this/Math.PI}),void 0===Math.sign&&(Math.sign=function(t){return 0===(t=+t)||isNaN(t)?t:t>0?1:-1}),t.exports&&(t.exports=o,t.exports.Vector3d=r)},function(t,e,n){"use strict";if(t.exports)var r=n(259);if(t.exports)var i=n(97);function o(t,e,n,r,a,s,u){if(!(this instanceof o))return new o(t,e,n,r,a,s,u);if(void 0===u&&(u=i.datum.WGS84),!(1<=t&&t<=60))throw new Error("Invalid MGRS grid reference (zone "+t+")");if(1!=e.length)throw new Error("Invalid MGRS grid reference (band "+e+")");if(-1==o.latBands.indexOf(e))throw new Error("Invalid MGRS grid reference (band "+e+")");if(1!=n.length)throw new Error("Invalid MGRS grid reference (e100k "+n+")");if(1!=r.length)throw new Error("Invalid MGRS grid reference (n100k "+r+")");this.zone=Number(t),this.band=e,this.e100k=n,this.n100k=r,this.easting=Number(a),this.northing=Number(s),this.datum=u}o.latBands="CDEFGHJKLMNPQRSTUVWXX",o.e100kLetters=["ABCDEFGH","JKLMNPQR","STUVWXYZ"],o.n100kLetters=["ABCDEFGHJKLMNPQRSTUV","FGHJKLMNPQRSTUVABCDE"],r.prototype.toMgrs=function(){if(isNaN(this.zone+this.easting+this.northing))throw new Error("Invalid UTM coordinate "+this.toString()+"");var t=this.zone,e=this.toLatLonE(),n=o.latBands.charAt(Math.floor(e.lat/8+10)),r=Math.floor(this.easting/1e5),i=o.e100kLetters[(t-1)%3].charAt(r-1),a=Math.floor(this.northing/1e5)%20,s=o.n100kLetters[(t-1)%2].charAt(a),u=this.easting%1e5,c=this.northing%1e5;return new o(t,n,i,s,u=Number(u.toFixed(6)),c=Number(c.toFixed(6)))},o.prototype.toUtm=function(){for(var t=this.zone,e=this.band,n=this.e100k,a=this.n100k,s=this.easting,u=this.northing,c=e>="N"?"N":"S",l=1e5*(o.e100kLetters[(t-1)%3].indexOf(n)+1),f=1e5*o.n100kLetters[(t-1)%2].indexOf(a),h=8*(o.latBands.indexOf(e)-10),d=1e5*Math.floor(new i(h,0).toUtm().northing/1e5),p=0;p+f+u<d;)p+=2e6;return new r(t,c,l+s,p+f+u,this.datum)},o.parse=function(t){if(!(t=t.trim()).match(/\s/)){var e=t.slice(5);e=e.slice(0,e.length/2)+" "+e.slice(-e.length/2),t=t.slice(0,3)+" "+t.slice(3,5)+" "+e}if(null==(t=t.match(/\S+/g))||4!=t.length)throw new Error("Invalid MGRS grid reference "+t+"");var n=t[0],r=n.slice(0,2),i=n.slice(2,3),a=t[1],s=a.slice(0,1),u=a.slice(1,2),c=t[2],l=t[3];return new o(r,i,s,u,c=c.length>=5?c:(c+"00000").slice(0,5),l=l.length>=5?l:(l+"00000").slice(0,5))},o.prototype.toString=function(t){if(t=void 0===t?10:Number(t),-1==[2,4,6,8,10].indexOf(t))throw new Error("Invalid precision "+t+"");var e=("00"+this.zone).slice(-2),n=this.band,r=this.e100k,i=this.n100k,o=Math.floor(this.easting/Math.pow(10,5-t/2)),a=Math.floor(this.northing/Math.pow(10,5-t/2));return e+n+" "+r+i+" "+("00000"+o).slice(-t/2)+" "+("00000"+a).slice(-t/2)},t.exports&&(t.exports=o)},function(t,e,n){"use strict";if(t.exports)var r=n(97);function i(t,e){if(!(this instanceof i))return new i(t,e);this.easting=Number(t),this.northing=Number(e)}i.latLonToOsGrid=function(t){if(!(t instanceof r))throw new TypeError("point is not LatLon object");t.datum!=r.datum.OSGB36&&(t=t.convertDatum(r.datum.OSGB36));var e=t.lat.toRadians(),n=t.lon.toRadians(),o=6377563.396,a=6356256.909,s=.9996012717,u=49..toRadians(),c=(-2).toRadians(),l=1-a*a/(o*o),f=(o-a)/(o+a),h=f*f,d=f*f*f,p=Math.cos(e),g=Math.sin(e),v=o*s/Math.sqrt(1-l*g*g),y=o*s*(1-l)/Math.pow(1-l*g*g,1.5),m=v/y-1,b=a*s*(1.0016767257673973*(e-u)-(3*f+3*f*f+21/8*d)*Math.sin(e-u)*Math.cos(e+u)+(15/8*h+15/8*d)*Math.sin(2*(e-u))*Math.cos(2*(e+u))-35/24*d*Math.sin(3*(e-u))*Math.cos(3*(e+u))),_=p*p*p,x=_*p*p,w=Math.tan(e)*Math.tan(e),E=w*w,S=n-c,O=S*S,P=O*S,C=P*S,M=C*S,I=b+-1e5+v/2*g*p*O+v/24*g*_*(5-w+9*m)*C+v/720*g*x*(61-58*w+E)*(M*S),A=4e5+v*p*S+v/6*_*(v/y-w)*P+v/120*x*(5-18*w+E+14*m-58*w*m)*M;return I=Number(I.toFixed(3)),new i(A=Number(A.toFixed(3)),I)},i.osGridToLatLon=function(t,e){if(!(t instanceof i))throw new TypeError("gridref is not OsGridRef object");void 0===e&&(e=r.datum.WGS84);var n=t.easting,o=t.northing,a=6377563.396,s=6356256.909,u=.9996012717,c=49..toRadians(),l=(-2).toRadians(),f=1-s*s/(a*a),h=(a-s)/(a+s),d=h*h,p=h*h*h,g=c,v=0;do{v=s*u*(1.0016767257673973*((g=(o- -1e5-v)/(a*u)+g)-c)-(3*h+3*h*h+21/8*p)*Math.sin(g-c)*Math.cos(g+c)+(15/8*d+15/8*p)*Math.sin(2*(g-c))*Math.cos(2*(g+c))-35/24*p*Math.sin(3*(g-c))*Math.cos(3*(g+c)))}while(o- -1e5-v>=1e-5);var y=Math.cos(g),m=Math.sin(g),b=a*u/Math.sqrt(1-f*m*m),_=a*u*(1-f)/Math.pow(1-f*m*m,1.5),x=b/_-1,w=Math.tan(g),E=w*w,S=E*E,O=1/y,P=b*b*b,C=P*b*b,M=n-4e5,I=M*M,A=I*M,T=I*I,N=A*I,L=l+O/b*M-O/(6*P)*(b/_+2*E)*A+O/(120*C)*(5+28*E+24*S)*N-O/(5040*(C*b*b))*(61+662*E+1320*S+720*(S*E))*(N*I),R=new r((g=g-w/(2*_*b)*I+w/(24*_*P)*(5+3*E+x-9*E*x)*T-w/(720*_*C)*(61+90*E+45*S)*(T*I)).toDegrees(),L.toDegrees(),r.datum.OSGB36);return e!=r.datum.OSGB36&&(R=R.convertDatum(e)),R},i.parse=function(t){var e=(t=String(t).trim()).match(/^(\d+),\s*(\d+)$/);if(e)return new i(e[1],e[2]);if(!(e=t.match(/^[A-Z]{2}\s*[0-9]+\s*[0-9]+$/i)))throw new Error("Invalid grid reference");var n=t.toUpperCase().charCodeAt(0)-"A".charCodeAt(0),r=t.toUpperCase().charCodeAt(1)-"A".charCodeAt(0);n>7&&n--,r>7&&r--;var o=(n-2)%5*5+r%5,a=19-5*Math.floor(n/5)-Math.floor(r/5),s=t.slice(2).trim().split(/\s+/);if(1==s.length&&(s=[s[0].slice(0,s[0].length/2),s[0].slice(s[0].length/2)]),o<0||o>6||a<0||a>12)throw new Error("Invalid grid reference");if(2!=s.length)throw new Error("Invalid grid reference");if(s[0].length!=s[1].length)throw new Error("Invalid grid reference");return s[0]=(s[0]+"00000").slice(0,5),s[1]=(s[1]+"00000").slice(0,5),new i(o+s[0],a+s[1])},i.prototype.toString=function(t){if(t=void 0===t?10:Number(t),isNaN(t)||t%2!=0||t>16)throw new RangeError("Invalid precision "+t+"");var e=this.easting,n=this.northing;if(isNaN(e)||isNaN(n))throw new Error("Invalid grid reference");if(0==t){var r=Math.floor(e),i=e-r,o=Math.floor(n),a=n-o;return("000000"+r).slice(-6)+(i>0?i.toFixed(3).slice(1):"")+","+((o<1e6?("000000"+o).slice(-6):o)+(a>0?a.toFixed(3).slice(1):""))}var s=Math.floor(e/1e5),u=Math.floor(n/1e5);if(s<0||s>6||u<0||u>12)return"";var c=19-u-(19-u)%5+Math.floor((s+10)/5),l=5*(19-u)%25+s%5;c>7&&c++,l>7&&l++;var f=String.fromCharCode(c+"A".charCodeAt(0),l+"A".charCodeAt(0));return e=Math.floor(e%1e5/Math.pow(10,5-t/2)),n=Math.floor(n%1e5/Math.pow(10,5-t/2)),f+" "+(e=("00000000"+e).slice(-t/2))+" "+(n=("00000000"+n).slice(-t/2))},t.exports&&(t.exports=i)},function(t,e,n){var r=n(91).coordEach;t.exports=function(t){var e=[1/0,1/0,-1/0,-1/0];return r(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}},function(t,e,n){var r=n(263);function i(t,e,n){var r=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var i=0,o=e.length-1;i<e.length;o=i++){var a=e[i][0],s=e[i][1],u=e[o][0],c=e[o][1];if(t[1]*(a-u)+s*(u-t[0])+c*(t[0]-a)==0&&(a-t[0])*(u-t[0])<=0&&(s-t[1])*(c-t[1])<=0)return!n;s>t[1]!=c>t[1]&&t[0]<(u-a)*(t[1]-s)/(c-s)+a&&(r=!r)}return r}t.exports=function(t,e){var n=r.getCoord(t),o=e.geometry.coordinates;"Polygon"===e.geometry.type&&(o=[o]);for(var a=0,s=!1;a<o.length&&!s;a++)if(i(n,o[a][0])){for(var u=!1,c=1;c<o[a].length&&!u;)i(n,o[a][c],!0)&&(u=!0),c++;u||(s=!0)}return s}},function(t,e,n){var r=n(124).featureCollection,i=n(91).featureEach,o=n(91).coordEach,a=n(124).point;t.exports=function(t){var e=[];return"FeatureCollection"===t.type?i(t,(function(t){o(t,(function(n){e.push(a(n,t.properties))}))})):o(t,(function(n){e.push(a(n,t.properties))})),r(e)}},function(t,e,n){"use strict";
/*!
* MarchingSquaresJS
* version 1.3.3
* https://github.com/RaumZeit/MarchingSquares.js
*
* @license GNU Affero General Public License.
* Copyright (c) 2015-2019 Ronny Lorenz <ronny@tbi.univie.ac.at>
*/
function r(t,e,n){return t<e?(n-t)/(e-t):(t-n)/(t-e)}function i(t,e,n,r){var i;return n>r&&(i=n,n=r,r=i),t<e?t<n?(n-t)/(e-t):(r-t)/(e-t):t>r?(t-r)/(t-e):(t-n)/(t-e)}function o(t,e,n,r){return t<e?(n-t)/(e-t):(t-r)/(t-e)}function a(t,e,n,r){return t<e?(r-t)/(e-t):(t-n)/(t-e)}function s(){this.successCallback=null,this.verbose=!1,this.polygons=!1,this.polygons_full=!1,this.linearRing=!0,this.noQuadTree=!1,this.noFrame=!1}function u(t,e,n,r){var i=[];return t.polygons.forEach((function(t){t.forEach((function(t){t[0]+=e,t[1]+=n})),r.linearRing&&t.push(t[0]),i.push(t)})),i}function c(t,e,n,r){return 0===n?(t+=1,e+=r[0][1]):1===n?t+=r[0][0]:2===n?e+=r[0][1]:3===n&&(t+=r[0][0],e+=1),[t,e]}function l(t,e,n){return 0===n?t++:1===n||(2===n?e++:3===n&&(t++,e++)),[t,e]}function f(t,e,n,r,i){var o=r,a=i,s=0,u=0;if(this.x=e,this.y=n,this.lowerBound=null,this.upperBound=null,this.childA=null,this.childB=null,this.childC=null,this.childD=null,1===r&&1===i)this.lowerBound=Math.min(t[n][e],t[n][e+1],t[n+1][e+1],t[n+1][e]),this.upperBound=Math.max(t[n][e],t[n][e+1],t[n+1][e+1],t[n+1][e]);else{if(r>1){for(;0!==o;)o>>=1,s++;r===1<<s-1&&s--,o=1<<s-1}if(i>1){for(;0!==a;)a>>=1,u++;i===1<<u-1&&u--,a=1<<u-1}this.childA=new f(t,e,n,o,a),this.lowerBound=this.childA.lowerBound,this.upperBound=this.childA.upperBound,r-o>0&&(this.childB=new f(t,e+o,n,r-o,a),this.lowerBound=Math.min(this.lowerBound,this.childB.lowerBound),this.upperBound=Math.max(this.upperBound,this.childB.upperBound),i-a>0&&(this.childC=new f(t,e+o,n+a,r-o,i-a),this.lowerBound=Math.min(this.lowerBound,this.childC.lowerBound),this.upperBound=Math.max(this.upperBound,this.childC.upperBound))),i-a>0&&(this.childD=new f(t,e,n+a,o,i-a),this.lowerBound=Math.min(this.lowerBound,this.childD.lowerBound),this.upperBound=Math.max(this.upperBound,this.childD.upperBound))}}function h(t){var e,n;if(!t)throw new Error("data is required");if(!Array.isArray(t)||!Array.isArray(t[0]))throw new Error("data must be scalar field, i.e. array of arrays");if(t.length<2)throw new Error("data must contain at least two rows");if((n=t[0].length)<2)throw new Error("data must contain at least two columns");for(e=1;e<t.length;e++){if(!Array.isArray(t[e]))throw new Error("Row "+e+" is not an array");if(t[e].length!=n)throw new Error("unequal row lengths detected, please provide a regular grid")}this.data=t,this.root=new f(t,0,0,t[0].length-1,t.length-1)}function d(t,e,n){var i,o,a,f=!1,d=!1,g=null,v=null,y=null,m=null,b=null,_=[];if(!t)throw new Error("data is required");if(null==e)throw new Error("threshold is required");if(n&&"object"!=typeof n)throw new Error("options must be an object");if(i=function(t){var e,n,i,o,a;for(o=new s,t=t||{},a=Object.keys(o),e=0;e<a.length;e++)null!=(i=t[n=a[e]])&&(o[n]=i);return o.polygons_full=!o.polygons,o.interpolate=r,o}(n),t instanceof h)g=t,v=t.root,y=t.data,i.noQuadTree||(f=!0);else{if(!Array.isArray(t)||!Array.isArray(t[0]))throw new Error("input is neither array of arrays nor object retrieved from 'QuadTree()'");y=t}if(Array.isArray(e)){for(d=!0,i.noQuadTree||(f=!0),o=0;o<e.length;o++)if(isNaN(+e[o]))throw new Error("threshold["+o+"] is not a number")}else{if(isNaN(+e))throw new Error("threshold must be a number or array of numbers");e=[e]}return f&&!v&&(g=new h(y),v=g.root,y=g.data),i.verbose&&(i.polygons?console.log("MarchingSquaresJS-isoLines: returning single lines (polygons) for each grid cell"):console.log("MarchingSquaresJS-isoLines: returning line paths (polygons) for entire data grid"),d&&console.log("MarchingSquaresJS-isoLines: multiple lines requested, returning array of line paths instead of lines for a single threshold")),e.forEach((function(t,e){if(b=[],i.threshold=t,i.verbose&&console.log("MarchingSquaresJS-isoLines: computing iso lines for threshold "+t),i.polygons)if(f)v.cellsBelowThreshold(i.threshold,!0).forEach((function(t){b=b.concat(u(p(y,t.x,t.y,i),t.x,t.y,i))}));else for(a=0;a<y.length-1;++a)for(e=0;e<y[0].length-1;++e)b=b.concat(u(p(y,e,a,i),e,a,i));else{for(m=[],e=0;e<y[0].length-1;++e)m[e]=[];if(f)v.cellsBelowThreshold(i.threshold,!1).forEach((function(t){m[t.x][t.y]=p(y,t.x,t.y,i)}));else for(e=0;e<y[0].length-1;++e)for(a=0;a<y.length-1;++a)m[e][a]=p(y,e,a,i);b=function(t,e,n){var r,i,o,a,s,u,f,h,d,p,g,v,y,m,b,_=[],x=t.length-1,w=t[0].length-1,E=["right","bottom","left","top"],S=[0,-1,0,1],O=[-1,0,1,0],P={bottom:1,left:2,top:3,right:0};return n.noFrame||function(t,e){var n,r,i,o,a;for(n=!0,r=t[0].length,i=t.length,a=0;a<i;a++)if(t[a][0]>=e||t[a][r-1]>=e){n=!1;break}if(n&&(t[i-1][0]>=e||t[i-1][r-1]>=e)&&(n=!1),n)for(o=0;o<r-1;o++)if(t[0][o]>=e||t[i-1][o]>e){n=!1;break}return n}(t,n.threshold)&&(n.linearRing?_.push([[0,0],[0,x],[w,x],[w,0],[0,0]]):_.push([[0,0],[0,x],[w,x],[w,0]])),e.forEach((function(t,C){t.forEach((function(t,M){for(r=null,i=0;i<4;i++)if(r=E[i],"object"==typeof t.edges[r]){for(s=[],o=t.edges[r],u=r,f=C,h=M,d=!1,p=[C+o.path[0][0],M+o.path[0][1]],s.push(p);!d&&"object"==typeof(a=e[f][h]).edges[u];)if(o=a.edges[u],delete a.edges[u],(g=o.path[1])[0]+=f,g[1]+=h,s.push(g),u=o.move.enter,f+=o.move.x,h+=o.move.y,void 0===e[f]||void 0===e[f][h]){if(!n.linearRing)break;if(v=0,y=0,f===w?(f--,v=0):f<0?(f++,v=2):h===x?(h--,v=3):h<0&&(h++,v=1),f===C&&h===M&&v===P[r]){d=!0,u=r;break}for(;;){if(m=!1,y>4)throw new Error("Direction change counter overflow! This should never happen!");if(void 0!==e[f]&&void 0!==e[f][h]&&(a=e[f][h],b=E[v],"object"==typeof a.edges[b])){o=a.edges[b],s.push(c(f,h,v,o.path)),u=b,m=!0;break}if(m)break;if(s.push(l(f,h,v)),h+=O[v],void 0!==e[f+=S[v]]&&void 0!==e[f][h]||(0===v&&h<0||1===v&&f<0||2===v&&h===x||3===v&&f===w)&&(f-=S[v],h-=O[v],v=(v+1)%4,y++),f===C&&h===M&&v===P[r]){d=!0,u=r;break}}}!n.linearRing||s[s.length-1][0]===p[0]&&s[s.length-1][1]===p[1]||s.push(p),_.push(s)}}))})),_}(y,m,i)}d?_.push(b):_=b,"function"==typeof i.successCallback&&i.successCallback(_,t)})),_}function p(t,e,n,r){var i,o,a,s,u,c,l=0,f=t[n+1][e],h=t[n+1][e+1],d=t[n][e+1],p=t[n][e],g=r.threshold;if(!(isNaN(p)||isNaN(d)||isNaN(h)||isNaN(f))){switch(l|=f>=g?8:0,l|=h>=g?4:0,l|=d>=g?2:0,c={cval:l=+(l|=p>=g?1:0),polygons:[],edges:{},x0:p,x1:d,x2:h,x3:f},l){case 0:r.polygons&&c.polygons.push([[0,0],[0,1],[1,1],[1,0]]);break;case 15:break;case 14:i=r.interpolate(p,f,g),s=r.interpolate(p,d,g),r.polygons_full&&(c.edges.left={path:[[0,i],[s,0]],move:{x:0,y:-1,enter:"top"}}),r.polygons&&c.polygons.push([[0,0],[0,i],[s,0]]);break;case 13:s=r.interpolate(p,d,g),o=r.interpolate(d,h,g),r.polygons_full&&(c.edges.bottom={path:[[s,0],[1,o]],move:{x:1,y:0,enter:"left"}}),r.polygons&&c.polygons.push([[s,0],[1,o],[1,0]]);break;case 11:o=r.interpolate(d,h,g),a=r.interpolate(f,h,g),r.polygons_full&&(c.edges.right={path:[[1,o],[a,1]],move:{x:0,y:1,enter:"bottom"}}),r.polygons&&c.polygons.push([[1,o],[a,1],[1,1]]);break;case 7:i=r.interpolate(p,f,g),a=r.interpolate(f,h,g),r.polygons_full&&(c.edges.top={path:[[a,1],[0,i]],move:{x:-1,y:0,enter:"right"}}),r.polygons&&c.polygons.push([[a,1],[0,i],[0,1]]);break;case 1:i=r.interpolate(p,f,g),s=r.interpolate(p,d,g),r.polygons_full&&(c.edges.bottom={path:[[s,0],[0,i]],move:{x:-1,y:0,enter:"right"}}),r.polygons&&c.polygons.push([[s,0],[0,i],[0,1],[1,1],[1,0]]);break;case 2:s=r.interpolate(p,d,g),o=r.interpolate(d,h,g),r.polygons_full&&(c.edges.right={path:[[1,o],[s,0]],move:{x:0,y:-1,enter:"top"}}),r.polygons&&c.polygons.push([[0,0],[0,1],[1,1],[1,o],[s,0]]);break;case 4:o=r.interpolate(d,h,g),a=r.interpolate(f,h,g),r.polygons_full&&(c.edges.top={path:[[a,1],[1,o]],move:{x:1,y:0,enter:"left"}}),r.polygons&&c.polygons.push([[0,0],[0,1],[a,1],[1,o],[1,0]]);break;case 8:i=r.interpolate(p,f,g),a=r.interpolate(f,h,g),r.polygons_full&&(c.edges.left={path:[[0,i],[a,1]],move:{x:0,y:1,enter:"bottom"}}),r.polygons&&c.polygons.push([[0,0],[0,i],[a,1],[1,1],[1,0]]);break;case 12:i=r.interpolate(p,f,g),o=r.interpolate(d,h,g),r.polygons_full&&(c.edges.left={path:[[0,i],[1,o]],move:{x:1,y:0,enter:"left"}}),r.polygons&&c.polygons.push([[0,0],[0,i],[1,o],[1,0]]);break;case 9:s=r.interpolate(p,d,g),a=r.interpolate(f,h,g),r.polygons_full&&(c.edges.bottom={path:[[s,0],[a,1]],move:{x:0,y:1,enter:"bottom"}}),r.polygons&&c.polygons.push([[s,0],[a,1],[1,1],[1,0]]);break;case 3:i=r.interpolate(p,f,g),o=r.interpolate(d,h,g),r.polygons_full&&(c.edges.right={path:[[1,o],[0,i]],move:{x:-1,y:0,enter:"right"}}),r.polygons&&c.polygons.push([[0,i],[0,1],[1,1],[1,o]]);break;case 6:s=r.interpolate(p,d,g),a=r.interpolate(f,h,g),r.polygons_full&&(c.edges.top={path:[[a,1],[s,0]],move:{x:0,y:-1,enter:"top"}}),r.polygons&&c.polygons.push([[0,0],[0,1],[a,1],[s,0]]);break;case 10:i=r.interpolate(p,f,g),o=r.interpolate(d,h,g),s=r.interpolate(p,d,g),a=r.interpolate(f,h,g),u=(p+d+h+f)/4,r.polygons_full&&(u<g?(c.edges.left={path:[[0,i],[a,1]],move:{x:0,y:1,enter:"bottom"}},c.edges.right={path:[[1,o],[s,0]],move:{x:0,y:-1,enter:"top"}}):(c.edges.right={path:[[1,o],[a,1]],move:{x:0,y:1,enter:"bottom"}},c.edges.left={path:[[0,i],[s,0]],move:{x:0,y:-1,enter:"top"}})),r.polygons&&(u<g?c.polygons.push([[0,0],[0,i],[a,1],[1,1],[1,o],[s,0]]):(c.polygons.push([[0,0],[0,i],[s,0]]),c.polygons.push([[a,1],[1,1],[1,o]])));break;case 5:i=r.interpolate(p,f,g),o=r.interpolate(d,h,g),s=r.interpolate(p,d,g),a=r.interpolate(f,h,g),u=(p+d+h+f)/4,r.polygons_full&&(u<g?(c.edges.bottom={path:[[s,0],[0,i]],move:{x:-1,y:0,enter:"right"}},c.edges.top={path:[[a,1],[1,o]],move:{x:1,y:0,enter:"left"}}):(c.edges.top={path:[[a,1],[0,i]],move:{x:-1,y:0,enter:"right"}},c.edges.bottom={path:[[s,0],[1,o]],move:{x:1,y:0,enter:"left"}})),r.polygons&&(u<g?c.polygons.push([[0,i],[0,1],[a,1],[1,o],[1,0],[s,0]]):(c.polygons.push([[0,i],[0,1],[a,1]]),c.polygons.push([[s,0],[1,o],[1,0]])))}return c}}n.r(e),n.d(e,"isoLines",(function(){return d})),n.d(e,"isoContours",(function(){return d})),n.d(e,"isoBands",(function(){return $})),n.d(e,"QuadTree",(function(){return h})),n.d(e,"quadTree",(function(){return h})),f.prototype.cellsInBand=function(t,e,n){var r=[];return n=void 0===n||n,this.lowerBound>e||this.upperBound<t||(this.childA||this.childB||this.childC||this.childD?(this.childA&&(r=r.concat(this.childA.cellsInBand(t,e,n))),this.childB&&(r=r.concat(this.childB.cellsInBand(t,e,n))),this.childD&&(r=r.concat(this.childD.cellsInBand(t,e,n))),this.childC&&(r=r.concat(this.childC.cellsInBand(t,e,n)))):(n||this.lowerBound<=t||this.upperBound>=e)&&r.push({x:this.x,y:this.y})),r},f.prototype.cellsBelowThreshold=function(t,e){var n=[];return e=void 0===e||e,this.lowerBound>t||(this.childA||this.childB||this.childC||this.childD?(this.childA&&(n=n.concat(this.childA.cellsBelowThreshold(t,e))),this.childB&&(n=n.concat(this.childB.cellsBelowThreshold(t,e))),this.childD&&(n=n.concat(this.childD.cellsBelowThreshold(t,e))),this.childC&&(n=n.concat(this.childC.cellsBelowThreshold(t,e)))):(e||this.upperBound>=t)&&n.push({x:this.x,y:this.y})),n};var g=function(t,e,n,r,i,o){o.polygons&&t.polygons.push([[0,0],[0,1],[1,1],[1,0]])},v=function(t,e,n,r,i,o){var a=o.interpolate(e,n,o.minV,o.maxV),s=o.interpolate(e,i,o.minV,o.maxV);o.polygons_full&&(t.edges.lb={path:[[0,s],[a,0]],move:{x:0,y:-1,enter:"tl"}}),o.polygons&&t.polygons.push([[0,s],[a,0],[0,0]])},y=function(t,e,n,r,i,o){var a=o.interpolate(e,n,o.minV,o.maxV),s=o.interpolate(n,r,o.minV,o.maxV);o.polygons_full&&(t.edges.br={path:[[a,0],[1,s]],move:{x:1,y:0,enter:"lb"}}),o.polygons&&t.polygons.push([[a,0],[1,s],[1,0]])},m=function(t,e,n,r,i,o){var a=o.interpolate(n,r,o.minV,o.maxV),s=o.interpolate(i,r,o.minV,o.maxV);o.polygons_full&&(t.edges.rt={path:[[1,a],[s,1]],move:{x:0,y:1,enter:"br"}}),o.polygons&&t.polygons.push([[1,a],[s,1],[1,1]])},b=function(t,e,n,r,i,o){var a=o.interpolate(i,r,o.minV,o.maxV),s=o.interpolate(e,i,o.minV,o.maxV);o.polygons_full&&(t.edges.tl={path:[[a,1],[0,s]],move:{x:-1,y:0,enter:"rt"}}),o.polygons&&t.polygons.push([[0,s],[0,1],[a,1]])},_=function(t,e,n,r,i,o){var a=o.interpolate(n,r,o.minV,o.maxV),s=o.interpolate(e,i,o.minV,o.maxV);o.polygons_full&&(t.edges.rt={path:[[1,a],[0,s]],move:{x:-1,y:0,enter:"rt"}}),o.polygons&&t.polygons.push([[0,s],[0,1],[1,1],[1,a]])},x=function(t,e,n,r,i,o){var a=o.interpolate(e,n,o.minV,o.maxV),s=o.interpolate(i,r,o.minV,o.maxV);o.polygons_full&&(t.edges.br={path:[[a,0],[s,1]],move:{x:0,y:1,enter:"br"}}),o.polygons&&t.polygons.push([[a,0],[s,1],[1,1],[1,0]])},w=function(t,e,n,r,i,o){var a=o.interpolate(e,i,o.minV,o.maxV),s=o.interpolate(n,r,o.minV,o.maxV);o.polygons_full&&(t.edges.lb={path:[[0,a],[1,s]],move:{x:1,y:0,enter:"lb"}}),o.polygons&&t.polygons.push([[0,0],[0,a],[1,s],[1,0]])},E=function(t,e,n,r,i,o){var a=o.interpolate(i,r,o.minV,o.maxV),s=o.interpolate(e,n,o.minV,o.maxV);o.polygons_full&&(t.edges.tl={path:[[a,1],[s,0]],move:{x:0,y:-1,enter:"tl"}}),o.polygons&&t.polygons.push([[0,0],[0,1],[a,1],[s,0]])},S=function(t,e,n,r,i,o){var a=o.interpolate_a(e,n,o.minV,o.maxV),s=o.interpolate_b(e,n,o.minV,o.maxV),u=o.interpolate_a(e,i,o.minV,o.maxV),c=o.interpolate_b(e,i,o.minV,o.maxV);o.polygons_full&&(t.edges.bl={path:[[a,0],[0,u]],move:{x:-1,y:0,enter:"rb"}},t.edges.lt={path:[[0,c],[s,0]],move:{x:0,y:-1,enter:"tr"}}),o.polygons&&t.polygons.push([[a,0],[0,u],[0,c],[s,0]])},O=function(t,e,n,r,i,o){var a=o.interpolate_a(e,n,o.minV,o.maxV),s=o.interpolate_b(e,n,o.minV,o.maxV),u=o.interpolate_a(n,r,o.minV,o.maxV),c=o.interpolate_b(n,r,o.minV,o.maxV);o.polygons_full&&(t.edges.bl={path:[[a,0],[1,c]],move:{x:1,y:0,enter:"lt"}},t.edges.rb={path:[[1,u],[s,0]],move:{x:0,y:-1,enter:"tr"}}),o.polygons&&t.polygons.push([[a,0],[1,c],[1,u],[s,0]])},P=function(t,e,n,r,i,o){var a=o.interpolate_a(i,r,o.minV,o.maxV),s=o.interpolate_b(i,r,o.minV,o.maxV),u=o.interpolate_b(n,r,o.minV,o.maxV),c=o.interpolate_a(n,r,o.minV,o.maxV);o.polygons_full&&(t.edges.rb={path:[[1,c],[a,1]],move:{x:0,y:1,enter:"bl"}},t.edges.tr={path:[[s,1],[1,u]],move:{x:1,y:0,enter:"lt"}}),o.polygons&&t.polygons.push([[1,c],[a,1],[s,1],[1,u]])},C=function(t,e,n,r,i,o){var a=o.interpolate_a(i,r,o.minV,o.maxV),s=o.interpolate_b(i,r,o.minV,o.maxV),u=o.interpolate_b(e,i,o.minV,o.maxV),c=o.interpolate_a(e,i,o.minV,o.maxV);o.polygons_full&&(t.edges.tr={path:[[s,1],[0,c]],move:{x:-1,y:0,enter:"rb"}},t.edges.lt={path:[[0,u],[a,1]],move:{x:0,y:1,enter:"bl"}}),o.polygons&&t.polygons.push([[s,1],[0,c],[0,u],[a,1]])},M=function(t,e,n,r,i,o){var a=o.interpolate_a(e,i,o.minV,o.maxV),s=o.interpolate_b(e,i,o.minV,o.maxV),u=o.interpolate_b(n,r,o.minV,o.maxV),c=o.interpolate_a(n,r,o.minV,o.maxV);o.polygons_full&&(t.edges.lt={path:[[0,s],[1,u]],move:{x:1,y:0,enter:"lt"}},t.edges.rb={path:[[1,c],[0,a]],move:{x:-1,y:0,enter:"rb"}}),o.polygons&&t.polygons.push([[0,a],[0,s],[1,u],[1,c]])},I=function(t,e,n,r,i,o){var a=o.interpolate_a(i,r,o.minV,o.maxV),s=o.interpolate_b(i,r,o.minV,o.maxV),u=o.interpolate_b(e,n,o.minV,o.maxV),c=o.interpolate_a(e,n,o.minV,o.maxV);o.polygons_full&&(t.edges.tr={path:[[s,1],[u,0]],move:{x:0,y:-1,enter:"tr"}},t.edges.bl={path:[[c,0],[a,1]],move:{x:0,y:1,enter:"bl"}}),o.polygons&&t.polygons.push([[c,0],[a,1],[s,1],[u,0]])},A=function(t,e,n,r,i,o){var a=o.interpolate(i,r,o.minV,o.maxV),s=o.interpolate(n,r,o.minV,o.maxV);o.polygons_full&&(t.edges.tl={path:[[a,1],[1,s]],move:{x:1,y:0,enter:"lb"}}),o.polygons&&t.polygons.push([[0,0],[0,1],[a,1],[1,s],[1,0]])},T=function(t,e,n,r,i,o){var a=o.interpolate(e,i,o.minV,o.maxV),s=o.interpolate(i,r,o.minV,o.maxV);o.polygons_full&&(t.edges.lb={path:[[0,a],[s,1]],move:{x:0,y:1,enter:"br"}}),o.polygons&&t.polygons.push([[0,0],[0,a],[s,1],[1,1],[1,0]])},N=function(t,e,n,r,i,o){var a=o.interpolate(e,n,o.minV,o.maxV),s=o.interpolate(n,r,o.minV,o.maxV);o.polygons_full&&(t.edges.rt={path:[[1,s],[a,0]],move:{x:0,y:-1,enter:"tl"}}),o.polygons&&t.polygons.push([[0,0],[0,1],[1,1],[1,s],[a,0]])},L=function(t,e,n,r,i,o){var a=o.interpolate(e,i,o.minV,o.maxV),s=o.interpolate(e,n,o.minV,o.maxV);o.polygons_full&&(t.edges.br={path:[[s,0],[0,a]],move:{x:-1,y:0,enter:"rt"}}),o.polygons&&t.polygons.push([[0,a],[0,1],[1,1],[1,0],[s,0]])},R=function(t,e,n,r,i,o){var a=o.interpolate(e,i,o.minV,o.maxV),s=o.interpolate(i,r,o.minV,o.maxV),u=o.interpolate_b(n,r,o.minV,o.maxV),c=o.interpolate_a(n,r,o.minV,o.maxV);o.polygons_full&&(t.edges.tl={path:[[s,1],[1,u]],move:{x:1,y:0,enter:"lt"}},t.edges.rb={path:[[1,c],[0,a]],move:{x:-1,y:0,enter:"rt"}}),o.polygons&&t.polygons.push([[0,a],[0,1],[s,1],[1,u],[1,c]])},k=function(t,e,n,r,i,o){var a=o.interpolate(n,r,o.minV,o.maxV),s=o.interpolate_b(e,n,o.minV,o.maxV),u=o.interpolate_a(e,n,o.minV,o.maxV),c=o.interpolate(i,r,o.minV,o.maxV);o.polygons_full&&(t.edges.rt={path:[[1,a],[s,0]],move:{x:0,y:-1,enter:"tr"}},t.edges.bl={path:[[u,0],[c,1]],move:{x:0,y:1,enter:"br"}}),o.polygons&&t.polygons.push([[c,1],[1,1],[1,a],[s,0],[u,0]])},j=function(t,e,n,r,i,o){var a=o.interpolate(e,n,o.minV,o.maxV),s=o.interpolate_a(e,i,o.minV,o.maxV),u=o.interpolate_b(e,i,o.minV,o.maxV),c=o.interpolate(n,r,o.minV,o.maxV);o.polygons_full&&(t.edges.br={path:[[a,0],[0,s]],move:{x:-1,y:0,enter:"rb"}},t.edges.lt={path:[[0,u],[1,c]],move:{x:1,y:0,enter:"lb"}}),o.polygons&&t.polygons.push([[a,0],[0,s],[0,u],[1,c],[1,0]])},F=function(t,e,n,r,i,o){var a=o.interpolate(e,i,o.minV,o.maxV),s=o.interpolate_a(i,r,o.minV,o.maxV),u=o.interpolate_b(i,r,o.minV,o.maxV),c=o.interpolate(e,n,o.minV,o.maxV);o.polygons_full&&(t.edges.lb={path:[[0,a],[s,1]],move:{x:0,y:1,enter:"bl"}},t.edges.tr={path:[[u,1],[c,0]],move:{x:0,y:-1,enter:"tl"}}),o.polygons&&t.polygons.push([[0,0],[0,a],[s,1],[u,1],[c,0]])},D=function(t,e,n,r,i,o){var a=o.interpolate(e,i,o.minV,o.maxV),s=o.interpolate(i,r,o.minV,o.maxV),u=o.interpolate_b(e,n,o.minV,o.maxV),c=o.interpolate_a(e,n,o.minV,o.maxV);o.polygons_full&&(t.edges.bl={path:[[c,0],[0,a]],move:{x:-1,y:0,enter:"rt"}},t.edges.tl={path:[[s,1],[u,0]],move:{x:0,y:-1,enter:"tr"}}),o.polygons&&t.polygons.push([[0,a],[0,1],[s,1],[u,0],[c,0]])},B=function(t,e,n,r,i,o){var a=o.interpolate_a(e,i,o.minV,o.maxV),s=o.interpolate_b(e,i,o.minV,o.maxV),u=o.interpolate(i,r,o.minV,o.maxV),c=o.interpolate(n,i,o.minV,o.maxV);o.polygons_full&&(t.edges.lt={path:[[0,s],[u,1]],move:{x:0,y:1,enter:"br"}},t.edges.rt={path:[[1,c],[0,a]],move:{x:-1,y:0,enter:"rb"}}),o.polygons&&t.polygons.push([[0,a],[0,s],[u,1],[1,1],[1,c]])},z=function(t,e,n,r,i,o){var a=o.interpolate_a(i,r,o.minV,o.maxV),s=o.interpolate_b(i,r,o.minV,o.maxV),u=o.interpolate(n,r,o.minV,o.maxV),c=o.interpolate(e,n,o.minV,o.maxV);o.polygons_full&&(t.edges.br={path:[[c,0],[a,1]],move:{x:0,y:1,enter:"bl"}},t.edges.tr={path:[[s,1],[1,u]],move:{x:1,y:0,enter:"lb"}}),o.polygons&&t.polygons.push([[a,1],[s,1],[1,u],[1,0],[c,0]])},V=function(t,e,n,r,i,o){var a=o.interpolate(e,i,o.minV,o.maxV),s=o.interpolate_b(n,r,o.minV,o.maxV),u=o.interpolate_a(n,r,o.minV,o.maxV),c=o.interpolate(e,n,o.minV,o.maxV);o.polygons_full&&(t.edges.lb={path:[[0,a],[1,s]],move:{x:1,y:0,enter:"lt"}},t.edges.rb={path:[[1,u],[c,0]],move:{x:0,y:-1,enter:"tl"}}),o.polygons&&t.polygons.push([[0,0],[0,a],[1,s],[1,u],[c,0]])},G=function(t,e,n,r,i,o){var a=o.interpolate(e,i,o.minV,o.maxV),s=o.interpolate_a(i,r,o.minV,o.maxV),u=o.interpolate_b(i,r,o.minV,o.maxV),c=o.interpolate(n,r,o.minV,o.maxV);o.polygons_full&&(t.edges.lb={path:[[0,a],[s,1]],move:{x:0,y:1,enter:"bl"}},t.edges.tr={path:[[u,1],[1,c]],move:{x:1,y:0,enter:"lb"}}),o.polygons&&t.polygons.push([[0,0],[0,a],[s,1],[u,1],[1,c],[1,0]])},U=function(t,e,n,r,i,o){var a=o.interpolate(e,n,o.minV,o.maxV),s=o.interpolate_a(e,i,o.minV,o.maxV),u=o.interpolate_b(e,i,o.minV,o.maxV),c=o.interpolate(i,r,o.minV,o.maxV);o.polygons_full&&(t.edges.br={path:[[a,0],[0,s]],move:{x:-1,y:0,enter:"rb"}},t.edges.lt={path:[[0,u],[c,1]],move:{x:0,y:1,enter:"br"}}),o.polygons&&t.polygons.push([[a,0],[0,s],[0,u],[c,1],[1,1],[1,0]])},W=function(t,e,n,r,i,o){var a=o.interpolate_a(e,n,o.minV,o.maxV),s=o.interpolate_b(e,n,o.minV,o.maxV),u=o.interpolate(e,i,o.minV,o.maxV),c=o.interpolate(n,r,o.minV,o.maxV);o.polygons_full&&(t.edges.bl={path:[[a,0],[0,u]],move:{x:-1,y:0,enter:"rt"}},t.edges.rt={path:[[1,c],[s,0]],move:{x:0,y:-1,enter:"tr"}}),o.polygons&&t.polygons.push([[a,0],[0,u],[0,1],[1,1],[1,c],[s,0]])},q=function(t,e,n,r,i,o){var a=o.interpolate(e,n,o.minV,o.maxV),s=o.interpolate(i,r,o.minV,o.maxV),u=o.interpolate_b(n,r,o.minV,o.maxV),c=o.interpolate_a(n,r,o.minV,o.maxV);o.polygons_full&&(t.edges.tl={path:[[s,1],[1,u]],move:{x:1,y:0,enter:"lt"}},t.edges.rb={path:[[1,c],[a,0]],move:{x:0,y:-1,enter:"tl"}}),o.polygons&&t.polygons.push([[0,0],[0,1],[s,1],[1,u],[1,c],[a,0]])},X=function(t,e,n,r,i,o){var a=o.interpolate(e,i,o.minV,o.maxV),s=o.interpolate(i,r,o.minV,o.maxV),u=o.interpolate(n,r,o.minV,o.maxV),c=o.interpolate(e,n,o.minV,o.maxV);o.polygons_full&&(t.edges.lb={path:[[0,a],[s,1]],move:{x:0,y:1,enter:"br"}},t.edges.rt={path:[[1,u],[c,0]],move:{x:0,y:-1,enter:"tl"}}),o.polygons&&t.polygons.push([[0,0],[0,a],[s,1],[1,1],[1,u],[c,0]])},H=function(t,e,n,r,i,o){var a=o.interpolate(e,n,o.minV,o.maxV),s=o.interpolate(e,i,o.minV,o.maxV),u=o.interpolate(i,r,o.minV,o.maxV),c=o.interpolate(n,r,o.minV,o.maxV);o.polygons_full&&(t.edges.br={path:[[a,0],[0,s]],move:{x:-1,y:0,enter:"rt"}},t.edges.tl={path:[[u,1],[1,c]],move:{x:1,y:0,enter:"lb"}}),o.polygons&&t.polygons.push([[a,0],[0,s],[0,1],[u,1],[1,c],[1,0]])},Y=function(t,e,n,r,i,o){var a=o.interpolate_a(e,n,o.minV,o.maxV),s=o.interpolate_b(e,n,o.minV,o.maxV),u=o.interpolate_a(e,i,o.minV,o.maxV),c=o.interpolate_b(e,i,o.minV,o.maxV),l=o.interpolate(i,r,o.minV,o.maxV),f=o.interpolate(n,r,o.minV,o.maxV);o.polygons_full&&(t.edges.bl={path:[[a,0],[0,u]],move:{x:-1,y:0,enter:"rb"}},t.edges.lt={path:[[0,c],[l,1]],move:{x:0,y:1,enter:"br"}},t.edges.rt={path:[[1,f],[s,0]],move:{x:0,y:-1,enter:"tr"}}),o.polygons&&t.polygons.push([[a,0],[0,u],[0,c],[l,1],[1,1],[1,f],[s,0]])},Z=function(t,e,n,r,i,o){var a=o.interpolate(e,n,o.minV,o.maxV),s=o.interpolate(e,i,o.minV,o.maxV),u=o.interpolate_a(i,r,o.minV,o.maxV),c=o.interpolate_b(i,r,o.minV,o.maxV),l=o.interpolate_b(n,r,o.minV,o.maxV),f=o.interpolate_a(n,r,o.minV,o.maxV);o.polygons_full&&(t.edges.lb={path:[[0,s],[u,1]],move:{x:0,y:1,enter:"bl"}},t.edges.tr={path:[[c,1],[1,l]],move:{x:1,y:0,enter:"lt"}},t.edges.rb={path:[[1,f],[a,0]],move:{x:0,y:-1,enter:"tl"}}),o.polygons&&t.polygons.push([[0,0],[0,s],[u,1],[c,1],[1,l],[1,f],[a,0]])},K=function(t,e,n,r,i,o){var a=o.interpolate_a(e,n,o.minV,o.maxV),s=o.interpolate_b(e,n,o.minV,o.maxV),u=o.interpolate(e,i,o.minV,o.maxV),c=o.interpolate(i,r,o.minV,o.maxV),l=o.interpolate_b(n,r,o.minV,o.maxV),f=o.interpolate_a(n,r,o.minV,o.maxV);o.polygons_full&&(t.edges.bl={path:[[a,0],[0,u]],move:{x:-1,y:0,enter:"rt"}},t.edges.tl={path:[[c,1],[1,l]],move:{x:1,y:0,enter:"lt"}},t.edges.rb={path:[[1,f],[s,0]],move:{x:0,y:-1,enter:"tr"}}),o.polygons&&t.polygons.push([[a,0],[0,u],[0,1],[c,1],[1,l],[1,f],[s,0]])},J=function(t,e,n,r,i,o){var a=o.interpolate(e,n,o.minV,o.maxV),s=o.interpolate_a(e,i,o.minV,o.maxV),u=o.interpolate_b(e,i,o.minV,o.maxV),c=o.interpolate_a(i,r,o.minV,o.maxV),l=o.interpolate_b(i,r,o.minV,o.maxV),f=o.interpolate(n,r,o.minV,o.maxV);o.polygons_full&&(t.edges.br={path:[[a,0],[0,s]],move:{x:-1,y:0,enter:"rb"}},t.edges.lt={path:[[0,u],[c,1]],move:{x:0,y:1,enter:"bl"}},t.edges.tr={path:[[l,1],[1,f]],move:{x:1,y:0,enter:"lb"}}),o.polygons&&t.polygons.push([[a,0],[0,s],[0,u],[c,1],[l,1],[1,f],[1,0]])},Q=function(t,e,n,r,i,o){var a=o.interpolate_a(e,n,o.minV,o.maxV),s=o.interpolate_b(e,n,o.minV,o.maxV),u=o.interpolate_a(e,i,o.minV,o.maxV),c=o.interpolate_b(e,i,o.minV,o.maxV),l=o.interpolate_a(i,r,o.minV,o.maxV),f=o.interpolate_b(i,r,o.minV,o.maxV),h=o.interpolate_b(n,r,o.minV,o.maxV),d=o.interpolate_a(n,r,o.minV,o.maxV);o.polygons_full&&(t.edges.bl={path:[[a,0],[0,u]],move:{x:-1,y:0,enter:"rb"}},t.edges.lt={path:[[0,c],[l,1]],move:{x:0,y:1,enter:"bl"}},t.edges.tr={path:[[f,1],[1,h]],move:{x:1,y:0,enter:"lt"}},t.edges.rb={path:[[1,d],[s,0]],move:{x:0,y:-1,enter:"tr"}}),o.polygons&&t.polygons.push([[a,0],[0,u],[0,c],[l,1],[f,1],[1,h],[1,d],[s,0]])};function $(t,e,n,r){var f,d,p,g=!1,v=null,y=null,m=null,b=null,_=!1,x=[],w=[],E=[];if(!t)throw new Error("data is required");if(null==e)throw new Error("lowerBound is required");if(null==n)throw new Error("bandWidth is required");if(r&&"object"!=typeof r)throw new Error("options must be an object");if(p=function(t){var e,n,r,u,c;for(u=new s,t=t||{},c=Object.keys(u),e=0;e<c.length;e++)null!=(r=t[n=c[e]])&&(u[n]=r);return u.polygons_full=!u.polygons,u.interpolate=i,u.interpolate_a=o,u.interpolate_b=a,u}(r),t instanceof h)v=t,y=t.root,m=t.data,p.noQuadTree||(g=!0);else{if(!Array.isArray(t)||!Array.isArray(t[0]))throw new Error("input is neither array of arrays nor object retrieved from 'QuadTree()'");m=t}if(Array.isArray(e)){for(_=!0,p.noQuadTree||(g=!0),f=0;f<e.length;f++)if(isNaN(+e[f]))throw new Error("lowerBound["+f+"] is not a number");if(Array.isArray(n)){if(e.length!==n.length)throw new Error("lowerBound and bandWidth have unequal lengths");for(f=0;f<n.length;f++)if(isNaN(+n[f]))throw new Error("bandWidth["+f+"] is not a number")}else{if(isNaN(+n))throw new Error("bandWidth must be a number");for(x=[],f=0;f<e.length;f++)x.push(n);n=x}}else{if(isNaN(+e))throw new Error("lowerBound must be a number");if(e=[e],isNaN(+n))throw new Error("bandWidth must be a number");n=[n]}return g&&!y&&(v=new h(m),y=v.root,m=v.data),p.verbose&&(p.polygons?console.log("MarchingSquaresJS-isoBands: returning single polygons for each grid cell"):console.log("MarchingSquaresJS-isoBands: returning polygon paths for entire data grid"),_&&console.log("MarchingSquaresJS-isoBands: multiple bands requested, returning array of band polygons instead of polygons for a single band")),e.forEach((function(t,e){if(w=[],p.minV=t,p.maxV=t+n[e],p.verbose&&console.log("MarchingSquaresJS-isoBands: computing isobands for ["+t+":"+(t+n[e])+"]"),p.polygons)if(g)y.cellsInBand(p.minV,p.maxV,!0).forEach((function(t){w=w.concat(u(et(m,t.x,t.y,p),t.x,t.y,p))}));else for(d=0;d<m.length-1;++d)for(f=0;f<m[0].length-1;++f)w=w.concat(u(et(m,f,d,p),f,d,p));else{for(b=[],f=0;f<m[0].length-1;++f)b[f]=[];if(g)y.cellsInBand(p.minV,p.maxV,!1).forEach((function(t){b[t.x][t.y]=et(m,t.x,t.y,p)}));else for(f=0;f<m[0].length-1;++f)for(d=0;d<m.length-1;++d)b[f][d]=et(m,f,d,p);w=function(t,e,n){var r,i,o,a,s,u,f,h,d,p,g,v,y,m,b,_,x=[],w=t.length-1,E=t[0].length-1,S=[["rt","rb"],["br","bl"],["lb","lt"],["tl","tr"]],O=[0,-1,0,1],P=[-1,0,1,0],C=["bl","lb","lt","tl","tr","rt","rb","br"],M={bl:1,br:1,lb:2,lt:2,tl:3,tr:3,rt:0,rb:0};return function(t,e,n){var r,i,o,a,s;for(r=!0,i=t[0].length,o=t.length,s=0;s<o;s++)if(t[s][0]<e||t[s][0]>n||t[s][i-1]<e||t[s][i-1]>n){r=!1;break}if(r&&(t[o-1][0]<e||t[o-1][0]>n||t[o-1][i-1]<e||t[o-1][i-1]>n)&&(r=!1),r)for(a=0;a<i-1;a++)if(t[0][a]<e||t[0][a]>n||t[o-1][a]<e||t[o-1][a]>n){r=!1;break}return r}(t,n.minV,n.maxV)&&(n.linearRing?x.push([[0,0],[0,w],[E,w],[E,0],[0,0]]):x.push([[0,0],[0,w],[E,w],[E,0]])),e.forEach((function(t,I){t.forEach((function(t,A){for(r=null,o=0;o<8;o++)if(r=C[o],"object"==typeof t.edges[r]){for(i=[],a=t.edges[r],f=r,h=I,d=A,p=!1,g=[I+a.path[0][0],A+a.path[0][1]],i.push(g);!p&&"object"==typeof(v=e[h][d]).edges[f];)if(a=v.edges[f],delete v.edges[f],(b=a.path[1])[0]+=h,b[1]+=d,i.push(b),f=a.move.enter,h+=a.move.x,d+=a.move.y,void 0===e[h]||void 0===e[h][d]){if(y=0,m=0,h===E)h--,y=0;else if(h<0)h++,y=2;else if(d===w)d--,y=3;else{if(!(d<0))throw new Error("Left the grid somewhere in the interior!");d++,y=1}if(h===I&&d===A&&y===M[r]){p=!0,f=r;break}for(;;){if(_=!1,m>4)throw new Error("Direction change counter overflow! This should never happen!");if(void 0!==e[h]&&void 0!==e[h][d])for(v=e[h][d],s=0;s<S[y].length;s++)if(u=S[y][s],"object"==typeof v.edges[u]){a=v.edges[u],i.push(c(h,d,y,a.path)),f=u,_=!0;break}if(_)break;if(i.push(l(h,d,y)),d+=P[y],void 0!==e[h+=O[y]]&&void 0!==e[h][d]||(0===y&&d<0||1===y&&h<0||2===y&&d===w||3===y&&h===E)&&(h-=O[y],d-=P[y],y=(y+1)%4,m++),h===I&&d===A&&y===M[r]){p=!0,f=r;break}}}!n.linearRing||i[i.length-1][0]===g[0]&&i[i.length-1][1]===g[1]||i.push(g),x.push(i)}}))})),x}(m,b,p)}_?E.push(w):E=w,"function"==typeof p.successCallback&&p.successCallback(E,t,n[e])})),E}function tt(t,e,n,r,i,o){var a=(r+n+e+t)/4;return a>o?2:a<i?0:1}function et(t,e,n,r){var i,o,a=0,s=t[n+1][e],u=t[n+1][e+1],c=t[n][e+1],l=t[n][e],f=r.minV,h=r.maxV;if(!(isNaN(l)||isNaN(c)||isNaN(u)||isNaN(s))){switch(a|=s<f?0:s>h?128:64,a|=u<f?0:u>h?32:16,a|=c<f?0:c>h?8:4,o=0,i={cval:a=+(a|=l<f?0:l>h?2:1),polygons:[],edges:{},x0:l,x1:c,x2:u,x3:s,x:e,y:n},a){case 85:g(i,l,c,u,s,r);case 0:case 170:break;case 169:v(i,l,c,u,s,r);break;case 166:y(i,l,c,u,s,r);break;case 154:m(i,l,c,u,s,r);break;case 106:b(i,l,c,u,s,r);break;case 1:v(i,l,c,u,s,r);break;case 4:y(i,l,c,u,s,r);break;case 16:m(i,l,c,u,s,r);break;case 64:b(i,l,c,u,s,r);break;case 168:S(i,l,c,u,s,r);break;case 162:O(i,l,c,u,s,r);break;case 138:P(i,l,c,u,s,r);break;case 42:C(i,l,c,u,s,r);break;case 2:S(i,l,c,u,s,r);break;case 8:O(i,l,c,u,s,r);break;case 32:P(i,l,c,u,s,r);break;case 128:C(i,l,c,u,s,r);break;case 5:w(i,l,c,u,s,r);break;case 20:x(i,l,c,u,s,r);break;case 80:_(i,l,c,u,s,r);break;case 65:E(i,l,c,u,s,r);break;case 165:w(i,l,c,u,s,r);break;case 150:x(i,l,c,u,s,r);break;case 90:_(i,l,c,u,s,r);break;case 105:E(i,l,c,u,s,r);break;case 160:M(i,l,c,u,s,r);break;case 130:I(i,l,c,u,s,r);break;case 10:M(i,l,c,u,s,r);break;case 40:I(i,l,c,u,s,r);break;case 101:A(i,l,c,u,s,r);break;case 149:T(i,l,c,u,s,r);break;case 86:L(i,l,c,u,s,r);break;case 89:N(i,l,c,u,s,r);break;case 69:A(i,l,c,u,s,r);break;case 21:T(i,l,c,u,s,r);break;case 84:L(i,l,c,u,s,r);break;case 81:N(i,l,c,u,s,r);break;case 96:R(i,l,c,u,s,r);break;case 24:k(i,l,c,u,s,r);break;case 6:j(i,l,c,u,s,r);break;case 129:F(i,l,c,u,s,r);break;case 74:R(i,l,c,u,s,r);break;case 146:k(i,l,c,u,s,r);break;case 164:j(i,l,c,u,s,r);break;case 41:F(i,l,c,u,s,r);break;case 66:D(i,l,c,u,s,r);break;case 144:B(i,l,c,u,s,r);break;case 36:z(i,l,c,u,s,r);break;case 9:V(i,l,c,u,s,r);break;case 104:D(i,l,c,u,s,r);break;case 26:B(i,l,c,u,s,r);break;case 134:z(i,l,c,u,s,r);break;case 161:V(i,l,c,u,s,r);break;case 37:G(i,l,c,u,s,r);break;case 148:U(i,l,c,u,s,r);break;case 82:W(i,l,c,u,s,r);break;case 73:q(i,l,c,u,s,r);break;case 133:G(i,l,c,u,s,r);break;case 22:U(i,l,c,u,s,r);break;case 88:W(i,l,c,u,s,r);break;case 97:q(i,l,c,u,s,r);break;case 145:case 25:X(i,l,c,u,s,r);break;case 70:case 100:H(i,l,c,u,s,r);break;case 17:0===(o=tt(l,c,u,s,f,h))?(v(i,l,c,u,s,r),m(i,l,c,u,s,r)):X(i,l,c,u,s,r);break;case 68:0===(o=tt(l,c,u,s,f,h))?(b(i,l,c,u,s,r),y(i,l,c,u,s,r)):H(i,l,c,u,s,r);break;case 153:2===(o=tt(l,c,u,s,f,h))?(v(i,l,c,u,s,r),m(i,l,c,u,s,r)):X(i,l,c,u,s,r);break;case 102:2===(o=tt(l,c,u,s,f,h))?(b(i,l,c,u,s,r),y(i,l,c,u,s,r)):H(i,l,c,u,s,r);break;case 152:2===(o=tt(l,c,u,s,f,h))?(m(i,l,c,u,s,r),S(i,l,c,u,s,r)):Y(i,l,c,u,s,r);break;case 137:2===(o=tt(l,c,u,s,f,h))?(v(i,l,c,u,s,r),P(i,l,c,u,s,r)):Z(i,l,c,u,s,r);break;case 98:2===(o=tt(l,c,u,s,f,h))?(b(i,l,c,u,s,r),O(i,l,c,u,s,r)):K(i,l,c,u,s,r);break;case 38:2===(o=tt(l,c,u,s,f,h))?(y(i,l,c,u,s,r),C(i,l,c,u,s,r)):J(i,l,c,u,s,r);break;case 18:0===(o=tt(l,c,u,s,f,h))?(m(i,l,c,u,s,r),S(i,l,c,u,s,r)):Y(i,l,c,u,s,r);break;case 33:0===(o=tt(l,c,u,s,f,h))?(v(i,l,c,u,s,r),P(i,l,c,u,s,r)):Z(i,l,c,u,s,r);break;case 72:0===(o=tt(l,c,u,s,f,h))?(b(i,l,c,u,s,r),O(i,l,c,u,s,r)):K(i,l,c,u,s,r);break;case 132:0===(o=tt(l,c,u,s,f,h))?(y(i,l,c,u,s,r),C(i,l,c,u,s,r)):J(i,l,c,u,s,r);break;case 136:0===(o=tt(l,c,u,s,f,h))?(C(i,l,c,u,s,r),O(i,l,c,u,s,r)):1===o?Q(i,l,c,u,s,r):(S(i,l,c,u,s,r),P(i,l,c,u,s,r));break;case 34:0===(o=tt(l,c,u,s,f,h))?(S(i,l,c,u,s,r),P(i,l,c,u,s,r)):1===o?Q(i,l,c,u,s,r):(C(i,l,c,u,s,r),O(i,l,c,u,s,r))}return i}}},function(t,e){function n(t){var e=t[0],n=t[1];return[n[0]-e[0],n[1]-e[1]]}function r(t,e){return t[0]*e[1]-e[0]*t[1]}t.exports=function(t,e){return!function(t,e){return 0===r(n(t),n(e))}(t,e)&&function(t,e){var i,o,a=t[0],s=n(t),u=e[0],c=n(e),l=r(s,c);return function(t,e){return[t[0]+e[0],t[1]+e[1]]}(a,function(t,e){return[t*e[0],t*e[1]]}(r((o=a,[(i=u)[0]-o[0],i[1]-o[1]]),c)/l,s))}(t,e)}},function(t,e,n){"use strict";var r=n(472),i=n(269),o=n(11).featureCollection;t.exports=function(t){var e=r.fromGeoJson(t);e.deleteDangles(),e.deleteCutEdges();var n=[],a=[];return e.getEdgeRings().filter((function(t){return t.isValid()})).forEach((function(t){t.isHole()?n.push(t):a.push(t)})),n.forEach((function(t){i.findEdgeRingContaining(t,a)&&a.push(t)})),o(a.map((function(t){return t.toPolygon()})))}},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=n(473),o=n(474),a=n(269),s=n(15),u=s.flattenEach,c=s.coordReduce,l=n(16).featureOf;var f=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.edges=[],this.nodes={}}return r(t,[{key:"getNode",value:function(t){var e=i.buildId(t),n=this.nodes[e];return n||(n=this.nodes[e]=new i(t)),n}},{key:"addEdge",value:function(t,e){var n=new o(t,e),r=n.getSymetric();this.edges.push(n),this.edges.push(r)}}],[{key:"fromGeoJson",value:function(e){!function(t){if(!t)throw new Error("No geojson passed");if("FeatureCollection"!==t.type&&"GeometryCollection"!==t.type&&"MultiLineString"!==t.type&&"LineString"!==t.type&&"Feature"!==t.type)throw new Error("Invalid input type '"+t.type+"'. Geojson must be FeatureCollection, GeometryCollection, LineString, MultiLineString or Feature")}(e);var n=new t;return u(e,(function(t){l(t,"LineString","Graph::fromGeoJson"),c(t,(function(t,e){if(t){var r=n.getNode(t),i=n.getNode(e);n.addEdge(r,i)}return e}))})),n}}]),r(t,[{key:"deleteDangles",value:function(){var t=this;Object.keys(this.nodes).map((function(e){return t.nodes[e]})).forEach((function(e){return t._removeIfDangle(e)}))}},{key:"_removeIfDangle",value:function(t){var e=this;if(t.innerEdges.length<=1){var n=t.getOuterEdges().map((function(t){return t.to}));this.removeNode(t),n.forEach((function(t){return e._removeIfDangle(t)}))}}},{key:"deleteCutEdges",value:function(){var t=this;this._computeNextCWEdges(),this._findLabeledEdgeRings(),this.edges.forEach((function(e){e.label===e.symetric.label&&(t.removeEdge(e.symetric),t.removeEdge(e))}))}},{key:"_computeNextCWEdges",value:function(t){var e=this;void 0===t?Object.keys(this.nodes).forEach((function(t){return e._computeNextCWEdges(e.nodes[t])})):t.getOuterEdges().forEach((function(e,n){t.getOuterEdge((0===n?t.getOuterEdges().length:n)-1).symetric.next=e}))}},{key:"_computeNextCCWEdges",value:function(t,e){for(var n=t.getOuterEdges(),r=void 0,i=void 0,o=n.length-1;o>=0;--o){var a=n[o],s=a.symetric,u=void 0,c=void 0;a.label===e&&(u=a),s.label===e&&(c=s),u&&c&&(c&&(i=c),u&&(i&&(i.next=u,i=void 0),r||(r=u)))}i&&(i.next=r)}},{key:"_findLabeledEdgeRings",value:function(){var t=[],e=0;return this.edges.forEach((function(n){if(!(n.label>=0)){t.push(n);var r=n;do{r.label=e,r=r.next}while(!n.isEqual(r));e++}})),t}},{key:"getEdgeRings",value:function(){var t=this;this._computeNextCWEdges(),this.edges.forEach((function(t){t.label=void 0})),this._findLabeledEdgeRings().forEach((function(e){t._findIntersectionNodes(e).forEach((function(n){t._computeNextCCWEdges(n,e.label)}))}));var e=[];return this.edges.forEach((function(n){n.ring||e.push(t._findEdgeRing(n))})),e}},{key:"_findIntersectionNodes",value:function(t){var e=[],n=t,r=function(){var r=0;n.from.getOuterEdges().forEach((function(e){e.label===t.label&&++r})),r>1&&e.push(n.from),n=n.next};do{r()}while(!t.isEqual(n));return e}},{key:"_findEdgeRing",value:function(t){var e=t,n=new a;do{n.push(e),e.ring=n,e=e.next}while(!t.isEqual(e));return n}},{key:"removeNode",value:function(t){var e=this;t.getOuterEdges().forEach((function(t){return e.removeEdge(t)})),t.innerEdges.forEach((function(t){return e.removeEdge(t)})),delete this.nodes[t.id]}},{key:"removeEdge",value:function(t){this.edges=this.edges.filter((function(e){return!e.isEqual(t)})),t.deleteEdge()}}]),t}();t.exports=f},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=n(177).orientationIndex,o=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=t.buildId(e),this.coordinates=e,this.innerEdges=[],this.outerEdges=[],this.outerEdgesSorted=!1}return r(t,null,[{key:"buildId",value:function(t){return t.join(",")}}]),r(t,[{key:"removeInnerEdge",value:function(t){this.innerEdges=this.innerEdges.filter((function(e){return e.from.id!==t.from.id}))}},{key:"removeOuterEdge",value:function(t){this.outerEdges=this.outerEdges.filter((function(e){return e.to.id!==t.to.id}))}},{key:"addOuterEdge",value:function(t){this.outerEdges.push(t),this.outerEdgesSorted=!1}},{key:"sortOuterEdges",value:function(){var t=this;this.outerEdgesSorted||(this.outerEdges.sort((function(e,n){var r=e.to,o=n.to;if(r.coordinates[0]-t.coordinates[0]>=0&&o.coordinates[0]-t.coordinates[0]<0)return 1;if(r.coordinates[0]-t.coordinates[0]<0&&o.coordinates[0]-t.coordinates[0]>=0)return-1;if(r.coordinates[0]-t.coordinates[0]==0&&o.coordinates[0]-t.coordinates[0]==0)return r.coordinates[1]-t.coordinates[1]>=0||o.coordinates[1]-t.coordinates[1]>=0?r.coordinates[1]-o.coordinates[1]:o.coordinates[1]-r.coordinates[1];var a=i(t.coordinates,r.coordinates,o.coordinates);return a<0?1:a>0?-1:Math.pow(r.coordinates[0]-t.coordinates[0],2)+Math.pow(r.coordinates[1]-t.coordinates[1],2)-(Math.pow(o.coordinates[0]-t.coordinates[0],2)+Math.pow(o.coordinates[1]-t.coordinates[1],2))})),this.outerEdgesSorted=!0)}},{key:"getOuterEdges",value:function(){return this.sortOuterEdges(),this.outerEdges}},{key:"getOuterEdge",value:function(t){return this.sortOuterEdges(),this.outerEdges[t]}},{key:"addInnerEdge",value:function(t){this.innerEdges.push(t)}}]),t}();t.exports=o},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var i=n(11).lineString,o=n(177).orientationIndex,a=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.from=e,this.to=n,this.next=void 0,this.label=void 0,this.symetric=void 0,this.ring=void 0,this.from.addOuterEdge(this),this.to.addInnerEdge(this)}return r(t,[{key:"getSymetric",value:function(){return this.symetric||(this.symetric=new t(this.to,this.from),this.symetric.symetric=this),this.symetric}}]),r(t,[{key:"deleteEdge",value:function(){this.from.removeOuterEdge(this),this.to.removeInnerEdge(this)}},{key:"isEqual",value:function(t){return this.from.id===t.from.id&&this.to.id===t.to.id}},{key:"toString",value:function(){return"Edge { "+this.from.id+" -> "+this.to.id+" }"}},{key:"toLineString",value:function(){return i([this.from.coordinates,this.to.coordinates])}},{key:"compareTo",value:function(t){return o(t.from.coordinates,t.to.coordinates,this.to.coordinates)}}]),t}();t.exports=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(476),o=(r=i)&&r.__esModule?r:{default:r},a=n(550),s=n(42);e.default={coorToMeterOffset:function(t){var e=t.data,n=t.coordinateOrigin,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Math.pow(2,22),i={type:"FeatureCollection",features:[]};if(!e||e.features&&0===e.features.length)return i;var s=(0,a.projectFlat)(n,r);return i.features=e.features.map((function(t){var e=(0,o.default)(t);return e.geometry.coordinates=e.geometry.coordinates.map((function(t){var e=(0,a.projectFlat)(t,r),n=[s[0]-e[0],s[1]-e[1]],i=(0,a.getDistanceScales)({latitude:t[1],longitude:t[0],scale:r,highPrecision:!0}).metersPerPixel;return[-n[0]*i[0],n[1]*i[1]]})),e})),i},COORDINATE_SYSTEM:s.COORDINATE_SYSTEM}},function(t,e,n){var r=n(477);t.exports=function(t){return r(t,5)}},function(t,e,n){var r=n(478),i=n(508),o=n(280),a=n(510),s=n(520),u=n(523),c=n(524),l=n(525),f=n(527),h=n(528),d=n(529),p=n(186),g=n(534),v=n(535),y=n(541),m=n(181),b=n(283),_=n(543),x=n(100),w=n(545),E=n(180),S={};S["[object Arguments]"]=S["[object Array]"]=S["[object ArrayBuffer]"]=S["[object DataView]"]=S["[object Boolean]"]=S["[object Date]"]=S["[object Float32Array]"]=S["[object Float64Array]"]=S["[object Int8Array]"]=S["[object Int16Array]"]=S["[object Int32Array]"]=S["[object Map]"]=S["[object Number]"]=S["[object Object]"]=S["[object RegExp]"]=S["[object Set]"]=S["[object String]"]=S["[object Symbol]"]=S["[object Uint8Array]"]=S["[object Uint8ClampedArray]"]=S["[object Uint16Array]"]=S["[object Uint32Array]"]=!0,S["[object Error]"]=S["[object Function]"]=S["[object WeakMap]"]=!1,t.exports=function t(e,n,O,P,C,M){var I,A=1&n,T=2&n,N=4&n;if(O&&(I=C?O(e,P,C,M):O(e)),void 0!==I)return I;if(!x(e))return e;var L=m(e);if(L){if(I=g(e),!A)return c(e,I)}else{var R=p(e),k="[object Function]"==R||"[object GeneratorFunction]"==R;if(b(e))return u(e,A);if("[object Object]"==R||"[object Arguments]"==R||k&&!C){if(I=T||k?{}:y(e),!A)return T?f(e,s(I,e)):l(e,a(I,e))}else{if(!S[R])return C?e:{};I=v(e,R,A)}}M||(M=new r);var j=M.get(e);if(j)return j;M.set(e,I),w(e)?e.forEach((function(r){I.add(t(r,n,O,r,e,M))})):_(e)&&e.forEach((function(r,i){I.set(i,t(r,n,O,i,e,M))}));var F=N?T?d:h:T?keysIn:E,D=L?void 0:F(e);return i(D||e,(function(r,i){D&&(r=e[i=r]),o(I,i,t(r,n,O,i,e,M))})),I}},function(t,e,n){var r=n(127),i=n(484),o=n(485),a=n(486),s=n(487),u=n(488);function c(t){var e=this.__data__=new r(t);this.size=e.size}c.prototype.clear=i,c.prototype.delete=o,c.prototype.get=a,c.prototype.has=s,c.prototype.set=u,t.exports=c},function(t,e){t.exports=function(){this.__data__=[],this.size=0}},function(t,e,n){var r=n(128),i=Array.prototype.splice;t.exports=function(t){var e=this.__data__,n=r(e,t);return!(n<0)&&(n==e.length-1?e.pop():i.call(e,n,1),--this.size,!0)}},function(t,e,n){var r=n(128);t.exports=function(t){var e=this.__data__,n=r(e,t);return n<0?void 0:e[n][1]}},function(t,e,n){var r=n(128);t.exports=function(t){return r(this.__data__,t)>-1}},function(t,e,n){var r=n(128);t.exports=function(t,e){var n=this.__data__,i=r(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this}},function(t,e,n){var r=n(127);t.exports=function(){this.__data__=new r,this.size=0}},function(t,e){t.exports=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}},function(t,e){t.exports=function(t){return this.__data__.get(t)}},function(t,e){t.exports=function(t){return this.__data__.has(t)}},function(t,e,n){var r=n(127),i=n(178),o=n(495);t.exports=function(t,e){var n=this.__data__;if(n instanceof r){var a=n.__data__;if(!i||a.length<199)return a.push([t,e]),this.size=++n.size,this;n=this.__data__=new o(a)}return n.set(t,e),this.size=n.size,this}},function(t,e,n){var r=n(277),i=n(492),o=n(100),a=n(279),s=/^\[object .+?Constructor\]$/,u=Function.prototype,c=Object.prototype,l=u.toString,f=c.hasOwnProperty,h=RegExp("^"+l.call(f).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t){return!(!o(t)||i(t))&&(r(t)?h:s).test(a(t))}},function(t,e,n){var r=n(179),i=Object.prototype,o=i.hasOwnProperty,a=i.toString,s=r?r.toStringTag:void 0;t.exports=function(t){var e=o.call(t,s),n=t[s];try{t[s]=void 0;var r=!0}catch(t){}var i=a.call(t);return r&&(e?t[s]=n:delete t[s]),i}},function(t,e){var n=Object.prototype.toString;t.exports=function(t){return n.call(t)}},function(t,e,n){var r,i=n(493),o=(r=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";t.exports=function(t){return!!o&&o in t}},function(t,e,n){var r=n(56)["__core-js_shared__"];t.exports=r},function(t,e){t.exports=function(t,e){return null==t?void 0:t[e]}},function(t,e,n){var r=n(496),i=n(503),o=n(505),a=n(506),s=n(507);function u(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=i,u.prototype.get=o,u.prototype.has=a,u.prototype.set=s,t.exports=u},function(t,e,n){var r=n(497),i=n(127),o=n(178);t.exports=function(){this.size=0,this.__data__={hash:new r,map:new(o||i),string:new r}}},function(t,e,n){var r=n(498),i=n(499),o=n(500),a=n(501),s=n(502);function u(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=i,u.prototype.get=o,u.prototype.has=a,u.prototype.set=s,t.exports=u},function(t,e,n){var r=n(130);t.exports=function(){this.__data__=r?r(null):{},this.size=0}},function(t,e){t.exports=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}},function(t,e,n){var r=n(130),i=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;if(r){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return i.call(e,t)?e[t]:void 0}},function(t,e,n){var r=n(130),i=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;return r?void 0!==e[t]:i.call(e,t)}},function(t,e,n){var r=n(130);t.exports=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=r&&void 0===e?"__lodash_hash_undefined__":e,this}},function(t,e,n){var r=n(131);t.exports=function(t){var e=r(this,t).delete(t);return this.size-=e?1:0,e}},function(t,e){t.exports=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}},function(t,e,n){var r=n(131);t.exports=function(t){return r(this,t).get(t)}},function(t,e,n){var r=n(131);t.exports=function(t){return r(this,t).has(t)}},function(t,e,n){var r=n(131);t.exports=function(t,e){var n=r(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this}},function(t,e){t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););return t}},function(t,e,n){var r=n(74),i=function(){try{var t=r(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();t.exports=i},function(t,e,n){var r=n(132),i=n(180);t.exports=function(t,e){return t&&r(e,i(e),t)}},function(t,e){t.exports=function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}},function(t,e,n){var r=n(513),i=n(101),o=Object.prototype,a=o.hasOwnProperty,s=o.propertyIsEnumerable,u=r(function(){return arguments}())?r:function(t){return i(t)&&a.call(t,"callee")&&!s.call(t,"callee")};t.exports=u},function(t,e,n){var r=n(129),i=n(101);t.exports=function(t){return i(t)&&"[object Arguments]"==r(t)}},function(t,e){t.exports=function(){return!1}},function(t,e){var n=/^(?:0|[1-9]\d*)$/;t.exports=function(t,e){var r=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==r||"symbol"!=r&&n.test(t))&&t>-1&&t%1==0&&t<e}},function(t,e,n){var r=n(517),i=n(182),o=n(183),a=o&&o.isTypedArray,s=a?i(a):r;t.exports=s},function(t,e,n){var r=n(129),i=n(284),o=n(101),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1,t.exports=function(t){return o(t)&&i(t.length)&&!!a[r(t)]}},function(t,e,n){var r=n(184),i=n(519),o=Object.prototype.hasOwnProperty;t.exports=function(t){if(!r(t))return i(t);var e=[];for(var n in Object(t))o.call(t,n)&&"constructor"!=n&&e.push(n);return e}},function(t,e,n){var r=n(285)(Object.keys,Object);t.exports=r},function(t,e,n){var r=n(132),i=n(287);t.exports=function(t,e){return t&&r(e,i(e),t)}},function(t,e,n){var r=n(100),i=n(184),o=n(522),a=Object.prototype.hasOwnProperty;t.exports=function(t){if(!r(t))return o(t);var e=i(t),n=[];for(var s in t)("constructor"!=s||!e&&a.call(t,s))&&n.push(s);return n}},function(t,e){t.exports=function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}},function(t,e,n){(function(t){var r=n(56),i=e&&!e.nodeType&&e,o=i&&"object"==typeof t&&t&&!t.nodeType&&t,a=o&&o.exports===i?r.Buffer:void 0,s=a?a.allocUnsafe:void 0;t.exports=function(t,e){if(e)return t.slice();var n=t.length,r=s?s(n):new t.constructor(n);return t.copy(r),r}}).call(this,n(116)(t))},function(t,e){t.exports=function(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e}},function(t,e,n){var r=n(132),i=n(185);t.exports=function(t,e){return r(t,i(t),e)}},function(t,e){t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length,i=0,o=[];++n<r;){var a=t[n];e(a,n,t)&&(o[i++]=a)}return o}},function(t,e,n){var r=n(132),i=n(289);t.exports=function(t,e){return r(t,i(t),e)}},function(t,e,n){var r=n(292),i=n(185),o=n(180);t.exports=function(t){return r(t,o,i)}},function(t,e,n){var r=n(292),i=n(289),o=n(287);t.exports=function(t){return r(t,o,i)}},function(t,e,n){var r=n(74)(n(56),"DataView");t.exports=r},function(t,e,n){var r=n(74)(n(56),"Promise");t.exports=r},function(t,e,n){var r=n(74)(n(56),"Set");t.exports=r},function(t,e,n){var r=n(74)(n(56),"WeakMap");t.exports=r},function(t,e){var n=Object.prototype.hasOwnProperty;t.exports=function(t){var e=t.length,r=new t.constructor(e);return e&&"string"==typeof t[0]&&n.call(t,"index")&&(r.index=t.index,r.input=t.input),r}},function(t,e,n){var r=n(187),i=n(537),o=n(538),a=n(539),s=n(540);t.exports=function(t,e,n){var u=t.constructor;switch(e){case"[object ArrayBuffer]":return r(t);case"[object Boolean]":case"[object Date]":return new u(+t);case"[object DataView]":return i(t,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return s(t,n);case"[object Map]":return new u;case"[object Number]":case"[object String]":return new u(t);case"[object RegExp]":return o(t);case"[object Set]":return new u;case"[object Symbol]":return a(t)}}},function(t,e,n){var r=n(56).Uint8Array;t.exports=r},function(t,e,n){var r=n(187);t.exports=function(t,e){var n=e?r(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}},function(t,e){var n=/\w*$/;t.exports=function(t){var e=new t.constructor(t.source,n.exec(t));return e.lastIndex=t.lastIndex,e}},function(t,e,n){var r=n(179),i=r?r.prototype:void 0,o=i?i.valueOf:void 0;t.exports=function(t){return o?Object(o.call(t)):{}}},function(t,e,n){var r=n(187);t.exports=function(t,e){var n=e?r(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}},function(t,e,n){var r=n(542),i=n(291),o=n(184);t.exports=function(t){return"function"!=typeof t.constructor||o(t)?{}:r(i(t))}},function(t,e,n){var r=n(100),i=Object.create,o=function(){function t(){}return function(e){if(!r(e))return{};if(i)return i(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();t.exports=o},function(t,e,n){var r=n(544),i=n(182),o=n(183),a=o&&o.isMap,s=a?i(a):r;t.exports=s},function(t,e,n){var r=n(186),i=n(101);t.exports=function(t){return i(t)&&"[object Map]"==r(t)}},function(t,e,n){var r=n(546),i=n(182),o=n(183),a=o&&o.isSet,s=a?i(a):r;t.exports=s},function(t,e,n){var r=n(186),i=n(101);t.exports=function(t){return i(t)&&"[object Set]"==r(t)}},function(t,e,n){"use strict";n.r(e),n.d(e,"geoArea",(function(){return Y})),n.d(e,"geoBounds",(function(){return zt})),n.d(e,"geoCentroid",(function(){return Qt})),n.d(e,"geoCircle",(function(){return ce})),n.d(e,"geoClipAntimeridian",(function(){return Ce})),n.d(e,"geoClipCircle",(function(){return Me})),n.d(e,"geoClipExtent",(function(){return Le})),n.d(e,"geoClipRectangle",(function(){return Ie})),n.d(e,"geoContains",(function(){return Je})),n.d(e,"geoDistance",(function(){return Ge})),n.d(e,"geoGraticule",(function(){return tn})),n.d(e,"geoGraticule10",(function(){return en})),n.d(e,"geoInterpolate",(function(){return sn})),n.d(e,"geoLength",(function(){return Be})),n.d(e,"geoPath",(function(){return or})),n.d(e,"geoAlbers",(function(){return Sr})),n.d(e,"geoAlbersUsa",(function(){return Or})),n.d(e,"geoAzimuthalEqualArea",(function(){return Ir})),n.d(e,"geoAzimuthalEqualAreaRaw",(function(){return Mr})),n.d(e,"geoAzimuthalEquidistant",(function(){return Tr})),n.d(e,"geoAzimuthalEquidistantRaw",(function(){return Ar})),n.d(e,"geoConicConformal",(function(){return Fr})),n.d(e,"geoConicConformalRaw",(function(){return jr})),n.d(e,"geoConicEqualArea",(function(){return Er})),n.d(e,"geoConicEqualAreaRaw",(function(){return wr})),n.d(e,"geoConicEquidistant",(function(){return Vr})),n.d(e,"geoConicEquidistantRaw",(function(){return zr})),n.d(e,"geoEqualEarth",(function(){return Yr})),n.d(e,"geoEqualEarthRaw",(function(){return Hr})),n.d(e,"geoEquirectangular",(function(){return Br})),n.d(e,"geoEquirectangularRaw",(function(){return Dr})),n.d(e,"geoGnomonic",(function(){return Kr})),n.d(e,"geoGnomonicRaw",(function(){return Zr})),n.d(e,"geoIdentity",(function(){return Jr})),n.d(e,"geoProjection",(function(){return br})),n.d(e,"geoProjectionMutator",(function(){return _r})),n.d(e,"geoMercator",(function(){return Lr})),n.d(e,"geoMercatorRaw",(function(){return Nr})),n.d(e,"geoNaturalEarth1",(function(){return $r})),n.d(e,"geoNaturalEarth1Raw",(function(){return Qr})),n.d(e,"geoOrthographic",(function(){return ei})),n.d(e,"geoOrthographicRaw",(function(){return ti})),n.d(e,"geoStereographic",(function(){return ri})),n.d(e,"geoStereographicRaw",(function(){return ni})),n.d(e,"geoTransverseMercator",(function(){return oi})),n.d(e,"geoTransverseMercatorRaw",(function(){return ii})),n.d(e,"geoRotation",(function(){return ae})),n.d(e,"geoStream",(function(){return z})),n.d(e,"geoTransform",(function(){return ar}));var r=function(){return new i};function i(){this.reset()}i.prototype={constructor:i,reset:function(){this.s=this.t=0},add:function(t){a(o,t,this.t),a(this,o.s,this.s),this.s?this.t+=o.t:this.s=o.t},valueOf:function(){return this.s}};var o=new i;function a(t,e,n){var r=t.s=e+n,i=r-e,o=r-i;t.t=e-o+(n-i)}var s=1e-6,u=Math.PI,c=u/2,l=u/4,f=2*u,h=180/u,d=u/180,p=Math.abs,g=Math.atan,v=Math.atan2,y=Math.cos,m=Math.ceil,b=Math.exp,_=(Math.floor,Math.log),x=Math.pow,w=Math.sin,E=Math.sign||function(t){return t>0?1:t<0?-1:0},S=Math.sqrt,O=Math.tan;function P(t){return t>1?0:t<-1?u:Math.acos(t)}function C(t){return t>1?c:t<-1?-c:Math.asin(t)}function M(t){return(t=w(t/2))*t}function I(){}function A(t,e){t&&N.hasOwnProperty(t.type)&&N[t.type](t,e)}var T={Feature:function(t,e){A(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)A(n[r].geometry,e)}},N={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){L(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)L(n[r],e,0)},Polygon:function(t,e){R(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)R(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)A(n[r],e)}};function L(t,e,n){var r,i=-1,o=t.length-n;for(e.lineStart();++i<o;)r=t[i],e.point(r[0],r[1],r[2]);e.lineEnd()}function R(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)L(t[n],e,1);e.polygonEnd()}var k,j,F,D,B,z=function(t,e){t&&T.hasOwnProperty(t.type)?T[t.type](t,e):A(t,e)},V=r(),G=r(),U={point:I,lineStart:I,lineEnd:I,polygonStart:function(){V.reset(),U.lineStart=W,U.lineEnd=q},polygonEnd:function(){var t=+V;G.add(t<0?f+t:t),this.lineStart=this.lineEnd=this.point=I},sphere:function(){G.add(f)}};function W(){U.point=X}function q(){H(k,j)}function X(t,e){U.point=H,k=t,j=e,F=t*=d,D=y(e=(e*=d)/2+l),B=w(e)}function H(t,e){var n=(t*=d)-F,r=n>=0?1:-1,i=r*n,o=y(e=(e*=d)/2+l),a=w(e),s=B*a,u=D*o+s*y(i),c=s*r*w(i);V.add(v(c,u)),F=t,D=o,B=a}var Y=function(t){return G.reset(),z(t,U),2*G};function Z(t){return[v(t[1],t[0]),C(t[2])]}function K(t){var e=t[0],n=t[1],r=y(n);return[r*y(e),r*w(e),w(n)]}function J(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Q(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function $(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function tt(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function et(t){var e=S(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}var nt,rt,it,ot,at,st,ut,ct,lt,ft,ht=r(),dt={point:pt,lineStart:vt,lineEnd:yt,polygonStart:function(){dt.point=mt,dt.lineStart=bt,dt.lineEnd=_t,ht.reset(),U.polygonStart()},polygonEnd:function(){U.polygonEnd(),dt.point=pt,dt.lineStart=vt,dt.lineEnd=yt,V<0?(nt=-(it=180),rt=-(ot=90)):ht>s?ot=90:ht<-s&&(rt=-90),ft[0]=nt,ft[1]=it},sphere:function(){nt=-(it=180),rt=-(ot=90)}};function pt(t,e){lt.push(ft=[nt=t,it=t]),e<rt&&(rt=e),e>ot&&(ot=e)}function gt(t,e){var n=K([t*d,e*d]);if(ct){var r=Q(ct,n),i=Q([r[1],-r[0],0],r);et(i),i=Z(i);var o,a=t-at,s=a>0?1:-1,u=i[0]*h*s,c=p(a)>180;c^(s*at<u&&u<s*t)?(o=i[1]*h)>ot&&(ot=o):c^(s*at<(u=(u+360)%360-180)&&u<s*t)?(o=-i[1]*h)<rt&&(rt=o):(e<rt&&(rt=e),e>ot&&(ot=e)),c?t<at?xt(nt,t)>xt(nt,it)&&(it=t):xt(t,it)>xt(nt,it)&&(nt=t):it>=nt?(t<nt&&(nt=t),t>it&&(it=t)):t>at?xt(nt,t)>xt(nt,it)&&(it=t):xt(t,it)>xt(nt,it)&&(nt=t)}else lt.push(ft=[nt=t,it=t]);e<rt&&(rt=e),e>ot&&(ot=e),ct=n,at=t}function vt(){dt.point=gt}function yt(){ft[0]=nt,ft[1]=it,dt.point=pt,ct=null}function mt(t,e){if(ct){var n=t-at;ht.add(p(n)>180?n+(n>0?360:-360):n)}else st=t,ut=e;U.point(t,e),gt(t,e)}function bt(){U.lineStart()}function _t(){mt(st,ut),U.lineEnd(),p(ht)>s&&(nt=-(it=180)),ft[0]=nt,ft[1]=it,ct=null}function xt(t,e){return(e-=t)<0?e+360:e}function wt(t,e){return t[0]-e[0]}function Et(t,e){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}var St,Ot,Pt,Ct,Mt,It,At,Tt,Nt,Lt,Rt,kt,jt,Ft,Dt,Bt,zt=function(t){var e,n,r,i,o,a,s;if(ot=it=-(nt=rt=1/0),lt=[],z(t,dt),n=lt.length){for(lt.sort(wt),e=1,o=[r=lt[0]];e<n;++e)Et(r,(i=lt[e])[0])||Et(r,i[1])?(xt(r[0],i[1])>xt(r[0],r[1])&&(r[1]=i[1]),xt(i[0],r[1])>xt(r[0],r[1])&&(r[0]=i[0])):o.push(r=i);for(a=-1/0,e=0,r=o[n=o.length-1];e<=n;r=i,++e)i=o[e],(s=xt(r[1],i[0]))>a&&(a=s,nt=i[0],it=r[1])}return lt=ft=null,nt===1/0||rt===1/0?[[NaN,NaN],[NaN,NaN]]:[[nt,rt],[it,ot]]},Vt={sphere:I,point:Gt,lineStart:Wt,lineEnd:Ht,polygonStart:function(){Vt.lineStart=Yt,Vt.lineEnd=Zt},polygonEnd:function(){Vt.lineStart=Wt,Vt.lineEnd=Ht}};function Gt(t,e){t*=d;var n=y(e*=d);Ut(n*y(t),n*w(t),w(e))}function Ut(t,e,n){++St,Pt+=(t-Pt)/St,Ct+=(e-Ct)/St,Mt+=(n-Mt)/St}function Wt(){Vt.point=qt}function qt(t,e){t*=d;var n=y(e*=d);Ft=n*y(t),Dt=n*w(t),Bt=w(e),Vt.point=Xt,Ut(Ft,Dt,Bt)}function Xt(t,e){t*=d;var n=y(e*=d),r=n*y(t),i=n*w(t),o=w(e),a=v(S((a=Dt*o-Bt*i)*a+(a=Bt*r-Ft*o)*a+(a=Ft*i-Dt*r)*a),Ft*r+Dt*i+Bt*o);Ot+=a,It+=a*(Ft+(Ft=r)),At+=a*(Dt+(Dt=i)),Tt+=a*(Bt+(Bt=o)),Ut(Ft,Dt,Bt)}function Ht(){Vt.point=Gt}function Yt(){Vt.point=Kt}function Zt(){Jt(kt,jt),Vt.point=Gt}function Kt(t,e){kt=t,jt=e,t*=d,e*=d,Vt.point=Jt;var n=y(e);Ft=n*y(t),Dt=n*w(t),Bt=w(e),Ut(Ft,Dt,Bt)}function Jt(t,e){t*=d;var n=y(e*=d),r=n*y(t),i=n*w(t),o=w(e),a=Dt*o-Bt*i,s=Bt*r-Ft*o,u=Ft*i-Dt*r,c=S(a*a+s*s+u*u),l=C(c),f=c&&-l/c;Nt+=f*a,Lt+=f*s,Rt+=f*u,Ot+=l,It+=l*(Ft+(Ft=r)),At+=l*(Dt+(Dt=i)),Tt+=l*(Bt+(Bt=o)),Ut(Ft,Dt,Bt)}var Qt=function(t){St=Ot=Pt=Ct=Mt=It=At=Tt=Nt=Lt=Rt=0,z(t,Vt);var e=Nt,n=Lt,r=Rt,i=e*e+n*n+r*r;return i<1e-12&&(e=It,n=At,r=Tt,Ot<s&&(e=Pt,n=Ct,r=Mt),(i=e*e+n*n+r*r)<1e-12)?[NaN,NaN]:[v(n,e)*h,C(r/S(i))*h]},$t=function(t){return function(){return t}},te=function(t,e){function n(n,r){return n=t(n,r),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,r){return(n=e.invert(n,r))&&t.invert(n[0],n[1])}),n};function ee(t,e){return[p(t)>u?t+Math.round(-t/f)*f:t,e]}function ne(t,e,n){return(t%=f)?e||n?te(ie(t),oe(e,n)):ie(t):e||n?oe(e,n):ee}function re(t){return function(e,n){return[(e+=t)>u?e-f:e<-u?e+f:e,n]}}function ie(t){var e=re(t);return e.invert=re(-t),e}function oe(t,e){var n=y(t),r=w(t),i=y(e),o=w(e);function a(t,e){var a=y(e),s=y(t)*a,u=w(t)*a,c=w(e),l=c*n+s*r;return[v(u*i-l*o,s*n-c*r),C(l*i+u*o)]}return a.invert=function(t,e){var a=y(e),s=y(t)*a,u=w(t)*a,c=w(e),l=c*i-u*o;return[v(u*i+c*o,s*n+l*r),C(l*n-s*r)]},a}ee.invert=ee;var ae=function(t){function e(e){return(e=t(e[0]*d,e[1]*d))[0]*=h,e[1]*=h,e}return t=ne(t[0]*d,t[1]*d,t.length>2?t[2]*d:0),e.invert=function(e){return(e=t.invert(e[0]*d,e[1]*d))[0]*=h,e[1]*=h,e},e};function se(t,e,n,r,i,o){if(n){var a=y(e),s=w(e),u=r*n;null==i?(i=e+r*f,o=e-u/2):(i=ue(a,i),o=ue(a,o),(r>0?i<o:i>o)&&(i+=r*f));for(var c,l=i;r>0?l>o:l<o;l-=u)c=Z([a,-s*y(l),-s*w(l)]),t.point(c[0],c[1])}}function ue(t,e){(e=K(e))[0]-=t,et(e);var n=P(-e[1]);return((-e[2]<0?-n:n)+f-s)%f}var ce=function(){var t,e,n=$t([0,0]),r=$t(90),i=$t(6),o={point:function(n,r){t.push(n=e(n,r)),n[0]*=h,n[1]*=h}};function a(){var a=n.apply(this,arguments),s=r.apply(this,arguments)*d,u=i.apply(this,arguments)*d;return t=[],e=ne(-a[0]*d,-a[1]*d,0).invert,se(o,s,u,1),a={type:"Polygon",coordinates:[t]},t=e=null,a}return a.center=function(t){return arguments.length?(n="function"==typeof t?t:$t([+t[0],+t[1]]),a):n},a.radius=function(t){return arguments.length?(r="function"==typeof t?t:$t(+t),a):r},a.precision=function(t){return arguments.length?(i="function"==typeof t?t:$t(+t),a):i},a},le=function(){var t,e=[];return{point:function(e,n){t.push([e,n])},lineStart:function(){e.push(t=[])},lineEnd:I,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}},fe=function(t,e){return p(t[0]-e[0])<s&&p(t[1]-e[1])<s};function he(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}var de=function(t,e,n,r,i){var o,a,s=[],u=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,n,r=t[0],a=t[e];if(fe(r,a)){for(i.lineStart(),o=0;o<e;++o)i.point((r=t[o])[0],r[1]);i.lineEnd()}else s.push(n=new he(r,t,null,!0)),u.push(n.o=new he(r,null,n,!1)),s.push(n=new he(a,t,null,!1)),u.push(n.o=new he(a,null,n,!0))}})),s.length){for(u.sort(e),pe(s),pe(u),o=0,a=u.length;o<a;++o)u[o].e=n=!n;for(var c,l,f=s[0];;){for(var h=f,d=!0;h.v;)if((h=h.n)===f)return;c=h.z,i.lineStart();do{if(h.v=h.o.v=!0,h.e){if(d)for(o=0,a=c.length;o<a;++o)i.point((l=c[o])[0],l[1]);else r(h.x,h.n.x,1,i);h=h.n}else{if(d)for(c=h.p.z,o=c.length-1;o>=0;--o)i.point((l=c[o])[0],l[1]);else r(h.x,h.p.x,-1,i);h=h.p}c=(h=h.o).z,d=!d}while(!h.v);i.lineEnd()}}};function pe(t){if(e=t.length){for(var e,n,r=0,i=t[0];++r<e;)i.n=n=t[r],n.p=i,i=n;i.n=n=t[0],n.p=i}}var ge=r();function ve(t){return p(t[0])<=u?t[0]:E(t[0])*((p(t[0])+u)%f-u)}var ye=function(t,e){var n=ve(e),r=e[1],i=w(r),o=[w(n),-y(n),0],a=0,h=0;ge.reset(),1===i?r=c+s:-1===i&&(r=-c-s);for(var d=0,p=t.length;d<p;++d)if(m=(g=t[d]).length)for(var g,m,b=g[m-1],_=ve(b),x=b[1]/2+l,E=w(x),S=y(x),O=0;O<m;++O,_=M,E=A,S=T,b=P){var P=g[O],M=ve(P),I=P[1]/2+l,A=w(I),T=y(I),N=M-_,L=N>=0?1:-1,R=L*N,k=R>u,j=E*A;if(ge.add(v(j*L*w(R),S*T+j*y(R))),a+=k?N+L*f:N,k^_>=n^M>=n){var F=Q(K(b),K(P));et(F);var D=Q(o,F);et(D);var B=(k^N>=0?-1:1)*C(D[2]);(r>B||r===B&&(F[0]||F[1]))&&(h+=k^N>=0?1:-1)}}return(a<-s||a<s&&ge<-s)^1&h},me=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN};var be,_e;1===(be=me).length&&(_e=be,be=function(t,e){return me(_e(t),e)});var xe=Array.prototype,we=(xe.slice,xe.map,function(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),o=new Array(i);++r<i;)o[r]=t+r*n;return o});Math.sqrt(50),Math.sqrt(10),Math.sqrt(2);var Ee=function(t){for(var e,n,r,i=t.length,o=-1,a=0;++o<i;)a+=t[o].length;for(n=new Array(a);--i>=0;)for(e=(r=t[i]).length;--e>=0;)n[--a]=r[e];return n};var Se=function(t,e,n,r){return function(i){var o,a,s,u=e(i),c=le(),l=e(c),f=!1,h={point:d,lineStart:g,lineEnd:v,polygonStart:function(){h.point=y,h.lineStart=m,h.lineEnd=b,a=[],o=[]},polygonEnd:function(){h.point=d,h.lineStart=g,h.lineEnd=v,a=Ee(a);var t=ye(o,r);a.length?(f||(i.polygonStart(),f=!0),de(a,Pe,t,n,i)):t&&(f||(i.polygonStart(),f=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),f&&(i.polygonEnd(),f=!1),a=o=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function d(e,n){t(e,n)&&i.point(e,n)}function p(t,e){u.point(t,e)}function g(){h.point=p,u.lineStart()}function v(){h.point=d,u.lineEnd()}function y(t,e){s.push([t,e]),l.point(t,e)}function m(){l.lineStart(),s=[]}function b(){y(s[0][0],s[0][1]),l.lineEnd();var t,e,n,r,u=l.clean(),h=c.result(),d=h.length;if(s.pop(),o.push(s),s=null,d)if(1&u){if((e=(n=h[0]).length-1)>0){for(f||(i.polygonStart(),f=!0),i.lineStart(),t=0;t<e;++t)i.point((r=n[t])[0],r[1]);i.lineEnd()}}else d>1&&2&u&&h.push(h.pop().concat(h.shift())),a.push(h.filter(Oe))}return h}};function Oe(t){return t.length>1}function Pe(t,e){return((t=t.x)[0]<0?t[1]-c-s:c-t[1])-((e=e.x)[0]<0?e[1]-c-s:c-e[1])}var Ce=Se((function(){return!0}),(function(t){var e,n=NaN,r=NaN,i=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(o,a){var l=o>0?u:-u,f=p(o-n);p(f-u)<s?(t.point(n,r=(r+a)/2>0?c:-c),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(l,r),t.point(o,r),e=0):i!==l&&f>=u&&(p(n-i)<s&&(n-=i*s),p(o-l)<s&&(o-=l*s),r=function(t,e,n,r){var i,o,a=w(t-n);return p(a)>s?g((w(e)*(o=y(r))*w(n)-w(r)*(i=y(e))*w(t))/(i*o*a)):(e+r)/2}(n,r,o,a),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(l,r),e=0),t.point(n=o,r=a),i=l},lineEnd:function(){t.lineEnd(),n=r=NaN},clean:function(){return 2-e}}}),(function(t,e,n,r){var i;if(null==t)i=n*c,r.point(-u,i),r.point(0,i),r.point(u,i),r.point(u,0),r.point(u,-i),r.point(0,-i),r.point(-u,-i),r.point(-u,0),r.point(-u,i);else if(p(t[0]-e[0])>s){var o=t[0]<e[0]?u:-u;i=n*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(e[0],e[1])}),[-u,-c]);var Me=function(t){var e=y(t),n=6*d,r=e>0,i=p(e)>s;function o(t,n){return y(t)*y(n)>e}function a(t,n,r){var i=[1,0,0],o=Q(K(t),K(n)),a=J(o,o),c=o[0],l=a-c*c;if(!l)return!r&&t;var f=e*a/l,h=-e*c/l,d=Q(i,o),g=tt(i,f);$(g,tt(o,h));var v=d,y=J(g,v),m=J(v,v),b=y*y-m*(J(g,g)-1);if(!(b<0)){var _=S(b),x=tt(v,(-y-_)/m);if($(x,g),x=Z(x),!r)return x;var w,E=t[0],O=n[0],P=t[1],C=n[1];O<E&&(w=E,E=O,O=w);var M=O-E,I=p(M-u)<s;if(!I&&C<P&&(w=P,P=C,C=w),I||M<s?I?P+C>0^x[1]<(p(x[0]-E)<s?P:C):P<=x[1]&&x[1]<=C:M>u^(E<=x[0]&&x[0]<=O)){var A=tt(v,(-y+_)/m);return $(A,g),[x,Z(A)]}}}function c(e,n){var i=r?t:u-t,o=0;return e<-i?o|=1:e>i&&(o|=2),n<-i?o|=4:n>i&&(o|=8),o}return Se(o,(function(t){var e,n,l,f,h;return{lineStart:function(){f=l=!1,h=1},point:function(d,p){var g,v=[d,p],y=o(d,p),m=r?y?0:c(d,p):y?c(d+(d<0?u:-u),p):0;if(!e&&(f=l=y)&&t.lineStart(),y!==l&&(!(g=a(e,v))||fe(e,g)||fe(v,g))&&(v[0]+=s,v[1]+=s,y=o(v[0],v[1])),y!==l)h=0,y?(t.lineStart(),g=a(v,e),t.point(g[0],g[1])):(g=a(e,v),t.point(g[0],g[1]),t.lineEnd()),e=g;else if(i&&e&&r^y){var b;m&n||!(b=a(v,e,!0))||(h=0,r?(t.lineStart(),t.point(b[0][0],b[0][1]),t.point(b[1][0],b[1][1]),t.lineEnd()):(t.point(b[1][0],b[1][1]),t.lineEnd(),t.lineStart(),t.point(b[0][0],b[0][1])))}!y||e&&fe(e,v)||t.point(v[0],v[1]),e=v,l=y,n=m},lineEnd:function(){l&&t.lineEnd(),e=null},clean:function(){return h|(f&&l)<<1}}}),(function(e,r,i,o){se(o,t,n,i,e,r)}),r?[0,-t]:[-u,t-u])};function Ie(t,e,n,r){function i(i,o){return t<=i&&i<=n&&e<=o&&o<=r}function o(i,o,s,u){var l=0,f=0;if(null==i||(l=a(i,s))!==(f=a(o,s))||c(i,o)<0^s>0)do{u.point(0===l||3===l?t:n,l>1?r:e)}while((l=(l+s+4)%4)!==f);else u.point(o[0],o[1])}function a(r,i){return p(r[0]-t)<s?i>0?0:3:p(r[0]-n)<s?i>0?2:1:p(r[1]-e)<s?i>0?1:0:i>0?3:2}function u(t,e){return c(t.x,e.x)}function c(t,e){var n=a(t,1),r=a(e,1);return n!==r?n-r:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(a){var s,c,l,f,h,d,p,g,v,y,m,b=a,_=le(),x={point:w,lineStart:function(){x.point=E,c&&c.push(l=[]);y=!0,v=!1,p=g=NaN},lineEnd:function(){s&&(E(f,h),d&&v&&_.rejoin(),s.push(_.result()));x.point=w,v&&b.lineEnd()},polygonStart:function(){b=_,s=[],c=[],m=!0},polygonEnd:function(){var e=function(){for(var e=0,n=0,i=c.length;n<i;++n)for(var o,a,s=c[n],u=1,l=s.length,f=s[0],h=f[0],d=f[1];u<l;++u)o=h,a=d,f=s[u],h=f[0],d=f[1],a<=r?d>r&&(h-o)*(r-a)>(d-a)*(t-o)&&++e:d<=r&&(h-o)*(r-a)<(d-a)*(t-o)&&--e;return e}(),n=m&&e,i=(s=Ee(s)).length;(n||i)&&(a.polygonStart(),n&&(a.lineStart(),o(null,null,1,a),a.lineEnd()),i&&de(s,u,e,o,a),a.polygonEnd());b=a,s=c=l=null}};function w(t,e){i(t,e)&&b.point(t,e)}function E(o,a){var s=i(o,a);if(c&&l.push([o,a]),y)f=o,h=a,d=s,y=!1,s&&(b.lineStart(),b.point(o,a));else if(s&&v)b.point(o,a);else{var u=[p=Math.max(-1e9,Math.min(1e9,p)),g=Math.max(-1e9,Math.min(1e9,g))],_=[o=Math.max(-1e9,Math.min(1e9,o)),a=Math.max(-1e9,Math.min(1e9,a))];!function(t,e,n,r,i,o){var a,s=t[0],u=t[1],c=0,l=1,f=e[0]-s,h=e[1]-u;if(a=n-s,f||!(a>0)){if(a/=f,f<0){if(a<c)return;a<l&&(l=a)}else if(f>0){if(a>l)return;a>c&&(c=a)}if(a=i-s,f||!(a<0)){if(a/=f,f<0){if(a>l)return;a>c&&(c=a)}else if(f>0){if(a<c)return;a<l&&(l=a)}if(a=r-u,h||!(a>0)){if(a/=h,h<0){if(a<c)return;a<l&&(l=a)}else if(h>0){if(a>l)return;a>c&&(c=a)}if(a=o-u,h||!(a<0)){if(a/=h,h<0){if(a>l)return;a>c&&(c=a)}else if(h>0){if(a<c)return;a<l&&(l=a)}return c>0&&(t[0]=s+c*f,t[1]=u+c*h),l<1&&(e[0]=s+l*f,e[1]=u+l*h),!0}}}}}(u,_,t,e,n,r)?s&&(b.lineStart(),b.point(o,a),m=!1):(v||(b.lineStart(),b.point(u[0],u[1])),b.point(_[0],_[1]),s||b.lineEnd(),m=!1)}p=o,g=a,v=s}return x}}var Ae,Te,Ne,Le=function(){var t,e,n,r=0,i=0,o=960,a=500;return n={stream:function(n){return t&&e===n?t:t=Ie(r,i,o,a)(e=n)},extent:function(s){return arguments.length?(r=+s[0][0],i=+s[0][1],o=+s[1][0],a=+s[1][1],t=e=null,n):[[r,i],[o,a]]}}},Re=r(),ke={sphere:I,point:I,lineStart:function(){ke.point=Fe,ke.lineEnd=je},lineEnd:I,polygonStart:I,polygonEnd:I};function je(){ke.point=ke.lineEnd=I}function Fe(t,e){Ae=t*=d,Te=w(e*=d),Ne=y(e),ke.point=De}function De(t,e){t*=d;var n=w(e*=d),r=y(e),i=p(t-Ae),o=y(i),a=r*w(i),s=Ne*n-Te*r*o,u=Te*n+Ne*r*o;Re.add(v(S(a*a+s*s),u)),Ae=t,Te=n,Ne=r}var Be=function(t){return Re.reset(),z(t,ke),+Re},ze=[null,null],Ve={type:"LineString",coordinates:ze},Ge=function(t,e){return ze[0]=t,ze[1]=e,Be(Ve)},Ue={Feature:function(t,e){return qe(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)if(qe(n[r].geometry,e))return!0;return!1}},We={Sphere:function(){return!0},Point:function(t,e){return Xe(t.coordinates,e)},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)if(Xe(n[r],e))return!0;return!1},LineString:function(t,e){return He(t.coordinates,e)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)if(He(n[r],e))return!0;return!1},Polygon:function(t,e){return Ye(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)if(Ye(n[r],e))return!0;return!1},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)if(qe(n[r],e))return!0;return!1}};function qe(t,e){return!(!t||!We.hasOwnProperty(t.type))&&We[t.type](t,e)}function Xe(t,e){return 0===Ge(t,e)}function He(t,e){for(var n,r,i,o=0,a=t.length;o<a;o++){if(0===(r=Ge(t[o],e)))return!0;if(o>0&&(i=Ge(t[o],t[o-1]))>0&&n<=i&&r<=i&&(n+r-i)*(1-Math.pow((n-r)/i,2))<1e-12*i)return!0;n=r}return!1}function Ye(t,e){return!!ye(t.map(Ze),Ke(e))}function Ze(t){return(t=t.map(Ke)).pop(),t}function Ke(t){return[t[0]*d,t[1]*d]}var Je=function(t,e){return(t&&Ue.hasOwnProperty(t.type)?Ue[t.type]:qe)(t,e)};function Qe(t,e,n){var r=we(t,e-s,n).concat(e);return function(t){return r.map((function(e){return[t,e]}))}}function $e(t,e,n){var r=we(t,e-s,n).concat(e);return function(t){return r.map((function(e){return[e,t]}))}}function tn(){var t,e,n,r,i,o,a,u,c,l,f,h,d=10,g=d,v=90,y=360,b=2.5;function _(){return{type:"MultiLineString",coordinates:x()}}function x(){return we(m(r/v)*v,n,v).map(f).concat(we(m(u/y)*y,a,y).map(h)).concat(we(m(e/d)*d,t,d).filter((function(t){return p(t%v)>s})).map(c)).concat(we(m(o/g)*g,i,g).filter((function(t){return p(t%y)>s})).map(l))}return _.lines=function(){return x().map((function(t){return{type:"LineString",coordinates:t}}))},_.outline=function(){return{type:"Polygon",coordinates:[f(r).concat(h(a).slice(1),f(n).reverse().slice(1),h(u).reverse().slice(1))]}},_.extent=function(t){return arguments.length?_.extentMajor(t).extentMinor(t):_.extentMinor()},_.extentMajor=function(t){return arguments.length?(r=+t[0][0],n=+t[1][0],u=+t[0][1],a=+t[1][1],r>n&&(t=r,r=n,n=t),u>a&&(t=u,u=a,a=t),_.precision(b)):[[r,u],[n,a]]},_.extentMinor=function(n){return arguments.length?(e=+n[0][0],t=+n[1][0],o=+n[0][1],i=+n[1][1],e>t&&(n=e,e=t,t=n),o>i&&(n=o,o=i,i=n),_.precision(b)):[[e,o],[t,i]]},_.step=function(t){return arguments.length?_.stepMajor(t).stepMinor(t):_.stepMinor()},_.stepMajor=function(t){return arguments.length?(v=+t[0],y=+t[1],_):[v,y]},_.stepMinor=function(t){return arguments.length?(d=+t[0],g=+t[1],_):[d,g]},_.precision=function(s){return arguments.length?(b=+s,c=Qe(o,i,90),l=$e(e,t,b),f=Qe(u,a,90),h=$e(r,n,b),_):b},_.extentMajor([[-180,-90+s],[180,90-s]]).extentMinor([[-180,-80-s],[180,80+s]])}function en(){return tn()()}var nn,rn,on,an,sn=function(t,e){var n=t[0]*d,r=t[1]*d,i=e[0]*d,o=e[1]*d,a=y(r),s=w(r),u=y(o),c=w(o),l=a*y(n),f=a*w(n),p=u*y(i),g=u*w(i),m=2*C(S(M(o-r)+a*u*M(i-n))),b=w(m),_=m?function(t){var e=w(t*=m)/b,n=w(m-t)/b,r=n*l+e*p,i=n*f+e*g,o=n*s+e*c;return[v(i,r)*h,v(o,S(r*r+i*i))*h]}:function(){return[n*h,r*h]};return _.distance=m,_},un=function(t){return t},cn=r(),ln=r(),fn={point:I,lineStart:I,lineEnd:I,polygonStart:function(){fn.lineStart=hn,fn.lineEnd=gn},polygonEnd:function(){fn.lineStart=fn.lineEnd=fn.point=I,cn.add(p(ln)),ln.reset()},result:function(){var t=cn/2;return cn.reset(),t}};function hn(){fn.point=dn}function dn(t,e){fn.point=pn,nn=on=t,rn=an=e}function pn(t,e){ln.add(an*t-on*e),on=t,an=e}function gn(){pn(nn,rn)}var vn=fn,yn=1/0,mn=yn,bn=-yn,_n=bn;var xn,wn,En,Sn,On={point:function(t,e){t<yn&&(yn=t);t>bn&&(bn=t);e<mn&&(mn=e);e>_n&&(_n=e)},lineStart:I,lineEnd:I,polygonStart:I,polygonEnd:I,result:function(){var t=[[yn,mn],[bn,_n]];return bn=_n=-(mn=yn=1/0),t}},Pn=0,Cn=0,Mn=0,In=0,An=0,Tn=0,Nn=0,Ln=0,Rn=0,kn={point:jn,lineStart:Fn,lineEnd:zn,polygonStart:function(){kn.lineStart=Vn,kn.lineEnd=Gn},polygonEnd:function(){kn.point=jn,kn.lineStart=Fn,kn.lineEnd=zn},result:function(){var t=Rn?[Nn/Rn,Ln/Rn]:Tn?[In/Tn,An/Tn]:Mn?[Pn/Mn,Cn/Mn]:[NaN,NaN];return Pn=Cn=Mn=In=An=Tn=Nn=Ln=Rn=0,t}};function jn(t,e){Pn+=t,Cn+=e,++Mn}function Fn(){kn.point=Dn}function Dn(t,e){kn.point=Bn,jn(En=t,Sn=e)}function Bn(t,e){var n=t-En,r=e-Sn,i=S(n*n+r*r);In+=i*(En+t)/2,An+=i*(Sn+e)/2,Tn+=i,jn(En=t,Sn=e)}function zn(){kn.point=jn}function Vn(){kn.point=Un}function Gn(){Wn(xn,wn)}function Un(t,e){kn.point=Wn,jn(xn=En=t,wn=Sn=e)}function Wn(t,e){var n=t-En,r=e-Sn,i=S(n*n+r*r);In+=i*(En+t)/2,An+=i*(Sn+e)/2,Tn+=i,Nn+=(i=Sn*t-En*e)*(En+t),Ln+=i*(Sn+e),Rn+=3*i,jn(En=t,Sn=e)}var qn=kn;function Xn(t){this._context=t}Xn.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,f)}},result:I};var Hn,Yn,Zn,Kn,Jn,Qn=r(),$n={point:I,lineStart:function(){$n.point=tr},lineEnd:function(){Hn&&er(Yn,Zn),$n.point=I},polygonStart:function(){Hn=!0},polygonEnd:function(){Hn=null},result:function(){var t=+Qn;return Qn.reset(),t}};function tr(t,e){$n.point=er,Yn=Kn=t,Zn=Jn=e}function er(t,e){Kn-=t,Jn-=e,Qn.add(S(Kn*Kn+Jn*Jn)),Kn=t,Jn=e}var nr=$n;function rr(){this._string=[]}function ir(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}rr.prototype={_radius:4.5,_circle:ir(4.5),pointRadius:function(t){return(t=+t)!==this._radius&&(this._radius=t,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._string.push("M",t,",",e),this._point=1;break;case 1:this._string.push("L",t,",",e);break;default:null==this._circle&&(this._circle=ir(this._radius)),this._string.push("M",t,",",e,this._circle)}},result:function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}return null}};var or=function(t,e){var n,r,i=4.5;function o(t){return t&&("function"==typeof i&&r.pointRadius(+i.apply(this,arguments)),z(t,n(r))),r.result()}return o.area=function(t){return z(t,n(vn)),vn.result()},o.measure=function(t){return z(t,n(nr)),nr.result()},o.bounds=function(t){return z(t,n(On)),On.result()},o.centroid=function(t){return z(t,n(qn)),qn.result()},o.projection=function(e){return arguments.length?(n=null==e?(t=null,un):(t=e).stream,o):t},o.context=function(t){return arguments.length?(r=null==t?(e=null,new rr):new Xn(e=t),"function"!=typeof i&&r.pointRadius(i),o):e},o.pointRadius=function(t){return arguments.length?(i="function"==typeof t?t:(r.pointRadius(+t),+t),o):i},o.projection(t).context(e)},ar=function(t){return{stream:sr(t)}};function sr(t){return function(e){var n=new ur;for(var r in t)n[r]=t[r];return n.stream=e,n}}function ur(){}function cr(t,e,n){var r=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),null!=r&&t.clipExtent(null),z(n,t.stream(On)),e(On.result()),null!=r&&t.clipExtent(r),t}function lr(t,e,n){return cr(t,(function(n){var r=e[1][0]-e[0][0],i=e[1][1]-e[0][1],o=Math.min(r/(n[1][0]-n[0][0]),i/(n[1][1]-n[0][1])),a=+e[0][0]+(r-o*(n[1][0]+n[0][0]))/2,s=+e[0][1]+(i-o*(n[1][1]+n[0][1]))/2;t.scale(150*o).translate([a,s])}),n)}function fr(t,e,n){return lr(t,[[0,0],e],n)}function hr(t,e,n){return cr(t,(function(n){var r=+e,i=r/(n[1][0]-n[0][0]),o=(r-i*(n[1][0]+n[0][0]))/2,a=-i*n[0][1];t.scale(150*i).translate([o,a])}),n)}function dr(t,e,n){return cr(t,(function(n){var r=+e,i=r/(n[1][1]-n[0][1]),o=-i*n[0][0],a=(r-i*(n[1][1]+n[0][1]))/2;t.scale(150*i).translate([o,a])}),n)}ur.prototype={constructor:ur,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var pr=y(30*d),gr=function(t,e){return+e?function(t,e){function n(r,i,o,a,u,c,l,f,h,d,g,y,m,b){var _=l-r,x=f-i,w=_*_+x*x;if(w>4*e&&m--){var E=a+d,O=u+g,P=c+y,M=S(E*E+O*O+P*P),I=C(P/=M),A=p(p(P)-1)<s||p(o-h)<s?(o+h)/2:v(O,E),T=t(A,I),N=T[0],L=T[1],R=N-r,k=L-i,j=x*R-_*k;(j*j/w>e||p((_*R+x*k)/w-.5)>.3||a*d+u*g+c*y<pr)&&(n(r,i,o,a,u,c,N,L,A,E/=M,O/=M,P,m,b),b.point(N,L),n(N,L,A,E,O,P,l,f,h,d,g,y,m,b))}}return function(e){var r,i,o,a,s,u,c,l,f,h,d,p,g={point:v,lineStart:y,lineEnd:b,polygonStart:function(){e.polygonStart(),g.lineStart=_},polygonEnd:function(){e.polygonEnd(),g.lineStart=y}};function v(n,r){n=t(n,r),e.point(n[0],n[1])}function y(){l=NaN,g.point=m,e.lineStart()}function m(r,i){var o=K([r,i]),a=t(r,i);n(l,f,c,h,d,p,l=a[0],f=a[1],c=r,h=o[0],d=o[1],p=o[2],16,e),e.point(l,f)}function b(){g.point=v,e.lineEnd()}function _(){y(),g.point=x,g.lineEnd=w}function x(t,e){m(r=t,e),i=l,o=f,a=h,s=d,u=p,g.point=m}function w(){n(l,f,c,h,d,p,i,o,r,a,s,u,16,e),g.lineEnd=b,b()}return g}}(t,e):function(t){return sr({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}(t)};var vr=sr({point:function(t,e){this.stream.point(t*d,e*d)}});function yr(t,e,n,r,i){function o(o,a){return[e+t*(o*=r),n-t*(a*=i)]}return o.invert=function(o,a){return[(o-e)/t*r,(n-a)/t*i]},o}function mr(t,e,n,r,i,o){var a=y(o),s=w(o),u=a*t,c=s*t,l=a/t,f=s/t,h=(s*n-a*e)/t,d=(s*e+a*n)/t;function p(t,o){return[u*(t*=r)-c*(o*=i)+e,n-c*t-u*o]}return p.invert=function(t,e){return[r*(l*t-f*e+h),i*(d-f*t-l*e)]},p}function br(t){return _r((function(){return t}))()}function _r(t){var e,n,r,i,o,a,s,u,c,l,f=150,p=480,g=250,v=0,y=0,m=0,b=0,_=0,x=0,w=1,E=1,O=null,P=Ce,C=null,M=un,I=.5;function A(t){return u(t[0]*d,t[1]*d)}function T(t){return(t=u.invert(t[0],t[1]))&&[t[0]*h,t[1]*h]}function N(){var t=mr(f,0,0,w,E,x).apply(null,e(v,y)),r=(x?mr:yr)(f,p-t[0],g-t[1],w,E,x);return n=ne(m,b,_),s=te(e,r),u=te(n,s),a=gr(s,I),L()}function L(){return c=l=null,A}return A.stream=function(t){return c&&l===t?c:c=vr(function(t){return sr({point:function(e,n){var r=t(e,n);return this.stream.point(r[0],r[1])}})}(n)(P(a(M(l=t)))))},A.preclip=function(t){return arguments.length?(P=t,O=void 0,L()):P},A.postclip=function(t){return arguments.length?(M=t,C=r=i=o=null,L()):M},A.clipAngle=function(t){return arguments.length?(P=+t?Me(O=t*d):(O=null,Ce),L()):O*h},A.clipExtent=function(t){return arguments.length?(M=null==t?(C=r=i=o=null,un):Ie(C=+t[0][0],r=+t[0][1],i=+t[1][0],o=+t[1][1]),L()):null==C?null:[[C,r],[i,o]]},A.scale=function(t){return arguments.length?(f=+t,N()):f},A.translate=function(t){return arguments.length?(p=+t[0],g=+t[1],N()):[p,g]},A.center=function(t){return arguments.length?(v=t[0]%360*d,y=t[1]%360*d,N()):[v*h,y*h]},A.rotate=function(t){return arguments.length?(m=t[0]%360*d,b=t[1]%360*d,_=t.length>2?t[2]%360*d:0,N()):[m*h,b*h,_*h]},A.angle=function(t){return arguments.length?(x=t%360*d,N()):x*h},A.reflectX=function(t){return arguments.length?(w=t?-1:1,N()):w<0},A.reflectY=function(t){return arguments.length?(E=t?-1:1,N()):E<0},A.precision=function(t){return arguments.length?(a=gr(s,I=t*t),L()):S(I)},A.fitExtent=function(t,e){return lr(A,t,e)},A.fitSize=function(t,e){return fr(A,t,e)},A.fitWidth=function(t,e){return hr(A,t,e)},A.fitHeight=function(t,e){return dr(A,t,e)},function(){return e=t.apply(this,arguments),A.invert=e.invert&&T,N()}}function xr(t){var e=0,n=u/3,r=_r(t),i=r(e,n);return i.parallels=function(t){return arguments.length?r(e=t[0]*d,n=t[1]*d):[e*h,n*h]},i}function wr(t,e){var n=w(t),r=(n+w(e))/2;if(p(r)<s)return function(t){var e=y(t);function n(t,n){return[t*e,w(n)/e]}return n.invert=function(t,n){return[t/e,C(n*e)]},n}(t);var i=1+n*(2*r-n),o=S(i)/r;function a(t,e){var n=S(i-2*r*w(e))/r;return[n*w(t*=r),o-n*y(t)]}return a.invert=function(t,e){var n=o-e,a=v(t,p(n))*E(n);return n*r<0&&(a-=u*E(t)*E(n)),[a/r,C((i-(t*t+n*n)*r*r)/(2*r))]},a}var Er=function(){return xr(wr).scale(155.424).center([0,33.6442])},Sr=function(){return Er().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])};var Or=function(){var t,e,n,r,i,o,a=Sr(),u=Er().rotate([154,0]).center([-2,58.5]).parallels([55,65]),c=Er().rotate([157,0]).center([-3,19.9]).parallels([8,18]),l={point:function(t,e){o=[t,e]}};function f(t){var e=t[0],a=t[1];return o=null,n.point(e,a),o||(r.point(e,a),o)||(i.point(e,a),o)}function h(){return t=e=null,f}return f.invert=function(t){var e=a.scale(),n=a.translate(),r=(t[0]-n[0])/e,i=(t[1]-n[1])/e;return(i>=.12&&i<.234&&r>=-.425&&r<-.214?u:i>=.166&&i<.234&&r>=-.214&&r<-.115?c:a).invert(t)},f.stream=function(n){return t&&e===n?t:(r=[a.stream(e=n),u.stream(n),c.stream(n)],i=r.length,t={point:function(t,e){for(var n=-1;++n<i;)r[n].point(t,e)},sphere:function(){for(var t=-1;++t<i;)r[t].sphere()},lineStart:function(){for(var t=-1;++t<i;)r[t].lineStart()},lineEnd:function(){for(var t=-1;++t<i;)r[t].lineEnd()},polygonStart:function(){for(var t=-1;++t<i;)r[t].polygonStart()},polygonEnd:function(){for(var t=-1;++t<i;)r[t].polygonEnd()}});var r,i},f.precision=function(t){return arguments.length?(a.precision(t),u.precision(t),c.precision(t),h()):a.precision()},f.scale=function(t){return arguments.length?(a.scale(t),u.scale(.35*t),c.scale(t),f.translate(a.translate())):a.scale()},f.translate=function(t){if(!arguments.length)return a.translate();var e=a.scale(),o=+t[0],f=+t[1];return n=a.translate(t).clipExtent([[o-.455*e,f-.238*e],[o+.455*e,f+.238*e]]).stream(l),r=u.translate([o-.307*e,f+.201*e]).clipExtent([[o-.425*e+s,f+.12*e+s],[o-.214*e-s,f+.234*e-s]]).stream(l),i=c.translate([o-.205*e,f+.212*e]).clipExtent([[o-.214*e+s,f+.166*e+s],[o-.115*e-s,f+.234*e-s]]).stream(l),h()},f.fitExtent=function(t,e){return lr(f,t,e)},f.fitSize=function(t,e){return fr(f,t,e)},f.fitWidth=function(t,e){return hr(f,t,e)},f.fitHeight=function(t,e){return dr(f,t,e)},f.scale(1070)};function Pr(t){return function(e,n){var r=y(e),i=y(n),o=t(r*i);return[o*i*w(e),o*w(n)]}}function Cr(t){return function(e,n){var r=S(e*e+n*n),i=t(r),o=w(i),a=y(i);return[v(e*o,r*a),C(r&&n*o/r)]}}var Mr=Pr((function(t){return S(2/(1+t))}));Mr.invert=Cr((function(t){return 2*C(t/2)}));var Ir=function(){return br(Mr).scale(124.75).clipAngle(179.999)},Ar=Pr((function(t){return(t=P(t))&&t/w(t)}));Ar.invert=Cr((function(t){return t}));var Tr=function(){return br(Ar).scale(79.4188).clipAngle(179.999)};function Nr(t,e){return[t,_(O((c+e)/2))]}Nr.invert=function(t,e){return[t,2*g(b(e))-c]};var Lr=function(){return Rr(Nr).scale(961/f)};function Rr(t){var e,n,r,i=br(t),o=i.center,a=i.scale,s=i.translate,c=i.clipExtent,l=null;function f(){var o=u*a(),s=i(ae(i.rotate()).invert([0,0]));return c(null==l?[[s[0]-o,s[1]-o],[s[0]+o,s[1]+o]]:t===Nr?[[Math.max(s[0]-o,l),e],[Math.min(s[0]+o,n),r]]:[[l,Math.max(s[1]-o,e)],[n,Math.min(s[1]+o,r)]])}return i.scale=function(t){return arguments.length?(a(t),f()):a()},i.translate=function(t){return arguments.length?(s(t),f()):s()},i.center=function(t){return arguments.length?(o(t),f()):o()},i.clipExtent=function(t){return arguments.length?(null==t?l=e=n=r=null:(l=+t[0][0],e=+t[0][1],n=+t[1][0],r=+t[1][1]),f()):null==l?null:[[l,e],[n,r]]},f()}function kr(t){return O((c+t)/2)}function jr(t,e){var n=y(t),r=t===e?w(t):_(n/y(e))/_(kr(e)/kr(t)),i=n*x(kr(t),r)/r;if(!r)return Nr;function o(t,e){i>0?e<-c+s&&(e=-c+s):e>c-s&&(e=c-s);var n=i/x(kr(e),r);return[n*w(r*t),i-n*y(r*t)]}return o.invert=function(t,e){var n=i-e,o=E(r)*S(t*t+n*n),a=v(t,p(n))*E(n);return n*r<0&&(a-=u*E(t)*E(n)),[a/r,2*g(x(i/o,1/r))-c]},o}var Fr=function(){return xr(jr).scale(109.5).parallels([30,30])};function Dr(t,e){return[t,e]}Dr.invert=Dr;var Br=function(){return br(Dr).scale(152.63)};function zr(t,e){var n=y(t),r=t===e?w(t):(n-y(e))/(e-t),i=n/r+t;if(p(r)<s)return Dr;function o(t,e){var n=i-e,o=r*t;return[n*w(o),i-n*y(o)]}return o.invert=function(t,e){var n=i-e,o=v(t,p(n))*E(n);return n*r<0&&(o-=u*E(t)*E(n)),[o/r,i-E(r)*S(t*t+n*n)]},o}var Vr=function(){return xr(zr).scale(131.154).center([0,13.9389])},Gr=1.340264,Ur=-.081106,Wr=893e-6,qr=.003796,Xr=S(3)/2;function Hr(t,e){var n=C(Xr*w(e)),r=n*n,i=r*r*r;return[t*y(n)/(Xr*(Gr+3*Ur*r+i*(7*Wr+9*qr*r))),n*(Gr+Ur*r+i*(Wr+qr*r))]}Hr.invert=function(t,e){for(var n,r=e,i=r*r,o=i*i*i,a=0;a<12&&(o=(i=(r-=n=(r*(Gr+Ur*i+o*(Wr+qr*i))-e)/(Gr+3*Ur*i+o*(7*Wr+9*qr*i)))*r)*i*i,!(p(n)<1e-12));++a);return[Xr*t*(Gr+3*Ur*i+o*(7*Wr+9*qr*i))/y(r),C(w(r)/Xr)]};var Yr=function(){return br(Hr).scale(177.158)};function Zr(t,e){var n=y(e),r=y(t)*n;return[n*w(t)/r,w(e)/r]}Zr.invert=Cr(g);var Kr=function(){return br(Zr).scale(144.049).clipAngle(60)},Jr=function(){var t,e,n,r,i,o,a,s=1,u=0,c=0,l=1,f=1,p=0,g=null,v=1,m=1,b=sr({point:function(t,e){var n=E([t,e]);this.stream.point(n[0],n[1])}}),_=un;function x(){return v=s*l,m=s*f,o=a=null,E}function E(n){var r=n[0]*v,i=n[1]*m;if(p){var o=i*t-r*e;r=r*t+i*e,i=o}return[r+u,i+c]}return E.invert=function(n){var r=n[0]-u,i=n[1]-c;if(p){var o=i*t+r*e;r=r*t-i*e,i=o}return[r/v,i/m]},E.stream=function(t){return o&&a===t?o:o=b(_(a=t))},E.postclip=function(t){return arguments.length?(_=t,g=n=r=i=null,x()):_},E.clipExtent=function(t){return arguments.length?(_=null==t?(g=n=r=i=null,un):Ie(g=+t[0][0],n=+t[0][1],r=+t[1][0],i=+t[1][1]),x()):null==g?null:[[g,n],[r,i]]},E.scale=function(t){return arguments.length?(s=+t,x()):s},E.translate=function(t){return arguments.length?(u=+t[0],c=+t[1],x()):[u,c]},E.angle=function(n){return arguments.length?(e=w(p=n%360*d),t=y(p),x()):p*h},E.reflectX=function(t){return arguments.length?(l=t?-1:1,x()):l<0},E.reflectY=function(t){return arguments.length?(f=t?-1:1,x()):f<0},E.fitExtent=function(t,e){return lr(E,t,e)},E.fitSize=function(t,e){return fr(E,t,e)},E.fitWidth=function(t,e){return hr(E,t,e)},E.fitHeight=function(t,e){return dr(E,t,e)},E};function Qr(t,e){var n=e*e,r=n*n;return[t*(.8707-.131979*n+r*(r*(.003971*n-.001529*r)-.013791)),e*(1.007226+n*(.015085+r*(.028874*n-.044475-.005916*r)))]}Qr.invert=function(t,e){var n,r=e,i=25;do{var o=r*r,a=o*o;r-=n=(r*(1.007226+o*(.015085+a*(.028874*o-.044475-.005916*a)))-e)/(1.007226+o*(.045255+a*(.259866*o-.311325-.005916*11*a)))}while(p(n)>s&&--i>0);return[t/(.8707+(o=r*r)*(o*(o*o*o*(.003971-.001529*o)-.013791)-.131979)),r]};var $r=function(){return br(Qr).scale(175.295)};function ti(t,e){return[y(e)*w(t),w(e)]}ti.invert=Cr(C);var ei=function(){return br(ti).scale(249.5).clipAngle(90+s)};function ni(t,e){var n=y(e),r=1+y(t)*n;return[n*w(t)/r,w(e)/r]}ni.invert=Cr((function(t){return 2*g(t)}));var ri=function(){return br(ni).scale(250).clipAngle(142)};function ii(t,e){return[_(O((c+e)/2)),-t]}ii.invert=function(t,e){return[-e,2*g(b(t))-c]};var oi=function(){var t=Rr(ii),e=t.center,n=t.rotate;return t.center=function(t){return arguments.length?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return arguments.length?n([t[0],t[1],t.length>2?t[2]+90:90]):[(t=n())[0],t[1],t[2]-90]},n([0,0,90]).scale(159.155)}},function(t,e,n){"use strict";n.r(e),n.d(e,"topology",(function(){return y}));var r=Object.prototype.hasOwnProperty,i=function(t,e,n,r,i,o){3===arguments.length&&(r=o=Array,i=null);for(var a=new r(t=1<<Math.max(4,Math.ceil(Math.log(t)/Math.LN2))),s=new o(t),u=t-1,c=0;c<t;++c)a[c]=i;function l(r,o){for(var c=e(r)&u,l=a[c],f=0;l!=i;){if(n(l,r))return s[c]=o;if(++f>=t)throw new Error("full hashmap");l=a[c=c+1&u]}return a[c]=r,s[c]=o,o}function f(r,o){for(var c=e(r)&u,l=a[c],f=0;l!=i;){if(n(l,r))return s[c];if(++f>=t)throw new Error("full hashmap");l=a[c=c+1&u]}return a[c]=r,s[c]=o,o}function h(r,o){for(var c=e(r)&u,l=a[c],f=0;l!=i;){if(n(l,r))return s[c];if(++f>=t)break;l=a[c=c+1&u]}return o}function d(){for(var t=[],e=0,n=a.length;e<n;++e){var r=a[e];r!=i&&t.push(r)}return t}return{set:l,maybeSet:f,get:h,keys:d}},o=function(t,e){return t[0]===e[0]&&t[1]===e[1]},a=new ArrayBuffer(16),s=new Float64Array(a),u=new Uint32Array(a),c=function(t){s[0]=t[0],s[1]=t[1];var e=u[0]^u[1];return 2147483647&(e=e<<5^e>>7^u[2]^u[3])},l=function(t){var e,n,r,a,s=t.coordinates,u=t.lines,l=t.rings,f=function(){for(var t=i(1.4*s.length,S,O,Int32Array,-1,Int32Array),e=new Int32Array(s.length),n=0,r=s.length;n<r;++n)e[n]=t.maybeSet(n,n);return e}(),h=new Int32Array(s.length),d=new Int32Array(s.length),p=new Int32Array(s.length),g=new Int8Array(s.length),v=0;for(e=0,n=s.length;e<n;++e)h[e]=d[e]=p[e]=-1;for(e=0,n=u.length;e<n;++e){var y=u[e],m=y[0],b=y[1];for(r=f[m],a=f[++m],++v,g[r]=1;++m<=b;)E(e,r,r=a,a=f[m]);++v,g[a]=1}for(e=0,n=s.length;e<n;++e)h[e]=-1;for(e=0,n=l.length;e<n;++e){var _=l[e],x=_[0]+1,w=_[1];for(E(e,f[w-1],r=f[x-1],a=f[x]);++x<=w;)E(e,r,r=a,a=f[x])}function E(t,e,n,r){if(h[n]!==t){h[n]=t;var i=d[n];if(i>=0){var o=p[n];i===e&&o===r||i===r&&o===e||(++v,g[n]=1)}else d[n]=e,p[n]=r}}function S(t){return c(s[t])}function O(t,e){return o(s[t],s[e])}h=d=p=null;var P,C=function(t,e,n,r,i){3===arguments.length&&(r=Array,i=null);for(var o=new r(t=1<<Math.max(4,Math.ceil(Math.log(t)/Math.LN2))),a=t-1,s=0;s<t;++s)o[s]=i;function u(r){for(var s=e(r)&a,u=o[s],c=0;u!=i;){if(n(u,r))return!0;if(++c>=t)throw new Error("full hashset");u=o[s=s+1&a]}return o[s]=r,!0}function c(r){for(var s=e(r)&a,u=o[s],c=0;u!=i;){if(n(u,r))return!0;if(++c>=t)break;u=o[s=s+1&a]}return!1}function l(){for(var t=[],e=0,n=o.length;e<n;++e){var r=o[e];r!=i&&t.push(r)}return t}return{add:u,has:c,values:l}}(1.4*v,c,o);for(e=0,n=s.length;e<n;++e)g[P=f[e]]&&C.add(s[P]);return C};function f(t,e,n,r){h(t,e,n),h(t,e,e+r),h(t,e+r,n)}function h(t,e,n){for(var r,i=e+(n---e>>1);e<i;++e,--n)r=t[e],t[e]=t[n],t[n]=r}var d=function(t){var e,n,r={};for(e in t)r[e]=null==(n=t[e])?{type:null}:("FeatureCollection"===n.type?p:"Feature"===n.type?g:v)(n);return r};function p(t){var e={type:"GeometryCollection",geometries:t.features.map(g)};return null!=t.bbox&&(e.bbox=t.bbox),e}function g(t){var e,n=v(t.geometry);for(e in null!=t.id&&(n.id=t.id),null!=t.bbox&&(n.bbox=t.bbox),t.properties){n.properties=t.properties;break}return n}function v(t){if(null==t)return{type:null};var e="GeometryCollection"===t.type?{type:"GeometryCollection",geometries:t.geometries.map(v)}:"Point"===t.type||"MultiPoint"===t.type?{type:t.type,coordinates:t.coordinates}:{type:t.type,arcs:t.coordinates};return null!=t.bbox&&(e.bbox=t.bbox),e}var y=function(t,e){var n=function(t){var e=1/0,n=1/0,i=-1/0,o=-1/0;function a(t){null!=t&&r.call(s,t.type)&&s[t.type](t)}var s={GeometryCollection:function(t){t.geometries.forEach(a)},Point:function(t){u(t.coordinates)},MultiPoint:function(t){t.coordinates.forEach(u)},LineString:function(t){c(t.arcs)},MultiLineString:function(t){t.arcs.forEach(c)},Polygon:function(t){t.arcs.forEach(c)},MultiPolygon:function(t){t.arcs.forEach(l)}};function u(t){var r=t[0],a=t[1];r<e&&(e=r),r>i&&(i=r),a<n&&(n=a),a>o&&(o=a)}function c(t){t.forEach(u)}function l(t){t.forEach(c)}for(var f in t)a(t[f]);return i>=e&&o>=n?[e,n,i,o]:void 0}(t=d(t)),a=e>0&&n&&function(t,e,n){var i=e[0],o=e[1],a=e[2],s=e[3],u=a-i?(n-1)/(a-i):1,c=s-o?(n-1)/(s-o):1;function l(t){return[Math.round((t[0]-i)*u),Math.round((t[1]-o)*c)]}function f(t,e){for(var n,r,a,s,l,f=-1,h=0,d=t.length,p=new Array(d);++f<d;)n=t[f],s=Math.round((n[0]-i)*u),l=Math.round((n[1]-o)*c),s===r&&l===a||(p[h++]=[r=s,a=l]);for(p.length=h;h<e;)h=p.push([p[0][0],p[0][1]]);return p}function h(t){return f(t,2)}function d(t){return f(t,4)}function p(t){return t.map(d)}function g(t){null!=t&&r.call(v,t.type)&&v[t.type](t)}var v={GeometryCollection:function(t){t.geometries.forEach(g)},Point:function(t){t.coordinates=l(t.coordinates)},MultiPoint:function(t){t.coordinates=t.coordinates.map(l)},LineString:function(t){t.arcs=h(t.arcs)},MultiLineString:function(t){t.arcs=t.arcs.map(h)},Polygon:function(t){t.arcs=p(t.arcs)},MultiPolygon:function(t){t.arcs=t.arcs.map(p)}};for(var y in t)g(t[y]);return{scale:[1/u,1/c],translate:[i,o]}}(t,n,e),s=function(t){var e,n,r,a,s=t.coordinates,u=t.lines,l=t.rings,f=u.length+l.length;for(delete t.lines,delete t.rings,r=0,a=u.length;r<a;++r)for(e=u[r];e=e.next;)++f;for(r=0,a=l.length;r<a;++r)for(n=l[r];n=n.next;)++f;var h=i(2*f*1.4,c,o),d=t.arcs=[];for(r=0,a=u.length;r<a;++r){e=u[r];do{p(e)}while(e=e.next)}for(r=0,a=l.length;r<a;++r)if((n=l[r]).next)do{p(n)}while(n=n.next);else g(n);function p(t){var e,n,r,i,o,a,u,c;if(r=h.get(e=s[t[0]]))for(u=0,c=r.length;u<c;++u)if(v(i=r[u],t))return t[0]=i[0],void(t[1]=i[1]);if(o=h.get(n=s[t[1]]))for(u=0,c=o.length;u<c;++u)if(y(a=o[u],t))return t[1]=a[0],void(t[0]=a[1]);r?r.push(t):h.set(e,[t]),o?o.push(t):h.set(n,[t]),d.push(t)}function g(t){var e,n,r,i,o;if(n=h.get(s[t[0]]))for(i=0,o=n.length;i<o;++i){if(m(r=n[i],t))return t[0]=r[0],void(t[1]=r[1]);if(b(r,t))return t[0]=r[1],void(t[1]=r[0])}if(n=h.get(e=s[t[0]+_(t)]))for(i=0,o=n.length;i<o;++i){if(m(r=n[i],t))return t[0]=r[0],void(t[1]=r[1]);if(b(r,t))return t[0]=r[1],void(t[1]=r[0])}n?n.push(t):h.set(e,[t]),d.push(t)}function v(t,e){var n=t[0],r=e[0],i=t[1];if(n-i!=r-e[1])return!1;for(;n<=i;++n,++r)if(!o(s[n],s[r]))return!1;return!0}function y(t,e){var n=t[0],r=e[0],i=t[1],a=e[1];if(n-i!=r-a)return!1;for(;n<=i;++n,--a)if(!o(s[n],s[a]))return!1;return!0}function m(t,e){var n=t[0],r=e[0],i=t[1]-n;if(i!==e[1]-r)return!1;for(var a=_(t),u=_(e),c=0;c<i;++c)if(!o(s[n+(c+a)%i],s[r+(c+u)%i]))return!1;return!0}function b(t,e){var n=t[0],r=e[0],i=t[1],a=e[1],u=i-n;if(u!==a-r)return!1;for(var c=_(t),l=u-_(e),f=0;f<u;++f)if(!o(s[n+(f+c)%u],s[a-(f+l)%u]))return!1;return!0}function _(t){for(var e=t[0],n=t[1],r=e,i=r,o=s[r];++r<n;){var a=s[r];(a[0]<o[0]||a[0]===o[0]&&a[1]<o[1])&&(i=r,o=a)}return i-e}return t}(function(t){var e,n,r,i=l(t),o=t.coordinates,a=t.lines,s=t.rings;for(n=0,r=a.length;n<r;++n)for(var u=a[n],c=u[0],h=u[1];++c<h;)i.has(o[c])&&(e={0:c,1:u[1]},u[1]=c,u=u.next=e);for(n=0,r=s.length;n<r;++n)for(var d=s[n],p=d[0],g=p,v=d[1],y=i.has(o[p]);++g<v;)i.has(o[g])&&(y?(e={0:g,1:d[1]},d[1]=g,d=d.next=e):(f(o,p,v,v-g),o[v]=o[p],y=!0,g=p));return t}(function(t){var e=-1,n=[],i=[],o=[];function a(t){t&&r.call(s,t.type)&&s[t.type](t)}var s={GeometryCollection:function(t){t.geometries.forEach(a)},LineString:function(t){t.arcs=u(t.arcs)},MultiLineString:function(t){t.arcs=t.arcs.map(u)},Polygon:function(t){t.arcs=t.arcs.map(c)},MultiPolygon:function(t){t.arcs=t.arcs.map(l)}};function u(t){for(var r=0,i=t.length;r<i;++r)o[++e]=t[r];var a={0:e-i+1,1:e};return n.push(a),a}function c(t){for(var n=0,r=t.length;n<r;++n)o[++e]=t[n];var a={0:e-r+1,1:e};return i.push(a),a}function l(t){return t.map(c)}for(var f in t)a(t[f]);return{type:"Topology",coordinates:o,lines:n,rings:i,objects:t}}(t))),u=s.coordinates,h=i(1.4*s.arcs.length,m,b);function p(t){t&&r.call(g,t.type)&&g[t.type](t)}t=s.objects,s.bbox=n,s.arcs=s.arcs.map((function(t,e){return h.set(t,e),u.slice(t[0],t[1]+1)})),delete s.coordinates,u=null;var g={GeometryCollection:function(t){t.geometries.forEach(p)},LineString:function(t){t.arcs=v(t.arcs)},MultiLineString:function(t){t.arcs=t.arcs.map(v)},Polygon:function(t){t.arcs=t.arcs.map(v)},MultiPolygon:function(t){t.arcs=t.arcs.map(y)}};function v(t){var e=[];do{var n=h.get(t);e.push(t[0]<t[1]?n:~n)}while(t=t.next);return e}function y(t){return t.map(v)}for(var _ in t)p(t[_]);return a&&(s.transform=a,s.arcs=function(t){for(var e=-1,n=t.length;++e<n;){for(var r,i,o=t[e],a=0,s=1,u=o.length,c=o[0],l=c[0],f=c[1];++a<u;)r=(c=o[a])[0],i=c[1],r===l&&i===f||(o[s++]=[r-l,i-f],l=r,f=i);1===s&&(o[s++]=[0,0]),o.length=s}return t}(s.arcs)),s};function m(t){var e,n=t[0],r=t[1];return r<n&&(e=n,n=r,r=e),n+31*r}function b(t,e){var n,r=t[0],i=t[1],o=e[0],a=e[1];return i<r&&(n=r,r=i,i=n),a<o&&(n=o,o=a,a=n),r===o&&i===a}},function(t,e,n){"use strict";n.r(e),n.d(e,"bbox",(function(){return o})),n.d(e,"feature",(function(){return a})),n.d(e,"mesh",(function(){return l})),n.d(e,"meshArcs",(function(){return f})),n.d(e,"merge",(function(){return d})),n.d(e,"mergeArcs",(function(){return p})),n.d(e,"neighbors",(function(){return v})),n.d(e,"quantize",(function(){return m})),n.d(e,"transform",(function(){return i})),n.d(e,"untransform",(function(){return y}));var r=function(t){return t},i=function(t){if(null==t)return r;var e,n,i=t.scale[0],o=t.scale[1],a=t.translate[0],s=t.translate[1];return function(t,r){r||(e=n=0);var u=2,c=t.length,l=new Array(c);for(l[0]=(e+=t[0])*i+a,l[1]=(n+=t[1])*o+s;u<c;)l[u]=t[u],++u;return l}},o=function(t){var e,n=i(t.transform),r=1/0,o=r,a=-r,s=-r;function u(t){(t=n(t))[0]<r&&(r=t[0]),t[0]>a&&(a=t[0]),t[1]<o&&(o=t[1]),t[1]>s&&(s=t[1])}function c(t){switch(t.type){case"GeometryCollection":t.geometries.forEach(c);break;case"Point":u(t.coordinates);break;case"MultiPoint":t.coordinates.forEach(u)}}for(e in t.arcs.forEach((function(t){for(var e,i=-1,u=t.length;++i<u;)(e=n(t[i],i))[0]<r&&(r=e[0]),e[0]>a&&(a=e[0]),e[1]<o&&(o=e[1]),e[1]>s&&(s=e[1])})),t.objects)c(t.objects[e]);return[r,o,a,s]},a=function(t,e){return"string"==typeof e&&(e=t.objects[e]),"GeometryCollection"===e.type?{type:"FeatureCollection",features:e.geometries.map((function(e){return s(t,e)}))}:s(t,e)};function s(t,e){var n=e.id,r=e.bbox,i=null==e.properties?{}:e.properties,o=u(t,e);return null==n&&null==r?{type:"Feature",properties:i,geometry:o}:null==r?{type:"Feature",id:n,properties:i,geometry:o}:{type:"Feature",id:n,bbox:r,properties:i,geometry:o}}function u(t,e){var n=i(t.transform),r=t.arcs;function o(t,e){e.length&&e.pop();for(var i=r[t<0?~t:t],o=0,a=i.length;o<a;++o)e.push(n(i[o],o));t<0&&function(t,e){for(var n,r=t.length,i=r-e;i<--r;)n=t[i],t[i++]=t[r],t[r]=n}(e,a)}function a(t){return n(t)}function s(t){for(var e=[],n=0,r=t.length;n<r;++n)o(t[n],e);return e.length<2&&e.push(e[0]),e}function u(t){for(var e=s(t);e.length<4;)e.push(e[0]);return e}function c(t){return t.map(u)}return function t(e){var n,r=e.type;switch(r){case"GeometryCollection":return{type:r,geometries:e.geometries.map(t)};case"Point":n=a(e.coordinates);break;case"MultiPoint":n=e.coordinates.map(a);break;case"LineString":n=s(e.arcs);break;case"MultiLineString":n=e.arcs.map(s);break;case"Polygon":n=c(e.arcs);break;case"MultiPolygon":n=e.arcs.map(c);break;default:return null}return{type:r,coordinates:n}}(e)}var c=function(t,e){var n={},r={},i={},o=[],a=-1;function s(t,e){for(var r in t){var i=t[r];delete e[i.start],delete i.start,delete i.end,i.forEach((function(t){n[t<0?~t:t]=1})),o.push(i)}}return e.forEach((function(n,r){var i,o=t.arcs[n<0?~n:n];o.length<3&&!o[1][0]&&!o[1][1]&&(i=e[++a],e[a]=n,e[r]=i)})),e.forEach((function(e){var n,o,a=function(e){var n,r=t.arcs[e<0?~e:e],i=r[0];t.transform?(n=[0,0],r.forEach((function(t){n[0]+=t[0],n[1]+=t[1]}))):n=r[r.length-1];return e<0?[n,i]:[i,n]}(e),s=a[0],u=a[1];if(n=i[s])if(delete i[n.end],n.push(e),n.end=u,o=r[u]){delete r[o.start];var c=o===n?n:n.concat(o);r[c.start=n.start]=i[c.end=o.end]=c}else r[n.start]=i[n.end]=n;else if(n=r[u])if(delete r[n.start],n.unshift(e),n.start=s,o=i[s]){delete i[o.end];var l=o===n?n:o.concat(n);r[l.start=o.start]=i[l.end=n.end]=l}else r[n.start]=i[n.end]=n;else r[(n=[e]).start=s]=i[n.end=u]=n})),s(i,r),s(r,i),e.forEach((function(t){n[t<0?~t:t]||o.push([t])})),o},l=function(t){return u(t,f.apply(this,arguments))};function f(t,e,n){var r,i,o;if(arguments.length>1)r=h(t,e,n);else for(i=0,r=new Array(o=t.arcs.length);i<o;++i)r[i]=i;return{type:"MultiLineString",arcs:c(t,r)}}function h(t,e,n){var r,i=[],o=[];function a(t){var e=t<0?~t:t;(o[e]||(o[e]=[])).push({i:t,g:r})}function s(t){t.forEach(a)}function u(t){t.forEach(s)}return function t(e){switch(r=e,e.type){case"GeometryCollection":e.geometries.forEach(t);break;case"LineString":s(e.arcs);break;case"MultiLineString":case"Polygon":u(e.arcs);break;case"MultiPolygon":!function(t){t.forEach(u)}(e.arcs)}}(e),o.forEach(null==n?function(t){i.push(t[0].i)}:function(t){n(t[0].g,t[t.length-1].g)&&i.push(t[0].i)}),i}var d=function(t){return u(t,p.apply(this,arguments))};function p(t,e){var n={},r=[],i=[];function o(t){t.forEach((function(e){e.forEach((function(e){(n[e=e<0?~e:e]||(n[e]=[])).push(t)}))})),r.push(t)}function a(e){return function(t){for(var e,n=-1,r=t.length,i=t[r-1],o=0;++n<r;)e=i,i=t[n],o+=e[0]*i[1]-e[1]*i[0];return Math.abs(o)}(u(t,{type:"Polygon",arcs:[e]}).coordinates[0])}return e.forEach((function t(e){switch(e.type){case"GeometryCollection":e.geometries.forEach(t);break;case"Polygon":o(e.arcs);break;case"MultiPolygon":e.arcs.forEach(o)}})),r.forEach((function(t){if(!t._){var e=[],r=[t];for(t._=1,i.push(e);t=r.pop();)e.push(t),t.forEach((function(t){t.forEach((function(t){n[t<0?~t:t].forEach((function(t){t._||(t._=1,r.push(t))}))}))}))}})),r.forEach((function(t){delete t._})),{type:"MultiPolygon",arcs:i.map((function(e){var r,i=[];if(e.forEach((function(t){t.forEach((function(t){t.forEach((function(t){n[t<0?~t:t].length<2&&i.push(t)}))}))})),(r=(i=c(t,i)).length)>1)for(var o,s,u=1,l=a(i[0]);u<r;++u)(o=a(i[u]))>l&&(s=i[0],i[0]=i[u],i[u]=s,l=o);return i})).filter((function(t){return t.length>0}))}}var g=function(t,e){for(var n=0,r=t.length;n<r;){var i=n+r>>>1;t[i]<e?n=i+1:r=i}return n},v=function(t){var e={},n=t.map((function(){return[]}));function r(t,n){t.forEach((function(t){t<0&&(t=~t);var r=e[t];r?r.push(n):e[t]=[n]}))}function i(t,e){t.forEach((function(t){r(t,e)}))}var o={LineString:r,MultiLineString:i,Polygon:i,MultiPolygon:function(t,e){t.forEach((function(t){i(t,e)}))}};for(var a in t.forEach((function t(e,n){"GeometryCollection"===e.type?e.geometries.forEach((function(e){t(e,n)})):e.type in o&&o[e.type](e.arcs,n)})),e)for(var s=e[a],u=s.length,c=0;c<u;++c)for(var l=c+1;l<u;++l){var f,h=s[c],d=s[l];(f=n[h])[a=g(f,d)]!==d&&f.splice(a,0,d),(f=n[d])[a=g(f,h)]!==h&&f.splice(a,0,h)}return n},y=function(t){if(null==t)return r;var e,n,i=t.scale[0],o=t.scale[1],a=t.translate[0],s=t.translate[1];return function(t,r){r||(e=n=0);var u=2,c=t.length,l=new Array(c),f=Math.round((t[0]-a)/i),h=Math.round((t[1]-s)/o);for(l[0]=f-e,e=f,l[1]=h-n,n=h;u<c;)l[u]=t[u],++u;return l}},m=function(t,e){if(t.transform)throw new Error("already quantized");if(e&&e.scale)u=t.bbox;else{if(!((n=Math.floor(e))>=2))throw new Error("n must be 2");var n,r=(u=t.bbox||o(t))[0],i=u[1],a=u[2],s=u[3];e={scale:[a-r?(a-r)/(n-1):1,s-i?(s-i)/(n-1):1],translate:[r,i]}}var u,c,l=y(e),f=t.objects,h={};function d(t){return l(t)}function p(t){var e;switch(t.type){case"GeometryCollection":e={type:"GeometryCollection",geometries:t.geometries.map(p)};break;case"Point":e={type:"Point",coordinates:d(t.coordinates)};break;case"MultiPoint":e={type:"MultiPoint",coordinates:t.coordinates.map(d)};break;default:return t}return null!=t.id&&(e.id=t.id),null!=t.bbox&&(e.bbox=t.bbox),null!=t.properties&&(e.properties=t.properties),e}for(c in f)h[c]=p(f[c]);return{type:"Topology",bbox:u,transform:e,objects:h,arcs:t.arcs.map((function(t){var e,n=0,r=1,i=t.length,o=new Array(i);for(o[0]=l(t[0],0);++n<i;)((e=l(t[n],n))[0]||e[1])&&(o[r++]=e);return 1===r&&(o[r++]=[0,0]),o.length=r,o}))}}},function(t,e,n){"use strict";n.r(e),n.d(e,"default",(function(){return it})),n.d(e,"WebMercatorViewport",(function(){return it})),n.d(e,"fitBounds",(function(){return $})),n.d(e,"normalizeViewportProps",(function(){return ot})),n.d(e,"flyToViewport",(function(){return ut})),n.d(e,"lngLatToWorld",(function(){return F})),n.d(e,"worldToLngLat",(function(){return D})),n.d(e,"worldToPixels",(function(){return q})),n.d(e,"pixelsToWorld",(function(){return X})),n.d(e,"getMeterZoom",(function(){return B})),n.d(e,"getDistanceScales",(function(){return z})),n.d(e,"getWorldPosition",(function(){return V})),n.d(e,"getViewMatrix",(function(){return G})),n.d(e,"getProjectionMatrix",(function(){return W})),n.d(e,"getProjectionParameters",(function(){return U})),n.d(e,"PerspectiveMercatorViewport",(function(){return it})),n.d(e,"getUncenteredViewMatrix",(function(){return G})),n.d(e,"projectFlat",(function(){return F})),n.d(e,"unprojectFlat",(function(){return D}));var r=n(1),i=n(2),o=n(9),a=n(8),s=n(10),u=n(17),c=n(13),l=n(18),f=n(301),h=n.n(f),d=n(302),p=n.n(d);function g(t,e){var n=p()([],e,t);return h()(n,n,1/n[3]),n}function v(t,e){var n=t%e;return n<0?e+n:n}var y=n(103),m=n(297),b=n.n(m),_=n(104),x=n.n(_),w=n(105),E=n.n(w),S=n(298),O=n.n(S),P=n(299),C=n.n(P),M=n(300),I=n.n(M);function A(t){if(!t)throw new Error("viewport-mercator-project: assertion failed.")}var T=Math.PI,N=T/4,L=T/180,R=180/T;function k(t){return Math.pow(2,t)}function j(t){return Math.log2(t)}function F(t,e){var n=Object(c.a)(t,2),r=n[0],i=n[1]*L;return[(e*=512)*(r*L+T)/(2*T),e*(T-Math.log(Math.tan(N+.5*i)))/(2*T)]}function D(t,e){var n=Object(c.a)(t,2),r=n[0],i=n[1],o=r/(e*=512)*(2*T)-T,a=2*(Math.atan(Math.exp(T-i/e*(2*T)))-N);return[o*R,a*R]}function B(t){var e=t.latitude;return A(Number.isFinite(e)),j(4003e4*Math.cos(e*L))-9}function z(t){var e=t.latitude,n=t.longitude,r=t.zoom,i=t.scale,o=t.highPrecision,a=void 0!==o&&o;i=void 0!==i?i:k(r),A(Number.isFinite(e)&&Number.isFinite(n)&&Number.isFinite(i));var s={},u=512*i,c=Math.cos(e*L),l=u/360,f=l/c,h=u/4003e4/c;if(s.pixelsPerMeter=[h,h,h],s.metersPerPixel=[1/h,1/h,1/h],s.pixelsPerDegree=[l,f,h],s.degreesPerPixel=[1/l,1/f,1/h],a){var d=L*Math.tan(e*L)/c,p=l*d/2,g=u/4003e4*d,v=g/f*h;s.pixelsPerDegree2=[0,p,g],s.pixelsPerMeter2=[v,0,v]}return s}function V(t){var e=t.longitude,n=t.latitude,r=t.zoom,i=t.scale,o=t.meterOffset,a=t.distanceScales,s=void 0===a?null:a,u=F([e,n],i=void 0!==i?i:k(r)),c=new y.a(u[0],u[1],0);if(o){s=s||z({latitude:n,longitude:e,scale:i});var l=new y.a(o).scale(s.pixelsPerMeter).scale([1,-1,1]);c.add(l)}return c}function G(t){var e=t.height,n=t.pitch,r=t.bearing,i=t.altitude,o=t.center,a=void 0===o?null:o,s=t.flipY,u=void 0!==s&&s,c=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return E()(c,c,[0,0,-i]),x()(c,c,[1,1,1/e]),O()(c,c,-n*L),C()(c,c,r*L),u&&x()(c,c,[1,-1,1]),a&&E()(c,c,new y.a(a).negate()),c}function U(t){var e=t.width,n=t.height,r=t.altitude,i=void 0===r?1.5:r,o=t.pitch,a=void 0===o?0:o,s=t.farZMultiplier,u=void 0===s?1:s,c=a*L,l=Math.atan(.5/i),f=Math.sin(l)*i/Math.sin(Math.PI/2-c-l),h=Math.cos(Math.PI/2-c)*f+i;return{fov:2*Math.atan(n/2/i),aspect:e/n,focalDistance:i,near:.1,far:h*u}}function W(t){var e=t.width,n=t.height,r=t.pitch,i=t.altitude,o=t.farZMultiplier,a=U({width:e,height:n,altitude:i,pitch:r,farZMultiplier:void 0===o?10:o}),s=a.fov,u=a.aspect,c=a.near,l=a.far;return b()([],s,u,c,l)}function q(t,e){var n=Object(c.a)(t,3),r=n[0],i=n[1],o=n[2],a=void 0===o?0:o;return A(Number.isFinite(r)&&Number.isFinite(i)&&Number.isFinite(a)),g(e,[r,i,a,1])}function X(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=Object(c.a)(t,3),i=r[0],o=r[1],a=r[2];if(A(Number.isFinite(i)&&Number.isFinite(o)),Number.isFinite(a)){var s=g(e,[i,o,a,1]);return s}var u=g(e,[i,o,0,1]),l=g(e,[i,o,1,1]),f=u[2],h=l[2],d=f===h?0:((n||0)-f)/(h-f);return I()([],u,l,d)}var H=n(140),Y=n.n(H),Z=n(303),K=n.n(Z),J=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Q=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.width,i=e.height,o=e.viewMatrix,a=void 0===o?J:o,s=e.projectionMatrix,u=void 0===s?J:s;Object(r.a)(this,t),this.width=n||1,this.height=i||1,this.scale=1,this.viewMatrix=a,this.projectionMatrix=u;var c=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Y()(c,c,this.projectionMatrix),Y()(c,c,this.viewMatrix),this.viewProjectionMatrix=c;var l=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];x()(l,l,[this.width/2,-this.height/2,1]),E()(l,l,[1,-1,0]),Y()(l,l,this.viewProjectionMatrix);var f=K()([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],l);if(!f)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=l,this.pixelUnprojectionMatrix=f,this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}return Object(i.a)(t,[{key:"equals",value:function(e){return e instanceof t&&(e.width===this.width&&e.height===this.height&&Object(l.e)(e.projectionMatrix,this.projectionMatrix)&&Object(l.e)(e.viewMatrix,this.viewMatrix))}},{key:"project",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.topLeft,r=void 0===n||n,i=Object(c.a)(t,3),o=i[0],a=i[1],s=i[2],u=this.projectFlat([o,a]),l=Object(c.a)(u,2),f=l[0],h=l[1],d=q([f,h,s],this.pixelProjectionMatrix),p=Object(c.a)(d,2),g=p[0],v=p[1],y=r?v:this.height-v;return 2===t.length?[g,y]:[g,y,d[2]]}},{key:"unproject",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.topLeft,r=void 0===n||n,i=e.targetZ,o=Object(c.a)(t,3),a=o[0],s=o[1],u=o[2],l=r?s:this.height-s,f=X([a,l,u],this.pixelUnprojectionMatrix,i),h=this.unprojectFlat(f),d=Object(c.a)(h,2),p=d[0],g=d[1];return Number.isFinite(u)?[p,g,f[2]]:Number.isFinite(i)?[p,g,i]:[p,g]}},{key:"projectFlat",value:function(t){arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale;return t}},{key:"unprojectFlat",value:function(t){arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale;return t}}]),t}();function $(t){var e=t.width,n=t.height,r=t.bounds,i=t.padding,o=void 0===i?0:i,a=t.offset,s=void 0===a?[0,0]:a,u=Object(c.a)(r,2),l=Object(c.a)(u[0],2),f=l[0],h=l[1],d=Object(c.a)(u[1],2),p=d[0],g=d[1];if(Number.isFinite(o)){o={top:o,bottom:o,left:o,right:o}}else A(Number.isFinite(o.top)&&Number.isFinite(o.bottom)&&Number.isFinite(o.left)&&Number.isFinite(o.right));var v=new it({width:e,height:n,longitude:0,latitude:0,zoom:0}),y=v.project([f,g]),m=v.project([p,h]),b=[Math.abs(m[0]-y[0]),Math.abs(m[1]-y[1])],_=[e-o.left-o.right-2*Math.abs(s[0]),n-o.top-o.bottom-2*Math.abs(s[1])];A(_[0]>0&&_[1]>0);var x=_[0]/b[0],w=_[1]/b[1],E=(o.right-o.left)/2/x,S=(o.bottom-o.top)/2/w,O=[(m[0]+y[0])/2+E,(m[1]+y[1])/2+S],P=v.unproject(O),C=v.zoom+Math.log2(Math.abs(Math.min(x,w)));return{longitude:P[0],latitude:P[1],zoom:C}}var tt=n(190),et=n.n(tt),nt=n(296),rt=n.n(nt),it=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.width,s=n.height,c=n.latitude,l=void 0===c?0:c,f=n.longitude,h=void 0===f?0:f,d=n.zoom,p=void 0===d?0:d,g=n.pitch,v=void 0===g?0:g,y=n.bearing,m=void 0===y?0:y,b=n.altitude,_=void 0===b?1.5:b,x=n.farZMultiplier,w=void 0===x?10:x;Object(r.a)(this,e),i=i||1,s=s||1;var E=k(p);_=Math.max(.75,_);var S=V({longitude:h,latitude:l,scale:E}),O=W({width:i,height:s,pitch:v,bearing:m,altitude:_,farZMultiplier:w}),P=G({height:s,center:S,pitch:v,bearing:m,altitude:_,flipY:!0});return(t=Object(o.a)(this,Object(a.a)(e).call(this,{width:i,height:s,viewMatrix:P,projectionMatrix:O}))).latitude=l,t.longitude=h,t.zoom=p,t.pitch=v,t.bearing=m,t.altitude=_,t.scale=E,t.center=S,Object.freeze(Object(u.a)(Object(u.a)(t))),t}return Object(s.a)(e,t),Object(i.a)(e,[{key:"projectFlat",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale;return F(t,e)}},{key:"unprojectFlat",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale;return D(t,e)}},{key:"getMapCenterByLngLatPosition",value:function(t){var e=t.lngLat,n=X(t.pos,this.pixelUnprojectionMatrix),r=F(e,this.scale),i=et()([],r,rt()([],n));return D(et()([],this.center,i),this.scale)}},{key:"getLocationAtPoint",value:function(t){var e=t.lngLat,n=t.pos;return this.getMapCenterByLngLatPosition({lngLat:e,pos:n})}},{key:"fitBounds",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.width,i=this.height,o=$(Object.assign({width:r,height:i,bounds:t},n)),a=o.longitude,s=o.latitude,u=o.zoom;return new e({width:r,height:i,longitude:a,latitude:s,zoom:u})}}]),e}(Q);function ot(t){var e=t.width,n=t.height,r=t.longitude,i=t.latitude,o=t.zoom,a=t.pitch,s=void 0===a?0:a,u=t.bearing,c=void 0===u?0:u;(r<-180||r>180)&&(r=v(r+180,360)-180),(c<-180||c>180)&&(c=v(c+180,360)-180);var l=new it({width:e,height:n,longitude:r,latitude:i,zoom:o}),f=l.project([r,85.05113])[1],h=l.project([r,-85.05113])[1],d=0;return h-f<n&&(o+=Math.log2(n/(h-f)),f=(l=new it({width:e,height:n,longitude:r,latitude:i,zoom:o})).project([r,85.05113])[1],h=l.project([r,-85.05113])[1]),f>0?d=f:h<n&&(d=h-n),d&&(i=l.unproject([e/2,n/2+d])[1]),{width:e,height:n,longitude:r,latitude:i,zoom:o,pitch:s,bearing:c}}var at=n(189),st=["longitude","latitude","zoom"];function ut(t,e,n){var r,i={},o=t.zoom,a=[t.longitude,t.latitude],s=k(o),u=e.zoom,c=[e.longitude,e.latitude],l=k(u-o),f=new at.a(F(a,s)),h=new at.a(F(c,s)).subtract(f),d=Math.max(t.width,t.height),p=d/l,g=Math.sqrt(h.x*h.x+h.y*h.y);if(Math.abs(g)<.01){for(var v=0;v<st.length;v++){var y=st[v],m=t[y],b=e[y];i[y]=(r=n)*b+(1-r)*m}return i}var _=1.414*1.414,x=(p*p-d*d+_*_*g*g)/(2*d*_*g),w=(p*p-d*d-_*_*g*g)/(2*p*_*g),E=Math.log(Math.sqrt(x*x+1)-x),S=n*((Math.log(Math.sqrt(w*w+1)-w)-E)/1.414),O=Math.cosh(E)/Math.cosh(E+1.414*S),P=d*((Math.cosh(E)*Math.tanh(E+1.414*S)-Math.sinh(E))/_)/g,C=1/O,M=o+j(C),I=D(f.add(h.scale(P)).scale(C),k(M));return i.longitude=I[0],i.latitude=I[1],i.zoom=M,i}},function(t,e,n){"use strict";n.r(e),n.d(e,"default",(function(){return a}));function r(t){return!!t&&t.constructor===Object}function i(t){if(!t)throw new Error("coords is required");if("Feature"===t.type&&null!==t.geometry)return t.geometry.coordinates;if(t.coordinates)return t.coordinates;if(Array.isArray(t))return t;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function o(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var n=0;n<t.features.length&&!1!==e(t.features[n],n);n++);}function a(t,e){if(!r(e=e||{}))throw new Error("options is invalid");var n=e.zProperty||"elevation",a=e.flip,s=e.flags;!function(t,e,n){if(!t)throw new Error("No featureCollection passed");if(!n)throw new Error(".collectionOf() requires a name");if(!t||"FeatureCollection"!==t.type)throw new Error("Invalid input to "+n+", FeatureCollection required");for(var r=0;r<t.features.length;r++){var i=t.features[r];if(!i||"Feature"!==i.type||!i.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!i.geometry||i.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+i.geometry.type)}}(t,"Point","input must contain Points");for(var u=function(t,e){var n={};return o(t,(function(t){var e=i(t)[1];n[e]||(n[e]=[]),n[e].push(t)})),Object.keys(n).map((function(t){return n[t].sort((function(t,e){return i(t)[0]-i(e)[0]}))})).sort((function(t,n){return e?i(t[0])[1]-i(n[0])[1]:i(n[0])[1]-i(t[0])[1]}))}(t,a),c=[],l=0;l<u.length;l++){for(var f=u[l],h=[],d=0;d<f.length;d++){var p=f[d];p.properties[n]?h.push(p.properties[n]):h.push(0),!0===s&&(p.properties.matrixPosition=[l,d])}c.push(h)}return c}},function(t,e,n){"use strict";n.r(e),n.d(e,"default",(function(){return a}));function r(t){return 180*(t%(2*Math.PI))/Math.PI}function i(t){return t%360*Math.PI/180}function o(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function a(t,e,n){if(void 0===n&&(n={}),!0===n.final)return function(t,e){var n=a(e,t);return n=(n+180)%360}(t,e);var s=o(t),u=o(e),c=i(s[0]),l=i(u[0]),f=i(s[1]),h=i(u[1]),d=Math.sin(l-c)*Math.cos(h),p=Math.cos(f)*Math.sin(h)-Math.sin(f)*Math.cos(h)*Math.cos(l-c);return r(Math.atan2(d,p))}},function(t,e,n){"use strict";n.d(e,"a",(function(){return x}));var r=n(22),i=n(20),o=n(0),a=n(1),s=n(2),u=n(57);function c(t){try{var e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch(t){return null}}var l=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"sessionStorage";Object(a.a)(this,t),this.storage=c(r),this.id=e,this.config={},Object.assign(this.config,n),this._loadConfiguration()}return Object(s.a)(t,[{key:"getConfiguration",value:function(){return this.config}},{key:"setConfiguration",value:function(t){return this.config={},this.updateConfiguration(t)}},{key:"updateConfiguration",value:function(t){if(Object.assign(this.config,t),this.storage){var e=JSON.stringify(this.config);this.storage.setItem(this.id,e)}return this}},{key:"_loadConfiguration",value:function(){var t={};if(this.storage){var e=this.storage.getItem(this.id);t=e?JSON.parse(e):{}}return Object.assign(this.config,t),this}}]),t}(),f=n(45),h=n(59),d={BLACK:30,RED:31,GREEN:32,YELLOW:33,BLUE:34,MAGENTA:35,CYAN:36,WHITE:37,BRIGHT_BLACK:90,BRIGHT_RED:91,BRIGHT_GREEN:92,BRIGHT_YELLOW:93,BRIGHT_BLUE:94,BRIGHT_MAGENTA:95,BRIGHT_CYAN:96,BRIGHT_WHITE:97};function p(t){return"string"==typeof t?d[t.toUpperCase()]||d.WHITE:t}function g(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["constructor"],n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n),i=!0,o=!1,a=void 0;try{for(var s,u=function(){var n=s.value;"function"==typeof t[n]&&(e.find((function(t){return n===t}))||(t[n]=t[n].bind(t)))},c=r[Symbol.iterator]();!(i=(s=c.next()).done);i=!0)u()}catch(t){o=!0,a=t}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}}function v(t,e){if(!t)throw new Error(e||"Assertion failed")}var y={debug:u.b&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},m={enabled:!1,priority:0};function b(){}var _={};var x=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.id;Object(a.a)(this,t),this.id=n,this.VERSION=u.a,this._startTs=Object(f.a)(),this._deltaTs=Object(f.a)(),this.LOG_THROTTLE_TIMEOUT=0,this._storage=new l("__probe-".concat(this.id,"__"),m),this.userData={},this.timeStamp("".concat(this.id," started")),g(this),Object.seal(this)}return Object(s.a)(t,[{key:"isEnabled",value:function(){return this._storage.config.enabled}},{key:"getPriority",value:function(){return this._storage.config.priority}},{key:"getLevel",value:function(){return this._storage.config.priority}},{key:"getTotal",value:function(){return Number((Object(f.a)()-this._startTs).toPrecision(10))}},{key:"getDelta",value:function(){return Number((Object(f.a)()-this._deltaTs).toPrecision(10))}},{key:"enable",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._storage.updateConfiguration({enabled:t}),this}},{key:"setLevel",value:function(t){return this._storage.updateConfiguration({priority:t}),this}},{key:"assert",value:function(t,e){v(t,e)}},{key:"warn",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return this._getLogFunction({message:t,args:n,method:y.warn,once:!0})}},{key:"error",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return this._getLogFunction({message:t,args:n,method:y.error})}},{key:"deprecated",value:function(t,e){return this.warn("`".concat(t,"` is deprecated and will be removed in a later version. Use `").concat(e,"` instead"))}},{key:"removed",value:function(t,e){return this.error("`".concat(t,"` has been removed. Use `").concat(e,"` instead"))}},{key:"probe",value:function(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return this._getLogFunction({priority:t,message:e,args:r,method:y.log,time:!0,once:!0})}},{key:"log",value:function(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return this._getLogFunction({priority:t,message:e,args:r,method:y.debug})}},{key:"info",value:function(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return this._getLogFunction({priority:t,message:e,args:r,method:console.info})}},{key:"once",value:function(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return this._getLogFunction({priority:t,message:e,args:r,method:y.debug||y.info,once:!0})}},{key:"table",value:function(t,e,n){if(e){var r=function(t){for(var e in t)for(var n in t[e])return n||"untitled";return"empty"}(e);return this._getLogFunction({priority:t,message:e,args:n&&[n],tag:r,method:console.table||b})}return b}},{key:"image",value:function(t){var e=t.priority,n=t.image,r=t.message,i=void 0===r?"":r,o=t.scale,a=void 0===o?1:o;return e>this.getPriority()?b:u.b?this._logImageInBrowser({image:n,message:i,scale:a}):this._logImageInNode({image:n,message:i,scale:a})}},{key:"settings",value:function(){console.table?console.table(this._storage.config):console.log(this._storage.config)}},{key:"get",value:function(t){return this._storage.config[t]}},{key:"set",value:function(t,e){this._storage.updateConfiguration(Object(o.a)({},t,e))}},{key:"_logImageInNode",value:function(t){var e=t.image,r=(t.message,t.scale),i=void 0===r?1:r,o=null;try{o=n(344)}catch(t){}return o?function(){return o(e,{fit:"box",width:"".concat(Math.round(80*i),"%")}).then((function(t){return console.log(t)}))}:b}},{key:"_logImageInBrowser",value:function(t){var e=t.image,n=t.message,r=void 0===n?"":n,o=t.scale,a=void 0===o?1:o;if("string"==typeof e){var s=new Image;return s.onload=function(){var t,e=Object(h.a)(s,r,a);(t=console).log.apply(t,Object(i.a)(e))},s.src=e,b}var u,c=e.nodeName||"";if("img"===c.toLowerCase())return(u=console).log.apply(u,Object(i.a)(Object(h.a)(e,r,a))),b;if("canvas"===c.toLowerCase()){var l=new Image;return l.onload=function(){var t;return(t=console).log.apply(t,Object(i.a)(Object(h.a)(l,r,a)))},l.src=e.toDataURL(),b}return b}},{key:"time",value:function(t,e){return this._getLogFunction({priority:t,message:e,method:console.time?console.time:console.info})}},{key:"timeEnd",value:function(t,e){return this._getLogFunction({priority:t,message:e,method:console.timeEnd?console.timeEnd:console.info})}},{key:"timeStamp",value:function(t,e){return this._getLogFunction({priority:t,message:e,method:console.timeStamp||b})}},{key:"group",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{collapsed:!1},r=n=this._normalizeArguments({priority:t,message:e,opts:n}),i=r.collapsed;return this._getLogFunction({priority:t,message:e,opts:n,method:(i?console.groupCollapsed:console.group)||console.info})}},{key:"groupCollapsed",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.group(t,e,Object.assign({},n,{collapsed:!0}))}},{key:"groupEnd",value:function(t){return this._getLogFunction({priority:t,message:"",method:console.groupEnd||b})}},{key:"withGroup",value:function(t,e,n){var r=this._normalizeArguments({priority:t,message:e});this.group(r);try{n()}finally{this.groupEnd(r.message)}}},{key:"trace",value:function(){console.trace&&console.trace()}},{key:"_shouldLog",value:function(t){return 0===(t=this._normalizePriority(t))||this.isEnabled()&&this.getPriority()>=t}},{key:"_getElapsedTime",value:function(){var t=this.getTotal(),e=this.getDelta();return this._deltaTs=Object(f.a)(),{total:t,delta:e}}},{key:"_getLogFunction",value:function(t){if(this._shouldLog(t.priority)){var e=t.method;t=this._parseArguments(t),v(e);var n=t.message,r=t.tag||t.message;if(t.once){if(_[r])return b;_[r]=Object(f.a)()}return n=this._decorateMessage(n,t),e.bind.apply(e,[console,n].concat(Object(i.a)(t.args)))}return b}},{key:"_parseArguments",value:function(t){var e=this._normalizeArguments(t),n=this._getElapsedTime(),r=n.delta,i=n.total;return Object.assign(t,e,{delta:r,total:i})}},{key:"_normalizePriority",value:function(t){var e;switch(Object(r.a)(t)){case"number":e=t;break;case"object":e=t.priority||0;break;default:e=0}return v(Number.isFinite(e)&&e>=0),e}},{key:"_normalizeArguments",value:function(t){var e=t.priority,n=t.message,i=t.args,o=void 0===i?[]:i,a=t.opts,s={priority:this._normalizePriority(e),message:n,args:o};switch(Object(r.a)(e)){case"string":case"function":void 0!==n&&o.unshift(n),Object.assign(s,{message:e});break;case"object":Object.assign(s,e)}return"function"==typeof s.message&&(s.message=this._shouldLog(s.priority)?s.message():""),v("string"==typeof s.message||"object"===Object(r.a)(s.message)),Object.assign(s,a)}},{key:"_decorateMessage",value:function(t,e){if("string"==typeof t){var n="";if(e.time){var r=this._getElapsedTime().total;n=Object(h.c)(Object(h.b)(r))}t=e.time?"".concat(this.id,": ").concat(n,"  ").concat(t):"".concat(this.id,": ").concat(t),i=t,o=e.color,a=e.background,u.b||"string"!=typeof i||(o&&(o=p(o),i="[".concat(o,"m").concat(i,"[39m")),a&&(o=p(a),i="[".concat(a+10,"m").concat(i,"[49m"))),t=i}var i,o,a;return t}},{key:"priority",set:function(t){return this._storage.updateConfiguration({priority:t}),this},get:function(){return this._storage.config.priority}}]),t}();x.VERSION=u.a},,,function(t,e,n){"use strict";n.d(e,"a",(function(){return _}));var r=n(13),i=n(1),o=n(2),a=n(9),s=n(8),u=n(10),c=n(137),l=n(18);function f(t,e){return t.length===e&&t.every(Number.isFinite)}var h=n(189),d=n(103),p=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return Object(i.a)(this,e),t=Object(a.a)(this,Object(s.a)(e).call(this,4)),Array.isArray(n)&&1===arguments.length?t.copy(n):t.set(n,r,o,u),t}return Object(u.a)(e,t),Object(o.a)(e,[{key:"applyMatrix4",value:function(t){return t.transformVector(this,this),this}},{key:"ELEMENTS",get:function(){return 4}},{key:"z",get:function(){return this[2]},set:function(t){return this[2]=Object(l.a)(t)}},{key:"w",get:function(){return this[3]},set:function(t){return this[3]=Object(l.a)(t)}}]),e}(n(88).a),g=n(12),v=n(30),y=n(49),m=n(44),b=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];var _=function(t){function e(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return Object(i.a)(this,e),t=Object(a.a)(this,Object(s.a)(e).call(this,16)),Array.isArray(r[0])&&1===arguments.length?t.copy(r[0]):t.identity(),t}return Object(u.a)(e,t),Object(o.a)(e,[{key:"setRowMajor",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,l=arguments.length>10&&void 0!==arguments[10]?arguments[10]:1,f=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,h=arguments.length>12&&void 0!==arguments[12]?arguments[12]:0,d=arguments.length>13&&void 0!==arguments[13]?arguments[13]:0,p=arguments.length>14&&void 0!==arguments[14]?arguments[14]:0,g=arguments.length>15&&void 0!==arguments[15]?arguments[15]:1;return this[0]=t,this[1]=i,this[2]=u,this[3]=h,this[4]=e,this[5]=o,this[6]=c,this[7]=d,this[8]=n,this[9]=a,this[10]=l,this[11]=p,this[12]=r,this[13]=s,this[14]=f,this[15]=g,this.check()}},{key:"setColumnMajor",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,l=arguments.length>10&&void 0!==arguments[10]?arguments[10]:1,f=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,h=arguments.length>12&&void 0!==arguments[12]?arguments[12]:0,d=arguments.length>13&&void 0!==arguments[13]?arguments[13]:0,p=arguments.length>14&&void 0!==arguments[14]?arguments[14]:0,g=arguments.length>15&&void 0!==arguments[15]?arguments[15]:1;return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this[4]=i,this[5]=o,this[6]=a,this[7]=s,this[8]=u,this[9]=c,this[10]=l,this[11]=f,this[12]=h,this[13]=d,this[14]=p,this[15]=g,this.check()}},{key:"set",value:function(){return this.setColumnMajor.apply(this,arguments)}},{key:"getElement",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n?this[t][e]:this[e][t]}},{key:"setElement",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return r?this[t][e]=Object(l.a)(n):this[e][t]=Object(l.a)(n),this}},{key:"determinant",value:function(){return g.a(this)}},{key:"identity",value:function(){return this.copy(b)}},{key:"fromQuaternion",value:function(t){return g.c(this,t),this.check()}},{key:"frustum",value:function(t){var e=t.left,n=t.right,r=t.bottom,i=t.top,o=t.near,a=t.far;return g.d(this,e,n,r,i,o,a),this.check()}},{key:"lookAt",value:function(t){var e=t.eye,n=t.center,r=void 0===n?[0,0,0]:n,i=t.up,o=void 0===i?[0,1,0]:i;return g.f(this,e,r,o),this.check()}},{key:"ortho",value:function(t){var e=t.left,n=t.right,r=t.bottom,i=t.top,o=t.near,a=void 0===o?.1:o,s=t.far,u=void 0===s?500:s;return g.h(this,e,n,r,i,a,u),this.check()}},{key:"orthographic",value:function(t){var n=t.fovy,r=void 0===n?45*Math.PI/180:n,i=t.aspect,o=void 0===i?1:i,a=t.focalDistance,s=void 0===a?1:a,u=t.near,c=void 0===u?.1:u,l=t.far,f=void 0===l?500:l;if(r>2*Math.PI)throw Error("radians");var h=r/2,d=s*Math.tan(h),p=d*o;return(new e).ortho({left:-p,right:p,bottom:-d,top:d,near:c,far:f})}},{key:"perspective",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.fovy,n=t.fov,r=void 0===n?45*Math.PI/180:n,i=t.aspect,o=void 0===i?1:i,a=t.near,s=void 0===a?.1:a,u=t.far,c=void 0===u?500:u;if((e=e||r)>2*Math.PI)throw Error("radians");return g.i(this,e,o,s,c),this.check()}},{key:"transpose",value:function(){return g.p(this,this),this.check()}},{key:"invert",value:function(){return g.e(this,this),this.check()}},{key:"multiplyLeft",value:function(t){return g.g(this,t,this),this.check()}},{key:"multiplyRight",value:function(t){return g.g(this,this,t),this.check()}},{key:"rotateX",value:function(t){return g.k(this,this,t),this.check()}},{key:"rotateY",value:function(t){return g.l(this,this,t),this.check()}},{key:"rotateZ",value:function(t){return g.m(this,this,t),this.check()}},{key:"rotateXYZ",value:function(t){var e=Object(r.a)(t,3),n=e[0],i=e[1],o=e[2];return this.rotateX(n).rotateY(i).rotateZ(o)}},{key:"rotateAxis",value:function(t,e){return g.j(this,this,t,e),this.check()}},{key:"scale",value:function(t){return Array.isArray(t)?g.n(this,this,t):g.n(this,this,[t,t,t]),this.check()}},{key:"translate",value:function(t){return g.o(this,this,t),this.check()}},{key:"transformVector2",value:function(t,e){return e=e||new h.a,v.h(e,t,this),f(e,2),e}},{key:"transformVector3",value:function(t,e){return e=e||new d.a,y.i(e,t,this),f(e,3),e}},{key:"transformVector4",value:function(t,e){return e=e||new p,m.c(e,t,this),f(e,4),e.check()}},{key:"transformVector",value:function(t,e){switch(t.length){case 2:return this.transformVector2(t,e);case 3:return this.transformVector3(t,e);case 4:return this.transformVector4(t,e);default:throw new Error("Illegal vector")}}},{key:"transformDirection",value:function(t,e){return this._transformVector(t,e,0)}},{key:"transformPoint",value:function(t,e){return this._transformVector(t,e,1)}},{key:"_transformVector",value:function(t,e,n){switch(t.length){case 2:e=e||new h.a,m.c(e,[t[0],t[1],0,n],this),e.length=2,f(e,2);break;case 3:e=e||new d.a,m.c(e,[t[0],t[1],t[2],n],this),e.length=3,f(e,3);break;case 4:if(Boolean(n)!==Boolean(t[3]))throw new Error("math.gl: Matrix4.transformPoint - invalid vector");e=e||new p,m.c(e,t,this),f(e,4);break;default:throw new Error("Illegal vector")}return e}},{key:"makeRotationX",value:function(t){return this.identity().rotateX(t)}},{key:"makeTranslation",value:function(t,e,n){return this.identity().translate([t,e,n])}},{key:"ELEMENTS",get:function(){return 16}}]),e}(c.a)}])}));